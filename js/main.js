var shadow$provide = {};
(function(){
shadow$provide[0]=function(Le,Sd,Yd,ba){function Na(Ma){if(null===Ma||"object"!==typeof Ma)return null;Ma=Hc&&Ma[Hc]||Ma["@@iterator"];return"function"===typeof Ma?Ma:null}function qc(Ma,jb,sc){this.props=Ma;this.context=jb;this.refs=sd;this.updater=sc||Jc}function hb(){}function M(Ma,jb,sc){this.props=Ma;this.context=jb;this.refs=sd;this.updater=sc||Jc}function v(Ma,jb,sc){var Ac,Tc={},od=null,Vc=null;if(null!=jb)for(Ac in void 0!==jb.ref&&(Vc=jb.ref),void 0!==jb.key&&(od=""+jb.key),jb)xc.call(jb,
Ac)&&!pd.hasOwnProperty(Ac)&&(Tc[Ac]=jb[Ac]);var yc=arguments.length-2;if(1===yc)Tc.children=sc;else if(1<yc){for(var Pc=Array(yc),td=0;td<yc;td++)Pc[td]=arguments[td+2];Tc.children=Pc}if(Ma&&Ma.defaultProps)for(Ac in yc=Ma.defaultProps,yc)void 0===Tc[Ac]&&(Tc[Ac]=yc[Ac]);return{$$typeof:vb,type:Ma,key:od,ref:Vc,props:Tc,_owner:Nc.current}}function ta(Ma,jb){return{$$typeof:vb,type:Ma.type,key:jb,ref:Ma.ref,props:Ma.props,_owner:Ma._owner}}function Va(Ma){return"object"===typeof Ma&&null!==Ma&&Ma.$$typeof===
vb}function Ab(Ma){var jb={"\x3d":"\x3d0",":":"\x3d2"};return"$"+Ma.replace(/[=:]/g,function(sc){return jb[sc]})}function $a(Ma,jb){return"object"===typeof Ma&&null!==Ma&&null!=Ma.key?Ab(""+Ma.key):jb.toString(36)}function Sb(Ma,jb,sc,Ac,Tc){var od=typeof Ma;if("undefined"===od||"boolean"===od)Ma=null;var Vc=!1;if(null===Ma)Vc=!0;else switch(od){case "string":case "number":Vc=!0;break;case "object":switch(Ma.$$typeof){case vb:case Pa:Vc=!0}}if(Vc)return Vc=Ma,Tc=Tc(Vc),Ma=""===Ac?"."+$a(Vc,0):Ac,
dc(Tc)?(sc="",null!=Ma&&(sc=Ma.replace(Ic,"$\x26/")+"/"),Sb(Tc,jb,sc,"",function(td){return td})):null!=Tc&&(Va(Tc)&&(Tc=ta(Tc,sc+(!Tc.key||Vc&&Vc.key===Tc.key?"":(""+Tc.key).replace(Ic,"$\x26/")+"/")+Ma)),jb.push(Tc)),1;Vc=0;Ac=""===Ac?".":Ac+":";if(dc(Ma))for(var yc=0;yc<Ma.length;yc++){od=Ma[yc];var Pc=Ac+$a(od,yc);Vc+=Sb(od,jb,sc,Pc,Tc)}else if(Pc=Na(Ma),"function"===typeof Pc)for(Ma=Pc.call(Ma),yc=0;!(od=Ma.next()).done;)od=od.value,Pc=Ac+$a(od,yc++),Vc+=Sb(od,jb,sc,Pc,Tc);else if("object"===
od)throw jb=String(Ma),Error("Objects are not valid as a React child (found: "+("[object Object]"===jb?"object with keys {"+Object.keys(Ma).join(", ")+"}":jb)+"). If you meant to render a collection of children, use an array instead.");return Vc}function na(Ma,jb,sc){if(null==Ma)return Ma;var Ac=[],Tc=0;Sb(Ma,Ac,"","",function(od){return jb.call(sc,od,Tc++)});return Ac}function bb(Ma){if(-1===Ma._status){var jb=Ma._result;jb=jb();jb.then(function(sc){if(0===Ma._status||-1===Ma._status)Ma._status=
1,Ma._result=sc},function(sc){if(0===Ma._status||-1===Ma._status)Ma._status=2,Ma._result=sc});-1===Ma._status&&(Ma._status=0,Ma._result=jb)}if(1===Ma._status)return Ma._result.default;throw Ma._result;}function tc(){throw Error("act(...) is not supported in production builds of React.");}var vb=Symbol.for("react.element"),Pa=Symbol.for("react.portal");Le=Symbol.for("react.fragment");Sd=Symbol.for("react.strict_mode");Yd=Symbol.for("react.profiler");var yb=Symbol.for("react.provider"),Ib=Symbol.for("react.context"),
Fb=Symbol.for("react.forward_ref"),zb=Symbol.for("react.suspense"),lc=Symbol.for("react.memo"),bc=Symbol.for("react.lazy"),Hc=Symbol.iterator,Jc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},id=Object.assign,sd={};qc.prototype.isReactComponent={};qc.prototype.setState=function(Ma,jb){if("object"!==typeof Ma&&"function"!==typeof Ma&&null!=Ma)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");
this.updater.enqueueSetState(this,Ma,jb,"setState")};qc.prototype.forceUpdate=function(Ma){this.updater.enqueueForceUpdate(this,Ma,"forceUpdate")};hb.prototype=qc.prototype;var Dc=M.prototype=new hb;Dc.constructor=M;id(Dc,qc.prototype);Dc.isPureReactComponent=!0;var dc=Array.isArray,xc=Object.prototype.hasOwnProperty,Nc={current:null},pd={key:!0,ref:!0,__self:!0,__source:!0},Ic=/\/+/g,Rc={current:null},Kb={transition:null};Dc={ReactCurrentDispatcher:Rc,ReactCurrentBatchConfig:Kb,ReactCurrentOwner:Nc};
ba.Children={map:na,forEach:function(Ma,jb,sc){na(Ma,function(){jb.apply(this,arguments)},sc)},count:function(Ma){var jb=0;na(Ma,function(){jb++});return jb},toArray:function(Ma){return na(Ma,function(jb){return jb})||[]},only:function(Ma){if(!Va(Ma))throw Error("React.Children.only expected to receive a single React element child.");return Ma}};ba.Component=qc;ba.Fragment=Le;ba.Profiler=Yd;ba.PureComponent=M;ba.StrictMode=Sd;ba.Suspense=zb;ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dc;
ba.act=tc;ba.cloneElement=function(Ma,jb,sc){if(null===Ma||void 0===Ma)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Ma+".");var Ac=id({},Ma.props),Tc=Ma.key,od=Ma.ref,Vc=Ma._owner;if(null!=jb){void 0!==jb.ref&&(od=jb.ref,Vc=Nc.current);void 0!==jb.key&&(Tc=""+jb.key);if(Ma.type&&Ma.type.defaultProps)var yc=Ma.type.defaultProps;for(Pc in jb)xc.call(jb,Pc)&&!pd.hasOwnProperty(Pc)&&(Ac[Pc]=void 0===jb[Pc]&&void 0!==yc?yc[Pc]:jb[Pc])}var Pc=arguments.length-
2;if(1===Pc)Ac.children=sc;else if(1<Pc){yc=Array(Pc);for(var td=0;td<Pc;td++)yc[td]=arguments[td+2];Ac.children=yc}return{$$typeof:vb,type:Ma.type,key:Tc,ref:od,props:Ac,_owner:Vc}};ba.createContext=function(Ma){Ma={$$typeof:Ib,_currentValue:Ma,_currentValue2:Ma,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};Ma.Provider={$$typeof:yb,_context:Ma};return Ma.Consumer=Ma};ba.createElement=v;ba.createFactory=function(Ma){var jb=v.bind(null,Ma);jb.type=Ma;return jb};ba.createRef=
function(){return{current:null}};ba.forwardRef=function(Ma){return{$$typeof:Fb,render:Ma}};ba.isValidElement=Va;ba.lazy=function(Ma){return{$$typeof:bc,_payload:{_status:-1,_result:Ma},_init:bb}};ba.memo=function(Ma,jb){return{$$typeof:lc,type:Ma,compare:void 0===jb?null:jb}};ba.startTransition=function(Ma){var jb=Kb.transition;Kb.transition={};try{Ma()}finally{Kb.transition=jb}};ba.unstable_act=tc;ba.useCallback=function(Ma,jb){return Rc.current.useCallback(Ma,jb)};ba.useContext=function(Ma){return Rc.current.useContext(Ma)};
ba.useDebugValue=function(){};ba.useDeferredValue=function(Ma){return Rc.current.useDeferredValue(Ma)};ba.useEffect=function(Ma,jb){return Rc.current.useEffect(Ma,jb)};ba.useId=function(){return Rc.current.useId()};ba.useImperativeHandle=function(Ma,jb,sc){return Rc.current.useImperativeHandle(Ma,jb,sc)};ba.useInsertionEffect=function(Ma,jb){return Rc.current.useInsertionEffect(Ma,jb)};ba.useLayoutEffect=function(Ma,jb){return Rc.current.useLayoutEffect(Ma,jb)};ba.useMemo=function(Ma,jb){return Rc.current.useMemo(Ma,
jb)};ba.useReducer=function(Ma,jb,sc){return Rc.current.useReducer(Ma,jb,sc)};ba.useRef=function(Ma){return Rc.current.useRef(Ma)};ba.useState=function(Ma){return Rc.current.useState(Ma)};ba.useSyncExternalStore=function(Ma,jb,sc){return Rc.current.useSyncExternalStore(Ma,jb,sc)};ba.useTransition=function(){return Rc.current.useTransition()};ba.version="18.3.1"};
shadow$provide[2]=function(Le,Sd,Yd,ba){Yd.exports=Sd(0)};
shadow$provide[3]=function(Le,Sd,Yd,ba){function Na(Kb,Ma){var jb=Kb.length;Kb.push(Ma);a:for(;0<jb;){var sc=jb-1>>>1,Ac=Kb[sc];if(0<M(Ac,Ma))Kb[sc]=Ma,Kb[jb]=Ac,jb=sc;else break a}}function qc(Kb){return 0===Kb.length?null:Kb[0]}function hb(Kb){if(0===Kb.length)return null;var Ma=Kb[0],jb=Kb.pop();if(jb!==Ma){Kb[0]=jb;var sc=0,Ac=Kb.length,Tc=Ac>>>1;a:for(;sc<Tc;){var od=2*(sc+1)-1,Vc=Kb[od],yc=od+1,Pc=Kb[yc];if(0>M(Vc,jb))yc<Ac&&0>M(Pc,Vc)?(Kb[sc]=Pc,Kb[yc]=jb,sc=yc):(Kb[sc]=Vc,Kb[od]=jb,sc=od);
else if(yc<Ac&&0>M(Pc,jb))Kb[sc]=Pc,Kb[yc]=jb,sc=yc;else break a}}return Ma}function M(Kb,Ma){var jb=Kb.sortIndex-Ma.sortIndex;return 0!==jb?jb:Kb.id-Ma.id}function v(Kb){for(var Ma=qc(yb);null!==Ma;){if(null===Ma.callback)hb(yb);else if(Ma.startTime<=Kb)hb(yb),Ma.sortIndex=Ma.expirationTime,Na(Pa,Ma);else break;Ma=qc(yb)}}function ta(Kb){Hc=!1;v(Kb);if(!bc)if(null!==qc(Pa))bc=!0,Sb(Va);else{var Ma=qc(yb);null!==Ma&&na(ta,Ma.startTime-Kb)}}function Va(Kb,Ma){bc=!1;Hc&&(Hc=!1,id(xc),xc=-1);lc=!0;var jb=
zb;try{v(Ma);for(Fb=qc(Pa);null!==Fb&&(!(Fb.expirationTime>Ma)||Kb&&!Ab());){var sc=Fb.callback;if("function"===typeof sc){Fb.callback=null;zb=Fb.priorityLevel;var Ac=sc(Fb.expirationTime<=Ma);Ma=ba.unstable_now();"function"===typeof Ac?Fb.callback=Ac:Fb===qc(Pa)&&hb(Pa);v(Ma)}else hb(Pa);Fb=qc(Pa)}if(null!==Fb)var Tc=!0;else{var od=qc(yb);null!==od&&na(ta,od.startTime-Ma);Tc=!1}return Tc}finally{Fb=null,zb=jb,lc=!1}}function Ab(){return ba.unstable_now()-pd<Nc?!1:!0}function $a(){if(null!==dc){var Kb=
ba.unstable_now();pd=Kb;var Ma=!0;try{Ma=dc(!0,Kb)}finally{Ma?Ic():(Dc=!1,dc=null)}}else Dc=!1}function Sb(Kb){dc=Kb;Dc||(Dc=!0,Ic())}function na(Kb,Ma){xc=Jc(function(){Kb(ba.unstable_now())},Ma)}if("object"===typeof performance&&"function"===typeof performance.now){var bb=performance;ba.unstable_now=function(){return bb.now()}}else{var tc=Date,vb=tc.now();ba.unstable_now=function(){return tc.now()-vb}}var Pa=[],yb=[],Ib=1,Fb=null,zb=3,lc=!1,bc=!1,Hc=!1,Jc="function"===typeof setTimeout?setTimeout:
null,id="function"===typeof clearTimeout?clearTimeout:null,sd="undefined"!==typeof setImmediate?setImmediate:null;"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var Dc=!1,dc=null,xc=-1,Nc=5,pd=-1;if("function"===typeof sd)var Ic=function(){sd($a)};else if("undefined"!==typeof MessageChannel){Le=new MessageChannel;var Rc=Le.port2;Le.port1.onmessage=$a;Ic=function(){Rc.postMessage(null)}}else Ic=
function(){Jc($a,0)};ba.unstable_IdlePriority=5;ba.unstable_ImmediatePriority=1;ba.unstable_LowPriority=4;ba.unstable_NormalPriority=3;ba.unstable_Profiling=null;ba.unstable_UserBlockingPriority=2;ba.unstable_cancelCallback=function(Kb){Kb.callback=null};ba.unstable_continueExecution=function(){bc||lc||(bc=!0,Sb(Va))};ba.unstable_forceFrameRate=function(Kb){0>Kb||125<Kb?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):
Nc=0<Kb?Math.floor(1E3/Kb):5};ba.unstable_getCurrentPriorityLevel=function(){return zb};ba.unstable_getFirstCallbackNode=function(){return qc(Pa)};ba.unstable_next=function(Kb){switch(zb){case 1:case 2:case 3:var Ma=3;break;default:Ma=zb}var jb=zb;zb=Ma;try{return Kb()}finally{zb=jb}};ba.unstable_pauseExecution=function(){};ba.unstable_requestPaint=function(){};ba.unstable_runWithPriority=function(Kb,Ma){switch(Kb){case 1:case 2:case 3:case 4:case 5:break;default:Kb=3}var jb=zb;zb=Kb;try{return Ma()}finally{zb=
jb}};ba.unstable_scheduleCallback=function(Kb,Ma,jb){var sc=ba.unstable_now();"object"===typeof jb&&null!==jb?(jb=jb.delay,jb="number"===typeof jb&&0<jb?sc+jb:sc):jb=sc;switch(Kb){case 1:var Ac=-1;break;case 2:Ac=250;break;case 5:Ac=1073741823;break;case 4:Ac=1E4;break;default:Ac=5E3}Ac=jb+Ac;Kb={id:Ib++,callback:Ma,priorityLevel:Kb,startTime:jb,expirationTime:Ac,sortIndex:-1};jb>sc?(Kb.sortIndex=jb,Na(yb,Kb),null===qc(Pa)&&Kb===qc(yb)&&(Hc?(id(xc),xc=-1):Hc=!0,na(ta,jb-sc))):(Kb.sortIndex=Ac,Na(Pa,
Kb),bc||lc||(bc=!0,Sb(Va)));return Kb};ba.unstable_shouldYield=Ab;ba.unstable_wrapCallback=function(Kb){var Ma=zb;return function(){var jb=zb;zb=Ma;try{return Kb.apply(this,arguments)}finally{zb=jb}}}};
shadow$provide[5]=function(Le,Sd,Yd,ba){Yd.exports=Sd(3)};
shadow$provide[6]=function(Le,Sd,Yd,ba){function Na(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant\x3d"+n,B=1;B<arguments.length;B++)r+="\x26args[]\x3d"+encodeURIComponent(arguments[B]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function qc(n,r){hb(n,r);hb(n+"Capture",r)}function hb(n,r){R[n]=r;for(n=0;n<r.length;n++)K.add(r[n])}function M(n){if(ca.call(pa,n))return!0;
if(ca.call(la,n))return!1;if(ja.test(n))return pa[n]=!0;la[n]=!0;return!1}function v(n,r,B,F){if(null!==B&&0===B.type)return!1;switch(typeof r){case "function":case "symbol":return!0;case "boolean":if(F)return!1;if(null!==B)return!B.acceptsBooleans;n=n.toLowerCase().slice(0,5);return"data-"!==n&&"aria-"!==n;default:return!1}}function ta(n,r,B,F){if(null===r||"undefined"===typeof r||v(n,r,B,F))return!0;if(F)return!1;if(null!==B)switch(B.type){case 3:return!r;case 4:return!1===r;case 5:return isNaN(r);
case 6:return isNaN(r)||1>r}return!1}function Va(n,r,B,F,Q,V,oa){this.acceptsBooleans=2===r||3===r||4===r;this.attributeName=F;this.attributeNamespace=Q;this.mustUseProperty=B;this.propertyName=n;this.type=r;this.sanitizeURL=V;this.removeEmptyString=oa}function Ab(n){return n[1].toUpperCase()}function $a(n,r,B,F){var Q=ya.hasOwnProperty(r)?ya[r]:null;if(null!==Q?0!==Q.type:F||!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])ta(r,B,Q,F)&&(B=null),F||null===Q?M(r)&&(null===B?n.removeAttribute(r):
n.setAttribute(r,""+B)):Q.mustUseProperty?n[Q.propertyName]=null===B?3===Q.type?!1:"":B:(r=Q.attributeName,F=Q.attributeNamespace,null===B?n.removeAttribute(r):(Q=Q.type,B=3===Q||4===Q&&!0===B?"":""+B,F?n.setAttributeNS(F,r,B):n.setAttribute(r,B)))}function Sb(n){if(null===n||"object"!==typeof n)return null;n=Yc&&n[Yc]||n["@@iterator"];return"function"===typeof n?n:null}function na(n){if(void 0===Bd)try{throw Error();}catch(B){var r=B.stack.trim().match(/\n( *(at )?)/);Bd=r&&r[1]||""}return"\n"+Bd+
n}function bb(n,r){if(!n||fd)return"";fd=!0;var B=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error();},Object.defineProperty(r.prototype,"props",{set:function(){throw Error();}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(tb){var F=tb}Reflect.construct(n,[],r)}else{try{r.call()}catch(tb){F=tb}n.call(r.prototype)}else{try{throw Error();}catch(tb){F=tb}n()}}catch(tb){if(tb&&F&&"string"===typeof tb.stack){for(var Q=tb.stack.split("\n"),
V=F.stack.split("\n"),oa=Q.length-1,Ia=V.length-1;1<=oa&&0<=Ia&&Q[oa]!==V[Ia];)Ia--;for(;1<=oa&&0<=Ia;oa--,Ia--)if(Q[oa]!==V[Ia]){if(1!==oa||1!==Ia){do if(oa--,Ia--,0>Ia||Q[oa]!==V[Ia]){var Ta="\n"+Q[oa].replace(" at new "," at ");n.displayName&&Ta.includes("\x3canonymous\x3e")&&(Ta=Ta.replace("\x3canonymous\x3e",n.displayName));return Ta}while(1<=oa&&0<=Ia)}break}}}finally{fd=!1,Error.prepareStackTrace=B}return(n=n?n.displayName||n.name:"")?na(n):""}function tc(n){switch(n.tag){case 5:return na(n.type);
case 16:return na("Lazy");case 13:return na("Suspense");case 19:return na("SuspenseList");case 0:case 2:case 15:return n=bb(n.type,!1),n;case 11:return n=bb(n.type.render,!1),n;case 1:return n=bb(n.type,!0),n;default:return""}}function vb(n){if(null==n)return null;if("function"===typeof n)return n.displayName||n.name||null;if("string"===typeof n)return n;switch(n){case Za:return"Fragment";case Qa:return"Portal";case ob:return"Profiler";case sb:return"StrictMode";case Ob:return"Suspense";case Jb:return"SuspenseList"}if("object"===
typeof n)switch(n.$$typeof){case Db:return(n.displayName||"Context")+".Consumer";case eb:return(n._context.displayName||"Context")+".Provider";case Nb:var r=n.render;(n=n.displayName)||(n=r.displayName||r.name||"",n=""!==n?"ForwardRef("+n+")":"ForwardRef");return n;case $b:return r=n.displayName||null,null!==r?r:vb(n.type)||"Memo";case vc:r=n._payload;n=n._init;try{return vb(n(r))}catch(B){}}return null}function Pa(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+
".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(""!==n?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vb(r);case 8:return r===sb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";
case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof r)return r.displayName||r.name||null;if("string"===typeof r)return r}return null}function yb(n){switch(typeof n){case "boolean":case "number":case "string":case "undefined":return n;case "object":return n;default:return""}}function Ib(n){var r=n.type;return(n=n.nodeName)&&"input"===n.toLowerCase()&&("checkbox"===r||"radio"===r)}function Fb(n){var r=Ib(n)?"checked":"value",B=Object.getOwnPropertyDescriptor(n.constructor.prototype,
r),F=""+n[r];if(!n.hasOwnProperty(r)&&"undefined"!==typeof B&&"function"===typeof B.get&&"function"===typeof B.set){var Q=B.get,V=B.set;Object.defineProperty(n,r,{configurable:!0,get:function(){return Q.call(this)},set:function(oa){F=""+oa;V.call(this,oa)}});Object.defineProperty(n,r,{enumerable:B.enumerable});return{getValue:function(){return F},setValue:function(oa){F=""+oa},stopTracking:function(){n._valueTracker=null;delete n[r]}}}}function zb(n){n._valueTracker||(n._valueTracker=Fb(n))}function lc(n){if(!n)return!1;
var r=n._valueTracker;if(!r)return!0;var B=r.getValue(),F="";n&&(F=Ib(n)?n.checked?"true":"false":n.value);n=F;return n!==B?(r.setValue(n),!0):!1}function bc(n){n=n||("undefined"!==typeof document?document:void 0);if("undefined"===typeof n)return null;try{return n.activeElement||n.body}catch(r){return n.body}}function Hc(n,r){var B=r.checked;return md({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=B?B:n._wrapperState.initialChecked})}function Jc(n,r){var B=null==r.defaultValue?
"":r.defaultValue,F=null!=r.checked?r.checked:r.defaultChecked;B=yb(null!=r.value?r.value:B);n._wrapperState={initialChecked:F,initialValue:B,controlled:"checkbox"===r.type||"radio"===r.type?null!=r.checked:null!=r.value}}function id(n,r){r=r.checked;null!=r&&$a(n,"checked",r,!1)}function sd(n,r){id(n,r);var B=yb(r.value),F=r.type;if(null!=B)if("number"===F){if(0===B&&""===n.value||n.value!=B)n.value=""+B}else n.value!==""+B&&(n.value=""+B);else if("submit"===F||"reset"===F){n.removeAttribute("value");
return}r.hasOwnProperty("value")?dc(n,r.type,B):r.hasOwnProperty("defaultValue")&&dc(n,r.type,yb(r.defaultValue));null==r.checked&&null!=r.defaultChecked&&(n.defaultChecked=!!r.defaultChecked)}function Dc(n,r,B){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var F=r.type;if(!("submit"!==F&&"reset"!==F||void 0!==r.value&&null!==r.value))return;r=""+n._wrapperState.initialValue;B||r===n.value||(n.value=r);n.defaultValue=r}B=n.name;""!==B&&(n.name="");n.defaultChecked=!!n._wrapperState.initialChecked;
""!==B&&(n.name=B)}function dc(n,r,B){if("number"!==r||bc(n.ownerDocument)!==n)null==B?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+B&&(n.defaultValue=""+B)}function xc(n,r,B,F){n=n.options;if(r){r={};for(var Q=0;Q<B.length;Q++)r["$"+B[Q]]=!0;for(B=0;B<n.length;B++)Q=r.hasOwnProperty("$"+n[B].value),n[B].selected!==Q&&(n[B].selected=Q),Q&&F&&(n[B].defaultSelected=!0)}else{B=""+yb(B);r=null;for(Q=0;Q<n.length;Q++){if(n[Q].value===B){n[Q].selected=!0;F&&(n[Q].defaultSelected=!0);
return}null!==r||n[Q].disabled||(r=n[Q])}null!==r&&(r.selected=!0)}}function Nc(n,r){if(null!=r.dangerouslySetInnerHTML)throw Error(Na(91));return md({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function pd(n,r){var B=r.value;if(null==B){B=r.children;r=r.defaultValue;if(null!=B){if(null!=r)throw Error(Na(92));if(ud(B)){if(1<B.length)throw Error(Na(93));B=B[0]}r=B}null==r&&(r="");B=r}n._wrapperState={initialValue:yb(B)}}function Ic(n,r){var B=yb(r.value),F=yb(r.defaultValue);
null!=B&&(B=""+B,B!==n.value&&(n.value=B),null==r.defaultValue&&n.defaultValue!==B&&(n.defaultValue=B));null!=F&&(n.defaultValue=""+F)}function Rc(n){var r=n.textContent;r===n._wrapperState.initialValue&&""!==r&&null!==r&&(n.value=r)}function Kb(n){switch(n){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ma(n,r){return null==n||"http://www.w3.org/1999/xhtml"===n?Kb(r):"http://www.w3.org/2000/svg"===
n&&"foreignObject"===r?"http://www.w3.org/1999/xhtml":n}function jb(n,r){if(r){var B=n.firstChild;if(B&&B===n.lastChild&&3===B.nodeType){B.nodeValue=r;return}}n.textContent=r}function sc(n,r,B){return null==r||"boolean"===typeof r||""===r?"":B||"number"!==typeof r||0===r||Fd.hasOwnProperty(n)&&Fd[n]?(""+r).trim():r+"px"}function Ac(n,r){n=n.style;for(var B in r)if(r.hasOwnProperty(B)){var F=0===B.indexOf("--"),Q=sc(B,r[B],F);"float"===B&&(B="cssFloat");F?n.setProperty(B,Q):n[B]=Q}}function Tc(n,r){if(r){if(ff[n]&&
(null!=r.children||null!=r.dangerouslySetInnerHTML))throw Error(Na(137,n));if(null!=r.dangerouslySetInnerHTML){if(null!=r.children)throw Error(Na(60));if("object"!==typeof r.dangerouslySetInnerHTML||!("__html"in r.dangerouslySetInnerHTML))throw Error(Na(61));}if(null!=r.style&&"object"!==typeof r.style)throw Error(Na(62));}}function od(n,r){if(-1===n.indexOf("-"))return"string"===typeof r.is;switch(n){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function Vc(n){n=n.target||n.srcElement||window;n.correspondingUseElement&&(n=n.correspondingUseElement);return 3===n.nodeType?n.parentNode:n}function yc(n){if(n=Td(n)){if("function"!==typeof ie)throw Error(Na(280));var r=n.stateNode;r&&(r=Ee(r),ie(n.stateNode,n.type,r))}}function Pc(n){oe?ce?ce.push(n):ce=[n]:oe=n}function td(){if(oe){var n=oe,r=ce;ce=oe=null;yc(n);if(r)for(n=0;n<r.length;n++)yc(r[n])}}function Cd(n,r){return n(r)}function Gd(){}function pe(n,r,B){if(pf)return n(r,
B);pf=!0;try{return Cd(n,r,B)}finally{if(pf=!1,null!==oe||null!==ce)Gd(),td()}}function qe(n,r){var B=n.stateNode;if(null===B)return null;var F=Ee(B);if(null===F)return null;B=F[r];a:switch(r){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(F=!F.disabled)||(n=n.type,F=!("button"===n||"input"===n||"select"===n||
"textarea"===n));n=!F;break a;default:n=!1}if(n)return null;if(B&&"function"!==typeof B)throw Error(Na(231,r,typeof B));return B}function gf(n,r,B,F,Q,V,oa,Ia,Ta){var tb=Array.prototype.slice.call(arguments,3);try{r.apply(B,tb)}catch(Zb){this.onError(Zb)}}function da(n,r,B,F,Q,V,oa,Ia,Ta){Ch=!1;Xh=null;gf.apply(Se,arguments)}function J(n,r,B,F,Q,V,oa,Ia,Ta){da.apply(this,arguments);if(Ch){if(Ch){var tb=Xh;Ch=!1;Xh=null}else throw Error(Na(198));Dh||(Dh=!0,Fe=tb)}}function O(n){var r=n,B=n;if(n.alternate)for(;r.return;)r=
r.return;else{n=r;do r=n,0!==(r.flags&4098)&&(B=r.return),n=r.return;while(n)}return 3===r.tag?B:null}function W(n){if(13===n.tag){var r=n.memoizedState;null===r&&(n=n.alternate,null!==n&&(r=n.memoizedState));if(null!==r)return r.dehydrated}return null}function S(n){if(O(n)!==n)throw Error(Na(188));}function fa(n){var r=n.alternate;if(!r){r=O(n);if(null===r)throw Error(Na(188));return r!==n?null:n}for(var B=n,F=r;;){var Q=B.return;if(null===Q)break;var V=Q.alternate;if(null===V){F=Q.return;if(null!==
F){B=F;continue}break}if(Q.child===V.child){for(V=Q.child;V;){if(V===B)return S(Q),n;if(V===F)return S(Q),r;V=V.sibling}throw Error(Na(188));}if(B.return!==F.return)B=Q,F=V;else{for(var oa=!1,Ia=Q.child;Ia;){if(Ia===B){oa=!0;B=Q;F=V;break}if(Ia===F){oa=!0;F=Q;B=V;break}Ia=Ia.sibling}if(!oa){for(Ia=V.child;Ia;){if(Ia===B){oa=!0;B=V;F=Q;break}if(Ia===F){oa=!0;F=V;B=Q;break}Ia=Ia.sibling}if(!oa)throw Error(Na(189));}}if(B.alternate!==F)throw Error(Na(190));}if(3!==B.tag)throw Error(Na(188));return B.stateNode.current===
B?n:r}function ra(n){n=fa(n);return null!==n?ma(n):null}function ma(n){if(5===n.tag||6===n.tag)return n;for(n=n.child;null!==n;){var r=ma(n);if(null!==r)return r;n=n.sibling}return null}function ua(n){if(Yh&&"function"===typeof Yh.onCommitFiberRoot)try{Yh.onCommitFiberRoot(ig,n,void 0,128===(n.current.flags&128))}catch(r){}}function Aa(n){n>>>=0;return 0===n?32:31-(Bn(n)/jn|0)|0}function Ua(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;
case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function fb(n,r){var B=n.pendingLanes;if(0===B)return 0;var F=0,Q=n.suspendedLanes,
V=n.pingedLanes,oa=B&268435455;if(0!==oa){var Ia=oa&~Q;0!==Ia?F=Ua(Ia):(V&=oa,0!==V&&(F=Ua(V)))}else oa=B&~Q,0!==oa?F=Ua(oa):0!==V&&(F=Ua(V));if(0===F)return 0;if(0!==r&&r!==F&&0===(r&Q)&&(Q=F&-F,V=r&-r,Q>=V||16===Q&&0!==(V&4194240)))return r;0!==(F&4)&&(F|=B&16);r=n.entangledLanes;if(0!==r)for(n=n.entanglements,r&=F;0<r;)B=31-oi(r),Q=1<<B,F|=n[B],r&=~Q;return F}function pb(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+
5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rb(n,r){for(var B=n.suspendedLanes,F=n.pingedLanes,Q=n.expirationTimes,V=n.pendingLanes;0<V;){var oa=31-oi(V),Ia=1<<oa,Ta=Q[oa];if(-1===Ta){if(0===(Ia&B)||0!==(Ia&F))Q[oa]=pb(Ia,r)}else Ta<=r&&(n.expiredLanes|=Ia);V&=~Ia}}function ec(n){n=n.pendingLanes&-1073741825;return 0!==n?n:n&1073741824?1073741824:0}function kc(){var n=
Vk;Vk<<=1;0===(Vk&4194240)&&(Vk=64);return n}function fc(n){for(var r=[],B=0;31>B;B++)r.push(n);return r}function Gc(n,r,B){n.pendingLanes|=r;536870912!==r&&(n.suspendedLanes=0,n.pingedLanes=0);n=n.eventTimes;r=31-oi(r);n[r]=B}function Fc(n,r){var B=n.pendingLanes&~r;n.pendingLanes=r;n.suspendedLanes=0;n.pingedLanes=0;n.expiredLanes&=r;n.mutableReadLanes&=r;n.entangledLanes&=r;r=n.entanglements;var F=n.eventTimes;for(n=n.expirationTimes;0<B;){var Q=31-oi(B),V=1<<Q;r[Q]=0;F[Q]=-1;n[Q]=-1;B&=~V}}function Hd(n,
r){var B=n.entangledLanes|=r;for(n=n.entanglements;B;){var F=31-oi(B),Q=1<<F;Q&r|n[F]&r&&(n[F]|=r);B&=~Q}}function de(n){n&=-n;return 1<n?4<n?0!==(n&268435455)?16:536870912:4:1}function Me(n,r){switch(n){case "focusin":case "focusout":pi=null;break;case "dragenter":case "dragleave":jg=null;break;case "mouseover":case "mouseout":oj=null;break;case "pointerover":case "pointerout":pj.delete(r.pointerId);break;case "gotpointercapture":case "lostpointercapture":nk.delete(r.pointerId)}}function zg(n,r,
B,F,Q,V){if(null===n||n.nativeEvent!==V)return n={blockedOn:r,domEventName:B,eventSystemFlags:F,nativeEvent:V,targetContainers:[Q]},null!==r&&(r=Td(r),null!==r&&Zl(r)),n;n.eventSystemFlags|=F;r=n.targetContainers;null!==Q&&-1===r.indexOf(Q)&&r.push(Q);return n}function Kf(n,r,B,F,Q){switch(r){case "focusin":return pi=zg(pi,n,r,B,F,Q),!0;case "dragenter":return jg=zg(jg,n,r,B,F,Q),!0;case "mouseover":return oj=zg(oj,n,r,B,F,Q),!0;case "pointerover":var V=Q.pointerId;pj.set(V,zg(pj.get(V)||null,n,r,
B,F,Q));return!0;case "gotpointercapture":return V=Q.pointerId,nk.set(V,zg(nk.get(V)||null,n,r,B,F,Q)),!0}return!1}function Lf(n){var r=kg(n.target);if(null!==r){var B=O(r);if(null!==B)if(r=B.tag,13===r){if(r=W(B),null!==r){n.blockedOn=r;$l(n.priority,function(){kn(B)});return}}else if(3===r&&B.stateNode.current.memoizedState.isDehydrated){n.blockedOn=3===B.tag?B.stateNode.containerInfo:null;return}}n.blockedOn=null}function Ag(n){if(null!==n.blockedOn)return!1;for(var r=n.targetContainers;0<r.length;){var B=
Ui(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(null===B){B=n.nativeEvent;var F=new B.constructor(B.type,B);we=F;B.target.dispatchEvent(F);we=null}else return r=Td(B),null!==r&&Zl(r),n.blockedOn=B,!1;r.shift()}return!0}function Vi(n,r,B){Ag(n)&&B.delete(r)}function qi(){Wk=!1;null!==pi&&Ag(pi)&&(pi=null);null!==jg&&Ag(jg)&&(jg=null);null!==oj&&Ag(oj)&&(oj=null);pj.forEach(Vi);nk.forEach(Vi)}function re(n,r){n.blockedOn===r&&(n.blockedOn=null,Wk||(Wk=!0,G.unstable_scheduleCallback(G.unstable_NormalPriority,
qi)))}function Eh(n){function r(Q){return re(Q,n)}if(0<Cl.length){re(Cl[0],n);for(var B=1;B<Cl.length;B++){var F=Cl[B];F.blockedOn===n&&(F.blockedOn=null)}}null!==pi&&re(pi,n);null!==jg&&re(jg,n);null!==oj&&re(oj,n);pj.forEach(r);nk.forEach(r);for(B=0;B<Fh.length;B++)F=Fh[B],F.blockedOn===n&&(F.blockedOn=null);for(;0<Fh.length&&(B=Fh[0],null===B.blockedOn);)Lf(B),null===B.blockedOn&&Fh.shift()}function ok(n,r,B,F){var Q=se,V=pk.transition;pk.transition=null;try{se=1,qj(n,r,B,F)}finally{se=Q,pk.transition=
V}}function Nj(n,r,B,F){var Q=se,V=pk.transition;pk.transition=null;try{se=4,qj(n,r,B,F)}finally{se=Q,pk.transition=V}}function qj(n,r,B,F){if(Oj){var Q=Ui(n,r,B,F);if(null===Q)qk(n,r,F,rj,B),Me(n,F);else if(Kf(Q,n,r,B,F))F.stopPropagation();else if(Me(n,F),r&4&&-1<Xk.indexOf(n)){for(;null!==Q;){var V=Td(Q);null!==V&&Rm(V);V=Ui(n,r,B,F);null===V&&qk(n,r,F,rj,B);if(V===Q)break;Q=V}null!==Q&&F.stopPropagation()}else qk(n,r,F,null,B)}}function Ui(n,r,B,F){rj=null;n=Vc(F);n=kg(n);if(null!==n)if(r=O(n),
null===r)n=null;else if(B=r.tag,13===B){n=W(r);if(null!==n)return n;n=null}else if(3===B){if(r.stateNode.current.memoizedState.isDehydrated)return 3===r.tag?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);rj=n;return null}function mh(n){switch(n){case "cancel":case "click":case "close":case "contextmenu":case "copy":case "cut":case "auxclick":case "dblclick":case "dragend":case "dragstart":case "drop":case "focusin":case "focusout":case "input":case "invalid":case "keydown":case "keypress":case "keyup":case "mousedown":case "mouseup":case "paste":case "pause":case "play":case "pointercancel":case "pointerdown":case "pointerup":case "ratechange":case "reset":case "resize":case "seeked":case "submit":case "touchcancel":case "touchend":case "touchstart":case "volumechange":case "change":case "selectionchange":case "textInput":case "compositionstart":case "compositionend":case "compositionupdate":case "beforeblur":case "afterblur":case "beforeinput":case "blur":case "fullscreenchange":case "focus":case "hashchange":case "popstate":case "select":case "selectstart":return 1;
case "drag":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "mousemove":case "mouseout":case "mouseover":case "pointermove":case "pointerout":case "pointerover":case "scroll":case "toggle":case "touchmove":case "wheel":case "mouseenter":case "mouseleave":case "pointerenter":case "pointerleave":return 4;case "message":switch(Yk()){case nh:return 1;case rk:return 4;case Wi:case sk:return 16;case lg:return 536870912;default:return 16}default:return 16}}function ri(){if(mg)return mg;
var n,r=si,B=r.length,F,Q="value"in Xi?Xi.value:Xi.textContent,V=Q.length;for(n=0;n<B&&r[n]===Q[n];n++);var oa=B-n;for(F=1;F<=oa&&r[B-F]===Q[V-F];F++);return mg=Q.slice(n,1<F?1-F:void 0)}function Bg(n){var r=n.keyCode;"charCode"in n?(n=n.charCode,0===n&&13===r&&(n=13)):n=r;10===n&&(n=13);return 32<=n||13===n?n:0}function Cg(){return!0}function Gh(){return!1}function te(n){function r(B,F,Q,V,oa){this._reactName=B;this._targetInst=Q;this.type=F;this.nativeEvent=V;this.target=oa;this.currentTarget=null;
for(var Ia in n)n.hasOwnProperty(Ia)&&(B=n[Ia],this[Ia]=B?B(V):V[Ia]);this.isDefaultPrevented=(null!=V.defaultPrevented?V.defaultPrevented:!1===V.returnValue)?Cg:Gh;this.isPropagationStopped=Gh;return this}md(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var B=this.nativeEvent;B&&(B.preventDefault?B.preventDefault():"unknown"!==typeof B.returnValue&&(B.returnValue=!1),this.isDefaultPrevented=Cg)},stopPropagation:function(){var B=this.nativeEvent;B&&(B.stopPropagation?B.stopPropagation():
"unknown"!==typeof B.cancelBubble&&(B.cancelBubble=!0),this.isPropagationStopped=Cg)},persist:function(){},isPersistent:Cg});return r}function Zh(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Zk[n])?!!r[n]:!1}function Pj(){return Zh}function oh(n,r){switch(n){case "keyup":return-1!==Dl.indexOf(r.keyCode);case "keydown":return 229!==r.keyCode;case "keypress":case "mousedown":case "focusout":return!0;default:return!1}}function Id(n){n=n.detail;return"object"===typeof n&&
"data"in n?n.data:null}function Xg(n,r){switch(n){case "compositionend":return Id(r);case "keypress":if(32!==r.which)return null;am=!0;return ln;case "textInput":return n=r.data,n===ln&&am?null:n;default:return null}}function tk(n,r){if(sj)return"compositionend"===n||!Ef&&oh(n,r)?(n=ri(),mg=si=Xi=null,sj=!1,n):null;switch(n){case "paste":return null;case "keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;
case "compositionend":return mn&&"ko"!==r.locale?null:r.data;default:return null}}function ph(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return"input"===r?!!hf[n.type]:"textarea"===r?!0:!1}function Dg(n,r,B,F){Pc(F);r=vd(r,"onChange");0<r.length&&(B=new El("onChange","change",null,B,F),n.push({event:B,listeners:r}))}function ti(n){Yg(n,0)}function ui(n){var r=Mf(n);if(lc(r))return n}function Yi(n,r){if("change"===n)return r}function Fl(){Qj&&(Qj.detachEvent("onpropertychange",Rj),ng=Qj=null)}
function Rj(n){if("value"===n.propertyName&&ui(ng)){var r=[];Dg(r,ng,n,Vc(n));pe(ti,r)}}function Tf(n,r,B){"focusin"===n?(Fl(),Qj=r,ng=B,Qj.attachEvent("onpropertychange",Rj)):"focusout"===n&&Fl()}function vi(n){if("selectionchange"===n||"keyup"===n||"keydown"===n)return ui(ng)}function tj(n,r){if("click"===n)return ui(r)}function Hh(n,r){if("input"===n||"change"===n)return ui(r)}function uk(n,r){return n===r&&(0!==n||1/n===1/r)||n!==n&&r!==r}function og(n,r){if(qh(n,r))return!0;if("object"!==typeof n||
null===n||"object"!==typeof r||null===r)return!1;var B=Object.keys(n),F=Object.keys(r);if(B.length!==F.length)return!1;for(F=0;F<B.length;F++){var Q=B[F];if(!ca.call(r,Q)||!qh(n[Q],r[Q]))return!1}return!0}function Uf(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function qd(n,r){var B=Uf(n);n=0;for(var F;B;){if(3===B.nodeType){F=n+B.textContent.length;if(n<=r&&F>=r)return{node:B,offset:r-n};n=F}a:{for(;B;){if(B.nextSibling){B=B.nextSibling;break a}B=B.parentNode}B=void 0}B=Uf(B)}}function rb(n,
r){return n&&r?n===r?!0:n&&3===n.nodeType?!1:r&&3===r.nodeType?rb(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Zi(){for(var n=window,r=bc();r instanceof n.HTMLIFrameElement;){try{var B="string"===typeof r.contentWindow.location.href}catch(F){B=!1}if(B)n=r.contentWindow;else break;r=bc(n.document)}return r}function Zg(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&("input"===r&&("text"===n.type||"search"===n.type||
"tel"===n.type||"url"===n.type||"password"===n.type)||"textarea"===r||"true"===n.contentEditable)}function Ih(n){var r=Zi(),B=n.focusedElem,F=n.selectionRange;if(r!==B&&B&&B.ownerDocument&&rb(B.ownerDocument.documentElement,B)){if(null!==F&&Zg(B))if(r=F.start,n=F.end,void 0===n&&(n=r),"selectionStart"in B)B.selectionStart=r,B.selectionEnd=Math.min(n,B.value.length);else if(n=(r=B.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var Q=B.textContent.length,V=Math.min(F.start,
Q);F=void 0===F.end?V:Math.min(F.end,Q);!n.extend&&V>F&&(Q=F,F=V,V=Q);Q=qd(B,V);var oa=qd(B,F);Q&&oa&&(1!==n.rangeCount||n.anchorNode!==Q.node||n.anchorOffset!==Q.offset||n.focusNode!==oa.node||n.focusOffset!==oa.offset)&&(r=r.createRange(),r.setStart(Q.node,Q.offset),n.removeAllRanges(),V>F?(n.addRange(r),n.extend(oa.node,oa.offset)):(r.setEnd(oa.node,oa.offset),n.addRange(r)))}r=[];for(n=B;n=n.parentNode;)1===n.nodeType&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});"function"===typeof B.focus&&
B.focus();for(B=0;B<r.length;B++)n=r[B],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}function wi(n,r,B){var F=B.window===B?B.document:9===B.nodeType?B:B.ownerDocument;$k||null==Sj||Sj!==bc(F)||(F=Sj,"selectionStart"in F&&Zg(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),vk&&og(vk,F)||(vk=F,F=vd(al,"onSelect"),
0<F.length&&(r=new El("onSelect","select",null,r,B),n.push({event:r,listeners:F}),r.target=Sj)))}function rh(n,r){var B={};B[n.toLowerCase()]=r.toLowerCase();B["Webkit"+n]="webkit"+r;B["Moz"+n]="moz"+r;return B}function yf(n){if(bl[n])return bl[n];if(!Tj[n])return n;var r=Tj[n],B;for(B in r)if(r.hasOwnProperty(B)&&B in Gl)return bl[n]=r[B];return n}function Jh(n,r){cl.set(n,r);qc(r,[n])}function uj(n,r,B){var F=n.type||"unknown-event";n.currentTarget=B;J(F,r,void 0,n);n.currentTarget=null}function Yg(n,
r){r=0!==(r&4);for(var B=0;B<n.length;B++){var F=n[B],Q=F.event;F=F.listeners;a:{var V=void 0;if(r)for(var oa=F.length-1;0<=oa;oa--){var Ia=F[oa],Ta=Ia.instance,tb=Ia.currentTarget;Ia=Ia.listener;if(Ta!==V&&Q.isPropagationStopped())break a;uj(Q,Ia,tb);V=Ta}else for(oa=0;oa<F.length;oa++){Ia=F[oa];Ta=Ia.instance;tb=Ia.currentTarget;Ia=Ia.listener;if(Ta!==V&&Q.isPropagationStopped())break a;uj(Q,Ia,tb);V=Ta}}}if(Dh)throw n=Fe,Dh=!1,Fe=null,n;}function Ud(n,r){var B=r[Hl];void 0===B&&(B=r[Hl]=new Set);
var F=n+"__bubble";B.has(F)||($h(r,n,2,!1),B.add(F))}function xi(n,r,B){var F=0;r&&(F|=4);$h(B,n,F,r)}function Eg(n){if(!n[wk]){n[wk]=!0;K.forEach(function(B){"selectionchange"!==B&&(bm.has(B)||xi(B,!1,n),xi(B,!0,n))});var r=9===n.nodeType?n:n.ownerDocument;null===r||r[wk]||(r[wk]=!0,xi("selectionchange",!1,r))}}function $h(n,r,B,F){switch(mh(r)){case 1:var Q=ok;break;case 4:Q=Nj;break;default:Q=qj}B=Q.bind(null,r,B,n);Q=void 0;!$i||"touchstart"!==r&&"touchmove"!==r&&"wheel"!==r||(Q=!0);F?void 0!==
Q?n.addEventListener(r,B,{capture:!0,passive:Q}):n.addEventListener(r,B,!0):void 0!==Q?n.addEventListener(r,B,{passive:Q}):n.addEventListener(r,B,!1)}function qk(n,r,B,F,Q){var V=F;if(0===(r&1)&&0===(r&2)&&null!==F)a:for(;;){if(null===F)return;var oa=F.tag;if(3===oa||4===oa){var Ia=F.stateNode.containerInfo;if(Ia===Q||8===Ia.nodeType&&Ia.parentNode===Q)break;if(4===oa)for(oa=F.return;null!==oa;){var Ta=oa.tag;if(3===Ta||4===Ta)if(Ta=oa.stateNode.containerInfo,Ta===Q||8===Ta.nodeType&&Ta.parentNode===
Q)return;oa=oa.return}for(;null!==Ia;){oa=kg(Ia);if(null===oa)return;Ta=oa.tag;if(5===Ta||6===Ta){F=V=oa;continue a}Ia=Ia.parentNode}}F=F.return}pe(function(){var tb=V,Zb=Vc(B),gc=[];a:{var Pb=cl.get(n);if(void 0!==Pb){var Ec=El,Oc=n;switch(n){case "keypress":if(0===Bg(B))break a;case "keydown":case "keyup":Ec=Cm;break;case "focusin":Oc="focus";Ec=aj;break;case "focusout":Oc="blur";Ec=aj;break;case "beforeblur":case "afterblur":Ec=aj;break;case "click":if(2===B.button)break a;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":Ec=
cm;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":Ec=dm;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":Ec=em;break;case dl:case el:case fm:Ec=gd;break;case Uj:Ec=Zc;break;case "scroll":Ec=gm;break;case "wheel":Ec=Sm;break;case "copy":case "cut":case "paste":Ec=Tm;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":Ec=
Vj}var Kc=0!==(r&4),Te=!Kc&&"scroll"===n,gb=Kc?null!==Pb?Pb+"Capture":null:Pb;Kc=[];for(var Xa=tb,nb;null!==Xa;){nb=Xa;var ac=nb.stateNode;5===nb.tag&&null!==ac&&(nb=ac,null!==gb&&(ac=qe(Xa,gb),null!=ac&&Kc.push(sh(Xa,ac,nb))));if(Te)break;Xa=Xa.return}0<Kc.length&&(Pb=new Ec(Pb,Oc,null,B,Zb),gc.push({event:Pb,listeners:Kc}))}}if(0===(r&7)){Pb="mouseover"===n||"pointerover"===n;Ec="mouseout"===n||"pointerout"===n;if(!Pb||B===we||!(Oc=B.relatedTarget||B.fromElement)||!kg(Oc)&&!Oc[bj])if(Ec||Pb){Pb=
Zb.window===Zb?Zb:(Pb=Zb.ownerDocument)?Pb.defaultView||Pb.parentWindow:window;if(Ec){if(Oc=B.relatedTarget||B.toElement,Ec=tb,Oc=Oc?kg(Oc):null,null!==Oc&&(Te=O(Oc),Oc!==Te||5!==Oc.tag&&6!==Oc.tag))Oc=null}else Ec=null,Oc=tb;if(Ec!==Oc){Kc=cm;ac="onMouseLeave";gb="onMouseEnter";Xa="mouse";if("pointerout"===n||"pointerover"===n)Kc=Vj,ac="onPointerLeave",gb="onPointerEnter",Xa="pointer";Te=null==Ec?Pb:Mf(Ec);nb=null==Oc?Pb:Mf(Oc);Pb=new Kc(ac,Xa+"leave",Ec,B,Zb);Pb.target=Te;Pb.relatedTarget=nb;ac=
null;kg(Zb)===tb&&(Kc=new Kc(gb,Xa+"enter",Oc,B,Zb),Kc.target=nb,Kc.relatedTarget=Te,ac=Kc);Te=ac;if(Ec&&Oc)b:{Kc=Ec;gb=Oc;Xa=0;for(nb=Kc;nb;nb=Fg(nb))Xa++;nb=0;for(ac=gb;ac;ac=Fg(ac))nb++;for(;0<Xa-nb;)Kc=Fg(Kc),Xa--;for(;0<nb-Xa;)gb=Fg(gb),nb--;for(;Xa--;){if(Kc===gb||null!==gb&&Kc===gb.alternate)break b;Kc=Fg(Kc);gb=Fg(gb)}Kc=null}else Kc=null;null!==Ec&&xk(gc,Pb,Ec,Kc,!1);null!==Oc&&null!==Te&&xk(gc,Te,Oc,Kc,!0)}}Pb=tb?Mf(tb):window;Ec=Pb.nodeName&&Pb.nodeName.toLowerCase();if("select"===Ec||
"input"===Ec&&"file"===Pb.type)var Qc=Yi;else if(ph(Pb))if(fl)Qc=Hh;else{Qc=vi;var jd=Tf}else(Ec=Pb.nodeName)&&"input"===Ec.toLowerCase()&&("checkbox"===Pb.type||"radio"===Pb.type)&&(Qc=tj);Qc&&(Qc=Qc(n,tb))?Dg(gc,Qc,B,Zb):(jd&&jd(n,Pb,tb),"focusout"===n&&(jd=Pb._wrapperState)&&jd.controlled&&"number"===Pb.type&&dc(Pb,"number",Pb.value));jd=tb?Mf(tb):window;switch(n){case "focusin":if(ph(jd)||"true"===jd.contentEditable)Sj=jd,al=tb,vk=null;break;case "focusout":vk=al=Sj=null;break;case "mousedown":$k=
!0;break;case "contextmenu":case "mouseup":case "dragend":$k=!1;wi(gc,B,Zb);break;case "selectionchange":if(hm)break;case "keydown":case "keyup":wi(gc,B,Zb)}var hd;if(Ef)a:{switch(n){case "compositionstart":var rd="onCompositionStart";break a;case "compositionend":rd="onCompositionEnd";break a;case "compositionupdate":rd="onCompositionUpdate";break a}rd=void 0}else sj?oh(n,B)&&(rd="onCompositionEnd"):"keydown"===n&&229===B.keyCode&&(rd="onCompositionStart");rd&&(mn&&"ko"!==B.locale&&(sj||"onCompositionStart"!==
rd?"onCompositionEnd"===rd&&sj&&(hd=ri()):(Xi=Zb,si="value"in Xi?Xi.value:Xi.textContent,sj=!0)),jd=vd(tb,rd),0<jd.length&&(rd=new yi(rd,n,null,B,Zb),gc.push({event:rd,listeners:jd}),hd?rd.data=hd:(hd=Id(B),null!==hd&&(rd.data=hd))));if(hd=Um?Xg(n,B):tk(n,B))tb=vd(tb,"onBeforeInput"),0<tb.length&&(Zb=new yi("onBeforeInput","beforeinput",null,B,Zb),gc.push({event:Zb,listeners:tb}),Zb.data=hd)}Yg(gc,r)})}function sh(n,r,B){return{instance:n,listener:r,currentTarget:B}}function vd(n,r){for(var B=r+"Capture",
F=[];null!==n;){var Q=n,V=Q.stateNode;5===Q.tag&&null!==V&&(Q=V,V=qe(n,B),null!=V&&F.unshift(sh(n,V,Q)),V=qe(n,r),null!=V&&F.push(sh(n,V,Q)));n=n.return}return F}function Fg(n){if(null===n)return null;do n=n.return;while(n&&5!==n.tag);return n?n:null}function xk(n,r,B,F,Q){for(var V=r._reactName,oa=[];null!==B&&B!==F;){var Ia=B,Ta=Ia.alternate,tb=Ia.stateNode;if(null!==Ta&&Ta===F)break;5===Ia.tag&&null!==tb&&(Ia=tb,Q?(Ta=qe(B,V),null!=Ta&&oa.unshift(sh(B,Ta,Ia))):Q||(Ta=qe(B,V),null!=Ta&&oa.push(sh(B,
Ta,Ia))));B=B.return}0!==oa.length&&n.push({event:r,listeners:oa})}function Vf(n){return("string"===typeof n?n:""+n).replace(Dm,"\n").replace(im,"")}function pg(n,r,B){r=Vf(r);if(Vf(n)!==r&&B)throw Error(Na(425));}function zi(){}function qf(n,r){return"textarea"===n||"noscript"===n||"string"===typeof r.children||"number"===typeof r.children||"object"===typeof r.dangerouslySetInnerHTML&&null!==r.dangerouslySetInnerHTML&&null!=r.dangerouslySetInnerHTML.__html}function Ai(n){setTimeout(function(){throw n;
})}function Gg(n,r){var B=r,F=0;do{var Q=B.nextSibling;n.removeChild(B);if(Q&&8===Q.nodeType)if(B=Q.data,"/$"===B){if(0===F){n.removeChild(Q);Eh(r);return}F--}else"$"!==B&&"$?"!==B&&"$!"!==B||F++;B=Q}while(B);Eh(r)}function Ff(n){for(;null!=n;n=n.nextSibling){var r=n.nodeType;if(1===r||3===r)break;if(8===r){r=n.data;if("$"===r||"$!"===r||"$?"===r)break;if("/$"===r)return null}}return n}function qg(n){n=n.previousSibling;for(var r=0;n;){if(8===n.nodeType){var B=n.data;if("$"===B||"$!"===B||"$?"===
B){if(0===r)return n;r--}else"/$"===B&&r++}n=n.previousSibling}return null}function kg(n){var r=n[ai];if(r)return r;for(var B=n.parentNode;B;){if(r=B[bj]||B[ai]){B=r.alternate;if(null!==r.child||null!==B&&null!==B.child)for(n=qg(n);null!==n;){if(B=n[ai])return B;n=qg(n)}return r}n=B;B=n.parentNode}return null}function Td(n){n=n[ai]||n[bj];return!n||5!==n.tag&&6!==n.tag&&13!==n.tag&&3!==n.tag?null:n}function Mf(n){if(5===n.tag||6===n.tag)return n.stateNode;throw Error(Na(33));}function Ee(n){return n[gl]||
null}function zf(n){return{current:n}}function $c(n){0>yk||(n.current=Il[yk],Il[yk]=null,yk--)}function Zd(n,r){yk++;Il[yk]=n.current;n.current=r}function Wf(n,r){var B=n.type.contextTypes;if(!B)return Wj;var F=n.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===r)return F.__reactInternalMemoizedMaskedChildContext;var Q={},V;for(V in B)Q[V]=r[V];F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=Q);return Q}function Vd(n){n=
n.childContextTypes;return null!==n&&void 0!==n}function jf(){$c($g);$c(Hg)}function bi(n,r,B){if(Hg.current!==Wj)throw Error(Na(168));Zd(Hg,r);Zd($g,B)}function Xj(n,r,B){var F=n.stateNode;r=r.childContextTypes;if("function"!==typeof F.getChildContext)return B;F=F.getChildContext();for(var Q in F)if(!(Q in r))throw Error(Na(108,Pa(n)||"Unknown",Q));return md({},B,F)}function ci(n){n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Wj;zk=Hg.current;Zd(Hg,n);Zd($g,$g.current);return!0}
function di(n,r,B){var F=n.stateNode;if(!F)throw Error(Na(169));B?(n=Xj(n,r,zk),F.__reactInternalMemoizedMergedChildContext=n,$c($g),$c(Hg),Zd(Hg,n)):$c($g);Zd($g,B)}function vj(n){null===ah?ah=[n]:ah.push(n)}function Od(n){hl=!0;vj(n)}function Nf(){if(!Em&&null!==ah){Em=!0;var n=0,r=se;try{var B=ah;for(se=1;n<B.length;n++){var F=B[n];do F=F(!0);while(null!==F)}ah=null;hl=!1}catch(Q){throw null!==ah&&(ah=ah.slice(n+1)),rg(nh,Nf),Q;}finally{se=r,Em=!1}}return null}function Ue(n,r){il[Ve++]=jm;il[Ve++]=
km;km=n;jm=r}function th(n,r,B){Kh[ei++]=Lh;Kh[ei++]=Bi;Kh[ei++]=Ci;Ci=n;var F=Lh;n=Bi;var Q=32-oi(F)-1;F&=~(1<<Q);B+=1;var V=32-oi(r)+Q;if(30<V){var oa=Q-Q%5;V=(F&(1<<oa)-1).toString(32);F>>=oa;Q-=oa;Lh=1<<32-oi(r)+Q|B<<Q|F;Bi=V+n}else Lh=1<<V|B<<Q|F,Bi=n}function Di(n){null!==n.return&&(Ue(n,1),th(n,1,0))}function cj(n){for(;n===km;)km=il[--Ve],il[Ve]=null,jm=il[--Ve],il[Ve]=null;for(;n===Ci;)Ci=Kh[--ei],Kh[ei]=null,Bi=Kh[--ei],Kh[ei]=null,Lh=Kh[--ei],Kh[ei]=null}function Af(n,r){var B=Of(5,null,
null,0);B.elementType="DELETED";B.stateNode=r;B.return=n;r=n.deletions;null===r?(n.deletions=[B],n.flags|=16):r.push(B)}function Ei(n,r){switch(n.tag){case 5:var B=n.type;r=1!==r.nodeType||B.toLowerCase()!==r.nodeName.toLowerCase()?null:r;return null!==r?(n.stateNode=r,uh=n,rf=Ff(r.firstChild),!0):!1;case 6:return r=""===n.pendingProps||3!==r.nodeType?null:r,null!==r?(n.stateNode=r,uh=n,rf=null,!0):!1;case 13:return r=8!==r.nodeType?null:r,null!==r?(B=null!==Ci?{id:Lh,overflow:Bi}:null,n.memoizedState=
{dehydrated:r,treeContext:B,retryLane:1073741824},B=Of(18,null,null,0),B.stateNode=r,B.return=n,n.child=B,uh=n,rf=null,!0):!1;default:return!1}}function Gf(n){return 0!==(n.mode&1)&&0===(n.flags&128)}function Xf(n){if(he){var r=rf;if(r){var B=r;if(!Ei(n,r)){if(Gf(n))throw Error(Na(418));r=Ff(B.nextSibling);var F=uh;r&&Ei(n,r)?Af(F,B):(n.flags=n.flags&-4097|2,he=!1,uh=n)}}else{if(Gf(n))throw Error(Na(418));n.flags=n.flags&-4097|2;he=!1;uh=n}}}function wj(n){for(n=n.return;null!==n&&5!==n.tag&&3!==
n.tag&&13!==n.tag;)n=n.return;uh=n}function Yf(n){if(n!==uh)return!1;if(!he)return wj(n),he=!0,!1;var r;(r=3!==n.tag)&&!(r=5!==n.tag)&&(r=n.type,r="head"!==r&&"body"!==r&&!qf(n.type,n.memoizedProps));if(r&&(r=rf)){if(Gf(n))throw Ge(),Error(Na(418));for(;r;)Af(n,r),r=Ff(r.nextSibling)}wj(n);if(13===n.tag){n=n.memoizedState;n=null!==n?n.dehydrated:null;if(!n)throw Error(Na(317));a:{n=n.nextSibling;for(r=0;n;){if(8===n.nodeType){var B=n.data;if("/$"===B){if(0===r){rf=Ff(n.nextSibling);break a}r--}else"$"!==
B&&"$!"!==B&&"$?"!==B||r++}n=n.nextSibling}rf=null}}else rf=uh?Ff(n.stateNode.nextSibling):null;return!0}function Ge(){for(var n=rf;n;)n=Ff(n.nextSibling)}function Bf(){rf=uh=null;he=!1}function Ne(n){null===vh?vh=[n]:vh.push(n)}function Ig(n,r,B){n=B.ref;if(null!==n&&"function"!==typeof n&&"object"!==typeof n){if(B._owner){if(B=B._owner){if(1!==B.tag)throw Error(Na(309));var F=B.stateNode}if(!F)throw Error(Na(147,n));var Q=F,V=""+n;if(null!==r&&null!==r.ref&&"function"===typeof r.ref&&r.ref._stringRef===
V)return r.ref;r=function(oa){var Ia=Q.refs;null===oa?delete Ia[V]:Ia[V]=oa};r._stringRef=V;return r}if("string"!==typeof n)throw Error(Na(284));if(!B._owner)throw Error(Na(290,n));}return n}function Jg(n,r){n=Object.prototype.toString.call(r);throw Error(Na(31,"[object Object]"===n?"object with keys {"+Object.keys(r).join(", ")+"}":n));}function bh(n){var r=n._init;return r(n._payload)}function jl(n){function r(gb,Xa){if(n){var nb=gb.deletions;null===nb?(gb.deletions=[Xa],gb.flags|=16):nb.push(Xa)}}
function B(gb,Xa){if(!n)return null;for(;null!==Xa;)r(gb,Xa),Xa=Xa.sibling;return null}function F(gb,Xa){for(gb=new Map;null!==Xa;)null!==Xa.key?gb.set(Xa.key,Xa):gb.set(Xa.index,Xa),Xa=Xa.sibling;return gb}function Q(gb,Xa){gb=Cf(gb,Xa);gb.index=0;gb.sibling=null;return gb}function V(gb,Xa,nb){gb.index=nb;if(!n)return gb.flags|=1048576,Xa;nb=gb.alternate;if(null!==nb)return nb=nb.index,nb<Xa?(gb.flags|=2,Xa):nb;gb.flags|=2;return Xa}function oa(gb){n&&null===gb.alternate&&(gb.flags|=2);return gb}
function Ia(gb,Xa,nb,ac){if(null===Xa||6!==Xa.tag)return Xa=Ak(nb,gb.mode,ac),Xa.return=gb,Xa;Xa=Q(Xa,nb);Xa.return=gb;return Xa}function Ta(gb,Xa,nb,ac){var Qc=nb.type;if(Qc===Za)return Zb(gb,Xa,nb.props.children,ac,nb.key);if(null!==Xa&&(Xa.elementType===Qc||"object"===typeof Qc&&null!==Qc&&Qc.$$typeof===vc&&bh(Qc)===Xa.type))return ac=Q(Xa,nb.props),ac.ref=Ig(gb,Xa,nb),ac.return=gb,ac;ac=Uc(nb.type,nb.key,nb.props,null,gb.mode,ac);ac.ref=Ig(gb,Xa,nb);ac.return=gb;return ac}function tb(gb,Xa,nb,
ac){if(null===Xa||4!==Xa.tag||Xa.stateNode.containerInfo!==nb.containerInfo||Xa.stateNode.implementation!==nb.implementation)return Xa=Kg(nb,gb.mode,ac),Xa.return=gb,Xa;Xa=Q(Xa,nb.children||[]);Xa.return=gb;return Xa}function Zb(gb,Xa,nb,ac,Qc){if(null===Xa||7!==Xa.tag)return Xa=oc(nb,gb.mode,ac,Qc),Xa.return=gb,Xa;Xa=Q(Xa,nb);Xa.return=gb;return Xa}function gc(gb,Xa,nb){if("string"===typeof Xa&&""!==Xa||"number"===typeof Xa)return Xa=Ak(""+Xa,gb.mode,nb),Xa.return=gb,Xa;if("object"===typeof Xa&&
null!==Xa){switch(Xa.$$typeof){case Ea:return nb=Uc(Xa.type,Xa.key,Xa.props,null,gb.mode,nb),nb.ref=Ig(gb,null,Xa),nb.return=gb,nb;case Qa:return Xa=Kg(Xa,gb.mode,nb),Xa.return=gb,Xa;case vc:var ac=Xa._init;return gc(gb,ac(Xa._payload),nb)}if(ud(Xa)||Sb(Xa))return Xa=oc(Xa,gb.mode,nb,null),Xa.return=gb,Xa;Jg(gb,Xa)}return null}function Pb(gb,Xa,nb,ac){var Qc=null!==Xa?Xa.key:null;if("string"===typeof nb&&""!==nb||"number"===typeof nb)return null!==Qc?null:Ia(gb,Xa,""+nb,ac);if("object"===typeof nb&&
null!==nb){switch(nb.$$typeof){case Ea:return nb.key===Qc?Ta(gb,Xa,nb,ac):null;case Qa:return nb.key===Qc?tb(gb,Xa,nb,ac):null;case vc:return Qc=nb._init,Pb(gb,Xa,Qc(nb._payload),ac)}if(ud(nb)||Sb(nb))return null!==Qc?null:Zb(gb,Xa,nb,ac,null);Jg(gb,nb)}return null}function Ec(gb,Xa,nb,ac,Qc){if("string"===typeof ac&&""!==ac||"number"===typeof ac)return gb=gb.get(nb)||null,Ia(Xa,gb,""+ac,Qc);if("object"===typeof ac&&null!==ac){switch(ac.$$typeof){case Ea:return gb=gb.get(null===ac.key?nb:ac.key)||
null,Ta(Xa,gb,ac,Qc);case Qa:return gb=gb.get(null===ac.key?nb:ac.key)||null,tb(Xa,gb,ac,Qc);case vc:var jd=ac._init;return Ec(gb,Xa,nb,jd(ac._payload),Qc)}if(ud(ac)||Sb(ac))return gb=gb.get(nb)||null,Zb(Xa,gb,ac,Qc,null);Jg(Xa,ac)}return null}function Oc(gb,Xa,nb,ac){for(var Qc=null,jd=null,hd=Xa,rd=Xa=0,We=null;null!==hd&&rd<nb.length;rd++){hd.index>rd?(We=hd,hd=null):We=hd.sibling;var Wd=Pb(gb,hd,nb[rd],ac);if(null===Wd){null===hd&&(hd=We);break}n&&hd&&null===Wd.alternate&&r(gb,hd);Xa=V(Wd,Xa,
rd);null===jd?Qc=Wd:jd.sibling=Wd;jd=Wd;hd=We}if(rd===nb.length)return B(gb,hd),he&&Ue(gb,rd),Qc;if(null===hd){for(;rd<nb.length;rd++)hd=gc(gb,nb[rd],ac),null!==hd&&(Xa=V(hd,Xa,rd),null===jd?Qc=hd:jd.sibling=hd,jd=hd);he&&Ue(gb,rd);return Qc}for(hd=F(gb,hd);rd<nb.length;rd++)We=Ec(hd,gb,rd,nb[rd],ac),null!==We&&(n&&null!==We.alternate&&hd.delete(null===We.key?rd:We.key),Xa=V(We,Xa,rd),null===jd?Qc=We:jd.sibling=We,jd=We);n&&hd.forEach(function(dj){return r(gb,dj)});he&&Ue(gb,rd);return Qc}function Kc(gb,
Xa,nb,ac){var Qc=Sb(nb);if("function"!==typeof Qc)throw Error(Na(150));nb=Qc.call(nb);if(null==nb)throw Error(Na(151));for(var jd=Qc=null,hd=Xa,rd=Xa=0,We=null,Wd=nb.next();null!==hd&&!Wd.done;rd++,Wd=nb.next()){hd.index>rd?(We=hd,hd=null):We=hd.sibling;var dj=Pb(gb,hd,Wd.value,ac);if(null===dj){null===hd&&(hd=We);break}n&&hd&&null===dj.alternate&&r(gb,hd);Xa=V(dj,Xa,rd);null===jd?Qc=dj:jd.sibling=dj;jd=dj;hd=We}if(Wd.done)return B(gb,hd),he&&Ue(gb,rd),Qc;if(null===hd){for(;!Wd.done;rd++,Wd=nb.next())Wd=
gc(gb,Wd.value,ac),null!==Wd&&(Xa=V(Wd,Xa,rd),null===jd?Qc=Wd:jd.sibling=Wd,jd=Wd);he&&Ue(gb,rd);return Qc}for(hd=F(gb,hd);!Wd.done;rd++,Wd=nb.next())Wd=Ec(hd,gb,rd,Wd.value,ac),null!==Wd&&(n&&null!==Wd.alternate&&hd.delete(null===Wd.key?rd:Wd.key),Xa=V(Wd,Xa,rd),null===jd?Qc=Wd:jd.sibling=Wd,jd=Wd);n&&hd.forEach(function(Pd){return r(gb,Pd)});he&&Ue(gb,rd);return Qc}function Te(gb,Xa,nb,ac){"object"===typeof nb&&null!==nb&&nb.type===Za&&null===nb.key&&(nb=nb.props.children);if("object"===typeof nb&&
null!==nb){switch(nb.$$typeof){case Ea:a:{for(var Qc=nb.key,jd=Xa;null!==jd;){if(jd.key===Qc){Qc=nb.type;if(Qc===Za){if(7===jd.tag){B(gb,jd.sibling);Xa=Q(jd,nb.props.children);Xa.return=gb;gb=Xa;break a}}else if(jd.elementType===Qc||"object"===typeof Qc&&null!==Qc&&Qc.$$typeof===vc&&bh(Qc)===jd.type){B(gb,jd.sibling);Xa=Q(jd,nb.props);Xa.ref=Ig(gb,jd,nb);Xa.return=gb;gb=Xa;break a}B(gb,jd);break}else r(gb,jd);jd=jd.sibling}nb.type===Za?(Xa=oc(nb.props.children,gb.mode,ac,nb.key),Xa.return=gb,gb=Xa):
(ac=Uc(nb.type,nb.key,nb.props,null,gb.mode,ac),ac.ref=Ig(gb,Xa,nb),ac.return=gb,gb=ac)}return oa(gb);case Qa:a:{for(jd=nb.key;null!==Xa;){if(Xa.key===jd)if(4===Xa.tag&&Xa.stateNode.containerInfo===nb.containerInfo&&Xa.stateNode.implementation===nb.implementation){B(gb,Xa.sibling);Xa=Q(Xa,nb.children||[]);Xa.return=gb;gb=Xa;break a}else{B(gb,Xa);break}else r(gb,Xa);Xa=Xa.sibling}Xa=Kg(nb,gb.mode,ac);Xa.return=gb;gb=Xa}return oa(gb);case vc:return jd=nb._init,Te(gb,Xa,jd(nb._payload),ac)}if(ud(nb))return Oc(gb,
Xa,nb,ac);if(Sb(nb))return Kc(gb,Xa,nb,ac);Jg(gb,nb)}return"string"===typeof nb&&""!==nb||"number"===typeof nb?(nb=""+nb,null!==Xa&&6===Xa.tag?(B(gb,Xa.sibling),Xa=Q(Xa,nb),Xa.return=gb,gb=Xa):(B(gb,Xa),Xa=Ak(nb,gb.mode,ac),Xa.return=gb,gb=Xa),oa(gb)):B(gb,Xa)}return Te}function Lb(n){var r=ej.current;$c(ej);n._currentValue=r}function nd(n,r,B){for(;null!==n;){var F=n.alternate;(n.childLanes&r)!==r?(n.childLanes|=r,null!==F&&(F.childLanes|=r)):null!==F&&(F.childLanes&r)!==r&&(F.childLanes|=r);if(n===
B)break;n=n.return}}function ue(n,r){xj=n;Zf=ch=null;n=n.dependencies;null!==n&&null!==n.firstContext&&(0!==(n.lanes&r)&&(dh=!0),n.firstContext=null)}function Xe(n){var r=n._currentValue;if(Zf!==n)if(n={context:n,memoizedValue:r,next:null},null===ch){if(null===xj)throw Error(Na(308));ch=n;xj.dependencies={lanes:0,firstContext:n}}else ch=ch.next=n;return r}function hc(n){null===Lg?Lg=[n]:Lg.push(n)}function kf(n,r,B,F){var Q=r.interleaved;null===Q?(B.next=B,hc(r)):(B.next=Q.next,Q.next=B);r.interleaved=
B;return Ed(n,F)}function Ed(n,r){n.lanes|=r;var B=n.alternate;null!==B&&(B.lanes|=r);B=n;for(n=n.return;null!==n;)n.childLanes|=r,B=n.alternate,null!==B&&(B.childLanes|=r),B=n,n=n.return;return 3===B.tag?B.stateNode:null}function sg(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function He(n,r){n=n.updateQueue;r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,
lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Eb(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function Cb(n,r,B){var F=n.updateQueue;if(null===F)return null;F=F.shared;if(0!==($d&2)){var Q=F.pending;null===Q?r.next=r:(r.next=Q.next,Q.next=r);F.pending=r;return Ed(n,B)}Q=F.interleaved;null===Q?(r.next=r,hc(F)):(r.next=Q.next,Q.next=r);F.interleaved=r;return Ed(n,B)}function kd(n,r,B){r=r.updateQueue;if(null!==r&&(r=r.shared,0!==(B&4194240))){var F=
r.lanes;F&=n.pendingLanes;B|=F;r.lanes=B;Hd(n,B)}}function $f(n,r){var B=n.updateQueue,F=n.alternate;if(null!==F&&(F=F.updateQueue,B===F)){var Q=null,V=null;B=B.firstBaseUpdate;if(null!==B){do{var oa={eventTime:B.eventTime,lane:B.lane,tag:B.tag,payload:B.payload,callback:B.callback,next:null};null===V?Q=V=oa:V=V.next=oa;B=B.next}while(null!==B);null===V?Q=V=r:V=V.next=r}else Q=V=r;B={baseState:F.baseState,firstBaseUpdate:Q,lastBaseUpdate:V,shared:F.shared,effects:F.effects};n.updateQueue=B}else n=
B.lastBaseUpdate,null===n?B.firstBaseUpdate=r:n.next=r,B.lastBaseUpdate=r}function sf(n,r,B,F){var Q=n.updateQueue;ag=!1;var V=Q.firstBaseUpdate,oa=Q.lastBaseUpdate,Ia=Q.shared.pending;if(null!==Ia){Q.shared.pending=null;var Ta=Ia,tb=Ta.next;Ta.next=null;null===oa?V=tb:oa.next=tb;var Zb=n.alternate;null!==Zb&&(Zb=Zb.updateQueue,Ia=Zb.lastBaseUpdate,Ia!==Ta&&(null===Ia?Zb.firstBaseUpdate=tb:Ia.next=tb,Zb.lastBaseUpdate=Ta))}if(null!==V){var gc=Q.baseState;oa=0;Zb=tb=Ta=null;Ia=V;do{var Pb=Ia.lane,
Ec=Ia.eventTime;if((F&Pb)===Pb){null!==Zb&&(Zb=Zb.next={eventTime:Ec,lane:0,tag:Ia.tag,payload:Ia.payload,callback:Ia.callback,next:null});a:{var Oc=n,Kc=Ia;Pb=r;Ec=B;switch(Kc.tag){case 1:Oc=Kc.payload;if("function"===typeof Oc){gc=Oc.call(Ec,gc,Pb);break a}gc=Oc;break a;case 3:Oc.flags=Oc.flags&-65537|128;case 0:Oc=Kc.payload;Pb="function"===typeof Oc?Oc.call(Ec,gc,Pb):Oc;if(null===Pb||void 0===Pb)break a;gc=md({},gc,Pb);break a;case 2:ag=!0}}null!==Ia.callback&&0!==Ia.lane&&(n.flags|=64,Pb=Q.effects,
null===Pb?Q.effects=[Ia]:Pb.push(Ia))}else Ec={eventTime:Ec,lane:Pb,tag:Ia.tag,payload:Ia.payload,callback:Ia.callback,next:null},null===Zb?(tb=Zb=Ec,Ta=gc):Zb=Zb.next=Ec,oa|=Pb;Ia=Ia.next;if(null===Ia)if(Ia=Q.shared.pending,null===Ia)break;else Pb=Ia,Ia=Pb.next,Pb.next=null,Q.lastBaseUpdate=Pb,Q.shared.pending=null}while(1);null===Zb&&(Ta=gc);Q.baseState=Ta;Q.firstBaseUpdate=tb;Q.lastBaseUpdate=Zb;r=Q.shared.interleaved;if(null!==r){Q=r;do oa|=Q.lane,Q=Q.next;while(Q!==r)}else null===V&&(Q.shared.lanes=
0);kl|=oa;n.lanes=oa;n.memoizedState=gc}}function ld(n,r,B){n=r.effects;r.effects=null;if(null!==n)for(r=0;r<n.length;r++){var F=n[r],Q=F.callback;if(null!==Q){F.callback=null;F=B;if("function"!==typeof Q)throw Error(Na(191,Q));Q.call(F)}}}function Ld(n){if(n===Ye)throw Error(Na(174));return n}function yd(n,r){Zd(Mh,r);Zd(Jl,n);Zd(bg,Ye);n=r.nodeType;switch(n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Ma(null,"");break;default:n=8===n?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,
r=Ma(r,n)}$c(bg);Zd(bg,r)}function Md(){$c(bg);$c(Jl);$c(Mh)}function dd(n){Ld(Mh.current);var r=Ld(bg.current),B=Ma(r,n.type);r!==B&&(Zd(Jl,n),Zd(bg,B))}function ed(n){Jl.current===n&&($c(bg),$c(Jl))}function Jd(n){for(var r=n;null!==r;){if(13===r.tag){var B=r.memoizedState;if(null!==B&&(B=B.dehydrated,null===B||"$?"===B.data||"$!"===B.data))return r}else if(19===r.tag&&void 0!==r.memoizedProps.revealOrder){if(0!==(r.flags&128))return r}else if(null!==r.child){r.child.return=r;r=r.child;continue}if(r===
n)break;for(;null===r.sibling;){if(null===r.return||r.return===n)return null;r=r.return}r.sibling.return=r.return;r=r.sibling}return null}function ee(){for(var n=0;n<lm.length;n++)lm[n]._workInProgressVersionPrimary=null;lm.length=0}function Ie(){throw Error(Na(321));}function Ze(n,r){if(null===r)return!1;for(var B=0;B<r.length&&B<n.length;B++)if(!qh(n[B],r[B]))return!1;return!0}function Da(n,r,B,F,Q,V){Bk=V;xe=r;r.memoizedState=null;r.updateQueue=null;r.lanes=0;Yj.current=null===n||null===n.memoizedState?
nn:Vm;n=B(F,Q);if(ll){V=0;do{ll=!1;Kl=0;if(25<=V)throw Error(Na(301));V+=1;cg=Oe=null;r.updateQueue=null;Yj.current=mm;n=B(F,Q)}while(ll)}Yj.current=Mg;r=null!==Oe&&null!==Oe.next;Bk=0;cg=Oe=xe=null;ml=!1;if(r)throw Error(Na(300));return n}function Fi(){var n=0!==Kl;Kl=0;return n}function tg(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===cg?xe.memoizedState=cg=n:cg=cg.next=n;return cg}function fe(){if(null===Oe){var n=xe.alternate;n=null!==n?n.memoizedState:
null}else n=Oe.next;var r=null===cg?xe.memoizedState:cg.next;if(null!==r)cg=r,Oe=n;else{if(null===n)throw Error(Na(310));Oe=n;n={memoizedState:Oe.memoizedState,baseState:Oe.baseState,baseQueue:Oe.baseQueue,queue:Oe.queue,next:null};null===cg?xe.memoizedState=cg=n:cg=cg.next=n}return cg}function Ad(n,r){return"function"===typeof r?r(n):r}function ye(n){var r=fe(),B=r.queue;if(null===B)throw Error(Na(311));B.lastRenderedReducer=n;var F=Oe,Q=F.baseQueue,V=B.pending;if(null!==V){if(null!==Q){var oa=Q.next;
Q.next=V.next;V.next=oa}F.baseQueue=Q=V;B.pending=null}if(null!==Q){V=Q.next;F=F.baseState;var Ia=oa=null,Ta=null,tb=V;do{var Zb=tb.lane;if((Bk&Zb)===Zb)null!==Ta&&(Ta=Ta.next={lane:0,action:tb.action,hasEagerState:tb.hasEagerState,eagerState:tb.eagerState,next:null}),F=tb.hasEagerState?tb.eagerState:n(F,tb.action);else{var gc={lane:Zb,action:tb.action,hasEagerState:tb.hasEagerState,eagerState:tb.eagerState,next:null};null===Ta?(Ia=Ta=gc,oa=F):Ta=Ta.next=gc;xe.lanes|=Zb;kl|=Zb}tb=tb.next}while(null!==
tb&&tb!==V);null===Ta?oa=F:Ta.next=Ia;qh(F,r.memoizedState)||(dh=!0);r.memoizedState=F;r.baseState=oa;r.baseQueue=Ta;B.lastRenderedState=F}n=B.interleaved;if(null!==n){Q=n;do V=Q.lane,xe.lanes|=V,kl|=V,Q=Q.next;while(Q!==n)}else null===Q&&(B.lanes=0);return[r.memoizedState,B.dispatch]}function dg(n){var r=fe(),B=r.queue;if(null===B)throw Error(Na(311));B.lastRenderedReducer=n;var F=B.dispatch,Q=B.pending,V=r.memoizedState;if(null!==Q){B.pending=null;var oa=Q=Q.next;do V=n(V,oa.action),oa=oa.next;
while(oa!==Q);qh(V,r.memoizedState)||(dh=!0);r.memoizedState=V;null===r.baseQueue&&(r.baseState=V);B.lastRenderedState=V}return[V,F]}function tf(){}function Ce(n,r){var B=xe,F=fe(),Q=r(),V=!qh(F.memoizedState,Q);V&&(F.memoizedState=Q,dh=!0);F=F.queue;$e(Pe.bind(null,B,F,n),[n]);if(F.getSnapshot!==r||V||null!==cg&&cg.memoizedState.tag&1){B.flags|=2048;Qe(9,af.bind(null,B,F,Q,r),void 0,null);if(null===Pf)throw Error(Na(349));0!==(Bk&30)||Hf(B,r,Q)}return Q}function Hf(n,r,B){n.flags|=16384;n={getSnapshot:r,
value:B};r=xe.updateQueue;null===r?(r={lastEffect:null,stores:null},xe.updateQueue=r,r.stores=[n]):(B=r.stores,null===B?r.stores=[n]:B.push(n))}function af(n,r,B,F){r.value=B;r.getSnapshot=F;ug(r)&&ge(n)}function Pe(n,r,B){return B(function(){ug(r)&&ge(n)})}function ug(n){var r=n.getSnapshot;n=n.value;try{var B=r();return!qh(n,B)}catch(F){return!0}}function ge(n){var r=Ed(n,1);null!==r&&Xd(r,n,1,-1)}function Ng(n){var r=tg();"function"===typeof n&&(n=n());r.memoizedState=r.baseState=n;n={pending:null,
interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ad,lastRenderedState:n};r.queue=n;n=n.dispatch=fj.bind(null,xe,n);return[r.memoizedState,n]}function Qe(n,r,B,F){n={tag:n,create:r,destroy:B,deps:F,next:null};r=xe.updateQueue;null===r?(r={lastEffect:null,stores:null},xe.updateQueue=r,r.lastEffect=n.next=n):(B=r.lastEffect,null===B?r.lastEffect=n.next=n:(F=B.next,B.next=n,n.next=F,r.lastEffect=n));return n}function eh(){return fe().memoizedState}function Og(n,r,B,F){var Q=tg();xe.flags|=n;
Q.memoizedState=Qe(1|r,B,void 0,void 0===F?null:F)}function fi(n,r,B,F){var Q=fe();F=void 0===F?null:F;var V=void 0;if(null!==Oe){var oa=Oe.memoizedState;V=oa.destroy;if(null!==F&&Ze(F,oa.deps)){Q.memoizedState=Qe(r,B,V,F);return}}xe.flags|=n;Q.memoizedState=Qe(1|r,B,V,F)}function yj(n,r){return Og(8390656,8,n,r)}function $e(n,r){return fi(2048,8,n,r)}function Pg(n,r){return fi(4,2,n,r)}function Gi(n,r){return fi(4,4,n,r)}function Hi(n,r){if("function"===typeof r)return n=n(),r(n),function(){r(null)};
if(null!==r&&void 0!==r)return n=n(),r.current=n,function(){r.current=null}}function eg(n,r,B){B=null!==B&&void 0!==B?B.concat([n]):null;return fi(4,4,Hi.bind(null,r,n),B)}function gi(){}function hi(n,r){var B=fe();r=void 0===r?null:r;var F=B.memoizedState;if(null!==F&&null!==r&&Ze(r,F[1]))return F[0];B.memoizedState=[n,r];return n}function zj(n,r){var B=fe();r=void 0===r?null:r;var F=B.memoizedState;if(null!==F&&null!==r&&Ze(r,F[1]))return F[0];n=n();B.memoizedState=[n,r];return n}function wh(n,
r,B){if(0===(Bk&21))return n.baseState&&(n.baseState=!1,dh=!0),n.memoizedState=B;qh(B,r)||(B=kc(),xe.lanes|=B,kl|=B,n.baseState=!0);return r}function Wc(n,r){var B=se;se=0!==B&&4>B?B:4;n(!0);var F=nm.transition;nm.transition={};try{n(!1),r()}finally{se=B,nm.transition=F}}function xh(){return fe().memoizedState}function Re(n,r,B){var F=fg(n);B={lane:F,action:B,hasEagerState:!1,eagerState:null,next:null};if(zd(n))lf(r,B);else if(B=kf(n,r,B,F),null!==B){var Q=ve();Xd(B,n,F,Q);Ii(B,r,F)}}function fj(n,
r,B){var F=fg(n),Q={lane:F,action:B,hasEagerState:!1,eagerState:null,next:null};if(zd(n))lf(r,Q);else{var V=n.alternate;if(0===n.lanes&&(null===V||0===V.lanes)&&(V=r.lastRenderedReducer,null!==V))try{var oa=r.lastRenderedState,Ia=V(oa,B);Q.hasEagerState=!0;Q.eagerState=Ia;if(qh(Ia,oa)){var Ta=r.interleaved;null===Ta?(Q.next=Q,hc(r)):(Q.next=Ta.next,Ta.next=Q);r.interleaved=Q;return}}catch(tb){}finally{}B=kf(n,r,Q,F);null!==B&&(Q=ve(),Xd(B,n,F,Q),Ii(B,r,F))}}function zd(n){var r=n.alternate;return n===
xe||null!==r&&r===xe}function lf(n,r){ll=ml=!0;var B=n.pending;null===B?r.next=r:(r.next=B.next,B.next=r);n.pending=r}function Ii(n,r,B){if(0!==(B&4194240)){var F=r.lanes;F&=n.pendingLanes;B|=F;r.lanes=B;Hd(n,B)}}function je(n,r){if(n&&n.defaultProps){r=md({},r);n=n.defaultProps;for(var B in n)void 0===r[B]&&(r[B]=n[B])}return r}function Zj(n,r,B,F){r=n.memoizedState;B=B(F,r);B=null===B||void 0===B?r:md({},r,B);n.memoizedState=B;0===n.lanes&&(n.updateQueue.baseState=B)}function gj(n,r,B,F,Q,V,oa){n=
n.stateNode;return"function"===typeof n.shouldComponentUpdate?n.shouldComponentUpdate(F,V,oa):r.prototype&&r.prototype.isPureReactComponent?!og(B,F)||!og(Q,V):!0}function Qg(n,r,B){var F=!1,Q=Wj,V=r.contextType;"object"===typeof V&&null!==V?V=Xe(V):(Q=Vd(r)?zk:Hg.current,F=r.contextTypes,V=(F=null!==F&&void 0!==F)?Wf(n,Q):Wj);r=new r(B,V);n.memoizedState=null!==r.state&&void 0!==r.state?r.state:null;r.updater=Ll;n.stateNode=r;r._reactInternals=n;F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=
Q,n.__reactInternalMemoizedMaskedChildContext=V);return r}function ke(n,r,B,F){n=r.state;"function"===typeof r.componentWillReceiveProps&&r.componentWillReceiveProps(B,F);"function"===typeof r.UNSAFE_componentWillReceiveProps&&r.UNSAFE_componentWillReceiveProps(B,F);r.state!==n&&Ll.enqueueReplaceState(r,r.state,null)}function Ji(n,r,B,F){var Q=n.stateNode;Q.props=B;Q.state=n.memoizedState;Q.refs={};sg(n);var V=r.contextType;"object"===typeof V&&null!==V?Q.context=Xe(V):(V=Vd(r)?zk:Hg.current,Q.context=
Wf(n,V));Q.state=n.memoizedState;V=r.getDerivedStateFromProps;"function"===typeof V&&(Zj(n,r,V,B),Q.state=n.memoizedState);"function"===typeof r.getDerivedStateFromProps||"function"===typeof Q.getSnapshotBeforeUpdate||"function"!==typeof Q.UNSAFE_componentWillMount&&"function"!==typeof Q.componentWillMount||(r=Q.state,"function"===typeof Q.componentWillMount&&Q.componentWillMount(),"function"===typeof Q.UNSAFE_componentWillMount&&Q.UNSAFE_componentWillMount(),r!==Q.state&&Ll.enqueueReplaceState(Q,
Q.state,null),sf(n,B,Q,F),Q.state=n.memoizedState);"function"===typeof Q.componentDidMount&&(n.flags|=4194308)}function Nh(n,r){try{var B="",F=r;do B+=tc(F),F=F.return;while(F)}catch(Q){B="\nError generating stack: "+Q.message+"\n"+Q.stack}return{value:n,source:r,stack:B,digest:null}}function fh(n,r,B){return{value:n,source:null,stack:null!=B?B:null,digest:null!=r?r:null}}function Qf(n,r){try{console.error(r.value)}catch(B){setTimeout(function(){throw B;})}}function Oh(n,r,B){B=Eb(-1,B);B.tag=3;B.payload=
{element:null};var F=r.value;B.callback=function(){om||(om=!0,Wm=F);Qf(n,r)};return B}function Ki(n,r,B){B=Eb(-1,B);B.tag=3;var F=n.type.getDerivedStateFromError;if("function"===typeof F){var Q=r.value;B.payload=function(){return F(Q)};B.callback=function(){Qf(n,r)}}var V=n.stateNode;null!==V&&"function"===typeof V.componentDidCatch&&(B.callback=function(){Qf(n,r);"function"!==typeof F&&(null===Li?Li=new Set([this]):Li.add(this));var oa=r.stack;this.componentDidCatch(r.value,{componentStack:null!==
oa?oa:""})});return B}function Mi(n,r,B){var F=n.pingCache;if(null===F){F=n.pingCache=new on;var Q=new Set;F.set(r,Q)}else Q=F.get(r),void 0===Q&&(Q=new Set,F.set(r,Q));Q.has(B)||(Q.add(B),n=Ck.bind(null,n,r,B),r.then(n,n))}function hj(n){do{var r;if(r=13===n.tag)r=n.memoizedState,r=null!==r?null!==r.dehydrated?!0:!1:!0;if(r)return n;n=n.return}while(null!==n);return null}function Aj(n,r,B,F,Q){if(0===(n.mode&1))return n===r?n.flags|=65536:(n.flags|=128,B.flags|=131072,B.flags&=-52805,1===B.tag&&
(null===B.alternate?B.tag=17:(r=Eb(-1,1),r.tag=2,Cb(B,r,1))),B.lanes|=1),n;n.flags|=65536;n.lanes=Q;return n}function uf(n,r,B,F){r.child=null===n?nl(r,null,B,F):Bj(r,n.child,B,F)}function Ph(n,r,B,F,Q){B=B.render;var V=r.ref;ue(r,Q);F=Da(n,r,B,F,V,Q);B=Fi();if(null!==n&&!dh)return r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~Q,A(n,r,Q);he&&B&&Di(r);r.flags|=1;uf(n,r,F,Q);return r.child}function Cj(n,r,B,F,Q){if(null===n){var V=B.type;if("function"===typeof V&&!Dk(V)&&void 0===V.defaultProps&&
null===B.compare&&void 0===B.defaultProps)return r.tag=15,r.type=V,yh(n,r,V,F,Q);n=Uc(B.type,null,F,r,r.mode,Q);n.ref=r.ref;n.return=r;return r.child=n}V=n.child;if(0===(n.lanes&Q)){var oa=V.memoizedProps;B=B.compare;B=null!==B?B:og;if(B(oa,F)&&n.ref===r.ref)return A(n,r,Q)}r.flags|=1;n=Cf(V,F);n.ref=r.ref;n.return=r;return r.child=n}function yh(n,r,B,F,Q){if(null!==n){var V=n.memoizedProps;if(og(V,F)&&n.ref===r.ref)if(dh=!1,r.pendingProps=F=V,0!==(n.lanes&Q))0!==(n.flags&131072)&&(dh=!0);else return r.lanes=
n.lanes,A(n,r,Q)}return Nd(n,r,B,F,Q)}function Qh(n,r,B){var F=r.pendingProps,Q=F.children,V=null!==n?n.memoizedState:null;if("hidden"===F.mode)if(0===(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zd(ol,Rh),Rh|=B;else{if(0===(B&1073741824))return n=null!==V?V.baseLanes|B:B,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,Zd(ol,Rh),Rh|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null};F=null!==
V?V.baseLanes:B;Zd(ol,Rh);Rh|=F}else null!==V?(F=V.baseLanes|B,r.memoizedState=null):F=B,Zd(ol,Rh),Rh|=F;uf(n,r,Q,B);return r.child}function vg(n,r){var B=r.ref;if(null===n&&null!==B||null!==n&&n.ref!==B)r.flags|=512,r.flags|=2097152}function Nd(n,r,B,F,Q){var V=Vd(B)?zk:Hg.current;V=Wf(r,V);ue(r,Q);B=Da(n,r,B,F,V,Q);F=Fi();if(null!==n&&!dh)return r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~Q,A(n,r,Q);he&&F&&Di(r);r.flags|=1;uf(n,r,B,Q);return r.child}function vf(n,r,B,F,Q){if(Vd(B)){var V=
!0;ci(r)}else V=!1;ue(r,Q);if(null===r.stateNode)t(n,r),Qg(r,B,F),Ji(r,B,F,Q),F=!0;else if(null===n){var oa=r.stateNode,Ia=r.memoizedProps;oa.props=Ia;var Ta=oa.context,tb=B.contextType;"object"===typeof tb&&null!==tb?tb=Xe(tb):(tb=Vd(B)?zk:Hg.current,tb=Wf(r,tb));var Zb=B.getDerivedStateFromProps,gc="function"===typeof Zb||"function"===typeof oa.getSnapshotBeforeUpdate;gc||"function"!==typeof oa.UNSAFE_componentWillReceiveProps&&"function"!==typeof oa.componentWillReceiveProps||(Ia!==F||Ta!==tb)&&
ke(r,oa,F,tb);ag=!1;var Pb=r.memoizedState;oa.state=Pb;sf(r,F,oa,Q);Ta=r.memoizedState;Ia!==F||Pb!==Ta||$g.current||ag?("function"===typeof Zb&&(Zj(r,B,Zb,F),Ta=r.memoizedState),(Ia=ag||gj(r,B,Ia,F,Pb,Ta,tb))?(gc||"function"!==typeof oa.UNSAFE_componentWillMount&&"function"!==typeof oa.componentWillMount||("function"===typeof oa.componentWillMount&&oa.componentWillMount(),"function"===typeof oa.UNSAFE_componentWillMount&&oa.UNSAFE_componentWillMount()),"function"===typeof oa.componentDidMount&&(r.flags|=
4194308)):("function"===typeof oa.componentDidMount&&(r.flags|=4194308),r.memoizedProps=F,r.memoizedState=Ta),oa.props=F,oa.state=Ta,oa.context=tb,F=Ia):("function"===typeof oa.componentDidMount&&(r.flags|=4194308),F=!1)}else{oa=r.stateNode;He(n,r);Ia=r.memoizedProps;tb=r.type===r.elementType?Ia:je(r.type,Ia);oa.props=tb;gc=r.pendingProps;Pb=oa.context;Ta=B.contextType;"object"===typeof Ta&&null!==Ta?Ta=Xe(Ta):(Ta=Vd(B)?zk:Hg.current,Ta=Wf(r,Ta));var Ec=B.getDerivedStateFromProps;(Zb="function"===
typeof Ec||"function"===typeof oa.getSnapshotBeforeUpdate)||"function"!==typeof oa.UNSAFE_componentWillReceiveProps&&"function"!==typeof oa.componentWillReceiveProps||(Ia!==gc||Pb!==Ta)&&ke(r,oa,F,Ta);ag=!1;Pb=r.memoizedState;oa.state=Pb;sf(r,F,oa,Q);var Oc=r.memoizedState;Ia!==gc||Pb!==Oc||$g.current||ag?("function"===typeof Ec&&(Zj(r,B,Ec,F),Oc=r.memoizedState),(tb=ag||gj(r,B,tb,F,Pb,Oc,Ta)||!1)?(Zb||"function"!==typeof oa.UNSAFE_componentWillUpdate&&"function"!==typeof oa.componentWillUpdate||
("function"===typeof oa.componentWillUpdate&&oa.componentWillUpdate(F,Oc,Ta),"function"===typeof oa.UNSAFE_componentWillUpdate&&oa.UNSAFE_componentWillUpdate(F,Oc,Ta)),"function"===typeof oa.componentDidUpdate&&(r.flags|=4),"function"===typeof oa.getSnapshotBeforeUpdate&&(r.flags|=1024)):("function"!==typeof oa.componentDidUpdate||Ia===n.memoizedProps&&Pb===n.memoizedState||(r.flags|=4),"function"!==typeof oa.getSnapshotBeforeUpdate||Ia===n.memoizedProps&&Pb===n.memoizedState||(r.flags|=1024),r.memoizedProps=
F,r.memoizedState=Oc),oa.props=F,oa.state=Oc,oa.context=Ta,F=tb):("function"!==typeof oa.componentDidUpdate||Ia===n.memoizedProps&&Pb===n.memoizedState||(r.flags|=4),"function"!==typeof oa.getSnapshotBeforeUpdate||Ia===n.memoizedProps&&Pb===n.memoizedState||(r.flags|=1024),F=!1)}return wg(n,r,B,F,V,Q)}function wg(n,r,B,F,Q,V){vg(n,r);var oa=0!==(r.flags&128);if(!F&&!oa)return Q&&di(r,B,!1),A(n,r,V);F=r.stateNode;pn.current=r;var Ia=oa&&"function"!==typeof B.getDerivedStateFromError?null:F.render();
r.flags|=1;null!==n&&oa?(r.child=Bj(r,n.child,null,V),r.child=Bj(r,null,Ia,V)):uf(n,r,Ia,V);r.memoizedState=F.state;Q&&di(r,B,!0);return r.child}function Ni(n){var r=n.stateNode;r.pendingContext?bi(n,r.pendingContext,r.pendingContext!==r.context):r.context&&bi(n,r.context,!1);yd(n,r.containerInfo)}function gg(n){return{baseLanes:n,cachePool:null,transitions:null}}function ii(n,r,B){var F=r.pendingProps,Q=ze.current,V=!1,oa=0!==(r.flags&128),Ia;(Ia=oa)||(Ia=null!==n&&null===n.memoizedState?!1:0!==
(Q&2));if(Ia)V=!0,r.flags&=-129;else if(null===n||null!==n.memoizedState)Q|=1;Zd(ze,Q&1);if(null===n){Xf(r);n=r.memoizedState;if(null!==n&&(n=n.dehydrated,null!==n))return 0===(r.mode&1)?r.lanes=1:"$!"===n.data?r.lanes=8:r.lanes=1073741824,null;oa=F.children;n=F.fallback;return V?(F=r.mode,V=r.child,oa={mode:"hidden",children:oa},0===(F&1)&&null!==V?(V.childLanes=0,V.pendingProps=oa):V=Rg(oa,F,0,null),n=oc(n,F,B,null),V.return=r,n.return=r,V.sibling=n,r.child=V,r.child.memoizedState=gg(B),r.memoizedState=
pm,n):Sh(r,oa)}Q=n.memoizedState;if(null!==Q&&(Ia=Q.dehydrated,null!==Ia))return Ek(n,r,oa,F,Ia,Q,B);if(V){V=F.fallback;oa=r.mode;Q=n.child;Ia=Q.sibling;var Ta={mode:"hidden",children:F.children};0===(oa&1)&&r.child!==Q?(F=r.child,F.childLanes=0,F.pendingProps=Ta,r.deletions=null):(F=Cf(Q,Ta),F.subtreeFlags=Q.subtreeFlags&14680064);null!==Ia?V=Cf(Ia,V):(V=oc(V,oa,B,null),V.flags|=2);V.return=r;F.return=r;F.sibling=V;r.child=F;F=V;V=r.child;oa=n.child.memoizedState;oa=null===oa?gg(B):{baseLanes:oa.baseLanes|
B,cachePool:null,transitions:oa.transitions};V.memoizedState=oa;V.childLanes=n.childLanes&~B;r.memoizedState=pm;return F}V=n.child;n=V.sibling;F=Cf(V,{mode:"visible",children:F.children});0===(r.mode&1)&&(F.lanes=B);F.return=r;F.sibling=null;null!==n&&(B=r.deletions,null===B?(r.deletions=[n],r.flags|=16):B.push(n));r.child=F;r.memoizedState=null;return F}function Sh(n,r){r=Rg({mode:"visible",children:r},n.mode,0,null);r.return=n;return n.child=r}function ak(n,r,B,F){null!==F&&Ne(F);Bj(r,n.child,null,
B);n=Sh(r,r.pendingProps.children);n.flags|=2;r.memoizedState=null;return n}function Ek(n,r,B,F,Q,V,oa){if(B){if(r.flags&256)return r.flags&=-257,F=fh(Error(Na(422))),ak(n,r,oa,F);if(null!==r.memoizedState)return r.child=n.child,r.flags|=128,null;V=F.fallback;Q=r.mode;F=Rg({mode:"visible",children:F.children},Q,0,null);V=oc(V,Q,oa,null);V.flags|=2;F.return=r;V.return=r;F.sibling=V;r.child=F;0!==(r.mode&1)&&Bj(r,n.child,null,oa);r.child.memoizedState=gg(oa);r.memoizedState=pm;return V}if(0===(r.mode&
1))return ak(n,r,oa,null);if("$!"===Q.data){if(F=Q.nextSibling&&Q.nextSibling.dataset)var Ia=F.dgst;F=Ia;V=Error(Na(419));F=fh(V,F,void 0);return ak(n,r,oa,F)}Ia=0!==(oa&n.childLanes);if(dh||Ia){F=Pf;if(null!==F){switch(oa&-oa){case 4:Q=2;break;case 16:Q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Q=
32;break;case 536870912:Q=268435456;break;default:Q=0}Q=0!==(Q&(F.suspendedLanes|oa))?0:Q;0!==Q&&Q!==V.retryLane&&(V.retryLane=Q,Ed(n,Q),Xd(F,n,Q,-1))}zh();F=fh(Error(Na(421)));return ak(n,r,oa,F)}if("$?"===Q.data)return r.flags|=128,r.child=n.child,r=Fk.bind(null,n),Q._reactRetry=r,null;n=V.treeContext;rf=Ff(Q.nextSibling);uh=r;he=!0;vh=null;null!==n&&(Kh[ei++]=Lh,Kh[ei++]=Bi,Kh[ei++]=Ci,Lh=n.id,Bi=n.overflow,Ci=r);r=Sh(r,F.children);r.flags|=4096;return r}function Dj(n,r,B){n.lanes|=r;var F=n.alternate;
null!==F&&(F.lanes|=r);nd(n.return,r,B)}function bk(n,r,B,F,Q){var V=n.memoizedState;null===V?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:F,tail:B,tailMode:Q}:(V.isBackwards=r,V.rendering=null,V.renderingStartTime=0,V.last=F,V.tail=B,V.tailMode=Q)}function Gk(n,r,B){var F=r.pendingProps,Q=F.revealOrder,V=F.tail;uf(n,r,F.children,B);F=ze.current;if(0!==(F&2))F=F&1|2,r.flags|=128;else{if(null!==n&&0!==(n.flags&128))a:for(n=r.child;null!==n;){if(13===n.tag)null!==n.memoizedState&&
Dj(n,B,r);else if(19===n.tag)Dj(n,B,r);else if(null!==n.child){n.child.return=n;n=n.child;continue}if(n===r)break a;for(;null===n.sibling;){if(null===n.return||n.return===r)break a;n=n.return}n.sibling.return=n.return;n=n.sibling}F&=1}Zd(ze,F);if(0===(r.mode&1))r.memoizedState=null;else switch(Q){case "forwards":B=r.child;for(Q=null;null!==B;)n=B.alternate,null!==n&&null===Jd(n)&&(Q=B),B=B.sibling;B=Q;null===B?(Q=r.child,r.child=null):(Q=B.sibling,B.sibling=null);bk(r,!1,Q,B,V);break;case "backwards":B=
null;Q=r.child;for(r.child=null;null!==Q;){n=Q.alternate;if(null!==n&&null===Jd(n)){r.child=Q;break}n=Q.sibling;Q.sibling=B;B=Q;Q=n}bk(r,!0,B,null,V);break;case "together":bk(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function t(n,r){0===(r.mode&1)&&null!==n&&(n.alternate=null,r.alternate=null,r.flags|=2)}function A(n,r,B){null!==n&&(r.dependencies=n.dependencies);kl|=r.lanes;if(0===(B&r.childLanes))return null;if(null!==n&&r.child!==n.child)throw Error(Na(153));if(null!==
r.child){n=r.child;B=Cf(n,n.pendingProps);r.child=B;for(B.return=r;null!==n.sibling;)n=n.sibling,B=B.sibling=Cf(n,n.pendingProps),B.return=r;B.sibling=null}return r.child}function E(n,r,B){switch(r.tag){case 3:Ni(r);Bf();break;case 5:dd(r);break;case 1:Vd(r.type)&&ci(r);break;case 4:yd(r,r.stateNode.containerInfo);break;case 10:var F=r.type._context,Q=r.memoizedProps.value;Zd(ej,F._currentValue);F._currentValue=Q;break;case 13:F=r.memoizedState;if(null!==F){if(null!==F.dehydrated)return Zd(ze,ze.current&
1),r.flags|=128,null;if(0!==(B&r.child.childLanes))return ii(n,r,B);Zd(ze,ze.current&1);n=A(n,r,B);return null!==n?n.sibling:null}Zd(ze,ze.current&1);break;case 19:F=0!==(B&r.childLanes);if(0!==(n.flags&128)){if(F)return Gk(n,r,B);r.flags|=128}Q=r.memoizedState;null!==Q&&(Q.rendering=null,Q.tail=null,Q.lastEffect=null);Zd(ze,ze.current);if(F)break;else return null;case 22:case 23:return r.lanes=0,Qh(n,r,B)}return A(n,r,B)}function N(n,r){if(!he)switch(n.tailMode){case "hidden":r=n.tail;for(var B=
null;null!==r;)null!==r.alternate&&(B=r),r=r.sibling;null===B?n.tail=null:B.sibling=null;break;case "collapsed":B=n.tail;for(var F=null;null!==B;)null!==B.alternate&&(F=B),B=B.sibling;null===F?r||null===n.tail?n.tail=null:n.tail.sibling=null:F.sibling=null}}function U(n){var r=null!==n.alternate&&n.alternate.child===n.child,B=0,F=0;if(r)for(var Q=n.child;null!==Q;)B|=Q.lanes|Q.childLanes,F|=Q.subtreeFlags&14680064,F|=Q.flags&14680064,Q.return=n,Q=Q.sibling;else for(Q=n.child;null!==Q;)B|=Q.lanes|
Q.childLanes,F|=Q.subtreeFlags,F|=Q.flags,Q.return=n,Q=Q.sibling;n.subtreeFlags|=F;n.childLanes=B;return r}function ea(n,r,B){var F=r.pendingProps;cj(r);switch(r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return U(r),null;case 1:return Vd(r.type)&&jf(),U(r),null;case 3:F=r.stateNode;Md();$c($g);$c(Hg);ee();F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null);if(null===n||null===n.child)Yf(r)?r.flags|=4:null===n||n.memoizedState.isDehydrated&&0===
(r.flags&256)||(r.flags|=1024,null!==vh&&(Oi(vh),vh=null));Xm(n,r);U(r);return null;case 5:ed(r);var Q=Ld(Mh.current);B=r.type;if(null!==n&&null!=r.stateNode)qn(n,r,B,F,Q),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!F){if(null===r.stateNode)throw Error(Na(166));U(r);return null}n=Ld(bg.current);if(Yf(r)){F=r.stateNode;B=r.type;var V=r.memoizedProps;F[ai]=r;F[gl]=V;n=0!==(r.mode&1);switch(B){case "dialog":Ud("cancel",F);Ud("close",F);break;case "iframe":case "object":case "embed":Ud("load",
F);break;case "video":case "audio":for(Q=0;Q<Hk.length;Q++)Ud(Hk[Q],F);break;case "source":Ud("error",F);break;case "img":case "image":case "link":Ud("error",F);Ud("load",F);break;case "details":Ud("toggle",F);break;case "input":Jc(F,V);Ud("invalid",F);break;case "select":F._wrapperState={wasMultiple:!!V.multiple};Ud("invalid",F);break;case "textarea":pd(F,V),Ud("invalid",F)}Tc(B,V);Q=null;for(var oa in V)if(V.hasOwnProperty(oa)){var Ia=V[oa];"children"===oa?"string"===typeof Ia?F.textContent!==Ia&&
(!0!==V.suppressHydrationWarning&&pg(F.textContent,Ia,n),Q=["children",Ia]):"number"===typeof Ia&&F.textContent!==""+Ia&&(!0!==V.suppressHydrationWarning&&pg(F.textContent,Ia,n),Q=["children",""+Ia]):R.hasOwnProperty(oa)&&null!=Ia&&"onScroll"===oa&&Ud("scroll",F)}switch(B){case "input":zb(F);Dc(F,V,!0);break;case "textarea":zb(F);Rc(F);break;case "select":case "option":break;default:"function"===typeof V.onClick&&(F.onclick=zi)}F=Q;r.updateQueue=F;null!==F&&(r.flags|=4)}else{oa=9===Q.nodeType?Q:Q.ownerDocument;
"http://www.w3.org/1999/xhtml"===n&&(n=Kb(B));"http://www.w3.org/1999/xhtml"===n?"script"===B?(n=oa.createElement("div"),n.innerHTML="\x3cscript\x3e\x3c/script\x3e",n=n.removeChild(n.firstChild)):"string"===typeof F.is?n=oa.createElement(B,{is:F.is}):(n=oa.createElement(B),"select"===B&&(oa=n,F.multiple?oa.multiple=!0:F.size&&(oa.size=F.size))):n=oa.createElementNS(n,B);n[ai]=r;n[gl]=F;rn(n,r,!1,!1);r.stateNode=n;a:{oa=od(B,F);switch(B){case "dialog":Ud("cancel",n);Ud("close",n);Q=F;break;case "iframe":case "object":case "embed":Ud("load",
n);Q=F;break;case "video":case "audio":for(Q=0;Q<Hk.length;Q++)Ud(Hk[Q],n);Q=F;break;case "source":Ud("error",n);Q=F;break;case "img":case "image":case "link":Ud("error",n);Ud("load",n);Q=F;break;case "details":Ud("toggle",n);Q=F;break;case "input":Jc(n,F);Q=Hc(n,F);Ud("invalid",n);break;case "option":Q=F;break;case "select":n._wrapperState={wasMultiple:!!F.multiple};Q=md({},F,{value:void 0});Ud("invalid",n);break;case "textarea":pd(n,F);Q=Nc(n,F);Ud("invalid",n);break;default:Q=F}Tc(B,Q);Ia=Q;for(V in Ia)if(Ia.hasOwnProperty(V)){var Ta=
Ia[V];"style"===V?Ac(n,Ta):"dangerouslySetInnerHTML"===V?(Ta=Ta?Ta.__html:void 0,null!=Ta&&wd(n,Ta)):"children"===V?"string"===typeof Ta?("textarea"!==B||""!==Ta)&&jb(n,Ta):"number"===typeof Ta&&jb(n,""+Ta):"suppressContentEditableWarning"!==V&&"suppressHydrationWarning"!==V&&"autoFocus"!==V&&(R.hasOwnProperty(V)?null!=Ta&&"onScroll"===V&&Ud("scroll",n):null!=Ta&&$a(n,V,Ta,oa))}switch(B){case "input":zb(n);Dc(n,F,!1);break;case "textarea":zb(n);Rc(n);break;case "option":null!=F.value&&n.setAttribute("value",
""+yb(F.value));break;case "select":n.multiple=!!F.multiple;V=F.value;null!=V?xc(n,!!F.multiple,V,!1):null!=F.defaultValue&&xc(n,!!F.multiple,F.defaultValue,!0);break;default:"function"===typeof Q.onClick&&(n.onclick=zi)}switch(B){case "button":case "input":case "select":case "textarea":F=!!F.autoFocus;break a;case "img":F=!0;break a;default:F=!1}}F&&(r.flags|=4)}null!==r.ref&&(r.flags|=512,r.flags|=2097152)}U(r);return null;case 6:if(n&&null!=r.stateNode)pl(n,r,n.memoizedProps,F);else{if("string"!==
typeof F&&null===r.stateNode)throw Error(Na(166));B=Ld(Mh.current);Ld(bg.current);if(Yf(r)){F=r.stateNode;B=r.memoizedProps;F[ai]=r;if(V=F.nodeValue!==B)if(n=uh,null!==n)switch(n.tag){case 3:pg(F.nodeValue,B,0!==(n.mode&1));break;case 5:!0!==n.memoizedProps.suppressHydrationWarning&&pg(F.nodeValue,B,0!==(n.mode&1))}V&&(r.flags|=4)}else F=(9===B.nodeType?B:B.ownerDocument).createTextNode(F),F[ai]=r,r.stateNode=F}U(r);return null;case 13:$c(ze);F=r.memoizedState;if(null===n||null!==n.memoizedState&&
null!==n.memoizedState.dehydrated){if(he&&null!==rf&&0!==(r.mode&1)&&0===(r.flags&128))Ge(),Bf(),r.flags|=98560,V=!1;else if(V=Yf(r),null!==F&&null!==F.dehydrated){if(null===n){if(!V)throw Error(Na(318));V=r.memoizedState;V=null!==V?V.dehydrated:null;if(!V)throw Error(Na(317));V[ai]=r}else Bf(),0===(r.flags&128)&&(r.memoizedState=null),r.flags|=4;U(r);V=!1}else null!==vh&&(Oi(vh),vh=null),V=!0;if(!V)return r.flags&65536?r:null}if(0!==(r.flags&128))return r.lanes=B,r;F=null!==F;F!==(null!==n&&null!==
n.memoizedState)&&F&&(r.child.flags|=8192,0!==(r.mode&1)&&(null===n||0!==(ze.current&1)?0===bf&&(bf=3):zh()));null!==r.updateQueue&&(r.flags|=4);U(r);return null;case 4:return Md(),Xm(n,r),null===n&&Eg(r.stateNode.containerInfo),U(r),null;case 10:return Lb(r.type._context),U(r),null;case 17:return Vd(r.type)&&jf(),U(r),null;case 19:$c(ze);V=r.memoizedState;if(null===V)return U(r),null;F=0!==(r.flags&128);oa=V.rendering;if(null===oa)if(F)N(V,!1);else{if(0!==bf||null!==n&&0!==(n.flags&128))for(n=r.child;null!==
n;){oa=Jd(n);if(null!==oa){r.flags|=128;N(V,!1);F=oa.updateQueue;null!==F&&(r.updateQueue=F,r.flags|=4);r.subtreeFlags=0;F=B;for(B=r.child;null!==B;)V=B,n=F,V.flags&=14680066,oa=V.alternate,null===oa?(V.childLanes=0,V.lanes=n,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=oa.childLanes,V.lanes=oa.lanes,V.child=oa.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=oa.memoizedProps,V.memoizedState=oa.memoizedState,
V.updateQueue=oa.updateQueue,V.type=oa.type,n=oa.dependencies,V.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),B=B.sibling;Zd(ze,ze.current&1|2);return r.child}n=n.sibling}null!==V.tail&&cf()>ql&&(r.flags|=128,F=!0,N(V,!1),r.lanes=4194304)}else{if(!F)if(n=Jd(oa),null!==n){if(r.flags|=128,F=!0,B=n.updateQueue,null!==B&&(r.updateQueue=B,r.flags|=4),N(V,!0),null===V.tail&&"hidden"===V.tailMode&&!oa.alternate&&!he)return U(r),null}else 2*cf()-V.renderingStartTime>ql&&1073741824!==
B&&(r.flags|=128,F=!0,N(V,!1),r.lanes=4194304);V.isBackwards?(oa.sibling=r.child,r.child=oa):(B=V.last,null!==B?B.sibling=oa:r.child=oa,V.last=oa)}if(null!==V.tail)return r=V.tail,V.rendering=r,V.tail=r.sibling,V.renderingStartTime=cf(),r.sibling=null,B=ze.current,Zd(ze,F?B&1|2:B&1),r;U(r);return null;case 22:case 23:return Pi(),F=null!==r.memoizedState,null!==n&&null!==n.memoizedState!==F&&(r.flags|=8192),F&&0!==(r.mode&1)?0!==(Rh&1073741824)&&(U(r),r.subtreeFlags&6&&(r.flags|=8192)):U(r),null;case 24:return null;
case 25:return null}throw Error(Na(156,r.tag));}function ia(n,r){cj(r);switch(r.tag){case 1:return Vd(r.type)&&jf(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Md(),$c($g),$c(Hg),ee(),n=r.flags,0!==(n&65536)&&0===(n&128)?(r.flags=n&-65537|128,r):null;case 5:return ed(r),null;case 13:$c(ze);n=r.memoizedState;if(null!==n&&null!==n.dehydrated){if(null===r.alternate)throw Error(Na(340));Bf()}n=r.flags;return n&65536?(r.flags=n&-65537|128,r):null;case 19:return $c(ze),null;case 4:return Md(),
null;case 10:return Lb(r.type._context),null;case 22:case 23:return Pi(),null;case 24:return null;default:return null}}function va(n,r){var B=n.ref;if(null!==B)if("function"===typeof B)try{B(null)}catch(F){Je(n,r,F)}else B.current=null}function Ga(n,r,B){try{B()}catch(F){Je(n,r,F)}}function Sa(n,r){qm=Oj;n=Zi();if(Zg(n)){if("selectionStart"in n)var B={start:n.selectionStart,end:n.selectionEnd};else a:{B=(B=n.ownerDocument)&&B.defaultView||window;var F=B.getSelection&&B.getSelection();if(F&&0!==F.rangeCount){B=
F.anchorNode;var Q=F.anchorOffset,V=F.focusNode;F=F.focusOffset;try{B.nodeType,V.nodeType}catch(ac){B=null;break a}var oa=0,Ia=-1,Ta=-1,tb=0,Zb=0,gc=n,Pb=null;b:for(;;){for(var Ec;;){gc!==B||0!==Q&&3!==gc.nodeType||(Ia=oa+Q);gc!==V||0!==F&&3!==gc.nodeType||(Ta=oa+F);3===gc.nodeType&&(oa+=gc.nodeValue.length);if(null===(Ec=gc.firstChild))break;Pb=gc;gc=Ec}for(;;){if(gc===n)break b;Pb===B&&++tb===Q&&(Ia=oa);Pb===V&&++Zb===F&&(Ta=oa);if(null!==(Ec=gc.nextSibling))break;gc=Pb;Pb=gc.parentNode}gc=Ec}B=
-1===Ia||-1===Ta?null:{start:Ia,end:Ta}}else B=null}B=B||{start:0,end:0}}else B=null;Ej={focusedElem:n,selectionRange:B};Oj=!1;for(Lc=r;null!==Lc;)if(r=Lc,n=r.child,0!==(r.subtreeFlags&1028)&&null!==n)n.return=r,Lc=n;else for(;null!==Lc;){r=Lc;try{var Oc=r.alternate;if(0!==(r.flags&1024))switch(r.tag){case 0:case 11:case 15:break;case 1:if(null!==Oc){var Kc=Oc.memoizedProps,Te=Oc.memoizedState,gb=r.stateNode,Xa=gb.getSnapshotBeforeUpdate(r.elementType===r.type?Kc:je(r.type,Kc),Te);gb.__reactInternalSnapshotBeforeUpdate=
Xa}break;case 3:var nb=r.stateNode.containerInfo;1===nb.nodeType?nb.textContent="":9===nb.nodeType&&nb.documentElement&&nb.removeChild(nb.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Na(163));}}catch(ac){Je(r,r.return,ac)}n=r.sibling;if(null!==n){n.return=r.return;Lc=n;break}Lc=r.return}Oc=Ym;Ym=!1;return Oc}function ab(n,r,B){var F=r.updateQueue;F=null!==F?F.lastEffect:null;if(null!==F){var Q=F=F.next;do{if((Q.tag&n)===n){var V=Q.destroy;Q.destroy=void 0;void 0!==
V&&Ga(r,B,V)}Q=Q.next}while(Q!==F)}}function Qb(n,r){r=r.updateQueue;r=null!==r?r.lastEffect:null;if(null!==r){var B=r=r.next;do{if((B.tag&n)===n){var F=B.create;B.destroy=F()}B=B.next}while(B!==r)}}function ic(n){var r=n.ref;if(null!==r){var B=n.stateNode;switch(n.tag){case 5:n=B;break;default:n=B}"function"===typeof r?r(n):r.current=n}}function Vb(n){var r=n.alternate;null!==r&&(n.alternate=null,Vb(r));n.child=null;n.deletions=null;n.sibling=null;5===n.tag&&(r=n.stateNode,null!==r&&(delete r[ai],
delete r[gl],delete r[Hl],delete r[Zm],delete r[Ik]));n.stateNode=null;n.return=null;n.dependencies=null;n.memoizedProps=null;n.memoizedState=null;n.pendingProps=null;n.stateNode=null;n.updateQueue=null}function Sc(n){return 5===n.tag||3===n.tag||4===n.tag}function mc(n){a:for(;;){for(;null===n.sibling;){if(null===n.return||Sc(n.return))return null;n=n.return}n.sibling.return=n.return;for(n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(n.flags&2)continue a;if(null===n.child||4===n.tag)continue a;
else n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function xd(n,r,B){var F=n.tag;if(5===F||6===F)n=n.stateNode,r?8===B.nodeType?B.parentNode.insertBefore(n,r):B.insertBefore(n,r):(8===B.nodeType?(r=B.parentNode,r.insertBefore(n,B)):(r=B,r.appendChild(n)),B=B._reactRootContainer,null!==B&&void 0!==B||null!==r.onclick||(r.onclick=zi));else if(4!==F&&(n=n.child,null!==n))for(xd(n,r,B),n=n.sibling;null!==n;)xd(n,r,B),n=n.sibling}function Sg(n,r,B){var F=n.tag;if(5===F||6===F)n=n.stateNode,
r?B.insertBefore(n,r):B.appendChild(n);else if(4!==F&&(n=n.child,null!==n))for(Sg(n,r,B),n=n.sibling;null!==n;)Sg(n,r,B),n=n.sibling}function If(n,r,B){for(B=B.child;null!==B;)Fj(n,r,B),B=B.sibling}function Fj(n,r,B){if(Yh&&"function"===typeof Yh.onCommitFiberUnmount)try{Yh.onCommitFiberUnmount(ig,B)}catch(Ia){}switch(B.tag){case 5:xg||va(B,r);case 6:var F=Tg,Q=Qi;Tg=null;If(n,r,B);Tg=F;Qi=Q;null!==Tg&&(Qi?(n=Tg,B=B.stateNode,8===n.nodeType?n.parentNode.removeChild(B):n.removeChild(B)):Tg.removeChild(B.stateNode));
break;case 18:null!==Tg&&(Qi?(n=Tg,B=B.stateNode,8===n.nodeType?Gg(n.parentNode,B):1===n.nodeType&&Gg(n,B),Eh(n)):Gg(Tg,B.stateNode));break;case 4:F=Tg;Q=Qi;Tg=B.stateNode.containerInfo;Qi=!0;If(n,r,B);Tg=F;Qi=Q;break;case 0:case 11:case 14:case 15:if(!xg&&(F=B.updateQueue,null!==F&&(F=F.lastEffect,null!==F))){Q=F=F.next;do{var V=Q,oa=V.destroy;V=V.tag;void 0!==oa&&(0!==(V&2)?Ga(B,r,oa):0!==(V&4)&&Ga(B,r,oa));Q=Q.next}while(Q!==F)}If(n,r,B);break;case 1:if(!xg&&(va(B,r),F=B.stateNode,"function"===
typeof F.componentWillUnmount))try{F.props=B.memoizedProps,F.state=B.memoizedState,F.componentWillUnmount()}catch(Ia){Je(B,r,Ia)}If(n,r,B);break;case 21:If(n,r,B);break;case 22:B.mode&1?(xg=(F=xg)||null!==B.memoizedState,If(n,r,B),xg=F):If(n,r,B);break;default:If(n,r,B)}}function mf(n){var r=n.updateQueue;if(null!==r){n.updateQueue=null;var B=n.stateNode;null===B&&(B=n.stateNode=new Fm);r.forEach(function(F){var Q=rm.bind(null,n,F);B.has(F)||(B.add(F),F.then(Q,Q))})}}function Rf(n,r){var B=r.deletions;
if(null!==B)for(var F=0;F<B.length;F++){var Q=B[F];try{var V=n,oa=r,Ia=oa;a:for(;null!==Ia;){switch(Ia.tag){case 5:Tg=Ia.stateNode;Qi=!1;break a;case 3:Tg=Ia.stateNode.containerInfo;Qi=!0;break a;case 4:Tg=Ia.stateNode.containerInfo;Qi=!0;break a}Ia=Ia.return}if(null===Tg)throw Error(Na(160));Fj(V,oa,Q);Tg=null;Qi=!1;var Ta=Q.alternate;null!==Ta&&(Ta.return=null);Q.return=null}catch(tb){Je(Q,r,tb)}}if(r.subtreeFlags&12854)for(r=r.child;null!==r;)ij(r,n),r=r.sibling}function ij(n,r){var B=n.alternate,
F=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Rf(r,n);Ug(n);if(F&4){try{ab(3,n,n.return),Qb(3,n)}catch(Kc){Je(n,n.return,Kc)}try{ab(5,n,n.return)}catch(Kc){Je(n,n.return,Kc)}}break;case 1:Rf(r,n);Ug(n);F&512&&null!==B&&va(B,B.return);break;case 5:Rf(r,n);Ug(n);F&512&&null!==B&&va(B,B.return);if(n.flags&32){var Q=n.stateNode;try{jb(Q,"")}catch(Kc){Je(n,n.return,Kc)}}if(F&4&&(Q=n.stateNode,null!=Q)){var V=n.memoizedProps,oa=null!==B?B.memoizedProps:V,Ia=n.type,Ta=n.updateQueue;n.updateQueue=
null;if(null!==Ta)try{"input"===Ia&&"radio"===V.type&&null!=V.name&&id(Q,V);od(Ia,oa);var tb=od(Ia,V);for(oa=0;oa<Ta.length;oa+=2){var Zb=Ta[oa],gc=Ta[oa+1];"style"===Zb?Ac(Q,gc):"dangerouslySetInnerHTML"===Zb?wd(Q,gc):"children"===Zb?jb(Q,gc):$a(Q,Zb,gc,tb)}switch(Ia){case "input":sd(Q,V);break;case "textarea":Ic(Q,V);break;case "select":var Pb=Q._wrapperState.wasMultiple;Q._wrapperState.wasMultiple=!!V.multiple;var Ec=V.value;null!=Ec?xc(Q,!!V.multiple,Ec,!1):Pb!==!!V.multiple&&(null!=V.defaultValue?
xc(Q,!!V.multiple,V.defaultValue,!0):xc(Q,!!V.multiple,V.multiple?[]:"",!1))}Q[gl]=V}catch(Kc){Je(n,n.return,Kc)}}break;case 6:Rf(r,n);Ug(n);if(F&4){if(null===n.stateNode)throw Error(Na(162));Q=n.stateNode;V=n.memoizedProps;try{Q.nodeValue=V}catch(Kc){Je(n,n.return,Kc)}}break;case 3:Rf(r,n);Ug(n);if(F&4&&null!==B&&B.memoizedState.isDehydrated)try{Eh(r.containerInfo)}catch(Kc){Je(n,n.return,Kc)}break;case 4:Rf(r,n);Ug(n);break;case 13:Rf(r,n);Ug(n);Q=n.child;Q.flags&8192&&(V=null!==Q.memoizedState,
Q.stateNode.isHidden=V,!V||null!==Q.alternate&&null!==Q.alternate.memoizedState||(Ml=cf()));F&4&&mf(n);break;case 22:Zb=null!==B&&null!==B.memoizedState;n.mode&1?(xg=(tb=xg)||Zb,Rf(r,n),xg=tb):Rf(r,n);Ug(n);if(F&8192){tb=null!==n.memoizedState;if((n.stateNode.isHidden=tb)&&!Zb&&0!==(n.mode&1))for(Lc=n,Zb=n.child;null!==Zb;){for(gc=Lc=Zb;null!==Lc;){Pb=Lc;Ec=Pb.child;switch(Pb.tag){case 0:case 11:case 14:case 15:ab(4,Pb,Pb.return);break;case 1:va(Pb,Pb.return);var Oc=Pb.stateNode;if("function"===typeof Oc.componentWillUnmount){F=
Pb;B=Pb.return;try{r=F,Oc.props=r.memoizedProps,Oc.state=r.memoizedState,Oc.componentWillUnmount()}catch(Kc){Je(F,B,Kc)}}break;case 5:va(Pb,Pb.return);break;case 22:if(null!==Pb.memoizedState){rl(gc);continue}}null!==Ec?(Ec.return=Pb,Lc=Ec):rl(gc)}Zb=Zb.sibling}Zb=null;gc=n;a:for(;;){if(5===gc.tag){if(null===Zb){Zb=gc;try{Q=gc.stateNode,tb?(V=Q.style,"function"===typeof V.setProperty?V.setProperty("display","none","important"):V.display="none"):(Ia=gc.stateNode,Ta=gc.memoizedProps.style,oa=void 0!==
Ta&&null!==Ta&&Ta.hasOwnProperty("display")?Ta.display:null,Ia.style.display=sc("display",oa))}catch(Kc){Je(n,n.return,Kc)}}}else if(6===gc.tag){if(null===Zb)try{gc.stateNode.nodeValue=tb?"":gc.memoizedProps}catch(Kc){Je(n,n.return,Kc)}}else if((22!==gc.tag&&23!==gc.tag||null===gc.memoizedState||gc===n)&&null!==gc.child){gc.child.return=gc;gc=gc.child;continue}if(gc===n)break a;for(;null===gc.sibling;){if(null===gc.return||gc.return===n)break a;Zb===gc&&(Zb=null);gc=gc.return}Zb===gc&&(Zb=null);gc.sibling.return=
gc.return;gc=gc.sibling}}break;case 19:Rf(r,n);Ug(n);F&4&&mf(n);break;case 21:break;default:Rf(r,n),Ug(n)}}function Ug(n){var r=n.flags;if(r&2){try{a:{for(var B=n.return;null!==B;){if(Sc(B))break a;B=B.return}throw Error(Na(160));}switch(B.tag){case 5:var F=B.stateNode;B.flags&32&&(jb(F,""),B.flags&=-33);var Q=mc(n);Sg(n,Q,F);break;case 3:case 4:var V=B.stateNode.containerInfo,oa=mc(n);xd(n,oa,V);break;default:throw Error(Na(161));}}catch(Ia){Je(n,n.return,Ia)}n.flags&=-3}r&4096&&(n.flags&=-4097)}
function Mc(n,r,B){Lc=n;Jk(n,r,B)}function Jk(n,r,B){for(var F=0!==(n.mode&1);null!==Lc;){var Q=Lc,V=Q.child;if(22===Q.tag&&F){var oa=null!==Q.memoizedState||ck;if(!oa){var Ia=Q.alternate,Ta=null!==Ia&&null!==Ia.memoizedState||xg;Ia=ck;var tb=xg;ck=oa;if((xg=Ta)&&!tb)for(Lc=Q;null!==Lc;)oa=Lc,Ta=oa.child,22===oa.tag&&null!==oa.memoizedState?ji(Q):null!==Ta?(Ta.return=oa,Lc=Ta):ji(Q);for(;null!==V;)Lc=V,Jk(V,r,B),V=V.sibling;Lc=Q;ck=Ia;xg=tb}Vg(n,r,B)}else 0!==(Q.subtreeFlags&8772)&&null!==V?(V.return=
Q,Lc=V):Vg(n,r,B)}}function Vg(n){for(;null!==Lc;){var r=Lc;if(0!==(r.flags&8772)){var B=r.alternate;try{if(0!==(r.flags&8772))switch(r.tag){case 0:case 11:case 15:xg||Qb(5,r);break;case 1:var F=r.stateNode;if(r.flags&4&&!xg)if(null===B)F.componentDidMount();else{var Q=r.elementType===r.type?B.memoizedProps:je(r.type,B.memoizedProps);F.componentDidUpdate(Q,B.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var V=r.updateQueue;null!==V&&ld(r,V,F);break;case 3:var oa=r.updateQueue;if(null!==oa){B=
null;if(null!==r.child)switch(r.child.tag){case 5:B=r.child.stateNode;break;case 1:B=r.child.stateNode}ld(r,oa,B)}break;case 5:var Ia=r.stateNode;if(null===B&&r.flags&4){B=Ia;var Ta=r.memoizedProps;switch(r.type){case "button":case "input":case "select":case "textarea":Ta.autoFocus&&B.focus();break;case "img":Ta.src&&(B.src=Ta.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===r.memoizedState){var tb=r.alternate;if(null!==tb){var Zb=tb.memoizedState;if(null!==Zb){var gc=Zb.dehydrated;
null!==gc&&Eh(gc)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Na(163));}xg||r.flags&512&&ic(r)}catch(Pb){Je(r,r.return,Pb)}}if(r===n){Lc=null;break}B=r.sibling;if(null!==B){B.return=r.return;Lc=B;break}Lc=r.return}}function rl(n){for(;null!==Lc;){var r=Lc;if(r===n){Lc=null;break}var B=r.sibling;if(null!==B){B.return=r.return;Lc=B;break}Lc=r.return}}function ji(n){for(;null!==Lc;){var r=Lc;try{switch(r.tag){case 0:case 11:case 15:var B=r.return;try{Qb(4,r)}catch(Ta){Je(r,
B,Ta)}break;case 1:var F=r.stateNode;if("function"===typeof F.componentDidMount){var Q=r.return;try{F.componentDidMount()}catch(Ta){Je(r,Q,Ta)}}var V=r.return;try{ic(r)}catch(Ta){Je(r,V,Ta)}break;case 5:var oa=r.return;try{ic(r)}catch(Ta){Je(r,oa,Ta)}}}catch(Ta){Je(r,r.return,Ta)}if(r===n){Lc=null;break}var Ia=r.sibling;if(null!==Ia){Ia.return=r.return;Lc=Ia;break}Lc=r.return}}function ve(){return 0!==($d&6)?cf():-1!==Gm?Gm:Gm=cf()}function fg(n){if(0===(n.mode&1))return 1;if(0!==($d&2)&&0!==df)return df&
-df;if(null!==ki.transition)return 0===Kk&&(Kk=kc()),Kk;n=se;if(0!==n)return n;n=window.event;return n=void 0===n?16:mh(n.type)}function Xd(n,r,B,F){if(50<sm)throw sm=0,Hm=null,Error(Na(185));Gc(n,B,F);if(0===($d&2)||n!==Pf)n===Pf&&(0===($d&2)&&(Gj|=B),4===bf&&gh(n,df)),Xc(n,F),1===B&&0===$d&&0===(r.mode&1)&&(ql=cf()+500,hl&&Nf())}function Xc(n,r){var B=n.callbackNode;Rb(n,r);var F=fb(n,n===Pf?df:0);if(0===F)null!==B&&Hj(B),n.callbackNode=null,n.callbackPriority=0;else if(r=F&-F,n.callbackPriority!==
r){null!=B&&Hj(B);if(1===r)0===n.tag?Od(dk.bind(null,n)):vj(dk.bind(null,n)),sn(function(){0===($d&6)&&Nf()}),B=null;else{switch(de(F)){case 1:B=nh;break;case 4:B=rk;break;case 16:B=Wi;break;case 536870912:B=lg;break;default:B=Wi}B=Nl(B,tm.bind(null,n))}n.callbackPriority=r;n.callbackNode=B}}function tm(n,r){Gm=-1;Kk=0;if(0!==($d&6))throw Error(Na(327));var B=n.callbackNode;if(li()&&n.callbackNode!==B)return null;var F=fb(n,n===Pf?df:0);if(0===F)return null;if(0!==(F&30)||0!==(F&n.expiredLanes)||
r)r=Lk(n,F);else{r=F;var Q=$d;$d|=2;var V=nf();if(Pf!==n||df!==r)hh=null,ql=cf()+500,mi(n,r);do try{for(;null!==wf&&!ek();)ih(wf);break}catch(Ia){Mk(n,Ia)}while(1);Zf=ch=xj=null;Im.current=V;$d=Q;null!==wf?r=0:(Pf=null,df=0,r=bf)}if(0!==r){2===r&&(Q=ec(n),0!==Q&&(F=Q,r=Ri(n,Q)));if(1===r)throw B=Ol,mi(n,0),gh(n,F),Xc(n,cf()),B;if(6===r)gh(n,F);else{Q=n.current.alternate;if(0===(F&30)&&!um(Q)&&(r=Lk(n,F),2===r&&(V=ec(n),0!==V&&(F=V,r=Ri(n,V))),1===r))throw B=Ol,mi(n,0),gh(n,F),Xc(n,cf()),B;n.finishedWork=
Q;n.finishedLanes=F;switch(r){case 0:case 1:throw Error(Na(345));case 2:Wg(n,Jf,hh);break;case 3:gh(n,F);if((F&130023424)===F&&(r=Ml+500-cf(),10<r)){if(0!==fb(n,0))break;Q=n.suspendedLanes;if((Q&F)!==F){ve();n.pingedLanes|=n.suspendedLanes&Q;break}n.timeoutHandle=Jm(Wg.bind(null,n,Jf,hh),r);break}Wg(n,Jf,hh);break;case 4:gh(n,F);if((F&4194240)===F)break;r=n.eventTimes;for(Q=-1;0<F;){var oa=31-oi(F);V=1<<oa;oa=r[oa];oa>Q&&(Q=oa);F&=~V}F=Q;F=cf()-F;F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3E3>
F?3E3:4320>F?4320:1960*tn(F/1960))-F;if(10<F){n.timeoutHandle=Jm(Wg.bind(null,n,Jf,hh),F);break}Wg(n,Jf,hh);break;case 5:Wg(n,Jf,hh);break;default:throw Error(Na(329));}}}Xc(n,cf());return n.callbackNode===B?tm.bind(null,n):null}function Ri(n,r){var B=Pl;n.current.memoizedState.isDehydrated&&(mi(n,r).flags|=256);n=Lk(n,r);2!==n&&(r=Jf,Jf=B,null!==r&&Oi(r));return n}function Oi(n){null===Jf?Jf=n:Jf.push.apply(Jf,n)}function um(n){for(var r=n;;){if(r.flags&16384){var B=r.updateQueue;if(null!==B&&(B=
B.stores,null!==B))for(var F=0;F<B.length;F++){var Q=B[F],V=Q.getSnapshot;Q=Q.value;try{if(!qh(V(),Q))return!1}catch(oa){return!1}}}B=r.child;if(r.subtreeFlags&16384&&null!==B)B.return=r,r=B;else{if(r===n)break;for(;null===r.sibling;){if(null===r.return||r.return===n)return!0;r=r.return}r.sibling.return=r.return;r=r.sibling}}return!0}function gh(n,r){r&=~$m;r&=~Gj;n.suspendedLanes|=r;n.pingedLanes&=~r;for(n=n.expirationTimes;0<r;){var B=31-oi(r),F=1<<B;n[B]=-1;r&=~F}}function dk(n){if(0!==($d&6))throw Error(Na(327));
li();var r=fb(n,0);if(0===(r&1))return Xc(n,cf()),null;var B=Lk(n,r);if(0!==n.tag&&2===B){var F=ec(n);0!==F&&(r=F,B=Ri(n,F))}if(1===B)throw B=Ol,mi(n,0),gh(n,r),Xc(n,cf()),B;if(6===B)throw Error(Na(345));n.finishedWork=n.current.alternate;n.finishedLanes=r;Wg(n,Jf,hh);Xc(n,cf());return null}function jj(n,r){var B=$d;$d|=1;try{return n(r)}finally{$d=B,0===$d&&(ql=cf()+500,hl&&Nf())}}function ni(n){null!==Nk&&0===Nk.tag&&0===($d&6)&&li();var r=$d;$d|=1;var B=hg.transition,F=se;try{if(hg.transition=
null,se=1,n)return n()}finally{se=F,hg.transition=B,$d=r,0===($d&6)&&Nf()}}function Pi(){Rh=ol.current;$c(ol)}function mi(n,r){n.finishedWork=null;n.finishedLanes=0;var B=n.timeoutHandle;-1!==B&&(n.timeoutHandle=-1,Ij(B));if(null!==wf)for(B=wf.return;null!==B;){var F=B;cj(F);switch(F.tag){case 1:F=F.type.childContextTypes;null!==F&&void 0!==F&&jf();break;case 3:Md();$c($g);$c(Hg);ee();break;case 5:ed(F);break;case 4:Md();break;case 13:$c(ze);break;case 19:$c(ze);break;case 10:Lb(F.type._context);
break;case 22:case 23:Pi()}B=B.return}Pf=n;wf=n=Cf(n.current,null);df=Rh=r;bf=0;Ol=null;$m=Gj=kl=0;Jf=Pl=null;if(null!==Lg){for(r=0;r<Lg.length;r++)if(B=Lg[r],F=B.interleaved,null!==F){B.interleaved=null;var Q=F.next,V=B.pending;if(null!==V){var oa=V.next;V.next=Q;F.next=oa}B.pending=F}Lg=null}return n}function Mk(n,r){do{var B=wf;try{Zf=ch=xj=null;Yj.current=Mg;if(ml){for(var F=xe.memoizedState;null!==F;){var Q=F.queue;null!==Q&&(Q.pending=null);F=F.next}ml=!1}Bk=0;cg=Oe=xe=null;ll=!1;Kl=0;Ql.current=
null;if(null===B||null===B.return){bf=1;Ol=r;wf=null;break}a:{var V=n,oa=B.return,Ia=B,Ta=r;r=df;Ia.flags|=32768;if(null!==Ta&&"object"===typeof Ta&&"function"===typeof Ta.then){var tb=Ta,Zb=Ia,gc=Zb.tag;if(0===(Zb.mode&1)&&(0===gc||11===gc||15===gc)){var Pb=Zb.alternate;Pb?(Zb.updateQueue=Pb.updateQueue,Zb.memoizedState=Pb.memoizedState,Zb.lanes=Pb.lanes):(Zb.updateQueue=null,Zb.memoizedState=null)}var Ec=hj(oa);if(null!==Ec){Ec.flags&=-257;Aj(Ec,oa,Ia,V,r);Ec.mode&1&&Mi(V,tb,r);r=Ec;Ta=tb;var Oc=
r.updateQueue;if(null===Oc){var Kc=new Set;Kc.add(Ta);r.updateQueue=Kc}else Oc.add(Ta);break a}else{if(0===(r&1)){Mi(V,tb,r);zh();break a}Ta=Error(Na(426))}}else if(he&&Ia.mode&1){var Te=hj(oa);if(null!==Te){0===(Te.flags&65536)&&(Te.flags|=256);Aj(Te,oa,Ia,V,r);Ne(Nh(Ta,Ia));break a}}V=Ta=Nh(Ta,Ia);4!==bf&&(bf=2);null===Pl?Pl=[V]:Pl.push(V);V=oa;do{switch(V.tag){case 3:V.flags|=65536;r&=-r;V.lanes|=r;var gb=Oh(V,Ta,r);$f(V,gb);break a;case 1:Ia=Ta;var Xa=V.type,nb=V.stateNode;if(0===(V.flags&128)&&
("function"===typeof Xa.getDerivedStateFromError||null!==nb&&"function"===typeof nb.componentDidCatch&&(null===Li||!Li.has(nb)))){V.flags|=65536;r&=-r;V.lanes|=r;var ac=Ki(V,Ia,r);$f(V,ac);break a}}V=V.return}while(null!==V)}Jj(B)}catch(Qc){r=Qc;wf===B&&null!==B&&(wf=B.return);continue}break}while(1)}function nf(){var n=Im.current;Im.current=Mg;return null===n?Mg:n}function zh(){if(0===bf||3===bf||2===bf)bf=4;null===Pf||0===(kl&268435455)&&0===(Gj&268435455)||gh(Pf,df)}function Lk(n,r){var B=$d;$d|=
2;var F=nf();if(Pf!==n||df!==r)hh=null,mi(n,r);do try{for(;null!==wf;)ih(wf);break}catch(Q){Mk(n,Q)}while(1);Zf=ch=xj=null;$d=B;Im.current=F;if(null!==wf)throw Error(Na(261));Pf=null;df=0;return bf}function ih(n){var r=un(n.alternate,n,Rh);n.memoizedProps=n.pendingProps;null===r?Jj(n):wf=r;Ql.current=null}function Jj(n){var r=n;do{var B=r.alternate;n=r.return;if(0===(r.flags&32768)){if(B=ea(B,r,Rh),null!==B){wf=B;return}}else{B=ia(B,r);if(null!==B){B.flags&=32767;wf=B;return}if(null!==n)n.flags|=
32768,n.subtreeFlags=0,n.deletions=null;else{bf=6;wf=null;return}}r=r.sibling;if(null!==r){wf=r;return}wf=r=n}while(null!==r);0===bf&&(bf=5)}function Wg(n,r,B){var F=se,Q=hg.transition;try{hg.transition=null,se=1,Rl(n,r,B,F)}finally{hg.transition=Q,se=F}return null}function Rl(n,r,B,F){do li();while(null!==Nk);if(0!==($d&6))throw Error(Na(327));B=n.finishedWork;var Q=n.finishedLanes;if(null===B)return null;n.finishedWork=null;n.finishedLanes=0;if(B===n.current)throw Error(Na(177));n.callbackNode=
null;n.callbackPriority=0;var V=B.lanes|B.childLanes;Fc(n,V);n===Pf&&(wf=Pf=null,df=0);0===(B.subtreeFlags&2064)&&0===(B.flags&2064)||Km||(Km=!0,Nl(Wi,function(){li();return null}));V=0!==(B.flags&15990);if(0!==(B.subtreeFlags&15990)||V){V=hg.transition;hg.transition=null;var oa=se;se=1;var Ia=$d;$d|=4;Ql.current=null;Sa(n,B);ij(B,n);Ih(Ej);Oj=!!qm;Ej=qm=null;n.current=B;Mc(B,n,Q);sl();$d=Ia;se=oa;hg.transition=V}else n.current=B;Km&&(Km=!1,Nk=n,Lm=Q);V=n.pendingLanes;0===V&&(Li=null);ua(B.stateNode,
F);Xc(n,cf());if(null!==r)for(F=n.onRecoverableError,B=0;B<r.length;B++)Q=r[B],F(Q.value,{componentStack:Q.stack,digest:Q.digest});if(om)throw om=!1,n=Wm,Wm=null,n;0!==(Lm&1)&&0!==n.tag&&li();V=n.pendingLanes;0!==(V&1)?n===Hm?sm++:(sm=0,Hm=n):sm=0;Nf();return null}function li(){if(null!==Nk){var n=de(Lm),r=hg.transition,B=se;try{hg.transition=null;se=16>n?16:n;if(null===Nk)var F=!1;else{n=Nk;Nk=null;Lm=0;if(0!==($d&6))throw Error(Na(331));var Q=$d;$d|=4;for(Lc=n.current;null!==Lc;){var V=Lc,oa=V.child;
if(0!==(Lc.flags&16)){var Ia=V.deletions;if(null!==Ia){for(var Ta=0;Ta<Ia.length;Ta++){var tb=Ia[Ta];for(Lc=tb;null!==Lc;){var Zb=Lc;switch(Zb.tag){case 0:case 11:case 15:ab(8,Zb,V)}var gc=Zb.child;if(null!==gc)gc.return=Zb,Lc=gc;else for(;null!==Lc;){Zb=Lc;var Pb=Zb.sibling,Ec=Zb.return;Vb(Zb);if(Zb===tb){Lc=null;break}if(null!==Pb){Pb.return=Ec;Lc=Pb;break}Lc=Ec}}}var Oc=V.alternate;if(null!==Oc){var Kc=Oc.child;if(null!==Kc){Oc.child=null;do{var Te=Kc.sibling;Kc.sibling=null;Kc=Te}while(null!==
Kc)}}Lc=V}}if(0!==(V.subtreeFlags&2064)&&null!==oa)oa.return=V,Lc=oa;else a:for(;null!==Lc;){V=Lc;if(0!==(V.flags&2048))switch(V.tag){case 0:case 11:case 15:ab(9,V,V.return)}var gb=V.sibling;if(null!==gb){gb.return=V.return;Lc=gb;break a}Lc=V.return}}var Xa=n.current;for(Lc=Xa;null!==Lc;){oa=Lc;var nb=oa.child;if(0!==(oa.subtreeFlags&2064)&&null!==nb)nb.return=oa,Lc=nb;else a:for(oa=Xa;null!==Lc;){Ia=Lc;if(0!==(Ia.flags&2048))try{switch(Ia.tag){case 0:case 11:case 15:Qb(9,Ia)}}catch(Qc){Je(Ia,Ia.return,
Qc)}if(Ia===oa){Lc=null;break a}var ac=Ia.sibling;if(null!==ac){ac.return=Ia.return;Lc=ac;break a}Lc=Ia.return}}$d=Q;Nf();if(Yh&&"function"===typeof Yh.onPostCommitFiberRoot)try{Yh.onPostCommitFiberRoot(ig,n)}catch(Qc){}F=!0}return F}finally{se=B,hg.transition=r}}return!1}function Sf(n,r,B){r=Nh(B,r);r=Oh(n,r,1);n=Cb(n,r,1);r=ve();null!==n&&(Gc(n,1,r),Xc(n,r))}function Je(n,r,B){if(3===n.tag)Sf(n,n,B);else for(;null!==r;){if(3===r.tag){Sf(r,n,B);break}else if(1===r.tag){var F=r.stateNode;if("function"===
typeof r.type.getDerivedStateFromError||"function"===typeof F.componentDidCatch&&(null===Li||!Li.has(F))){n=Nh(B,n);n=Ki(r,n,1);r=Cb(r,n,1);n=ve();null!==r&&(Gc(r,1,n),Xc(r,n));break}}r=r.return}}function Ck(n,r,B){var F=n.pingCache;null!==F&&F.delete(r);r=ve();n.pingedLanes|=n.suspendedLanes&B;Pf===n&&(df&B)===B&&(4===bf||3===bf&&(df&130023424)===df&&500>cf()-Ml?mi(n,0):$m|=B);Xc(n,r)}function Kj(n,r){0===r&&(0===(n.mode&1)?r=1:(r=Sl,Sl<<=1,0===(Sl&130023424)&&(Sl=4194304)));var B=ve();n=Ed(n,r);
null!==n&&(Gc(n,r,B),Xc(n,B))}function Fk(n){var r=n.memoizedState,B=0;null!==r&&(B=r.retryLane);Kj(n,B)}function rm(n,r){var B=0;switch(n.tag){case 13:var F=n.stateNode,Q=n.memoizedState;null!==Q&&(B=Q.retryLane);break;case 19:F=n.stateNode;break;default:throw Error(Na(314));}null!==F&&F.delete(r);Kj(n,B)}function Nl(n,r){return rg(n,r)}function kj(n,r,B,F){this.tag=n;this.key=B;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=
r;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=F;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Of(n,r,B,F){return new kj(n,r,B,F)}function Dk(n){n=n.prototype;return!(!n||!n.isReactComponent)}function fk(n){if("function"===typeof n)return Dk(n)?1:0;if(void 0!==n&&null!==n){n=n.$$typeof;if(n===Nb)return 11;if(n===$b)return 14}return 2}function Cf(n,r){var B=n.alternate;null===B?(B=Of(n.tag,r,n.key,
n.mode),B.elementType=n.elementType,B.type=n.type,B.stateNode=n.stateNode,B.alternate=n,n.alternate=B):(B.pendingProps=r,B.type=n.type,B.flags=0,B.subtreeFlags=0,B.deletions=null);B.flags=n.flags&14680064;B.childLanes=n.childLanes;B.lanes=n.lanes;B.child=n.child;B.memoizedProps=n.memoizedProps;B.memoizedState=n.memoizedState;B.updateQueue=n.updateQueue;r=n.dependencies;B.dependencies=null===r?null:{lanes:r.lanes,firstContext:r.firstContext};B.sibling=n.sibling;B.index=n.index;B.ref=n.ref;return B}
function Uc(n,r,B,F,Q,V){var oa=2;F=n;if("function"===typeof n)Dk(n)&&(oa=1);else if("string"===typeof n)oa=5;else a:switch(n){case Za:return oc(B.children,Q,V,r);case sb:oa=8;Q|=8;break;case ob:return n=Of(12,B,r,Q|2),n.elementType=ob,n.lanes=V,n;case Ob:return n=Of(13,B,r,Q),n.elementType=Ob,n.lanes=V,n;case Jb:return n=Of(19,B,r,Q),n.elementType=Jb,n.lanes=V,n;case Bb:return Rg(B,Q,V,r);default:if("object"===typeof n&&null!==n)switch(n.$$typeof){case eb:oa=10;break a;case Db:oa=9;break a;case Nb:oa=
11;break a;case $b:oa=14;break a;case vc:oa=16;F=null;break a}throw Error(Na(130,null==n?n:typeof n,""));}r=Of(oa,B,r,Q);r.elementType=n;r.type=F;r.lanes=V;return r}function oc(n,r,B,F){n=Of(7,n,F,r);n.lanes=B;return n}function Rg(n,r,B,F){n=Of(22,n,F,r);n.elementType=Bb;n.lanes=B;n.stateNode={isHidden:!1};return n}function Ak(n,r,B){n=Of(6,n,null,r);n.lanes=B;return n}function Kg(n,r,B){r=Of(4,null!==n.children?n.children:[],n.key,r);r.lanes=B;r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,
implementation:n.implementation};return r}function lj(n,r,B,F,Q){this.tag=r;this.containerInfo=n;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=fc(0);this.expirationTimes=fc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=fc(0);this.identifierPrefix=
F;this.onRecoverableError=Q;this.mutableSourceEagerHydrationData=null}function Th(n,r,B,F,Q,V,oa,Ia,Ta){n=new lj(n,r,B,Ia,Ta);1===r?(r=1,!0===V&&(r|=8)):r=0;V=Of(3,null,null,r);n.current=V;V.stateNode=n;V.memoizedState={element:F,isDehydrated:B,cache:null,transitions:null,pendingSuspenseBoundaries:null};sg(V);return n}function Lj(n,r,B){var F=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Qa,key:null==F?null:""+F,children:n,containerInfo:r,implementation:B}}function tl(n){if(!n)return Wj;
n=n._reactInternals;a:{if(O(n)!==n||1!==n.tag)throw Error(Na(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break a;case 1:if(Vd(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break a}}r=r.return}while(null!==r);throw Error(Na(171));}if(1===n.tag){var B=n.type;if(Vd(B))return Xj(n,B,r)}return r}function gk(n,r,B,F,Q,V,oa,Ia,Ta){n=Th(B,F,!0,n,Q,V,oa,Ia,Ta);n.context=tl(null);B=n.current;F=ve();Q=fg(B);V=Eb(F,Q);V.callback=void 0!==r&&null!==r?r:null;Cb(B,V,Q);n.current.lanes=
Q;Gc(n,Q,F);Xc(n,F);return n}function Ah(n,r,B,F){var Q=r.current,V=ve(),oa=fg(Q);B=tl(B);null===r.context?r.context=B:r.pendingContext=B;r=Eb(V,oa);r.payload={element:n};F=void 0===F?null:F;null!==F&&(r.callback=F);n=Cb(Q,r,oa);null!==n&&(Xd(n,Q,oa,V),kd(n,Q,oa));return oa}function Si(n){n=n.current;if(!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Ok(n,r){n=n.memoizedState;if(null!==n&&null!==n.dehydrated){var B=n.retryLane;n.retryLane=
0!==B&&B<r?B:r}}function hk(n,r){Ok(n,r);(n=n.alternate)&&Ok(n,r)}function mj(){return null}function Ti(n){this._internalRoot=n}function Pk(n){this._internalRoot=n}function b(n){return!(!n||1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType)}function g(n){return!(!n||1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType&&(8!==n.nodeType||" react-mount-point-unstable "!==n.nodeValue))}function m(){}function u(n,r,B,F,Q){if(Q){if("function"===typeof F){var V=F;F=function(){var tb=Si(oa);V.call(tb)}}var oa=gk(r,
F,n,0,null,!1,!1,"",m);n._reactRootContainer=oa;n[bj]=oa.current;Eg(8===n.nodeType?n.parentNode:n);ni();return oa}for(;Q=n.lastChild;)n.removeChild(Q);if("function"===typeof F){var Ia=F;F=function(){var tb=Si(Ta);Ia.call(tb)}}var Ta=Th(n,0,!1,null,null,!1,!1,"",m);n._reactRootContainer=Ta;n[bj]=Ta.current;Eg(8===n.nodeType?n.parentNode:n);ni(function(){Ah(r,Ta,B,F)});return Ta}function z(n,r,B,F,Q){var V=B._reactRootContainer;if(V){var oa=V;if("function"===typeof Q){var Ia=Q;Q=function(){var Ta=Si(oa);
Ia.call(Ta)}}Ah(r,oa,n,Q)}else oa=u(B,r,n,Q,F);return Si(oa)}var C=Sd(2),G=Sd(5),K=new Set,R={},X=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),ca=Object.prototype.hasOwnProperty,ja=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
la={},pa={},ya={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ya[n]=new Va(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];ya[r]=new Va(r,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ya[n]=new Va(n,2,!1,n.toLowerCase(),
null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ya[n]=new Va(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ya[n]=new Va(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ya[n]=
new Va(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ya[n]=new Va(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ya[n]=new Va(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ya[n]=new Va(n,5,!1,n.toLowerCase(),null,!1,!1)});var Ba=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=
n.replace(Ba,Ab);ya[r]=new Va(r,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(Ba,Ab);ya[r]=new Va(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(Ba,Ab);ya[r]=new Va(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ya[n]=new Va(n,1,!1,n.toLowerCase(),null,!1,!1)});ya.xlinkHref=
new Va("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ya[n]=new Va(n,1,!1,n.toLowerCase(),null,!0,!0)});var za=C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ea=Symbol.for("react.element"),Qa=Symbol.for("react.portal"),Za=Symbol.for("react.fragment"),sb=Symbol.for("react.strict_mode"),ob=Symbol.for("react.profiler"),eb=Symbol.for("react.provider"),Db=Symbol.for("react.context"),Nb=Symbol.for("react.forward_ref"),Ob=
Symbol.for("react.suspense"),Jb=Symbol.for("react.suspense_list"),$b=Symbol.for("react.memo"),vc=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var Bb=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var Yc=Symbol.iterator,md=Object.assign,Bd,fd=!1,ud=Array.isArray,le,wd=function(n){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(r,B,F,Q){MSApp.execUnsafeLocalFunction(function(){return n(r,
B,F,Q)})}:n}(function(n,r){if("http://www.w3.org/2000/svg"!==n.namespaceURI||"innerHTML"in n)n.innerHTML=r;else{le=le||document.createElement("div");le.innerHTML="\x3csvg\x3e"+r.valueOf().toString()+"\x3c/svg\x3e";for(r=le.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}}),Fd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,
flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Df=["Webkit","ms","Moz","O"];Object.keys(Fd).forEach(function(n){Df.forEach(function(r){r=
r+n.charAt(0).toUpperCase()+n.substring(1);Fd[r]=Fd[n]})});var ff=md({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),we=null,ie=null,oe=null,ce=null,pf=!1,$i=!1;if(X)try{var xf={};Object.defineProperty(xf,"passive",{get:function(){$i=!0}});window.addEventListener("test",xf,xf);window.removeEventListener("test",xf,xf)}catch(n){$i=!1}var Ch=!1,Xh=null,Dh=!1,Fe=null,Se={onError:function(n){Ch=!0;Xh=n}},rg=G.unstable_scheduleCallback,
Hj=G.unstable_cancelCallback,ek=G.unstable_shouldYield,sl=G.unstable_requestPaint,cf=G.unstable_now,Yk=G.unstable_getCurrentPriorityLevel,nh=G.unstable_ImmediatePriority,rk=G.unstable_UserBlockingPriority,Wi=G.unstable_NormalPriority,sk=G.unstable_LowPriority,lg=G.unstable_IdlePriority,ig=null,Yh=null,oi=Math.clz32?Math.clz32:Aa,Bn=Math.log,jn=Math.LN2,Vk=64,Sl=4194304,se=0,Wk=!1,Cl=[],pi=null,jg=null,oj=null,pj=new Map,nk=new Map,Fh=[],Xk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" "),
pk=za.ReactCurrentBatchConfig,Oj=!0,rj=null,Xi=null,si=null,mg=null,ik={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},El=te(ik),Uh=md({},ik,{view:0,detail:0}),gm=te(Uh),an,Mm,ul,Tl=md({},Uh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pj,button:0,buttons:0,relatedTarget:function(n){return void 0===n.relatedTarget?n.fromElement===n.srcElement?n.toElement:
n.fromElement:n.relatedTarget},movementX:function(n){if("movementX"in n)return n.movementX;n!==ul&&(ul&&"mousemove"===n.type?(an=n.screenX-ul.screenX,Mm=n.screenY-ul.screenY):Mm=an=0,ul=n);return an},movementY:function(n){return"movementY"in n?n.movementY:Mm}}),cm=te(Tl),vl=md({},Tl,{dataTransfer:0}),dm=te(vl),vm=md({},Uh,{relatedTarget:0}),aj=te(vm),wm=md({},ik,{animationName:0,elapsedTime:0,pseudoElement:0}),gd=te(wm),Nm=md({},ik,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:
window.clipboardData}}),Tm=te(Nm),jh=md({},ik,{data:0}),yi=te(jh),me={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",
45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},Ul=md({},Uh,{key:function(n){if(n.key){var r=me[n.key]||n.key;if("Unidentified"!==r)return r}return"keypress"===n.type?(n=Bg(n),13===n?"Enter":String.fromCharCode(n)):"keydown"===n.type||"keyup"===n.type?xm[n.keyCode]||"Unidentified":""},code:0,location:0,
ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pj,charCode:function(n){return"keypress"===n.type?Bg(n):0},keyCode:function(n){return"keydown"===n.type||"keyup"===n.type?n.keyCode:0},which:function(n){return"keypress"===n.type?Bg(n):"keydown"===n.type||"keyup"===n.type?n.keyCode:0}}),Cm=te(Ul),bn=md({},Tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vj=te(bn),nj=md({},Uh,{touches:0,targetTouches:0,changedTouches:0,
altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pj}),em=te(nj),Bc=md({},ik,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zc=te(Bc),wl=md({},Tl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Sm=te(wl),Dl=[9,13,27,32],Ef=X&&"CompositionEvent"in window,yg=null;X&&"documentMode"in document&&(yg=document.documentMode);var Um=
X&&"TextEvent"in window&&!yg,mn=X&&(!Ef||yg&&8<yg&&11>=yg),ln=String.fromCharCode(32),am=!1,sj=!1,hf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Qj=null,ng=null,fl=!1;if(X){if(X){var Vl="oninput"in document;if(!Vl){var xl=document.createElement("div");xl.setAttribute("oninput","return;");Vl="function"===typeof xl.oninput}var Qk=Vl}else Qk=!1;fl=Qk&&(!document.documentMode||9<document.documentMode)}var qh=
"function"===typeof Object.is?Object.is:uk,hm=X&&"documentMode"in document&&11>=document.documentMode,Sj=null,al=null,vk=null,$k=!1,Tj={animationend:rh("Animation","AnimationEnd"),animationiteration:rh("Animation","AnimationIteration"),animationstart:rh("Animation","AnimationStart"),transitionend:rh("Transition","TransitionEnd")},bl={},Gl={};X&&(Gl=document.createElement("div").style,"AnimationEvent"in window||(delete Tj.animationend.animation,delete Tj.animationiteration.animation,delete Tj.animationstart.animation),
"TransitionEvent"in window||delete Tj.transitionend.transition);for(var dl=yf("animationend"),el=yf("animationiteration"),fm=yf("animationstart"),Uj=yf("transitionend"),cl=new Map,Wl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" "),
yl=0;yl<Wl.length;yl++){var jk=Wl[yl],ym=jk.toLowerCase(),Rk=jk[0].toUpperCase()+jk.slice(1);Jh(ym,"on"+Rk)}Jh(dl,"onAnimationEnd");Jh(el,"onAnimationIteration");Jh(fm,"onAnimationStart");Jh("dblclick","onDoubleClick");Jh("focusin","onFocus");Jh("focusout","onBlur");Jh(Uj,"onTransitionEnd");hb("onMouseEnter",["mouseout","mouseover"]);hb("onMouseLeave",["mouseout","mouseover"]);hb("onPointerEnter",["pointerout","pointerover"]);hb("onPointerLeave",["pointerout","pointerover"]);qc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));
qc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qc("onBeforeInput",["compositionend","keypress","textInput","paste"]);qc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hk="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),
bm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hk)),wk="_reactListening"+Math.random().toString(36).slice(2),Dm=/\r\n?/g,im=/\u0000|\uFFFD/g,qm=null,Ej=null,Jm="function"===typeof setTimeout?setTimeout:void 0,Ij="function"===typeof clearTimeout?clearTimeout:void 0,zm="function"===typeof Promise?Promise:void 0,sn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof zm?function(n){return zm.resolve(null).then(n).catch(Ai)}:Jm,kk=Math.random().toString(36).slice(2),
ai="__reactFiber$"+kk,gl="__reactProps$"+kk,bj="__reactContainer$"+kk,Hl="__reactEvents$"+kk,Zm="__reactListeners$"+kk,Ik="__reactHandles$"+kk,Il=[],yk=-1,Wj={},Hg=zf(Wj),$g=zf(!1),zk=Wj,ah=null,hl=!1,Em=!1,il=[],Ve=0,km=null,jm=0,Kh=[],ei=0,Ci=null,Lh=1,Bi="",uh=null,rf=null,he=!1,vh=null,ki=za.ReactCurrentBatchConfig,Bj=jl(!0),nl=jl(!1),ej=zf(null),xj=null,ch=null,Zf=null,Lg=null,ag=!1,Ye={},bg=zf(Ye),Jl=zf(Ye),Mh=zf(Ye),ze=zf(0),lm=[],Yj=za.ReactCurrentDispatcher,nm=za.ReactCurrentBatchConfig,
Bk=0,xe=null,Oe=null,cg=null,ml=!1,ll=!1,Kl=0,Xl=0,Mg={readContext:Xe,useCallback:Ie,useContext:Ie,useEffect:Ie,useImperativeHandle:Ie,useInsertionEffect:Ie,useLayoutEffect:Ie,useMemo:Ie,useReducer:Ie,useRef:Ie,useState:Ie,useDebugValue:Ie,useDeferredValue:Ie,useTransition:Ie,useMutableSource:Ie,useSyncExternalStore:Ie,useId:Ie,unstable_isNewReconciler:!1},nn={readContext:Xe,useCallback:function(n,r){tg().memoizedState=[n,void 0===r?null:r];return n},useContext:Xe,useEffect:yj,useImperativeHandle:function(n,
r,B){B=null!==B&&void 0!==B?B.concat([n]):null;return Og(4194308,4,Hi.bind(null,r,n),B)},useLayoutEffect:function(n,r){return Og(4194308,4,n,r)},useInsertionEffect:function(n,r){return Og(4,2,n,r)},useMemo:function(n,r){var B=tg();r=void 0===r?null:r;n=n();B.memoizedState=[n,r];return n},useReducer:function(n,r,B){var F=tg();r=void 0!==B?B(r):r;F.memoizedState=F.baseState=r;n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r};F.queue=n;n=n.dispatch=Re.bind(null,
xe,n);return[F.memoizedState,n]},useRef:function(n){var r=tg();n={current:n};return r.memoizedState=n},useState:Ng,useDebugValue:gi,useDeferredValue:function(n){return tg().memoizedState=n},useTransition:function(){var n=Ng(!1),r=n[0];n=Wc.bind(null,n[1]);tg().memoizedState=n;return[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,B){var F=xe,Q=tg();if(he){if(void 0===B)throw Error(Na(407));B=B()}else{B=r();if(null===Pf)throw Error(Na(349));0!==(Bk&30)||Hf(F,r,B)}Q.memoizedState=
B;var V={value:B,getSnapshot:r};Q.queue=V;yj(Pe.bind(null,F,V,n),[n]);F.flags|=2048;Qe(9,af.bind(null,F,V,B,r),void 0,null);return B},useId:function(){var n=tg(),r=Pf.identifierPrefix;if(he){var B=Bi,F=Lh;B=(F&~(1<<32-oi(F)-1)).toString(32)+B;r=":"+r+"R"+B;B=Kl++;0<B&&(r+="H"+B.toString(32));r+=":"}else B=Xl++,r=":"+r+"r"+B.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},Vm={readContext:Xe,useCallback:hi,useContext:Xe,useEffect:$e,useImperativeHandle:eg,useInsertionEffect:Pg,
useLayoutEffect:Gi,useMemo:zj,useReducer:ye,useRef:eh,useState:function(){return ye(Ad)},useDebugValue:gi,useDeferredValue:function(n){var r=fe();return wh(r,Oe.memoizedState,n)},useTransition:function(){var n=ye(Ad)[0],r=fe().memoizedState;return[n,r]},useMutableSource:tf,useSyncExternalStore:Ce,useId:xh,unstable_isNewReconciler:!1},mm={readContext:Xe,useCallback:hi,useContext:Xe,useEffect:$e,useImperativeHandle:eg,useInsertionEffect:Pg,useLayoutEffect:Gi,useMemo:zj,useReducer:dg,useRef:eh,useState:function(){return dg(Ad)},
useDebugValue:gi,useDeferredValue:function(n){var r=fe();return null===Oe?r.memoizedState=n:wh(r,Oe.memoizedState,n)},useTransition:function(){var n=dg(Ad)[0],r=fe().memoizedState;return[n,r]},useMutableSource:tf,useSyncExternalStore:Ce,useId:xh,unstable_isNewReconciler:!1},Ll={isMounted:function(n){return(n=n._reactInternals)?O(n)===n:!1},enqueueSetState:function(n,r,B){n=n._reactInternals;var F=ve(),Q=fg(n),V=Eb(F,Q);V.payload=r;void 0!==B&&null!==B&&(V.callback=B);r=Cb(n,V,Q);null!==r&&(Xd(r,n,
Q,F),kd(r,n,Q))},enqueueReplaceState:function(n,r,B){n=n._reactInternals;var F=ve(),Q=fg(n),V=Eb(F,Q);V.tag=1;V.payload=r;void 0!==B&&null!==B&&(V.callback=B);r=Cb(n,V,Q);null!==r&&(Xd(r,n,Q,F),kd(r,n,Q))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var B=ve(),F=fg(n),Q=Eb(B,F);Q.tag=2;void 0!==r&&null!==r&&(Q.callback=r);r=Cb(n,Q,F);null!==r&&(Xd(r,n,F,B),kd(r,n,F))}},on="function"===typeof WeakMap?WeakMap:Map,pn=za.ReactCurrentOwner,dh=!1,pm={dehydrated:null,treeContext:null,retryLane:0};
var rn=function(n,r){for(var B=r.child;null!==B;){if(5===B.tag||6===B.tag)n.appendChild(B.stateNode);else if(4!==B.tag&&null!==B.child){B.child.return=B;B=B.child;continue}if(B===r)break;for(;null===B.sibling;){if(null===B.return||B.return===r)return;B=B.return}B.sibling.return=B.return;B=B.sibling}};var Xm=function(){};var qn=function(n,r,B,F){var Q=n.memoizedProps;if(Q!==F){n=r.stateNode;Ld(bg.current);var V=null;switch(B){case "input":Q=Hc(n,Q);F=Hc(n,F);V=[];break;case "select":Q=md({},Q,{value:void 0});
F=md({},F,{value:void 0});V=[];break;case "textarea":Q=Nc(n,Q);F=Nc(n,F);V=[];break;default:"function"!==typeof Q.onClick&&"function"===typeof F.onClick&&(n.onclick=zi)}Tc(B,F);var oa;B=null;for(tb in Q)if(!F.hasOwnProperty(tb)&&Q.hasOwnProperty(tb)&&null!=Q[tb])if("style"===tb){var Ia=Q[tb];for(oa in Ia)Ia.hasOwnProperty(oa)&&(B||(B={}),B[oa]="")}else"dangerouslySetInnerHTML"!==tb&&"children"!==tb&&"suppressContentEditableWarning"!==tb&&"suppressHydrationWarning"!==tb&&"autoFocus"!==tb&&(R.hasOwnProperty(tb)?
V||(V=[]):(V=V||[]).push(tb,null));for(tb in F){var Ta=F[tb];Ia=null!=Q?Q[tb]:void 0;if(F.hasOwnProperty(tb)&&Ta!==Ia&&(null!=Ta||null!=Ia))if("style"===tb)if(Ia){for(oa in Ia)!Ia.hasOwnProperty(oa)||Ta&&Ta.hasOwnProperty(oa)||(B||(B={}),B[oa]="");for(oa in Ta)Ta.hasOwnProperty(oa)&&Ia[oa]!==Ta[oa]&&(B||(B={}),B[oa]=Ta[oa])}else B||(V||(V=[]),V.push(tb,B)),B=Ta;else"dangerouslySetInnerHTML"===tb?(Ta=Ta?Ta.__html:void 0,Ia=Ia?Ia.__html:void 0,null!=Ta&&Ia!==Ta&&(V=V||[]).push(tb,Ta)):"children"===
tb?"string"!==typeof Ta&&"number"!==typeof Ta||(V=V||[]).push(tb,""+Ta):"suppressContentEditableWarning"!==tb&&"suppressHydrationWarning"!==tb&&(R.hasOwnProperty(tb)?(null!=Ta&&"onScroll"===tb&&Ud("scroll",n),V||Ia===Ta||(V=[])):(V=V||[]).push(tb,Ta))}B&&(V=V||[]).push("style",B);var tb;if(r.updateQueue=V)r.flags|=4}};var pl=function(n,r,B,F){B!==F&&(r.flags|=4)};var ck=!1,xg=!1,Fm="function"===typeof WeakSet?WeakSet:Set,Lc=null,Ym=!1,Tg=null,Qi=!1,tn=Math.ceil,Im=za.ReactCurrentDispatcher,Ql=za.ReactCurrentOwner,
hg=za.ReactCurrentBatchConfig,$d=0,Pf=null,wf=null,df=0,Rh=0,ol=zf(0),bf=0,Ol=null,kl=0,Gj=0,$m=0,Pl=null,Jf=null,Ml=0,ql=Infinity,hh=null,om=!1,Wm=null,Li=null,Km=!1,Nk=null,Lm=0,sm=0,Hm=null,Gm=-1,Kk=0;var un=function(n,r,B){if(null!==n)if(n.memoizedProps!==r.pendingProps||$g.current)dh=!0;else{if(0===(n.lanes&B)&&0===(r.flags&128))return dh=!1,E(n,r,B);dh=0!==(n.flags&131072)?!0:!1}else dh=!1,he&&0!==(r.flags&1048576)&&th(r,jm,r.index);r.lanes=0;switch(r.tag){case 2:var F=r.type;t(n,r);n=r.pendingProps;
var Q=Wf(r,Hg.current);ue(r,B);Q=Da(null,r,F,n,Q,B);var V=Fi();r.flags|=1;"object"===typeof Q&&null!==Q&&"function"===typeof Q.render&&void 0===Q.$$typeof?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Vd(F)?(V=!0,ci(r)):V=!1,r.memoizedState=null!==Q.state&&void 0!==Q.state?Q.state:null,sg(r),Q.updater=Ll,r.stateNode=Q,Q._reactInternals=r,Ji(r,F,n,B),r=wg(null,r,F,!0,V,B)):(r.tag=0,he&&V&&Di(r),uf(null,r,Q,B),r=r.child);return r;case 16:F=r.elementType;a:{t(n,r);n=r.pendingProps;Q=F._init;F=Q(F._payload);
r.type=F;Q=r.tag=fk(F);n=je(F,n);switch(Q){case 0:r=Nd(null,r,F,n,B);break a;case 1:r=vf(null,r,F,n,B);break a;case 11:r=Ph(null,r,F,n,B);break a;case 14:r=Cj(null,r,F,je(F.type,n),B);break a}throw Error(Na(306,F,""));}return r;case 0:return F=r.type,Q=r.pendingProps,Q=r.elementType===F?Q:je(F,Q),Nd(n,r,F,Q,B);case 1:return F=r.type,Q=r.pendingProps,Q=r.elementType===F?Q:je(F,Q),vf(n,r,F,Q,B);case 3:a:{Ni(r);if(null===n)throw Error(Na(387));F=r.pendingProps;V=r.memoizedState;Q=V.element;He(n,r);sf(r,
F,null,B);var oa=r.memoizedState;F=oa.element;if(V.isDehydrated)if(V={element:F,isDehydrated:!1,cache:oa.cache,pendingSuspenseBoundaries:oa.pendingSuspenseBoundaries,transitions:oa.transitions},r.updateQueue.baseState=V,r.memoizedState=V,r.flags&256){Q=Nh(Error(Na(423)),r);Bf();Ne(Q);r.flags|=256;uf(n,r,F,B);r=r.child;break a}else if(F!==Q){Q=Nh(Error(Na(424)),r);Bf();Ne(Q);r.flags|=256;uf(n,r,F,B);r=r.child;break a}else for(rf=Ff(r.stateNode.containerInfo.firstChild),uh=r,he=!0,vh=null,B=nl(r,null,
F,B),r.child=B;B;)B.flags=B.flags&-3|4096,B=B.sibling;else{Bf();if(F===Q){r=A(n,r,B);break a}uf(n,r,F,B)}r=r.child}return r;case 5:return dd(r),null===n&&Xf(r),F=r.type,Q=r.pendingProps,V=null!==n?n.memoizedProps:null,oa=Q.children,qf(F,Q)?oa=null:null!==V&&qf(F,V)&&(r.flags|=32),vg(n,r),uf(n,r,oa,B),r.child;case 6:return null===n&&Xf(r),null;case 13:return ii(n,r,B);case 4:return yd(r,r.stateNode.containerInfo),F=r.pendingProps,null===n?r.child=Bj(r,null,F,B):uf(n,r,F,B),r.child;case 11:return F=
r.type,Q=r.pendingProps,Q=r.elementType===F?Q:je(F,Q),Ph(n,r,F,Q,B);case 7:return uf(n,r,r.pendingProps,B),r.child;case 8:return uf(n,r,r.pendingProps.children,B),r.child;case 12:return uf(n,r,r.pendingProps.children,B),r.child;case 10:a:{F=r.type._context;Q=r.pendingProps;V=r.memoizedProps;oa=Q.value;Zd(ej,F._currentValue);F._currentValue=oa;if(null!==V)if(qh(V.value,oa)){if(V.children===Q.children&&!$g.current){r=A(n,r,B);break a}}else for(V=r.child,null!==V&&(V.return=r);null!==V;){var Ia=V.dependencies;
if(null!==Ia){oa=V.child;for(var Ta=Ia.firstContext;null!==Ta;){if(Ta.context===F){if(1===V.tag){Ta=Eb(-1,B&-B);Ta.tag=2;var tb=V.updateQueue;if(null!==tb){tb=tb.shared;var Zb=tb.pending;null===Zb?Ta.next=Ta:(Ta.next=Zb.next,Zb.next=Ta);tb.pending=Ta}}V.lanes|=B;Ta=V.alternate;null!==Ta&&(Ta.lanes|=B);nd(V.return,B,r);Ia.lanes|=B;break}Ta=Ta.next}}else if(10===V.tag)oa=V.type===r.type?null:V.child;else if(18===V.tag){oa=V.return;if(null===oa)throw Error(Na(341));oa.lanes|=B;Ia=oa.alternate;null!==
Ia&&(Ia.lanes|=B);nd(oa,B,r);oa=V.sibling}else oa=V.child;if(null!==oa)oa.return=V;else for(oa=V;null!==oa;){if(oa===r){oa=null;break}V=oa.sibling;if(null!==V){V.return=oa.return;oa=V;break}oa=oa.return}V=oa}uf(n,r,Q.children,B);r=r.child}return r;case 9:return Q=r.type,F=r.pendingProps.children,ue(r,B),Q=Xe(Q),F=F(Q),r.flags|=1,uf(n,r,F,B),r.child;case 14:return F=r.type,Q=je(F,r.pendingProps),Q=je(F.type,Q),Cj(n,r,F,Q,B);case 15:return yh(n,r,r.type,r.pendingProps,B);case 17:return F=r.type,Q=r.pendingProps,
Q=r.elementType===F?Q:je(F,Q),t(n,r),r.tag=1,Vd(F)?(n=!0,ci(r)):n=!1,ue(r,B),Qg(r,F,Q),Ji(r,F,Q,B),wg(null,r,F,!0,n,B);case 19:return Gk(n,r,B);case 22:return Qh(n,r,B)}throw Error(Na(156,r.tag));};var ae="function"===typeof reportError?reportError:function(n){console.error(n)};Pk.prototype.render=Ti.prototype.render=function(n){var r=this._internalRoot;if(null===r)throw Error(Na(409));Ah(n,r,null,null)};Pk.prototype.unmount=Ti.prototype.unmount=function(){var n=this._internalRoot;if(null!==n){this._internalRoot=
null;var r=n.containerInfo;ni(function(){Ah(null,n,null,null)});r[bj]=null}};Pk.prototype.unstable_scheduleHydration=function(n){if(n){var r=Sk();n={blockedOn:null,target:n,priority:r};for(var B=0;B<Fh.length&&0!==r&&r<Fh[B].priority;B++);Fh.splice(B,0,n);0===B&&Lf(n)}};var Rm=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var B=Ua(r.pendingLanes);0!==B&&(Hd(r,B|1),Xc(r,cf()),0===($d&6)&&(ql=cf()+500,Nf()))}break;case 13:ni(function(){var F=Ed(n,1);if(null!==
F){var Q=ve();Xd(F,n,1,Q)}}),hk(n,1)}};var Zl=function(n){if(13===n.tag){var r=Ed(n,134217728);if(null!==r){var B=ve();Xd(r,n,134217728,B)}hk(n,134217728)}};var kn=function(n){if(13===n.tag){var r=fg(n),B=Ed(n,r);if(null!==B){var F=ve();Xd(B,n,r,F)}hk(n,r)}};var Sk=function(){return se};var $l=function(n,r){var B=se;try{return se=n,r()}finally{se=B}};ie=function(n,r,B){switch(r){case "input":sd(n,B);r=B.name;if("radio"===B.type&&null!=r){for(B=n;B.parentNode;)B=B.parentNode;B=B.querySelectorAll("input[name\x3d"+
JSON.stringify(""+r)+'][type\x3d"radio"]');for(r=0;r<B.length;r++){var F=B[r];if(F!==n&&F.form===n.form){var Q=Ee(F);if(!Q)throw Error(Na(90));lc(F);sd(F,Q)}}}break;case "textarea":Ic(n,B);break;case "select":r=B.value,null!=r&&xc(n,!!B.multiple,r,!1)}};Cd=jj;Gd=ni;var Am={usingClientEntryPoint:!1,Events:[Td,Mf,Ee,Pc,td,jj]},Tk={findFiberByHostInstance:kg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Cn={bundleType:Tk.bundleType,version:Tk.version,rendererPackageName:Tk.rendererPackageName,
rendererConfig:Tk.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:za.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){n=ra(n);return null===n?null:n.stateNode},findFiberByHostInstance:Tk.findFiberByHostInstance||mj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,
setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Om=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Om.isDisabled&&Om.supportsFiber)try{ig=Om.inject(Cn),Yh=Om}catch(n){}}ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Am;ba.createPortal=function(n,r){var B=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!b(r))throw Error(Na(200));return Lj(n,r,null,B)};ba.createRoot=function(n,r){if(!b(n))throw Error(Na(299));
var B=!1,F="",Q=ae;null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(B=!0),void 0!==r.identifierPrefix&&(F=r.identifierPrefix),void 0!==r.onRecoverableError&&(Q=r.onRecoverableError));r=Th(n,1,!1,null,null,B,!1,F,Q);n[bj]=r.current;Eg(8===n.nodeType?n.parentNode:n);return new Ti(r)};ba.findDOMNode=function(n){if(null==n)return null;if(1===n.nodeType)return n;var r=n._reactInternals;if(void 0===r){if("function"===typeof n.render)throw Error(Na(188));n=Object.keys(n).join(",");throw Error(Na(268,
n));}n=ra(r);return n=null===n?null:n.stateNode};ba.flushSync=function(n){return ni(n)};ba.hydrate=function(n,r,B){if(!g(r))throw Error(Na(200));return z(null,n,r,!0,B)};ba.hydrateRoot=function(n,r,B){if(!b(n))throw Error(Na(405));var F=null!=B&&B.hydratedSources||null,Q=!1,V="",oa=ae;null!==B&&void 0!==B&&(!0===B.unstable_strictMode&&(Q=!0),void 0!==B.identifierPrefix&&(V=B.identifierPrefix),void 0!==B.onRecoverableError&&(oa=B.onRecoverableError));r=gk(r,null,n,1,null!=B?B:null,Q,!1,V,oa);n[bj]=
r.current;Eg(n);if(F)for(n=0;n<F.length;n++)B=F[n],Q=B._getVersion,Q=Q(B._source),null==r.mutableSourceEagerHydrationData?r.mutableSourceEagerHydrationData=[B,Q]:r.mutableSourceEagerHydrationData.push(B,Q);return new Pk(r)};ba.render=function(n,r,B){if(!g(r))throw Error(Na(200));return z(null,n,r,!1,B)};ba.unmountComponentAtNode=function(n){if(!g(n))throw Error(Na(40));return n._reactRootContainer?(ni(function(){z(null,null,n,!1,function(){n._reactRootContainer=null;n[bj]=null})}),!0):!1};ba.unstable_batchedUpdates=
jj;ba.unstable_renderSubtreeIntoContainer=function(n,r,B,F){if(!g(B))throw Error(Na(200));if(null==n||void 0===n._reactInternals)throw Error(Na(38));return z(n,r,B,!1,F)};ba.version="18.3.1-next-f1338f8080-20240426"};
shadow$provide[8]=function(Le,Sd,Yd,ba){function Na(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Na)}catch(qc){console.error(qc)}}Na();Yd.exports=Sd(6)};
shadow$provide[9]=function(Le,Sd,Yd,ba){Le=Sd(8);ba.createRoot=Le.createRoot;ba.hydrateRoot=Le.hydrateRoot};
shadow$provide[10]=function(Le,Sd,Yd,ba){function Na(){const a=4294967295*Math.random()|0,c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,h=4294967295*Math.random()|0;return(Ne[a&255]+Ne[a>>8&255]+Ne[a>>16&255]+Ne[a>>24&255]+"-"+Ne[c&255]+Ne[c>>8&255]+"-"+Ne[c>>16&15|64]+Ne[c>>24&255]+"-"+Ne[e&63|128]+Ne[e>>8&255]+"-"+Ne[e>>16&255]+Ne[e>>24&255]+Ne[h&255]+Ne[h>>8&255]+Ne[h>>16&255]+Ne[h>>24&255]).toLowerCase()}function qc(a,c,e){return Math.max(c,Math.min(e,a))}function hb(a,c){return(a%
c+c)%c}function M(a,c,e){return(1-e)*a+e*c}function v(a,c){switch(c.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.");}}function ta(a,c){switch(c.constructor){case Float32Array:return a;case Uint32Array:return Math.round(4294967295*
a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(2147483647*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw Error("Invalid component type.");}}function Va(a){for(let c=a.length-1;0<=c;--c)if(65535<=a[c])return!0;return!1}function Ab(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function $a(){const a=Ab("canvas");a.style.display="block";return a}function Sb(a){a in
hc||(hc[a]=!0,console.warn(a))}function na(a,c,e){return new Promise(function(h,l){function p(){switch(a.clientWaitSync(c,a.SYNC_FLUSH_COMMANDS_BIT,0)){case a.WAIT_FAILED:l();break;case a.TIMEOUT_EXPIRED:setTimeout(p,e);break;default:h()}}setTimeout(p,e)})}function bb(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function tc(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}function vb(a){if("undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!==
typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap)return kd.getDataURL(a);if(a.data)return{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name};console.warn("THREE.Texture: Unable to serialize Texture.");return{}}function Pa(a,c,e,h,l){for(let p=0,w=a.length-3;p<=w;p+=3){eh.fromArray(a,p);const x=l.x*Math.abs(eh.x)+l.y*Math.abs(eh.y)+l.z*Math.abs(eh.z),y=c.dot(eh),D=e.dot(eh),H=h.dot(eh);if(Math.max(-Math.max(y,
D,H),Math.min(y,D,H))>x)return!1}return!0}function yb(a,c,e){0>e&&(e+=1);1<e&&--e;return e<1/6?a+6*(c-a)*e:.5>e?c:e<2/3?a+6*(c-a)*(2/3-e):a}function Ib(a){65504<Math.abs(a)&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range.");a=qc(a,-65504,65504);Qb.floatView[0]=a;a=Qb.uint32View[0];const c=a>>23&511;return Qb.baseTable[c]+((a&8388607)>>Qb.shiftTable[c])}function Fb(a){const c=a>>10;Qb.uint32View[0]=Qb.mantissaTable[Qb.offsetTable[c]+(a&1023)]+Qb.exponentTable[c];return Qb.floatView[0]}
function zb(a,c,e,h,l,p,w,x,y,D){a.getVertexPosition(x,gh);a.getVertexPosition(y,dk);a.getVertexPosition(D,jj);null===(1===c.side?h.intersectTriangle(jj,dk,gh,!0,mi):h.intersectTriangle(gh,dk,jj,0===c.side,mi))?a=null:(Mk.copy(mi),Mk.applyMatrix4(a.matrixWorld),c=e.ray.origin.distanceTo(Mk),a=c<e.near||c>e.far?null:{distance:c,point:Mk.clone(),object:a});a&&(e=new Da,E.getBarycoord(mi,gh,dk,jj,e),l&&(a.uv=E.getInterpolatedAttribute(l,x,y,D,e,new Lb)),p&&(a.uv1=E.getInterpolatedAttribute(p,x,y,D,e,
new Lb)),w&&(a.normal=E.getInterpolatedAttribute(w,x,y,D,e,new Da),0<a.normal.dot(h.direction)&&a.normal.multiplyScalar(-1)),h={a:x,b:y,c:D,normal:new Da,materialIndex:0},E.getNormal(gh,dk,jj,h.normal),a.face=h,a.barycoord=e);return a}function lc(a){const c={};for(const e in a){c[e]={};for(const h in a[e]){const l=a[e][h];l&&(l.isColor||l.isMatrix3||l.isMatrix4||l.isVector2||l.isVector3||l.isVector4||l.isTexture||l.isQuaternion)?l.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),
c[e][h]=null):c[e][h]=l.clone():Array.isArray(l)?c[e][h]=l.slice():c[e][h]=l}}return c}function bc(a){const c={};for(let e=0;e<a.length;e++){const h=lc(a[e]);for(const l in h)c[l]=h[l]}return c}function Hc(a){const c=a.getRenderTarget();return null===c?a.outputColorSpace:!0===c.isXRRenderTarget?c.texture.colorSpace:Eb.workingColorSpace}function Jc(){function a(p,w){h(p,w);l=c.requestAnimationFrame(a)}let c=null,e=!1,h=null,l=null;return{start:function(){!0!==e&&null!==h&&(l=c.requestAnimationFrame(a),
e=!0)},stop:function(){c.cancelAnimationFrame(l);e=!1},setAnimationLoop:function(p){h=p},setContext:function(p){c=p}}}function id(a){function c(h,l,p){const w=l.array,x=l.updateRanges;a.bindBuffer(p,h);if(0===x.length)a.bufferSubData(p,0,w);else{x.sort((y,D)=>y.start-D.start);h=0;for(let y=1;y<x.length;y++){const D=x[h],H=x[y];H.start<=D.start+D.count+1?D.count=Math.max(D.count,H.start+H.count-D.start):(++h,x[h]=H)}x.length=h+1;for(let y=0,D=x.length;y<D;y++)h=x[y],a.bufferSubData(p,h.start*w.BYTES_PER_ELEMENT,
w,h.start,h.count);l.clearUpdateRanges()}l.onUploadCallback()}const e=new WeakMap;return{get:function(h){h.isInterleavedBufferAttribute&&(h=h.data);return e.get(h)},remove:function(h){h.isInterleavedBufferAttribute&&(h=h.data);const l=e.get(h);l&&(a.deleteBuffer(l.buffer),e.delete(h))},update:function(h,l){h.isInterleavedBufferAttribute&&(h=h.data);if(h.isGLBufferAttribute)l=e.get(h),(!l||l.version<h.version)&&e.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});
else{var p=e.get(h);if(void 0===p){p=e.set;var w=h;const x=h.array,y=h.usage,D=x.byteLength,H=a.createBuffer();a.bindBuffer(l,H);a.bufferData(l,x,y);h.onUploadCallback();if(x instanceof Float32Array)l=a.FLOAT;else if(x instanceof Uint16Array)l=h.isFloat16BufferAttribute?a.HALF_FLOAT:a.UNSIGNED_SHORT;else if(x instanceof Int16Array)l=a.SHORT;else if(x instanceof Uint32Array)l=a.UNSIGNED_INT;else if(x instanceof Int32Array)l=a.INT;else if(x instanceof Int8Array)l=a.BYTE;else if(x instanceof Uint8Array)l=
a.UNSIGNED_BYTE;else if(x instanceof Uint8ClampedArray)l=a.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+x);p.call(e,w,{buffer:H,type:l,bytesPerElement:x.BYTES_PER_ELEMENT,version:h.version,size:D})}else if(p.version<h.version){if(p.size!==h.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");c(p.buffer,h,l);p.version=h.version}}}}}
function sd(a,c,e,h,l,p,w){function x(aa){let T=!0===aa.isScene?aa.background:null;T&&T.isTexture&&(T=(0<aa.backgroundBlurriness?e:c).get(T));return T}function y(aa,T){aa.getRGB(Ak,Hc(a));h.buffers.color.setClear(Ak.r,Ak.g,Ak.b,T,w)}const D=new ia(0);let H=!0===p?0:1,I,L,Y=null,P=0,Z=null;return{getClearColor:function(){return D},setClearColor:function(aa,T=1){D.set(aa);H=T;y(D,H)},getClearAlpha:function(){return H},setClearAlpha:function(aa){H=aa;y(D,H)},render:function(aa){let T=!1;aa=x(aa);null===
aa?y(D,H):aa&&aa.isColor&&(y(aa,1),T=!0);aa=a.xr.getEnvironmentBlendMode();"additive"===aa?h.buffers.color.setClear(0,0,0,1,w):"alpha-blend"===aa&&h.buffers.color.setClear(0,0,0,0,w);if(a.autoClear||T)h.buffers.depth.setTest(!0),h.buffers.depth.setMask(!0),h.buffers.color.setMask(!0),a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil)},addToRenderList:function(aa,T){const ha=x(T);if(ha&&(ha.isCubeTexture||306===ha.mapping)){void 0===L&&(L=new nf(new zh(1,1,1),new ih({name:"BackgroundCubeMaterial",
uniforms:lc(Rg.backgroundCube.uniforms),vertexShader:Rg.backgroundCube.vertexShader,fragmentShader:Rg.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),L.geometry.deleteAttribute("normal"),L.geometry.deleteAttribute("uv"),L.onBeforeRender=function(Ca,xa,Ha){this.matrixWorld.copyPosition(Ha.matrixWorld)},Object.defineProperty(L.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),l.update(L));Kg.copy(T.backgroundRotation);Kg.x*=-1;Kg.y*=-1;Kg.z*=-1;ha.isCubeTexture&&
!1===ha.isRenderTargetTexture&&(Kg.y*=-1,Kg.z*=-1);L.material.uniforms.envMap.value=ha;L.material.uniforms.flipEnvMap.value=ha.isCubeTexture&&!1===ha.isRenderTargetTexture?-1:1;L.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness;L.material.uniforms.backgroundIntensity.value=T.backgroundIntensity;L.material.uniforms.backgroundRotation.value.setFromMatrix4(lj.makeRotationFromEuler(Kg));L.material.toneMapped="srgb"!==Eb.getTransfer(ha.colorSpace);if(Y!==ha||P!==ha.version||Z!==a.toneMapping)L.material.needsUpdate=
!0,Y=ha,P=ha.version,Z=a.toneMapping;L.layers.enableAll();aa.unshift(L,L.geometry,L.material,0,0,null)}else if(ha&&ha.isTexture){void 0===I&&(I=new nf(new Cf(2,2),new ih({name:"BackgroundMaterial",uniforms:lc(Rg.background.uniforms),vertexShader:Rg.background.vertexShader,fragmentShader:Rg.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),l.update(I));I.material.uniforms.t2D.value=
ha;I.material.uniforms.backgroundIntensity.value=T.backgroundIntensity;I.material.toneMapped="srgb"!==Eb.getTransfer(ha.colorSpace);!0===ha.matrixAutoUpdate&&ha.updateMatrix();I.material.uniforms.uvTransform.value.copy(ha.matrix);if(Y!==ha||P!==ha.version||Z!==a.toneMapping)I.material.needsUpdate=!0,Y=ha,P=ha.version,Z=a.toneMapping;I.layers.enableAll();aa.unshift(I,I.geometry,I.material,0,0,null)}}}}function Dc(a,c){function e(P){const Z=[],aa=[],T=[];for(let ha=0;ha<D;ha++)Z[ha]=0,aa[ha]=0,T[ha]=
0;return{geometry:null,program:null,wireframe:!1,newAttributes:Z,enabledAttributes:aa,attributeDivisors:T,object:P,attributes:{},index:null}}function h(){const P=L.newAttributes;for(let Z=0,aa=P.length;Z<aa;Z++)P[Z]=0}function l(P){p(P,0)}function p(P,Z){const aa=L.enabledAttributes,T=L.attributeDivisors;L.newAttributes[P]=1;0===aa[P]&&(a.enableVertexAttribArray(P),aa[P]=1);T[P]!==Z&&(a.vertexAttribDivisor(P,Z),T[P]=Z)}function w(){const P=L.newAttributes,Z=L.enabledAttributes;for(let aa=0,T=Z.length;aa<
T;aa++)Z[aa]!==P[aa]&&(a.disableVertexAttribArray(aa),Z[aa]=0)}function x(){y();Y=!0;L!==I&&(L=I,a.bindVertexArray(L.object))}function y(){I.geometry=null;I.program=null;I.wireframe=!1}const D=a.getParameter(a.MAX_VERTEX_ATTRIBS),H={},I=e(null);let L=I,Y=!1;return{setup:function(P,Z,aa,T,ha){var Ca=!0===Z.wireframe;var xa=H[T.id];void 0===xa&&(xa={},H[T.id]=xa);var Ha=xa[aa.id];void 0===Ha&&(Ha={},xa[aa.id]=Ha);xa=Ha[Ca];void 0===xa&&(xa=e(a.createVertexArray()),Ha[Ca]=xa);Ca=xa;L!==Ca&&(L=Ca,a.bindVertexArray(L.object));
a:{Ca=L.attributes;Ha=T.attributes;xa=0;var Fa=aa.getAttributes();for(Ka in Fa)if(0<=Fa[Ka].location){var Ra=Ca[Ka],Ja=Ha[Ka];void 0===Ja&&("instanceMatrix"===Ka&&P.instanceMatrix&&(Ja=P.instanceMatrix),"instanceColor"===Ka&&P.instanceColor&&(Ja=P.instanceColor));if(void 0===Ra||Ra.attribute!==Ja||Ja&&Ra.data!==Ja.data){var Ka=!0;break a}xa++}Ka=L.attributesNum!==xa||L.index!==ha?!0:!1}if(Ka){Ca={};Ha=T.attributes;xa=0;Fa=aa.getAttributes();for(var lb in Fa)0<=Fa[lb].location&&(Ra=Ha[lb],void 0===
Ra&&("instanceMatrix"===lb&&P.instanceMatrix&&(Ra=P.instanceMatrix),"instanceColor"===lb&&P.instanceColor&&(Ra=P.instanceColor)),Ja={},(Ja.attribute=Ra)&&Ra.data&&(Ja.data=Ra.data),Ca[lb]=Ja,xa++);L.attributes=Ca;L.attributesNum=xa;L.index=ha}null!==ha&&c.update(ha,a.ELEMENT_ARRAY_BUFFER);if(Ka||Y){Y=!1;h();lb=T.attributes;aa=aa.getAttributes();Z=Z.defaultAttributeValues;for(const wc in aa)if(Ka=aa[wc],0<=Ka.location){var wb=lb[wc];void 0===wb&&("instanceMatrix"===wc&&P.instanceMatrix&&(wb=P.instanceMatrix),
"instanceColor"===wc&&P.instanceColor&&(wb=P.instanceColor));if(void 0!==wb){if(Ca=wb.normalized,Ha=wb.itemSize,Fa=c.get(wb),void 0!==Fa){var Mb=Fa.buffer;xa=Fa.type;Fa=Fa.bytesPerElement;Ra=xa===a.INT||xa===a.UNSIGNED_INT||1013===wb.gpuType;if(wb.isInterleavedBufferAttribute){var kb=wb.data;Ja=kb.stride;wb=wb.offset;if(kb.isInstancedInterleavedBuffer){for(var jc=0;jc<Ka.locationSize;jc++)p(Ka.location+jc,kb.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===T._maxInstanceCount&&(T._maxInstanceCount=
kb.meshPerAttribute*kb.count)}else for(kb=0;kb<Ka.locationSize;kb++)l(Ka.location+kb);a.bindBuffer(a.ARRAY_BUFFER,Mb);for(let Tb=0;Tb<Ka.locationSize;Tb++){Mb=Ka.location+Tb;kb=Ha/Ka.locationSize;jc=xa;var Wb=Ca,Xb=Ja*Fa,ad=(wb+Ha/Ka.locationSize*Tb)*Fa;!0===Ra?a.vertexAttribIPointer(Mb,kb,jc,Xb,ad):a.vertexAttribPointer(Mb,kb,jc,Wb,Xb,ad)}}else{if(wb.isInstancedBufferAttribute){for(Ja=0;Ja<Ka.locationSize;Ja++)p(Ka.location+Ja,wb.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===T._maxInstanceCount&&
(T._maxInstanceCount=wb.meshPerAttribute*wb.count)}else for(Ja=0;Ja<Ka.locationSize;Ja++)l(Ka.location+Ja);a.bindBuffer(a.ARRAY_BUFFER,Mb);for(Xb=0;Xb<Ka.locationSize;Xb++)Ja=Ka.location+Xb,wb=Ha/Ka.locationSize,Mb=xa,kb=Ca,jc=Ha*Fa,Wb=Ha/Ka.locationSize*Xb*Fa,!0===Ra?a.vertexAttribIPointer(Ja,wb,Mb,jc,Wb):a.vertexAttribPointer(Ja,wb,Mb,kb,jc,Wb)}}}else if(void 0!==Z&&(Ca=Z[wc],void 0!==Ca))switch(Ca.length){case 2:a.vertexAttrib2fv(Ka.location,Ca);break;case 3:a.vertexAttrib3fv(Ka.location,Ca);break;
case 4:a.vertexAttrib4fv(Ka.location,Ca);break;default:a.vertexAttrib1fv(Ka.location,Ca)}}w();null!==ha&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c.get(ha).buffer)}},reset:x,resetDefaultState:y,dispose:function(){x();for(const P in H){const Z=H[P];for(const aa in Z){const T=Z[aa];for(const ha in T)a.deleteVertexArray(T[ha].object),delete T[ha];delete Z[aa]}delete H[P]}},releaseStatesOfGeometry:function(P){if(void 0!==H[P.id]){var Z=H[P.id];for(const aa in Z){const T=Z[aa];for(const ha in T)a.deleteVertexArray(T[ha].object),
delete T[ha];delete Z[aa]}delete H[P.id]}},releaseStatesOfProgram:function(P){for(const Z in H){const aa=H[Z];if(void 0===aa[P.id])continue;const T=aa[P.id];for(const ha in T)a.deleteVertexArray(T[ha].object),delete T[ha];delete aa[P.id]}},initAttributes:h,enableAttribute:l,disableUnusedAttributes:w}}function dc(a,c,e){function h(p,w,x){0!==x&&(a.drawArraysInstanced(l,p,w,x),e.update(w,l,x))}let l;this.setMode=function(p){l=p};this.render=function(p,w){a.drawArrays(l,p,w);e.update(w,l,1)};this.renderInstances=
h;this.renderMultiDraw=function(p,w,x){if(0!==x){c.get("WEBGL_multi_draw").multiDrawArraysWEBGL(l,p,0,w,0,x);p=0;for(let y=0;y<x;y++)p+=w[y];e.update(p,l,1)}};this.renderMultiDrawInstances=function(p,w,x,y){if(0!==x){var D=c.get("WEBGL_multi_draw");if(null===D)for(x=0;x<p.length;x++)h(p[x],w[x],y[x]);else{D.multiDrawArraysInstancedWEBGL(l,p,0,w,0,y,0,x);p=0;for(D=0;D<x;D++)p+=w[D];for(w=0;w<y.length;w++)e.update(p,l,y[w])}}}}function xc(a,c,e,h){function l(ha){if("highp"===ha){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,
a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";ha="mediump"}return"mediump"===ha&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}let p,w=void 0!==e.precision?e.precision:"highp";var x=l(w);x!==w&&(console.warn("THREE.WebGLRenderer:",w,"not supported, using",x,"instead."),w=x);x=!0===e.logarithmicDepthBuffer;e=!0===e.reverseDepthBuffer&&
c.has("EXT_clip_control");if(!0===e){var y=c.get("EXT_clip_control");y.clipControlEXT(y.LOWER_LEFT_EXT,y.ZERO_TO_ONE_EXT)}y=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);const D=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),H=a.getParameter(a.MAX_TEXTURE_SIZE),I=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),L=a.getParameter(a.MAX_VERTEX_ATTRIBS),Y=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),P=a.getParameter(a.MAX_VARYING_VECTORS),Z=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),aa=0<D,T=a.getParameter(a.MAX_SAMPLES);
return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==p)return p;if(!0===c.has("EXT_texture_filter_anisotropic")){const ha=c.get("EXT_texture_filter_anisotropic");p=a.getParameter(ha.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else p=0;return p},getMaxPrecision:l,textureFormatReadable:function(ha){return 1023!==ha&&h.convert(ha)!==a.getParameter(a.IMPLEMENTATION_COLOR_READ_FORMAT)?!1:!0},textureTypeReadable:function(ha){const Ca=1016===ha&&(c.has("EXT_color_buffer_half_float")||c.has("EXT_color_buffer_float"));
return 1009===ha||h.convert(ha)===a.getParameter(a.IMPLEMENTATION_COLOR_READ_TYPE)||1015===ha||Ca?!0:!1},precision:w,logarithmicDepthBuffer:x,reverseDepthBuffer:e,maxTextures:y,maxVertexTextures:D,maxTextureSize:H,maxCubemapSize:I,maxAttributes:L,maxVertexUniforms:Y,maxVaryings:P,maxFragmentUniforms:Z,vertexTextures:aa,maxSamples:T}}function Nc(a){function c(H,I,L,Y){const P=null!==H?H.length:0;let Z=null;if(0!==P){Z=D.value;if(!0!==Y||null===Z){Y=L+4*P;I=I.matrixWorldInverse;y.getNormalMatrix(I);
if(null===Z||Z.length<Y)Z=new Float32Array(Y);for(let aa=0,T=L;aa!==P;++aa,T+=4)x.copy(H[aa]).applyMatrix4(I,y),x.normal.toArray(Z,T),Z[T+3]=x.constant}D.value=Z;D.needsUpdate=!0}e.numPlanes=P;e.numIntersection=0;return Z}const e=this;let h=null,l=0,p=!1,w=!1;const x=new kj,y=new nd,D={value:null,needsUpdate:!1};this.uniform=D;this.numIntersection=this.numPlanes=0;this.init=function(H,I){const L=0!==H.length||I||0!==l||p;p=I;l=H.length;return L};this.beginShadows=function(){w=!0;c(null)};this.endShadows=
function(){w=!1};this.setGlobalState=function(H,I){h=c(H,I,0)};this.setState=function(H,I,L){const Y=H.clippingPlanes,P=H.clipIntersection;var Z=H.clipShadows;H=a.get(H);if(!p||null===Y||0===Y.length||w&&!Z)w?c(null):(D.value!==h&&(D.value=h,D.needsUpdate=0<l),e.numPlanes=l,e.numIntersection=0);else{Z=w?0:l;const aa=4*Z;let T=H.clippingState||null;D.value=T;T=c(Y,I,aa,L);for(I=0;I!==aa;++I)T[I]=h[I];H.clippingState=T;this.numIntersection=P?this.numPlanes:0;this.numPlanes+=Z}}}function pd(a){function c(l,
p){303===p?l.mapping=301:304===p&&(l.mapping=302);return l}function e(l){l=l.target;l.removeEventListener("dispose",e);const p=h.get(l);void 0!==p&&(h.delete(l),p.dispose())}let h=new WeakMap;return{get:function(l){if(l&&l.isTexture){var p=l.mapping;if(303===p||304===p)return h.has(l)?(p=h.get(l).texture,c(p,l.mapping)):(p=l.image)&&0<p.height?(p=new Kj(p.height),p.fromEquirectangularTexture(a,l),h.set(l,p),l.addEventListener("dispose",e),c(p.texture,l.mapping)):null}return l},dispose:function(){h=
new WeakMap}}}function Ic(a,c,e){a=new dd(a,c,e);a.texture.mapping=306;a.texture.name="PMREM.cubeUv";a.scissorTest=!0;return a}function Rc(a,c,e,h,l){a.viewport.set(c,e,h,l);a.scissor.set(c,e,h,l)}function Kb(){return new ih({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:jb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include \x3ccommon\x3e\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection \x3d normalize( vOutputDirection );\n\t\t\t\tvec2 uv \x3d equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor \x3d vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function Ma(){return new ih({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:jb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor \x3d textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function jb(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv \x3d 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction \x3d vec3( uv, 1.0 );\n\n\t\t\tif ( face \x3d\x3d 0.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face \x3d\x3d 1.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face \x3d\x3d 2.0 ) {\n\n\t\t\t\tdirection.x *\x3d -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face \x3d\x3d 3.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face \x3d\x3d 4.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xy *\x3d -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face \x3d\x3d 5.0 ) {\n\n\t\t\t\tdirection.z *\x3d -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection \x3d getDirection( uv, faceIndex );\n\t\t\tgl_Position \x3d vec4( position, 1.0 );\n\n\t\t}\n\t"}
function sc(a){function c(l){l=l.target;l.removeEventListener("dispose",c);const p=e.get(l);void 0!==p&&(e.delete(l),p.dispose())}let e=new WeakMap,h=null;return{get:function(l){if(l&&l.isTexture){var p=l.mapping;const y=303===p||304===p;var w=301===p||302===p;if(y||w){p=e.get(l);var x=void 0!==p?p.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==x)return null===h&&(h=new b(a)),p=y?h.fromEquirectangular(l,p):h.fromCubemap(l,p),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),p.texture;
if(void 0!==p)return p.texture;p=l.image;if(!(x=y&&p&&0<p.height)){if(w=w&&p){w=0;for(x=0;6>x;x++)void 0!==p[x]&&w++;w=6===w}x=w}return x?(null===h&&(h=new b(a)),p=y?h.fromEquirectangular(l):h.fromCubemap(l),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),l.addEventListener("dispose",c),p.texture):null}}return l},dispose:function(){e=new WeakMap;null!==h&&(h.dispose(),h=null)}}}function Ac(a){function c(h){if(void 0!==e[h])return e[h];let l;switch(h){case "WEBGL_depth_texture":l=a.getExtension("WEBGL_depth_texture")||
a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":l=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":l=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;
case "WEBGL_compressed_texture_pvrtc":l=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=a.getExtension(h)}return e[h]=l}const e={};return{has:function(h){return null!==c(h)},init:function(){c("EXT_color_buffer_float");c("WEBGL_clip_cull_distance");c("OES_texture_float_linear");c("EXT_color_buffer_half_float");c("WEBGL_multisampled_render_to_texture");c("WEBGL_render_shared_exponent")},get:function(h){const l=c(h);null===l&&
Sb("THREE.WebGLRenderer: "+h+" extension not supported.");return l}}}function Tc(a,c,e,h){function l(y){y=y.target;null!==y.index&&c.remove(y.index);for(var D in y.attributes)c.remove(y.attributes[D]);for(var H in y.morphAttributes){D=y.morphAttributes[H];for(let I=0,L=D.length;I<L;I++)c.remove(D[I])}y.removeEventListener("dispose",l);delete w[y.id];if(H=x.get(y))c.remove(H),x.delete(y);h.releaseStatesOfGeometry(y);!0===y.isInstancedBufferGeometry&&delete y._maxInstanceCount;e.memory.geometries--}
function p(y){var D=[],H=y.index,I=y.attributes.position;if(null!==H){I=H.array;H=H.version;for(let P=0,Z=I.length;P<Z;P+=3){var L=I[P+0],Y=I[P+1];const aa=I[P+2];D.push(L,Y,Y,aa,aa,L)}}else if(void 0!==I){L=I.array;H=I.version;for(let P=0,Z=L.length/3-1;P<Z;P+=3)I=P+0,L=P+1,Y=P+2,D.push(I,L,L,Y,Y,I)}else return;D=new (Va(D)?ij:mf)(D,1);D.version=H;(H=x.get(y))&&c.remove(H);x.set(y,D)}const w={},x=new WeakMap;return{get:function(y,D){if(!0===w[D.id])return D;D.addEventListener("dispose",l);w[D.id]=
!0;e.memory.geometries++;return D},update:function(y){var D=y.attributes;for(const H in D)c.update(D[H],a.ARRAY_BUFFER);y=y.morphAttributes;for(const H in y){D=y[H];for(let I=0,L=D.length;I<L;I++)c.update(D[I],a.ARRAY_BUFFER)}},getWireframeAttribute:function(y){const D=x.get(y);if(D){const H=y.index;null!==H&&D.version<H.version&&p(y)}else p(y);return x.get(y)}}}function od(a,c,e){function h(x,y,D){0!==D&&(a.drawElementsInstanced(l,y,p,x*w,D),e.update(y,l,D))}let l,p,w;this.setMode=function(x){l=
x};this.setIndex=function(x){p=x.type;w=x.bytesPerElement};this.render=function(x,y){a.drawElements(l,y,p,x*w);e.update(y,l,1)};this.renderInstances=h;this.renderMultiDraw=function(x,y,D){if(0!==D){c.get("WEBGL_multi_draw").multiDrawElementsWEBGL(l,y,0,p,x,0,D);x=0;for(let H=0;H<D;H++)x+=y[H];e.update(x,l,1)}};this.renderMultiDrawInstances=function(x,y,D,H){if(0!==D){var I=c.get("WEBGL_multi_draw");if(null===I)for(D=0;D<x.length;D++)h(x[D]/w,y[D],H[D]);else{I.multiDrawElementsInstancedWEBGL(l,y,0,
p,x,0,H,0,D);x=0;for(I=0;I<D;I++)x+=y[I];for(y=0;y<H.length;y++)e.update(x,l,H[y])}}}}function Vc(a){const c={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:c,programs:null,autoReset:!0,reset:function(){c.calls=0;c.triangles=0;c.points=0;c.lines=0},update:function(e,h,l){c.calls++;switch(h){case a.TRIANGLES:c.triangles+=e/3*l;break;case a.LINES:c.lines+=e/2*l;break;case a.LINE_STRIP:c.lines+=l*(e-1);break;case a.LINE_LOOP:c.lines+=l*e;break;case a.POINTS:c.points+=
l*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",h)}}}}function yc(a,c,e){const h=new WeakMap,l=new yd;return{update:function(p,w,x){const y=p.morphTargetInfluences;var D=w.morphAttributes.position||w.morphAttributes.normal||w.morphAttributes.color;D=void 0!==D?D.length:0;var H=h.get(w);if(void 0===H||H.count!==D){void 0!==H&&H.texture.dispose();H=void 0!==w.morphAttributes.position;const L=void 0!==w.morphAttributes.normal,Y=void 0!==w.morphAttributes.color,P=w.morphAttributes.position||
[],Z=w.morphAttributes.normal||[],aa=w.morphAttributes.color||[];var I=0;!0===H&&(I=1);!0===L&&(I=2);!0===Y&&(I=3);let T=w.attributes.position.count*I,ha=1;T>c.maxTextureSize&&(ha=Math.ceil(T/c.maxTextureSize),T=c.maxTextureSize);const Ca=new Float32Array(T*ha*4*D),xa=new ed(Ca,T,ha,D);xa.type=1015;xa.needsUpdate=!0;I*=4;for(let Fa=0;Fa<D;Fa++){const Ra=P[Fa],Ja=Z[Fa],Ka=aa[Fa],lb=T*ha*4*Fa;for(let wb=0;wb<Ra.count;wb++){const Mb=wb*I;!0===H&&(l.fromBufferAttribute(Ra,wb),Ca[lb+Mb+0]=l.x,Ca[lb+Mb+
1]=l.y,Ca[lb+Mb+2]=l.z,Ca[lb+Mb+3]=0);!0===L&&(l.fromBufferAttribute(Ja,wb),Ca[lb+Mb+4]=l.x,Ca[lb+Mb+5]=l.y,Ca[lb+Mb+6]=l.z,Ca[lb+Mb+7]=0);!0===Y&&(l.fromBufferAttribute(Ka,wb),Ca[lb+Mb+8]=l.x,Ca[lb+Mb+9]=l.y,Ca[lb+Mb+10]=l.z,Ca[lb+Mb+11]=4===Ka.itemSize?l.w:1)}}H={count:D,texture:xa,size:new Lb(T,ha)};h.set(w,H);function Ha(){xa.dispose();h.delete(w);w.removeEventListener("dispose",Ha)}w.addEventListener("dispose",Ha)}if(!0===p.isInstancedMesh&&null!==p.morphTexture)x.getUniforms().setValue(a,"morphTexture",
p.morphTexture,e);else{p=0;for(D=0;D<y.length;D++)p+=y[D];p=w.morphTargetsRelative?1:1-p;x.getUniforms().setValue(a,"morphTargetBaseInfluence",p);x.getUniforms().setValue(a,"morphTargetInfluences",y)}x.getUniforms().setValue(a,"morphTargetsTexture",H.texture,e);x.getUniforms().setValue(a,"morphTargetsTextureSize",H.size)}}}function Pc(a,c,e,h){function l(w){w=w.target;w.removeEventListener("dispose",l);e.remove(w.instanceMatrix);null!==w.instanceColor&&e.remove(w.instanceColor)}let p=new WeakMap;
return{update:function(w){const x=h.render.frame,y=c.get(w,w.geometry);p.get(y)!==x&&(c.update(y),p.set(y,x));w.isInstancedMesh&&(!1===w.hasEventListener("dispose",l)&&w.addEventListener("dispose",l),p.get(w)!==x&&(e.update(w.instanceMatrix,a.ARRAY_BUFFER),null!==w.instanceColor&&e.update(w.instanceColor,a.ARRAY_BUFFER),p.set(w,x)));w.isSkinnedMesh&&(w=w.skeleton,p.get(w)!==x&&(w.update(),p.set(w,x)));return y},dispose:function(){p=new WeakMap}}}function td(a,c,e){const h=a[0];if(0>=h||0<h)return a;
const l=c*e;let p=K[l];void 0===p&&(p=new Float32Array(l),K[l]=p);if(0!==c){h.toArray(p,0);for(let w=1,x=0;w!==c;++w)x+=e,a[w].toArray(p,x)}return p}function Cd(a,c){if(a.length!==c.length)return!1;for(let e=0,h=a.length;e<h;e++)if(a[e]!==c[e])return!1;return!0}function Gd(a,c){for(let e=0,h=c.length;e<h;e++)a[e]=c[e]}function pe(a,c){let e=R[c];void 0===e&&(e=new Int32Array(c),R[c]=e);for(let h=0;h!==c;++h)e[h]=a.allocateTextureUnit();return e}function qe(a,c){const e=this.cache;e[0]!==c&&(a.uniform1f(this.addr,
c),e[0]=c)}function gf(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y)a.uniform2f(this.addr,c.x,c.y),e[0]=c.x,e[1]=c.y}else Cd(e,c)||(a.uniform2fv(this.addr,c),Gd(e,c))}function da(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z)a.uniform3f(this.addr,c.x,c.y,c.z),e[0]=c.x,e[1]=c.y,e[2]=c.z}else if(void 0!==c.r){if(e[0]!==c.r||e[1]!==c.g||e[2]!==c.b)a.uniform3f(this.addr,c.r,c.g,c.b),e[0]=c.r,e[1]=c.g,e[2]=c.b}else Cd(e,c)||(a.uniform3fv(this.addr,
c),Gd(e,c))}function J(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z||e[3]!==c.w)a.uniform4f(this.addr,c.x,c.y,c.z,c.w),e[0]=c.x,e[1]=c.y,e[2]=c.z,e[3]=c.w}else Cd(e,c)||(a.uniform4fv(this.addr,c),Gd(e,c))}function O(a,c){const e=this.cache,h=c.elements;void 0===h?Cd(e,c)||(a.uniformMatrix2fv(this.addr,!1,c),Gd(e,c)):Cd(e,h)||(ja.set(h),a.uniformMatrix2fv(this.addr,!1,ja),Gd(e,h))}function W(a,c){const e=this.cache,h=c.elements;void 0===h?Cd(e,c)||(a.uniformMatrix3fv(this.addr,
!1,c),Gd(e,c)):Cd(e,h)||(ca.set(h),a.uniformMatrix3fv(this.addr,!1,ca),Gd(e,h))}function S(a,c){const e=this.cache,h=c.elements;void 0===h?Cd(e,c)||(a.uniformMatrix4fv(this.addr,!1,c),Gd(e,c)):Cd(e,h)||(X.set(h),a.uniformMatrix4fv(this.addr,!1,X),Gd(e,h))}function fa(a,c){const e=this.cache;e[0]!==c&&(a.uniform1i(this.addr,c),e[0]=c)}function ra(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y)a.uniform2i(this.addr,c.x,c.y),e[0]=c.x,e[1]=c.y}else Cd(e,c)||(a.uniform2iv(this.addr,
c),Gd(e,c))}function ma(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z)a.uniform3i(this.addr,c.x,c.y,c.z),e[0]=c.x,e[1]=c.y,e[2]=c.z}else Cd(e,c)||(a.uniform3iv(this.addr,c),Gd(e,c))}function ua(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z||e[3]!==c.w)a.uniform4i(this.addr,c.x,c.y,c.z,c.w),e[0]=c.x,e[1]=c.y,e[2]=c.z,e[3]=c.w}else Cd(e,c)||(a.uniform4iv(this.addr,c),Gd(e,c))}function Aa(a,c){const e=this.cache;e[0]!==c&&(a.uniform1ui(this.addr,
c),e[0]=c)}function Ua(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y)a.uniform2ui(this.addr,c.x,c.y),e[0]=c.x,e[1]=c.y}else Cd(e,c)||(a.uniform2uiv(this.addr,c),Gd(e,c))}function fb(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z)a.uniform3ui(this.addr,c.x,c.y,c.z),e[0]=c.x,e[1]=c.y,e[2]=c.z}else Cd(e,c)||(a.uniform3uiv(this.addr,c),Gd(e,c))}function pb(a,c){const e=this.cache;if(void 0!==c.x){if(e[0]!==c.x||e[1]!==c.y||e[2]!==c.z||e[3]!==c.w)a.uniform4ui(this.addr,
c.x,c.y,c.z,c.w),e[0]=c.x,e[1]=c.y,e[2]=c.z,e[3]=c.w}else Cd(e,c)||(a.uniform4uiv(this.addr,c),Gd(e,c))}function Rb(a,c,e){const h=this.cache,l=e.allocateTextureUnit();h[0]!==l&&(a.uniform1i(this.addr,l),h[0]=l);this.type===a.SAMPLER_2D_SHADOW?(u.compareFunction=515,a=u):a=m;e.setTexture2D(c||a,l)}function ec(a,c,e){const h=this.cache,l=e.allocateTextureUnit();h[0]!==l&&(a.uniform1i(this.addr,l),h[0]=l);e.setTexture3D(c||C,l)}function kc(a,c,e){const h=this.cache,l=e.allocateTextureUnit();h[0]!==
l&&(a.uniform1i(this.addr,l),h[0]=l);e.setTextureCube(c||G,l)}function fc(a,c,e){const h=this.cache,l=e.allocateTextureUnit();h[0]!==l&&(a.uniform1i(this.addr,l),h[0]=l);e.setTexture2DArray(c||z,l)}function Gc(a){switch(a){case 5126:return qe;case 35664:return gf;case 35665:return da;case 35666:return J;case 35674:return O;case 35675:return W;case 35676:return S;case 5124:case 35670:return fa;case 35667:case 35671:return ra;case 35668:case 35672:return ma;case 35669:case 35673:return ua;case 5125:return Aa;
case 36294:return Ua;case 36295:return fb;case 36296:return pb;case 35678:case 36198:case 36298:case 36306:case 35682:return Rb;case 35679:case 36299:case 36307:return ec;case 35680:case 36300:case 36308:case 36293:return kc;case 36289:case 36303:case 36311:case 36292:return fc}}function Fc(a,c){a.uniform1fv(this.addr,c)}function Hd(a,c){c=td(c,this.size,2);a.uniform2fv(this.addr,c)}function de(a,c){c=td(c,this.size,3);a.uniform3fv(this.addr,c)}function Me(a,c){c=td(c,this.size,4);a.uniform4fv(this.addr,
c)}function zg(a,c){c=td(c,this.size,4);a.uniformMatrix2fv(this.addr,!1,c)}function Kf(a,c){c=td(c,this.size,9);a.uniformMatrix3fv(this.addr,!1,c)}function Lf(a,c){c=td(c,this.size,16);a.uniformMatrix4fv(this.addr,!1,c)}function Ag(a,c){a.uniform1iv(this.addr,c)}function Vi(a,c){a.uniform2iv(this.addr,c)}function qi(a,c){a.uniform3iv(this.addr,c)}function re(a,c){a.uniform4iv(this.addr,c)}function Eh(a,c){a.uniform1uiv(this.addr,c)}function ok(a,c){a.uniform2uiv(this.addr,c)}function Nj(a,c){a.uniform3uiv(this.addr,
c)}function qj(a,c){a.uniform4uiv(this.addr,c)}function Ui(a,c,e){const h=this.cache,l=c.length,p=pe(e,l);Cd(h,p)||(a.uniform1iv(this.addr,p),Gd(h,p));for(a=0;a!==l;++a)e.setTexture2D(c[a]||m,p[a])}function mh(a,c,e){const h=this.cache,l=c.length,p=pe(e,l);Cd(h,p)||(a.uniform1iv(this.addr,p),Gd(h,p));for(a=0;a!==l;++a)e.setTexture3D(c[a]||C,p[a])}function ri(a,c,e){const h=this.cache,l=c.length,p=pe(e,l);Cd(h,p)||(a.uniform1iv(this.addr,p),Gd(h,p));for(a=0;a!==l;++a)e.setTextureCube(c[a]||G,p[a])}
function Bg(a,c,e){const h=this.cache,l=c.length,p=pe(e,l);Cd(h,p)||(a.uniform1iv(this.addr,p),Gd(h,p));for(a=0;a!==l;++a)e.setTexture2DArray(c[a]||z,p[a])}function Cg(a){switch(a){case 5126:return Fc;case 35664:return Hd;case 35665:return de;case 35666:return Me;case 35674:return zg;case 35675:return Kf;case 35676:return Lf;case 5124:case 35670:return Ag;case 35667:case 35671:return Vi;case 35668:case 35672:return qi;case 35669:case 35673:return re;case 5125:return Eh;case 36294:return ok;case 36295:return Nj;
case 36296:return qj;case 35678:case 36198:case 36298:case 36306:case 35682:return Ui;case 35679:case 36299:case 36307:return mh;case 35680:case 36300:case 36308:case 36293:return ri;case 36289:case 36303:case 36311:case 36292:return Bg}}function Gh(a,c,e){c=a.createShader(c);a.shaderSource(c,e);a.compileShader(c);return c}function te(a,c,e){var h=a.getShaderParameter(c,a.COMPILE_STATUS),l=a.getShaderInfoLog(c).trim();if(h&&""===l)return"";if(h=/ERROR: 0:(\d+)/.exec(l)){h=parseInt(h[1]);e=e.toUpperCase()+
"\n\n"+l+"\n\n";a=a.getShaderSource(c).split("\n");c=[];var p=Math.max(h-6,0);for(l=Math.min(h+6,a.length);p<l;p++){const w=p+1;c.push(`${w===h?"\x3e":" "} ${w}: ${a[p]}`)}h=c.join("\n");return e+h}return l}function Zh(a,c){a:{const e=Eb.getPrimaries(Eb.workingColorSpace),h=Eb.getPrimaries(c);let l;e===h?l="":"p3"===e&&"rec709"===h?l="LinearDisplayP3ToLinearSRGB":"rec709"===e&&"p3"===h&&(l="LinearSRGBToLinearDisplayP3");switch(c){case "srgb-linear":case "display-p3-linear":c=[l,"LinearTransferOETF"];
break a;case "srgb":case "display-p3":c=[l,"sRGBTransferOETF"];break a;default:console.warn("THREE.WebGLProgram: Unsupported color space:",c),c=[l,"LinearTransferOETF"]}}return`vec4 ${a}( vec4 value ) { return ${c[0]}( ${c[1]}( value ) ); }`}function Pj(a,c){switch(c){case 1:c="Linear";break;case 2:c="Reinhard";break;case 3:c="Cineon";break;case 4:c="ACESFilmic";break;case 6:c="AgX";break;case 7:c="Neutral";break;case 5:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",
c),c="Linear"}return"vec3 "+a+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function oh(){Eb.getLuminanceCoefficients(Qa);const a=Qa.x.toFixed(4),c=Qa.y.toFixed(4),e=Qa.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${a}, ${c}, ${e} );`,"\treturn dot( weights, rgb );\n}"].join("\n")}function Id(a){const c=[];for(const e in a){const h=a[e];!1!==h&&c.push("#define "+e+" "+h)}return c.join("\n")}function Xg(a){return""!==a}function tk(a,c){const e=
c.numSpotLightShadows+c.numSpotLightMaps-c.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,c.numDirLights).replace(/NUM_SPOT_LIGHTS/g,c.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,c.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,e).replace(/NUM_RECT_AREA_LIGHTS/g,c.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,c.numPointLights).replace(/NUM_HEMI_LIGHTS/g,c.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,c.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,c.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,
c.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,c.numPointLightShadows)}function ph(a,c){return a.replace(/NUM_CLIPPING_PLANES/g,c.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,c.numClippingPlanes-c.numClipIntersection)}function Dg(a,c){a=Uc[c];if(void 0===a){const e=sb.get(c);if(void 0!==e)a=Uc[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',c,e);else throw Error("Can not resolve #include \x3c"+c+"\x3e");}return a.replace(Za,Dg)}function ti(a,
c,e,h){a="";for(c=parseInt(c);c<parseInt(e);c++)a+=h.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return a}function ui(a){let c=`precision ${a.precision} float;
	precision ${a.precision} int;
	precision ${a.precision} sampler2D;
	precision ${a.precision} samplerCube;
	precision ${a.precision} sampler3D;
	precision ${a.precision} sampler2DArray;
	precision ${a.precision} sampler2DShadow;
	precision ${a.precision} samplerCubeShadow;
	precision ${a.precision} sampler2DArrayShadow;
	precision ${a.precision} isampler2D;
	precision ${a.precision} isampler3D;
	precision ${a.precision} isamplerCube;
	precision ${a.precision} isampler2DArray;
	precision ${a.precision} usampler2D;
	precision ${a.precision} usampler3D;
	precision ${a.precision} usamplerCube;
	precision ${a.precision} usampler2DArray;
	`;"highp"===a.precision?c+="\n#define HIGH_PRECISION":"mediump"===a.precision?c+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(c+="\n#define LOW_PRECISION");return c}function Yi(a){let c="SHADOWMAP_TYPE_BASIC";1===a.shadowMapType?c="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?c="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(c="SHADOWMAP_TYPE_VSM");return c}function Fl(a){let c="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:c="ENVMAP_TYPE_CUBE";break;case 306:c="ENVMAP_TYPE_CUBE_UV"}return c}
function Rj(a){let c="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:c="ENVMAP_MODE_REFRACTION"}return c}function Tf(a){let c="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:c="ENVMAP_BLENDING_MULTIPLY";break;case 1:c="ENVMAP_BLENDING_MIX";break;case 2:c="ENVMAP_BLENDING_ADD"}return c}function vi(a){a=a.envMapCubeUVHeight;if(null===a)return null;const c=Math.log2(a)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,c),112)),texelHeight:1/a,maxMip:c}}function tj(a,c,e,h){function l(Ja){if(a.debug.checkShaderErrors){var Ka=
p.getProgramInfoLog(aa).trim(),lb=p.getShaderInfoLog(Ca).trim(),wb=p.getShaderInfoLog(xa).trim(),Mb=!0,kb=!0;if(!1===p.getProgramParameter(aa,p.LINK_STATUS))if(Mb=!1,"function"===typeof a.debug.onShaderError)a.debug.onShaderError(p,aa,Ca,xa);else{const jc=te(p,Ca,"vertex"),Wb=te(p,xa,"fragment");console.error("THREE.WebGLProgram: Shader Error "+p.getError()+" - VALIDATE_STATUS "+p.getProgramParameter(aa,p.VALIDATE_STATUS)+"\n\nMaterial Name: "+Ja.name+"\nMaterial Type: "+Ja.type+"\n\nProgram Info Log: "+
Ka+"\n"+jc+"\n"+Wb)}else if(""!==Ka)console.warn("THREE.WebGLProgram: Program Info Log:",Ka);else if(""===lb||""===wb)kb=!1;kb&&(Ja.diagnostics={runnable:Mb,programLog:Ka,vertexShader:{log:lb,prefix:T},fragmentShader:{log:wb,prefix:ha}})}p.deleteShader(Ca);p.deleteShader(xa);Ha=new za(p,aa);Ja={};Ka=p.getProgramParameter(aa,p.ACTIVE_ATTRIBUTES);for(lb=0;lb<Ka;lb++)wb=p.getActiveAttrib(aa,lb),Mb=wb.name,kb=1,wb.type===p.FLOAT_MAT2&&(kb=2),wb.type===p.FLOAT_MAT3&&(kb=3),wb.type===p.FLOAT_MAT4&&(kb=
4),Ja[Mb]={type:wb.type,location:p.getAttribLocation(aa,Mb),locationSize:kb};Fa=Ja}const p=a.getContext();var w=e.defines;let x=e.vertexShader;var y=e.fragmentShader;const D=Yi(e),H=Fl(e),I=Rj(e),L=Tf(e),Y=vi(e),P=[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Xg).join("\n"),Z=Id(w),aa=p.createProgram();let T,ha;w=e.glslVersion?"#version "+e.glslVersion+"\n":"";e.isRawShaderMaterial?(T=["#define SHADER_TYPE "+
e.shaderType,"#define SHADER_NAME "+e.shaderName,Z].filter(Xg).join("\n"),0<T.length&&(T+="\n"),ha=["#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,Z].filter(Xg).join("\n"),0<ha.length&&(ha+="\n")):(T=[ui(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,Z,e.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",e.batching?"#define USE_BATCHING":"",e.batchingColor?"#define USE_BATCHING_COLOR":"",e.instancing?"#define USE_INSTANCING":"",e.instancingColor?
"#define USE_INSTANCING_COLOR":"",e.instancingMorph?"#define USE_INSTANCING_MORPH":"",e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+I:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":
"",e.displacementMap?"#define USE_DISPLACEMENTMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":
"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":
"",e.mapUv?"#define MAP_UV "+e.mapUv:"",e.alphaMapUv?"#define ALPHAMAP_UV "+e.alphaMapUv:"",e.lightMapUv?"#define LIGHTMAP_UV "+e.lightMapUv:"",e.aoMapUv?"#define AOMAP_UV "+e.aoMapUv:"",e.emissiveMapUv?"#define EMISSIVEMAP_UV "+e.emissiveMapUv:"",e.bumpMapUv?"#define BUMPMAP_UV "+e.bumpMapUv:"",e.normalMapUv?"#define NORMALMAP_UV "+e.normalMapUv:"",e.displacementMapUv?"#define DISPLACEMENTMAP_UV "+e.displacementMapUv:"",e.metalnessMapUv?"#define METALNESSMAP_UV "+e.metalnessMapUv:"",e.roughnessMapUv?
"#define ROUGHNESSMAP_UV "+e.roughnessMapUv:"",e.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+e.anisotropyMapUv:"",e.clearcoatMapUv?"#define CLEARCOATMAP_UV "+e.clearcoatMapUv:"",e.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+e.clearcoatNormalMapUv:"",e.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+e.clearcoatRoughnessMapUv:"",e.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+e.iridescenceMapUv:"",e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+e.iridescenceThicknessMapUv:
"",e.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+e.sheenColorMapUv:"",e.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+e.sheenRoughnessMapUv:"",e.specularMapUv?"#define SPECULARMAP_UV "+e.specularMapUv:"",e.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+e.specularColorMapUv:"",e.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+e.specularIntensityMapUv:"",e.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+e.transmissionMapUv:"",e.thicknessMapUv?"#define THICKNESSMAP_UV "+e.thicknessMapUv:
"",e.vertexTangents&&!1===e.flatShading?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&!1===e.flatShading?"#define USE_MORPHNORMALS":"",e.morphColors?"#define USE_MORPHCOLORS":
"",0<e.morphTargetsCount?"#define MORPHTARGETS_TEXTURE_STRIDE "+e.morphTextureStride:"",0<e.morphTargetsCount?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+D:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",0<e.numLightProbes?"#define USE_LIGHT_PROBES":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":
"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;",
"#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xg).join("\n"),ha=[ui(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+
e.shaderName,Z,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+H:"",e.envMap?"#define "+I:"",e.envMap?"#define "+L:"",Y?"#define CUBEUV_TEXEL_WIDTH "+Y.texelWidth:"",Y?"#define CUBEUV_TEXEL_HEIGHT "+Y.texelHeight:"",Y?"#define CUBEUV_MAX_MIP "+Y.maxMip+".0":"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":
"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?
"#define USE_CLEARCOAT_NORMALMAP":"",e.dispersion?"#define USE_DISPERSION":"",e.iridescence?"#define USE_IRIDESCENCE":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":
"",e.alphaTest?"#define USE_ALPHATEST":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents&&!1===e.flatShading?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor||e.batchingColor?"#define USE_COLOR":"",e.vertexAlphas?
"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+D:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",0<e.numLightProbes?"#define USE_LIGHT_PROBES":
"",e.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==e.toneMapping?"#define TONE_MAPPING":"",0!==e.toneMapping?Uc.tonemapping_pars_fragment:"",0!==e.toneMapping?Pj("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.opaque?"#define OPAQUE":"",Uc.colorspace_pars_fragment,Zh("linearToOutputTexel",
e.outputColorSpace),oh(),e.useDepthPacking?"#define DEPTH_PACKING "+e.depthPacking:"","\n"].filter(Xg).join("\n"));x=x.replace(Za,Dg);x=tk(x,e);x=ph(x,e);y=y.replace(Za,Dg);y=tk(y,e);y=ph(y,e);x=x.replace(ob,ti);y=y.replace(ob,ti);!0!==e.isRawShaderMaterial&&(w="#version 300 es\n",T=[P,"#define attribute in\n#define varying out\n#define texture2D texture"].join("\n")+"\n"+T,ha=["#define varying in","300 es"===e.glslVersion?"":"layout(location \x3d 0) out highp vec4 pc_fragColor;","300 es"===e.glslVersion?
"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+ha);y=w+ha+y;const Ca=Gh(p,p.VERTEX_SHADER,w+T+x),xa=Gh(p,p.FRAGMENT_SHADER,
y);p.attachShader(aa,Ca);p.attachShader(aa,xa);void 0!==e.index0AttributeName?p.bindAttribLocation(aa,0,e.index0AttributeName):!0===e.morphTargets&&p.bindAttribLocation(aa,0,"position");p.linkProgram(aa);let Ha;this.getUniforms=function(){void 0===Ha&&l(this);return Ha};let Fa;this.getAttributes=function(){void 0===Fa&&l(this);return Fa};let Ra=!1===e.rendererExtensionParallelShaderCompile;this.isReady=function(){!1===Ra&&(Ra=p.getProgramParameter(aa,37297));return Ra};this.destroy=function(){h.releaseStatesOfProgram(this);
p.deleteProgram(aa);this.program=void 0};this.type=e.shaderType;this.name=e.shaderName;this.id=Ea++;this.cacheKey=c;this.usedTimes=1;this.program=aa;this.vertexShader=Ca;this.fragmentShader=xa;return this}function Hh(a,c,e,h,l,p,w){function x(T){H.add(T);return 0===T?"uv":`uv${T}`}const y=new ke,D=new Db,H=new Set,I=[],L=l.logarithmicDepthBuffer,Y=l.reverseDepthBuffer,P=l.vertexTextures;let Z=l.precision;const aa={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",
MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(T,ha,Ca,xa,Ha){const Fa=xa.fog,Ra=Ha.geometry;xa=T.isMeshStandardMaterial?xa.environment:null;const Ja=(xa=(T.isMeshStandardMaterial?e:c).get(T.envMap||
xa))&&306===xa.mapping?xa.image.height:null,Ka=aa[T.type];null!==T.precision&&(Z=l.getMaxPrecision(T.precision),Z!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",Z,"instead."));var lb=Ra.morphAttributes.position||Ra.morphAttributes.normal||Ra.morphAttributes.color;lb=void 0!==lb?lb.length:0;let wb=0;void 0!==Ra.morphAttributes.position&&(wb=1);void 0!==Ra.morphAttributes.normal&&(wb=2);void 0!==Ra.morphAttributes.color&&(wb=3);let Mb;let kb,jc;if(Ka){var Wb=
Rg[Ka];Mb=Wb.vertexShader;Wb=Wb.fragmentShader}else Mb=T.vertexShader,Wb=T.fragmentShader,D.update(T),kb=D.getVertexShaderID(T),jc=D.getFragmentShaderID(T);const Xb=a.getRenderTarget(),ad=!0===Ha.isInstancedMesh,wc=!0===Ha.isBatchedMesh,Tb=!!T.map,Hb=!!T.matcap,Ub=!!xa,zc=!!T.aoMap,cc=!!T.lightMap,sa=!!T.bumpMap,ka=!!T.normalMap,wa=!!T.displacementMap,Oa=!!T.emissiveMap,Ya=!!T.metalnessMap,La=!!T.roughnessMap,ub=0<T.anisotropy,mb=0<T.clearcoat,ib=0<T.dispersion,Gb=0<T.iridescence,Yb=0<T.sheen,rc=
0<T.transmission,pc=ub&&!!T.anisotropyMap,Kd=mb&&!!T.clearcoatMap,bd=mb&&!!T.clearcoatNormalMap,Ae=mb&&!!T.clearcoatRoughnessMap,Dd=Gb&&!!T.iridescenceMap,Mj=Gb&&!!T.iridescenceThicknessMap,cn=Yb&&!!T.sheenColorMap,dn=Yb&&!!T.sheenRoughnessMap,Hn=!!T.specularMap,Yl=!!T.specularColorMap,vn=!!T.specularIntensityMap,en=rc&&!!T.transmissionMap,db=rc&&!!T.thicknessMap,kh=!!T.gradientMap,Vh=!!T.alphaMap,ne=0<T.alphaTest,lk=!!T.alphaHash,Be=!!T.extensions;let Ke=0;!T.toneMapped||null!==Xb&&!0!==Xb.isXRRenderTarget||
(Ke=a.toneMapping);T={shaderID:Ka,shaderType:T.type,shaderName:T.name,vertexShader:Mb,fragmentShader:Wb,defines:T.defines,customVertexShaderID:kb,customFragmentShaderID:jc,isRawShaderMaterial:!0===T.isRawShaderMaterial,glslVersion:T.glslVersion,precision:Z,batching:wc,batchingColor:wc&&null!==Ha._colorsTexture,instancing:ad,instancingColor:ad&&null!==Ha.instanceColor,instancingMorph:ad&&null!==Ha.morphTexture,supportsVertexTextures:P,outputColorSpace:null===Xb?a.outputColorSpace:!0===Xb.isXRRenderTarget?
Xb.texture.colorSpace:"srgb-linear",alphaToCoverage:!!T.alphaToCoverage,map:Tb,matcap:Hb,envMap:Ub,envMapMode:Ub&&xa.mapping,envMapCubeUVHeight:Ja,aoMap:zc,lightMap:cc,bumpMap:sa,normalMap:ka,displacementMap:P&&wa,emissiveMap:Oa,normalMapObjectSpace:ka&&1===T.normalMapType,normalMapTangentSpace:ka&&0===T.normalMapType,metalnessMap:Ya,roughnessMap:La,anisotropy:ub,anisotropyMap:pc,clearcoat:mb,clearcoatMap:Kd,clearcoatNormalMap:bd,clearcoatRoughnessMap:Ae,dispersion:ib,iridescence:Gb,iridescenceMap:Dd,
iridescenceThicknessMap:Mj,sheen:Yb,sheenColorMap:cn,sheenRoughnessMap:dn,specularMap:Hn,specularColorMap:Yl,specularIntensityMap:vn,transmission:rc,transmissionMap:en,thicknessMap:db,gradientMap:kh,opaque:!1===T.transparent&&1===T.blending&&!1===T.alphaToCoverage,alphaMap:Vh,alphaTest:ne,alphaHash:lk,combine:T.combine,mapUv:Tb&&x(T.map.channel),aoMapUv:zc&&x(T.aoMap.channel),lightMapUv:cc&&x(T.lightMap.channel),bumpMapUv:sa&&x(T.bumpMap.channel),normalMapUv:ka&&x(T.normalMap.channel),displacementMapUv:wa&&
x(T.displacementMap.channel),emissiveMapUv:Oa&&x(T.emissiveMap.channel),metalnessMapUv:Ya&&x(T.metalnessMap.channel),roughnessMapUv:La&&x(T.roughnessMap.channel),anisotropyMapUv:pc&&x(T.anisotropyMap.channel),clearcoatMapUv:Kd&&x(T.clearcoatMap.channel),clearcoatNormalMapUv:bd&&x(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ae&&x(T.clearcoatRoughnessMap.channel),iridescenceMapUv:Dd&&x(T.iridescenceMap.channel),iridescenceThicknessMapUv:Mj&&x(T.iridescenceThicknessMap.channel),sheenColorMapUv:cn&&
x(T.sheenColorMap.channel),sheenRoughnessMapUv:dn&&x(T.sheenRoughnessMap.channel),specularMapUv:Hn&&x(T.specularMap.channel),specularColorMapUv:Yl&&x(T.specularColorMap.channel),specularIntensityMapUv:vn&&x(T.specularIntensityMap.channel),transmissionMapUv:en&&x(T.transmissionMap.channel),thicknessMapUv:db&&x(T.thicknessMap.channel),alphaMapUv:Vh&&x(T.alphaMap.channel),vertexTangents:!!Ra.attributes.tangent&&(ka||ub),vertexColors:T.vertexColors,vertexAlphas:!0===T.vertexColors&&!!Ra.attributes.color&&
4===Ra.attributes.color.itemSize,pointsUvs:!0===Ha.isPoints&&!!Ra.attributes.uv&&(Tb||Vh),fog:!!Fa,useFog:!0===T.fog,fogExp2:!!Fa&&Fa.isFogExp2,flatShading:!0===T.flatShading,sizeAttenuation:!0===T.sizeAttenuation,logarithmicDepthBuffer:L,reverseDepthBuffer:Y,skinning:!0===Ha.isSkinnedMesh,morphTargets:void 0!==Ra.morphAttributes.position,morphNormals:void 0!==Ra.morphAttributes.normal,morphColors:void 0!==Ra.morphAttributes.color,morphTargetsCount:lb,morphTextureStride:wb,numDirLights:ha.directional.length,
numPointLights:ha.point.length,numSpotLights:ha.spot.length,numSpotLightMaps:ha.spotLightMap.length,numRectAreaLights:ha.rectArea.length,numHemiLights:ha.hemi.length,numDirLightShadows:ha.directionalShadowMap.length,numPointLightShadows:ha.pointShadowMap.length,numSpotLightShadows:ha.spotShadowMap.length,numSpotLightShadowsWithMaps:ha.numSpotLightShadowsWithMaps,numLightProbes:ha.numLightProbes,numClippingPlanes:w.numPlanes,numClipIntersection:w.numIntersection,dithering:T.dithering,shadowMapEnabled:a.shadowMap.enabled&&
0<Ca.length,shadowMapType:a.shadowMap.type,toneMapping:Ke,decodeVideoTexture:Tb&&!0===T.map.isVideoTexture&&"srgb"===Eb.getTransfer(T.map.colorSpace),premultipliedAlpha:T.premultipliedAlpha,doubleSided:2===T.side,flipSided:1===T.side,useDepthPacking:0<=T.depthPacking,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionClipCullDistance:Be&&!0===T.extensions.clipCullDistance&&h.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Be&&!0===T.extensions.multiDraw||wc)&&h.has("WEBGL_multi_draw"),
rendererExtensionParallelShaderCompile:h.has("KHR_parallel_shader_compile"),customProgramCacheKey:T.customProgramCacheKey()};T.vertexUv1s=H.has(1);T.vertexUv2s=H.has(2);T.vertexUv3s=H.has(3);H.clear();return T},getProgramCacheKey:function(T){const ha=[];T.shaderID?ha.push(T.shaderID):(ha.push(T.customVertexShaderID),ha.push(T.customFragmentShaderID));if(void 0!==T.defines)for(const Ca in T.defines)ha.push(Ca),ha.push(T.defines[Ca]);!1===T.isRawShaderMaterial&&(ha.push(T.precision),ha.push(T.outputColorSpace),
ha.push(T.envMapMode),ha.push(T.envMapCubeUVHeight),ha.push(T.mapUv),ha.push(T.alphaMapUv),ha.push(T.lightMapUv),ha.push(T.aoMapUv),ha.push(T.bumpMapUv),ha.push(T.normalMapUv),ha.push(T.displacementMapUv),ha.push(T.emissiveMapUv),ha.push(T.metalnessMapUv),ha.push(T.roughnessMapUv),ha.push(T.anisotropyMapUv),ha.push(T.clearcoatMapUv),ha.push(T.clearcoatNormalMapUv),ha.push(T.clearcoatRoughnessMapUv),ha.push(T.iridescenceMapUv),ha.push(T.iridescenceThicknessMapUv),ha.push(T.sheenColorMapUv),ha.push(T.sheenRoughnessMapUv),
ha.push(T.specularMapUv),ha.push(T.specularColorMapUv),ha.push(T.specularIntensityMapUv),ha.push(T.transmissionMapUv),ha.push(T.thicknessMapUv),ha.push(T.combine),ha.push(T.fogExp2),ha.push(T.sizeAttenuation),ha.push(T.morphTargetsCount),ha.push(T.morphAttributeCount),ha.push(T.numDirLights),ha.push(T.numPointLights),ha.push(T.numSpotLights),ha.push(T.numSpotLightMaps),ha.push(T.numHemiLights),ha.push(T.numRectAreaLights),ha.push(T.numDirLightShadows),ha.push(T.numPointLightShadows),ha.push(T.numSpotLightShadows),
ha.push(T.numSpotLightShadowsWithMaps),ha.push(T.numLightProbes),ha.push(T.shadowMapType),ha.push(T.toneMapping),ha.push(T.numClippingPlanes),ha.push(T.numClipIntersection),ha.push(T.depthPacking),y.disableAll(),T.supportsVertexTextures&&y.enable(0),T.instancing&&y.enable(1),T.instancingColor&&y.enable(2),T.instancingMorph&&y.enable(3),T.matcap&&y.enable(4),T.envMap&&y.enable(5),T.normalMapObjectSpace&&y.enable(6),T.normalMapTangentSpace&&y.enable(7),T.clearcoat&&y.enable(8),T.iridescence&&y.enable(9),
T.alphaTest&&y.enable(10),T.vertexColors&&y.enable(11),T.vertexAlphas&&y.enable(12),T.vertexUv1s&&y.enable(13),T.vertexUv2s&&y.enable(14),T.vertexUv3s&&y.enable(15),T.vertexTangents&&y.enable(16),T.anisotropy&&y.enable(17),T.alphaHash&&y.enable(18),T.batching&&y.enable(19),T.dispersion&&y.enable(20),T.batchingColor&&y.enable(21),ha.push(y.mask),y.disableAll(),T.fog&&y.enable(0),T.useFog&&y.enable(1),T.flatShading&&y.enable(2),T.logarithmicDepthBuffer&&y.enable(3),T.reverseDepthBuffer&&y.enable(4),
T.skinning&&y.enable(5),T.morphTargets&&y.enable(6),T.morphNormals&&y.enable(7),T.morphColors&&y.enable(8),T.premultipliedAlpha&&y.enable(9),T.shadowMapEnabled&&y.enable(10),T.doubleSided&&y.enable(11),T.flipSided&&y.enable(12),T.useDepthPacking&&y.enable(13),T.dithering&&y.enable(14),T.transmission&&y.enable(15),T.sheen&&y.enable(16),T.opaque&&y.enable(17),T.pointsUvs&&y.enable(18),T.decodeVideoTexture&&y.enable(19),T.alphaToCoverage&&y.enable(20),ha.push(y.mask),ha.push(a.outputColorSpace));ha.push(T.customProgramCacheKey);
return ha.join()},getUniforms:function(T){const ha=aa[T.type];return ha?Lk.clone(Rg[ha].uniforms):T.uniforms},acquireProgram:function(T,ha){let Ca;for(let xa=0,Ha=I.length;xa<Ha;xa++){const Fa=I[xa];if(Fa.cacheKey===ha){Ca=Fa;++Ca.usedTimes;break}}void 0===Ca&&(Ca=new tj(a,ha,T,p),I.push(Ca));return Ca},releaseProgram:function(T){if(0===--T.usedTimes){const ha=I.indexOf(T);I[ha]=I[I.length-1];I.pop();T.destroy()}},releaseShaderCache:function(T){D.remove(T)},programs:I,dispose:function(){D.dispose()}}}
function uk(){let a=new WeakMap;return{has:function(c){return a.has(c)},get:function(c){let e=a.get(c);void 0===e&&(e={},a.set(c,e));return e},remove:function(c){a.delete(c)},update:function(c,e,h){a.get(c)[e]=h},dispose:function(){a=new WeakMap}}}function og(a,c){return a.groupOrder!==c.groupOrder?a.groupOrder-c.groupOrder:a.renderOrder!==c.renderOrder?a.renderOrder-c.renderOrder:a.material.id!==c.material.id?a.material.id-c.material.id:a.z!==c.z?a.z-c.z:a.id-c.id}function Uf(a,c){return a.groupOrder!==
c.groupOrder?a.groupOrder-c.groupOrder:a.renderOrder!==c.renderOrder?a.renderOrder-c.renderOrder:a.z!==c.z?c.z-a.z:a.id-c.id}function qd(){function a(w,x,y,D,H,I){let L=c[e];void 0===L?(L={id:w.id,object:w,geometry:x,material:y,groupOrder:D,renderOrder:w.renderOrder,z:H,group:I},c[e]=L):(L.id=w.id,L.object=w,L.geometry=x,L.material=y,L.groupOrder=D,L.renderOrder=w.renderOrder,L.z=H,L.group=I);e++;return L}const c=[];let e=0;const h=[],l=[],p=[];return{opaque:h,transmissive:l,transparent:p,init:function(){e=
0;h.length=0;l.length=0;p.length=0},push:function(w,x,y,D,H,I){w=a(w,x,y,D,H,I);0<y.transmission?l.push(w):!0===y.transparent?p.push(w):h.push(w)},unshift:function(w,x,y,D,H,I){w=a(w,x,y,D,H,I);0<y.transmission?l.unshift(w):!0===y.transparent?p.unshift(w):h.unshift(w)},finish:function(){for(let w=e,x=c.length;w<x;w++){const y=c[w];if(null===y.id)break;y.id=null;y.object=null;y.geometry=null;y.material=null;y.group=null}},sort:function(w,x){1<h.length&&h.sort(w||og);1<l.length&&l.sort(x||Uf);1<p.length&&
p.sort(x||Uf)}}}function rb(){let a=new WeakMap;return{get:function(c,e){const h=a.get(c);void 0===h?(e=new qd,a.set(c,[e])):e>=h.length?(e=new qd,h.push(e)):e=h[e];return e},dispose:function(){a=new WeakMap}}}function Zi(){const a={};return{get:function(c){if(void 0!==a[c.id])return a[c.id];let e;switch(c.type){case "DirectionalLight":e={direction:new Da,color:new ia};break;case "SpotLight":e={position:new Da,direction:new Da,color:new ia,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case "PointLight":e=
{position:new Da,color:new ia,distance:0,decay:0};break;case "HemisphereLight":e={direction:new Da,skyColor:new ia,groundColor:new ia};break;case "RectAreaLight":e={color:new ia,position:new Da,halfWidth:new Da,halfHeight:new Da}}return a[c.id]=e}}}function Zg(){const a={};return{get:function(c){if(void 0!==a[c.id])return a[c.id];let e;switch(c.type){case "DirectionalLight":e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lb};break;case "SpotLight":e={shadowIntensity:1,
shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lb};break;case "PointLight":e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lb,shadowCameraNear:1,shadowCameraFar:1E3}}return a[c.id]=e}}}function Ih(a,c){return(c.castShadow?2:0)-(a.castShadow?2:0)+(c.map?1:0)-(a.map?1:0)}function wi(a){const c=new Zi,e=Zg(),h={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,
numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let x=0;9>x;x++)h.probe.push(new Da);const l=new Da,p=new Wc,w=new Wc;return{setup:function(x){let y=
0,D=0,H=0;for(var I=0;9>I;I++)h.probe[I].set(0,0,0);let L=I=0,Y=0,P=0,Z=0,aa=0,T=0,ha=0,Ca=0,xa=0,Ha=0;x.sort(Ih);for(let wb=0,Mb=x.length;wb<Mb;wb++){var Fa=x[wb],Ra=Fa.color,Ja=Fa.intensity,Ka=Fa.distance,lb=Fa.shadow&&Fa.shadow.map?Fa.shadow.map.texture:null;if(Fa.isAmbientLight)y+=Ra.r*Ja,D+=Ra.g*Ja,H+=Ra.b*Ja;else if(Fa.isLightProbe){for(lb=0;9>lb;lb++)h.probe[lb].addScaledVector(Fa.sh.coefficients[lb],Ja);Ha++}else if(Fa.isDirectionalLight)Ja=c.get(Fa),Ja.color.copy(Fa.color).multiplyScalar(Fa.intensity),
Fa.castShadow&&(Ra=Fa.shadow,Ka=e.get(Fa),Ka.shadowIntensity=Ra.intensity,Ka.shadowBias=Ra.bias,Ka.shadowNormalBias=Ra.normalBias,Ka.shadowRadius=Ra.radius,Ka.shadowMapSize=Ra.mapSize,h.directionalShadow[I]=Ka,h.directionalShadowMap[I]=lb,h.directionalShadowMatrix[I]=Fa.shadow.matrix,aa++),h.directional[I]=Ja,I++;else if(Fa.isSpotLight){const kb=c.get(Fa);kb.position.setFromMatrixPosition(Fa.matrixWorld);kb.color.copy(Ra).multiplyScalar(Ja);kb.distance=Ka;kb.coneCos=Math.cos(Fa.angle);kb.penumbraCos=
Math.cos(Fa.angle*(1-Fa.penumbra));kb.decay=Fa.decay;h.spot[Y]=kb;Ja=Fa.shadow;Fa.map&&(h.spotLightMap[Ca]=Fa.map,Ca++,Ja.updateMatrices(Fa),Fa.castShadow&&xa++);h.spotLightMatrix[Y]=Ja.matrix;Fa.castShadow&&(Fa=e.get(Fa),Fa.shadowIntensity=Ja.intensity,Fa.shadowBias=Ja.bias,Fa.shadowNormalBias=Ja.normalBias,Fa.shadowRadius=Ja.radius,Fa.shadowMapSize=Ja.mapSize,h.spotShadow[Y]=Fa,h.spotShadowMap[Y]=lb,ha++);Y++}else Fa.isRectAreaLight?(lb=c.get(Fa),lb.color.copy(Ra).multiplyScalar(Ja),lb.halfWidth.set(.5*
Fa.width,0,0),lb.halfHeight.set(0,.5*Fa.height,0),h.rectArea[P]=lb,P++):Fa.isPointLight?(Ja=c.get(Fa),Ja.color.copy(Fa.color).multiplyScalar(Fa.intensity),Ja.distance=Fa.distance,Ja.decay=Fa.decay,Fa.castShadow&&(Ra=Fa.shadow,Ka=e.get(Fa),Ka.shadowIntensity=Ra.intensity,Ka.shadowBias=Ra.bias,Ka.shadowNormalBias=Ra.normalBias,Ka.shadowRadius=Ra.radius,Ka.shadowMapSize=Ra.mapSize,Ka.shadowCameraNear=Ra.camera.near,Ka.shadowCameraFar=Ra.camera.far,h.pointShadow[L]=Ka,h.pointShadowMap[L]=lb,h.pointShadowMatrix[L]=
Fa.shadow.matrix,T++),h.point[L]=Ja,L++):Fa.isHemisphereLight&&(lb=c.get(Fa),lb.skyColor.copy(Fa.color).multiplyScalar(Ja),lb.groundColor.copy(Fa.groundColor).multiplyScalar(Ja),h.hemi[Z]=lb,Z++)}0<P&&(!0===a.has("OES_texture_float_linear")?(h.rectAreaLTC1=oc.LTC_FLOAT_1,h.rectAreaLTC2=oc.LTC_FLOAT_2):(h.rectAreaLTC1=oc.LTC_HALF_1,h.rectAreaLTC2=oc.LTC_HALF_2));h.ambient[0]=y;h.ambient[1]=D;h.ambient[2]=H;x=h.hash;if(x.directionalLength!==I||x.pointLength!==L||x.spotLength!==Y||x.rectAreaLength!==
P||x.hemiLength!==Z||x.numDirectionalShadows!==aa||x.numPointShadows!==T||x.numSpotShadows!==ha||x.numSpotMaps!==Ca||x.numLightProbes!==Ha)h.directional.length=I,h.spot.length=Y,h.rectArea.length=P,h.point.length=L,h.hemi.length=Z,h.directionalShadow.length=aa,h.directionalShadowMap.length=aa,h.pointShadow.length=T,h.pointShadowMap.length=T,h.spotShadow.length=ha,h.spotShadowMap.length=ha,h.directionalShadowMatrix.length=aa,h.pointShadowMatrix.length=T,h.spotLightMatrix.length=ha+Ca-xa,h.spotLightMap.length=
Ca,h.numSpotLightShadowsWithMaps=xa,h.numLightProbes=Ha,x.directionalLength=I,x.pointLength=L,x.spotLength=Y,x.rectAreaLength=P,x.hemiLength=Z,x.numDirectionalShadows=aa,x.numPointShadows=T,x.numSpotShadows=ha,x.numSpotMaps=Ca,x.numLightProbes=Ha,h.version=Ob++},setupView:function(x,y){let D=0,H=0,I=0,L=0,Y=0;y=y.matrixWorldInverse;for(let Z=0,aa=x.length;Z<aa;Z++){const T=x[Z];if(T.isDirectionalLight){var P=h.directional[D];P.direction.setFromMatrixPosition(T.matrixWorld);l.setFromMatrixPosition(T.target.matrixWorld);
P.direction.sub(l);P.direction.transformDirection(y);D++}else T.isSpotLight?(P=h.spot[I],P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(y),P.direction.setFromMatrixPosition(T.matrixWorld),l.setFromMatrixPosition(T.target.matrixWorld),P.direction.sub(l),P.direction.transformDirection(y),I++):T.isRectAreaLight?(P=h.rectArea[L],P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(y),w.identity(),p.copy(T.matrixWorld),p.premultiply(y),w.extractRotation(p),P.halfWidth.set(.5*
T.width,0,0),P.halfHeight.set(0,.5*T.height,0),P.halfWidth.applyMatrix4(w),P.halfHeight.applyMatrix4(w),L++):T.isPointLight?(P=h.point[H],P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(y),H++):T.isHemisphereLight&&(P=h.hemi[Y],P.direction.setFromMatrixPosition(T.matrixWorld),P.direction.transformDirection(y),Y++)}},state:h}}function rh(a){const c=new wi(a),e=[],h=[],l={lightsArray:e,shadowsArray:h,camera:null,lights:c,transmissionRenderTarget:{}};return{init:function(p){l.camera=
p;e.length=0;h.length=0},state:l,setupLights:function(){c.setup(e)},setupLightsView:function(p){c.setupView(e,p)},pushLight:function(p){e.push(p)},pushShadow:function(p){h.push(p)}}}function yf(a){let c=new WeakMap;return{get:function(e,h=0){const l=c.get(e);void 0===l?(h=new rh(a),c.set(e,[h])):h>=l.length?(h=new rh(a),l.push(h)):h=l[h];return h},dispose:function(){c=new WeakMap}}}function Jh(a,c,e){function h(xa,Ha,Fa,Ra){xa=!0===Fa.isPointLight?xa.customDistanceMaterial:xa.customDepthMaterial;
if(void 0===xa&&(xa=!0===Fa.isPointLight?I:H,a.localClippingEnabled&&!0===Ha.clipShadows&&Array.isArray(Ha.clippingPlanes)&&0!==Ha.clippingPlanes.length||Ha.displacementMap&&0!==Ha.displacementScale||Ha.alphaMap&&0<Ha.alphaTest||Ha.map&&0<Ha.alphaTest)){var Ja=xa.uuid;const Ka=Ha.uuid;let lb=L[Ja];void 0===lb&&(lb={},L[Ja]=lb);Ja=lb[Ka];void 0===Ja&&(Ja=xa.clone(),lb[Ka]=Ja,Ha.addEventListener("dispose",p));xa=Ja}xa.visible=Ha.visible;xa.wireframe=Ha.wireframe;xa.side=3===Ra?null!==Ha.shadowSide?
Ha.shadowSide:Ha.side:null!==Ha.shadowSide?Ha.shadowSide:P[Ha.side];xa.alphaMap=Ha.alphaMap;xa.alphaTest=Ha.alphaTest;xa.map=Ha.map;xa.clipShadows=Ha.clipShadows;xa.clippingPlanes=Ha.clippingPlanes;xa.clipIntersection=Ha.clipIntersection;xa.displacementMap=Ha.displacementMap;xa.displacementScale=Ha.displacementScale;xa.displacementBias=Ha.displacementBias;xa.wireframeLinewidth=Ha.wireframeLinewidth;xa.linewidth=Ha.linewidth;!0===Fa.isPointLight&&!0===xa.isMeshDistanceMaterial&&(a.properties.get(xa).light=
Fa);return xa}function l(xa,Ha,Fa,Ra,Ja){if(!1!==xa.visible){if(xa.layers.test(Ha.layers)&&(xa.isMesh||xa.isLine||xa.isPoints)&&(xa.castShadow||xa.receiveShadow&&3===Ja)&&(!xa.frustumCulled||w.intersectsObject(xa))){xa.modelViewMatrix.multiplyMatrices(Fa.matrixWorldInverse,xa.matrixWorld);const wb=c.update(xa);var Ka=xa.material;if(Array.isArray(Ka)){const Mb=wb.groups;for(let kb=0,jc=Mb.length;kb<jc;kb++){const Wb=Mb[kb];var lb=Ka[Wb.materialIndex];lb&&lb.visible&&(lb=h(xa,lb,Ra,Ja),xa.onBeforeShadow(a,
xa,Ha,Fa,wb,lb,Wb),a.renderBufferDirect(Fa,null,wb,lb,xa,Wb),xa.onAfterShadow(a,xa,Ha,Fa,wb,lb,Wb))}}else Ka.visible&&(Ka=h(xa,Ka,Ra,Ja),xa.onBeforeShadow(a,xa,Ha,Fa,wb,Ka,null),a.renderBufferDirect(Fa,null,wb,Ka,xa,null),xa.onAfterShadow(a,xa,Ha,Fa,wb,Ka,null))}xa=xa.children;for(let wb=0,Mb=xa.length;wb<Mb;wb++)l(xa[wb],Ha,Fa,Ra,Ja)}}function p(xa){xa.target.removeEventListener("dispose",p);for(const Ha in L){const Fa=L[Ha],Ra=xa.target.uuid;Ra in Fa&&(Fa[Ra].dispose(),delete Fa[Ra])}}let w=new fk;
const x=new Lb,y=new Lb,D=new yd,H=new Jb({depthPacking:3201}),I=new $b,L={},Y=e.maxTextureSize,P={[0]:1,[1]:0,[2]:2},Z=new ih({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Lb},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position \x3d vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include \x3cpacking\x3e\nvoid main() {\n\tconst float samples \x3d float( VSM_SAMPLES );\n\tfloat mean \x3d 0.0;\n\tfloat squared_mean \x3d 0.0;\n\tfloat uvStride \x3d samples \x3c\x3d 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart \x3d samples \x3c\x3d 1.0 ? 0.0 : - 1.0;\n\tfor ( float i \x3d 0.0; i \x3c samples; i ++ ) {\n\t\tfloat uvOffset \x3d uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution \x3d unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean +\x3d distribution.x;\n\t\t\tsquared_mean +\x3d distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth \x3d unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean +\x3d depth;\n\t\t\tsquared_mean +\x3d depth * depth;\n\t\t#endif\n\t}\n\tmean \x3d mean / samples;\n\tsquared_mean \x3d squared_mean / samples;\n\tfloat std_dev \x3d sqrt( squared_mean - mean * mean );\n\tgl_FragColor \x3d pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),
aa=Z.clone();aa.defines.HORIZONTAL_PASS=1;e=new Xc;e.setAttribute("position",new mc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new nf(e,Z),ha=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;let Ca=this.type=1;this.render=function(xa,Ha,Fa){if(!1!==ha.enabled&&(!1!==ha.autoUpdate||!1!==ha.needsUpdate)&&0!==xa.length){var Ra=a.getRenderTarget(),Ja=a.getActiveCubeFace(),Ka=a.getActiveMipmapLevel(),lb=a.state;lb.setBlending(0);lb.buffers.color.setClear(1,1,1,1);lb.buffers.depth.setTest(!0);
lb.setScissorTest(!1);var wb=3!==Ca&&3===this.type,Mb=3===Ca&&3!==this.type;for(let Xb=0,ad=xa.length;Xb<ad;Xb++){var kb=xa[Xb];const wc=kb.shadow;if(void 0===wc)console.warn("THREE.WebGLShadowMap:",kb,"has no shadow.");else if(!1!==wc.autoUpdate||!1!==wc.needsUpdate){x.copy(wc.mapSize);var jc=wc.getFrameExtents();x.multiply(jc);y.copy(wc.mapSize);if(x.x>Y||x.y>Y)x.x>Y&&(y.x=Math.floor(Y/jc.x),x.x=y.x*jc.x,wc.mapSize.x=y.x),x.y>Y&&(y.y=Math.floor(Y/jc.y),x.y=y.y*jc.y,wc.mapSize.y=y.y);if(null===wc.map||
!0===wb||!0===Mb)jc=3!==this.type?{minFilter:1003,magFilter:1003}:{},null!==wc.map&&wc.map.dispose(),wc.map=new dd(x.x,x.y,jc),wc.map.texture.name=kb.name+".shadowMap",wc.camera.updateProjectionMatrix();a.setRenderTarget(wc.map);a.clear();jc=wc.getViewportCount();for(var Wb=0;Wb<jc;Wb++){const Tb=wc.getViewport(Wb);D.set(y.x*Tb.x,y.y*Tb.y,y.x*Tb.z,y.y*Tb.w);lb.viewport(D);wc.updateMatrices(kb,Wb);w=wc.getFrustum();l(Ha,Fa,wc.camera,kb,this.type)}!0!==wc.isPointLightShadow&&3===this.type&&(kb=wc,jc=
Fa,Wb=c.update(T),Z.defines.VSM_SAMPLES!==kb.blurSamples&&(Z.defines.VSM_SAMPLES=kb.blurSamples,aa.defines.VSM_SAMPLES=kb.blurSamples,Z.needsUpdate=!0,aa.needsUpdate=!0),null===kb.mapPass&&(kb.mapPass=new dd(x.x,x.y)),Z.uniforms.shadow_pass.value=kb.map.texture,Z.uniforms.resolution.value=kb.mapSize,Z.uniforms.radius.value=kb.radius,a.setRenderTarget(kb.mapPass),a.clear(),a.renderBufferDirect(jc,null,Wb,Z,T,null),aa.uniforms.shadow_pass.value=kb.mapPass.texture,aa.uniforms.resolution.value=kb.mapSize,
aa.uniforms.radius.value=kb.radius,a.setRenderTarget(kb.map),a.clear(),a.renderBufferDirect(jc,null,Wb,aa,T,null));wc.needsUpdate=!1}}Ca=this.type;ha.needsUpdate=!1;a.setRenderTarget(Ra,Ja,Ka)}}}function uj(a){function c(La,ub,mb,ib){const Gb=new Uint8Array(4),Yb=a.createTexture();a.bindTexture(La,Yb);a.texParameteri(La,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(La,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let rc=0;rc<mb;rc++)La===a.TEXTURE_3D||La===a.TEXTURE_2D_ARRAY?a.texImage3D(ub,0,a.RGBA,1,1,
ib,0,a.RGBA,a.UNSIGNED_BYTE,Gb):a.texImage2D(ub+rc,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,Gb);return Yb}function e(La){!0!==Y[La]&&(a.enable(La),Y[La]=!0)}function h(La){!1!==Y[La]&&(a.disable(La),Y[La]=!1)}function l(La,ub,mb,ib,Gb,Yb,rc,pc,Kd,bd){if(0===La)!0===ha&&(h(a.BLEND),ha=!1);else if(!1===ha&&(e(a.BLEND),ha=!0),5!==La){if(La!==Ca||bd!==Mb){if(100!==xa||100!==Ra)a.blendEquation(a.FUNC_ADD),Ra=xa=100;if(bd)switch(La){case 1:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);
break;case 2:a.blendFunc(a.ONE,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",La)}else switch(La){case 1:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFunc(a.ZERO,
a.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",La)}Ka=Ja=Fa=Ha=null;lb.set(0,0,0);wb=0;Ca=La;Mb=bd}}else{Gb=Gb||ub;Yb=Yb||mb;rc=rc||ib;if(ub!==xa||Gb!==Ra)a.blendEquationSeparate(Oa[ub],Oa[Gb]),xa=ub,Ra=Gb;if(mb!==Ha||ib!==Fa||Yb!==Ja||rc!==Ka)a.blendFuncSeparate(Ya[mb],Ya[ib],Ya[Yb],Ya[rc]),Ha=mb,Fa=ib,Ja=Yb,Ka=rc;if(!1===pc.equals(lb)||Kd!==wb)a.blendColor(pc.r,pc.g,pc.b,Kd),lb.copy(pc),wb=Kd;Ca=La;Mb=!1}}function p(La){kb!==La&&(La?a.frontFace(a.CW):a.frontFace(a.CCW),
kb=La)}function w(La){0!==La?(e(a.CULL_FACE),La!==jc&&(1===La?a.cullFace(a.BACK):2===La?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):h(a.CULL_FACE);jc=La}function x(La,ub,mb){if(La){if(e(a.POLYGON_OFFSET_FILL),Xb!==ub||ad!==mb)a.polygonOffset(ub,mb),Xb=ub,ad=mb}else h(a.POLYGON_OFFSET_FILL)}const y=new function(){let La=!1;const ub=new yd;let mb=null;const ib=new yd(0,0,0,0);return{setMask:function(Gb){mb===Gb||La||(a.colorMask(Gb,Gb,Gb,Gb),mb=Gb)},setLocked:function(Gb){La=Gb},setClear:function(Gb,
Yb,rc,pc,Kd){!0===Kd&&(Gb*=pc,Yb*=pc,rc*=pc);ub.set(Gb,Yb,rc,pc);!1===ib.equals(ub)&&(a.clearColor(Gb,Yb,rc,pc),ib.copy(ub))},reset:function(){La=!1;mb=null;ib.set(-1,0,0,0)}}},D=new function(){let La=!1,ub=!1,mb=null,ib=null,Gb=null;return{setReversed:function(Yb){ub=Yb},setTest:function(Yb){Yb?e(a.DEPTH_TEST):h(a.DEPTH_TEST)},setMask:function(Yb){mb===Yb||La||(a.depthMask(Yb),mb=Yb)},setFunc:function(Yb){ub&&(Yb=vc[Yb]);if(ib!==Yb){switch(Yb){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);
break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}ib=Yb}},setLocked:function(Yb){La=Yb},setClear:function(Yb){Gb!==Yb&&(a.clearDepth(Yb),Gb=Yb)},reset:function(){La=!1;Gb=ib=mb=null}}},H=new function(){let La=!1,ub=null,mb=null,ib=null,Gb=null,Yb=null,rc=null,pc=null,Kd=null;return{setTest:function(bd){La||
(bd?e(a.STENCIL_TEST):h(a.STENCIL_TEST))},setMask:function(bd){ub===bd||La||(a.stencilMask(bd),ub=bd)},setFunc:function(bd,Ae,Dd){if(mb!==bd||ib!==Ae||Gb!==Dd)a.stencilFunc(bd,Ae,Dd),mb=bd,ib=Ae,Gb=Dd},setOp:function(bd,Ae,Dd){if(Yb!==bd||rc!==Ae||pc!==Dd)a.stencilOp(bd,Ae,Dd),Yb=bd,rc=Ae,pc=Dd},setLocked:function(bd){La=bd},setClear:function(bd){Kd!==bd&&(a.clearStencil(bd),Kd=bd)},reset:function(){La=!1;Kd=pc=rc=Yb=Gb=ib=mb=ub=null}}},I=new WeakMap,L=new WeakMap;let Y={},P={},Z=new WeakMap,aa=[],
T=null,ha=!1,Ca=null,xa=null,Ha=null,Fa=null,Ra=null,Ja=null,Ka=null,lb=new ia(0,0,0),wb=0,Mb=!1,kb=null,jc=null,Wb=null,Xb=null,ad=null;const wc=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Tb=!1;var Hb=0;Hb=a.getParameter(a.VERSION);-1!==Hb.indexOf("WebGL")?(Hb=parseFloat(/^WebGL (\d)/.exec(Hb)[1]),Tb=1<=Hb):-1!==Hb.indexOf("OpenGL ES")&&(Hb=parseFloat(/^OpenGL ES (\d)/.exec(Hb)[1]),Tb=2<=Hb);let Ub=null,zc={};Hb=a.getParameter(a.SCISSOR_BOX);const cc=a.getParameter(a.VIEWPORT),sa=(new yd).fromArray(Hb),
ka=(new yd).fromArray(cc),wa={};wa[a.TEXTURE_2D]=c(a.TEXTURE_2D,a.TEXTURE_2D,1);wa[a.TEXTURE_CUBE_MAP]=c(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);wa[a.TEXTURE_2D_ARRAY]=c(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1);wa[a.TEXTURE_3D]=c(a.TEXTURE_3D,a.TEXTURE_3D,1,1);y.setClear(0,0,0,1);D.setClear(1);H.setClear(0);e(a.DEPTH_TEST);D.setFunc(3);p(!1);w(1);e(a.CULL_FACE);l(0);const Oa={[100]:a.FUNC_ADD,[101]:a.FUNC_SUBTRACT,[102]:a.FUNC_REVERSE_SUBTRACT};Oa[103]=a.MIN;Oa[104]=a.MAX;const Ya={[200]:a.ZERO,
[201]:a.ONE,[202]:a.SRC_COLOR,[204]:a.SRC_ALPHA,[210]:a.SRC_ALPHA_SATURATE,[208]:a.DST_COLOR,[206]:a.DST_ALPHA,[203]:a.ONE_MINUS_SRC_COLOR,[205]:a.ONE_MINUS_SRC_ALPHA,[209]:a.ONE_MINUS_DST_COLOR,[207]:a.ONE_MINUS_DST_ALPHA,[211]:a.CONSTANT_COLOR,[212]:a.ONE_MINUS_CONSTANT_COLOR,[213]:a.CONSTANT_ALPHA,[214]:a.ONE_MINUS_CONSTANT_ALPHA};return{buffers:{color:y,depth:D,stencil:H},enable:e,disable:h,bindFramebuffer:function(La,ub){return P[La]!==ub?(a.bindFramebuffer(La,ub),P[La]=ub,La===a.DRAW_FRAMEBUFFER&&
(P[a.FRAMEBUFFER]=ub),La===a.FRAMEBUFFER&&(P[a.DRAW_FRAMEBUFFER]=ub),!0):!1},drawBuffers:function(La,ub){let mb=aa,ib=!1;if(La){if(mb=Z.get(ub),void 0===mb&&(mb=[],Z.set(ub,mb)),La=La.textures,mb.length!==La.length||mb[0]!==a.COLOR_ATTACHMENT0){for(let Gb=0,Yb=La.length;Gb<Yb;Gb++)mb[Gb]=a.COLOR_ATTACHMENT0+Gb;mb.length=La.length;ib=!0}}else mb[0]!==a.BACK&&(mb[0]=a.BACK,ib=!0);ib&&a.drawBuffers(mb)},useProgram:function(La){return T!==La?(a.useProgram(La),T=La,!0):!1},setBlending:l,setMaterial:function(La,
ub){2===La.side?h(a.CULL_FACE):e(a.CULL_FACE);let mb=1===La.side;ub&&(mb=!mb);p(mb);1===La.blending&&!1===La.transparent?l(0):l(La.blending,La.blendEquation,La.blendSrc,La.blendDst,La.blendEquationAlpha,La.blendSrcAlpha,La.blendDstAlpha,La.blendColor,La.blendAlpha,La.premultipliedAlpha);D.setFunc(La.depthFunc);D.setTest(La.depthTest);D.setMask(La.depthWrite);y.setMask(La.colorWrite);ub=La.stencilWrite;H.setTest(ub);ub&&(H.setMask(La.stencilWriteMask),H.setFunc(La.stencilFunc,La.stencilRef,La.stencilFuncMask),
H.setOp(La.stencilFail,La.stencilZFail,La.stencilZPass));x(La.polygonOffset,La.polygonOffsetFactor,La.polygonOffsetUnits);!0===La.alphaToCoverage?e(a.SAMPLE_ALPHA_TO_COVERAGE):h(a.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:p,setCullFace:w,setLineWidth:function(La){La!==Wb&&(Tb&&a.lineWidth(La),Wb=La)},setPolygonOffset:x,setScissorTest:function(La){La?e(a.SCISSOR_TEST):h(a.SCISSOR_TEST)},activeTexture:function(La){void 0===La&&(La=a.TEXTURE0+wc-1);Ub!==La&&(a.activeTexture(La),Ub=La)},bindTexture:function(La,
ub,mb){void 0===mb&&(mb=null===Ub?a.TEXTURE0+wc-1:Ub);let ib=zc[mb];void 0===ib&&(ib={type:void 0,texture:void 0},zc[mb]=ib);if(ib.type!==La||ib.texture!==ub)Ub!==mb&&(a.activeTexture(mb),Ub=mb),a.bindTexture(La,ub||wa[La]),ib.type=La,ib.texture=ub},unbindTexture:function(){const La=zc[Ub];void 0!==La&&void 0!==La.type&&(a.bindTexture(La.type,null),La.type=void 0,La.texture=void 0)},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",
La)}},compressedTexImage3D:function(){try{a.compressedTexImage3D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},updateUBOMapping:function(La,ub){let mb=L.get(ub);void 0===mb&&(mb=new WeakMap,L.set(ub,mb));let ib=mb.get(La);void 0===ib&&(ib=a.getUniformBlockIndex(ub,
La.name),mb.set(La,ib))},uniformBlockBinding:function(La,ub){const mb=L.get(ub).get(La);I.get(ub)!==mb&&(a.uniformBlockBinding(ub,mb,La.__bindingPointIndex),I.set(ub,mb))},texStorage2D:function(){try{a.texStorage2D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},texStorage3D:function(){try{a.texStorage3D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},texSubImage2D:function(){try{a.texSubImage2D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",
La)}},texSubImage3D:function(){try{a.texSubImage3D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},compressedTexSubImage2D:function(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},compressedTexSubImage3D:function(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(La){console.error("THREE.WebGLState:",La)}},scissor:function(La){!1===sa.equals(La)&&(a.scissor(La.x,La.y,La.z,La.w),sa.copy(La))},viewport:function(La){!1===
ka.equals(La)&&(a.viewport(La.x,La.y,La.z,La.w),ka.copy(La))},reset:function(){a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.POLYGON_OFFSET_FILL);a.disable(a.SCISSOR_TEST);a.disable(a.STENCIL_TEST);a.disable(a.SAMPLE_ALPHA_TO_COVERAGE);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO);a.blendColor(0,0,0,0);a.colorMask(!0,!0,!0,!0);a.clearColor(0,0,0,0);a.depthMask(!0);a.depthFunc(a.LESS);a.clearDepth(1);a.stencilMask(4294967295);
a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.clearStencil(0);a.cullFace(a.BACK);a.frontFace(a.CCW);a.polygonOffset(0,0);a.activeTexture(a.TEXTURE0);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null);a.bindFramebuffer(a.READ_FRAMEBUFFER,null);a.useProgram(null);a.lineWidth(1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.viewport(0,0,a.canvas.width,a.canvas.height);Y={};Ub=null;zc={};P={};Z=new WeakMap;aa=[];T=null;ha=!1;Ka=Ja=Ra=Fa=Ha=xa=
Ca=null;lb=new ia(0,0,0);wb=0;Mb=!1;ad=Xb=Wb=jc=kb=null;sa.set(0,0,a.canvas.width,a.canvas.height);ka.set(0,0,a.canvas.width,a.canvas.height);y.reset();D.reset();H.reset()}}}function Yg(a,c,e,h){h=Ud(h);switch(e){case 1021:return a*c;case 1024:return a*c;case 1025:return a*c*2;case 1028:return a*c/h.components*h.byteLength;case 1029:return a*c/h.components*h.byteLength;case 1030:return a*c*2/h.components*h.byteLength;case 1031:return a*c*2/h.components*h.byteLength;case 1022:return a*c*3/h.components*
h.byteLength;case 1023:return a*c*4/h.components*h.byteLength;case 1033:return a*c*4/h.components*h.byteLength;case 33776:case 33777:return Math.floor((a+3)/4)*Math.floor((c+3)/4)*8;case 33778:case 33779:return Math.floor((a+3)/4)*Math.floor((c+3)/4)*16;case 35841:case 35843:return Math.max(a,16)*Math.max(c,8)/4;case 35840:case 35842:return Math.max(a,8)*Math.max(c,8)/2;case 36196:case 37492:return Math.floor((a+3)/4)*Math.floor((c+3)/4)*8;case 37496:return Math.floor((a+3)/4)*Math.floor((c+3)/4)*
16;case 37808:return Math.floor((a+3)/4)*Math.floor((c+3)/4)*16;case 37809:return Math.floor((a+4)/5)*Math.floor((c+3)/4)*16;case 37810:return Math.floor((a+4)/5)*Math.floor((c+4)/5)*16;case 37811:return Math.floor((a+5)/6)*Math.floor((c+4)/5)*16;case 37812:return Math.floor((a+5)/6)*Math.floor((c+5)/6)*16;case 37813:return Math.floor((a+7)/8)*Math.floor((c+4)/5)*16;case 37814:return Math.floor((a+7)/8)*Math.floor((c+5)/6)*16;case 37815:return Math.floor((a+7)/8)*Math.floor((c+7)/8)*16;case 37816:return Math.floor((a+
9)/10)*Math.floor((c+4)/5)*16;case 37817:return Math.floor((a+9)/10)*Math.floor((c+5)/6)*16;case 37818:return Math.floor((a+9)/10)*Math.floor((c+7)/8)*16;case 37819:return Math.floor((a+9)/10)*Math.floor((c+9)/10)*16;case 37820:return Math.floor((a+11)/12)*Math.floor((c+9)/10)*16;case 37821:return Math.floor((a+11)/12)*Math.floor((c+11)/12)*16;case 36492:case 36494:case 36495:return Math.ceil(a/4)*Math.ceil(c/4)*16;case 36283:case 36284:return Math.ceil(a/4)*Math.ceil(c/4)*8;case 36285:case 36286:return Math.ceil(a/
4)*Math.ceil(c/4)*16}throw Error(`Unable to determine texture byte length for ${e} format.`);}function Ud(a){switch(a){case 1009:case 1010:return{byteLength:1,components:1};case 1012:case 1011:case 1016:return{byteLength:2,components:1};case 1017:case 1018:return{byteLength:2,components:4};case 1014:case 1013:case 1015:return{byteLength:4,components:1};case 35902:return{byteLength:4,components:3}}throw Error(`Unknown texture type ${a}.`);}function xi(a,c,e,h,l,p,w){function x(sa,ka,wa){var Oa=1;const Ya=
lb(sa);if(Ya.width>wa||Ya.height>wa)Oa=wa/Math.max(Ya.width,Ya.height);if(1>Oa){if("undefined"!==typeof HTMLImageElement&&sa instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&sa instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&sa instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&sa instanceof VideoFrame)return wa=Math.floor(Oa*Ya.width),Oa=Math.floor(Oa*Ya.height),void 0===Wb&&(Wb=ad?new OffscreenCanvas(wa,Oa):Ab("canvas")),ka=ka?ad?new OffscreenCanvas(wa,
Oa):Ab("canvas"):Wb,ka.width=wa,ka.height=Oa,ka.getContext("2d").drawImage(sa,0,0,wa,Oa),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ya.width+"x"+Ya.height+") to ("+wa+"x"+Oa+")."),ka;"data"in sa&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ya.width+"x"+Ya.height+").")}return sa}function y(sa){return sa.generateMipmaps&&1003!==sa.minFilter&&1006!==sa.minFilter}function D(sa,ka,wa,Oa,Ya=!1){if(null!==sa){if(void 0!==a[sa])return a[sa];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+
sa+"'")}sa=ka;ka===a.RED&&(wa===a.FLOAT&&(sa=a.R32F),wa===a.HALF_FLOAT&&(sa=a.R16F),wa===a.UNSIGNED_BYTE&&(sa=a.R8));ka===a.RED_INTEGER&&(wa===a.UNSIGNED_BYTE&&(sa=a.R8UI),wa===a.UNSIGNED_SHORT&&(sa=a.R16UI),wa===a.UNSIGNED_INT&&(sa=a.R32UI),wa===a.BYTE&&(sa=a.R8I),wa===a.SHORT&&(sa=a.R16I),wa===a.INT&&(sa=a.R32I));ka===a.RG&&(wa===a.FLOAT&&(sa=a.RG32F),wa===a.HALF_FLOAT&&(sa=a.RG16F),wa===a.UNSIGNED_BYTE&&(sa=a.RG8));ka===a.RG_INTEGER&&(wa===a.UNSIGNED_BYTE&&(sa=a.RG8UI),wa===a.UNSIGNED_SHORT&&(sa=
a.RG16UI),wa===a.UNSIGNED_INT&&(sa=a.RG32UI),wa===a.BYTE&&(sa=a.RG8I),wa===a.SHORT&&(sa=a.RG16I),wa===a.INT&&(sa=a.RG32I));ka===a.RGB_INTEGER&&(wa===a.UNSIGNED_BYTE&&(sa=a.RGB8UI),wa===a.UNSIGNED_SHORT&&(sa=a.RGB16UI),wa===a.UNSIGNED_INT&&(sa=a.RGB32UI),wa===a.BYTE&&(sa=a.RGB8I),wa===a.SHORT&&(sa=a.RGB16I),wa===a.INT&&(sa=a.RGB32I));ka===a.RGBA_INTEGER&&(wa===a.UNSIGNED_BYTE&&(sa=a.RGBA8UI),wa===a.UNSIGNED_SHORT&&(sa=a.RGBA16UI),wa===a.UNSIGNED_INT&&(sa=a.RGBA32UI),wa===a.BYTE&&(sa=a.RGBA8I),wa===
a.SHORT&&(sa=a.RGBA16I),wa===a.INT&&(sa=a.RGBA32I));ka===a.RGB&&wa===a.UNSIGNED_INT_5_9_9_9_REV&&(sa=a.RGB9_E5);ka===a.RGBA&&(ka=Ya?"linear":Eb.getTransfer(Oa),wa===a.FLOAT&&(sa=a.RGBA32F),wa===a.HALF_FLOAT&&(sa=a.RGBA16F),wa===a.UNSIGNED_BYTE&&(sa="srgb"===ka?a.SRGB8_ALPHA8:a.RGBA8),wa===a.UNSIGNED_SHORT_4_4_4_4&&(sa=a.RGBA4),wa===a.UNSIGNED_SHORT_5_5_5_1&&(sa=a.RGB5_A1));sa!==a.R16F&&sa!==a.R32F&&sa!==a.RG16F&&sa!==a.RG32F&&sa!==a.RGBA16F&&sa!==a.RGBA32F||c.get("EXT_color_buffer_float");return sa}
function H(sa,ka){let wa;sa?null===ka||1014===ka||1020===ka?wa=a.DEPTH24_STENCIL8:1015===ka?wa=a.DEPTH32F_STENCIL8:1012===ka&&(wa=a.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===ka||1014===ka||1020===ka?wa=a.DEPTH_COMPONENT24:1015===ka?wa=a.DEPTH_COMPONENT32F:1012===ka&&(wa=a.DEPTH_COMPONENT16);return wa}function I(sa,ka){return!0===y(sa)||sa.isFramebufferTexture&&1003!==sa.minFilter&&1006!==sa.minFilter?Math.log2(Math.max(ka.width,
ka.height))+1:void 0!==sa.mipmaps&&0<sa.mipmaps.length?sa.mipmaps.length:sa.isCompressedTexture&&Array.isArray(sa.image)?ka.mipmaps.length:1}function L(sa){sa=sa.target;sa.removeEventListener("dispose",L);var ka=h.get(sa);if(void 0!==ka.__webglInit){var wa=sa.source,Oa=Xb.get(wa);Oa&&(ka=Oa[ka.__cacheKey],ka.usedTimes--,0===ka.usedTimes&&P(sa),0===Object.keys(Oa).length&&Xb.delete(wa));h.remove(sa)}sa.isVideoTexture&&jc.delete(sa)}function Y(sa){sa=sa.target;sa.removeEventListener("dispose",Y);var ka=
h.get(sa);sa.depthTexture&&sa.depthTexture.dispose();if(sa.isWebGLCubeRenderTarget)for(var wa=0;6>wa;wa++){if(Array.isArray(ka.__webglFramebuffer[wa]))for(let Oa=0;Oa<ka.__webglFramebuffer[wa].length;Oa++)a.deleteFramebuffer(ka.__webglFramebuffer[wa][Oa]);else a.deleteFramebuffer(ka.__webglFramebuffer[wa]);ka.__webglDepthbuffer&&a.deleteRenderbuffer(ka.__webglDepthbuffer[wa])}else{if(Array.isArray(ka.__webglFramebuffer))for(wa=0;wa<ka.__webglFramebuffer.length;wa++)a.deleteFramebuffer(ka.__webglFramebuffer[wa]);
else a.deleteFramebuffer(ka.__webglFramebuffer);ka.__webglDepthbuffer&&a.deleteRenderbuffer(ka.__webglDepthbuffer);ka.__webglMultisampledFramebuffer&&a.deleteFramebuffer(ka.__webglMultisampledFramebuffer);if(ka.__webglColorRenderbuffer)for(wa=0;wa<ka.__webglColorRenderbuffer.length;wa++)ka.__webglColorRenderbuffer[wa]&&a.deleteRenderbuffer(ka.__webglColorRenderbuffer[wa]);ka.__webglDepthRenderbuffer&&a.deleteRenderbuffer(ka.__webglDepthRenderbuffer)}ka=sa.textures;for(let Oa=0,Ya=ka.length;Oa<Ya;Oa++)wa=
h.get(ka[Oa]),wa.__webglTexture&&(a.deleteTexture(wa.__webglTexture),w.memory.textures--),h.remove(ka[Oa]);h.remove(sa)}function P(sa){const ka=h.get(sa);a.deleteTexture(ka.__webglTexture);delete Xb.get(sa.source)[ka.__cacheKey];w.memory.textures--}function Z(sa,ka){const wa=h.get(sa);if(sa.isVideoTexture){var Oa=w.render.frame;jc.get(sa)!==Oa&&(jc.set(sa,Oa),sa.update())}if(!1===sa.isRenderTargetTexture&&0<sa.version&&wa.__version!==sa.version)if(Oa=sa.image,null===Oa)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");
else if(!1===Oa.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ha(wa,sa,ka);return}e.bindTexture(a.TEXTURE_2D,wa.__webglTexture,a.TEXTURE0+ka)}function aa(sa,ka){1015!==ka.type||!1!==c.has("OES_texture_float_linear")||1006!==ka.magFilter&&1007!==ka.magFilter&&1005!==ka.magFilter&&1008!==ka.magFilter&&1006!==ka.minFilter&&1007!==ka.minFilter&&1005!==ka.minFilter&&1008!==ka.minFilter||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device.");
a.texParameteri(sa,a.TEXTURE_WRAP_S,Tb[ka.wrapS]);a.texParameteri(sa,a.TEXTURE_WRAP_T,Tb[ka.wrapT]);sa!==a.TEXTURE_3D&&sa!==a.TEXTURE_2D_ARRAY||a.texParameteri(sa,a.TEXTURE_WRAP_R,Tb[ka.wrapR]);a.texParameteri(sa,a.TEXTURE_MAG_FILTER,Hb[ka.magFilter]);a.texParameteri(sa,a.TEXTURE_MIN_FILTER,Hb[ka.minFilter]);ka.compareFunction&&(a.texParameteri(sa,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(sa,a.TEXTURE_COMPARE_FUNC,Ub[ka.compareFunction]));if(!0===c.has("EXT_texture_filter_anisotropic")&&
!(1003===ka.magFilter||1005!==ka.minFilter&&1008!==ka.minFilter||1015===ka.type&&!1===c.has("OES_texture_float_linear"))&&(1<ka.anisotropy||h.get(ka).__currentAnisotropy)){const wa=c.get("EXT_texture_filter_anisotropic");a.texParameterf(sa,wa.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ka.anisotropy,l.getMaxAnisotropy()));h.get(ka).__currentAnisotropy=ka.anisotropy}}function T(sa,ka){let wa=!1;void 0===sa.__webglInit&&(sa.__webglInit=!0,ka.addEventListener("dispose",L));var Oa=ka.source;let Ya=Xb.get(Oa);
void 0===Ya&&(Ya={},Xb.set(Oa,Ya));Oa=[];Oa.push(ka.wrapS);Oa.push(ka.wrapT);Oa.push(ka.wrapR||0);Oa.push(ka.magFilter);Oa.push(ka.minFilter);Oa.push(ka.anisotropy);Oa.push(ka.internalFormat);Oa.push(ka.format);Oa.push(ka.type);Oa.push(ka.generateMipmaps);Oa.push(ka.premultiplyAlpha);Oa.push(ka.flipY);Oa.push(ka.unpackAlignment);Oa.push(ka.colorSpace);Oa=Oa.join();if(Oa!==sa.__cacheKey){void 0===Ya[Oa]&&(Ya[Oa]={texture:a.createTexture(),usedTimes:0},w.memory.textures++,wa=!0);Ya[Oa].usedTimes++;
const La=Ya[sa.__cacheKey];void 0!==La&&(Ya[sa.__cacheKey].usedTimes--,0===La.usedTimes&&P(ka));sa.__cacheKey=Oa;sa.__webglTexture=Ya[Oa].texture}return wa}function ha(sa,ka,wa){let Oa=a.TEXTURE_2D;if(ka.isDataArrayTexture||ka.isCompressedArrayTexture)Oa=a.TEXTURE_2D_ARRAY;ka.isData3DTexture&&(Oa=a.TEXTURE_3D);var Ya=T(sa,ka);const La=ka.source;e.bindTexture(Oa,sa.__webglTexture,a.TEXTURE0+wa);const ub=h.get(La);if(La.version!==ub.__version||!0===Ya){e.activeTexture(a.TEXTURE0+wa);wa=Eb.getPrimaries(Eb.workingColorSpace);
var mb=""===ka.colorSpace?null:Eb.getPrimaries(ka.colorSpace);wa=""===ka.colorSpace||wa===mb?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,ka.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ka.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,ka.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,wa);var ib=x(ka.image,!1,l.maxTextureSize);ib=Ka(ka,ib);wa=p.convert(ka.format,ka.colorSpace);mb=p.convert(ka.type);var Gb=D(ka.internalFormat,wa,mb,ka.colorSpace,
ka.isVideoTexture);aa(Oa,ka);const bd=ka.mipmaps,Ae=!0!==ka.isVideoTexture;var Yb=void 0===ub.__version||!0===Ya;Ya=La.dataReady;var rc=I(ka,ib);if(ka.isDepthTexture)Gb=H(1027===ka.format,ka.type),Yb&&(Ae?e.texStorage2D(a.TEXTURE_2D,1,Gb,ib.width,ib.height):e.texImage2D(a.TEXTURE_2D,0,Gb,ib.width,ib.height,0,wa,mb,null));else if(ka.isDataTexture)if(0<bd.length){Ae&&Yb&&e.texStorage2D(a.TEXTURE_2D,rc,Gb,bd[0].width,bd[0].height);for(let Dd=0,Mj=bd.length;Dd<Mj;Dd++){var pc=bd[Dd];Ae?Ya&&e.texSubImage2D(a.TEXTURE_2D,
Dd,0,0,pc.width,pc.height,wa,mb,pc.data):e.texImage2D(a.TEXTURE_2D,Dd,Gb,pc.width,pc.height,0,wa,mb,pc.data)}ka.generateMipmaps=!1}else Ae?(Yb&&e.texStorage2D(a.TEXTURE_2D,rc,Gb,ib.width,ib.height),Ya&&e.texSubImage2D(a.TEXTURE_2D,0,0,0,ib.width,ib.height,wa,mb,ib.data)):e.texImage2D(a.TEXTURE_2D,0,Gb,ib.width,ib.height,0,wa,mb,ib.data);else if(ka.isCompressedTexture)if(ka.isCompressedArrayTexture){Ae&&Yb&&e.texStorage3D(a.TEXTURE_2D_ARRAY,rc,Gb,bd[0].width,bd[0].height,ib.depth);for(let Dd=0,Mj=
bd.length;Dd<Mj;Dd++)if(pc=bd[Dd],1023!==ka.format)if(null!==wa)if(Ae){if(Ya)if(0<ka.layerUpdates.size){rc=Yg(pc.width,pc.height,ka.format,ka.type);for(var Kd of ka.layerUpdates)Yb=pc.data.subarray(Kd*rc/pc.data.BYTES_PER_ELEMENT,(Kd+1)*rc/pc.data.BYTES_PER_ELEMENT),e.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,Dd,0,0,Kd,pc.width,pc.height,1,wa,Yb,0,0);ka.clearLayerUpdates()}else e.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,Dd,0,0,0,pc.width,pc.height,ib.depth,wa,pc.data,0,0)}else e.compressedTexImage3D(a.TEXTURE_2D_ARRAY,
Dd,Gb,pc.width,pc.height,ib.depth,0,pc.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ae?Ya&&e.texSubImage3D(a.TEXTURE_2D_ARRAY,Dd,0,0,0,pc.width,pc.height,ib.depth,wa,mb,pc.data):e.texImage3D(a.TEXTURE_2D_ARRAY,Dd,Gb,pc.width,pc.height,ib.depth,0,wa,mb,pc.data)}else{Ae&&Yb&&e.texStorage2D(a.TEXTURE_2D,rc,Gb,bd[0].width,bd[0].height);for(let Dd=0,Mj=bd.length;Dd<Mj;Dd++)pc=bd[Dd],1023!==ka.format?null!==wa?Ae?Ya&&
e.compressedTexSubImage2D(a.TEXTURE_2D,Dd,0,0,pc.width,pc.height,wa,pc.data):e.compressedTexImage2D(a.TEXTURE_2D,Dd,Gb,pc.width,pc.height,0,pc.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ae?Ya&&e.texSubImage2D(a.TEXTURE_2D,Dd,0,0,pc.width,pc.height,wa,mb,pc.data):e.texImage2D(a.TEXTURE_2D,Dd,Gb,pc.width,pc.height,0,wa,mb,pc.data)}else if(ka.isDataArrayTexture)if(Ae){if(Yb&&e.texStorage3D(a.TEXTURE_2D_ARRAY,rc,Gb,ib.width,ib.height,
ib.depth),Ya)if(0<ka.layerUpdates.size){Gb=Yg(ib.width,ib.height,ka.format,ka.type);for(pc of ka.layerUpdates)Kd=ib.data.subarray(pc*Gb/ib.data.BYTES_PER_ELEMENT,(pc+1)*Gb/ib.data.BYTES_PER_ELEMENT),e.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,pc,ib.width,ib.height,1,wa,mb,Kd);ka.clearLayerUpdates()}else e.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,ib.width,ib.height,ib.depth,wa,mb,ib.data)}else e.texImage3D(a.TEXTURE_2D_ARRAY,0,Gb,ib.width,ib.height,ib.depth,0,wa,mb,ib.data);else if(ka.isData3DTexture)Ae?
(Yb&&e.texStorage3D(a.TEXTURE_3D,rc,Gb,ib.width,ib.height,ib.depth),Ya&&e.texSubImage3D(a.TEXTURE_3D,0,0,0,0,ib.width,ib.height,ib.depth,wa,mb,ib.data)):e.texImage3D(a.TEXTURE_3D,0,Gb,ib.width,ib.height,ib.depth,0,wa,mb,ib.data);else if(ka.isFramebufferTexture){if(Yb)if(Ae)e.texStorage2D(a.TEXTURE_2D,rc,Gb,ib.width,ib.height);else for(Kd=ib.width,ib=ib.height,pc=0;pc<rc;pc++)e.texImage2D(a.TEXTURE_2D,pc,Gb,Kd,ib,0,wa,mb,null),Kd>>=1,ib>>=1}else if(0<bd.length){Ae&&Yb&&(ib=lb(bd[0]),e.texStorage2D(a.TEXTURE_2D,
rc,Gb,ib.width,ib.height));for(let Dd=0,Mj=bd.length;Dd<Mj;Dd++)pc=bd[Dd],Ae?Ya&&e.texSubImage2D(a.TEXTURE_2D,Dd,0,0,wa,mb,pc):e.texImage2D(a.TEXTURE_2D,Dd,Gb,wa,mb,pc);ka.generateMipmaps=!1}else Ae?(Yb&&(Kd=lb(ib),e.texStorage2D(a.TEXTURE_2D,rc,Gb,Kd.width,Kd.height)),Ya&&e.texSubImage2D(a.TEXTURE_2D,0,0,0,wa,mb,ib)):e.texImage2D(a.TEXTURE_2D,0,Gb,wa,mb,ib);y(ka)&&a.generateMipmap(Oa);ub.__version=La.version;if(ka.onUpdate)ka.onUpdate(ka)}sa.__version=ka.version}function Ca(sa,ka,wa,Oa,Ya,La){const ub=
p.convert(wa.format,wa.colorSpace),mb=p.convert(wa.type),ib=D(wa.internalFormat,ub,mb,wa.colorSpace);if(!h.get(ka).__hasExternalTextures){const Gb=Math.max(1,ka.width>>La),Yb=Math.max(1,ka.height>>La);Ya===a.TEXTURE_3D||Ya===a.TEXTURE_2D_ARRAY?e.texImage3D(Ya,La,ib,Gb,Yb,ka.depth,0,ub,mb,null):e.texImage2D(Ya,La,ib,Gb,Yb,0,ub,mb,null)}e.bindFramebuffer(a.FRAMEBUFFER,sa);Ja(ka)?wb.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,Oa,Ya,h.get(wa).__webglTexture,0,Ra(ka)):(Ya===a.TEXTURE_2D||Ya>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&
Ya<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,Oa,Ya,h.get(wa).__webglTexture,La);e.bindFramebuffer(a.FRAMEBUFFER,null)}function xa(sa,ka,wa){a.bindRenderbuffer(a.RENDERBUFFER,sa);if(ka.depthBuffer){var Oa=ka.depthTexture;Oa=H(ka.stencilBuffer,Oa&&Oa.isDepthTexture?Oa.type:null);var Ya=ka.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,La=Ra(ka);Ja(ka)?wb.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,La,Oa,ka.width,ka.height):wa?a.renderbufferStorageMultisample(a.RENDERBUFFER,
La,Oa,ka.width,ka.height):a.renderbufferStorage(a.RENDERBUFFER,Oa,ka.width,ka.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,Ya,a.RENDERBUFFER,sa)}else for(sa=ka.textures,Oa=0;Oa<sa.length;Oa++){Ya=sa[Oa];La=p.convert(Ya.format,Ya.colorSpace);const ub=p.convert(Ya.type);Ya=D(Ya.internalFormat,La,ub,Ya.colorSpace);La=Ra(ka);wa&&!1===Ja(ka)?a.renderbufferStorageMultisample(a.RENDERBUFFER,La,Ya,ka.width,ka.height):Ja(ka)?wb.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,La,Ya,ka.width,ka.height):
a.renderbufferStorage(a.RENDERBUFFER,Ya,ka.width,ka.height)}a.bindRenderbuffer(a.RENDERBUFFER,null)}function Ha(sa,ka){if(ka&&ka.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");e.bindFramebuffer(a.FRAMEBUFFER,sa);if(!ka.depthTexture||!ka.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");h.get(ka.depthTexture).__webglTexture&&ka.depthTexture.image.width===ka.width&&ka.depthTexture.image.height===
ka.height||(ka.depthTexture.image.width=ka.width,ka.depthTexture.image.height=ka.height,ka.depthTexture.needsUpdate=!0);Z(ka.depthTexture,0);sa=h.get(ka.depthTexture).__webglTexture;const wa=Ra(ka);if(1026===ka.depthTexture.format)Ja(ka)?wb.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,sa,0,wa):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,sa,0);else if(1027===ka.depthTexture.format)Ja(ka)?wb.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,
a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,sa,0,wa):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,sa,0);else throw Error("Unknown depthTexture format");}function Fa(sa){const ka=h.get(sa);var wa=!0===sa.isWebGLCubeRenderTarget;if(ka.__boundDepthTexture!==sa.depthTexture){const Oa=sa.depthTexture;ka.__depthDisposeCallback&&ka.__depthDisposeCallback();if(Oa){const Ya=()=>{delete ka.__boundDepthTexture;delete ka.__depthDisposeCallback;Oa.removeEventListener("dispose",Ya)};
Oa.addEventListener("dispose",Ya);ka.__depthDisposeCallback=Ya}ka.__boundDepthTexture=Oa}if(sa.depthTexture&&!ka.__autoAllocateDepthBuffer){if(wa)throw Error("target.depthTexture not supported in Cube render targets");Ha(ka.__webglFramebuffer,sa)}else if(wa)for(ka.__webglDepthbuffer=[],wa=0;6>wa;wa++)if(e.bindFramebuffer(a.FRAMEBUFFER,ka.__webglFramebuffer[wa]),void 0===ka.__webglDepthbuffer[wa])ka.__webglDepthbuffer[wa]=a.createRenderbuffer(),xa(ka.__webglDepthbuffer[wa],sa,!1);else{const Oa=sa.stencilBuffer?
a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,Ya=ka.__webglDepthbuffer[wa];a.bindRenderbuffer(a.RENDERBUFFER,Ya);a.framebufferRenderbuffer(a.FRAMEBUFFER,Oa,a.RENDERBUFFER,Ya)}else e.bindFramebuffer(a.FRAMEBUFFER,ka.__webglFramebuffer),void 0===ka.__webglDepthbuffer?(ka.__webglDepthbuffer=a.createRenderbuffer(),xa(ka.__webglDepthbuffer,sa,!1)):(sa=sa.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,wa=ka.__webglDepthbuffer,a.bindRenderbuffer(a.RENDERBUFFER,wa),a.framebufferRenderbuffer(a.FRAMEBUFFER,
sa,a.RENDERBUFFER,wa));e.bindFramebuffer(a.FRAMEBUFFER,null)}function Ra(sa){return Math.min(l.maxSamples,sa.samples)}function Ja(sa){const ka=h.get(sa);return 0<sa.samples&&!0===c.has("WEBGL_multisampled_render_to_texture")&&!1!==ka.__useRenderToTexture}function Ka(sa,ka){const wa=sa.colorSpace,Oa=sa.format,Ya=sa.type;if(!0===sa.isCompressedTexture||!0===sa.isVideoTexture)return ka;"srgb-linear"!==wa&&""!==wa&&("srgb"===Eb.getTransfer(wa)?(1023!==Oa||1009!==Ya)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):
console.error("THREE.WebGLTextures: Unsupported texture color space:",wa));return ka}function lb(sa){"undefined"!==typeof HTMLImageElement&&sa instanceof HTMLImageElement?(kb.width=sa.naturalWidth||sa.width,kb.height=sa.naturalHeight||sa.height):"undefined"!==typeof VideoFrame&&sa instanceof VideoFrame?(kb.width=sa.displayWidth,kb.height=sa.displayHeight):(kb.width=sa.width,kb.height=sa.height);return kb}const wb=c.has("WEBGL_multisampled_render_to_texture")?c.get("WEBGL_multisampled_render_to_texture"):
null,Mb="undefined"===typeof navigator?!1:/OculusBrowser/g.test(navigator.userAgent),kb=new Lb,jc=new WeakMap;let Wb;const Xb=new WeakMap;let ad=!1;try{ad="undefined"!==typeof OffscreenCanvas&&null!==(new OffscreenCanvas(1,1)).getContext("2d")}catch(sa){}let wc=0;const Tb={[1E3]:a.REPEAT,[1001]:a.CLAMP_TO_EDGE,[1002]:a.MIRRORED_REPEAT},Hb={[1003]:a.NEAREST,[1004]:a.NEAREST_MIPMAP_NEAREST,[1005]:a.NEAREST_MIPMAP_LINEAR,[1006]:a.LINEAR,[1007]:a.LINEAR_MIPMAP_NEAREST,[1008]:a.LINEAR_MIPMAP_LINEAR},Ub=
{[512]:a.NEVER,[519]:a.ALWAYS,[513]:a.LESS,[515]:a.LEQUAL,[514]:a.EQUAL,[518]:a.GEQUAL,[516]:a.GREATER,[517]:a.NOTEQUAL},zc=[],cc=[];this.allocateTextureUnit=function(){const sa=wc;sa>=l.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+sa+" texture units while this GPU supports only "+l.maxTextures);wc+=1;return sa};this.resetTextureUnits=function(){wc=0};this.setTexture2D=Z;this.setTexture2DArray=function(sa,ka){const wa=h.get(sa);0<sa.version&&wa.__version!==sa.version?ha(wa,sa,ka):
e.bindTexture(a.TEXTURE_2D_ARRAY,wa.__webglTexture,a.TEXTURE0+ka)};this.setTexture3D=function(sa,ka){const wa=h.get(sa);0<sa.version&&wa.__version!==sa.version?ha(wa,sa,ka):e.bindTexture(a.TEXTURE_3D,wa.__webglTexture,a.TEXTURE0+ka)};this.setTextureCube=function(sa,ka){const wa=h.get(sa);if(0<sa.version&&wa.__version!==sa.version){if(6===sa.image.length){var Oa=T(wa,sa),Ya=sa.source;e.bindTexture(a.TEXTURE_CUBE_MAP,wa.__webglTexture,a.TEXTURE0+ka);var La=h.get(Ya);if(Ya.version!==La.__version||!0===
Oa){e.activeTexture(a.TEXTURE0+ka);ka=Eb.getPrimaries(Eb.workingColorSpace);var ub=""===sa.colorSpace?null:Eb.getPrimaries(sa.colorSpace);ka=""===sa.colorSpace||ka===ub?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,sa.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,sa.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,sa.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,ka);var mb=sa.isCompressedTexture||sa.image[0].isCompressedTexture,ib=sa.image[0]&&
sa.image[0].isDataTexture;ka=[];for(ub=0;6>ub;ub++)ka[ub]=mb||ib?ib?sa.image[ub].image:sa.image[ub]:x(sa.image[ub],!0,l.maxCubemapSize),ka[ub]=Ka(sa,ka[ub]);var Gb=ka[0];ub=p.convert(sa.format,sa.colorSpace);const pc=p.convert(sa.type),Kd=D(sa.internalFormat,ub,pc,sa.colorSpace),bd=!0!==sa.isVideoTexture;var Yb=void 0===La.__version||!0===Oa;Oa=Ya.dataReady;var rc=I(sa,Gb);aa(a.TEXTURE_CUBE_MAP,sa);if(mb)for(bd&&Yb&&e.texStorage2D(a.TEXTURE_CUBE_MAP,rc,Kd,Gb.width,Gb.height),ib=0;6>ib;ib++)for(mb=
ka[ib].mipmaps,rc=0;rc<mb.length;rc++)Gb=mb[rc],1023!==sa.format?null!==ub?bd?Oa&&e.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ib,rc,0,0,Gb.width,Gb.height,ub,Gb.data):e.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ib,rc,Kd,Gb.width,Gb.height,0,Gb.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):bd?Oa&&e.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ib,rc,0,0,Gb.width,Gb.height,ub,pc,Gb.data):e.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+
ib,rc,Kd,Gb.width,Gb.height,0,ub,pc,Gb.data);else for(mb=sa.mipmaps,bd&&Yb&&(0<mb.length&&rc++,Gb=lb(ka[0]),e.texStorage2D(a.TEXTURE_CUBE_MAP,rc,Kd,Gb.width,Gb.height)),rc=0;6>rc;rc++)if(ib)for(bd?Oa&&e.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,0,0,0,ka[rc].width,ka[rc].height,ub,pc,ka[rc].data):e.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,0,Kd,ka[rc].width,ka[rc].height,0,ub,pc,ka[rc].data),Gb=0;Gb<mb.length;Gb++)Yb=mb[Gb].image[rc].image,bd?Oa&&e.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+
rc,Gb+1,0,0,Yb.width,Yb.height,ub,pc,Yb.data):e.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,Gb+1,Kd,Yb.width,Yb.height,0,ub,pc,Yb.data);else for(bd?Oa&&e.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,0,0,0,ub,pc,ka[rc]):e.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,0,Kd,ub,pc,ka[rc]),Gb=0;Gb<mb.length;Gb++)Yb=mb[Gb],bd?Oa&&e.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,Gb+1,0,0,ub,pc,Yb.image[rc]):e.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+rc,Gb+1,Kd,ub,pc,Yb.image[rc]);y(sa)&&a.generateMipmap(a.TEXTURE_CUBE_MAP);
La.__version=Ya.version;if(sa.onUpdate)sa.onUpdate(sa)}wa.__version=sa.version}}else e.bindTexture(a.TEXTURE_CUBE_MAP,wa.__webglTexture,a.TEXTURE0+ka)};this.rebindTextures=function(sa,ka,wa){const Oa=h.get(sa);void 0!==ka&&Ca(Oa.__webglFramebuffer,sa,sa.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0);void 0!==wa&&Fa(sa)};this.setupRenderTarget=function(sa){var ka=sa.texture;const wa=h.get(sa);var Oa=h.get(ka);sa.addEventListener("dispose",Y);var Ya=sa.textures;const La=!0===sa.isWebGLCubeRenderTarget,
ub=1<Ya.length;ub||(void 0===Oa.__webglTexture&&(Oa.__webglTexture=a.createTexture()),Oa.__version=ka.version,w.memory.textures++);if(La){wa.__webglFramebuffer=[];for(var mb=0;6>mb;mb++)if(ka.mipmaps&&0<ka.mipmaps.length){wa.__webglFramebuffer[mb]=[];for(var ib=0;ib<ka.mipmaps.length;ib++)wa.__webglFramebuffer[mb][ib]=a.createFramebuffer()}else wa.__webglFramebuffer[mb]=a.createFramebuffer()}else{if(ka.mipmaps&&0<ka.mipmaps.length)for(wa.__webglFramebuffer=[],mb=0;mb<ka.mipmaps.length;mb++)wa.__webglFramebuffer[mb]=
a.createFramebuffer();else wa.__webglFramebuffer=a.createFramebuffer();if(ub)for(let Yb=0,rc=Ya.length;Yb<rc;Yb++)mb=h.get(Ya[Yb]),void 0===mb.__webglTexture&&(mb.__webglTexture=a.createTexture(),w.memory.textures++);if(0<sa.samples&&!1===Ja(sa)){wa.__webglMultisampledFramebuffer=a.createFramebuffer();wa.__webglColorRenderbuffer=[];e.bindFramebuffer(a.FRAMEBUFFER,wa.__webglMultisampledFramebuffer);for(mb=0;mb<Ya.length;mb++){ib=Ya[mb];wa.__webglColorRenderbuffer[mb]=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,
wa.__webglColorRenderbuffer[mb]);var Gb=p.convert(ib.format,ib.colorSpace);const Yb=p.convert(ib.type);ib=D(ib.internalFormat,Gb,Yb,ib.colorSpace,!0===sa.isXRRenderTarget);Gb=Ra(sa);a.renderbufferStorageMultisample(a.RENDERBUFFER,Gb,ib,sa.width,sa.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+mb,a.RENDERBUFFER,wa.__webglColorRenderbuffer[mb])}a.bindRenderbuffer(a.RENDERBUFFER,null);sa.depthBuffer&&(wa.__webglDepthRenderbuffer=a.createRenderbuffer(),xa(wa.__webglDepthRenderbuffer,
sa,!0));e.bindFramebuffer(a.FRAMEBUFFER,null)}}if(La){e.bindTexture(a.TEXTURE_CUBE_MAP,Oa.__webglTexture);aa(a.TEXTURE_CUBE_MAP,ka);for(Ya=0;6>Ya;Ya++)if(ka.mipmaps&&0<ka.mipmaps.length)for(Oa=0;Oa<ka.mipmaps.length;Oa++)Ca(wa.__webglFramebuffer[Ya][Oa],sa,ka,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+Ya,Oa);else Ca(wa.__webglFramebuffer[Ya],sa,ka,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+Ya,0);y(ka)&&a.generateMipmap(a.TEXTURE_CUBE_MAP)}else if(ub)for(let Yb=0,rc=Ya.length;Yb<rc;Yb++)ka=
Ya[Yb],Oa=h.get(ka),e.bindTexture(a.TEXTURE_2D,Oa.__webglTexture),aa(a.TEXTURE_2D,ka),Ca(wa.__webglFramebuffer,sa,ka,a.COLOR_ATTACHMENT0+Yb,a.TEXTURE_2D,0),y(ka)&&a.generateMipmap(a.TEXTURE_2D);else{Ya=a.TEXTURE_2D;if(sa.isWebGL3DRenderTarget||sa.isWebGLArrayRenderTarget)Ya=sa.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY;e.bindTexture(Ya,Oa.__webglTexture);aa(Ya,ka);if(ka.mipmaps&&0<ka.mipmaps.length)for(Oa=0;Oa<ka.mipmaps.length;Oa++)Ca(wa.__webglFramebuffer[Oa],sa,ka,a.COLOR_ATTACHMENT0,
Ya,Oa);else Ca(wa.__webglFramebuffer,sa,ka,a.COLOR_ATTACHMENT0,Ya,0);y(ka)&&a.generateMipmap(Ya)}e.unbindTexture();sa.depthBuffer&&Fa(sa)};this.updateRenderTargetMipmap=function(sa){const ka=sa.textures;for(let Oa=0,Ya=ka.length;Oa<Ya;Oa++){var wa=ka[Oa];if(y(wa)){const La=sa.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D;wa=h.get(wa).__webglTexture;e.bindTexture(La,wa);a.generateMipmap(La);e.unbindTexture()}}};this.updateMultisampleRenderTarget=function(sa){if(0<sa.samples)if(!1===Ja(sa)){const Oa=
sa.textures;var ka=sa.width;const Ya=sa.height;let La=a.COLOR_BUFFER_BIT;const ub=sa.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,mb=h.get(sa),ib=1<Oa.length;if(ib)for(var wa=0;wa<Oa.length;wa++)e.bindFramebuffer(a.FRAMEBUFFER,mb.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+wa,a.RENDERBUFFER,null),e.bindFramebuffer(a.FRAMEBUFFER,mb.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+wa,a.TEXTURE_2D,null,0);
e.bindFramebuffer(a.READ_FRAMEBUFFER,mb.__webglMultisampledFramebuffer);e.bindFramebuffer(a.DRAW_FRAMEBUFFER,mb.__webglFramebuffer);for(wa=0;wa<Oa.length;wa++){sa.resolveDepthBuffer&&(sa.depthBuffer&&(La|=a.DEPTH_BUFFER_BIT),sa.stencilBuffer&&sa.resolveStencilBuffer&&(La|=a.STENCIL_BUFFER_BIT));if(ib){a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,mb.__webglColorRenderbuffer[wa]);const Gb=h.get(Oa[wa]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,
a.TEXTURE_2D,Gb,0)}a.blitFramebuffer(0,0,ka,Ya,0,0,ka,Ya,La,a.NEAREST);!0===Mb&&(zc.length=0,cc.length=0,zc.push(a.COLOR_ATTACHMENT0+wa),sa.depthBuffer&&!1===sa.resolveDepthBuffer&&(zc.push(ub),cc.push(ub),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,cc)),a.invalidateFramebuffer(a.READ_FRAMEBUFFER,zc))}e.bindFramebuffer(a.READ_FRAMEBUFFER,null);e.bindFramebuffer(a.DRAW_FRAMEBUFFER,null);if(ib)for(sa=0;sa<Oa.length;sa++)e.bindFramebuffer(a.FRAMEBUFFER,mb.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,
a.COLOR_ATTACHMENT0+sa,a.RENDERBUFFER,mb.__webglColorRenderbuffer[sa]),ka=h.get(Oa[sa]).__webglTexture,e.bindFramebuffer(a.FRAMEBUFFER,mb.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+sa,a.TEXTURE_2D,ka,0);e.bindFramebuffer(a.DRAW_FRAMEBUFFER,mb.__webglMultisampledFramebuffer)}else sa.depthBuffer&&!1===sa.resolveDepthBuffer&&Mb&&a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[sa.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT])};this.setupDepthRenderbuffer=
Fa;this.setupFrameBufferTexture=Ca;this.useMultisampledRTT=Ja}function Eg(a,c){return{convert:function(e,h=""){const l=Eb.getTransfer(h);if(1009===e)return a.UNSIGNED_BYTE;if(1017===e)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return a.UNSIGNED_SHORT_5_5_5_1;if(35902===e)return a.UNSIGNED_INT_5_9_9_9_REV;if(1010===e)return a.BYTE;if(1011===e)return a.SHORT;if(1012===e)return a.UNSIGNED_SHORT;if(1013===e)return a.INT;if(1014===e)return a.UNSIGNED_INT;if(1015===e)return a.FLOAT;if(1016===e)return a.HALF_FLOAT;
if(1021===e)return a.ALPHA;if(1022===e)return a.RGB;if(1023===e)return a.RGBA;if(1024===e)return a.LUMINANCE;if(1025===e)return a.LUMINANCE_ALPHA;if(1026===e)return a.DEPTH_COMPONENT;if(1027===e)return a.DEPTH_STENCIL;if(1028===e)return a.RED;if(1029===e)return a.RED_INTEGER;if(1030===e)return a.RG;if(1031===e)return a.RG_INTEGER;if(1033===e)return a.RGBA_INTEGER;if(33776===e||33777===e||33778===e||33779===e)if("srgb"===l)if(h=c.get("WEBGL_compressed_texture_s3tc_srgb"),null!==h){if(33776===e)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;
if(33777===e)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===e)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===e)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(h=c.get("WEBGL_compressed_texture_s3tc"),null!==h){if(33776===e)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(35840===e||35841===e||35842===
e||35843===e)if(h=c.get("WEBGL_compressed_texture_pvrtc"),null!==h){if(35840===e)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(36196===e||37492===e||37496===e)if(h=c.get("WEBGL_compressed_texture_etc"),null!==h){if(36196===e||37492===e)return"srgb"===l?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===e)return"srgb"===
l?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e)if(h=c.get("WEBGL_compressed_texture_astc"),null!==h){if(37808===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===
e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===e)return"srgb"===
l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===e)return"srgb"===
l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===e)return"srgb"===l?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(36492===e||36494===e||36495===e)if(h=c.get("EXT_texture_compression_bptc"),null!==h){if(36492===e)return"srgb"===l?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===e)return h.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===e)return h.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;
if(36283===e||36284===e||36285===e||36286===e)if(h=c.get("EXT_texture_compression_rgtc"),null!==h){if(36492===e)return h.COMPRESSED_RED_RGTC1_EXT;if(36284===e)return h.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===e)return h.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===e)return h.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return 1020===e?a.UNSIGNED_INT_24_8:void 0!==a[e]?a[e]:null}}}function $h(a,c){function e(l,p){!0===l.matrixAutoUpdate&&l.updateMatrix();p.value.copy(l.matrix)}function h(l,
p){l.opacity.value=p.opacity;p.color&&l.diffuse.value.copy(p.color);p.emissive&&l.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity);p.map&&(l.map.value=p.map,e(p.map,l.mapTransform));p.alphaMap&&(l.alphaMap.value=p.alphaMap,e(p.alphaMap,l.alphaMapTransform));p.bumpMap&&(l.bumpMap.value=p.bumpMap,e(p.bumpMap,l.bumpMapTransform),l.bumpScale.value=p.bumpScale,1===p.side&&(l.bumpScale.value*=-1));p.normalMap&&(l.normalMap.value=p.normalMap,e(p.normalMap,l.normalMapTransform),l.normalScale.value.copy(p.normalScale),
1===p.side&&l.normalScale.value.negate());p.displacementMap&&(l.displacementMap.value=p.displacementMap,e(p.displacementMap,l.displacementMapTransform),l.displacementScale.value=p.displacementScale,l.displacementBias.value=p.displacementBias);p.emissiveMap&&(l.emissiveMap.value=p.emissiveMap,e(p.emissiveMap,l.emissiveMapTransform));p.specularMap&&(l.specularMap.value=p.specularMap,e(p.specularMap,l.specularMapTransform));0<p.alphaTest&&(l.alphaTest.value=p.alphaTest);var w=c.get(p);const x=w.envMap;
w=w.envMapRotation;x&&(l.envMap.value=x,wd.copy(w),wd.x*=-1,wd.y*=-1,wd.z*=-1,x.isCubeTexture&&!1===x.isRenderTargetTexture&&(wd.y*=-1,wd.z*=-1),l.envMapRotation.value.setFromMatrix4(Fd.makeRotationFromEuler(wd)),l.flipEnvMap.value=x.isCubeTexture&&!1===x.isRenderTargetTexture?-1:1,l.reflectivity.value=p.reflectivity,l.ior.value=p.ior,l.refractionRatio.value=p.refractionRatio);p.lightMap&&(l.lightMap.value=p.lightMap,l.lightMapIntensity.value=p.lightMapIntensity,e(p.lightMap,l.lightMapTransform));
p.aoMap&&(l.aoMap.value=p.aoMap,l.aoMapIntensity.value=p.aoMapIntensity,e(p.aoMap,l.aoMapTransform))}return{refreshFogUniforms:function(l,p){p.color.getRGB(l.fogColor.value,Hc(a));p.isFog?(l.fogNear.value=p.near,l.fogFar.value=p.far):p.isFogExp2&&(l.fogDensity.value=p.density)},refreshMaterialUniforms:function(l,p,w,x,y){p.isMeshBasicMaterial?h(l,p):p.isMeshLambertMaterial?h(l,p):p.isMeshToonMaterial?(h(l,p),p.gradientMap&&(l.gradientMap.value=p.gradientMap)):p.isMeshPhongMaterial?(h(l,p),l.specular.value.copy(p.specular),
l.shininess.value=Math.max(p.shininess,1E-4)):p.isMeshStandardMaterial?(h(l,p),l.metalness.value=p.metalness,p.metalnessMap&&(l.metalnessMap.value=p.metalnessMap,e(p.metalnessMap,l.metalnessMapTransform)),l.roughness.value=p.roughness,p.roughnessMap&&(l.roughnessMap.value=p.roughnessMap,e(p.roughnessMap,l.roughnessMapTransform)),p.envMap&&(l.envMapIntensity.value=p.envMapIntensity),p.isMeshPhysicalMaterial&&(l.ior.value=p.ior,0<p.sheen&&(l.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),
l.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(l.sheenColorMap.value=p.sheenColorMap,e(p.sheenColorMap,l.sheenColorMapTransform)),p.sheenRoughnessMap&&(l.sheenRoughnessMap.value=p.sheenRoughnessMap,e(p.sheenRoughnessMap,l.sheenRoughnessMapTransform))),0<p.clearcoat&&(l.clearcoat.value=p.clearcoat,l.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(l.clearcoatMap.value=p.clearcoatMap,e(p.clearcoatMap,l.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(l.clearcoatRoughnessMap.value=
p.clearcoatRoughnessMap,e(p.clearcoatRoughnessMap,l.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(l.clearcoatNormalMap.value=p.clearcoatNormalMap,e(p.clearcoatNormalMap,l.clearcoatNormalMapTransform),l.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),1===p.side&&l.clearcoatNormalScale.value.negate())),0<p.dispersion&&(l.dispersion.value=p.dispersion),0<p.iridescence&&(l.iridescence.value=p.iridescence,l.iridescenceIOR.value=p.iridescenceIOR,l.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],
l.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(l.iridescenceMap.value=p.iridescenceMap,e(p.iridescenceMap,l.iridescenceMapTransform)),p.iridescenceThicknessMap&&(l.iridescenceThicknessMap.value=p.iridescenceThicknessMap,e(p.iridescenceThicknessMap,l.iridescenceThicknessMapTransform))),0<p.transmission&&(l.transmission.value=p.transmission,l.transmissionSamplerMap.value=y.texture,l.transmissionSamplerSize.value.set(y.width,y.height),p.transmissionMap&&(l.transmissionMap.value=
p.transmissionMap,e(p.transmissionMap,l.transmissionMapTransform)),l.thickness.value=p.thickness,p.thicknessMap&&(l.thicknessMap.value=p.thicknessMap,e(p.thicknessMap,l.thicknessMapTransform)),l.attenuationDistance.value=p.attenuationDistance,l.attenuationColor.value.copy(p.attenuationColor)),0<p.anisotropy&&(l.anisotropyVector.value.set(p.anisotropy*Math.cos(p.anisotropyRotation),p.anisotropy*Math.sin(p.anisotropyRotation)),p.anisotropyMap&&(l.anisotropyMap.value=p.anisotropyMap,e(p.anisotropyMap,
l.anisotropyMapTransform))),l.specularIntensity.value=p.specularIntensity,l.specularColor.value.copy(p.specularColor),p.specularColorMap&&(l.specularColorMap.value=p.specularColorMap,e(p.specularColorMap,l.specularColorMapTransform)),p.specularIntensityMap&&(l.specularIntensityMap.value=p.specularIntensityMap,e(p.specularIntensityMap,l.specularIntensityMapTransform)))):p.isMeshMatcapMaterial?(h(l,p),p.matcap&&(l.matcap.value=p.matcap)):p.isMeshDepthMaterial?h(l,p):p.isMeshDistanceMaterial?(h(l,p),
p=c.get(p).light,l.referencePosition.value.setFromMatrixPosition(p.matrixWorld),l.nearDistance.value=p.shadow.camera.near,l.farDistance.value=p.shadow.camera.far):p.isMeshNormalMaterial?h(l,p):p.isLineBasicMaterial?(l.diffuse.value.copy(p.color),l.opacity.value=p.opacity,p.map&&(l.map.value=p.map,e(p.map,l.mapTransform)),p.isLineDashedMaterial&&(l.dashSize.value=p.dashSize,l.totalSize.value=p.dashSize+p.gapSize,l.scale.value=p.scale)):p.isPointsMaterial?(l.diffuse.value.copy(p.color),l.opacity.value=
p.opacity,l.size.value=p.size*w,l.scale.value=.5*x,p.map&&(l.map.value=p.map,e(p.map,l.uvTransform)),p.alphaMap&&(l.alphaMap.value=p.alphaMap,e(p.alphaMap,l.alphaMapTransform)),0<p.alphaTest&&(l.alphaTest.value=p.alphaTest)):p.isSpriteMaterial?(l.diffuse.value.copy(p.color),l.opacity.value=p.opacity,l.rotation.value=p.rotation,p.map&&(l.map.value=p.map,e(p.map,l.mapTransform)),p.alphaMap&&(l.alphaMap.value=p.alphaMap,e(p.alphaMap,l.alphaMapTransform)),0<p.alphaTest&&(l.alphaTest.value=p.alphaTest)):
p.isShadowMaterial?(l.color.value.copy(p.color),l.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}}}function qk(a,c,e,h){function l(I){var L=I.uniforms;let Y=0;for(let Z=0,aa=L.length;Z<aa;Z++){const T=Array.isArray(L[Z])?L[Z]:[L[Z]];for(let ha=0,Ca=T.length;ha<Ca;ha++){const xa=T[ha],Ha=Array.isArray(xa.value)?xa.value:[xa.value];for(let Fa=0,Ra=Ha.length;Fa<Ra;Fa++){const Ja=p(Ha[Fa]);var P=Y%16;const Ka=P%Ja.boundary;P+=Ka;Y+=Ka;0!==P&&16-P<Ja.storage&&(Y+=16-P);xa.__data=
new Float32Array(Ja.storage/Float32Array.BYTES_PER_ELEMENT);xa.__offset=Y;Y+=Ja.storage}}}L=Y%16;0<L&&(Y+=16-L);I.__size=Y;I.__cache={};return this}function p(I){const L={boundary:0,storage:0};"number"===typeof I||"boolean"===typeof I?(L.boundary=4,L.storage=4):I.isVector2?(L.boundary=8,L.storage=8):I.isVector3||I.isColor?(L.boundary=16,L.storage=12):I.isVector4?(L.boundary=16,L.storage=16):I.isMatrix3?(L.boundary=48,L.storage=48):I.isMatrix4?(L.boundary=64,L.storage=64):I.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):
console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",I);return L}function w(I){I=I.target;I.removeEventListener("dispose",w);const L=D.indexOf(I.__bindingPointIndex);D.splice(L,1);a.deleteBuffer(x[I.id]);delete x[I.id];delete y[I.id]}let x={},y={},D=[];const H=a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS);return{bind:function(I,L){h.uniformBlockBinding(I,L.program)},update:function(I,L){var Y=x[I.id];if(void 0===Y){l(I);a:{for(Y=0;Y<H;Y++)if(-1===D.indexOf(Y)){D.push(Y);break a}console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.");
Y=0}I.__bindingPointIndex=Y;var P=a.createBuffer(),Z=I.__size,aa=I.usage;a.bindBuffer(a.UNIFORM_BUFFER,P);a.bufferData(a.UNIFORM_BUFFER,Z,aa);a.bindBuffer(a.UNIFORM_BUFFER,null);a.bindBufferBase(a.UNIFORM_BUFFER,Y,P);Y=P;x[I.id]=Y;I.addEventListener("dispose",w)}h.updateUBOMapping(I,L.program);L=c.render.frame;if(y[I.id]!==L){Y=I.uniforms;P=I.__cache;a.bindBuffer(a.UNIFORM_BUFFER,x[I.id]);for(let xa=0,Ha=Y.length;xa<Ha;xa++){Z=Array.isArray(Y[xa])?Y[xa]:[Y[xa]];for(let Fa=0,Ra=Z.length;Fa<Ra;Fa++){aa=
Z[Fa];a:{var T=aa.value;var ha=xa+"_"+Fa;if(void 0===P[ha])P[ha]="number"===typeof T||"boolean"===typeof T?T:T.clone(),T=!0;else{var Ca=P[ha];if("number"===typeof T||"boolean"===typeof T){if(Ca!==T){P[ha]=T;T=!0;break a}}else if(!1===Ca.equals(T)){Ca.copy(T);T=!0;break a}T=!1}}if(!0===T){T=aa.__offset;ha=Array.isArray(aa.value)?aa.value:[aa.value];Ca=0;for(let Ja=0;Ja<ha.length;Ja++){const Ka=ha[Ja],lb=p(Ka);"number"===typeof Ka||"boolean"===typeof Ka?(aa.__data[0]=Ka,a.bufferSubData(a.UNIFORM_BUFFER,
T+Ca,aa.__data)):Ka.isMatrix3?(aa.__data[0]=Ka.elements[0],aa.__data[1]=Ka.elements[1],aa.__data[2]=Ka.elements[2],aa.__data[3]=0,aa.__data[4]=Ka.elements[3],aa.__data[5]=Ka.elements[4],aa.__data[6]=Ka.elements[5],aa.__data[7]=0,aa.__data[8]=Ka.elements[6],aa.__data[9]=Ka.elements[7],aa.__data[10]=Ka.elements[8],aa.__data[11]=0):(Ka.toArray(aa.__data,Ca),Ca+=lb.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,T,aa.__data)}}}a.bindBuffer(a.UNIFORM_BUFFER,null);y[I.id]=L}},dispose:function(){for(const I in x)a.deleteBuffer(x[I]);
D=[];x={};y={}}}}function sh(a,c,e,h,l,p){Fe.subVectors(a,e).addScalar(.5).multiply(h);void 0!==l?(Se.x=p*Fe.x-l*Fe.y,Se.y=l*Fe.x+p*Fe.y):Se.copy(Fe);a.copy(c);a.x+=Se.x;a.y+=Se.y;a.applyMatrix4(rg)}function vd(a,c){return a.z-c.z}function Fg(a,c){return c.z-a.z}function xk(a,c,e=0){const h=c.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==c.array.constructor){const l=a.count;for(let p=0;p<l;p++)for(let w=0;w<h;w++)c.setComponent(p+e,w,a.getComponent(p,w))}else c.array.set(a.array,
e*h);c.needsUpdate=!0}function Vf(a,c,e,h,l,p){const w=a.geometry.attributes.position;yi.fromBufferAttribute(w,l);me.fromBufferAttribute(w,p);if(!(e.distanceSqToSegment(yi,me,Cm,bn)>h||(Cm.applyMatrix4(a.matrixWorld),e=c.ray.origin.distanceTo(Cm),e<c.near||e>c.far)))return{distance:e,point:bn.clone().applyMatrix4(a.matrixWorld),index:l,face:null,faceIndex:null,barycoord:null,object:a}}function pg(a,c,e,h,l,p,w){const x=Dl.distanceSqToPoint(a);x<e&&(e=new Da,Dl.closestPointToPoint(a,e),e.applyMatrix4(h),
a=l.ray.origin.distanceTo(e),a<l.near||a>l.far||p.push({distance:a,distanceToRay:Math.sqrt(x),point:e,index:c,face:null,faceIndex:null,barycoord:null,object:w}))}function zi(){let a=0,c=0,e=0,h=0;return{initCatmullRom:function(l,p,w,x,y){l=y*(w-l);x=y*(x-p);a=p;c=l;e=-3*p+3*w-2*l-x;h=2*p-2*w+l+x},initNonuniformCatmullRom:function(l,p,w,x,y,D,H){l=((p-l)/y-(w-l)/(y+D)+(w-p)/D)*D;x=((w-p)/D-(x-p)/(D+H)+(x-w)/H)*D;a=p;c=l;e=-3*p+3*w-2*l-x;h=2*p-2*w+l+x},calc:function(l){const p=l*l;return a+c*l+e*p+
h*p*l}}}function qf(a,c,e,h,l){c=.5*(h-c);l=.5*(l-e);const p=a*a;return(2*e-2*h+c+l)*a*p+(-3*e+3*h-2*c-l)*p+c*a+e}function Ai(a,c,e,h){const l=1-a;return l*l*c+2*(1-a)*a*e+a*a*h}function Gg(a,c,e,h,l){const p=1-a,w=1-a;return p*p*p*c+3*w*w*a*e+3*(1-a)*a*a*h+a*a*a*l}function Ff(a,c,e,h,l){let p,w=0;for(let x=c,y=e-h;x<e;x+=h)w+=(a[y]-a[x])*(a[x+1]+a[y+1]),y=x;if(l===0<w)for(l=c;l<e;l+=h)p=ci(l,a[l],a[l+1],p);else for(l=e-h;l>=c;l-=h)p=ci(l,a[l],a[l+1],p);p&&Zd(p,p.next)&&(di(p),p=p.next);return p}
function qg(a,c){if(!a)return a;c||(c=a);let e;do if(e=!1,a.steiner||!Zd(a,a.next)&&0!==$c(a.prev,a,a.next))a=a.next;else{di(a);a=c=a.prev;if(a===a.next)break;e=!0}while(e||a!==c);return c}function kg(a,c,e,h,l,p,w){if(a){if(!w&&p){var x=a,y=x;do 0===y.z&&(y.z=Ee(y.x,y.y,h,l,p)),y.prevZ=y.prev,y=y.nextZ=y.next;while(y!==x);y.prevZ.nextZ=null;y.prevZ=null;x=y;var D,H,I,L,Y=1;do{y=x;var P=x=null;for(H=0;y;){H++;var Z=y;for(D=I=0;D<Y&&(I++,Z=Z.nextZ,Z);D++);for(L=Y;0<I||0<L&&Z;)0!==I&&(0===L||!Z||y.z<=
Z.z)?(D=y,y=y.nextZ,I--):(D=Z,Z=Z.nextZ,L--),P?P.nextZ=D:x=D,D.prevZ=P,P=D;y=Z}P.nextZ=null;Y*=2}while(1<H)}for(x=a;a.prev!==a.next;){y=a.prev;Z=a.next;if(p)P=Td(a,h,l,p);else a:{P=a.prev;var aa=a;L=a.next;if(0<=$c(P,aa,L)){P=!1;break a}H=P.x;I=aa.x;Y=L.x;D=P.y;aa=aa.y;const T=L.y,ha=H<I?H<Y?H:Y:I<Y?I:Y,Ca=D<aa?D<T?D:T:aa<T?aa:T,xa=H>I?H>Y?H:Y:I>Y?I:Y,Ha=D>aa?D>T?D:T:aa>T?aa:T;for(L=L.next;L!==P;){if(L.x>=ha&&L.x<=xa&&L.y>=Ca&&L.y<=Ha&&zf(H,D,I,aa,Y,T,L.x,L.y)&&0<=$c(L.prev,L,L.next)){P=!1;break a}L=
L.next}P=!0}if(P)c.push(y.i/e|0),c.push(a.i/e|0),c.push(Z.i/e|0),di(a),x=a=Z.next;else if(a=Z,a===x){if(!w)kg(qg(a),c,e,h,l,p,1);else if(1===w){a=qg(a);w=c;x=e;y=a;do Z=y.prev,P=y.next.next,!Zd(Z,P)&&Wf(Z,y,y.next,P)&&bi(Z,P)&&bi(P,Z)&&(w.push(Z.i/x|0),w.push(y.i/x|0),w.push(P.i/x|0),di(y),di(y.next),y=a=P),y=y.next;while(y!==a);a=qg(y);kg(a,c,e,h,l,p,2)}else if(2===w)a:{w=a;do{for(x=w.next.next;x!==w.prev;){if(y=w.i!==x.i){y=w;Z=x;if(P=y.next.i!==Z.i&&y.prev.i!==Z.i){b:{P=y;do{if(P.i!==y.i&&P.next.i!==
y.i&&P.i!==Z.i&&P.next.i!==Z.i&&Wf(P,P.next,y,Z)){P=!0;break b}P=P.next}while(P!==y);P=!1}P=!P}if(P){if(P=bi(y,Z)&&bi(Z,y)){P=y;H=!1;I=(y.x+Z.x)/2;Y=(y.y+Z.y)/2;do P.y>Y!==P.next.y>Y&&P.next.y!==P.y&&I<(P.next.x-P.x)*(Y-P.y)/(P.next.y-P.y)+P.x&&(H=!H),P=P.next;while(P!==y);P=H}P=P&&($c(y.prev,y,Z.prev)||$c(y,Z.prev,Z))||Zd(y,Z)&&0<$c(y.prev,y,y.next)&&0<$c(Z.prev,Z,Z.next)}y=P}if(y){a=Xj(w,x);w=qg(w,w.next);a=qg(a,a.next);kg(w,c,e,h,l,p,0);kg(a,c,e,h,l,p,0);break a}x=x.next}w=w.next}while(w!==a)}break}}}}
function Td(a,c,e,h){const l=a.prev,p=a.next;if(0<=$c(l,a,p))return!1;const w=l.x,x=a.x,y=p.x,D=l.y,H=a.y,I=p.y,L=w<x?w<y?w:y:x<y?x:y,Y=D<H?D<I?D:I:H<I?H:I,P=w>x?w>y?w:y:x>y?x:y,Z=D>H?D>I?D:I:H>I?H:I,aa=Ee(L,Y,c,e,h);c=Ee(P,Z,c,e,h);e=a.prevZ;for(a=a.nextZ;e&&e.z>=aa&&a&&a.z<=c;){if(e.x>=L&&e.x<=P&&e.y>=Y&&e.y<=Z&&e!==l&&e!==p&&zf(w,D,x,H,y,I,e.x,e.y)&&0<=$c(e.prev,e,e.next))return!1;e=e.prevZ;if(a.x>=L&&a.x<=P&&a.y>=Y&&a.y<=Z&&a!==l&&a!==p&&zf(w,D,x,H,y,I,a.x,a.y)&&0<=$c(a.prev,a,a.next))return!1;
a=a.nextZ}for(;e&&e.z>=aa;){if(e.x>=L&&e.x<=P&&e.y>=Y&&e.y<=Z&&e!==l&&e!==p&&zf(w,D,x,H,y,I,e.x,e.y)&&0<=$c(e.prev,e,e.next))return!1;e=e.prevZ}for(;a&&a.z<=c;){if(a.x>=L&&a.x<=P&&a.y>=Y&&a.y<=Z&&a!==l&&a!==p&&zf(w,D,x,H,y,I,a.x,a.y)&&0<=$c(a.prev,a,a.next))return!1;a=a.nextZ}return!0}function Mf(a,c){return a.x-c.x}function Ee(a,c,e,h,l){a=(a-e)*l|0;c=(c-h)*l|0;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<
1)&1431655765|((c|c<<1)&1431655765)<<1}function zf(a,c,e,h,l,p,w,x){return(l-w)*(c-x)>=(a-w)*(p-x)&&(a-w)*(h-x)>=(e-w)*(c-x)&&(e-w)*(p-x)>=(l-w)*(h-x)}function $c(a,c,e){return(c.y-a.y)*(e.x-c.x)-(c.x-a.x)*(e.y-c.y)}function Zd(a,c){return a.x===c.x&&a.y===c.y}function Wf(a,c,e,h){const l=jf($c(a,c,e)),p=jf($c(a,c,h)),w=jf($c(e,h,a)),x=jf($c(e,h,c));return l!==p&&w!==x||0===l&&Vd(a,e,c)||0===p&&Vd(a,h,c)||0===w&&Vd(e,a,h)||0===x&&Vd(e,c,h)?!0:!1}function Vd(a,c,e){return c.x<=Math.max(a.x,e.x)&&c.x>=
Math.min(a.x,e.x)&&c.y<=Math.max(a.y,e.y)&&c.y>=Math.min(a.y,e.y)}function jf(a){return 0<a?1:0>a?-1:0}function bi(a,c){return 0>$c(a.prev,a,a.next)?0<=$c(a,c,a.next)&&0<=$c(a,a.prev,c):0>$c(a,c,a.prev)||0>$c(a,a.next,c)}function Xj(a,c){const e=new vj(a.i,a.x,a.y),h=new vj(c.i,c.x,c.y),l=a.next,p=c.prev;a.next=c;c.prev=a;e.next=l;l.prev=e;h.next=e;e.prev=h;p.next=h;h.prev=p;return h}function ci(a,c,e,h){a=new vj(a,c,e);h?(a.next=h.next,a.prev=h,h.next.prev=a,h.next=a):(a.prev=a,a.next=a);return a}
function di(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function vj(a,c,e){this.i=a;this.x=c;this.y=e;this.next=this.prev=null;this.z=0;this.nextZ=this.prevZ=null;this.steiner=!1}function Od(a){const c=a.length;2<c&&a[c-1].equals(a[0])&&a.pop()}function Nf(a,c){for(let e=0;e<c.length;e++)a.push(c[e].x),a.push(c[e].y)}function Ue(a,c,e){const h=`${a.x},${a.y},${a.z}-${c.x},${c.y},${c.z}`;a=`${c.x},${c.y},${c.z}-${a.x},${a.y},${a.z}`;if(!0===
e.has(h)||!0===e.has(a))return!1;e.add(h);e.add(a);return!0}function th(a,c,e){return!a||!e&&a.constructor===c?a:"number"===typeof c.BYTES_PER_ELEMENT?new c(a):Array.prototype.slice.call(a)}function Di(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function cj(a){const c=a.length,e=Array(c);for(let h=0;h!==c;++h)e[h]=h;e.sort(function(h,l){return a[h]-a[l]});return e}function Af(a,c,e){const h=a.length,l=new a.constructor(h);for(let p=0,w=0;w!==h;++p){const x=e[p]*c;for(let y=0;y!==c;++y)l[w++]=
a[x+y]}return l}function Ei(a,c,e,h){let l=1,p=a[0];for(;void 0!==p&&void 0===p[h];)p=a[l++];if(void 0!==p){var w=p[h];if(void 0!==w)if(Array.isArray(w)){do w=p[h],void 0!==w&&(c.push(p.time),e.push.apply(e,w)),p=a[l++];while(void 0!==p)}else if(void 0!==w.toArray){do w=p[h],void 0!==w&&(c.push(p.time),w.toArray(e,e.length)),p=a[l++];while(void 0!==p)}else{do w=p[h],void 0!==w&&(c.push(p.time),e.push(w)),p=a[l++];while(void 0!==p)}}}function Gf(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return ki;
case "vector":case "vector2":case "vector3":case "vector4":return xj;case "color":return vh;case "quaternion":return nl;case "bool":case "boolean":return he;case "string":return ej}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Xf(a,c){return a.distance-c.distance}function wj(a,c,e,h){let l=!0;a.layers.test(c.layers)&&!1===a.raycast(c,e)&&(l=!1);if(!0===l&&!0===h){a=a.children;for(let p=0,w=a.length;p<w;p++)wj(a[p],c,e,!0)}}function Yf(a){const c=[];!0===a.isBone&&c.push(a);
for(let e=0;e<a.children.length;e++)c.push.apply(c,Yf(a.children[e]));return c}function Ge(a,c,e,h,l,p,w){dj.set(l,p,w).unproject(h);a=c[a];if(void 0!==a){e=e.getAttribute("position");for(let x=0,y=a.length;x<y;x++)e.setXYZ(a[x],dj.x,dj.y,dj.z)}}class Bf{addEventListener(a,c){void 0===this._listeners&&(this._listeners={});const e=this._listeners;void 0===e[a]&&(e[a]=[]);-1===e[a].indexOf(c)&&e[a].push(c)}hasEventListener(a,c){if(void 0===this._listeners)return!1;const e=this._listeners;return void 0!==
e[a]&&-1!==e[a].indexOf(c)}removeEventListener(a,c){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(c=a.indexOf(c),-1!==c&&a.splice(c,1)))}dispatchEvent(a){if(void 0!==this._listeners){var c=this._listeners[a.type];if(void 0!==c){a.target=this;c=c.slice(0);for(let e=0,h=c.length;e<h;e++)c[e].call(this,a);a.target=null}}}}const Ne="00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f 40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f 50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f 60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f 80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f 90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff".split(" ");
let Ig=1234567;const Jg=Math.PI/180,bh=180/Math.PI,jl={DEG2RAD:Jg,RAD2DEG:bh,generateUUID:Na,clamp:qc,euclideanModulo:hb,mapLinear:function(a,c,e,h,l){return h+(a-c)*(l-h)/(e-c)},inverseLerp:function(a,c,e){return a!==c?(e-a)/(c-a):0},lerp:M,damp:function(a,c,e,h){return M(a,c,1-Math.exp(-e*h))},pingpong:function(a,c=1){return c-Math.abs(hb(a,2*c)-c)},smoothstep:function(a,c,e){if(a<=c)return 0;if(a>=e)return 1;a=(a-c)/(e-c);return a*a*(3-2*a)},smootherstep:function(a,c,e){if(a<=c)return 0;if(a>=
e)return 1;a=(a-c)/(e-c);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,c){return a+Math.floor(Math.random()*(c-a+1))},randFloat:function(a,c){return a+Math.random()*(c-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){void 0!==a&&(Ig=a);a=Ig+=1831565813;a=Math.imul(a^a>>>15,a|1);a^=a+Math.imul(a^a>>>7,a|61);return((a^a>>>14)>>>0)/4294967296},degToRad:function(a){return a*Jg},radToDeg:function(a){return a*bh},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},
ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},setQuaternionFromProperEuler:function(a,c,e,h,l){var p=Math.cos;const w=Math.sin,x=p(e/2);e=w(e/2);const y=p((c+h)/2),D=w((c+h)/2),H=p((c-h)/2),I=w((c-h)/2);p=p((h-c)/2);c=w((h-c)/2);switch(l){case "XYX":a.set(x*D,e*H,e*I,x*y);break;case "YZY":a.set(e*I,x*D,e*H,x*y);break;case "ZXZ":a.set(e*H,e*I,x*D,x*y);break;case "XZX":a.set(x*D,e*c,e*p,
x*y);break;case "YXY":a.set(e*p,x*D,e*c,x*y);break;case "ZYZ":a.set(e*c,e*p,x*D,x*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+l)}},normalize:ta,denormalize:v};class Lb{constructor(a=0,c=0){Lb.prototype.isVector2=!0;this.x=a;this.y=c}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,c){this.x=a;this.y=c;return this}setScalar(a){this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=
a;return this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y)}copy(a){this.x=a.x;this.y=a.y;return this}add(a){this.x+=a.x;this.y+=a.y;return this}addScalar(a){this.x+=a;this.y+=a;return this}addVectors(a,c){this.x=a.x+c.x;this.y=a.y+c.y;return this}addScaledVector(a,
c){this.x+=a.x*c;this.y+=a.y*c;return this}sub(a){this.x-=a.x;this.y-=a.y;return this}subScalar(a){this.x-=a;this.y-=a;return this}subVectors(a,c){this.x=a.x-c.x;this.y=a.y-c.y;return this}multiply(a){this.x*=a.x;this.y*=a.y;return this}multiplyScalar(a){this.x*=a;this.y*=a;return this}divide(a){this.x/=a.x;this.y/=a.y;return this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const c=this.x,e=this.y;a=a.elements;this.x=a[0]*c+a[3]*e+a[6];this.y=a[1]*c+a[4]*e+a[7];return this}min(a){this.x=
Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this}clamp(a,c){this.x=Math.max(a.x,Math.min(c.x,this.x));this.y=Math.max(a.y,Math.min(c.y,this.y));return this}clampScalar(a,c){this.x=Math.max(a,Math.min(c,this.x));this.y=Math.max(a,Math.min(c,this.y));return this}clampLength(a,c){const e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(a,Math.min(c,e)))}floor(){this.x=Math.floor(this.x);this.y=
Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+
Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;a=this.dot(a)/c;return Math.acos(qc(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x;a=this.y-a.y;return c*c+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,
c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;return this}lerpVectors(a,c,e){this.x=a.x+(c.x-a.x)*e;this.y=a.y+(c.y-a.y)*e;return this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,c=0){this.x=a[c];this.y=a[c+1];return this}toArray(a=[],c=0){a[c]=this.x;a[c+1]=this.y;return a}fromBufferAttribute(a,c){this.x=a.getX(c);this.y=a.getY(c);return this}rotateAround(a,c){const e=Math.cos(c);c=Math.sin(c);const h=this.x-a.x,l=this.y-a.y;this.x=h*e-l*c+a.x;this.y=h*c+l*e+a.y;return this}random(){this.x=
Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y}}class nd{constructor(a,c,e,h,l,p,w,x,y){nd.prototype.isMatrix3=!0;this.elements=[1,0,0,0,1,0,0,0,1];void 0!==a&&this.set(a,c,e,h,l,p,w,x,y)}set(a,c,e,h,l,p,w,x,y){const D=this.elements;D[0]=a;D[1]=h;D[2]=w;D[3]=c;D[4]=l;D[5]=x;D[6]=e;D[7]=p;D[8]=y;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(a){const c=this.elements;a=a.elements;c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=
a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return this}extractBasis(a,c,e){a.setFromMatrix3Column(this,0);c.setFromMatrix3Column(this,1);e.setFromMatrix3Column(this,2);return this}setFromMatrix4(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){var e=a.elements,h=c.elements;c=this.elements;a=e[0];const l=e[3],p=e[6],w=e[1],x=e[4],y=e[7],D=e[2],H=e[5];
e=e[8];const I=h[0],L=h[3],Y=h[6],P=h[1],Z=h[4],aa=h[7],T=h[2],ha=h[5];h=h[8];c[0]=a*I+l*P+p*T;c[3]=a*L+l*Z+p*ha;c[6]=a*Y+l*aa+p*h;c[1]=w*I+x*P+y*T;c[4]=w*L+x*Z+y*ha;c[7]=w*Y+x*aa+y*h;c[2]=D*I+H*P+e*T;c[5]=D*L+H*Z+e*ha;c[8]=D*Y+H*aa+e*h;return this}multiplyScalar(a){const c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=a;c[4]*=a;c[7]*=a;c[2]*=a;c[5]*=a;c[8]*=a;return this}determinant(){var a=this.elements;const c=a[0],e=a[1],h=a[2],l=a[3],p=a[4],w=a[5],x=a[6],y=a[7];a=a[8];return c*p*a-c*w*y-e*l*a+
e*w*x+h*l*y-h*p*x}invert(){const a=this.elements,c=a[0],e=a[1],h=a[2],l=a[3],p=a[4],w=a[5],x=a[6],y=a[7],D=a[8],H=D*p-w*y,I=w*x-D*l,L=y*l-p*x;var Y=c*H+e*I+h*L;if(0===Y)return this.set(0,0,0,0,0,0,0,0,0);Y=1/Y;a[0]=H*Y;a[1]=(h*y-D*e)*Y;a[2]=(w*e-h*p)*Y;a[3]=I*Y;a[4]=(D*c-h*x)*Y;a[5]=(h*l-w*c)*Y;a[6]=L*Y;a[7]=(e*x-y*c)*Y;a[8]=(p*c-e*l)*Y;return this}transpose(){let a;const c=this.elements;a=c[1];c[1]=c[3];c[3]=a;a=c[2];c[2]=c[6];c[6]=a;a=c[5];c[5]=c[7];c[7]=a;return this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const c=
this.elements;a[0]=c[0];a[1]=c[3];a[2]=c[6];a[3]=c[1];a[4]=c[4];a[5]=c[7];a[6]=c[2];a[7]=c[5];a[8]=c[8];return this}setUvTransform(a,c,e,h,l,p,w){const x=Math.cos(l);l=Math.sin(l);this.set(e*x,e*l,-e*(x*p+l*w)+p+a,-h*l,h*x,-h*(-l*p+x*w)+w+c,0,0,1);return this}scale(a,c){this.premultiply(ue.makeScale(a,c));return this}rotate(a){this.premultiply(ue.makeRotation(-a));return this}translate(a,c){this.premultiply(ue.makeTranslation(a,c));return this}makeTranslation(a,c){a.isVector2?this.set(1,0,a.x,0,1,
a.y,0,0,1):this.set(1,0,a,0,1,c,0,0,1);return this}makeRotation(a){const c=Math.cos(a);a=Math.sin(a);this.set(c,-a,0,a,c,0,0,0,1);return this}makeScale(a,c){this.set(a,0,0,0,c,0,0,0,1);return this}equals(a){const c=this.elements;a=a.elements;for(let e=0;9>e;e++)if(c[e]!==a[e])return!1;return!0}fromArray(a,c=0){for(let e=0;9>e;e++)this.elements[e]=a[e+c];return this}toArray(a=[],c=0){const e=this.elements;a[c]=e[0];a[c+1]=e[1];a[c+2]=e[2];a[c+3]=e[3];a[c+4]=e[4];a[c+5]=e[5];a[c+6]=e[6];a[c+7]=e[7];
a[c+8]=e[8];return a}clone(){return(new this.constructor).fromArray(this.elements)}}const ue=new nd,Xe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},hc={},kf=(new nd).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Ed=(new nd).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),sg={["srgb-linear"]:{transfer:"linear",primaries:"rec709",luminanceCoefficients:[.2126,.7152,.0722],toReference:a=>
a,fromReference:a=>a},srgb:{transfer:"srgb",primaries:"rec709",luminanceCoefficients:[.2126,.7152,.0722],toReference:a=>a.convertSRGBToLinear(),fromReference:a=>a.convertLinearToSRGB()},["display-p3-linear"]:{transfer:"linear",primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:a=>a.applyMatrix3(Ed),fromReference:a=>a.applyMatrix3(kf)},["display-p3"]:{transfer:"srgb",primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:a=>a.convertSRGBToLinear().applyMatrix3(Ed),fromReference:a=>
a.applyMatrix3(kf).convertLinearToSRGB()}},He=new Set(["srgb-linear","display-p3-linear"]),Eb={enabled:!0,_workingColorSpace:"srgb-linear",get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(a){if(!He.has(a))throw Error(`Unsupported working color space, "${a}".`);this._workingColorSpace=a},convert:function(a,c,e){if(!1===this.enabled||c===e||!c||!e)return a;c=sg[c].toReference;e=sg[e].fromReference;return e(c(a))},fromWorkingColorSpace:function(a,c){return this.convert(a,
this._workingColorSpace,c)},toWorkingColorSpace:function(a,c){return this.convert(a,c,this._workingColorSpace)},getPrimaries:function(a){return sg[a].primaries},getTransfer:function(a){return""===a?"linear":sg[a].transfer},getLuminanceCoefficients:function(a,c=this._workingColorSpace){return a.fromArray(sg[c].luminanceCoefficients)}};let Cb;class kd{static getDataURL(a){if(/^data:/i.test(a.src)||"undefined"===typeof HTMLCanvasElement)return a.src;if(a instanceof HTMLCanvasElement)var c=a;else void 0===
Cb&&(Cb=Ab("canvas")),Cb.width=a.width,Cb.height=a.height,c=Cb.getContext("2d"),a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height),c=Cb;return 2048<c.width||2048<c.height?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",a),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(a){if("undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||
"undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap){var c=Ab("canvas");c.width=a.width;c.height=a.height;var e=c.getContext("2d");e.drawImage(a,0,0,a.width,a.height);a=e.getImageData(0,0,a.width,a.height);const h=a.data;for(let l=0;l<h.length;l++)h[l]=255*bb(h[l]/255);e.putImageData(a,0,0);return c}if(a.data){c=a.data.slice(0);for(e=0;e<c.length;e++)c[e]=c instanceof Uint8Array||c instanceof Uint8ClampedArray?Math.floor(255*bb(c[e]/255)):bb(c[e]);return{data:c,width:a.width,height:a.height}}console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.");
return a}}let $f=0;class sf{constructor(a=null){this.isSource=!0;Object.defineProperty(this,"id",{value:$f++});this.uuid=Na();this.data=a;this.dataReady=!0;this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){const c=void 0===a||"string"===typeof a;if(!c&&void 0!==a.images[this.uuid])return a.images[this.uuid];const e={uuid:this.uuid,url:""},h=this.data;if(null!==h){let l;if(Array.isArray(h)){l=[];for(let p=0,w=h.length;p<w;p++)h[p].isDataTexture?l.push(vb(h[p].image)):l.push(vb(h[p]))}else l=
vb(h);e.url=l}c||(a.images[this.uuid]=e);return e}}let ld=0;class Ld extends Bf{constructor(a=Ld.DEFAULT_IMAGE,c=Ld.DEFAULT_MAPPING,e=1001,h=1001,l=1006,p=1008,w=1023,x=1009,y=Ld.DEFAULT_ANISOTROPY,D=""){super();this.isTexture=!0;Object.defineProperty(this,"id",{value:ld++});this.uuid=Na();this.name="";this.source=new sf(a);this.mipmaps=[];this.mapping=c;this.channel=0;this.wrapS=e;this.wrapT=h;this.magFilter=l;this.minFilter=p;this.anisotropy=y;this.format=w;this.internalFormat=null;this.type=x;
this.offset=new Lb(0,0);this.repeat=new Lb(1,1);this.center=new Lb(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new nd;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.colorSpace=D;this.userData={};this.version=0;this.onUpdate=null;this.isRenderTargetTexture=!1;this.pmremVersion=0}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,
this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.source=a.source;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.channel=a.channel;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.internalFormat=a.internalFormat;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=
a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.colorSpace=a.colorSpace;this.userData=JSON.parse(JSON.stringify(a.userData));this.needsUpdate=!0;return this}toJSON(a){const c=void 0===a||"string"===typeof a;if(!c&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];const e={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},
uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,
unpackAlignment:this.unpackAlignment};0<Object.keys(this.userData).length&&(e.userData=this.userData);c||(a.textures[this.uuid]=e);return e}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(300!==this.mapping)return a;a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);
break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y);return a}set needsUpdate(a){!0===a&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){!0===a&&this.pmremVersion++}}Ld.DEFAULT_IMAGE=null;Ld.DEFAULT_MAPPING=300;Ld.DEFAULT_ANISOTROPY=1;class yd{constructor(a=0,c=0,e=0,h=1){yd.prototype.isVector4=!0;this.x=a;this.y=c;this.z=e;this.w=h}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=
a}set(a,c,e,h){this.x=a;this.y=c;this.z=e;this.w=h;return this}setScalar(a){this.w=this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setW(a){this.w=a;return this}setComponent(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;
case 3:return this.w;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this}addVectors(a,c){this.x=a.x+c.x;this.y=a.y+c.y;this.z=a.z+c.z;this.w=a.w+c.w;return this}addScaledVector(a,c){this.x+=a.x*c;this.y+=a.y*c;this.z+=a.z*c;this.w+=
a.w*c;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this}subScalar(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this}subVectors(a,c){this.x=a.x-c.x;this.y=a.y-c.y;this.z=a.z-c.z;this.w=a.w-c.w;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this}multiplyScalar(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this}applyMatrix4(a){const c=this.x,e=this.y,h=this.z,l=this.w;a=a.elements;this.x=a[0]*c+a[4]*e+a[8]*h+a[12]*l;this.y=a[1]*c+
a[5]*e+a[9]*h+a[13]*l;this.z=a[2]*c+a[6]*e+a[10]*h+a[14]*l;this.w=a[3]*c+a[7]*e+a[11]*h+a[15]*l;return this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const c=Math.sqrt(1-a.w*a.w);1E-4>c?(this.x=1,this.z=this.y=0):(this.x=a.x/c,this.y=a.y/c,this.z=a.z/c);return this}setAxisAngleFromRotationMatrix(a){a=a.elements;var c=a[0];var e=a[4];var h=a[8];const l=a[1];var p=a[5],w=a[9];var x=a[2];var y=a[6];var D=a[10];if(.01>Math.abs(e-l)&&.01>Math.abs(h-
x)&&.01>Math.abs(w-y)){if(.1>Math.abs(e+l)&&.1>Math.abs(h+x)&&.1>Math.abs(w+y)&&.1>Math.abs(c+p+D-3))return this.set(1,0,0,0),this;a=Math.PI;c=(c+1)/2;p=(p+1)/2;D=(D+1)/2;e=(e+l)/4;h=(h+x)/4;w=(w+y)/4;c>p&&c>D?.01>c?(y=0,e=x=.707106781):(y=Math.sqrt(c),x=e/y,e=h/y):p>D?.01>p?(y=.707106781,x=0,e=.707106781):(x=Math.sqrt(p),y=e/x,e=w/x):.01>D?(x=y=.707106781,e=0):(e=Math.sqrt(D),y=h/e,x=w/e);this.set(y,x,e,a);return this}a=Math.sqrt((y-w)*(y-w)+(h-x)*(h-x)+(l-e)*(l-e));.001>Math.abs(a)&&(a=1);this.x=
(y-w)/a;this.y=(h-x)/a;this.z=(l-e)/a;this.w=Math.acos((c+p+D-1)/2);return this}setFromMatrixPosition(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];this.w=a[15];return this}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this}clamp(a,c){this.x=Math.max(a.x,Math.min(c.x,this.x));this.y=
Math.max(a.y,Math.min(c.y,this.y));this.z=Math.max(a.z,Math.min(c.z,this.z));this.w=Math.max(a.w,Math.min(c.w,this.w));return this}clampScalar(a,c){this.x=Math.max(a,Math.min(c,this.x));this.y=Math.max(a,Math.min(c,this.y));this.z=Math.max(a,Math.min(c,this.z));this.w=Math.max(a,Math.min(c,this.w));return this}clampLength(a,c){const e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(a,Math.min(c,e)))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);
this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this}dot(a){return this.x*
a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;this.z+=(a.z-this.z)*c;this.w+=(a.w-this.w)*c;return this}lerpVectors(a,
c,e){this.x=a.x+(c.x-a.x)*e;this.y=a.y+(c.y-a.y)*e;this.z=a.z+(c.z-a.z)*e;this.w=a.w+(c.w-a.w)*e;return this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,c=0){this.x=a[c];this.y=a[c+1];this.z=a[c+2];this.w=a[c+3];return this}toArray(a=[],c=0){a[c]=this.x;a[c+1]=this.y;a[c+2]=this.z;a[c+3]=this.w;return a}fromBufferAttribute(a,c){this.x=a.getX(c);this.y=a.getY(c);this.z=a.getZ(c);this.w=a.getW(c);return this}random(){this.x=Math.random();this.y=Math.random();
this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}class Md extends Bf{constructor(a=1,c=1,e={}){super();this.isRenderTarget=!0;this.width=a;this.height=c;this.depth=1;this.scissor=new yd(0,0,a,c);this.scissorTest=!1;this.viewport=new yd(0,0,a,c);a={width:a,height:c,depth:1};e=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:1006,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,
depthTexture:null,samples:0,count:1},e);a=new Ld(a,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace);a.flipY=!1;a.generateMipmaps=e.generateMipmaps;a.internalFormat=e.internalFormat;this.textures=[];c=e.count;for(let h=0;h<c;h++)this.textures[h]=a.clone(),this.textures[h].isRenderTargetTexture=!0;this.depthBuffer=e.depthBuffer;this.stencilBuffer=e.stencilBuffer;this.resolveDepthBuffer=e.resolveDepthBuffer;this.resolveStencilBuffer=e.resolveStencilBuffer;
this.depthTexture=e.depthTexture;this.samples=e.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}setSize(a,c,e=1){if(this.width!==a||this.height!==c||this.depth!==e){this.width=a;this.height=c;this.depth=e;for(let h=0,l=this.textures.length;h<l;h++)this.textures[h].image.width=a,this.textures[h].image.height=c,this.textures[h].image.depth=e;this.dispose()}this.viewport.set(0,0,a,c);this.scissor.set(0,0,a,c)}clone(){return(new this.constructor).copy(this)}copy(a){this.width=
a.width;this.height=a.height;this.depth=a.depth;this.scissor.copy(a.scissor);this.scissorTest=a.scissorTest;this.viewport.copy(a.viewport);this.textures.length=0;for(let e=0,h=a.textures.length;e<h;e++)this.textures[e]=a.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0;const c=Object.assign({},a.texture.image);this.texture.source=new sf(c);this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.resolveDepthBuffer=a.resolveDepthBuffer;this.resolveStencilBuffer=a.resolveStencilBuffer;
null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone());this.samples=a.samples;return this}dispose(){this.dispatchEvent({type:"dispose"})}}class dd extends Md{constructor(a=1,c=1,e={}){super(a,c,e);this.isWebGLRenderTarget=!0}}class ed extends Ld{constructor(a=null,c=1,e=1,h=1){super(null);this.isDataArrayTexture=!0;this.image={data:a,width:c,height:e,depth:h};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1;this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}
class Jd extends dd{constructor(a=1,c=1,e=1,h={}){super(a,c,h);this.isWebGLArrayRenderTarget=!0;this.depth=e;this.texture=new ed(null,a,c,e);this.texture.isRenderTargetTexture=!0}}class ee extends Ld{constructor(a=null,c=1,e=1,h=1){super(null);this.isData3DTexture=!0;this.image={data:a,width:c,height:e,depth:h};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}class Ie extends dd{constructor(a=1,c=1,e=1,h={}){super(a,c,h);this.isWebGL3DRenderTarget=
!0;this.depth=e;this.texture=new ee(null,a,c,e);this.texture.isRenderTargetTexture=!0}}class Ze{constructor(a=0,c=0,e=0,h=1){this.isQuaternion=!0;this._x=a;this._y=c;this._z=e;this._w=h}static slerpFlat(a,c,e,h,l,p,w){let x=e[h+0],y=e[h+1],D=e[h+2];e=e[h+3];h=l[p+0];const H=l[p+1],I=l[p+2];l=l[p+3];if(0===w)a[c+0]=x,a[c+1]=y,a[c+2]=D,a[c+3]=e;else if(1===w)a[c+0]=h,a[c+1]=H,a[c+2]=I,a[c+3]=l;else{if(e!==l||x!==h||y!==H||D!==I){p=1-w;var L=x*h+y*H+D*I+e*l,Y=0<=L?1:-1,P=1-L*L;P>Number.EPSILON&&(P=Math.sqrt(P),
L=Math.atan2(P,L*Y),p=Math.sin(p*L)/P,w=Math.sin(w*L)/P);Y*=w;x=x*p+h*Y;y=y*p+H*Y;D=D*p+I*Y;e=e*p+l*Y;p===1-w&&(w=1/Math.sqrt(x*x+y*y+D*D+e*e),x*=w,y*=w,D*=w,e*=w)}a[c]=x;a[c+1]=y;a[c+2]=D;a[c+3]=e}}static multiplyQuaternionsFlat(a,c,e,h,l,p){const w=e[h],x=e[h+1],y=e[h+2];e=e[h+3];h=l[p];const D=l[p+1],H=l[p+2];l=l[p+3];a[c]=w*l+e*h+x*H-y*D;a[c+1]=x*l+e*D+y*h-w*H;a[c+2]=y*l+e*H+w*D-x*h;a[c+3]=e*l-w*h-x*D-y*H;return a}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=
a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a;this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a;this._onChangeCallback()}set(a,c,e,h){this._x=a;this._y=c;this._z=e;this._w=h;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this._onChangeCallback();return this}setFromEuler(a,c=!0){var e=a._x,h=a._y,l=a._z;a=a._order;var p=Math.cos;const w=Math.sin,
x=p(e/2),y=p(h/2);p=p(l/2);e=w(e/2);h=w(h/2);l=w(l/2);switch(a){case "XYZ":this._x=e*y*p+x*h*l;this._y=x*h*p-e*y*l;this._z=x*y*l+e*h*p;this._w=x*y*p-e*h*l;break;case "YXZ":this._x=e*y*p+x*h*l;this._y=x*h*p-e*y*l;this._z=x*y*l-e*h*p;this._w=x*y*p+e*h*l;break;case "ZXY":this._x=e*y*p-x*h*l;this._y=x*h*p+e*y*l;this._z=x*y*l+e*h*p;this._w=x*y*p-e*h*l;break;case "ZYX":this._x=e*y*p-x*h*l;this._y=x*h*p+e*y*l;this._z=x*y*l-e*h*p;this._w=x*y*p+e*h*l;break;case "YZX":this._x=e*y*p+x*h*l;this._y=x*h*p+e*y*
l;this._z=x*y*l-e*h*p;this._w=x*y*p-e*h*l;break;case "XZY":this._x=e*y*p-x*h*l;this._y=x*h*p-e*y*l;this._z=x*y*l+e*h*p;this._w=x*y*p+e*h*l;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}!0===c&&this._onChangeCallback();return this}setFromAxisAngle(a,c){c/=2;const e=Math.sin(c);this._x=a.x*e;this._y=a.y*e;this._z=a.z*e;this._w=Math.cos(c);this._onChangeCallback();return this}setFromRotationMatrix(a){var c=a.elements,e=c[0];a=c[4];const h=c[8],l=c[1],
p=c[5],w=c[9],x=c[2],y=c[6];c=c[10];const D=e+p+c;0<D?(e=.5/Math.sqrt(D+1),this._w=.25/e,this._x=(y-w)*e,this._y=(h-x)*e,this._z=(l-a)*e):e>p&&e>c?(e=2*Math.sqrt(1+e-p-c),this._w=(y-w)/e,this._x=.25*e,this._y=(a+l)/e,this._z=(h+x)/e):p>c?(e=2*Math.sqrt(1+p-e-c),this._w=(h-x)/e,this._x=(a+l)/e,this._y=.25*e,this._z=(w+y)/e):(e=2*Math.sqrt(1+c-e-p),this._w=(l-a)/e,this._x=(h+x)/e,this._y=(w+y)/e,this._z=.25*e);this._onChangeCallback();return this}setFromUnitVectors(a,c){let e=a.dot(c)+1;e<Number.EPSILON?
(e=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=a.y*c.z-a.z*c.y,this._y=a.z*c.x-a.x*c.z,this._z=a.x*c.y-a.y*c.x);this._w=e;return this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(qc(this.dot(a),-1,1)))}rotateTowards(a,c){const e=this.angleTo(a);if(0===e)return this;this.slerp(a,Math.min(1,c/e));return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=-1;this._y*=-1;this._z*=-1;
this._onChangeCallback();return this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this._onChangeCallback();return this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,
this)}multiplyQuaternions(a,c){const e=a._x,h=a._y,l=a._z;a=a._w;const p=c._x,w=c._y,x=c._z;c=c._w;this._x=e*c+a*p+h*x-l*w;this._y=h*c+a*w+l*p-e*x;this._z=l*c+a*x+e*w-h*p;this._w=a*c-e*p-h*w-l*x;this._onChangeCallback();return this}slerp(a,c){if(0===c)return this;if(1===c)return this.copy(a);const e=this._x,h=this._y,l=this._z,p=this._w;var w=p*a._w+e*a._x+h*a._y+l*a._z;0>w?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,w=-w):this.copy(a);if(1<=w)return this._w=p,this._x=e,this._y=h,this._z=
l,this;a=1-w*w;if(a<=Number.EPSILON)return w=1-c,this._w=w*p+c*this._w,this._x=w*e+c*this._x,this._y=w*h+c*this._y,this._z=w*l+c*this._z,this.normalize(),this;a=Math.sqrt(a);const x=Math.atan2(a,w);w=Math.sin((1-c)*x)/a;c=Math.sin(c*x)/a;this._w=p*w+this._w*c;this._x=e*w+this._x*c;this._y=h*w+this._y*c;this._z=l*w+this._z*c;this._onChangeCallback();return this}slerpQuaternions(a,c,e){return this.copy(a).slerp(c,e)}random(){const a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();var e=Math.random();
const h=Math.sqrt(1-e);e=Math.sqrt(e);return this.set(h*Math.sin(a),h*Math.cos(a),e*Math.sin(c),e*Math.cos(c))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,c=0){this._x=a[c];this._y=a[c+1];this._z=a[c+2];this._w=a[c+3];this._onChangeCallback();return this}toArray(a=[],c=0){a[c]=this._x;a[c+1]=this._y;a[c+2]=this._z;a[c+3]=this._w;return a}fromBufferAttribute(a,c){this._x=a.getX(c);this._y=a.getY(c);this._z=a.getZ(c);this._w=a.getW(c);this._onChangeCallback();
return this}toJSON(){return this.toArray()}_onChange(a){this._onChangeCallback=a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}class Da{constructor(a=0,c=0,e=0){Da.prototype.isVector3=!0;this.x=a;this.y=c;this.z=e}set(a,c,e){void 0===e&&(e=this.z);this.x=a;this.y=c;this.z=e;return this}setScalar(a){this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setComponent(a,
c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;return this}addVectors(a,
c){this.x=a.x+c.x;this.y=a.y+c.y;this.z=a.z+c.z;return this}addScaledVector(a,c){this.x+=a.x*c;this.y+=a.y*c;this.z+=a.z*c;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this}subScalar(a){this.x-=a;this.y-=a;this.z-=a;return this}subVectors(a,c){this.x=a.x-c.x;this.y=a.y-c.y;this.z=a.z-c.z;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this}multiplyScalar(a){this.x*=a;this.y*=a;this.z*=a;return this}multiplyVectors(a,c){this.x=a.x*c.x;this.y=a.y*c.y;this.z=a.z*c.z;
return this}applyEuler(a){return this.applyQuaternion(tg.setFromEuler(a))}applyAxisAngle(a,c){return this.applyQuaternion(tg.setFromAxisAngle(a,c))}applyMatrix3(a){const c=this.x,e=this.y,h=this.z;a=a.elements;this.x=a[0]*c+a[3]*e+a[6]*h;this.y=a[1]*c+a[4]*e+a[7]*h;this.z=a[2]*c+a[5]*e+a[8]*h;return this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const c=this.x,e=this.y,h=this.z;a=a.elements;const l=1/(a[3]*c+a[7]*e+a[11]*h+a[15]);this.x=(a[0]*c+a[4]*e+a[8]*h+a[12])*
l;this.y=(a[1]*c+a[5]*e+a[9]*h+a[13])*l;this.z=(a[2]*c+a[6]*e+a[10]*h+a[14])*l;return this}applyQuaternion(a){const c=this.x,e=this.y,h=this.z,l=a.x,p=a.y,w=a.z;a=a.w;const x=2*(p*h-w*e),y=2*(w*c-l*h),D=2*(l*e-p*c);this.x=c+a*x+p*D-w*y;this.y=e+a*y+w*x-l*D;this.z=h+a*D+l*y-p*x;return this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const c=
this.x,e=this.y,h=this.z;a=a.elements;this.x=a[0]*c+a[4]*e+a[8]*h;this.y=a[1]*c+a[5]*e+a[9]*h;this.z=a[2]*c+a[6]*e+a[10]*h;return this.normalize()}divide(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this}clamp(a,c){this.x=Math.max(a.x,Math.min(c.x,
this.x));this.y=Math.max(a.y,Math.min(c.y,this.y));this.z=Math.max(a.z,Math.min(c.z,this.z));return this}clampScalar(a,c){this.x=Math.max(a,Math.min(c,this.x));this.y=Math.max(a,Math.min(c,this.y));this.z=Math.max(a,Math.min(c,this.z));return this}clampLength(a,c){const e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(a,Math.min(c,e)))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);
this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;this.z+=(a.z-this.z)*c;return this}lerpVectors(a,c,e){this.x=a.x+(c.x-a.x)*e;this.y=a.y+(c.y-a.y)*e;this.z=a.z+(c.z-a.z)*e;return this}cross(a){return this.crossVectors(this,a)}crossVectors(a,c){const e=a.x,h=a.y;a=a.z;const l=c.x,p=c.y;c=c.z;this.x=h*c-a*p;this.y=a*l-e*c;this.z=e*p-h*l;return this}projectOnVector(a){var c=
a.lengthSq();if(0===c)return this.set(0,0,0);c=a.dot(this)/c;return this.copy(a).multiplyScalar(c)}projectOnPlane(a){Fi.copy(this).projectOnVector(a);return this.sub(Fi)}reflect(a){return this.sub(Fi.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){const c=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===c)return Math.PI/2;a=this.dot(a)/c;return Math.acos(qc(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const c=this.x-a.x,e=this.y-a.y;a=this.z-a.z;return c*
c+e*e+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,c,e){const h=Math.sin(c)*a;this.x=h*Math.sin(e);this.y=Math.cos(c)*a;this.z=h*Math.cos(e);return this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,c,e){this.x=a*Math.sin(c);this.y=e;this.z=a*Math.cos(c);return this}setFromMatrixPosition(a){a=
a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this}setFromMatrixScale(a){const c=this.setFromMatrixColumn(a,0).length(),e=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=c;this.y=e;this.z=a;return this}setFromMatrixColumn(a,c){return this.fromArray(a.elements,4*c)}setFromMatrix3Column(a,c){return this.fromArray(a.elements,3*c)}setFromEuler(a){this.x=a._x;this.y=a._y;this.z=a._z;return this}setFromColor(a){this.x=a.r;this.y=a.g;this.z=a.b;return this}equals(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z}fromArray(a,c=0){this.x=a[c];this.y=a[c+1];this.z=a[c+2];return this}toArray(a=[],c=0){a[c]=this.x;a[c+1]=this.y;a[c+2]=this.z;return a}fromBufferAttribute(a,c){this.x=a.getX(c);this.y=a.getY(c);this.z=a.getZ(c);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const a=Math.random()*Math.PI*2,c=2*Math.random()-1,e=Math.sqrt(1-c*c);this.x=e*Math.cos(a);this.y=c;this.z=e*Math.sin(a);return this}*[Symbol.iterator](){yield this.x;
yield this.y;yield this.z}}const Fi=new Da,tg=new Ze;class fe{constructor(a=new Da(Infinity,Infinity,Infinity),c=new Da(-Infinity,-Infinity,-Infinity)){this.isBox3=!0;this.min=a;this.max=c}set(a,c){this.min.copy(a);this.max.copy(c);return this}setFromArray(a){this.makeEmpty();for(let c=0,e=a.length;c<e;c+=3)this.expandByPoint(ye.fromArray(a,c));return this}setFromBufferAttribute(a){this.makeEmpty();for(let c=0,e=a.count;c<e;c++)this.expandByPoint(ye.fromBufferAttribute(a,c));return this}setFromPoints(a){this.makeEmpty();
for(let c=0,e=a.length;c<e;c++)this.expandByPoint(a[c]);return this}setFromCenterAndSize(a,c){c=ye.copy(c).multiplyScalar(.5);this.min.copy(a).sub(c);this.max.copy(a).add(c);return this}setFromObject(a,c=!1){this.makeEmpty();return this.expandByObject(a,c)}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this}isEmpty(){return this.max.x<
this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}expandByObject(a,c=!1){a.updateWorldMatrix(!1,!1);const e=a.geometry;
if(void 0!==e){const h=e.getAttribute("position");if(!0===c&&void 0!==h&&!0!==a.isInstancedMesh)for(let l=0,p=h.count;l<p;l++)!0===a.isMesh?a.getVertexPosition(l,ye):ye.fromBufferAttribute(h,l),ye.applyMatrix4(a.matrixWorld),this.expandByPoint(ye);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),dg.copy(a.boundingBox)):(null===e.boundingBox&&e.computeBoundingBox(),dg.copy(e.boundingBox)),dg.applyMatrix4(a.matrixWorld),this.union(dg)}a=a.children;for(let h=0,l=a.length;h<l;h++)this.expandByObject(a[h],
c);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&
a.max.y>=this.min.y&&a.min.y<=this.max.y&&a.max.z>=this.min.z&&a.min.z<=this.max.z}intersectsSphere(a){this.clampPoint(a.center,ye);return ye.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let c,e;0<a.normal.x?(c=a.normal.x*this.min.x,e=a.normal.x*this.max.x):(c=a.normal.x*this.max.x,e=a.normal.x*this.min.x);0<a.normal.y?(c+=a.normal.y*this.min.y,e+=a.normal.y*this.max.y):(c+=a.normal.y*this.max.y,e+=a.normal.y*this.min.y);0<a.normal.z?(c+=a.normal.z*this.min.z,e+=a.normal.z*this.max.z):
(c+=a.normal.z*this.max.z,e+=a.normal.z*this.min.z);return c<=-a.constant&&e>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(ge);Ng.subVectors(this.max,ge);tf.subVectors(a.a,ge);Ce.subVectors(a.b,ge);Hf.subVectors(a.c,ge);af.subVectors(Ce,tf);Pe.subVectors(Hf,Ce);ug.subVectors(tf,Hf);a=[0,-af.z,af.y,0,-Pe.z,Pe.y,0,-ug.z,ug.y,af.z,0,-af.x,Pe.z,0,-Pe.x,ug.z,0,-ug.x,-af.y,af.x,0,-Pe.y,Pe.x,0,-ug.y,ug.x,0];if(!Pa(a,tf,Ce,Hf,Ng))return!1;a=[1,0,0,0,1,0,0,0,1];if(!Pa(a,tf,Ce,
Hf,Ng))return!1;Qe.crossVectors(af,Pe);a=[Qe.x,Qe.y,Qe.z];return Pa(a,tf,Ce,Hf,Ng)}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,ye).distanceTo(a)}getBoundingSphere(a){this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(ye).length());return a}intersect(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);this.max.max(a.max);return this}applyMatrix4(a){if(this.isEmpty())return this;
Ad[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a);Ad[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a);Ad[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a);Ad[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a);Ad[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a);Ad[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a);Ad[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a);Ad[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a);this.setFromPoints(Ad);
return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const Ad=[new Da,new Da,new Da,new Da,new Da,new Da,new Da,new Da],ye=new Da,dg=new fe,tf=new Da,Ce=new Da,Hf=new Da,af=new Da,Pe=new Da,ug=new Da,ge=new Da,Ng=new Da,Qe=new Da,eh=new Da,Og=new fe,fi=new Da,yj=new Da;class $e{constructor(a=new Da,c=-1){this.isSphere=!0;this.center=a;this.radius=c}set(a,c){this.center.copy(a);this.radius=c;return this}setFromPoints(a,
c){const e=this.center;void 0!==c?e.copy(c):Og.setFromPoints(a).getCenter(e);c=0;for(let h=0,l=a.length;h<l;h++)c=Math.max(c,e.distanceToSquared(a[h]));this.radius=Math.sqrt(c);return this}copy(a){this.center.copy(a.center);this.radius=a.radius;return this}isEmpty(){return 0>this.radius}makeEmpty(){this.center.set(0,0,0);this.radius=-1;return this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const c=
this.radius+a.radius;return a.center.distanceToSquared(this.center)<=c*c}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,c){const e=this.center.distanceToSquared(a);c.copy(a);e>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center));return c}getBoundingBox(a){if(this.isEmpty())return a.makeEmpty(),a;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a}applyMatrix4(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this}translate(a){this.center.add(a);return this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;fi.subVectors(a,this.center);a=fi.lengthSq();if(a>this.radius*this.radius){a=Math.sqrt(a);const c=.5*(a-this.radius);this.center.addScaledVector(fi,c/a);this.radius+=c}return this}union(a){if(a.isEmpty())return this;if(this.isEmpty())return this.copy(a),this;!0===this.center.equals(a.center)?
this.radius=Math.max(this.radius,a.radius):(yj.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(fi.copy(a.center).add(yj)),this.expandByPoint(fi.copy(a.center).sub(yj)));return this}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Pg=new Da,Gi=new Da,Hi=new Da,eg=new Da,gi=new Da,hi=new Da,zj=new Da;class wh{constructor(a=new Da,c=new Da(0,0,-1)){this.origin=a;this.direction=c}set(a,c){this.origin.copy(a);
this.direction.copy(c);return this}copy(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this}at(a,c){return c.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){this.direction.copy(a).sub(this.origin).normalize();return this}recast(a){this.origin.copy(this.at(a,Pg));return this}closestPointToPoint(a,c){c.subVectors(a,this.origin);a=c.dot(this.direction);return 0>a?c.copy(this.origin):c.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const c=
Pg.subVectors(a,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(a);Pg.copy(this.origin).addScaledVector(this.direction,c);return Pg.distanceToSquared(a)}distanceSqToSegment(a,c,e,h){Gi.copy(a).add(c).multiplyScalar(.5);Hi.copy(c).sub(a).normalize();eg.copy(this.origin).sub(Gi);var l=.5*a.distanceTo(c),p=-this.direction.dot(Hi);const w=eg.dot(this.direction),x=-eg.dot(Hi),y=eg.lengthSq(),D=Math.abs(1-p*p);let H;0<D?(a=p*x-w,c=p*w-x,H=l*D,0<=a?c>=-H?c<=H?(l=1/D,a*=l,c*=
l,p=a*(a+p*c+2*w)+c*(p*a+c+2*x)+y):(c=l,a=Math.max(0,-(p*c+w)),p=-a*a+c*(c+2*x)+y):(c=-l,a=Math.max(0,-(p*c+w)),p=-a*a+c*(c+2*x)+y):c<=-H?(a=Math.max(0,-(-p*l+w)),c=0<a?-l:Math.min(Math.max(-l,-x),l),p=-a*a+c*(c+2*x)+y):c<=H?(a=0,c=Math.min(Math.max(-l,-x),l),p=c*(c+2*x)+y):(a=Math.max(0,-(p*l+w)),c=0<a?l:Math.min(Math.max(-l,-x),l),p=-a*a+c*(c+2*x)+y)):(c=0<p?-l:l,a=Math.max(0,-(p*c+w)),p=-a*a+c*(c+2*x)+y);e&&e.copy(this.origin).addScaledVector(this.direction,a);h&&h.copy(Gi).addScaledVector(Hi,
c);return p}intersectSphere(a,c){Pg.subVectors(a.center,this.origin);var e=Pg.dot(this.direction),h=Pg.dot(Pg)-e*e;a=a.radius*a.radius;if(h>a)return null;a=Math.sqrt(a-h);h=e-a;e+=a;return 0>e?null:0>h?this.at(e,c):this.at(h,c)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){const c=a.normal.dot(this.direction);if(0===c)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/c;return 0<=a?a:null}intersectPlane(a,
c){a=this.distanceToPlane(a);return null===a?null:this.at(a,c)}intersectsPlane(a){const c=a.distanceToPoint(this.origin);return 0===c||0>a.normal.dot(this.direction)*c?!0:!1}intersectBox(a,c){let e;var h=1/this.direction.x;var l=1/this.direction.y;const p=1/this.direction.z,w=this.origin;0<=h?(e=(a.min.x-w.x)*h,h*=a.max.x-w.x):(e=(a.max.x-w.x)*h,h*=a.min.x-w.x);if(0<=l){var x=(a.min.y-w.y)*l;l*=a.max.y-w.y}else x=(a.max.y-w.y)*l,l*=a.min.y-w.y;if(e>l||x>h)return null;if(x>e||isNaN(e))e=x;if(l<h||
isNaN(h))h=l;0<=p?(x=(a.min.z-w.z)*p,a=(a.max.z-w.z)*p):(x=(a.max.z-w.z)*p,a=(a.min.z-w.z)*p);if(e>a||x>h)return null;if(x>e||e!==e)e=x;if(a<h||h!==h)h=a;return 0>h?null:this.at(0<=e?e:h,c)}intersectsBox(a){return null!==this.intersectBox(a,Pg)}intersectTriangle(a,c,e,h,l){gi.subVectors(c,a);hi.subVectors(e,a);zj.crossVectors(gi,hi);c=this.direction.dot(zj);if(0<c){if(h)return null;h=1}else if(0>c)h=-1,c=-c;else return null;eg.subVectors(this.origin,a);a=h*this.direction.dot(hi.crossVectors(eg,hi));
if(0>a)return null;e=h*this.direction.dot(gi.cross(eg));if(0>e||a+e>c)return null;a=-h*eg.dot(zj);return 0>a?null:this.at(a/c,l)}applyMatrix4(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Wc{constructor(a,c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z){Wc.prototype.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];void 0!==a&&this.set(a,
c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z)}set(a,c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z){const aa=this.elements;aa[0]=a;aa[4]=c;aa[8]=e;aa[12]=h;aa[1]=l;aa[5]=p;aa[9]=w;aa[13]=x;aa[2]=y;aa[6]=D;aa[10]=H;aa[14]=I;aa[3]=L;aa[7]=Y;aa[11]=P;aa[15]=Z;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return(new Wc).fromArray(this.elements)}copy(a){const c=this.elements;a=a.elements;c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];
c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return this}copyPosition(a){const c=this.elements;a=a.elements;c[12]=a[12];c[13]=a[13];c[14]=a[14];return this}setFromMatrix3(a){a=a.elements;this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1);return this}extractBasis(a,c,e){a.setFromMatrixColumn(this,0);c.setFromMatrixColumn(this,1);e.setFromMatrixColumn(this,2);return this}makeBasis(a,c,e){this.set(a.x,c.x,e.x,0,a.y,c.y,e.y,0,a.z,c.z,e.z,0,0,0,0,1);return this}extractRotation(a){const c=
this.elements,e=a.elements,h=1/xh.setFromMatrixColumn(a,0).length(),l=1/xh.setFromMatrixColumn(a,1).length();a=1/xh.setFromMatrixColumn(a,2).length();c[0]=e[0]*h;c[1]=e[1]*h;c[2]=e[2]*h;c[3]=0;c[4]=e[4]*l;c[5]=e[5]*l;c[6]=e[6]*l;c[7]=0;c[8]=e[8]*a;c[9]=e[9]*a;c[10]=e[10]*a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}makeRotationFromEuler(a){const c=this.elements;var e=a.x,h=a.y,l=a.z;const p=Math.cos(e);e=Math.sin(e);const w=Math.cos(h);h=Math.sin(h);const x=Math.cos(l);l=Math.sin(l);if("XYZ"===
a.order){a=p*x;var y=p*l,D=e*x,H=e*l;c[0]=w*x;c[4]=-w*l;c[8]=h;c[1]=y+D*h;c[5]=a-H*h;c[9]=-e*w;c[2]=H-a*h;c[6]=D+y*h;c[10]=p*w}else"YXZ"===a.order?(a=w*x,y=w*l,D=h*x,H=h*l,c[0]=a+H*e,c[4]=D*e-y,c[8]=p*h,c[1]=p*l,c[5]=p*x,c[9]=-e,c[2]=y*e-D,c[6]=H+a*e,c[10]=p*w):"ZXY"===a.order?(a=w*x,y=w*l,D=h*x,H=h*l,c[0]=a-H*e,c[4]=-p*l,c[8]=D+y*e,c[1]=y+D*e,c[5]=p*x,c[9]=H-a*e,c[2]=-p*h,c[6]=e,c[10]=p*w):"ZYX"===a.order?(a=p*x,y=p*l,D=e*x,H=e*l,c[0]=w*x,c[4]=D*h-y,c[8]=a*h+H,c[1]=w*l,c[5]=H*h+a,c[9]=y*h-D,c[2]=
-h,c[6]=e*w,c[10]=p*w):"YZX"===a.order?(a=p*w,y=p*h,D=e*w,H=e*h,c[0]=w*x,c[4]=H-a*l,c[8]=D*l+y,c[1]=l,c[5]=p*x,c[9]=-e*x,c[2]=-h*x,c[6]=y*l+D,c[10]=a-H*l):"XZY"===a.order&&(a=p*w,y=p*h,D=e*w,H=e*h,c[0]=w*x,c[4]=-l,c[8]=h*x,c[1]=a*l+H,c[5]=p*x,c[9]=y*l-D,c[2]=D*l-y,c[6]=e*x,c[10]=H*l+a);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}makeRotationFromQuaternion(a){return this.compose(fj,a,zd)}lookAt(a,c,e){const h=this.elements;je.subVectors(a,c);0===je.lengthSq()&&(je.z=1);je.normalize();
lf.crossVectors(e,je);0===lf.lengthSq()&&(1===Math.abs(e.z)?je.x+=1E-4:je.z+=1E-4,je.normalize(),lf.crossVectors(e,je));lf.normalize();Ii.crossVectors(je,lf);h[0]=lf.x;h[4]=Ii.x;h[8]=je.x;h[1]=lf.y;h[5]=Ii.y;h[9]=je.y;h[2]=lf.z;h[6]=Ii.z;h[10]=je.z;return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,c){var e=a.elements,h=c.elements;c=this.elements;a=e[0];const l=e[4],p=e[8],w=e[12],x=e[1],y=e[5],D=e[9],H=e[13],I=e[2],
L=e[6],Y=e[10],P=e[14],Z=e[3],aa=e[7],T=e[11];e=e[15];const ha=h[0],Ca=h[4],xa=h[8],Ha=h[12],Fa=h[1],Ra=h[5],Ja=h[9],Ka=h[13],lb=h[2],wb=h[6],Mb=h[10],kb=h[14],jc=h[3],Wb=h[7],Xb=h[11];h=h[15];c[0]=a*ha+l*Fa+p*lb+w*jc;c[4]=a*Ca+l*Ra+p*wb+w*Wb;c[8]=a*xa+l*Ja+p*Mb+w*Xb;c[12]=a*Ha+l*Ka+p*kb+w*h;c[1]=x*ha+y*Fa+D*lb+H*jc;c[5]=x*Ca+y*Ra+D*wb+H*Wb;c[9]=x*xa+y*Ja+D*Mb+H*Xb;c[13]=x*Ha+y*Ka+D*kb+H*h;c[2]=I*ha+L*Fa+Y*lb+P*jc;c[6]=I*Ca+L*Ra+Y*wb+P*Wb;c[10]=I*xa+L*Ja+Y*Mb+P*Xb;c[14]=I*Ha+L*Ka+Y*kb+P*h;c[3]=Z*
ha+aa*Fa+T*lb+e*jc;c[7]=Z*Ca+aa*Ra+T*wb+e*Wb;c[11]=Z*xa+aa*Ja+T*Mb+e*Xb;c[15]=Z*Ha+aa*Ka+T*kb+e*h;return this}multiplyScalar(a){const c=this.elements;c[0]*=a;c[4]*=a;c[8]*=a;c[12]*=a;c[1]*=a;c[5]*=a;c[9]*=a;c[13]*=a;c[2]*=a;c[6]*=a;c[10]*=a;c[14]*=a;c[3]*=a;c[7]*=a;c[11]*=a;c[15]*=a;return this}determinant(){const a=this.elements,c=a[0],e=a[4],h=a[8],l=a[12],p=a[1],w=a[5],x=a[9],y=a[13],D=a[2],H=a[6],I=a[10],L=a[14];return a[3]*(+l*x*H-h*y*H-l*w*I+e*y*I+h*w*L-e*x*L)+a[7]*(+c*x*L-c*y*I+l*p*I-h*p*L+
h*y*D-l*x*D)+a[11]*(+c*y*H-c*w*L-l*p*H+e*p*L+l*w*D-e*y*D)+a[15]*(-h*w*D-c*x*H+c*w*I+h*p*H-e*p*I+e*x*D)}transpose(){const a=this.elements;let c;c=a[1];a[1]=a[4];a[4]=c;c=a[2];a[2]=a[8];a[8]=c;c=a[6];a[6]=a[9];a[9]=c;c=a[3];a[3]=a[12];a[12]=c;c=a[7];a[7]=a[13];a[13]=c;c=a[11];a[11]=a[14];a[14]=c;return this}setPosition(a,c,e){const h=this.elements;a.isVector3?(h[12]=a.x,h[13]=a.y,h[14]=a.z):(h[12]=a,h[13]=c,h[14]=e);return this}invert(){const a=this.elements,c=a[0],e=a[1],h=a[2],l=a[3],p=a[4],w=a[5],
x=a[6],y=a[7],D=a[8],H=a[9],I=a[10],L=a[11],Y=a[12],P=a[13],Z=a[14],aa=a[15],T=H*Z*y-P*I*y+P*x*L-w*Z*L-H*x*aa+w*I*aa,ha=Y*I*y-D*Z*y-Y*x*L+p*Z*L+D*x*aa-p*I*aa,Ca=D*P*y-Y*H*y+Y*w*L-p*P*L-D*w*aa+p*H*aa,xa=Y*H*x-D*P*x-Y*w*I+p*P*I+D*w*Z-p*H*Z;var Ha=c*T+e*ha+h*Ca+l*xa;if(0===Ha)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);Ha=1/Ha;a[0]=T*Ha;a[1]=(P*I*l-H*Z*l-P*h*L+e*Z*L+H*h*aa-e*I*aa)*Ha;a[2]=(w*Z*l-P*x*l+P*h*y-e*Z*y-w*h*aa+e*x*aa)*Ha;a[3]=(H*x*l-w*I*l-H*h*y+e*I*y+w*h*L-e*x*L)*Ha;a[4]=ha*Ha;a[5]=(D*
Z*l-Y*I*l+Y*h*L-c*Z*L-D*h*aa+c*I*aa)*Ha;a[6]=(Y*x*l-p*Z*l-Y*h*y+c*Z*y+p*h*aa-c*x*aa)*Ha;a[7]=(p*I*l-D*x*l+D*h*y-c*I*y-p*h*L+c*x*L)*Ha;a[8]=Ca*Ha;a[9]=(Y*H*l-D*P*l-Y*e*L+c*P*L+D*e*aa-c*H*aa)*Ha;a[10]=(p*P*l-Y*w*l+Y*e*y-c*P*y-p*e*aa+c*w*aa)*Ha;a[11]=(D*w*l-p*H*l-D*e*y+c*H*y+p*e*L-c*w*L)*Ha;a[12]=xa*Ha;a[13]=(D*P*h-Y*H*h+Y*e*I-c*P*I-D*e*Z+c*H*Z)*Ha;a[14]=(Y*w*h-p*P*h-Y*e*x+c*P*x+p*e*Z-c*w*Z)*Ha;a[15]=(p*H*h-D*w*h+D*e*x-c*H*x-p*e*I+c*w*I)*Ha;return this}scale(a){const c=this.elements,e=a.x,h=a.y;a=a.z;
c[0]*=e;c[4]*=h;c[8]*=a;c[1]*=e;c[5]*=h;c[9]*=a;c[2]*=e;c[6]*=h;c[10]*=a;c[3]*=e;c[7]*=h;c[11]*=a;return this}getMaxScaleOnAxis(){const a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,c,e){a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,c,0,0,1,e,0,0,0,1);return this}makeRotationX(a){const c=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,c,-a,0,0,a,c,0,0,0,0,1);
return this}makeRotationY(a){const c=Math.cos(a);a=Math.sin(a);this.set(c,0,a,0,0,1,0,0,-a,0,c,0,0,0,0,1);return this}makeRotationZ(a){const c=Math.cos(a);a=Math.sin(a);this.set(c,-a,0,0,a,c,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(a,c){const e=Math.cos(c);c=Math.sin(c);const h=1-e,l=a.x,p=a.y;a=a.z;const w=h*l,x=h*p;this.set(w*l+e,w*p-c*a,w*a+c*p,0,w*p+c*a,x*p+e,x*a-c*l,0,w*a-c*p,x*a+c*l,h*a*a+e,0,0,0,0,1);return this}makeScale(a,c,e){this.set(a,0,0,0,0,c,0,0,0,0,e,0,0,0,0,1);return this}makeShear(a,
c,e,h,l,p){this.set(1,e,l,0,a,1,p,0,c,h,1,0,0,0,0,1);return this}compose(a,c,e){const h=this.elements;var l=c._x,p=c._y,w=c._z,x=c._w,y=l+l,D=p+p,H=w+w;c=l*y;const I=l*D;l*=H;const L=p*D;p*=H;w*=H;y*=x;D*=x;x*=H;H=e.x;const Y=e.y;e=e.z;h[0]=(1-(L+w))*H;h[1]=(I+x)*H;h[2]=(l-D)*H;h[3]=0;h[4]=(I-x)*Y;h[5]=(1-(c+w))*Y;h[6]=(p+y)*Y;h[7]=0;h[8]=(l+D)*e;h[9]=(p-y)*e;h[10]=(1-(c+L))*e;h[11]=0;h[12]=a.x;h[13]=a.y;h[14]=a.z;h[15]=1;return this}decompose(a,c,e){var h=this.elements;let l=xh.set(h[0],h[1],h[2]).length();
const p=xh.set(h[4],h[5],h[6]).length(),w=xh.set(h[8],h[9],h[10]).length();0>this.determinant()&&(l=-l);a.x=h[12];a.y=h[13];a.z=h[14];Re.copy(this);a=1/l;h=1/p;const x=1/w;Re.elements[0]*=a;Re.elements[1]*=a;Re.elements[2]*=a;Re.elements[4]*=h;Re.elements[5]*=h;Re.elements[6]*=h;Re.elements[8]*=x;Re.elements[9]*=x;Re.elements[10]*=x;c.setFromRotationMatrix(Re);e.x=l;e.y=p;e.z=w;return this}makePerspective(a,c,e,h,l,p,w=2E3){const x=this.elements;if(2E3===w)w=-(p+l)/(p-l),p=-2*p*l/(p-l);else if(2001===
w)w=-p/(p-l),p=-p*l/(p-l);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+w);x[0]=2*l/(c-a);x[4]=0;x[8]=(c+a)/(c-a);x[12]=0;x[1]=0;x[5]=2*l/(e-h);x[9]=(e+h)/(e-h);x[13]=0;x[2]=0;x[6]=0;x[10]=w;x[14]=p;x[3]=0;x[7]=0;x[11]=-1;x[15]=0;return this}makeOrthographic(a,c,e,h,l,p,w=2E3){const x=this.elements,y=1/(c-a),D=1/(e-h);var H=1/(p-l);if(2E3===w)l=(p+l)*H,H*=-2;else if(2001===w)l*=H,H*=-1;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+
w);x[0]=2*y;x[4]=0;x[8]=0;x[12]=-((c+a)*y);x[1]=0;x[5]=2*D;x[9]=0;x[13]=-((e+h)*D);x[2]=0;x[6]=0;x[10]=H;x[14]=-l;x[3]=0;x[7]=0;x[11]=0;x[15]=1;return this}equals(a){const c=this.elements;a=a.elements;for(let e=0;16>e;e++)if(c[e]!==a[e])return!1;return!0}fromArray(a,c=0){for(let e=0;16>e;e++)this.elements[e]=a[e+c];return this}toArray(a=[],c=0){const e=this.elements;a[c]=e[0];a[c+1]=e[1];a[c+2]=e[2];a[c+3]=e[3];a[c+4]=e[4];a[c+5]=e[5];a[c+6]=e[6];a[c+7]=e[7];a[c+8]=e[8];a[c+9]=e[9];a[c+10]=e[10];
a[c+11]=e[11];a[c+12]=e[12];a[c+13]=e[13];a[c+14]=e[14];a[c+15]=e[15];return a}}const xh=new Da,Re=new Wc,fj=new Da(0,0,0),zd=new Da(1,1,1),lf=new Da,Ii=new Da,je=new Da,Zj=new Wc,gj=new Ze;class Qg{constructor(a=0,c=0,e=0,h=Qg.DEFAULT_ORDER){this.isEuler=!0;this._x=a;this._y=c;this._z=e;this._order=h}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a;this._onChangeCallback()}get order(){return this._order}set order(a){this._order=
a;this._onChangeCallback()}set(a,c,e,h=this._order){this._x=a;this._y=c;this._z=e;this._order=h;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._onChangeCallback();return this}setFromRotationMatrix(a,c=this._order,e=!0){var h=a.elements;a=h[0];const l=h[4],p=h[8],w=h[1],x=h[5],y=h[9],D=h[2],H=h[6];h=h[10];switch(c){case "XYZ":this._y=Math.asin(qc(p,-1,1));.9999999>
Math.abs(p)?(this._x=Math.atan2(-y,h),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(H,x),this._z=0);break;case "YXZ":this._x=Math.asin(-qc(y,-1,1));.9999999>Math.abs(y)?(this._y=Math.atan2(p,h),this._z=Math.atan2(w,x)):(this._y=Math.atan2(-D,a),this._z=0);break;case "ZXY":this._x=Math.asin(qc(H,-1,1));.9999999>Math.abs(H)?(this._y=Math.atan2(-D,h),this._z=Math.atan2(-l,x)):(this._y=0,this._z=Math.atan2(w,a));break;case "ZYX":this._y=Math.asin(-qc(D,-1,1));.9999999>Math.abs(D)?(this._x=Math.atan2(H,
h),this._z=Math.atan2(w,a)):(this._x=0,this._z=Math.atan2(-l,x));break;case "YZX":this._z=Math.asin(qc(w,-1,1));.9999999>Math.abs(w)?(this._x=Math.atan2(-y,x),this._y=Math.atan2(-D,a)):(this._x=0,this._y=Math.atan2(p,h));break;case "XZY":this._z=Math.asin(-qc(l,-1,1));.9999999>Math.abs(l)?(this._x=Math.atan2(H,x),this._y=Math.atan2(p,a)):(this._x=Math.atan2(-y,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}this._order=c;!0===e&&this._onChangeCallback();
return this}setFromQuaternion(a,c,e){Zj.makeRotationFromQuaternion(a);return this.setFromRotationMatrix(Zj,c,e)}setFromVector3(a,c=this._order){return this.set(a.x,a.y,a.z,c)}reorder(a){gj.setFromEuler(this);return this.setFromQuaternion(gj,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this._onChangeCallback();return this}toArray(a=[],c=0){a[c]=this._x;a[c+1]=this._y;
a[c+2]=this._z;a[c+3]=this._order;return a}_onChange(a){this._onChangeCallback=a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._order}}Qg.DEFAULT_ORDER="XYZ";class ke{constructor(){this.mask=1}set(a){this.mask=(1<<a|0)>>>0}enable(a){this.mask=this.mask|1<<a|0}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a|0}disable(a){this.mask&=~(1<<a|0)}disableAll(){this.mask=0}test(a){return 0!==(this.mask&a.mask)}isEnabled(a){return 0!==(this.mask&
(1<<a|0))}}let Ji=0;const Nh=new Da,fh=new Ze,Qf=new Wc,Oh=new Da,Ki=new Da,Mi=new Da,hj=new Ze,Aj=new Da(1,0,0),uf=new Da(0,1,0),Ph=new Da(0,0,1),Cj={type:"added"},yh={type:"removed"},Qh={type:"childadded",child:null},vg={type:"childremoved",child:null};class Nd extends Bf{constructor(){super();this.isObject3D=!0;Object.defineProperty(this,"id",{value:Ji++});this.uuid=Na();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=Nd.DEFAULT_UP.clone();const a=new Da,c=new Qg,e=
new Ze,h=new Da(1,1,1);c._onChange(function(){e.setFromEuler(c,!1)});e._onChange(function(){c.setFromQuaternion(e,void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:e},scale:{configurable:!0,enumerable:!0,value:h},modelViewMatrix:{value:new Wc},normalMatrix:{value:new nd}});this.matrix=new Wc;this.matrixWorld=new Wc;this.matrixAutoUpdate=Nd.DEFAULT_MATRIX_AUTO_UPDATE;
this.matrixWorldAutoUpdate=Nd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE;this.matrixWorldNeedsUpdate=!1;this.layers=new ke;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.animations=[];this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(a);this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){this.quaternion.premultiply(a);
return this}setRotationFromAxisAngle(a,c){this.quaternion.setFromAxisAngle(a,c)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,c){fh.setFromAxisAngle(a,c);this.quaternion.multiply(fh);return this}rotateOnWorldAxis(a,c){fh.setFromAxisAngle(a,c);this.quaternion.premultiply(fh);return this}rotateX(a){return this.rotateOnAxis(Aj,a)}rotateY(a){return this.rotateOnAxis(uf,
a)}rotateZ(a){return this.rotateOnAxis(Ph,a)}translateOnAxis(a,c){Nh.copy(a).applyQuaternion(this.quaternion);this.position.add(Nh.multiplyScalar(c));return this}translateX(a){return this.translateOnAxis(Aj,a)}translateY(a){return this.translateOnAxis(uf,a)}translateZ(a){return this.translateOnAxis(Ph,a)}localToWorld(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(this.matrixWorld)}worldToLocal(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(Qf.copy(this.matrixWorld).invert())}lookAt(a,
c,e){a.isVector3?Oh.copy(a):Oh.set(a,c,e);a=this.parent;this.updateWorldMatrix(!0,!1);Ki.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?Qf.lookAt(Ki,Oh,this.up):Qf.lookAt(Oh,Ki,this.up);this.quaternion.setFromRotationMatrix(Qf);a&&(Qf.extractRotation(a.matrixWorld),fh.setFromRotationMatrix(Qf),this.quaternion.premultiply(fh.invert()))}add(a){if(1<arguments.length){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(Cj),Qh.child=a,this.dispatchEvent(Qh),Qh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this}remove(a){if(1<arguments.length){for(var c=0;c<arguments.length;c++)this.remove(arguments[c]);return this}c=this.children.indexOf(a);-1!==c&&(a.parent=null,this.children.splice(c,1),a.dispatchEvent(yh),vg.child=a,this.dispatchEvent(vg),vg.child=null);return this}removeFromParent(){const a=
this.parent;null!==a&&a.remove(this);return this}clear(){return this.remove(...this.children)}attach(a){this.updateWorldMatrix(!0,!1);Qf.copy(this.matrixWorld).invert();null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),Qf.multiply(a.parent.matrixWorld));a.applyMatrix4(Qf);a.removeFromParent();a.parent=this;this.children.push(a);a.updateWorldMatrix(!1,!0);a.dispatchEvent(Cj);Qh.child=a;this.dispatchEvent(Qh);Qh.child=null;return this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",
a)}getObjectByProperty(a,c){if(this[a]===c)return this;for(let e=0,h=this.children.length;e<h;e++){const l=this.children[e].getObjectByProperty(a,c);if(void 0!==l)return l}}getObjectsByProperty(a,c,e=[]){this[a]===c&&e.push(this);const h=this.children;for(let l=0,p=h.length;l<p;l++)h[l].getObjectsByProperty(a,c,e);return e}getWorldPosition(a){this.updateWorldMatrix(!0,!1);return a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(Ki,
a,Mi);return a}getWorldScale(a){this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(Ki,hj,a);return a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return a.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(a){a(this);const c=this.children;for(let e=0,h=c.length;e<h;e++)c[e].traverse(a)}traverseVisible(a){if(!1!==this.visible){a(this);var c=this.children;for(let e=0,h=c.length;e<h;e++)c[e].traverseVisible(a)}}traverseAncestors(a){const c=this.parent;
null!==c&&(a(c),c.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0;const c=this.children;for(let e=0,h=c.length;e<h;e++)c[e].updateMatrixWorld(a)}updateWorldMatrix(a,
c){const e=this.parent;!0===a&&null!==e&&e.updateWorldMatrix(!0,!1);this.matrixAutoUpdate&&this.updateMatrix();!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix));if(!0===c){a=this.children;for(let h=0,l=a.length;h<l;h++)a[h].updateWorldMatrix(!1,!0)}}toJSON(a){function c(x,y){void 0===x[y.uuid]&&(x[y.uuid]=y.toJSON(a));return y.uuid}function e(x){const y=[];for(const D in x){const H=x[D];delete H.metadata;
y.push(H)}return y}var h=void 0===a||"string"===typeof a;const l={};h&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},l.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const p={};p.uuid=this.uuid;p.type=this.type;""!==this.name&&(p.name=this.name);!0===this.castShadow&&(p.castShadow=!0);!0===this.receiveShadow&&(p.receiveShadow=!0);!1===this.visible&&(p.visible=!1);!1===this.frustumCulled&&(p.frustumCulled=!1);0!==this.renderOrder&&
(p.renderOrder=this.renderOrder);0<Object.keys(this.userData).length&&(p.userData=this.userData);p.layers=this.layers.mask;p.matrix=this.matrix.toArray();p.up=this.up.toArray();!1===this.matrixAutoUpdate&&(p.matrixAutoUpdate=!1);this.isInstancedMesh&&(p.type="InstancedMesh",p.count=this.count,p.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(p.instanceColor=this.instanceColor.toJSON()));this.isBatchedMesh&&(p.type="BatchedMesh",p.perObjectFrustumCulled=this.perObjectFrustumCulled,
p.sortObjects=this.sortObjects,p.drawRanges=this._drawRanges,p.reservedRanges=this._reservedRanges,p.visibility=this._visibility,p.active=this._active,p.bounds=this._bounds.map(x=>({boxInitialized:x.boxInitialized,boxMin:x.box.min.toArray(),boxMax:x.box.max.toArray(),sphereInitialized:x.sphereInitialized,sphereRadius:x.sphere.radius,sphereCenter:x.sphere.center.toArray()})),p.maxInstanceCount=this._maxInstanceCount,p.maxVertexCount=this._maxVertexCount,p.maxIndexCount=this._maxIndexCount,p.geometryInitialized=
this._geometryInitialized,p.geometryCount=this._geometryCount,p.matricesTexture=this._matricesTexture.toJSON(a),null!==this._colorsTexture&&(p.colorsTexture=this._colorsTexture.toJSON(a)),null!==this.boundingSphere&&(p.boundingSphere={center:p.boundingSphere.center.toArray(),radius:p.boundingSphere.radius}),null!==this.boundingBox&&(p.boundingBox={min:p.boundingBox.min.toArray(),max:p.boundingBox.max.toArray()}));if(this.isScene)this.background&&(this.background.isColor?p.background=this.background.toJSON():
this.background.isTexture&&(p.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(p.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){p.geometry=c(a.geometries,this.geometry);var w=this.geometry.parameters;if(void 0!==w&&void 0!==w.shapes)if(w=w.shapes,Array.isArray(w))for(let x=0,y=w.length;x<y;x++)c(a.shapes,w[x]);else c(a.shapes,w)}this.isSkinnedMesh&&(p.bindMode=this.bindMode,
p.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(c(a.skeletons,this.skeleton),p.skeleton=this.skeleton.uuid));if(void 0!==this.material)if(Array.isArray(this.material)){w=[];for(let x=0,y=this.material.length;x<y;x++)w.push(c(a.materials,this.material[x]));p.material=w}else p.material=c(a.materials,this.material);if(0<this.children.length)for(p.children=[],w=0;w<this.children.length;w++)p.children.push(this.children[w].toJSON(a).object);if(0<this.animations.length)for(p.animations=
[],w=0;w<this.animations.length;w++)p.animations.push(c(a.animations,this.animations[w]));if(h){h=e(a.geometries);w=e(a.materials);const x=e(a.textures),y=e(a.images),D=e(a.shapes),H=e(a.skeletons),I=e(a.animations),L=e(a.nodes);0<h.length&&(l.geometries=h);0<w.length&&(l.materials=w);0<x.length&&(l.textures=x);0<y.length&&(l.images=y);0<D.length&&(l.shapes=D);0<H.length&&(l.skeletons=H);0<I.length&&(l.animations=I);0<L.length&&(l.nodes=L)}l.object=p;return l}clone(a){return(new this.constructor).copy(this,
a)}copy(a,c=!0){this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.rotation.order=a.rotation.order;this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;
this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.animations=a.animations.slice();this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===c)for(c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}}Nd.DEFAULT_UP=new Da(0,1,0);Nd.DEFAULT_MATRIX_AUTO_UPDATE=!0;Nd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const vf=new Da,wg=new Da,Ni=new Da,gg=new Da,ii=new Da,Sh=new Da,ak=new Da,Ek=new Da,Dj=new Da,bk=new Da,Gk=new yd,t=new yd,A=new yd;class E{constructor(a=new Da,
c=new Da,e=new Da){this.a=a;this.b=c;this.c=e}static getNormal(a,c,e,h){h.subVectors(e,c);vf.subVectors(a,c);h.cross(vf);a=h.lengthSq();return 0<a?h.multiplyScalar(1/Math.sqrt(a)):h.set(0,0,0)}static getBarycoord(a,c,e,h,l){vf.subVectors(h,c);wg.subVectors(e,c);Ni.subVectors(a,c);a=vf.dot(vf);c=vf.dot(wg);e=vf.dot(Ni);var p=wg.dot(wg);h=wg.dot(Ni);var w=a*p-c*c;if(0===w)return l.set(0,0,0),null;w=1/w;p=(p*e-c*h)*w;a=(a*h-c*e)*w;return l.set(1-p-a,a,p)}static containsPoint(a,c,e,h){return null===this.getBarycoord(a,
c,e,h,gg)?!1:0<=gg.x&&0<=gg.y&&1>=gg.x+gg.y}static getInterpolation(a,c,e,h,l,p,w,x){if(null===this.getBarycoord(a,c,e,h,gg))return x.x=0,x.y=0,"z"in x&&(x.z=0),"w"in x&&(x.w=0),null;x.setScalar(0);x.addScaledVector(l,gg.x);x.addScaledVector(p,gg.y);x.addScaledVector(w,gg.z);return x}static getInterpolatedAttribute(a,c,e,h,l,p){Gk.setScalar(0);t.setScalar(0);A.setScalar(0);Gk.fromBufferAttribute(a,c);t.fromBufferAttribute(a,e);A.fromBufferAttribute(a,h);p.setScalar(0);p.addScaledVector(Gk,l.x);p.addScaledVector(t,
l.y);p.addScaledVector(A,l.z);return p}static isFrontFacing(a,c,e,h){vf.subVectors(e,c);wg.subVectors(a,c);return 0>vf.cross(wg).dot(h)?!0:!1}set(a,c,e){this.a.copy(a);this.b.copy(c);this.c.copy(e);return this}setFromPointsAndIndices(a,c,e,h){this.a.copy(a[c]);this.b.copy(a[e]);this.c.copy(a[h]);return this}setFromAttributeAndIndices(a,c,e,h){this.a.fromBufferAttribute(a,c);this.b.fromBufferAttribute(a,e);this.c.fromBufferAttribute(a,h);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.a.copy(a.a);
this.b.copy(a.b);this.c.copy(a.c);return this}getArea(){vf.subVectors(this.c,this.b);wg.subVectors(this.a,this.b);return.5*vf.cross(wg).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return E.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,c){return E.getBarycoord(a,this.a,this.b,this.c,c)}getInterpolation(a,c,e,h,l){return E.getInterpolation(a,this.a,this.b,this.c,c,e,h,l)}containsPoint(a){return E.containsPoint(a,
this.a,this.b,this.c)}isFrontFacing(a){return E.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,c){const e=this.a;var h=this.b,l=this.c;ii.subVectors(h,e);Sh.subVectors(l,e);Ek.subVectors(a,e);var p=ii.dot(Ek),w=Sh.dot(Ek);if(0>=p&&0>=w)return c.copy(e);Dj.subVectors(a,h);const x=ii.dot(Dj),y=Sh.dot(Dj);if(0<=x&&y<=x)return c.copy(h);var D=p*y-x*w;if(0>=D&&0<=p&&0>=x)return h=p/(p-x),c.copy(e).addScaledVector(ii,h);bk.subVectors(a,l);
a=ii.dot(bk);const H=Sh.dot(bk);if(0<=H&&a<=H)return c.copy(l);p=a*w-p*H;if(0>=p&&0<=w&&0>=H)return D=w/(w-H),c.copy(e).addScaledVector(Sh,D);w=x*H-a*y;if(0>=w&&0<=y-x&&0<=a-H)return ak.subVectors(l,h),D=(y-x)/(y-x+(a-H)),c.copy(h).addScaledVector(ak,D);l=1/(w+p+D);h=p*l;D*=l;return c.copy(e).addScaledVector(ii,h).addScaledVector(Sh,D)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}const N={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,
beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,
darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,
khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,
mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,
peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,
whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},U={h:0,s:0,l:0},ea={h:0,s:0,l:0};class ia{constructor(a,c,e){this.isColor=!0;this.b=this.g=this.r=1;return this.set(a,c,e)}set(a,c,e){void 0===c&&void 0===e?a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a):this.setRGB(a,c,e);return this}setScalar(a){this.b=this.g=this.r=a;return this}setHex(a,c="srgb"){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;Eb.toWorkingColorSpace(this,
c);return this}setRGB(a,c,e,h=Eb.workingColorSpace){this.r=a;this.g=c;this.b=e;Eb.toWorkingColorSpace(this,h);return this}setHSL(a,c,e,h=Eb.workingColorSpace){a=hb(a,1);c=qc(c,0,1);e=qc(e,0,1);0===c?this.r=this.g=this.b=e:(c=.5>=e?e*(1+c):e+c-e*c,e=2*e-c,this.r=yb(e,c,a+1/3),this.g=yb(e,c,a),this.b=yb(e,c,a-1/3));Eb.toWorkingColorSpace(this,h);return this}setStyle(a,c="srgb"){function e(p){void 0!==p&&1>parseFloat(p)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var h;if(h=
/^(\w+)\(([^\)]*)\)/.exec(a)){var l=h[2];switch(h[1]){case "rgb":case "rgba":if(h=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return e(h[4]),this.setRGB(Math.min(255,parseInt(h[1],10))/255,Math.min(255,parseInt(h[2],10))/255,Math.min(255,parseInt(h[3],10))/255,c);if(h=/^\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return e(h[4]),this.setRGB(Math.min(100,parseInt(h[1],10))/100,Math.min(100,parseInt(h[2],10))/100,Math.min(100,parseInt(h[3],10))/
100,c);break;case "hsl":case "hsla":if(h=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return e(h[4]),this.setHSL(parseFloat(h[1])/360,parseFloat(h[2])/100,parseFloat(h[3])/100,c);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(h=/^#([A-Fa-f\d]+)$/.exec(a)){l=h[1];h=l.length;if(3===h)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,c);if(6===h)return this.setHex(parseInt(l,
16),c);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&0<a.length)return this.setColorName(a,c);return this}setColorName(a,c="srgb"){const e=N[a.toLowerCase()];void 0!==e?this.setHex(e,c):console.warn("THREE.Color: Unknown color "+a);return this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){this.r=a.r;this.g=a.g;this.b=a.b;return this}copySRGBToLinear(a){this.r=bb(a.r);this.g=bb(a.g);this.b=bb(a.b);return this}copyLinearToSRGB(a){this.r=tc(a.r);this.g=tc(a.g);this.b=
tc(a.b);return this}convertSRGBToLinear(){this.copySRGBToLinear(this);return this}convertLinearToSRGB(){this.copyLinearToSRGB(this);return this}getHex(a="srgb"){Eb.fromWorkingColorSpace(va.copy(this),a);return 65536*Math.round(qc(255*va.r,0,255))+256*Math.round(qc(255*va.g,0,255))+Math.round(qc(255*va.b,0,255))}getHexString(a="srgb"){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,c=Eb.workingColorSpace){Eb.fromWorkingColorSpace(va.copy(this),c);c=va.r;const e=va.g,h=va.b,l=Math.max(c,
e,h);var p=Math.min(c,e,h);let w;const x=(p+l)/2;if(p===l)p=w=0;else{const y=l-p;p=.5>=x?y/(l+p):y/(2-l-p);switch(l){case c:w=(e-h)/y+(e<h?6:0);break;case e:w=(h-c)/y+2;break;case h:w=(c-e)/y+4}w/=6}a.h=w;a.s=p;a.l=x;return a}getRGB(a,c=Eb.workingColorSpace){Eb.fromWorkingColorSpace(va.copy(this),c);a.r=va.r;a.g=va.g;a.b=va.b;return a}getStyle(a="srgb"){Eb.fromWorkingColorSpace(va.copy(this),a);const c=va.r,e=va.g,h=va.b;return"srgb"!==a?`color(${a} ${c.toFixed(3)} ${e.toFixed(3)} ${h.toFixed(3)})`:
`rgb(${Math.round(255*c)},${Math.round(255*e)},${Math.round(255*h)})`}offsetHSL(a,c,e){this.getHSL(U);return this.setHSL(U.h+a,U.s+c,U.l+e)}add(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this}addColors(a,c){this.r=a.r+c.r;this.g=a.g+c.g;this.b=a.b+c.b;return this}addScalar(a){this.r+=a;this.g+=a;this.b+=a;return this}sub(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);this.b=Math.max(0,this.b-a.b);return this}multiply(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this}multiplyScalar(a){this.r*=
a;this.g*=a;this.b*=a;return this}lerp(a,c){this.r+=(a.r-this.r)*c;this.g+=(a.g-this.g)*c;this.b+=(a.b-this.b)*c;return this}lerpColors(a,c,e){this.r=a.r+(c.r-a.r)*e;this.g=a.g+(c.g-a.g)*e;this.b=a.b+(c.b-a.b)*e;return this}lerpHSL(a,c){this.getHSL(U);a.getHSL(ea);a=M(U.h,ea.h,c);const e=M(U.s,ea.s,c);c=M(U.l,ea.l,c);this.setHSL(a,e,c);return this}setFromVector3(a){this.r=a.x;this.g=a.y;this.b=a.z;return this}applyMatrix3(a){const c=this.r,e=this.g,h=this.b;a=a.elements;this.r=a[0]*c+a[3]*e+a[6]*
h;this.g=a[1]*c+a[4]*e+a[7]*h;this.b=a[2]*c+a[5]*e+a[8]*h;return this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,c=0){this.r=a[c];this.g=a[c+1];this.b=a[c+2];return this}toArray(a=[],c=0){a[c]=this.r;a[c+1]=this.g;a[c+2]=this.b;return a}fromBufferAttribute(a,c){this.r=a.getX(c);this.g=a.getY(c);this.b=a.getZ(c);return this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r;yield this.g;yield this.b}}const va=new ia;ia.NAMES=N;let Ga=0;class Sa extends Bf{constructor(){super();
this.isMaterial=!0;Object.defineProperty(this,"id",{value:Ga++});this.uuid=Na();this.name="";this.type="Material";this.blending=1;this.side=0;this.vertexColors=!1;this.opacity=1;this.alphaHash=this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.blendColor=new ia(0,0,0);this.blendAlpha=0;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.stencilWriteMask=255;this.stencilFunc=519;this.stencilRef=
0;this.stencilFuncMask=255;this.stencilZPass=this.stencilZFail=this.stencilFail=7680;this.stencilWrite=!1;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.forceSinglePass=this.premultipliedAlpha=this.alphaToCoverage=this.dithering=!1;this.toneMapped=this.visible=!0;this.userData={};this._alphaTest=this.version=0}get alphaTest(){return this._alphaTest}set alphaTest(a){0<
this._alphaTest!==0<a&&this.version++;this._alphaTest=a}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(const c in a){const e=a[c];if(void 0===e){console.warn(`THREE.Material: parameter '${c}' has value of undefined.`);continue}const h=this[c];void 0===h?console.warn(`THREE.Material: '${c}' is not a property of THREE.${this.type}.`):h&&h.isColor?h.set(e):h&&h.isVector3&&e&&e.isVector3?h.copy(e):this[c]=e}}toJSON(a){function c(l){const p=
[];for(const w in l){const x=l[w];delete x.metadata;p.push(x)}return p}var e=void 0===a||"string"===typeof a;e&&(a={textures:{},images:{}});const h={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};h.uuid=this.uuid;h.type=this.type;""!==this.name&&(h.name=this.name);this.color&&this.color.isColor&&(h.color=this.color.getHex());void 0!==this.roughness&&(h.roughness=this.roughness);void 0!==this.metalness&&(h.metalness=this.metalness);void 0!==this.sheen&&(h.sheen=this.sheen);this.sheenColor&&
this.sheenColor.isColor&&(h.sheenColor=this.sheenColor.getHex());void 0!==this.sheenRoughness&&(h.sheenRoughness=this.sheenRoughness);this.emissive&&this.emissive.isColor&&(h.emissive=this.emissive.getHex());void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(h.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(h.specular=this.specular.getHex());void 0!==this.specularIntensity&&(h.specularIntensity=this.specularIntensity);this.specularColor&&this.specularColor.isColor&&
(h.specularColor=this.specularColor.getHex());void 0!==this.shininess&&(h.shininess=this.shininess);void 0!==this.clearcoat&&(h.clearcoat=this.clearcoat);void 0!==this.clearcoatRoughness&&(h.clearcoatRoughness=this.clearcoatRoughness);this.clearcoatMap&&this.clearcoatMap.isTexture&&(h.clearcoatMap=this.clearcoatMap.toJSON(a).uuid);this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(h.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid);this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&
(h.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,h.clearcoatNormalScale=this.clearcoatNormalScale.toArray());void 0!==this.dispersion&&(h.dispersion=this.dispersion);void 0!==this.iridescence&&(h.iridescence=this.iridescence);void 0!==this.iridescenceIOR&&(h.iridescenceIOR=this.iridescenceIOR);void 0!==this.iridescenceThicknessRange&&(h.iridescenceThicknessRange=this.iridescenceThicknessRange);this.iridescenceMap&&this.iridescenceMap.isTexture&&(h.iridescenceMap=this.iridescenceMap.toJSON(a).uuid);
this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(h.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid);void 0!==this.anisotropy&&(h.anisotropy=this.anisotropy);void 0!==this.anisotropyRotation&&(h.anisotropyRotation=this.anisotropyRotation);this.anisotropyMap&&this.anisotropyMap.isTexture&&(h.anisotropyMap=this.anisotropyMap.toJSON(a).uuid);this.map&&this.map.isTexture&&(h.map=this.map.toJSON(a).uuid);this.matcap&&this.matcap.isTexture&&(h.matcap=this.matcap.toJSON(a).uuid);
this.alphaMap&&this.alphaMap.isTexture&&(h.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(h.lightMap=this.lightMap.toJSON(a).uuid,h.lightMapIntensity=this.lightMapIntensity);this.aoMap&&this.aoMap.isTexture&&(h.aoMap=this.aoMap.toJSON(a).uuid,h.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(h.bumpMap=this.bumpMap.toJSON(a).uuid,h.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(h.normalMap=this.normalMap.toJSON(a).uuid,
h.normalMapType=this.normalMapType,h.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(h.displacementMap=this.displacementMap.toJSON(a).uuid,h.displacementScale=this.displacementScale,h.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(h.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(h.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&
(h.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(h.specularMap=this.specularMap.toJSON(a).uuid);this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(h.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid);this.specularColorMap&&this.specularColorMap.isTexture&&(h.specularColorMap=this.specularColorMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&(h.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(h.combine=this.combine));
void 0!==this.envMapRotation&&(h.envMapRotation=this.envMapRotation.toArray());void 0!==this.envMapIntensity&&(h.envMapIntensity=this.envMapIntensity);void 0!==this.reflectivity&&(h.reflectivity=this.reflectivity);void 0!==this.refractionRatio&&(h.refractionRatio=this.refractionRatio);this.gradientMap&&this.gradientMap.isTexture&&(h.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.transmission&&(h.transmission=this.transmission);this.transmissionMap&&this.transmissionMap.isTexture&&(h.transmissionMap=
this.transmissionMap.toJSON(a).uuid);void 0!==this.thickness&&(h.thickness=this.thickness);this.thicknessMap&&this.thicknessMap.isTexture&&(h.thicknessMap=this.thicknessMap.toJSON(a).uuid);void 0!==this.attenuationDistance&&Infinity!==this.attenuationDistance&&(h.attenuationDistance=this.attenuationDistance);void 0!==this.attenuationColor&&(h.attenuationColor=this.attenuationColor.getHex());void 0!==this.size&&(h.size=this.size);null!==this.shadowSide&&(h.shadowSide=this.shadowSide);void 0!==this.sizeAttenuation&&
(h.sizeAttenuation=this.sizeAttenuation);1!==this.blending&&(h.blending=this.blending);0!==this.side&&(h.side=this.side);!0===this.vertexColors&&(h.vertexColors=!0);1>this.opacity&&(h.opacity=this.opacity);!0===this.transparent&&(h.transparent=!0);204!==this.blendSrc&&(h.blendSrc=this.blendSrc);205!==this.blendDst&&(h.blendDst=this.blendDst);100!==this.blendEquation&&(h.blendEquation=this.blendEquation);null!==this.blendSrcAlpha&&(h.blendSrcAlpha=this.blendSrcAlpha);null!==this.blendDstAlpha&&(h.blendDstAlpha=
this.blendDstAlpha);null!==this.blendEquationAlpha&&(h.blendEquationAlpha=this.blendEquationAlpha);this.blendColor&&this.blendColor.isColor&&(h.blendColor=this.blendColor.getHex());0!==this.blendAlpha&&(h.blendAlpha=this.blendAlpha);3!==this.depthFunc&&(h.depthFunc=this.depthFunc);!1===this.depthTest&&(h.depthTest=this.depthTest);!1===this.depthWrite&&(h.depthWrite=this.depthWrite);!1===this.colorWrite&&(h.colorWrite=this.colorWrite);255!==this.stencilWriteMask&&(h.stencilWriteMask=this.stencilWriteMask);
519!==this.stencilFunc&&(h.stencilFunc=this.stencilFunc);0!==this.stencilRef&&(h.stencilRef=this.stencilRef);255!==this.stencilFuncMask&&(h.stencilFuncMask=this.stencilFuncMask);7680!==this.stencilFail&&(h.stencilFail=this.stencilFail);7680!==this.stencilZFail&&(h.stencilZFail=this.stencilZFail);7680!==this.stencilZPass&&(h.stencilZPass=this.stencilZPass);!0===this.stencilWrite&&(h.stencilWrite=this.stencilWrite);void 0!==this.rotation&&0!==this.rotation&&(h.rotation=this.rotation);!0===this.polygonOffset&&
(h.polygonOffset=!0);0!==this.polygonOffsetFactor&&(h.polygonOffsetFactor=this.polygonOffsetFactor);0!==this.polygonOffsetUnits&&(h.polygonOffsetUnits=this.polygonOffsetUnits);void 0!==this.linewidth&&1!==this.linewidth&&(h.linewidth=this.linewidth);void 0!==this.dashSize&&(h.dashSize=this.dashSize);void 0!==this.gapSize&&(h.gapSize=this.gapSize);void 0!==this.scale&&(h.scale=this.scale);!0===this.dithering&&(h.dithering=!0);0<this.alphaTest&&(h.alphaTest=this.alphaTest);!0===this.alphaHash&&(h.alphaHash=
!0);!0===this.alphaToCoverage&&(h.alphaToCoverage=!0);!0===this.premultipliedAlpha&&(h.premultipliedAlpha=!0);!0===this.forceSinglePass&&(h.forceSinglePass=!0);!0===this.wireframe&&(h.wireframe=!0);1<this.wireframeLinewidth&&(h.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(h.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(h.wireframeLinejoin=this.wireframeLinejoin);!0===this.flatShading&&(h.flatShading=!0);!1===this.visible&&(h.visible=!1);
!1===this.toneMapped&&(h.toneMapped=!1);!1===this.fog&&(h.fog=!1);0<Object.keys(this.userData).length&&(h.userData=this.userData);e&&(e=c(a.textures),a=c(a.images),0<e.length&&(h.textures=e),0<a.length&&(h.images=a));return h}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.blending=a.blending;this.side=a.side;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;
this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.blendColor.copy(a.blendColor);this.blendAlpha=a.blendAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.stencilWriteMask=a.stencilWriteMask;this.stencilFunc=a.stencilFunc;this.stencilRef=a.stencilRef;this.stencilFuncMask=a.stencilFuncMask;this.stencilFail=a.stencilFail;this.stencilZFail=a.stencilZFail;this.stencilZPass=a.stencilZPass;this.stencilWrite=
a.stencilWrite;const c=a.clippingPlanes;let e=null;if(null!==c){const h=c.length;e=Array(h);for(let l=0;l!==h;++l)e[l]=c[l].clone()}this.clippingPlanes=e;this.clipIntersection=a.clipIntersection;this.clipShadows=a.clipShadows;this.shadowSide=a.shadowSide;this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.alphaHash=
a.alphaHash;this.alphaToCoverage=a.alphaToCoverage;this.premultipliedAlpha=a.premultipliedAlpha;this.forceSinglePass=a.forceSinglePass;this.visible=a.visible;this.toneMapped=a.toneMapped;this.userData=JSON.parse(JSON.stringify(a.userData));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ab extends Sa{constructor(a){super();this.isMeshBasicMaterial=!0;this.type="MeshBasicMaterial";
this.color=new ia(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Qg;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;
this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.fog=a.fog;return this}}const Qb=function(){var a=new ArrayBuffer(4);const c=
new Float32Array(a);a=new Uint32Array(a);const e=new Uint32Array(512),h=new Uint32Array(512);for(var l=0;256>l;++l){var p=l-127;-27>p?(e[l]=0,e[l|256]=32768,h[l]=24,h[l|256]=24):-14>p?(e[l]=1024>>-p-14,e[l|256]=1024>>-p-14|32768,h[l]=-p-1,h[l|256]=-p-1):15>=p?(e[l]=p+15<<10,e[l|256]=p+15<<10|32768,h[l]=13,h[l|256]=13):128>p?(e[l]=31744,e[l|256]=64512,h[l]=24,h[l|256]=24):(e[l]=31744,e[l|256]=64512,h[l]=13,h[l|256]=13)}l=new Uint32Array(2048);p=new Uint32Array(64);const w=new Uint32Array(64);for(var x=
1;1024>x;++x){let y=x<<13,D=0;for(;0===(y&8388608);)y<<=1,D-=8388608;y&=-8388609;D+=947912704;l[x]=y|D}for(x=1024;2048>x;++x)l[x]=939524096+(x-1024<<13);for(x=1;31>x;++x)p[x]=x<<23;p[31]=1199570944;p[32]=2147483648;for(x=33;63>x;++x)p[x]=2147483648+(x-32<<23);p[63]=3347054592;for(x=1;64>x;++x)32!==x&&(w[x]=1024);return{floatView:c,uint32View:a,baseTable:e,shiftTable:h,mantissaTable:l,exponentTable:p,offsetTable:w}}(),ic={toHalfFloat:Ib,fromHalfFloat:Fb},Vb=new Da,Sc=new Lb;class mc{constructor(a,
c,e=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0;this.name="";this.array=a;this.itemSize=c;this.count=void 0!==a?a.length/c:0;this.normalized=e;this.usage=35044;this.updateRanges=[];this.gpuType=1015;this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){this.usage=a;return this}addUpdateRange(a,c){this.updateRanges.push({start:a,count:c})}clearUpdateRanges(){this.updateRanges.length=
0}copy(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.usage=a.usage;this.gpuType=a.gpuType;return this}copyAt(a,c,e){a*=this.itemSize;e*=c.itemSize;for(let h=0,l=this.itemSize;h<l;h++)this.array[a+h]=c.array[e+h];return this}copyArray(a){this.array.set(a);return this}applyMatrix3(a){if(2===this.itemSize)for(let c=0,e=this.count;c<e;c++)Sc.fromBufferAttribute(this,c),Sc.applyMatrix3(a),this.setXY(c,Sc.x,
Sc.y);else if(3===this.itemSize)for(let c=0,e=this.count;c<e;c++)Vb.fromBufferAttribute(this,c),Vb.applyMatrix3(a),this.setXYZ(c,Vb.x,Vb.y,Vb.z);return this}applyMatrix4(a){for(let c=0,e=this.count;c<e;c++)Vb.fromBufferAttribute(this,c),Vb.applyMatrix4(a),this.setXYZ(c,Vb.x,Vb.y,Vb.z);return this}applyNormalMatrix(a){for(let c=0,e=this.count;c<e;c++)Vb.fromBufferAttribute(this,c),Vb.applyNormalMatrix(a),this.setXYZ(c,Vb.x,Vb.y,Vb.z);return this}transformDirection(a){for(let c=0,e=this.count;c<e;c++)Vb.fromBufferAttribute(this,
c),Vb.transformDirection(a),this.setXYZ(c,Vb.x,Vb.y,Vb.z);return this}set(a,c=0){this.array.set(a,c);return this}getComponent(a,c){a=this.array[a*this.itemSize+c];this.normalized&&(a=v(a,this.array));return a}setComponent(a,c,e){this.normalized&&(e=ta(e,this.array));this.array[a*this.itemSize+c]=e;return this}getX(a){a=this.array[a*this.itemSize];this.normalized&&(a=v(a,this.array));return a}setX(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize]=c;return this}getY(a){a=this.array[a*
this.itemSize+1];this.normalized&&(a=v(a,this.array));return a}setY(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+1]=c;return this}getZ(a){a=this.array[a*this.itemSize+2];this.normalized&&(a=v(a,this.array));return a}setZ(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+2]=c;return this}getW(a){a=this.array[a*this.itemSize+3];this.normalized&&(a=v(a,this.array));return a}setW(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+3]=c;return this}setXY(a,
c,e){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array));this.array[a+0]=c;this.array[a+1]=e;return this}setXYZ(a,c,e,h){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array));this.array[a+0]=c;this.array[a+1]=e;this.array[a+2]=h;return this}setXYZW(a,c,e,h,l){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array),l=ta(l,this.array));this.array[a+0]=c;this.array[a+1]=e;this.array[a+2]=h;this.array[a+3]=
l;return this}onUpload(a){this.onUploadCallback=a;return this}clone(){return(new this.constructor(this.array,this.itemSize)).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};""!==this.name&&(a.name=this.name);35044!==this.usage&&(a.usage=this.usage);return a}}class xd extends mc{constructor(a,c,e){super(new Int8Array(a),c,e)}}class Sg extends mc{constructor(a,c,e){super(new Uint8Array(a),c,e)}}class If extends mc{constructor(a,
c,e){super(new Uint8ClampedArray(a),c,e)}}class Fj extends mc{constructor(a,c,e){super(new Int16Array(a),c,e)}}class mf extends mc{constructor(a,c,e){super(new Uint16Array(a),c,e)}}class Rf extends mc{constructor(a,c,e){super(new Int32Array(a),c,e)}}class ij extends mc{constructor(a,c,e){super(new Uint32Array(a),c,e)}}class Ug extends mc{constructor(a,c,e){super(new Uint16Array(a),c,e);this.isFloat16BufferAttribute=!0}getX(a){a=Fb(this.array[a*this.itemSize]);this.normalized&&(a=v(a,this.array));
return a}setX(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize]=Ib(c);return this}getY(a){a=Fb(this.array[a*this.itemSize+1]);this.normalized&&(a=v(a,this.array));return a}setY(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+1]=Ib(c);return this}getZ(a){a=Fb(this.array[a*this.itemSize+2]);this.normalized&&(a=v(a,this.array));return a}setZ(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+2]=Ib(c);return this}getW(a){a=Fb(this.array[a*
this.itemSize+3]);this.normalized&&(a=v(a,this.array));return a}setW(a,c){this.normalized&&(c=ta(c,this.array));this.array[a*this.itemSize+3]=Ib(c);return this}setXY(a,c,e){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array));this.array[a+0]=Ib(c);this.array[a+1]=Ib(e);return this}setXYZ(a,c,e,h){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array));this.array[a+0]=Ib(c);this.array[a+1]=Ib(e);this.array[a+2]=Ib(h);return this}setXYZW(a,c,
e,h,l){a*=this.itemSize;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array),l=ta(l,this.array));this.array[a+0]=Ib(c);this.array[a+1]=Ib(e);this.array[a+2]=Ib(h);this.array[a+3]=Ib(l);return this}}class Mc extends mc{constructor(a,c,e){super(new Float32Array(a),c,e)}}let Jk=0;const Vg=new Wc,rl=new Nd,ji=new Da,ve=new fe,fg=new fe,Xd=new Da;class Xc extends Bf{constructor(){super();this.isBufferGeometry=!0;Object.defineProperty(this,"id",{value:Jk++});this.uuid=Na();this.name=
"";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=!1;this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}getIndex(){return this.index}setIndex(a){Array.isArray(a)?this.index=new (Va(a)?ij:mf)(a,1):this.index=a;return this}getAttribute(a){return this.attributes[a]}setAttribute(a,c){this.attributes[a]=c;return this}deleteAttribute(a){delete this.attributes[a];return this}hasAttribute(a){return void 0!==
this.attributes[a]}addGroup(a,c,e=0){this.groups.push({start:a,count:c,materialIndex:e})}clearGroups(){this.groups=[]}setDrawRange(a,c){this.drawRange.start=a;this.drawRange.count=c}applyMatrix4(a){var c=this.attributes.position;void 0!==c&&(c.applyMatrix4(a),c.needsUpdate=!0);c=this.attributes.normal;if(void 0!==c){const e=(new nd).getNormalMatrix(a);c.applyNormalMatrix(e);c.needsUpdate=!0}c=this.attributes.tangent;void 0!==c&&(c.transformDirection(a),c.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();
null!==this.boundingSphere&&this.computeBoundingSphere();return this}applyQuaternion(a){Vg.makeRotationFromQuaternion(a);this.applyMatrix4(Vg);return this}rotateX(a){Vg.makeRotationX(a);this.applyMatrix4(Vg);return this}rotateY(a){Vg.makeRotationY(a);this.applyMatrix4(Vg);return this}rotateZ(a){Vg.makeRotationZ(a);this.applyMatrix4(Vg);return this}translate(a,c,e){Vg.makeTranslation(a,c,e);this.applyMatrix4(Vg);return this}scale(a,c,e){Vg.makeScale(a,c,e);this.applyMatrix4(Vg);return this}lookAt(a){rl.lookAt(a);
rl.updateMatrix();this.applyMatrix4(rl.matrix);return this}center(){this.computeBoundingBox();this.boundingBox.getCenter(ji).negate();this.translate(ji.x,ji.y,ji.z);return this}setFromPoints(a){const c=[];for(let e=0,h=a.length;e<h;e++){const l=a[e];c.push(l.x,l.y,l.z||0)}this.setAttribute("position",new Mc(c,3));return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fe);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",
this),this.boundingBox.set(new Da(-Infinity,-Infinity,-Infinity),new Da(Infinity,Infinity,Infinity));else{if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),c)for(let e=0,h=c.length;e<h;e++)ve.setFromBufferAttribute(c[e]),this.morphTargetsRelative?(Xd.addVectors(this.boundingBox.min,ve.min),this.boundingBox.expandByPoint(Xd),Xd.addVectors(this.boundingBox.max,ve.max),this.boundingBox.expandByPoint(Xd)):(this.boundingBox.expandByPoint(ve.min),this.boundingBox.expandByPoint(ve.max))}else this.boundingBox.makeEmpty();
(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $e);const a=this.attributes.position,c=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",
this),this.boundingSphere.set(new Da,Infinity);else if(a){const e=this.boundingSphere.center;ve.setFromBufferAttribute(a);if(c)for(let l=0,p=c.length;l<p;l++)fg.setFromBufferAttribute(c[l]),this.morphTargetsRelative?(Xd.addVectors(ve.min,fg.min),ve.expandByPoint(Xd),Xd.addVectors(ve.max,fg.max),ve.expandByPoint(Xd)):(ve.expandByPoint(fg.min),ve.expandByPoint(fg.max));ve.getCenter(e);let h=0;for(let l=0,p=a.count;l<p;l++)Xd.fromBufferAttribute(a,l),h=Math.max(h,e.distanceToSquared(Xd));if(c)for(let l=
0,p=c.length;l<p;l++){const w=c[l],x=this.morphTargetsRelative;for(let y=0,D=w.count;y<D;y++)Xd.fromBufferAttribute(w,y),x&&(ji.fromBufferAttribute(a,y),Xd.add(ji)),h=Math.max(h,e.distanceToSquared(Xd))}this.boundingSphere.radius=Math.sqrt(h);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){function a(Ja,Ka,lb){H.fromBufferAttribute(l,Ja);I.fromBufferAttribute(l,
Ka);L.fromBufferAttribute(l,lb);Y.fromBufferAttribute(w,Ja);P.fromBufferAttribute(w,Ka);Z.fromBufferAttribute(w,lb);I.sub(H);L.sub(H);P.sub(Y);Z.sub(Y);const wb=1/(P.x*Z.y-Z.x*P.y);isFinite(wb)&&(aa.copy(I).multiplyScalar(Z.y).addScaledVector(L,-P.y).multiplyScalar(wb),T.copy(L).multiplyScalar(P.x).addScaledVector(I,-Z.x).multiplyScalar(wb),y[Ja].add(aa),y[Ka].add(aa),y[lb].add(aa),D[Ja].add(T),D[Ka].add(T),D[lb].add(T))}function c(Ja){Fa.fromBufferAttribute(p,Ja);Ra.copy(Fa);var Ka=y[Ja];xa.copy(Ka);
xa.sub(Fa.multiplyScalar(Fa.dot(Ka))).normalize();Ha.crossVectors(Ra,Ka);Ka=Ha.dot(D[Ja]);x.setXYZW(Ja,xa.x,xa.y,xa.z,0>Ka?-1:1)}const e=this.index;var h=this.attributes;if(null===e||void 0===h.position||void 0===h.normal||void 0===h.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{var l=h.position,p=h.normal,w=h.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new mc(new Float32Array(4*l.count),
4));var x=this.getAttribute("tangent"),y=[],D=[];for(h=0;h<l.count;h++)y[h]=new Da,D[h]=new Da;var H=new Da,I=new Da,L=new Da,Y=new Lb,P=new Lb,Z=new Lb,aa=new Da,T=new Da;h=this.groups;0===h.length&&(h=[{start:0,count:e.count}]);for(let Ja=0,Ka=h.length;Ja<Ka;++Ja){var ha=h[Ja],Ca=ha.start;ha=ha.count;for(let lb=Ca,wb=Ca+ha;lb<wb;lb+=3)a(e.getX(lb+0),e.getX(lb+1),e.getX(lb+2))}var xa=new Da,Ha=new Da,Fa=new Da,Ra=new Da;for(let Ja=0,Ka=h.length;Ja<Ka;++Ja){ha=h[Ja];Ca=ha.start;ha=ha.count;for(let lb=
Ca,wb=Ca+ha;lb<wb;lb+=3)c(e.getX(lb+0)),c(e.getX(lb+1)),c(e.getX(lb+2))}}}computeVertexNormals(){const a=this.index,c=this.getAttribute("position");if(void 0!==c){let e=this.getAttribute("normal");if(void 0===e)e=new mc(new Float32Array(3*c.count),3),this.setAttribute("normal",e);else for(let I=0,L=e.count;I<L;I++)e.setXYZ(I,0,0,0);const h=new Da,l=new Da,p=new Da,w=new Da,x=new Da,y=new Da,D=new Da,H=new Da;if(a)for(let I=0,L=a.count;I<L;I+=3){const Y=a.getX(I+0),P=a.getX(I+1),Z=a.getX(I+2);h.fromBufferAttribute(c,
Y);l.fromBufferAttribute(c,P);p.fromBufferAttribute(c,Z);D.subVectors(p,l);H.subVectors(h,l);D.cross(H);w.fromBufferAttribute(e,Y);x.fromBufferAttribute(e,P);y.fromBufferAttribute(e,Z);w.add(D);x.add(D);y.add(D);e.setXYZ(Y,w.x,w.y,w.z);e.setXYZ(P,x.x,x.y,x.z);e.setXYZ(Z,y.x,y.y,y.z)}else for(let I=0,L=c.count;I<L;I+=3)h.fromBufferAttribute(c,I+0),l.fromBufferAttribute(c,I+1),p.fromBufferAttribute(c,I+2),D.subVectors(p,l),H.subVectors(h,l),D.cross(H),e.setXYZ(I+0,D.x,D.y,D.z),e.setXYZ(I+1,D.x,D.y,
D.z),e.setXYZ(I+2,D.x,D.y,D.z);this.normalizeNormals();e.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let c=0,e=a.count;c<e;c++)Xd.fromBufferAttribute(a,c),Xd.normalize(),a.setXYZ(c,Xd.x,Xd.y,Xd.z)}toNonIndexed(){function a(x,y){const D=x.array,H=x.itemSize,I=x.normalized,L=new D.constructor(y.length*H);let Y,P=0;for(let Z=0,aa=y.length;Z<aa;Z++){Y=x.isInterleavedBufferAttribute?y[Z]*x.data.stride+x.offset:y[Z]*H;for(let T=0;T<H;T++)L[P++]=D[Y++]}return new mc(L,H,I)}if(null===
this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new Xc;var e=this.index.array,h=this.attributes;for(var l in h){var p=a(h[l],e);c.setAttribute(l,p)}h=this.morphAttributes;for(var w in h){l=[];p=h[w];for(let x=0,y=p.length;x<y;x++){const D=a(p[x],e);l.push(D)}c.morphAttributes[w]=l}c.morphTargetsRelative=this.morphTargetsRelative;e=this.groups;for(let x=0,y=e.length;x<y;x++)w=e[x],c.addGroup(w.start,w.count,w.materialIndex);
return c}toJSON(){const a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var c=this.parameters;for(var e in c)void 0!==c[e]&&(a[e]=c[e]);return a}a.data={attributes:{}};e=this.index;null!==e&&(a.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});e=this.attributes;for(var h in e)a.data.attributes[h]=
e[h].toJSON(a.data);h={};e=!1;for(c in this.morphAttributes){const l=this.morphAttributes[c],p=[];for(let w=0,x=l.length;w<x;w++)p.push(l[w].toJSON(a.data));0<p.length&&(h[c]=p,e=!0)}e&&(a.data.morphAttributes=h,a.data.morphTargetsRelative=this.morphTargetsRelative);c=this.groups;0<c.length&&(a.data.groups=JSON.parse(JSON.stringify(c)));c=this.boundingSphere;null!==c&&(a.data.boundingSphere={center:c.center.toArray(),radius:c.radius});return a}clone(){return(new this.constructor).copy(this)}copy(a){this.index=
null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;var c={};this.name=a.name;var e=a.index;null!==e&&this.setIndex(e.clone(c));e=a.attributes;for(var h in e)this.setAttribute(h,e[h].clone(c));h=a.morphAttributes;for(var l in h){e=[];const p=h[l];for(let w=0,x=p.length;w<x;w++)e.push(p[w].clone(c));this.morphAttributes[l]=e}this.morphTargetsRelative=a.morphTargetsRelative;c=a.groups;for(let p=0,w=c.length;p<w;p++)l=c[p],this.addGroup(l.start,l.count,
l.materialIndex);c=a.boundingBox;null!==c&&(this.boundingBox=c.clone());c=a.boundingSphere;null!==c&&(this.boundingSphere=c.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;return this}dispose(){this.dispatchEvent({type:"dispose"})}}const tm=new Wc,Ri=new wh,Oi=new $e,um=new Da,gh=new Da,dk=new Da,jj=new Da,ni=new Da,Pi=new Da,mi=new Da,Mk=new Da;class nf extends Nd{constructor(a=new Xc,c=new ab){super();this.isMesh=!0;this.type="Mesh";
this.geometry=a;this.material=c;this.updateMorphTargets()}copy(a,c){super.copy(a,c);void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}updateMorphTargets(){var a=this.geometry.morphAttributes,c=Object.keys(a);if(0<c.length&&(a=a[c[0]],void 0!==a)){this.morphTargetInfluences=
[];this.morphTargetDictionary={};for(let e=0,h=a.length;e<h;e++)c=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=e}}getVertexPosition(a,c){var e=this.geometry;const h=e.morphAttributes.position,l=e.morphTargetsRelative;c.fromBufferAttribute(e.attributes.position,a);e=this.morphTargetInfluences;if(h&&e){Pi.set(0,0,0);for(let p=0,w=h.length;p<w;p++){const x=e[p];0!==x&&(ni.fromBufferAttribute(h[p],a),l?Pi.addScaledVector(ni,x):Pi.addScaledVector(ni.sub(c),x))}c.add(Pi)}return c}raycast(a,
c){const e=this.geometry,h=this.matrixWorld;void 0!==this.material&&(null===e.boundingSphere&&e.computeBoundingSphere(),Oi.copy(e.boundingSphere),Oi.applyMatrix4(h),Ri.copy(a.ray).recast(a.near),!1===Oi.containsPoint(Ri.origin)&&(null===Ri.intersectSphere(Oi,um)||Ri.origin.distanceToSquared(um)>(a.far-a.near)**2)||(tm.copy(h).invert(),Ri.copy(a.ray).applyMatrix4(tm),null!==e.boundingBox&&!1===Ri.intersectsBox(e.boundingBox)||this._computeIntersections(a,c,Ri)))}_computeIntersections(a,c,e){var h=
this.geometry;const l=this.material;var p=h.index,w=h.attributes.position;const x=h.attributes.uv,y=h.attributes.uv1,D=h.attributes.normal;var H=h.groups;h=h.drawRange;if(null!==p)if(Array.isArray(l))for(let P=0,Z=H.length;P<Z;P++){w=H[P];var I=l[w.materialIndex];var L=Math.max(w.start,h.start);var Y=Math.min(p.count,Math.min(w.start+w.count,h.start+h.count));for(let aa=L,T=Y;aa<T;aa+=3){L=p.getX(aa);Y=p.getX(aa+1);const ha=p.getX(aa+2);if(L=zb(this,I,a,e,x,y,D,L,Y,ha))L.faceIndex=Math.floor(aa/3),
L.face.materialIndex=w.materialIndex,c.push(L)}}else{H=Math.max(0,h.start);h=Math.min(p.count,h.start+h.count);for(let P=H,Z=h;P<Z;P+=3)if(h=p.getX(P),H=p.getX(P+1),w=p.getX(P+2),L=zb(this,l,a,e,x,y,D,h,H,w))L.faceIndex=Math.floor(P/3),c.push(L)}else if(void 0!==w)if(Array.isArray(l))for(let P=0,Z=H.length;P<Z;P++){p=H[P];I=l[p.materialIndex];L=Math.max(p.start,h.start);Y=Math.min(w.count,Math.min(p.start+p.count,h.start+h.count));for(let aa=L,T=Y;aa<T;aa+=3)if(L=zb(this,I,a,e,x,y,D,aa,aa+1,aa+2))L.faceIndex=
Math.floor(aa/3),L.face.materialIndex=p.materialIndex,c.push(L)}else{p=Math.max(0,h.start);h=Math.min(w.count,h.start+h.count);for(let P=p,Z=h;P<Z;P+=3)if(L=zb(this,l,a,e,x,y,D,P,P+1,P+2))L.faceIndex=Math.floor(P/3),c.push(L)}}}class zh extends Xc{constructor(a=1,c=1,e=1,h=1,l=1,p=1){function w(P,Z,aa,T,ha,Ca,xa,Ha,Fa,Ra,Ja){const Ka=Ca/Fa,lb=xa/Ra,wb=Ca/2,Mb=xa/2,kb=Ha/2;xa=Fa+1;const jc=Ra+1;let Wb=Ca=0;const Xb=new Da;for(let ad=0;ad<jc;ad++){const wc=ad*lb-Mb;for(let Tb=0;Tb<xa;Tb++)Xb[P]=(Tb*
Ka-wb)*T,Xb[Z]=wc*ha,Xb[aa]=kb,D.push(Xb.x,Xb.y,Xb.z),Xb[P]=0,Xb[Z]=0,Xb[aa]=0<Ha?1:-1,H.push(Xb.x,Xb.y,Xb.z),I.push(Tb/Fa),I.push(1-ad/Ra),Ca+=1}for(P=0;P<Ra;P++)for(Z=0;Z<Fa;Z++)aa=L+Z+xa*(P+1),T=L+(Z+1)+xa*(P+1),ha=L+(Z+1)+xa*P,y.push(L+Z+xa*P,aa,ha),y.push(aa,T,ha),Wb+=6;x.addGroup(Y,Wb,Ja);Y+=Wb;L+=Ca}super();this.type="BoxGeometry";this.parameters={width:a,height:c,depth:e,widthSegments:h,heightSegments:l,depthSegments:p};const x=this;h=Math.floor(h);l=Math.floor(l);p=Math.floor(p);const y=
[],D=[],H=[],I=[];let L=0,Y=0;w("z","y","x",-1,-1,e,c,a,p,l,0);w("z","y","x",1,-1,e,c,-a,p,l,1);w("x","z","y",1,1,a,e,c,h,p,2);w("x","z","y",1,-1,a,e,-c,h,p,3);w("x","y","z",1,-1,a,c,e,h,l,4);w("x","y","z",-1,-1,a,c,-e,h,l,5);this.setIndex(y);this.setAttribute("position",new Mc(D,3));this.setAttribute("normal",new Mc(H,3));this.setAttribute("uv",new Mc(I,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new zh(a.width,a.height,a.depth,a.widthSegments,
a.heightSegments,a.depthSegments)}}const Lk={clone:lc,merge:bc};class ih extends Sa{constructor(a){super();this.isShaderMaterial=!0;this.type="ShaderMaterial";this.defines={};this.uniforms={};this.uniformsGroups=[];this.vertexShader="void main() {\n\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor \x3d vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.clipping=this.lights=
this.fog=!1;this.forceSinglePass=!0;this.extensions={clipCullDistance:!1,multiDraw:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.glslVersion=null;void 0!==a&&this.setValues(a)}copy(a){super.copy(a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=lc(a.uniforms);var c=a.uniformsGroups;const e=[];for(let h=0;h<c.length;h++)e.push(c[h].clone());this.uniformsGroups=e;this.defines=Object.assign({},
a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.fog=a.fog;this.lights=a.lights;this.clipping=a.clipping;this.extensions=Object.assign({},a.extensions);this.glslVersion=a.glslVersion;return this}toJSON(a){const c=super.toJSON(a);c.glslVersion=this.glslVersion;c.uniforms={};for(const e in this.uniforms){const h=this.uniforms[e].value;c.uniforms[e]=h&&h.isTexture?{type:"t",value:h.toJSON(a).uuid}:h&&h.isColor?{type:"c",value:h.getHex()}:h&&h.isVector2?{type:"v2",
value:h.toArray()}:h&&h.isVector3?{type:"v3",value:h.toArray()}:h&&h.isVector4?{type:"v4",value:h.toArray()}:h&&h.isMatrix3?{type:"m3",value:h.toArray()}:h&&h.isMatrix4?{type:"m4",value:h.toArray()}:{value:h}}0<Object.keys(this.defines).length&&(c.defines=this.defines);c.vertexShader=this.vertexShader;c.fragmentShader=this.fragmentShader;c.lights=this.lights;c.clipping=this.clipping;a={};for(const e in this.extensions)!0===this.extensions[e]&&(a[e]=!0);0<Object.keys(a).length&&(c.extensions=a);return c}}
class Jj extends Nd{constructor(){super();this.isCamera=!0;this.type="Camera";this.matrixWorldInverse=new Wc;this.projectionMatrix=new Wc;this.projectionMatrixInverse=new Wc;this.coordinateSystem=2E3}copy(a,c){super.copy(a,c);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);this.projectionMatrixInverse.copy(a.projectionMatrixInverse);this.coordinateSystem=a.coordinateSystem;return this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a);
this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,c){super.updateWorldMatrix(a,c);this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Wg=new Da,Rl=new Lb,li=new Lb;class Sf extends Jj{constructor(a=50,c=1,e=.1,h=2E3){super();this.isPerspectiveCamera=!0;this.type="PerspectiveCamera";this.fov=a;this.zoom=1;this.near=e;this.far=h;this.focus=10;this.aspect=c;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}copy(a,
c){super.copy(a,c);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this}setFocalLength(a){a=.5*this.getFilmHeight()/a;this.fov=2*bh*Math.atan(a);this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(.5*Jg*this.fov);return.5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*bh*Math.atan(Math.tan(.5*Jg*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*
Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,c,e){Wg.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse);c.set(Wg.x,Wg.y).multiplyScalar(-a/Wg.z);Wg.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse);e.set(Wg.x,Wg.y).multiplyScalar(-a/Wg.z)}getViewSize(a,c){this.getViewBounds(a,Rl,li);return c.subVectors(li,Rl)}setViewOffset(a,c,e,h,l,p){this.aspect=a/c;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,
width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=c;this.view.offsetX=e;this.view.offsetY=h;this.view.width=l;this.view.height=p;this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){const a=this.near;let c=a*Math.tan(.5*Jg*this.fov)/this.zoom,e=2*c,h=this.aspect*e,l=-.5*h;var p=this.view;if(null!==this.view&&this.view.enabled){const w=p.fullWidth,x=p.fullHeight;l+=p.offsetX*
h/w;c-=p.offsetY*e/x;h*=p.width/w;e*=p.height/x}p=this.filmOffset;0!==p&&(l+=a*p/this.getFilmWidth());this.projectionMatrix.makePerspective(l,l+h,c,c-e,a,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=
this.filmGauge;a.object.filmOffset=this.filmOffset;return a}}class Je extends Nd{constructor(a,c,e){super();this.type="CubeCamera";this.renderTarget=e;this.coordinateSystem=null;this.activeMipmapLevel=0;e=new Sf(-90,1,a,c);e.layers=this.layers;this.add(e);e=new Sf(-90,1,a,c);e.layers=this.layers;this.add(e);e=new Sf(-90,1,a,c);e.layers=this.layers;this.add(e);e=new Sf(-90,1,a,c);e.layers=this.layers;this.add(e);e=new Sf(-90,1,a,c);e.layers=this.layers;this.add(e);a=new Sf(-90,1,a,c);a.layers=this.layers;
this.add(a)}updateCoordinateSystem(){const a=this.coordinateSystem,c=this.children.concat(),[e,h,l,p,w,x]=c;for(const y of c)this.remove(y);if(2E3===a)e.up.set(0,1,0),e.lookAt(1,0,0),h.up.set(0,1,0),h.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),p.up.set(0,0,1),p.lookAt(0,-1,0),w.up.set(0,1,0),w.lookAt(0,0,1),x.up.set(0,1,0),x.lookAt(0,0,-1);else if(2001===a)e.up.set(0,-1,0),e.lookAt(-1,0,0),h.up.set(0,-1,0),h.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),p.up.set(0,0,-1),p.lookAt(0,-1,0),w.up.set(0,
-1,0),w.lookAt(0,0,1),x.up.set(0,-1,0),x.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(const y of c)this.add(y),y.updateMatrixWorld()}update(a,c){null===this.parent&&this.updateMatrixWorld();const {renderTarget:e,activeMipmapLevel:h}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const [l,p,w,x,y,D]=this.children,H=a.getRenderTarget(),I=a.getActiveCubeFace(),
L=a.getActiveMipmapLevel(),Y=a.xr.enabled;a.xr.enabled=!1;const P=e.texture.generateMipmaps;e.texture.generateMipmaps=!1;a.setRenderTarget(e,0,h);a.render(c,l);a.setRenderTarget(e,1,h);a.render(c,p);a.setRenderTarget(e,2,h);a.render(c,w);a.setRenderTarget(e,3,h);a.render(c,x);a.setRenderTarget(e,4,h);a.render(c,y);e.texture.generateMipmaps=P;a.setRenderTarget(e,5,h);a.render(c,D);a.setRenderTarget(H,I,L);a.xr.enabled=Y;e.texture.needsPMREMUpdate=!0}}class Ck extends Ld{constructor(a,c,e,h,l,p,w,x,
y,D){a=void 0!==a?a:[];super(a,void 0!==c?c:301,e,h,l,p,w,x,y,D);this.isCubeTexture=!0;this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class Kj extends dd{constructor(a=1,c={}){super(a,a,c);this.isWebGLCubeRenderTarget=!0;a={width:a,height:a,depth:1};this.texture=new Ck([a,a,a,a,a,a],c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace);this.texture.isRenderTargetTexture=!0;this.texture.generateMipmaps=void 0!==c.generateMipmaps?c.generateMipmaps:
!1;this.texture.minFilter=void 0!==c.minFilter?c.minFilter:1006}fromEquirectangularTexture(a,c){this.texture.type=c.type;this.texture.colorSpace=c.colorSpace;this.texture.generateMipmaps=c.generateMipmaps;this.texture.minFilter=c.minFilter;this.texture.magFilter=c.magFilter;var e=new zh(5,5,5),h=new ih({name:"CubemapFromEquirect",uniforms:lc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include \x3cbegin_vertex\x3e\n\t\t\t\t\t#include \x3cproject_vertex\x3e\n\n\t\t\t\t}\n\t\t\t",
fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include \x3ccommon\x3e\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction \x3d normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV \x3d equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});h.uniforms.tEquirect.value=c;e=new nf(e,h);h=c.minFilter;1008===c.minFilter&&(c.minFilter=1006);(new Je(1,10,this)).update(a,
e);c.minFilter=h;e.geometry.dispose();e.material.dispose();return this}clear(a,c,e,h){const l=a.getRenderTarget();for(let p=0;6>p;p++)a.setRenderTarget(this,p),a.clear(c,e,h);a.setRenderTarget(l)}}const Fk=new Da,rm=new Da,Nl=new nd;class kj{constructor(a=new Da(1,0,0),c=0){this.isPlane=!0;this.normal=a;this.constant=c}set(a,c){this.normal.copy(a);this.constant=c;return this}setComponents(a,c,e,h){this.normal.set(a,c,e);this.constant=h;return this}setFromNormalAndCoplanarPoint(a,c){this.normal.copy(a);
this.constant=-c.dot(this.normal);return this}setFromCoplanarPoints(a,c,e){c=Fk.subVectors(e,c).cross(rm.subVectors(a,c)).normalize();this.setFromNormalAndCoplanarPoint(c,a);return this}copy(a){this.normal.copy(a.normal);this.constant=a.constant;return this}normalize(){const a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this}negate(){this.constant*=-1;this.normal.negate();return this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-
a.radius}projectPoint(a,c){return c.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,c){const e=a.delta(Fk);var h=this.normal.dot(e);if(0===h)return 0===this.distanceToPoint(a.start)?c.copy(a.start):null;h=-(a.start.dot(this.normal)+this.constant)/h;return 0>h||1<h?null:c.copy(a.start).addScaledVector(e,h)}intersectsLine(a){const c=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>c&&0<a||0>a&&0<c}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,
c){c=c||Nl.getNormalMatrix(a);a=this.coplanarPoint(Fk).applyMatrix4(a);c=this.normal.applyMatrix3(c).normalize();this.constant=-a.dot(c);return this}translate(a){this.constant-=a.dot(this.normal);return this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Of=new $e,Dk=new Da;class fk{constructor(a=new kj,c=new kj,e=new kj,h=new kj,l=new kj,p=new kj){this.planes=[a,c,e,h,l,p]}set(a,c,e,h,l,p){const w=this.planes;w[0].copy(a);
w[1].copy(c);w[2].copy(e);w[3].copy(h);w[4].copy(l);w[5].copy(p);return this}copy(a){const c=this.planes;for(let e=0;6>e;e++)c[e].copy(a.planes[e]);return this}setFromProjectionMatrix(a,c=2E3){const e=this.planes;var h=a.elements;a=h[0];const l=h[1],p=h[2],w=h[3],x=h[4],y=h[5],D=h[6],H=h[7],I=h[8],L=h[9],Y=h[10],P=h[11],Z=h[12],aa=h[13],T=h[14];h=h[15];e[0].setComponents(w-a,H-x,P-I,h-Z).normalize();e[1].setComponents(w+a,H+x,P+I,h+Z).normalize();e[2].setComponents(w+l,H+y,P+L,h+aa).normalize();e[3].setComponents(w-
l,H-y,P-L,h-aa).normalize();e[4].setComponents(w-p,H-D,P-Y,h-T).normalize();if(2E3===c)e[5].setComponents(w+p,H+D,P+Y,h+T).normalize();else if(2001===c)e[5].setComponents(p,D,Y,T).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+c);return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),Of.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const c=a.geometry;null===c.boundingSphere&&c.computeBoundingSphere();
Of.copy(c.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(Of)}intersectsSprite(a){Of.center.set(0,0,0);Of.radius=.7071067811865476;Of.applyMatrix4(a.matrixWorld);return this.intersectsSphere(Of)}intersectsSphere(a){const c=this.planes,e=a.center;a=-a.radius;for(let h=0;6>h;h++)if(c[h].distanceToPoint(e)<a)return!1;return!0}intersectsBox(a){const c=this.planes;for(let e=0;6>e;e++){const h=c[e];Dk.x=0<h.normal.x?a.max.x:a.min.x;Dk.y=0<h.normal.y?a.max.y:a.min.y;Dk.z=0<h.normal.z?
a.max.z:a.min.z;if(0>h.distanceToPoint(Dk))return!1}return!0}containsPoint(a){const c=this.planes;for(let e=0;6>e;e++)if(0>c[e].distanceToPoint(a))return!1;return!0}clone(){return(new this.constructor).copy(this)}}class Cf extends Xc{constructor(a=1,c=1,e=1,h=1){super();this.type="PlaneGeometry";this.parameters={width:a,height:c,widthSegments:e,heightSegments:h};var l=a/2,p=c/2;e=Math.floor(e);h=Math.floor(h);const w=e+1;var x=h+1,y=a/e,D=c/h;c=[];a=[];const H=[],I=[];for(let L=0;L<x;L++){const Y=
L*D-p;for(let P=0;P<w;P++)a.push(P*y-l,-Y,0),H.push(0,0,1),I.push(P/e),I.push(1-L/h)}for(l=0;l<h;l++)for(p=0;p<e;p++)x=p+w*(l+1),y=p+1+w*(l+1),D=p+1+w*l,c.push(p+w*l,x,D),c.push(x,y,D);this.setIndex(c);this.setAttribute("position",new Mc(a,3));this.setAttribute("normal",new Mc(H,3));this.setAttribute("uv",new Mc(I,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Cf(a.width,a.height,a.widthSegments,a.heightSegments)}}const Uc={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a \x3c getAlphaHashThreshold( vPosition ) ) discard;\n#endif",
alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE \x3d 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv \x3d max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale \x3d 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales \x3d vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha \x3d vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor \x3d fract( log2( pixScale ) );\n\t\tfloat x \x3d ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a \x3d min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases \x3d vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold \x3d ( x \x3c ( 1.0 - a ) )\n\t\t\t? ( ( x \x3c a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",
alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a \x3d smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a \x3c alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",
aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion \x3d ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *\x3d ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD )\n\t\tfloat dotNV \x3d saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *\x3d computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size \x3d textureSize( batchingTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size \x3d textureSize( batchingIdTexture, 0 ).x;\n\t\tint x \x3d i % size;\n\t\tint y \x3d i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size \x3d textureSize( batchingColorTexture, 0 ).x;\n\t\tint j \x3d int( i );\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",
batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix \x3d getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed \x3d vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition \x3d vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal \x3d vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent \x3d vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G \x3d G_BlinnPhong_Implicit( );\n\tfloat D \x3d D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",
iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 \x3d mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 \x3d sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase \x3d 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val \x3d vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos \x3d vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var \x3d vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz \x3d val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x +\x3d 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /\x3d 1.0685e-7;\n\t\tvec3 rgb \x3d XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR \x3d mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq \x3d pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq \x3d 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq \x3c 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 \x3d sqrt( cosTheta2Sq );\n\t\tfloat R0 \x3d IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 \x3d F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 \x3d 1.0 - R12;\n\t\tfloat phi12 \x3d 0.0;\n\t\tif ( iridescenceIOR \x3c outsideIOR ) phi12 \x3d PI;\n\t\tfloat phi21 \x3d PI - phi12;\n\t\tvec3 baseIOR \x3d Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 \x3d IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 \x3d F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 \x3d vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] \x3c iridescenceIOR ) phi23[ 0 ] \x3d PI;\n\t\tif ( baseIOR[ 1 ] \x3c iridescenceIOR ) phi23[ 1 ] \x3d PI;\n\t\tif ( baseIOR[ 2 ] \x3c iridescenceIOR ) phi23[ 2 ] \x3d PI;\n\t\tfloat OPD \x3d 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi \x3d vec3( phi21 ) + phi23;\n\t\tvec3 R123 \x3d clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 \x3d sqrt( R123 );\n\t\tvec3 Rs \x3d pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 \x3d R12 + Rs;\n\t\tI \x3d C0;\n\t\tvec3 Cm \x3d Rs - T121;\n\t\tfor ( int m \x3d 1; m \x3c\x3d 2; ++ m ) {\n\t\t\tCm *\x3d r123;\n\t\t\tvec3 Sm \x3d 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI +\x3d Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx \x3d dFdx( vBumpMapUv );\n\t\tvec2 dSTdy \x3d dFdy( vBumpMapUv );\n\t\tfloat Hll \x3d bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX \x3d normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY \x3d normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN \x3d surf_norm;\n\t\tvec3 R1 \x3d cross( vSigmaY, vN );\n\t\tvec3 R2 \x3d cross( vN, vSigmaX );\n\t\tfloat fDet \x3d dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad \x3d sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity \x3d 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *\x3d smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity \x3d\x3d 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity \x3d 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *\x3d 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *\x3d 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *\x3d clipOpacity;\n\t\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tbool clipped \x3d true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tclipped \x3d ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) \x26\x26 clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvClipPosition \x3d - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *\x3d vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *\x3d vColor;\n#endif",
color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor \x3d vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor \x3d vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *\x3d color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *\x3d instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor \x3d getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *\x3d batchingColor.xyz;\n#endif",
common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 \x3d x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a \x3d 12.9898, b \x3d 78.233, c \x3d 43758.5453;\n\thighp float dt \x3d dot( uv.xy, vec2( a,b ) ), sn \x3d mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent \x3d max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] \x3d vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] \x3d vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] \x3d vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] \x3d\x3d - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u \x3d atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v \x3d asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection \x3d abs( direction );\n\t\tfloat face \x3d - 1.0;\n\t\tif ( absDirection.x \x3e absDirection.z ) {\n\t\t\tif ( absDirection.x \x3e absDirection.y )\n\t\t\t\tface \x3d direction.x \x3e 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z \x3e absDirection.y )\n\t\t\t\tface \x3d direction.z \x3e 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face \x3d\x3d 0.0 ) {\n\t\t\tuv \x3d vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 1.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face \x3d\x3d 2.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face \x3d\x3d 3.0 ) {\n\t\t\tuv \x3d vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 4.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv \x3d vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face \x3d getFace( direction );\n\t\tfloat filterInt \x3d max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt \x3d max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize \x3d exp2( mipInt );\n\t\thighp vec2 uv \x3d getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face \x3e 2.0 ) {\n\t\t\tuv.y +\x3d faceSize;\n\t\t\tface -\x3d 3.0;\n\t\t}\n\t\tuv.x +\x3d face * faceSize;\n\t\tuv.x +\x3d filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y +\x3d 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *\x3d CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *\x3d CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip \x3d 0.0;\n\t\tif ( roughness \x3e\x3d cubeUV_r1 ) {\n\t\t\tmip \x3d ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r4 ) {\n\t\t\tmip \x3d ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r5 ) {\n\t\t\tmip \x3d ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r6 ) {\n\t\t\tmip \x3d ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip \x3d - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip \x3d clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF \x3d fract( mip );\n\t\tfloat mipInt \x3d floor( mip );\n\t\tvec3 color0 \x3d bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF \x3d\x3d 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 \x3d bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal \x3d objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent \x3d objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm \x3d mat3( batchingMatrix );\n\ttransformedNormal /\x3d vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal \x3d bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im \x3d mat3( instanceMatrix );\n\ttransformedNormal /\x3d vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal \x3d im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal \x3d normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal \x3d - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent \x3d ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent \x3d - transformedTangent;\n\t#endif\n#endif",
displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed +\x3d normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor \x3d texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *\x3d emissiveColor.rgb;\n#endif",
emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor \x3d linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 \x3d mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB \x3d mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag \x3d normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec \x3d reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec \x3d refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec \x3d vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor \x3d textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor \x3d vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight \x3d mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight \x3d mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight +\x3d envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec \x3d reflect( - viewDir, normal );\n\t\t\treflectVec \x3d normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec \x3d inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal \x3d cross( bitangent, viewDir );\n\t\t\t\tbentNormal \x3d normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal \x3d normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition \x3d worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex \x3d normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect \x3d reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect \x3d refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tvFogDepth \x3d - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor \x3d 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor \x3d smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb \x3d mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL \x3d dot( normal, lightDirection );\n\tvec2 coord \x3d vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw \x3d fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",
lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularStrength \x3d specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",
lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x \x3d normal.x, y \x3d normal.y, z \x3d normal.z;\n\tvec3 result \x3d shCoefficients[ 0 ] * 0.886227;\n\tresult +\x3d shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult +\x3d shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult +\x3d shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult +\x3d shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult +\x3d shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult +\x3d shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult +\x3d shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult +\x3d shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance \x3d shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance \x3d ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff \x3d 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance \x3e 0.0 ) {\n\t\tdistanceFalloff *\x3d pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS \x3e 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color \x3d directionalLight.color;\n\t\tlight.direction \x3d directionalLight.direction;\n\t\tlight.visible \x3d true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS \x3e 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d pointLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat lightDistance \x3d length( lVector );\n\t\tlight.color \x3d pointLight.color;\n\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS \x3e 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d spotLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat angleCos \x3d dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation \x3d getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation \x3e 0.0 ) {\n\t\t\tfloat lightDistance \x3d length( lVector );\n\t\t\tlight.color \x3d spotLight.color * spotAttenuation;\n\t\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color \x3d vec3( 0.0 );\n\t\t\tlight.visible \x3d false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS \x3e 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL \x3d dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight \x3d 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance \x3d mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",
lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance \x3d getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularColor \x3d specular;\nmaterial.specularShininess \x3d shininess;\nmaterial.specularStrength \x3d specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy \x3d max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness \x3d max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness \x3d max( roughnessFactor, 0.0525 );material.roughness +\x3d geometryRoughness;\nmaterial.roughness \x3d min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior \x3d ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor \x3d specularIntensity;\n\t\tvec3 specularColorFactor \x3d specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *\x3d texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *\x3d texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 \x3d mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor \x3d 1.0;\n\t\tvec3 specularColorFactor \x3d vec3( 1.0 );\n\t\tmaterial.specularF90 \x3d 1.0;\n\t#endif\n\tmaterial.specularColor \x3d mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor \x3d mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 \x3d 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat \x3d clearcoat;\n\tmaterial.clearcoatRoughness \x3d clearcoatRoughness;\n\tmaterial.clearcoatF0 \x3d vec3( 0.04 );\n\tmaterial.clearcoatF90 \x3d 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *\x3d texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *\x3d texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat \x3d saturate( material.clearcoat );\tmaterial.clearcoatRoughness \x3d max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness +\x3d geometryRoughness;\n\tmaterial.clearcoatRoughness \x3d min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion \x3d dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence \x3d iridescence;\n\tmaterial.iridescenceIOR \x3d iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *\x3d texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness \x3d (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness \x3d iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor \x3d sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *\x3d texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness \x3d clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *\x3d texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat \x3d mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar \x3d texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV \x3d anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV \x3d anisotropyVector;\n\t#endif\n\tmaterial.anisotropy \x3d length( anisotropyV );\n\tif( material.anisotropy \x3d\x3d 0.0 ) {\n\t\tanisotropyV \x3d vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /\x3d material.anisotropy;\n\t\tmaterial.anisotropy \x3d saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT \x3d mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT \x3d tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB \x3d tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect \x3d vec3( 0.0 );\nvec3 clearcoatSpecularIndirect \x3d vec3( 0.0 );\nvec3 sheenSpecularDirect \x3d vec3( 0.0 );\nvec3 sheenSpecularIndirect \x3d vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x \x3d clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 \x3d x * x;\n    float x5 \x3d clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat gv \x3d dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl \x3d dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat denom \x3d pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv \x3d dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl \x3d dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v \x3d 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 \x3d alphaT * alphaB;\n\t\thighp vec3 v \x3d vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 \x3d dot( v, v );\n\t\tfloat w2 \x3d a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 \x3d material.clearcoatF0;\n\t\tfloat f90 \x3d material.clearcoatF90;\n\t\tfloat roughness \x3d material.clearcoatRoughness;\n\t\tfloat alpha \x3d pow2( roughness );\n\t\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\t\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 \x3d material.specularColor;\n\tfloat f90 \x3d material.specularF90;\n\tfloat roughness \x3d material.roughness;\n\tfloat alpha \x3d pow2( roughness );\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF \x3d mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL \x3d dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV \x3d dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH \x3d dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL \x3d dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV \x3d dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH \x3d dot( material.anisotropyB, halfDir );\n\t\tfloat V \x3d V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D \x3d D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE \x3d 64.0;\n\tconst float LUT_SCALE \x3d ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS \x3d 0.5 / LUT_SIZE;\n\tfloat dotNV \x3d saturate( dot( N, V ) );\n\tvec2 uv \x3d vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv \x3d uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l \x3d length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x \x3d dot( v1, v2 );\n\tfloat y \x3d abs( x );\n\tfloat a \x3d 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b \x3d 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v \x3d a / b;\n\tfloat theta_sintheta \x3d ( x \x3e 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 \x3d rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 \x3d rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal \x3d cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) \x3c 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 \x3d normalize( V - N * dot( V, N ) );\n\tT2 \x3d - cross( N, T1 );\n\tmat3 mat \x3d mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] \x3d mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] \x3d mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] \x3d mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] \x3d mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] \x3d normalize( coords[ 0 ] );\n\tcoords[ 1 ] \x3d normalize( coords[ 1 ] );\n\tcoords[ 2 ] \x3d normalize( coords[ 2 ] );\n\tcoords[ 3 ] \x3d normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor \x3d vec3( 0.0 );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result \x3d LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha \x3d pow2( roughness );\n\tfloat invAlpha \x3d 1.0 / alpha;\n\tfloat cos2h \x3d dotNH * dotNH;\n\tfloat sin2h \x3d max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat D \x3d D_Charlie( sheenRoughness, dotNH );\n\tfloat V \x3d V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat r2 \x3d roughness * roughness;\n\tfloat a \x3d roughness \x3c 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b \x3d roughness \x3c 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG \x3d exp( a * dotNV + b ) + ( roughness \x3c 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 \x3d vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 \x3d vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r \x3d roughness * c0 + c1;\n\tfloat a004 \x3d min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab \x3d vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr \x3d mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr \x3d specularColor;\n\t#endif\n\tvec3 FssEss \x3d Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess \x3d fab.x + fab.y;\n\tfloat Ems \x3d 1.0 - Ess;\n\tvec3 Favg \x3d Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms \x3d FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter +\x3d FssEss;\n\tmultiScatter +\x3d Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal \x3d geometryNormal;\n\t\tvec3 viewDir \x3d geometryViewDir;\n\t\tvec3 position \x3d geometryPosition;\n\t\tvec3 lightPos \x3d rectAreaLight.position;\n\t\tvec3 halfWidth \x3d rectAreaLight.halfWidth;\n\t\tvec3 halfHeight \x3d rectAreaLight.halfHeight;\n\t\tvec3 lightColor \x3d rectAreaLight.color;\n\t\tfloat roughness \x3d material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] \x3d lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] \x3d lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] \x3d lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] \x3d lightPos + halfWidth + halfHeight;\n\t\tvec2 uv \x3d LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 \x3d texture2D( ltc_1, uv );\n\t\tvec4 t2 \x3d texture2D( ltc_2, uv );\n\t\tmat3 mInv \x3d mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel \x3d ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular +\x3d lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse +\x3d lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc \x3d saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance \x3d dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect +\x3d ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect +\x3d irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect +\x3d clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect +\x3d irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering \x3d vec3( 0.0 );\n\tvec3 multiScattering \x3d vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance \x3d irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering \x3d singleScattering + multiScattering;\n\tvec3 diffuse \x3d material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular +\x3d radiance * singleScattering;\n\treflectedLight.indirectSpecular +\x3d multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse +\x3d diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nvec3 geometryPosition \x3d - vViewPosition;\nvec3 geometryNormal \x3d normal;\nvec3 geometryViewDir \x3d ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal \x3d vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal \x3d clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi \x3d saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness \x3d\x3d 0.0 ) {\n\t\tmaterial.iridescence \x3d 0.0;\n\t} else {\n\t\tmaterial.iridescence \x3d saturate( material.iridescence );\n\t}\n\tif ( material.iridescence \x3e 0.0 ) {\n\t\tmaterial.iridescenceFresnel \x3d evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 \x3d Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight \x3d pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow \x3d pointLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight \x3d spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX \x3c NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord \x3d vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap \x3d all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor \x3d texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color \x3d inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow \x3d spotLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow \x3d directionalLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight \x3d rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance \x3d vec3( 0.0 );\n\tvec3 irradiance \x3d getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance +\x3d getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS \x3e 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance \x3d vec3( 0.0 );\n\tvec3 clearcoatRadiance \x3d vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance \x3d lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance +\x3d lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD ) \x26\x26 defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance +\x3d getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) \x26\x26 defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance +\x3d getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance +\x3d getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance +\x3d getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth \x3d vIsPerspective \x3d\x3d 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth \x3d 1.0 + gl_Position.w;\n\tvIsPerspective \x3d float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor \x3d texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor \x3d vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *\x3d sampledDiffuseColor;\n#endif",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv \x3d vUv;\n\t#else\n\t\tvec2 uv \x3d ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *\x3d texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
metalnessmap_fragment:"float metalnessFactor \x3d metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness \x3d texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *\x3d texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence \x3d texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] \x3d  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",
morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) objectNormal +\x3d getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex \x3d vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y \x3d texelIndex / morphTargetsTextureSize.x;\n\t\tint x \x3d texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV \x3d ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) transformed +\x3d getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection \x3d gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx \x3d dFdx( vViewPosition );\n\tvec3 fdy \x3d dFdy( vViewPosition );\n\tvec3 normal \x3d normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal \x3d normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *\x3d faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn \x3d getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn[0] *\x3d faceDirection;\n\t\ttbn[1] *\x3d faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 \x3d getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn2[0] *\x3d faceDirection;\n\t\ttbn2[1] *\x3d faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal \x3d normal;",
normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal \x3d - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal \x3d normal * faceDirection;\n\t#endif\n\tnormal \x3d normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *\x3d normalScale;\n\tnormal \x3d normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal \x3d perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",
normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal \x3d normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent \x3d normalize( transformedTangent );\n\t\tvBitangent \x3d normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) \x26\x26 ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 \x3d dFdx( eye_pos.xyz );\n\t\tvec3 q1 \x3d dFdy( eye_pos.xyz );\n\t\tvec2 st0 \x3d dFdx( uv.st );\n\t\tvec2 st1 \x3d dFdy( uv.st );\n\t\tvec3 N \x3d surf_norm;\n\t\tvec3 q1perp \x3d cross( q1, N );\n\t\tvec3 q0perp \x3d cross( N, q0 );\n\t\tvec3 T \x3d q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B \x3d q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det \x3d max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale \x3d ( det \x3d\x3d 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",
clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal \x3d nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN \x3d texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *\x3d clearcoatNormalScale;\n\tclearcoatNormal \x3d normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",
iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a \x3d 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *\x3d material.transmissionAlpha;\n#endif\ngl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale \x3d 256. / 255.;const float UnpackDownscale \x3d 255. / 256.;const float ShiftRight8 \x3d 1. / 256.;\nconst float Inv255 \x3d 1. / 255.;\nconst vec4 PackFactors \x3d vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 \x3d vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 \x3d vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 \x3d vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af \x3d modf( v * PackFactors.a, vuf );\n\tfloat bf \x3d modf( vuf * ShiftRight8, vuf );\n\tfloat gf \x3d modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf \x3d modf( v * PackFactors.b, vuf );\n\tfloat gf \x3d modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf \x3d modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r \x3d vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *\x3d gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition \x3d vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition \x3d batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition \x3d instanceMatrix * mvPosition;\n#endif\nmvPosition \x3d modelViewMatrix * mvPosition;\ngl_Position \x3d projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb \x3d dithering( gl_FragColor.rgb );\n#endif",
dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position \x3d rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB \x3d vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB \x3d mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor \x3d roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness \x3d texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *\x3d texelRoughness.g;\n#endif",
roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS \x3e 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion \x3d 1.0;\n\t\tvec2 distribution \x3d texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow \x3d step( compare , distribution.x );\n\t\tif (hard_shadow !\x3d 1.0 ) {\n\t\t\tfloat distance \x3d compare - distribution.x ;\n\t\t\tfloat variance \x3d max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability \x3d variance / (variance + distance * distance );\t\t\tsoftness_probability \x3d clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion \x3d clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow \x3d 1.0;\n\t\tshadowCoord.xyz /\x3d shadowCoord.w;\n\t\tshadowCoord.z +\x3d shadowBias;\n\t\tbool inFrustum \x3d shadowCoord.x \x3e\x3d 0.0 \x26\x26 shadowCoord.x \x3c\x3d 1.0 \x26\x26 shadowCoord.y \x3e\x3d 0.0 \x26\x26 shadowCoord.y \x3c\x3d 1.0;\n\t\tbool frustumTest \x3d inFrustum \x26\x26 shadowCoord.z \x3c\x3d 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 \x3d - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 \x3d - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 \x3d + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 \x3d + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 \x3d dx0 / 2.0;\n\t\t\tfloat dy2 \x3d dy0 / 2.0;\n\t\t\tfloat dx3 \x3d dx1 / 2.0;\n\t\t\tfloat dy3 \x3d dy1 / 2.0;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx \x3d texelSize.x;\n\t\t\tfloat dy \x3d texelSize.y;\n\t\t\tvec2 uv \x3d shadowCoord.xy;\n\t\t\tvec2 f \x3d fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -\x3d f * texelSize;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow \x3d VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow \x3d texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV \x3d abs( v );\n\t\tfloat scaleToCube \x3d 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *\x3d scaleToCube;\n\t\tv *\x3d scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar \x3d v.xy;\n\t\tfloat almostATexel \x3d 1.5 * texelSizeY;\n\t\tfloat almostOne \x3d 1.0 - almostATexel;\n\t\tif ( absV.z \x3e\x3d almostOne ) {\n\t\t\tif ( v.z \x3e 0.0 )\n\t\t\t\tplanar.x \x3d 4.0 - v.x;\n\t\t} else if ( absV.x \x3e\x3d almostOne ) {\n\t\t\tfloat signX \x3d sign( v.x );\n\t\t\tplanar.x \x3d v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y \x3e\x3d almostOne ) {\n\t\t\tfloat signY \x3d sign( v.y );\n\t\t\tplanar.x \x3d v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y \x3d v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow \x3d 1.0;\n\t\tvec3 lightToPosition \x3d shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength \x3d length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar \x3c\x3d 0.0 \x26\x26 lightToPositionLength - shadowCameraNear \x3e\x3d 0.0 ) {\n\t\t\tfloat dp \x3d ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp +\x3d shadowBias;\n\t\t\tvec3 bd3D \x3d normalize( lightToPosition );\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset \x3d vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow \x3d (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow \x3d texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",
shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) \x26\x26 ( NUM_DIR_LIGHT_SHADOWS \x3e 0 || NUM_POINT_LIGHT_SHADOWS \x3e 0 ) ) || ( NUM_SPOT_LIGHT_COORDS \x3e 0 )\n\tvec3 shadowWorldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] \x3d directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] \x3d pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition \x3d worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) \x26\x26 UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz +\x3d shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] \x3d spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow \x3d 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight \x3d spotLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight \x3d pointLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX \x3d getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY \x3d getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ \x3d getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW \x3d getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size \x3d textureSize( boneTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex \x3d bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned \x3d vec4( 0.0 );\n\tskinned +\x3d boneMatX * skinVertex * skinWeight.x;\n\tskinned +\x3d boneMatY * skinVertex * skinWeight.y;\n\tskinned +\x3d boneMatZ * skinVertex * skinWeight.z;\n\tskinned +\x3d boneMatW * skinVertex * skinWeight.w;\n\ttransformed \x3d ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix \x3d mat4( 0.0 );\n\tskinMatrix +\x3d skinWeight.x * boneMatX;\n\tskinMatrix +\x3d skinWeight.y * boneMatY;\n\tskinMatrix +\x3d skinWeight.z * boneMatZ;\n\tskinMatrix +\x3d skinWeight.w * boneMatW;\n\tskinMatrix \x3d bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal \x3d vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent \x3d vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular \x3d texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength \x3d texelSpecular.r;\n#else\n\tspecularStrength \x3d 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb \x3d toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a \x3d v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b \x3d v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat \x3d mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat \x3d mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *\x3d toneMappingExposure / 0.6;\n\tcolor \x3d ACESInputMat * color;\n\tcolor \x3d RRTAndODTFit( color );\n\tcolor \x3d ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB \x3d mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 \x3d mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 \x3d x * x;\n\tvec3 x4 \x3d x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix \x3d mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix \x3d mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv \x3d - 12.47393;\tconst float AgxMaxEv \x3d 4.026069;\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor \x3d AgXInsetMatrix * color;\n\tcolor \x3d max( color, 1e-10 );\tcolor \x3d log2( color );\n\tcolor \x3d ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\tcolor \x3d agxDefaultContrastApprox( color );\n\tcolor \x3d AgXOutsetMatrix * color;\n\tcolor \x3d pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor \x3d LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression \x3d 0.8 - 0.04;\n\tconst float Desaturation \x3d 0.15;\n\tcolor *\x3d toneMappingExposure;\n\tfloat x \x3d min( color.r, min( color.g, color.b ) );\n\tfloat offset \x3d x \x3c 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -\x3d offset;\n\tfloat peak \x3d max( color.r, max( color.g, color.b ) );\n\tif ( peak \x3c StartCompression ) return color;\n\tfloat d \x3d 1. - StartCompression;\n\tfloat newPeak \x3d 1. - d * d / ( peak + d - StartCompression );\n\tcolor *\x3d newPeak / peak;\n\tfloat g \x3d 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",
transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission \x3d transmission;\n\tmaterial.transmissionAlpha \x3d 1.0;\n\tmaterial.thickness \x3d thickness;\n\tmaterial.attenuationDistance \x3d attenuationDistance;\n\tmaterial.attenuationColor \x3d attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *\x3d texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *\x3d texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos \x3d vWorldPosition;\n\tvec3 v \x3d normalize( cameraPosition - pos );\n\tvec3 n \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted \x3d getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha \x3d mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse \x3d mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",
transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv \x3d uv * texelSize.zw + 0.5;\n\t\tvec2 iuv \x3d floor( uv );\n\t\tvec2 fuv \x3d fract( uv );\n\t\tfloat g0x \x3d g0( fuv.x );\n\t\tfloat g1x \x3d g1( fuv.x );\n\t\tfloat h0x \x3d h0( fuv.x );\n\t\tfloat h1x \x3d h1( fuv.x );\n\t\tfloat h0y \x3d h0( fuv.y );\n\t\tfloat h1y \x3d h1( fuv.y );\n\t\tvec2 p0 \x3d ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 \x3d ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 \x3d ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 \x3d ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize \x3d vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize \x3d vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv \x3d 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv \x3d 1.0 / cLodSize;\n\t\tvec4 fSample \x3d bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample \x3d bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector \x3d refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x \x3d length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y \x3d length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z \x3d length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod \x3d log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient \x3d -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance \x3d exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread \x3d ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors \x3d vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i \x3d 0; i \x3c 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay \x3d getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit \x3d position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos \x3d projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords \x3d ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords +\x3d 1.0;\n\t\t\t\trefractionCoords /\x3d 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample \x3d getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] \x3d transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a +\x3d transmissionSample.a;\n\t\t\t\ttransmittance[ i ] \x3d diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /\x3d 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay \x3d getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit \x3d position + transmissionRay;\n\t\t\tvec4 ndcPos \x3d projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords \x3d ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords +\x3d 1.0;\n\t\t\trefractionCoords /\x3d 2.0;\n\t\t\ttransmittedLight \x3d getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance \x3d diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor \x3d transmittance * transmittedLight.rgb;\n\t\tvec3 F \x3d EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor \x3d ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",
uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv \x3d vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv \x3d ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv \x3d ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv \x3d ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv \x3d ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv \x3d ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv \x3d ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv \x3d ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv \x3d ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv \x3d ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv \x3d ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv \x3d ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv \x3d ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv \x3d ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv \x3d ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv \x3d ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv \x3d ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv \x3d ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv \x3d ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv \x3d ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv \x3d ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv \x3d ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv \x3d ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv \x3d ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",
worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvec4 worldPosition \x3d vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition \x3d batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition \x3d instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition \x3d modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position \x3d vec4( position.xy, 1.0, 1.0 );\n}",
background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor \x3d texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor \x3d vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
backgroundCube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include \x3ccube_uv_reflection_fragment\x3e\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor \x3d textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor \x3d textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
cube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor \x3d textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor \x3d texColor;\n\tgl_FragColor.a *\x3d opacity;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
depth_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvHighPrecisionZW \x3d gl_Position.zw;\n}",
depth_frag:"#if DEPTH_PACKING \x3d\x3d 3200\n\tuniform float opacity;\n#endif\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tdiffuseColor.a \x3d opacity;\n\t#endif\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\tfloat fragCoordZ \x3d 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tgl_FragColor \x3d vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING \x3d\x3d 3201\n\t\tgl_FragColor \x3d packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING \x3d\x3d 3202\n\t\tgl_FragColor \x3d vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING \x3d\x3d 3203\n\t\tgl_FragColor \x3d vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvWorldPosition \x3d worldPosition.xyz;\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main () {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\tfloat dist \x3d length( vWorldPosition - referencePosition );\n\tdist \x3d ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist \x3d saturate( dist );\n\tgl_FragColor \x3d packDepthToRGBA( dist );\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvec3 direction \x3d normalize( vWorldDirection );\n\tvec2 sampleUV \x3d equirectUv( direction );\n\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\tvLineDistance \x3d scale * lineDistance;\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tif ( mod( vLineDistance, totalSize ) \x3e dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
meshbasic_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinbase_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t\t#include \x3cdefaultnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse +\x3d lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse +\x3d vec3( 1.0 );\n\t#endif\n\t#include \x3caomap_fragment\x3e\n\treflectedLight.indirectDiffuse *\x3d diffuseColor.rgb;\n\tvec3 outgoingLight \x3d reflectedLight.indirectDiffuse;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_lambert_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_lambert_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tvec3 viewDir \x3d normalize( vViewPosition );\n\tvec3 x \x3d normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y \x3d cross( viewDir, x );\n\tvec2 uv \x3d vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor \x3d texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor \x3d vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight \x3d diffuseColor.rgb * matcapColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition \x3d - mvPosition.xyz;\n#endif\n}",
meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 0.0, 0.0, 0.0, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tgl_FragColor \x3d vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a \x3d 1.0;\n\t#endif\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_phong_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_phong_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n#ifdef USE_TRANSMISSION\n\tvWorldPosition \x3d worldPosition.xyz;\n#endif\n}",
meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3ciridescence_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_physical_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_physical_pars_fragment\x3e\n#include \x3ctransmission_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cclearcoat_pars_fragment\x3e\n#include \x3ciridescence_pars_fragment\x3e\n#include \x3croughnessmap_pars_fragment\x3e\n#include \x3cmetalnessmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3croughnessmap_fragment\x3e\n\t#include \x3cmetalnessmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cclearcoat_normal_fragment_begin\x3e\n\t#include \x3cclearcoat_normal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_physical_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 totalDiffuse \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular \x3d reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include \x3ctransmission_fragment\x3e\n\tvec3 outgoingLight \x3d totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp \x3d 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight \x3d outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc \x3d saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc \x3d F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight \x3d outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cgradientmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_toon_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_toon_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_PointSize \x3d size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *\x3d ( scale / - mvPosition.z );\n\t#endif\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cmap_particle_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_particle_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
shadow_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\nvoid main() {\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cshadowmask_pars_fragment\x3e\nvoid main() {\n\t#include \x3clogdepthbuf_fragment\x3e\n\tgl_FragColor \x3d vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\tvec4 mvPosition \x3d modelViewMatrix[ 3 ];\n\tvec2 scale \x3d vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *\x3d - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition \x3d ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x \x3d cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y \x3d sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy +\x3d rotatedPosition;\n\tgl_Position \x3d projectionMatrix * mvPosition;\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}"},
oc={common:{diffuse:{value:new ia(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new nd},alphaMap:{value:null},alphaMapTransform:{value:new nd},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new nd}},envmap:{envMap:{value:null},envMapRotation:{value:new nd},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new nd}},lightmap:{lightMap:{value:null},
lightMapIntensity:{value:1},lightMapTransform:{value:new nd}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new nd},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new nd},normalScale:{value:new Lb(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new nd},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new nd}},metalnessmap:{metalnessMap:{value:null},
metalnessMapTransform:{value:new nd}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new nd}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new ia(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},
directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,
shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ia(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new nd},
alphaTest:{value:0},uvTransform:{value:new nd}},sprite:{diffuse:{value:new ia(16777215)},opacity:{value:1},center:{value:new Lb(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new nd},alphaMap:{value:null},alphaMapTransform:{value:new nd},alphaTest:{value:0}}},Rg={basic:{uniforms:bc([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,oc.fog]),vertexShader:Uc.meshbasic_vert,fragmentShader:Uc.meshbasic_frag},lambert:{uniforms:bc([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,
oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.fog,oc.lights,{emissive:{value:new ia(0)}}]),vertexShader:Uc.meshlambert_vert,fragmentShader:Uc.meshlambert_frag},phong:{uniforms:bc([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.fog,oc.lights,{emissive:{value:new ia(0)},specular:{value:new ia(1118481)},shininess:{value:30}}]),vertexShader:Uc.meshphong_vert,fragmentShader:Uc.meshphong_frag},standard:{uniforms:bc([oc.common,
oc.envmap,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.roughnessmap,oc.metalnessmap,oc.fog,oc.lights,{emissive:{value:new ia(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Uc.meshphysical_vert,fragmentShader:Uc.meshphysical_frag},toon:{uniforms:bc([oc.common,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.gradientmap,oc.fog,oc.lights,{emissive:{value:new ia(0)}}]),vertexShader:Uc.meshtoon_vert,
fragmentShader:Uc.meshtoon_frag},matcap:{uniforms:bc([oc.common,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.fog,{matcap:{value:null}}]),vertexShader:Uc.meshmatcap_vert,fragmentShader:Uc.meshmatcap_frag},points:{uniforms:bc([oc.points,oc.fog]),vertexShader:Uc.points_vert,fragmentShader:Uc.points_frag},dashed:{uniforms:bc([oc.common,oc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Uc.linedashed_vert,fragmentShader:Uc.linedashed_frag},depth:{uniforms:bc([oc.common,oc.displacementmap]),
vertexShader:Uc.depth_vert,fragmentShader:Uc.depth_frag},normal:{uniforms:bc([oc.common,oc.bumpmap,oc.normalmap,oc.displacementmap,{opacity:{value:1}}]),vertexShader:Uc.meshnormal_vert,fragmentShader:Uc.meshnormal_frag},sprite:{uniforms:bc([oc.sprite,oc.fog]),vertexShader:Uc.sprite_vert,fragmentShader:Uc.sprite_frag},background:{uniforms:{uvTransform:{value:new nd},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Uc.background_vert,fragmentShader:Uc.background_frag},backgroundCube:{uniforms:{envMap:{value:null},
flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new nd}},vertexShader:Uc.backgroundCube_vert,fragmentShader:Uc.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Uc.cube_vert,fragmentShader:Uc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Uc.equirect_vert,fragmentShader:Uc.equirect_frag},distanceRGBA:{uniforms:bc([oc.common,oc.displacementmap,{referencePosition:{value:new Da},
nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:Uc.distanceRGBA_vert,fragmentShader:Uc.distanceRGBA_frag},shadow:{uniforms:bc([oc.lights,oc.fog,{color:{value:new ia(0)},opacity:{value:1}}]),vertexShader:Uc.shadow_vert,fragmentShader:Uc.shadow_frag}};Rg.physical={uniforms:bc([Rg.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new nd},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new nd},clearcoatNormalScale:{value:new Lb(1,
1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new nd},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new nd},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new nd},sheen:{value:0},sheenColor:{value:new ia(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new nd},
sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new nd},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new nd},transmissionSamplerSize:{value:new Lb},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new nd},attenuationDistance:{value:0},attenuationColor:{value:new ia(0)},specularColor:{value:new ia(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new nd},
specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new nd},anisotropyVector:{value:new Lb},anisotropyMap:{value:null},anisotropyMapTransform:{value:new nd}}]),vertexShader:Uc.meshphysical_vert,fragmentShader:Uc.meshphysical_frag};const Ak={r:0,b:0,g:0},Kg=new Qg,lj=new Wc;class Th extends Jj{constructor(a=-1,c=1,e=1,h=-1,l=.1,p=2E3){super();this.isOrthographicCamera=!0;this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=
c;this.top=e;this.bottom=h;this.near=l;this.far=p;this.updateProjectionMatrix()}copy(a,c){super.copy(a,c);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this}setViewOffset(a,c,e,h,l,p){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=c;this.view.offsetX=
e;this.view.offsetY=h;this.view.width=l;this.view.height=p;this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){var a=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,h=(this.top+this.bottom)/2;let l=e-a;e+=a;a=h+c;c=h-c;null!==this.view&&this.view.enabled&&(h=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/
this.zoom,l+=h*this.view.offsetX,e=l+h*this.view.width,a-=c*this.view.offsetY,c=a-c*this.view.height);this.projectionMatrix.makeOrthographic(l,e,a,c,this.near,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},
this.view));return a}}const Lj=[.125,.215,.35,.446,.526,.582],tl=new Th,gk=new ia;let Ah=null,Si=0,Ok=0,hk=!1;const mj=(1+Math.sqrt(5))/2,Ti=1/mj,Pk=[new Da(-mj,Ti,0),new Da(mj,Ti,0),new Da(-Ti,0,mj),new Da(Ti,0,mj),new Da(0,mj,-Ti),new Da(0,mj,Ti),new Da(-1,1,-1),new Da(1,1,-1),new Da(-1,1,1),new Da(1,1,1)];class b{constructor(a){this._renderer=a;this._pingPongRenderTarget=null;this._cubeSize=this._lodMax=0;this._lodPlanes=[];this._sizeLods=[];this._sigmas=[];this._equirectMaterial=this._cubemapMaterial=
this._blurMaterial=null;this._compileMaterial(this._blurMaterial)}fromScene(a,c=0,e=.1,h=100){Ah=this._renderer.getRenderTarget();Si=this._renderer.getActiveCubeFace();Ok=this._renderer.getActiveMipmapLevel();hk=this._renderer.xr.enabled;this._renderer.xr.enabled=!1;this._setSize(256);const l=this._allocateTargets();l.depthBuffer=!0;this._sceneToCubeUV(a,e,h,l);0<c&&this._blur(l,0,0,c);this._applyPMREM(l);this._cleanup(l);return l}fromEquirectangular(a,c=null){return this._fromTexture(a,c)}fromCubemap(a,
c=null){return this._fromTexture(a,c)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Ma(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Kb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose();null!==this._cubemapMaterial&&this._cubemapMaterial.dispose();null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a));
this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose();null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(Ah,Si,Ok);this._renderer.xr.enabled=hk;a.scissorTest=!1;Rc(a,0,0,a.width,a.height)}_fromTexture(a,c){301===a.mapping||302===a.mapping?this._setSize(0===a.image.length?16:a.image[0].width||a.image[0].image.width):
this._setSize(a.image.width/4);Ah=this._renderer.getRenderTarget();Si=this._renderer.getActiveCubeFace();Ok=this._renderer.getActiveMipmapLevel();hk=this._renderer.xr.enabled;this._renderer.xr.enabled=!1;c=c||this._allocateTargets();this._textureToCubeUV(a,c);this._applyPMREM(c);this._cleanup(c);return c}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),c=4*this._cubeSize;var e={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:"srgb-linear",depthBuffer:!1};
const h=Ic(a,c,e);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==c){null!==this._pingPongRenderTarget&&this._dispose();this._pingPongRenderTarget=Ic(a,c,e);({_lodMax:e}=this);var l=[],p=[];const D=[];let H=e;const I=e-4+1+Lj.length;for(let L=0;L<I;L++){var w=Math.pow(2,H);p.push(w);var x=1/w;L>e-4?x=Lj[L-e+4-1]:0===L&&(x=0);D.push(x);x=1/(w-2);w=-x;x=1+x;var y=[w,w,x,w,x,x,w,w,x,x,w,x];w=new Float32Array(108);x=new Float32Array(72);
const Y=new Float32Array(36);for(let P=0;6>P;P++){const Z=P%3*2/3-1,aa=2<P?0:-1;w.set([Z,aa,0,Z+2/3,aa,0,Z+2/3,aa+1,0,Z,aa,0,Z+2/3,aa+1,0,Z,aa+1,0],18*P);x.set(y,12*P);Y.set([P,P,P,P,P,P],6*P)}y=new Xc;y.setAttribute("position",new mc(w,3));y.setAttribute("uv",new mc(x,2));y.setAttribute("faceIndex",new mc(Y,1));l.push(y);4<H&&H--}({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}={lodPlanes:l,sizeLods:p,sigmas:D});l=new Float32Array(20);p=new Da(0,1,0);this._blurMaterial=new ih({name:"SphericalGaussianBlur",
defines:{n:20,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/c,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:l},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p}},vertexShader:jb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include \x3ccube_uv_reflection_fragment\x3e\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta \x3d cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection \x3d vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis \x3d latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis \x3d vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis \x3d normalize( axis );\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb +\x3d weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i \x3d 1; i \x3c n; i++ ) {\n\n\t\t\t\t\tif ( i \x3e\x3d samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta \x3d dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}return h}_compileMaterial(a){a=new nf(this._lodPlanes[0],a);this._renderer.compile(a,tl)}_sceneToCubeUV(a,c,e,h){c=new Sf(90,1,c,e);e=[1,-1,1,1,1,1];const l=[1,1,1,-1,-1,-1],p=this._renderer,w=p.autoClear,x=p.toneMapping;p.getClearColor(gk);p.toneMapping=0;p.autoClear=!1;var y=new ab({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});const D=new nf(new zh,y);let H=!1;const I=a.background;I?I.isColor&&(y.color.copy(I),a.background=null,H=!0):(y.color.copy(gk),
H=!0);for(y=0;6>y;y++){const L=y%3;0===L?(c.up.set(0,e[y],0),c.lookAt(l[y],0,0)):1===L?(c.up.set(0,0,e[y]),c.lookAt(0,l[y],0)):(c.up.set(0,e[y],0),c.lookAt(0,0,l[y]));const Y=this._cubeSize;Rc(h,L*Y,2<y?Y:0,Y,Y);p.setRenderTarget(h);H&&p.render(D,c);p.render(a,c)}D.geometry.dispose();D.material.dispose();p.toneMapping=x;p.autoClear=w;a.background=I}_textureToCubeUV(a,c){const e=this._renderer;var h=301===a.mapping||302===a.mapping;h?(null===this._cubemapMaterial&&(this._cubemapMaterial=Ma()),this._cubemapMaterial.uniforms.flipEnvMap.value=
!1===a.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Kb());const l=h?this._cubemapMaterial:this._equirectMaterial;h=new nf(this._lodPlanes[0],l);l.uniforms.envMap.value=a;a=this._cubeSize;Rc(c,0,0,3*a,2*a);e.setRenderTarget(c);e.render(h,tl)}_applyPMREM(a){const c=this._renderer,e=c.autoClear;c.autoClear=!1;const h=this._lodPlanes.length;for(let l=1;l<h;l++)this._blur(a,l-1,l,Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),Pk[(h-
l-1)%Pk.length]);c.autoClear=e}_blur(a,c,e,h,l){const p=this._pingPongRenderTarget;this._halfBlur(a,p,c,e,h,"latitudinal",l);this._halfBlur(p,a,e,e,h,"longitudinal",l)}_halfBlur(a,c,e,h,l,p,w){const x=this._renderer;var y=this._blurMaterial;"latitudinal"!==p&&"longitudinal"!==p&&console.error("blur direction must be either latitudinal or longitudinal!");const D=new nf(this._lodPlanes[h],y);y=y.uniforms;var H=this._sizeLods[e]-1;H=isFinite(l)?Math.PI/(2*H):2*Math.PI/39;var I=l/H;const L=isFinite(l)?
1+Math.floor(3*I):20;20<L&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${L} samples when the maximum is set to ${20}`);l=[];let Y=0;for(let Z=0;20>Z;++Z){var P=Z/I;P=Math.exp(-P*P/2);l.push(P);0===Z?Y+=P:Z<L&&(Y+=2*P)}for(I=0;I<l.length;I++)l[I]/=Y;y.envMap.value=a.texture;y.samples.value=L;y.weights.value=l;y.latitudinal.value="latitudinal"===p;w&&(y.poleAxis.value=w);({_lodMax:a}=this);y.dTheta.value=H;y.mipInt.value=a-e;e=this._sizeLods[h];Rc(c,3*e*(h>a-4?h-a+
4:0),4*(this._cubeSize-e),3*e,2*e);x.setRenderTarget(c);x.render(D,tl)}}class g extends Ld{constructor(a,c,e,h,l,p,w,x,y,D=1026){if(1026!==D&&1027!==D)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===e&&1026===D&&(e=1014);void 0===e&&1027===D&&(e=1020);super(null,h,l,p,w,x,D,e,y);this.isDepthTexture=!0;this.image={width:a,height:c};this.magFilter=void 0!==w?w:1003;this.minFilter=void 0!==x?x:1003;this.generateMipmaps=this.flipY=!1;this.compareFunction=
null}copy(a){super.copy(a);this.compareFunction=a.compareFunction;return this}toJSON(a){a=super.toJSON(a);null!==this.compareFunction&&(a.compareFunction=this.compareFunction);return a}}const m=new Ld,u=new g(1,1),z=new ed,C=new ee,G=new Ck,K=[],R=[],X=new Float32Array(16),ca=new Float32Array(9),ja=new Float32Array(4);class la{constructor(a,c,e){this.id=a;this.addr=e;this.cache=[];this.type=c.type;this.setValue=Gc(c.type)}}class pa{constructor(a,c,e){this.id=a;this.addr=e;this.cache=[];this.type=
c.type;this.size=c.size;this.setValue=Cg(c.type)}}class ya{constructor(a){this.id=a;this.seq=[];this.map={}}setValue(a,c,e){const h=this.seq;for(let l=0,p=h.length;l!==p;++l){const w=h[l];w.setValue(a,c[w.id],e)}}}const Ba=/(\w+)(\])?(\[|\.)?/g;class za{constructor(a,c){this.seq=[];this.map={};const e=a.getProgramParameter(c,a.ACTIVE_UNIFORMS);for(let D=0;D<e;++D){var h=a.getActiveUniform(c,D),l=a.getUniformLocation(c,h.name),p=this,w=h.name;const H=w.length;for(Ba.lastIndex=0;;){const I=Ba.exec(w),
L=Ba.lastIndex;var x=I[1],y=I[3];"]"===I[2]&&(x|=0);if(void 0===y||"["===y&&L+2===H){w=p;h=void 0===y?new la(x,h,l):new pa(x,h,l);w.seq.push(h);w.map[h.id]=h;break}else y=p.map[x],void 0===y&&(y=new ya(x),x=p,p=y,x.seq.push(p),x.map[p.id]=p),p=y}}}setValue(a,c,e,h){c=this.map[c];void 0!==c&&c.setValue(a,e,h)}setOptional(a,c,e){c=c[e];void 0!==c&&this.setValue(a,e,c)}static upload(a,c,e,h){for(let l=0,p=c.length;l!==p;++l){const w=c[l],x=e[w.id];!1!==x.needsUpdate&&w.setValue(a,x.value,h)}}static seqWithValue(a,
c){const e=[];for(let h=0,l=a.length;h!==l;++h){const p=a[h];p.id in c&&e.push(p)}return e}}let Ea=0;const Qa=new Da,Za=/^[ \t]*#include +<([\w\d./]+)>/gm,sb=new Map,ob=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;let eb=0;class Db{constructor(){this.shaderCache=new Map;this.materialCache=new Map}update(a){var c=a.fragmentShader;const e=this._getShaderStage(a.vertexShader);c=this._getShaderStage(c);a=
this._getShaderCacheForMaterial(a);!1===a.has(e)&&(a.add(e),e.usedTimes++);!1===a.has(c)&&(a.add(c),c.usedTimes++);return this}remove(a){const c=this.materialCache.get(a);for(const e of c)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);this.materialCache.delete(a);return this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear();this.materialCache.clear()}_getShaderCacheForMaterial(a){const c=
this.materialCache;let e=c.get(a);void 0===e&&(e=new Set,c.set(a,e));return e}_getShaderStage(a){const c=this.shaderCache;let e=c.get(a);void 0===e&&(e=new Nb(a),c.set(a,e));return e}}class Nb{constructor(a){this.id=eb++;this.code=a;this.usedTimes=0}}let Ob=0;class Jb extends Sa{constructor(a){super();this.isMeshDepthMaterial=!0;this.type="MeshDepthMaterial";this.depthPacking=3200;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=
1;this.setValues(a)}copy(a){super.copy(a);this.depthPacking=a.depthPacking;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this}}class $b extends Sa{constructor(a){super();this.isMeshDistanceMaterial=!0;this.type="MeshDistanceMaterial";this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=
1;this.displacementBias=0;this.setValues(a)}copy(a){super.copy(a);this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this}}const vc={[0]:1,[2]:6,[4]:7,[3]:5,[1]:0,[6]:2,[7]:4,[5]:3},Bb={contain:function(a,c){const e=a.image&&a.image.width?a.image.width/a.image.height:1;e>c?(a.repeat.x=1,a.repeat.y=e/c,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2):(a.repeat.x=c/e,a.repeat.y=1,a.offset.x=
(1-a.repeat.x)/2,a.offset.y=0);return a},cover:function(a,c){const e=a.image&&a.image.width?a.image.width/a.image.height:1;e>c?(a.repeat.x=c/e,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0):(a.repeat.x=1,a.repeat.y=e/c,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2);return a},fill:function(a){a.repeat.x=1;a.repeat.y=1;a.offset.x=0;a.offset.y=0;return a},getByteLength:Yg};class Yc extends Sf{constructor(a=[]){super();this.isArrayCamera=!0;this.cameras=a}}class md extends Nd{constructor(){super();
this.isGroup=!0;this.type="Group"}}const Bd={type:"move"};class fd{constructor(){this._hand=this._grip=this._targetRay=null}getHandSpace(){null===this._hand&&(this._hand=new md,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1});return this._hand}getTargetRaySpace(){null===this._targetRay&&(this._targetRay=new md,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=
new Da,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Da);return this._targetRay}getGripSpace(){null===this._grip&&(this._grip=new md,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Da,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Da);return this._grip}dispatchEvent(a){null!==this._targetRay&&this._targetRay.dispatchEvent(a);null!==this._grip&&this._grip.dispatchEvent(a);null!==this._hand&&
this._hand.dispatchEvent(a);return this}connect(a){if(a&&a.hand){const c=this._hand;if(c)for(const e of a.hand.values())this._getHandJoint(c,e)}this.dispatchEvent({type:"connected",data:a});return this}disconnect(a){this.dispatchEvent({type:"disconnected",data:a});null!==this._targetRay&&(this._targetRay.visible=!1);null!==this._grip&&(this._grip.visible=!1);null!==this._hand&&(this._hand.visible=!1);return this}update(a,c,e){let h=null,l=null,p=null;const w=this._targetRay,x=this._grip,y=this._hand;
if(a&&"visible-blurred"!==c.session.visibilityState){if(y&&a.hand){p=!0;for(var D of a.hand.values()){const H=c.getJointPose(D,e),I=this._getHandJoint(y,D);null!==H&&(I.matrix.fromArray(H.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=H.radius);I.visible=null!==H}D=y.joints["index-finger-tip"].position.distanceTo(y.joints["thumb-tip"].position);y.inputState.pinching&&.025<D?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",
handedness:a.handedness,target:this})):!y.inputState.pinching&&.015>=D&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==x&&a.gripSpace&&(l=c.getPose(a.gripSpace,e),null!==l&&(x.matrix.fromArray(l.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.matrixWorldNeedsUpdate=!0,l.linearVelocity?(x.hasLinearVelocity=!0,x.linearVelocity.copy(l.linearVelocity)):x.hasLinearVelocity=!1,l.angularVelocity?(x.hasAngularVelocity=
!0,x.angularVelocity.copy(l.angularVelocity)):x.hasAngularVelocity=!1));null!==w&&(h=c.getPose(a.targetRaySpace,e),null===h&&null!==l&&(h=l),null!==h&&(w.matrix.fromArray(h.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.matrixWorldNeedsUpdate=!0,h.linearVelocity?(w.hasLinearVelocity=!0,w.linearVelocity.copy(h.linearVelocity)):w.hasLinearVelocity=!1,h.angularVelocity?(w.hasAngularVelocity=!0,w.angularVelocity.copy(h.angularVelocity)):w.hasAngularVelocity=!1,this.dispatchEvent(Bd)))}null!==
w&&(w.visible=null!==h);null!==x&&(x.visible=null!==l);null!==y&&(y.visible=null!==p);return this}_getHandJoint(a,c){if(void 0===a.joints[c.jointName]){const e=new md;e.matrixAutoUpdate=!1;e.visible=!1;a.joints[c.jointName]=e;a.add(e)}return a.joints[c.jointName]}}class ud{constructor(){this.mesh=this.texture=null;this.depthFar=this.depthNear=0}init(a,c,e){if(null===this.texture){const h=new Ld;a.properties.get(h).__webglTexture=c.texture;if(c.depthNear!=e.depthNear||c.depthFar!=e.depthFar)this.depthNear=
c.depthNear,this.depthFar=c.depthFar;this.texture=h}}getMesh(a){null!==this.texture&&null===this.mesh&&(a=a.cameras[0].viewport,a=new ih({vertexShader:"\nvoid main() {\n\n\tgl_Position \x3d vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord \x3d vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x \x3e\x3d 1.0 ) {\n\n\t\tgl_FragDepth \x3d texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth \x3d texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",
uniforms:{depthColor:{value:this.texture},depthWidth:{value:a.z},depthHeight:{value:a.w}}}),this.mesh=new nf(new Cf(20,20),a));return this.mesh}reset(){this.mesh=this.texture=null}getDepthTexture(){return this.texture}}class le extends Bf{constructor(a,c){function e(Hb){var Ub=Ra.indexOf(Hb.inputSource);-1!==Ub&&(Ub=Fa[Ub],void 0!==Ub&&(Ub.update(Hb.inputSource,Hb.frame,L||D),Ub.dispatchEvent({type:Hb.type,data:Hb.inputSource})))}function h(){x.removeEventListener("select",e);x.removeEventListener("selectstart",
e);x.removeEventListener("selectend",e);x.removeEventListener("squeeze",e);x.removeEventListener("squeezestart",e);x.removeEventListener("squeezeend",e);x.removeEventListener("end",h);x.removeEventListener("inputsourceschange",l);for(let Hb=0;Hb<Fa.length;Hb++){const Ub=Ra[Hb];null!==Ub&&(Ra[Hb]=null,Fa[Hb].disconnect(Ub))}Wb=jc=null;ha.reset();a.setRenderTarget(xa);Ha=x=P=Z=aa=null;Tb.stop();w.isPresenting=!1;a.setPixelRatio(Ka);a.setSize(Ja.width,Ja.height,!1);w.dispatchEvent({type:"sessionend"})}
function l(Hb){for(var Ub=0;Ub<Hb.removed.length;Ub++){var zc=Hb.removed[Ub],cc=Ra.indexOf(zc);0<=cc&&(Ra[cc]=null,Fa[cc].disconnect(zc))}for(Ub=0;Ub<Hb.added.length;Ub++){zc=Hb.added[Ub];cc=Ra.indexOf(zc);if(-1===cc){for(let sa=0;sa<Fa.length;sa++)if(sa>=Ra.length){Ra.push(zc);cc=sa;break}else if(null===Ra[sa]){Ra[sa]=zc;cc=sa;break}if(-1===cc)break}(cc=Fa[cc])&&cc.connect(zc)}}function p(Hb,Ub){null===Ub?Hb.matrixWorld.copy(Hb.matrix):Hb.matrixWorld.multiplyMatrices(Ub.matrixWorld,Hb.matrix);Hb.matrixWorldInverse.copy(Hb.matrixWorld).invert()}
super();const w=this;let x=null,y=1,D=null,H="local-floor",I=1,L=null,Y=null,P=null,Z=null,aa=null,T=null;const ha=new ud,Ca=c.getContextAttributes();let xa=null,Ha=null;const Fa=[],Ra=[],Ja=new Lb;let Ka=null;const lb=new Sf;lb.layers.enable(1);lb.viewport=new yd;const wb=new Sf;wb.layers.enable(2);wb.viewport=new yd;const Mb=[lb,wb],kb=new Yc;kb.layers.enable(1);kb.layers.enable(2);let jc=null,Wb=null;this.cameraAutoUpdate=!0;this.isPresenting=this.enabled=!1;this.getController=function(Hb){let Ub=
Fa[Hb];void 0===Ub&&(Ub=new fd,Fa[Hb]=Ub);return Ub.getTargetRaySpace()};this.getControllerGrip=function(Hb){let Ub=Fa[Hb];void 0===Ub&&(Ub=new fd,Fa[Hb]=Ub);return Ub.getGripSpace()};this.getHand=function(Hb){let Ub=Fa[Hb];void 0===Ub&&(Ub=new fd,Fa[Hb]=Ub);return Ub.getHandSpace()};this.setFramebufferScaleFactor=function(Hb){y=Hb;!0===w.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(Hb){H=Hb;!0===w.isPresenting&&
console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};this.getReferenceSpace=function(){return L||D};this.setReferenceSpace=function(Hb){L=Hb};this.getBaseLayer=function(){return null!==Z?Z:aa};this.getBinding=function(){return P};this.getFrame=function(){return T};this.getSession=function(){return x};this.setSession=async function(Hb){x=Hb;if(null!==x){xa=a.getRenderTarget();x.addEventListener("select",e);x.addEventListener("selectstart",e);x.addEventListener("selectend",
e);x.addEventListener("squeeze",e);x.addEventListener("squeezestart",e);x.addEventListener("squeezeend",e);x.addEventListener("end",h);x.addEventListener("inputsourceschange",l);!0!==Ca.xrCompatible&&await c.makeXRCompatible();Ka=a.getPixelRatio();a.getSize(Ja);if(void 0===x.renderState.layers)aa=new XRWebGLLayer(x,c,{antialias:Ca.antialias,alpha:!0,depth:Ca.depth,stencil:Ca.stencil,framebufferScaleFactor:y}),x.updateRenderState({baseLayer:aa}),a.setPixelRatio(1),a.setSize(aa.framebufferWidth,aa.framebufferHeight,
!1),Ha=new dd(aa.framebufferWidth,aa.framebufferHeight,{format:1023,type:1009,colorSpace:a.outputColorSpace,stencilBuffer:Ca.stencil});else{let zc=Hb=null;var Ub=null;Ca.depth&&(Ub=Ca.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,Hb=Ca.stencil?1027:1026,zc=Ca.stencil?1020:1014);Ub={colorFormat:c.RGBA8,depthFormat:Ub,scaleFactor:y};P=new XRWebGLBinding(x,c);Z=P.createProjectionLayer(Ub);x.updateRenderState({layers:[Z]});a.setPixelRatio(1);a.setSize(Z.textureWidth,Z.textureHeight,!1);Ha=new dd(Z.textureWidth,
Z.textureHeight,{format:1023,type:1009,depthTexture:new g(Z.textureWidth,Z.textureHeight,zc,void 0,void 0,void 0,void 0,void 0,void 0,Hb),stencilBuffer:Ca.stencil,colorSpace:a.outputColorSpace,samples:Ca.antialias?4:0,resolveDepthBuffer:!1===Z.ignoreDepthValues})}Ha.isXRRenderTarget=!0;this.setFoveation(I);L=null;D=await x.requestReferenceSpace(H);Tb.setContext(x);Tb.start();w.isPresenting=!0;w.dispatchEvent({type:"sessionstart"})}};this.getEnvironmentBlendMode=function(){if(null!==x)return x.environmentBlendMode};
this.getDepthTexture=function(){return ha.getDepthTexture()};const Xb=new Da,ad=new Da;this.updateCamera=function(Hb){if(null!==x){var Ub=Hb.near,zc=Hb.far;null!==ha.texture&&(0<ha.depthNear&&(Ub=ha.depthNear),0<ha.depthFar&&(zc=ha.depthFar));kb.near=wb.near=lb.near=Ub;kb.far=wb.far=lb.far=zc;if(jc!==kb.near||Wb!==kb.far)x.updateRenderState({depthNear:kb.near,depthFar:kb.far}),jc=kb.near,Wb=kb.far;Ub=Hb.parent;zc=kb.cameras;p(kb,Ub);for(var cc=0;cc<zc.length;cc++)p(zc[cc],Ub);if(2===zc.length){Xb.setFromMatrixPosition(lb.matrixWorld);
ad.setFromMatrixPosition(wb.matrixWorld);zc=Xb.distanceTo(ad);var sa=lb.projectionMatrix.elements,ka=wb.projectionMatrix.elements,wa=sa[14]/(sa[10]-1);cc=sa[14]/(sa[10]+1);const La=(sa[9]+1)/sa[5],ub=(sa[9]-1)/sa[5];var Oa=(sa[8]-1)/sa[0],Ya=(ka[8]+1)/ka[0];ka=wa*Oa;const mb=wa*Ya;Ya=zc/(-Oa+Ya);Oa=Ya*-Oa;lb.matrixWorld.decompose(kb.position,kb.quaternion,kb.scale);kb.translateX(Oa);kb.translateZ(Ya);kb.matrixWorld.compose(kb.position,kb.quaternion,kb.scale);kb.matrixWorldInverse.copy(kb.matrixWorld).invert();
-1===sa[10]?(kb.projectionMatrix.copy(lb.projectionMatrix),kb.projectionMatrixInverse.copy(lb.projectionMatrixInverse)):(sa=wa+Ya,wa=cc+Ya,kb.projectionMatrix.makePerspective(ka-Oa,mb+(zc-Oa),La*cc/wa*sa,ub*cc/wa*sa,sa,wa),kb.projectionMatrixInverse.copy(kb.projectionMatrix).invert())}else kb.projectionMatrix.copy(lb.projectionMatrix);null===Ub?Hb.matrix.copy(kb.matrixWorld):(Hb.matrix.copy(Ub.matrixWorld),Hb.matrix.invert(),Hb.matrix.multiply(kb.matrixWorld));Hb.matrix.decompose(Hb.position,Hb.quaternion,
Hb.scale);Hb.updateMatrixWorld(!0);Hb.projectionMatrix.copy(kb.projectionMatrix);Hb.projectionMatrixInverse.copy(kb.projectionMatrixInverse);Hb.isPerspectiveCamera&&(Hb.fov=2*bh*Math.atan(1/Hb.projectionMatrix.elements[5]),Hb.zoom=1)}};this.getCamera=function(){return kb};this.getFoveation=function(){if(null!==Z||null!==aa)return I};this.setFoveation=function(Hb){I=Hb;null!==Z&&(Z.fixedFoveation=Hb);null!==aa&&void 0!==aa.fixedFoveation&&(aa.fixedFoveation=Hb)};this.hasDepthSensing=function(){return null!==
ha.texture};this.getDepthSensingMesh=function(){return ha.getMesh(kb)};let wc=null;const Tb=new Jc;Tb.setAnimationLoop(function(Hb,Ub){Y=Ub.getViewerPose(L||D);T=Ub;if(null!==Y){var zc=Y.views;null!==aa&&(a.setRenderTargetFramebuffer(Ha,aa.framebuffer),a.setRenderTarget(Ha));var cc=!1;zc.length!==kb.cameras.length&&(kb.cameras.length=0,cc=!0);for(var sa=0;sa<zc.length;sa++){const wa=zc[sa];let Oa;if(null!==aa)Oa=aa.getViewport(wa);else{var ka=P.getViewSubImage(Z,wa);Oa=ka.viewport;0===sa&&(a.setRenderTargetTextures(Ha,
ka.colorTexture,Z.ignoreDepthValues?void 0:ka.depthStencilTexture),a.setRenderTarget(Ha))}ka=Mb[sa];void 0===ka&&(ka=new Sf,ka.layers.enable(sa),ka.viewport=new yd,Mb[sa]=ka);ka.matrix.fromArray(wa.transform.matrix);ka.matrix.decompose(ka.position,ka.quaternion,ka.scale);ka.projectionMatrix.fromArray(wa.projectionMatrix);ka.projectionMatrixInverse.copy(ka.projectionMatrix).invert();ka.viewport.set(Oa.x,Oa.y,Oa.width,Oa.height);0===sa&&(kb.matrix.copy(ka.matrix),kb.matrix.decompose(kb.position,kb.quaternion,
kb.scale));!0===cc&&kb.cameras.push(ka)}(cc=x.enabledFeatures)&&cc.includes("depth-sensing")&&(zc=P.getDepthInformation(zc[0]))&&zc.isValid&&zc.texture&&ha.init(a,zc,x.renderState)}for(zc=0;zc<Fa.length;zc++)cc=Ra[zc],sa=Fa[zc],null!==cc&&void 0!==sa&&sa.update(cc,Ub,L||D);wc&&wc(Hb,Ub);Ub.detectedPlanes&&w.dispatchEvent({type:"planesdetected",data:Ub});T=null});this.setAnimationLoop=function(Hb){wc=Hb};this.dispose=function(){}}}const wd=new Qg,Fd=new Wc;class Df{constructor(a={}){function c(){kh=
new Ac(db);kh.init();zl=new Eg(db,kh);Vh=new xc(db,kh,a,zl);ne=new uj(db);Vh.reverseDepthBuffer&&ne.buffers.depth.setReversed(!0);lk=new Vc(db);Be=new uk;Ke=new xi(db,kh,ne,Be,Vh,zl,lk);wn=new pd(Tb);xn=new sc(Tb);yn=new id(db);fn=new Dc(db,yn);Mn=new Tc(db,yn,lk,fn);zn=new Pc(db,Mn,yn,lk);Sn=new yc(db,Vh,Ke);Uk=new Nc(Be);Bm=new Hh(Tb,wn,xn,kh,Vh,fn,Uk);Nn=new $h(Tb,Be);In=new rb;Jn=new yf(kh);mk=new sd(Tb,wn,xn,ne,zn,Mb,Ja);Al=new Jh(Tb,zn,Vh);Kn=new qk(db,lk,Vh,ne);Tn=new dc(db,kh,lk);Un=new od(db,
kh,lk);lk.programs=Bm.programs;Tb.capabilities=Vh;Tb.extensions=kh;Tb.properties=Be;Tb.renderLists=In;Tb.shadowMap=Al;Tb.state=ne;Tb.info=lk}function e(qa){qa.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");Hb=!0}function h(){console.log("THREE.WebGLRenderer: Context Restored.");Hb=!1;const qa=lk.autoReset,cb=Al.enabled,xb=Al.autoUpdate,qb=Al.needsUpdate,Wa=Al.type;c();lk.autoReset=qa;Al.enabled=cb;Al.autoUpdate=xb;Al.needsUpdate=qb;Al.type=Wa}function l(qa){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",
qa.statusMessage)}function p(qa){qa=qa.target;qa.removeEventListener("dispose",p);w(qa);Be.remove(qa)}function w(qa){const cb=Be.get(qa).programs;void 0!==cb&&(cb.forEach(function(xb){Bm.releaseProgram(xb)}),qa.isShaderMaterial&&Bm.releaseShaderCache(qa))}function x(qa,cb,xb){!0===qa.transparent&&2===qa.side&&!1===qa.forceSinglePass?(qa.side=1,qa.needsUpdate=!0,Z(qa,cb,xb),qa.side=0,qa.needsUpdate=!0,Z(qa,cb,xb),qa.side=2):Z(qa,cb,xb)}function y(){gn.stop()}function D(){gn.start()}function H(qa,cb,
xb,qb){if(!1!==qa.visible){if(qa.layers.test(cb.layers))if(qa.isGroup)xb=qa.renderOrder;else if(qa.isLOD)!0===qa.autoUpdate&&qa.update(cb);else if(qa.isLight)Xb.pushLight(qa),qa.castShadow&&Xb.pushShadow(qa);else if(qa.isSprite){if(!qa.frustumCulled||Ae.intersectsSprite(qa)){qb&&Yl.setFromMatrixPosition(qa.matrixWorld).applyMatrix4(dn);var Wa=zn.update(qa),nc=qa.material;nc.visible&&Wb.push(qa,Wa,nc,xb,Yl.z,null)}}else if(qa.isMesh||qa.isLine||qa.isPoints)if(!qa.frustumCulled||Ae.intersectsObject(qa))if(Wa=
zn.update(qa),nc=qa.material,qb&&(void 0!==qa.boundingSphere?(null===qa.boundingSphere&&qa.computeBoundingSphere(),Yl.copy(qa.boundingSphere.center)):(null===Wa.boundingSphere&&Wa.computeBoundingSphere(),Yl.copy(Wa.boundingSphere.center)),Yl.applyMatrix4(qa.matrixWorld).applyMatrix4(dn)),Array.isArray(nc)){const uc=Wa.groups;for(let Cc=0,be=uc.length;Cc<be;Cc++){const De=uc[Cc],Qd=nc[De.materialIndex];Qd&&Qd.visible&&Wb.push(qa,Wa,Qd,xb,Yl.z,De)}}else nc.visible&&Wb.push(qa,Wa,nc,xb,Yl.z,null);qa=
qa.children;for(let uc=0,Cc=qa.length;uc<Cc;uc++)H(qa[uc],cb,xb,qb)}}function I(qa,cb,xb,qb){const Wa=qa.opaque,nc=qa.transmissive;qa=qa.transparent;Xb.setupLightsView(xb);!0===Dd&&Uk.setGlobalState(Tb.clippingPlanes,xb);qb&&ne.viewport(wa.copy(qb));0<Wa.length&&Y(Wa,cb,xb);0<nc.length&&Y(nc,cb,xb);0<qa.length&&Y(qa,cb,xb);ne.buffers.depth.setTest(!0);ne.buffers.depth.setMask(!0);ne.buffers.color.setMask(!0);ne.setPolygonOffset(!1)}function L(qa,cb,xb,qb){if(null===(!0===xb.isScene?xb.overrideMaterial:
null)){void 0===Xb.state.transmissionRenderTarget[qb.id]&&(Xb.state.transmissionRenderTarget[qb.id]=new dd(1,1,{generateMipmaps:!0,type:kh.has("EXT_color_buffer_half_float")||kh.has("EXT_color_buffer_float")?1016:1009,minFilter:1008,samples:4,stencilBuffer:Ha,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Eb.workingColorSpace}));var Wa=Xb.state.transmissionRenderTarget[qb.id],nc=qb.viewport||wa;Wa.setSize(nc.z,nc.w);nc=Tb.getRenderTarget();Tb.setRenderTarget(Wa);Tb.getClearColor(La);ub=
Tb.getClearAlpha();1>ub&&Tb.setClearColor(16777215,.5);Tb.clear();en&&mk.render(xb);var uc=Tb.toneMapping;Tb.toneMapping=0;var Cc=qb.viewport;void 0!==qb.viewport&&(qb.viewport=void 0);Xb.setupLightsView(qb);!0===Dd&&Uk.setGlobalState(Tb.clippingPlanes,qb);Y(qa,xb,qb);Ke.updateMultisampleRenderTarget(Wa);Ke.updateRenderTargetMipmap(Wa);if(!1===kh.has("WEBGL_multisampled_render_to_texture")){var be=!1;for(let Qd=0,ef=cb.length;Qd<ef;Qd++){var De=cb[Qd];qa=De.object;const lh=De.geometry,Bh=De.material;
De=De.group;2===Bh.side&&qa.layers.test(qb.layers)&&(be=Bh.side,Bh.side=1,Bh.needsUpdate=!0,P(qa,xb,qb,lh,Bh,De),Bh.side=be,be=Bh.needsUpdate=!0)}!0===be&&(Ke.updateMultisampleRenderTarget(Wa),Ke.updateRenderTargetMipmap(Wa))}Tb.setRenderTarget(nc);Tb.setClearColor(La,ub);void 0!==Cc&&(qb.viewport=Cc);Tb.toneMapping=uc}}function Y(qa,cb,xb){const qb=!0===cb.isScene?cb.overrideMaterial:null;for(let nc=0,uc=qa.length;nc<uc;nc++){var Wa=qa[nc];const Cc=Wa.object,be=Wa.geometry,De=null===qb?Wa.material:
qb;Wa=Wa.group;Cc.layers.test(xb.layers)&&P(Cc,cb,xb,be,De,Wa)}}function P(qa,cb,xb,qb,Wa,nc){qa.onBeforeRender(Tb,cb,xb,qb,Wa,nc);qa.modelViewMatrix.multiplyMatrices(xb.matrixWorldInverse,qa.matrixWorld);qa.normalMatrix.getNormalMatrix(qa.modelViewMatrix);Wa.onBeforeRender(Tb,cb,xb,qb,qa,nc);!0===Wa.transparent&&2===Wa.side&&!1===Wa.forceSinglePass?(Wa.side=1,Wa.needsUpdate=!0,Tb.renderBufferDirect(xb,cb,qb,Wa,qa,nc),Wa.side=0,Wa.needsUpdate=!0,Tb.renderBufferDirect(xb,cb,qb,Wa,qa,nc),Wa.side=2):
Tb.renderBufferDirect(xb,cb,qb,Wa,qa,nc);qa.onAfterRender(Tb,cb,xb,qb,Wa,nc)}function Z(qa,cb,xb){!0!==cb.isScene&&(cb=vn);const qb=Be.get(qa),Wa=Xb.state.lights,nc=Wa.state.version;xb=Bm.getParameters(qa,Wa.state,Xb.state.shadowsArray,cb,xb);var uc=Bm.getProgramCacheKey(xb);let Cc=qb.programs;qb.environment=qa.isMeshStandardMaterial?cb.environment:null;qb.fog=cb.fog;qb.envMap=(qa.isMeshStandardMaterial?xn:wn).get(qa.envMap||qb.environment);qb.envMapRotation=null!==qb.environment&&null===qa.envMap?
cb.environmentRotation:qa.envMapRotation;void 0===Cc&&(qa.addEventListener("dispose",p),Cc=new Map,qb.programs=Cc);cb=Cc.get(uc);if(void 0!==cb){if(qb.currentProgram===cb&&qb.lightsStateVersion===nc)return T(qa,xb),cb}else xb.uniforms=Bm.getUniforms(qa),qa.onBeforeCompile(xb,Tb),cb=Bm.acquireProgram(xb,uc),Cc.set(uc,cb),qb.uniforms=xb.uniforms;uc=qb.uniforms;if(!qa.isShaderMaterial&&!qa.isRawShaderMaterial||!0===qa.clipping)uc.clippingPlanes=Uk.uniform;T(qa,xb);qb.needsLights=qa.isMeshLambertMaterial||
qa.isMeshToonMaterial||qa.isMeshPhongMaterial||qa.isMeshStandardMaterial||qa.isShadowMaterial||qa.isShaderMaterial&&!0===qa.lights;qb.lightsStateVersion=nc;qb.needsLights&&(uc.ambientLightColor.value=Wa.state.ambient,uc.lightProbe.value=Wa.state.probe,uc.directionalLights.value=Wa.state.directional,uc.directionalLightShadows.value=Wa.state.directionalShadow,uc.spotLights.value=Wa.state.spot,uc.spotLightShadows.value=Wa.state.spotShadow,uc.rectAreaLights.value=Wa.state.rectArea,uc.ltc_1.value=Wa.state.rectAreaLTC1,
uc.ltc_2.value=Wa.state.rectAreaLTC2,uc.pointLights.value=Wa.state.point,uc.pointLightShadows.value=Wa.state.pointShadow,uc.hemisphereLights.value=Wa.state.hemi,uc.directionalShadowMap.value=Wa.state.directionalShadowMap,uc.directionalShadowMatrix.value=Wa.state.directionalShadowMatrix,uc.spotShadowMap.value=Wa.state.spotShadowMap,uc.spotLightMatrix.value=Wa.state.spotLightMatrix,uc.spotLightMap.value=Wa.state.spotLightMap,uc.pointShadowMap.value=Wa.state.pointShadowMap,uc.pointShadowMatrix.value=
Wa.state.pointShadowMatrix);qb.currentProgram=cb;qb.uniformsList=null;return cb}function aa(qa){if(null===qa.uniformsList){const cb=qa.currentProgram.getUniforms();qa.uniformsList=za.seqWithValue(cb.seq,qa.uniforms)}return qa.uniformsList}function T(qa,cb){qa=Be.get(qa);qa.outputColorSpace=cb.outputColorSpace;qa.batching=cb.batching;qa.batchingColor=cb.batchingColor;qa.instancing=cb.instancing;qa.instancingColor=cb.instancingColor;qa.instancingMorph=cb.instancingMorph;qa.skinning=cb.skinning;qa.morphTargets=
cb.morphTargets;qa.morphNormals=cb.morphNormals;qa.morphColors=cb.morphColors;qa.morphTargetsCount=cb.morphTargetsCount;qa.numClippingPlanes=cb.numClippingPlanes;qa.numIntersection=cb.numClipIntersection;qa.vertexAlphas=cb.vertexAlphas;qa.vertexTangents=cb.vertexTangents;qa.toneMapping=cb.toneMapping}const {canvas:ha=$a(),context:Ca=null,depth:xa=!0,stencil:Ha=!1,alpha:Fa=!1,antialias:Ra=!1,premultipliedAlpha:Ja=!0,preserveDrawingBuffer:Ka=!1,powerPreference:lb="default",failIfMajorPerformanceCaveat:wb=
!1}=a;this.isWebGLRenderer=!0;let Mb;if(null!==Ca){if("undefined"!==typeof WebGLRenderingContext&&Ca instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");Mb=Ca.getContextAttributes().alpha}else Mb=Fa;const kb=new Uint32Array(4),jc=new Int32Array(4);let Wb=null,Xb=null;const ad=[],wc=[];this.domElement=ha;this.debug={checkShaderErrors:!0,onShaderError:null};this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=
!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this._outputColorSpace="srgb";this.toneMapping=0;this.toneMappingExposure=1;const Tb=this;let Hb=!1,Ub=0,zc=0,cc=null,sa=-1,ka=null;const wa=new yd,Oa=new yd;let Ya=null;const La=new ia(0);let ub=0,mb=ha.width,ib=ha.height,Gb=1,Yb=null,rc=null;const pc=new yd(0,0,mb,ib),Kd=new yd(0,0,mb,ib);let bd=!1;const Ae=new fk;let Dd=!1,Mj=!1;const cn=new Wc,dn=new Wc,Hn=new Da,Yl=new yd,vn={background:null,fog:null,environment:null,overrideMaterial:null,
isScene:!0};let en=!1,db=Ca;try{const qa={alpha:!0,depth:xa,stencil:Ha,antialias:Ra,premultipliedAlpha:Ja,preserveDrawingBuffer:Ka,powerPreference:lb,failIfMajorPerformanceCaveat:wb};"setAttribute"in ha&&ha.setAttribute("data-engine","three.js r169");ha.addEventListener("webglcontextlost",e,!1);ha.addEventListener("webglcontextrestored",h,!1);ha.addEventListener("webglcontextcreationerror",l,!1);if(null===db&&(db=ha.getContext("webgl2",qa),null===db)){if(ha.getContext("webgl2",void 0))throw Error("Error creating WebGL context with your selected attributes.");
throw Error("Error creating WebGL context.");}}catch(qa){throw console.error("THREE.WebGLRenderer: "+qa.message),qa;}let kh,Vh,ne,lk,Be,Ke,wn,xn,yn,Mn,zn,Bm,Nn,In,Jn,Uk,Al,mk,Sn,Tn,Un,zl,fn,Kn;c();const Wh=new le(Tb,db);this.xr=Wh;this.getContext=function(){return db};this.getContextAttributes=function(){return db.getContextAttributes()};this.forceContextLoss=function(){const qa=kh.get("WEBGL_lose_context");qa&&qa.loseContext()};this.forceContextRestore=function(){const qa=kh.get("WEBGL_lose_context");
qa&&qa.restoreContext()};this.getPixelRatio=function(){return Gb};this.setPixelRatio=function(qa){void 0!==qa&&(Gb=qa,this.setSize(mb,ib,!1))};this.getSize=function(qa){return qa.set(mb,ib)};this.setSize=function(qa,cb,xb=!0){Wh.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(mb=qa,ib=cb,ha.width=Math.floor(qa*Gb),ha.height=Math.floor(cb*Gb),!0===xb&&(ha.style.width=qa+"px",ha.style.height=cb+"px"),this.setViewport(0,0,qa,cb))};this.getDrawingBufferSize=
function(qa){return qa.set(mb*Gb,ib*Gb).floor()};this.setDrawingBufferSize=function(qa,cb,xb){mb=qa;ib=cb;Gb=xb;ha.width=Math.floor(qa*xb);ha.height=Math.floor(cb*xb);this.setViewport(0,0,qa,cb)};this.getCurrentViewport=function(qa){return qa.copy(wa)};this.getViewport=function(qa){return qa.copy(pc)};this.setViewport=function(qa,cb,xb,qb){qa.isVector4?pc.set(qa.x,qa.y,qa.z,qa.w):pc.set(qa,cb,xb,qb);ne.viewport(wa.copy(pc).multiplyScalar(Gb).round())};this.getScissor=function(qa){return qa.copy(Kd)};
this.setScissor=function(qa,cb,xb,qb){qa.isVector4?Kd.set(qa.x,qa.y,qa.z,qa.w):Kd.set(qa,cb,xb,qb);ne.scissor(Oa.copy(Kd).multiplyScalar(Gb).round())};this.getScissorTest=function(){return bd};this.setScissorTest=function(qa){ne.setScissorTest(bd=qa)};this.setOpaqueSort=function(qa){Yb=qa};this.setTransparentSort=function(qa){rc=qa};this.getClearColor=function(qa){return qa.copy(mk.getClearColor())};this.setClearColor=function(){mk.setClearColor.apply(mk,arguments)};this.getClearAlpha=function(){return mk.getClearAlpha()};
this.setClearAlpha=function(){mk.setClearAlpha.apply(mk,arguments)};this.clear=function(qa=!0,cb=!0,xb=!0){let qb=0;if(qa)if(qa=!1,null!==cc&&(qa=cc.texture.format,qa=1033===qa||1031===qa||1029===qa),qa){qa=cc.texture.type;qa=1009===qa||1014===qa||1012===qa||1020===qa||1017===qa||1018===qa;var Wa=mk.getClearColor();const nc=mk.getClearAlpha(),uc=Wa.r,Cc=Wa.g;Wa=Wa.b;qa?(kb[0]=uc,kb[1]=Cc,kb[2]=Wa,kb[3]=nc,db.clearBufferuiv(db.COLOR,0,kb)):(jc[0]=uc,jc[1]=Cc,jc[2]=Wa,jc[3]=nc,db.clearBufferiv(db.COLOR,
0,jc))}else qb|=db.COLOR_BUFFER_BIT;cb&&(qb|=db.DEPTH_BUFFER_BIT,db.clearDepth(this.capabilities.reverseDepthBuffer?0:1));xb&&(qb|=db.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295));db.clear(qb)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){ha.removeEventListener("webglcontextlost",e,!1);ha.removeEventListener("webglcontextrestored",h,!1);ha.removeEventListener("webglcontextcreationerror",
l,!1);In.dispose();Jn.dispose();Be.dispose();wn.dispose();xn.dispose();zn.dispose();fn.dispose();Kn.dispose();Bm.dispose();Wh.dispose();Wh.removeEventListener("sessionstart",y);Wh.removeEventListener("sessionend",D);gn.stop()};this.renderBufferDirect=function(qa,cb,xb,qb,Wa,nc){null===cb&&(cb=vn);var uc=Wa.isMesh&&0>Wa.matrixWorld.determinant(),Cc=cb;!0!==Cc.isScene&&(Cc=vn);Ke.resetTextureUnits();cb=Cc.fog;var be=qb.isMeshStandardMaterial?Cc.environment:null,De=null===cc?Tb.outputColorSpace:!0===
cc.isXRRenderTarget?cc.texture.colorSpace:"srgb-linear";be=(qb.isMeshStandardMaterial?xn:wn).get(qb.envMap||be);var Qd=!0===qb.vertexColors&&!!xb.attributes.color&&4===xb.attributes.color.itemSize,ef=!!xb.attributes.tangent&&(!!qb.normalMap||0<qb.anisotropy),lh=!!xb.morphAttributes.position,Bh=!!xb.morphAttributes.normal,Rd=!!xb.morphAttributes.color;let Bl=0;!qb.toneMapped||null!==cc&&!0!==cc.isXRRenderTarget||(Bl=Tb.toneMapping);var cd=xb.morphAttributes.position||xb.morphAttributes.normal||xb.morphAttributes.color;
const On=void 0!==cd?cd.length:0;cd=Be.get(qb);const Pn=Xb.state.lights;!0!==Dd||!0!==Mj&&qa===ka||Uk.setState(qb,qa,qa===ka&&qb.id===sa);let of=!1;qb.version===cd.__version?cd.needsLights&&cd.lightsStateVersion!==Pn.state.version?of=!0:cd.outputColorSpace!==De?of=!0:Wa.isBatchedMesh&&!1===cd.batching?of=!0:Wa.isBatchedMesh||!0!==cd.batching?Wa.isBatchedMesh&&!0===cd.batchingColor&&null===Wa.colorTexture?of=!0:Wa.isBatchedMesh&&!1===cd.batchingColor&&null!==Wa.colorTexture?of=!0:Wa.isInstancedMesh&&
!1===cd.instancing?of=!0:Wa.isInstancedMesh||!0!==cd.instancing?Wa.isSkinnedMesh&&!1===cd.skinning?of=!0:Wa.isSkinnedMesh||!0!==cd.skinning?Wa.isInstancedMesh&&!0===cd.instancingColor&&null===Wa.instanceColor?of=!0:Wa.isInstancedMesh&&!1===cd.instancingColor&&null!==Wa.instanceColor?of=!0:Wa.isInstancedMesh&&!0===cd.instancingMorph&&null===Wa.morphTexture?of=!0:Wa.isInstancedMesh&&!1===cd.instancingMorph&&null!==Wa.morphTexture?of=!0:cd.envMap!==be?of=!0:!0===qb.fog&&cd.fog!==cb?of=!0:void 0===cd.numClippingPlanes||
cd.numClippingPlanes===Uk.numPlanes&&cd.numIntersection===Uk.numIntersection?cd.vertexAlphas!==Qd?of=!0:cd.vertexTangents!==ef?of=!0:cd.morphTargets!==lh?of=!0:cd.morphNormals!==Bh?of=!0:cd.morphColors!==Rd?of=!0:cd.toneMapping!==Bl?of=!0:cd.morphTargetsCount!==On&&(of=!0):of=!0:of=!0:of=!0:of=!0:(of=!0,cd.__version=qb.version);De=cd.currentProgram;!0===of&&(De=Z(qb,Cc,Wa));Bh=lh=Rd=!1;Qd=De.getUniforms();ef=cd.uniforms;ne.useProgram(De.program)&&(Bh=lh=Rd=!0);qb.id!==sa&&(sa=qb.id,lh=!0);if(Rd||
ka!==qa)Vh.reverseDepthBuffer?(cn.copy(qa.projectionMatrix),Rd=cn.elements,Rd[2]=.5*Rd[2]+.5*Rd[3],Rd[6]=.5*Rd[6]+.5*Rd[7],Rd[10]=.5*Rd[10]+.5*Rd[11],Rd[14]=.5*Rd[14]+.5*Rd[15],Rd=cn.elements,-1===Rd[11]?(Rd[10]=-Rd[10]-1,Rd[14]=-Rd[14]):(Rd[10]=-Rd[10],Rd[14]=-Rd[14]+1),Qd.setValue(db,"projectionMatrix",cn)):Qd.setValue(db,"projectionMatrix",qa.projectionMatrix),Qd.setValue(db,"viewMatrix",qa.matrixWorldInverse),Rd=Qd.map.cameraPosition,void 0!==Rd&&Rd.setValue(db,Hn.setFromMatrixPosition(qa.matrixWorld)),
Vh.logarithmicDepthBuffer&&Qd.setValue(db,"logDepthBufFC",2/(Math.log(qa.far+1)/Math.LN2)),(qb.isMeshPhongMaterial||qb.isMeshToonMaterial||qb.isMeshLambertMaterial||qb.isMeshBasicMaterial||qb.isMeshStandardMaterial||qb.isShaderMaterial)&&Qd.setValue(db,"isOrthographic",!0===qa.isOrthographicCamera),ka!==qa&&(ka=qa,Bh=lh=!0);Wa.isSkinnedMesh&&(Qd.setOptional(db,Wa,"bindMatrix"),Qd.setOptional(db,Wa,"bindMatrixInverse"),Rd=Wa.skeleton)&&(null===Rd.boneTexture&&Rd.computeBoneTexture(),Qd.setValue(db,
"boneTexture",Rd.boneTexture,Ke));Wa.isBatchedMesh&&(Qd.setOptional(db,Wa,"batchingTexture"),Qd.setValue(db,"batchingTexture",Wa._matricesTexture,Ke),Qd.setOptional(db,Wa,"batchingIdTexture"),Qd.setValue(db,"batchingIdTexture",Wa._indirectTexture,Ke),Qd.setOptional(db,Wa,"batchingColorTexture"),null!==Wa._colorsTexture&&Qd.setValue(db,"batchingColorTexture",Wa._colorsTexture,Ke));Rd=xb.morphAttributes;void 0===Rd.position&&void 0===Rd.normal&&void 0===Rd.color||Sn.update(Wa,xb,De);if(lh||cd.receiveShadow!==
Wa.receiveShadow)cd.receiveShadow=Wa.receiveShadow,Qd.setValue(db,"receiveShadow",Wa.receiveShadow);qb.isMeshGouraudMaterial&&null!==qb.envMap&&(ef.envMap.value=be,ef.flipEnvMap.value=be.isCubeTexture&&!1===be.isRenderTargetTexture?-1:1);qb.isMeshStandardMaterial&&null===qb.envMap&&null!==Cc.environment&&(ef.envMapIntensity.value=Cc.environmentIntensity);lh&&(Qd.setValue(db,"toneMappingExposure",Tb.toneMappingExposure),cd.needsLights&&(Cc=Bh,ef.ambientLightColor.needsUpdate=Cc,ef.lightProbe.needsUpdate=
Cc,ef.directionalLights.needsUpdate=Cc,ef.directionalLightShadows.needsUpdate=Cc,ef.pointLights.needsUpdate=Cc,ef.pointLightShadows.needsUpdate=Cc,ef.spotLights.needsUpdate=Cc,ef.spotLightShadows.needsUpdate=Cc,ef.rectAreaLights.needsUpdate=Cc,ef.hemisphereLights.needsUpdate=Cc),cb&&!0===qb.fog&&Nn.refreshFogUniforms(ef,cb),Nn.refreshMaterialUniforms(ef,qb,Gb,ib,Xb.state.transmissionRenderTarget[qa.id]),za.upload(db,aa(cd),ef,Ke));qb.isShaderMaterial&&!0===qb.uniformsNeedUpdate&&(za.upload(db,aa(cd),
ef,Ke),qb.uniformsNeedUpdate=!1);qb.isSpriteMaterial&&Qd.setValue(db,"center",Wa.center);Qd.setValue(db,"modelViewMatrix",Wa.modelViewMatrix);Qd.setValue(db,"normalMatrix",Wa.normalMatrix);Qd.setValue(db,"modelMatrix",Wa.matrixWorld);if(qb.isShaderMaterial||qb.isRawShaderMaterial){qa=qb.uniformsGroups;for(let Dn=0,Vn=qa.length;Dn<Vn;Dn++)cb=qa[Dn],Kn.update(cb,De),Kn.bind(cb,De)}cb=De;ne.setMaterial(qb,uc);uc=xb.index;Cc=1;if(!0===qb.wireframe){uc=Mn.getWireframeAttribute(xb);if(void 0===uc)return;
Cc=2}cd=xb.drawRange;be=xb.attributes.position;qa=cd.start*Cc;cd=(cd.start+cd.count)*Cc;null!==nc&&(qa=Math.max(qa,nc.start*Cc),cd=Math.min(cd,(nc.start+nc.count)*Cc));null!==uc?(qa=Math.max(qa,0),cd=Math.min(cd,uc.count)):void 0!==be&&null!==be&&(qa=Math.max(qa,0),cd=Math.min(cd,be.count));Cc=cd-qa;if(!(0>Cc||Infinity===Cc))if(fn.setup(Wa,qb,cb,xb,uc),nc=Tn,null!==uc&&(cb=yn.get(uc),nc=Un,nc.setIndex(cb)),Wa.isMesh?!0===qb.wireframe?(ne.setLineWidth(qb.wireframeLinewidth*(null===cc?Gb:1)),nc.setMode(db.LINES)):
nc.setMode(db.TRIANGLES):Wa.isLine?(cb=qb.linewidth,void 0===cb&&(cb=1),ne.setLineWidth(cb*(null===cc?Gb:1)),Wa.isLineSegments?nc.setMode(db.LINES):Wa.isLineLoop?nc.setMode(db.LINE_LOOP):nc.setMode(db.LINE_STRIP)):Wa.isPoints?nc.setMode(db.POINTS):Wa.isSprite&&nc.setMode(db.TRIANGLES),Wa.isBatchedMesh)if(null!==Wa._multiDrawInstances)nc.renderMultiDrawInstances(Wa._multiDrawStarts,Wa._multiDrawCounts,Wa._multiDrawCount,Wa._multiDrawInstances);else if(kh.get("WEBGL_multi_draw"))nc.renderMultiDraw(Wa._multiDrawStarts,
Wa._multiDrawCounts,Wa._multiDrawCount);else for(xb=Wa._multiDrawStarts,qa=Wa._multiDrawCounts,Wa=Wa._multiDrawCount,uc=uc?yn.get(uc).bytesPerElement:1,qb=Be.get(qb).currentProgram.getUniforms(),cb=0;cb<Wa;cb++)qb.setValue(db,"_gl_DrawID",cb),nc.render(xb[cb]/uc,qa[cb]);else Wa.isInstancedMesh?nc.renderInstances(qa,Cc,Wa.count):xb.isInstancedBufferGeometry?nc.renderInstances(qa,Cc,Math.min(xb.instanceCount,void 0!==xb._maxInstanceCount?xb._maxInstanceCount:Infinity)):nc.render(qa,Cc)};this.compile=
function(qa,cb,xb=null){null===xb&&(xb=qa);Xb=Jn.get(xb);Xb.init(cb);wc.push(Xb);xb.traverseVisible(function(Wa){Wa.isLight&&Wa.layers.test(cb.layers)&&(Xb.pushLight(Wa),Wa.castShadow&&Xb.pushShadow(Wa))});qa!==xb&&qa.traverseVisible(function(Wa){Wa.isLight&&Wa.layers.test(cb.layers)&&(Xb.pushLight(Wa),Wa.castShadow&&Xb.pushShadow(Wa))});Xb.setupLights();const qb=new Set;qa.traverse(function(Wa){if(Wa.isMesh||Wa.isPoints||Wa.isLine||Wa.isSprite){var nc=Wa.material;if(nc)if(Array.isArray(nc))for(let uc=
0;uc<nc.length;uc++){const Cc=nc[uc];x(Cc,xb,Wa);qb.add(Cc)}else x(nc,xb,Wa),qb.add(nc)}});wc.pop();Xb=null;return qb};this.compileAsync=function(qa,cb,xb=null){const qb=this.compile(qa,cb,xb);return new Promise(Wa=>{function nc(){qb.forEach(function(uc){Be.get(uc).currentProgram.isReady()&&qb.delete(uc)});0===qb.size?Wa(qa):setTimeout(nc,10)}null!==kh.get("KHR_parallel_shader_compile")?nc():setTimeout(nc,10)})};let Qn=null;const gn=new Jc;gn.setAnimationLoop(function(qa){Qn&&Qn(qa)});"undefined"!==
typeof self&&gn.setContext(self);this.setAnimationLoop=function(qa){Qn=qa;Wh.setAnimationLoop(qa);null===qa?gn.stop():gn.start()};Wh.addEventListener("sessionstart",y);Wh.addEventListener("sessionend",D);this.render=function(qa,cb){if(void 0!==cb&&!0!==cb.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!0!==Hb){!0===qa.matrixWorldAutoUpdate&&qa.updateMatrixWorld();null===cb.parent&&!0===cb.matrixWorldAutoUpdate&&cb.updateMatrixWorld();!0===
Wh.enabled&&!0===Wh.isPresenting&&(!0===Wh.cameraAutoUpdate&&Wh.updateCamera(cb),cb=Wh.getCamera());if(!0===qa.isScene)qa.onBeforeRender(Tb,qa,cb,cc);Xb=Jn.get(qa,wc.length);Xb.init(cb);wc.push(Xb);dn.multiplyMatrices(cb.projectionMatrix,cb.matrixWorldInverse);Ae.setFromProjectionMatrix(dn);Mj=this.localClippingEnabled;Dd=Uk.init(this.clippingPlanes,Mj);Wb=In.get(qa,ad.length);Wb.init();ad.push(Wb);if(!0===Wh.enabled&&!0===Wh.isPresenting){var xb=Tb.xr.getDepthSensingMesh();null!==xb&&H(xb,cb,-Infinity,
Tb.sortObjects)}H(qa,cb,0,Tb.sortObjects);Wb.finish();!0===Tb.sortObjects&&Wb.sort(Yb,rc);(en=!1===Wh.enabled||!1===Wh.isPresenting||!1===Wh.hasDepthSensing())&&mk.addToRenderList(Wb,qa);this.info.render.frame++;!0===Dd&&Uk.beginShadows();Al.render(Xb.state.shadowsArray,qa,cb);!0===Dd&&Uk.endShadows();!0===this.info.autoReset&&this.info.reset();var qb=Wb.opaque,Wa=Wb.transmissive;Xb.setupLights();if(cb.isArrayCamera){xb=cb.cameras;if(0<Wa.length)for(let nc=0,uc=xb.length;nc<uc;nc++)L(qb,Wa,qa,xb[nc]);
en&&mk.render(qa);for(let nc=0,uc=xb.length;nc<uc;nc++)qb=xb[nc],I(Wb,qa,qb,qb.viewport)}else 0<Wa.length&&L(qb,Wa,qa,cb),en&&mk.render(qa),I(Wb,qa,cb);null!==cc&&(Ke.updateMultisampleRenderTarget(cc),Ke.updateRenderTargetMipmap(cc));if(!0===qa.isScene)qa.onAfterRender(Tb,qa,cb);fn.resetDefaultState();sa=-1;ka=null;wc.pop();0<wc.length?(Xb=wc[wc.length-1],!0===Dd&&Uk.setGlobalState(Tb.clippingPlanes,Xb.state.camera)):Xb=null;ad.pop();Wb=0<ad.length?ad[ad.length-1]:null}};this.getActiveCubeFace=function(){return Ub};
this.getActiveMipmapLevel=function(){return zc};this.getRenderTarget=function(){return cc};this.setRenderTargetTextures=function(qa,cb,xb){Be.get(qa.texture).__webglTexture=cb;Be.get(qa.depthTexture).__webglTexture=xb;qa=Be.get(qa);qa.__hasExternalTextures=!0;qa.__autoAllocateDepthBuffer=void 0===xb;qa.__autoAllocateDepthBuffer||!0!==kh.has("WEBGL_multisampled_render_to_texture")||(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),
qa.__useRenderToTexture=!1)};this.setRenderTargetFramebuffer=function(qa,cb){qa=Be.get(qa);qa.__webglFramebuffer=cb;qa.__useDefaultFramebuffer=void 0===cb};this.setRenderTarget=function(qa,cb=0,xb=0){cc=qa;Ub=cb;zc=xb;let qb=!0;var Wa=null;let nc=!1,uc=!1;if(qa){Wa=Be.get(qa);if(void 0!==Wa.__useDefaultFramebuffer)ne.bindFramebuffer(db.FRAMEBUFFER,null),qb=!1;else if(void 0===Wa.__webglFramebuffer)Ke.setupRenderTarget(qa);else if(Wa.__hasExternalTextures)Ke.rebindTextures(qa,Be.get(qa.texture).__webglTexture,
Be.get(qa.depthTexture).__webglTexture);else if(qa.depthBuffer){const Cc=qa.depthTexture;if(Wa.__boundDepthTexture!==Cc){if(null!==Cc&&Be.has(Cc)&&(qa.width!==Cc.image.width||qa.height!==Cc.image.height))throw Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ke.setupDepthRenderbuffer(qa)}}Wa=qa.texture;if(Wa.isData3DTexture||Wa.isDataArrayTexture||Wa.isCompressedArrayTexture)uc=!0;Wa=Be.get(qa).__webglFramebuffer;qa.isWebGLCubeRenderTarget?(Wa=Array.isArray(Wa[cb])?
Wa[cb][xb]:Wa[cb],nc=!0):Wa=0<qa.samples&&!1===Ke.useMultisampledRTT(qa)?Be.get(qa).__webglMultisampledFramebuffer:Array.isArray(Wa)?Wa[xb]:Wa;wa.copy(qa.viewport);Oa.copy(qa.scissor);Ya=qa.scissorTest}else wa.copy(pc).multiplyScalar(Gb).floor(),Oa.copy(Kd).multiplyScalar(Gb).floor(),Ya=bd;ne.bindFramebuffer(db.FRAMEBUFFER,Wa)&&qb&&ne.drawBuffers(qa,Wa);ne.viewport(wa);ne.scissor(Oa);ne.setScissorTest(Ya);nc?(qa=Be.get(qa.texture),db.framebufferTexture2D(db.FRAMEBUFFER,db.COLOR_ATTACHMENT0,db.TEXTURE_CUBE_MAP_POSITIVE_X+
cb,qa.__webglTexture,xb)):uc&&(qa=Be.get(qa.texture),db.framebufferTextureLayer(db.FRAMEBUFFER,db.COLOR_ATTACHMENT0,qa.__webglTexture,xb||0,cb||0));sa=-1};this.readRenderTargetPixels=function(qa,cb,xb,qb,Wa,nc,uc){if(qa&&qa.isWebGLRenderTarget){var Cc=Be.get(qa).__webglFramebuffer;qa.isWebGLCubeRenderTarget&&void 0!==uc&&(Cc=Cc[uc]);if(Cc){ne.bindFramebuffer(db.FRAMEBUFFER,Cc);try{const be=qa.texture,De=be.format,Qd=be.type;Vh.textureFormatReadable(De)?Vh.textureTypeReadable(Qd)?0<=cb&&cb<=qa.width-
qb&&0<=xb&&xb<=qa.height-Wa&&db.readPixels(cb,xb,qb,Wa,zl.convert(De),zl.convert(Qd),nc):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.")}finally{qa=null!==cc?Be.get(cc).__webglFramebuffer:null,ne.bindFramebuffer(db.FRAMEBUFFER,qa)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};
this.readRenderTargetPixelsAsync=async function(qa,cb,xb,qb,Wa,nc,uc){if(!qa||!qa.isWebGLRenderTarget)throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Cc=Be.get(qa).__webglFramebuffer;qa.isWebGLCubeRenderTarget&&void 0!==uc&&(Cc=Cc[uc]);if(Cc){var be=qa.texture;uc=be.format;be=be.type;if(!Vh.textureFormatReadable(uc))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");
if(!Vh.textureTypeReadable(be))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(0<=cb&&cb<=qa.width-qb&&0<=xb&&xb<=qa.height-Wa)return ne.bindFramebuffer(db.FRAMEBUFFER,Cc),qa=db.createBuffer(),db.bindBuffer(db.PIXEL_PACK_BUFFER,qa),db.bufferData(db.PIXEL_PACK_BUFFER,nc.byteLength,db.STREAM_READ),db.readPixels(cb,xb,qb,Wa,zl.convert(uc),zl.convert(be),0),cb=null!==cc?Be.get(cc).__webglFramebuffer:null,ne.bindFramebuffer(db.FRAMEBUFFER,
cb),cb=db.fenceSync(db.SYNC_GPU_COMMANDS_COMPLETE,0),db.flush(),await na(db,cb,4),db.bindBuffer(db.PIXEL_PACK_BUFFER,qa),db.getBufferSubData(db.PIXEL_PACK_BUFFER,0,nc),db.deleteBuffer(qa),db.deleteSync(cb),nc;throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.");}};this.copyFramebufferToTexture=function(qa,cb=null,xb=0){!0!==qa.isTexture&&(Sb("WebGLRenderer: copyFramebufferToTexture function signature has changed."),cb=qa||null,qa=arguments[1]);var qb=
Math.pow(2,-xb);const Wa=Math.floor(qa.image.width*qb);qb=Math.floor(qa.image.height*qb);const nc=null!==cb?cb.x:0;cb=null!==cb?cb.y:0;Ke.setTexture2D(qa,0);db.copyTexSubImage2D(db.TEXTURE_2D,xb,0,0,nc,cb,Wa,qb);ne.unbindTexture()};this.copyTextureToTexture=function(qa,cb,xb=null,qb=null,Wa=0){!0!==qa.isTexture&&(Sb("WebGLRenderer: copyTextureToTexture function signature has changed."),qb=qa||null,qa=cb,cb=arguments[2],Wa=arguments[3]||0,xb=null);let nc,uc,Cc,be;null!==xb?(nc=xb.max.x-xb.min.x,uc=
xb.max.y-xb.min.y,Cc=xb.min.x,xb=xb.min.y):(nc=qa.image.width,uc=qa.image.height,xb=Cc=0);null!==qb?(be=qb.x,qb=qb.y):qb=be=0;const De=zl.convert(cb.format),Qd=zl.convert(cb.type);Ke.setTexture2D(cb,0);db.pixelStorei(db.UNPACK_FLIP_Y_WEBGL,cb.flipY);db.pixelStorei(db.UNPACK_PREMULTIPLY_ALPHA_WEBGL,cb.premultiplyAlpha);db.pixelStorei(db.UNPACK_ALIGNMENT,cb.unpackAlignment);const ef=db.getParameter(db.UNPACK_ROW_LENGTH),lh=db.getParameter(db.UNPACK_IMAGE_HEIGHT),Bh=db.getParameter(db.UNPACK_SKIP_PIXELS),
Rd=db.getParameter(db.UNPACK_SKIP_ROWS),Bl=db.getParameter(db.UNPACK_SKIP_IMAGES),cd=qa.isCompressedTexture?qa.mipmaps[Wa]:qa.image;db.pixelStorei(db.UNPACK_ROW_LENGTH,cd.width);db.pixelStorei(db.UNPACK_IMAGE_HEIGHT,cd.height);db.pixelStorei(db.UNPACK_SKIP_PIXELS,Cc);db.pixelStorei(db.UNPACK_SKIP_ROWS,xb);qa.isDataTexture?db.texSubImage2D(db.TEXTURE_2D,Wa,be,qb,nc,uc,De,Qd,cd.data):qa.isCompressedTexture?db.compressedTexSubImage2D(db.TEXTURE_2D,Wa,be,qb,cd.width,cd.height,De,cd.data):db.texSubImage2D(db.TEXTURE_2D,
Wa,be,qb,nc,uc,De,Qd,cd);db.pixelStorei(db.UNPACK_ROW_LENGTH,ef);db.pixelStorei(db.UNPACK_IMAGE_HEIGHT,lh);db.pixelStorei(db.UNPACK_SKIP_PIXELS,Bh);db.pixelStorei(db.UNPACK_SKIP_ROWS,Rd);db.pixelStorei(db.UNPACK_SKIP_IMAGES,Bl);0===Wa&&cb.generateMipmaps&&db.generateMipmap(db.TEXTURE_2D);ne.unbindTexture()};this.copyTextureToTexture3D=function(qa,cb,xb=null,qb=null,Wa=0){!0!==qa.isTexture&&(Sb("WebGLRenderer: copyTextureToTexture3D function signature has changed."),xb=qa||null,qb=cb||null,qa=arguments[2],
cb=arguments[3],Wa=arguments[4]||0);let nc,uc,Cc,be,De,Qd,ef;const lh=qa.isCompressedTexture?qa.mipmaps[Wa]:qa.image;null!==xb?(nc=xb.max.x-xb.min.x,uc=xb.max.y-xb.min.y,Cc=xb.max.z-xb.min.z,be=xb.min.x,De=xb.min.y,xb=xb.min.z):(nc=lh.width,uc=lh.height,Cc=lh.depth,xb=De=be=0);null!==qb?(Qd=qb.x,ef=qb.y,qb=qb.z):qb=ef=Qd=0;const Bh=zl.convert(cb.format),Rd=zl.convert(cb.type);let Bl;if(cb.isData3DTexture)Ke.setTexture3D(cb,0),Bl=db.TEXTURE_3D;else if(cb.isDataArrayTexture||cb.isCompressedArrayTexture)Ke.setTexture2DArray(cb,
0),Bl=db.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}db.pixelStorei(db.UNPACK_FLIP_Y_WEBGL,cb.flipY);db.pixelStorei(db.UNPACK_PREMULTIPLY_ALPHA_WEBGL,cb.premultiplyAlpha);db.pixelStorei(db.UNPACK_ALIGNMENT,cb.unpackAlignment);const cd=db.getParameter(db.UNPACK_ROW_LENGTH),On=db.getParameter(db.UNPACK_IMAGE_HEIGHT),Pn=db.getParameter(db.UNPACK_SKIP_PIXELS),of=db.getParameter(db.UNPACK_SKIP_ROWS),
Dn=db.getParameter(db.UNPACK_SKIP_IMAGES);db.pixelStorei(db.UNPACK_ROW_LENGTH,lh.width);db.pixelStorei(db.UNPACK_IMAGE_HEIGHT,lh.height);db.pixelStorei(db.UNPACK_SKIP_PIXELS,be);db.pixelStorei(db.UNPACK_SKIP_ROWS,De);db.pixelStorei(db.UNPACK_SKIP_IMAGES,xb);qa.isDataTexture||qa.isData3DTexture?db.texSubImage3D(Bl,Wa,Qd,ef,qb,nc,uc,Cc,Bh,Rd,lh.data):cb.isCompressedArrayTexture?db.compressedTexSubImage3D(Bl,Wa,Qd,ef,qb,nc,uc,Cc,Bh,lh.data):db.texSubImage3D(Bl,Wa,Qd,ef,qb,nc,uc,Cc,Bh,Rd,lh);db.pixelStorei(db.UNPACK_ROW_LENGTH,
cd);db.pixelStorei(db.UNPACK_IMAGE_HEIGHT,On);db.pixelStorei(db.UNPACK_SKIP_PIXELS,Pn);db.pixelStorei(db.UNPACK_SKIP_ROWS,of);db.pixelStorei(db.UNPACK_SKIP_IMAGES,Dn);0===Wa&&cb.generateMipmaps&&db.generateMipmap(Bl);ne.unbindTexture()};this.initRenderTarget=function(qa){void 0===Be.get(qa).__webglFramebuffer&&Ke.setupRenderTarget(qa)};this.initTexture=function(qa){qa.isCubeTexture?Ke.setTextureCube(qa,0):qa.isData3DTexture?Ke.setTexture3D(qa,0):qa.isDataArrayTexture||qa.isCompressedArrayTexture?
Ke.setTexture2DArray(qa,0):Ke.setTexture2D(qa,0);ne.unbindTexture()};this.resetState=function(){zc=Ub=0;cc=null;ne.reset();fn.reset()};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return 2E3}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;const c=this.getContext();c.drawingBufferColorSpace="display-p3"===a?"display-p3":"srgb";c.unpackColorSpace="display-p3-linear"===
Eb.workingColorSpace?"display-p3":"srgb"}}class ff{constructor(a,c=2.5E-4){this.isFogExp2=!0;this.name="";this.color=new ia(a);this.density=c}clone(){return new ff(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class we{constructor(a,c=1,e=1E3){this.isFog=!0;this.name="";this.color=new ia(a);this.near=c;this.far=e}clone(){return new we(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),
near:this.near,far:this.far}}}class ie extends Nd{constructor(){super();this.isScene=!0;this.type="Scene";this.fog=this.environment=this.background=null;this.backgroundBlurriness=0;this.backgroundIntensity=1;this.backgroundRotation=new Qg;this.environmentIntensity=1;this.environmentRotation=new Qg;this.overrideMaterial=null;"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,c){super.copy(a,c);null!==a.background&&(this.background=
a.background.clone());null!==a.environment&&(this.environment=a.environment.clone());null!==a.fog&&(this.fog=a.fog.clone());this.backgroundBlurriness=a.backgroundBlurriness;this.backgroundIntensity=a.backgroundIntensity;this.backgroundRotation.copy(a.backgroundRotation);this.environmentIntensity=a.environmentIntensity;this.environmentRotation.copy(a.environmentRotation);null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.matrixAutoUpdate=a.matrixAutoUpdate;return this}toJSON(a){a=
super.toJSON(a);null!==this.fog&&(a.object.fog=this.fog.toJSON());0<this.backgroundBlurriness&&(a.object.backgroundBlurriness=this.backgroundBlurriness);1!==this.backgroundIntensity&&(a.object.backgroundIntensity=this.backgroundIntensity);a.object.backgroundRotation=this.backgroundRotation.toArray();1!==this.environmentIntensity&&(a.object.environmentIntensity=this.environmentIntensity);a.object.environmentRotation=this.environmentRotation.toArray();return a}}class oe{constructor(a,c){this.isInterleavedBuffer=
!0;this.array=a;this.stride=c;this.count=void 0!==a?a.length/c:0;this.usage=35044;this.updateRanges=[];this.version=0;this.uuid=Na()}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){this.usage=a;return this}addUpdateRange(a,c){this.updateRanges.push({start:a,count:c})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=a.stride;this.usage=a.usage;return this}copyAt(a,c,e){a*=this.stride;e*=c.stride;
for(let h=0,l=this.stride;h<l;h++)this.array[a+h]=c.array[e+h];return this}set(a,c=0){this.array.set(a,c);return this}clone(a){void 0===a.arrayBuffers&&(a.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Na());void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);a=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]);a=new this.constructor(a,this.stride);a.setUsage(this.usage);return a}onUpload(a){this.onUploadCallback=
a;return this}toJSON(a){void 0===a.arrayBuffers&&(a.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Na());void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer)));return{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ce=new Da;class pf{constructor(a,c,e,h=!1){this.isInterleavedBufferAttribute=!0;this.name="";this.data=a;this.itemSize=
c;this.offset=e;this.normalized=h}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=a}applyMatrix4(a){for(let c=0,e=this.data.count;c<e;c++)ce.fromBufferAttribute(this,c),ce.applyMatrix4(a),this.setXYZ(c,ce.x,ce.y,ce.z);return this}applyNormalMatrix(a){for(let c=0,e=this.count;c<e;c++)ce.fromBufferAttribute(this,c),ce.applyNormalMatrix(a),this.setXYZ(c,ce.x,ce.y,ce.z);return this}transformDirection(a){for(let c=0,e=this.count;c<e;c++)ce.fromBufferAttribute(this,
c),ce.transformDirection(a),this.setXYZ(c,ce.x,ce.y,ce.z);return this}getComponent(a,c){a=this.array[a*this.data.stride+this.offset+c];this.normalized&&(a=v(a,this.array));return a}setComponent(a,c,e){this.normalized&&(e=ta(e,this.array));this.data.array[a*this.data.stride+this.offset+c]=e;return this}setX(a,c){this.normalized&&(c=ta(c,this.array));this.data.array[a*this.data.stride+this.offset]=c;return this}setY(a,c){this.normalized&&(c=ta(c,this.array));this.data.array[a*this.data.stride+this.offset+
1]=c;return this}setZ(a,c){this.normalized&&(c=ta(c,this.array));this.data.array[a*this.data.stride+this.offset+2]=c;return this}setW(a,c){this.normalized&&(c=ta(c,this.array));this.data.array[a*this.data.stride+this.offset+3]=c;return this}getX(a){a=this.data.array[a*this.data.stride+this.offset];this.normalized&&(a=v(a,this.array));return a}getY(a){a=this.data.array[a*this.data.stride+this.offset+1];this.normalized&&(a=v(a,this.array));return a}getZ(a){a=this.data.array[a*this.data.stride+this.offset+
2];this.normalized&&(a=v(a,this.array));return a}getW(a){a=this.data.array[a*this.data.stride+this.offset+3];this.normalized&&(a=v(a,this.array));return a}setXY(a,c,e){a=a*this.data.stride+this.offset;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array));this.data.array[a+0]=c;this.data.array[a+1]=e;return this}setXYZ(a,c,e,h){a=a*this.data.stride+this.offset;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array));this.data.array[a+0]=c;this.data.array[a+1]=e;this.data.array[a+
2]=h;return this}setXYZW(a,c,e,h,l){a=a*this.data.stride+this.offset;this.normalized&&(c=ta(c,this.array),e=ta(e,this.array),h=ta(h,this.array),l=ta(l,this.array));this.data.array[a+0]=c;this.data.array[a+1]=e;this.data.array[a+2]=h;this.data.array[a+3]=l;return this}clone(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");a=[];for(let c=0;c<this.count;c++){const e=c*this.data.stride+this.offset;for(let h=
0;h<this.itemSize;h++)a.push(this.data.array[e+h])}return new mc(new this.array.constructor(a),this.itemSize,this.normalized)}void 0===a.interleavedBuffers&&(a.interleavedBuffers={});void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a));return new pf(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");
a=[];for(let c=0;c<this.count;c++){const e=c*this.data.stride+this.offset;for(let h=0;h<this.itemSize;h++)a.push(this.data.array[e+h])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}void 0===a.interleavedBuffers&&(a.interleavedBuffers={});void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a));return{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}
class $i extends Sa{constructor(a){super();this.isSpriteMaterial=!0;this.type="SpriteMaterial";this.color=new ia(16777215);this.alphaMap=this.map=null;this.rotation=0;this.fog=this.transparent=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.rotation=a.rotation;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}let xf;const Ch=new Da,Xh=new Da,Dh=new Da,Fe=new Lb,Se=new Lb,rg=new Wc,Hj=new Da,ek=new Da,
sl=new Da,cf=new Lb,Yk=new Lb,nh=new Lb;class rk extends Nd{constructor(a=new $i){super();this.isSprite=!0;this.type="Sprite";if(void 0===xf){xf=new Xc;var c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);c=new oe(c,5);xf.setIndex([0,1,2,0,2,3]);xf.setAttribute("position",new pf(c,3,0,!1));xf.setAttribute("uv",new pf(c,2,3,!1))}this.geometry=xf;this.material=a;this.center=new Lb(.5,.5)}raycast(a,c){null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');
Xh.setFromMatrixScale(this.matrixWorld);rg.copy(a.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld);Dh.setFromMatrixPosition(this.modelViewMatrix);a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Xh.multiplyScalar(-Dh.z);var e=this.material.rotation;let h;if(0!==e){h=Math.cos(e);var l=Math.sin(e)}e=this.center;sh(Hj.set(-.5,-.5,0),Dh,e,Xh,l,h);sh(ek.set(.5,-.5,0),Dh,e,Xh,l,h);sh(sl.set(.5,.5,0),Dh,e,Xh,l,h);cf.set(0,0);Yk.set(1,
0);nh.set(1,1);let p=a.ray.intersectTriangle(Hj,ek,sl,!1,Ch);if(null===p&&(sh(ek.set(-.5,.5,0),Dh,e,Xh,l,h),Yk.set(0,1),p=a.ray.intersectTriangle(Hj,sl,ek,!1,Ch),null===p))return;l=a.ray.origin.distanceTo(Ch);l<a.near||l>a.far||c.push({distance:l,point:Ch.clone(),uv:E.getInterpolation(Ch,Hj,ek,sl,cf,Yk,nh,new Lb),face:null,object:this})}copy(a,c){super.copy(a,c);void 0!==a.center&&this.center.copy(a.center);this.material=a.material;return this}}const Wi=new Da,sk=new Da;class lg extends Nd{constructor(){super();
this._currentLevel=0;this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}});this.autoUpdate=!0}copy(a){super.copy(a,!1);const c=a.levels;for(let e=0,h=c.length;e<h;e++){const l=c[e];this.addLevel(l.object.clone(),l.distance,l.hysteresis)}this.autoUpdate=a.autoUpdate;return this}addLevel(a,c=0,e=0){c=Math.abs(c);const h=this.levels;let l;for(l=0;l<h.length&&!(c<h[l].distance);l++);h.splice(l,0,{distance:c,hysteresis:e,object:a});this.add(a);return this}removeLevel(a){const c=
this.levels;for(let e=0;e<c.length;e++)if(c[e].distance===a)return a=c.splice(e,1),this.remove(a[0].object),!0;return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(a){const c=this.levels;if(0<c.length){let e,h;e=1;for(h=c.length;e<h;e++){let l=c[e].distance;c[e].object.visible&&(l-=l*c[e].hysteresis);if(a<l)break}return c[e-1].object}return null}raycast(a,c){if(0<this.levels.length){Wi.setFromMatrixPosition(this.matrixWorld);const e=a.ray.origin.distanceTo(Wi);this.getObjectForDistance(e).raycast(a,
c)}}update(a){const c=this.levels;if(1<c.length){Wi.setFromMatrixPosition(a.matrixWorld);sk.setFromMatrixPosition(this.matrixWorld);a=Wi.distanceTo(sk)/a.zoom;c[0].object.visible=!0;let e,h;e=1;for(h=c.length;e<h;e++){let l=c[e].distance;c[e].object.visible&&(l-=l*c[e].hysteresis);if(a>=l)c[e-1].object.visible=!1,c[e].object.visible=!0;else break}for(this._currentLevel=e-1;e<h;e++)c[e].object.visible=!1}}toJSON(a){a=super.toJSON(a);!1===this.autoUpdate&&(a.object.autoUpdate=!1);a.object.levels=[];
const c=this.levels;for(let e=0,h=c.length;e<h;e++){const l=c[e];a.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return a}}const ig=new Da,Yh=new yd,oi=new yd,Bn=new Da,jn=new Wc,Vk=new Da,Sl=new $e,se=new Wc,Wk=new wh;class Cl extends nf{constructor(a,c){super(a,c);this.isSkinnedMesh=!0;this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new Wc;this.bindMatrixInverse=new Wc;this.boundingSphere=this.boundingBox=null}computeBoundingBox(){var a=
this.geometry;null===this.boundingBox&&(this.boundingBox=new fe);this.boundingBox.makeEmpty();a=a.getAttribute("position");for(let c=0;c<a.count;c++)this.getVertexPosition(c,Vk),this.boundingBox.expandByPoint(Vk)}computeBoundingSphere(){var a=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new $e);this.boundingSphere.makeEmpty();a=a.getAttribute("position");for(let c=0;c<a.count;c++)this.getVertexPosition(c,Vk),this.boundingSphere.expandByPoint(Vk)}copy(a,c){super.copy(a,c);this.bindMode=
a.bindMode;this.bindMatrix.copy(a.bindMatrix);this.bindMatrixInverse.copy(a.bindMatrixInverse);this.skeleton=a.skeleton;null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this}raycast(a,c){const e=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Sl.copy(this.boundingSphere),Sl.applyMatrix4(e),!1!==a.ray.intersectsSphere(Sl)&&(se.copy(e).invert(),Wk.copy(a.ray).applyMatrix4(se),
null!==this.boundingBox&&!1===Wk.intersectsBox(this.boundingBox)||this._computeIntersections(a,c,Wk)))}getVertexPosition(a,c){super.getVertexPosition(a,c);this.applyBoneTransform(a,c);return c}bind(a,c){this.skeleton=a;void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld);this.bindMatrix.copy(c);this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const a=new yd,c=this.geometry.attributes.skinWeight;for(let e=0,h=c.count;e<
h;e++){a.fromBufferAttribute(c,e);const l=1/a.manhattanLength();Infinity!==l?a.multiplyScalar(l):a.set(1,0,0,0);c.setXYZW(e,a.x,a.y,a.z,a.w)}}updateMatrixWorld(a){super.updateMatrixWorld(a);"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(a,c){const e=this.skeleton;var h=this.geometry;Yh.fromBufferAttribute(h.attributes.skinIndex,
a);oi.fromBufferAttribute(h.attributes.skinWeight,a);ig.copy(c).applyMatrix4(this.bindMatrix);c.set(0,0,0);for(a=0;4>a;a++)if(h=oi.getComponent(a),0!==h){const l=Yh.getComponent(a);jn.multiplyMatrices(e.bones[l].matrixWorld,e.boneInverses[l]);c.addScaledVector(Bn.copy(ig).applyMatrix4(jn),h)}return c.applyMatrix4(this.bindMatrixInverse)}}class pi extends Nd{constructor(){super();this.isBone=!0;this.type="Bone"}}class jg extends Ld{constructor(a=null,c=1,e=1,h,l,p,w,x,y=1003,D=1003,H,I){super(null,
p,w,x,y,D,h,l,H,I);this.isDataTexture=!0;this.image={data:a,width:c,height:e};this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}const oj=new Wc,pj=new Wc;class nk{constructor(a=[],c=[]){this.uuid=Na();this.bones=a.slice(0);this.boneInverses=c;this.boneTexture=this.boneMatrices=null;this.init()}init(){const a=this.bones,c=this.boneInverses;this.boneMatrices=new Float32Array(16*a.length);if(0===c.length)this.calculateInverses();else if(a.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.");
this.boneInverses=[];for(let e=0,h=this.bones.length;e<h;e++)this.boneInverses.push(new Wc)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,c=this.bones.length;a<c;a++){const e=new Wc;this.bones[a]&&e.copy(this.bones[a].matrixWorld).invert();this.boneInverses.push(e)}}pose(){for(let c=0,e=this.bones.length;c<e;c++){var a=this.bones[c];a&&a.matrixWorld.copy(this.boneInverses[c]).invert()}for(let c=0,e=this.bones.length;c<e;c++)if(a=this.bones[c])a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),
a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)}update(){const a=this.bones,c=this.boneInverses,e=this.boneMatrices,h=this.boneTexture;for(let l=0,p=a.length;l<p;l++)oj.multiplyMatrices(a[l]?a[l].matrixWorld:pj,c[l]),oj.toArray(e,16*l);null!==h&&(h.needsUpdate=!0)}clone(){return new nk(this.bones,this.boneInverses)}computeBoneTexture(){var a=Math.sqrt(4*this.bones.length);a=4*Math.ceil(a/4);a=Math.max(a,4);const c=new Float32Array(a*
a*4);c.set(this.boneMatrices);a=new jg(c,a,a,1023,1015);a.needsUpdate=!0;this.boneMatrices=c;this.boneTexture=a;return this}getBoneByName(a){for(let c=0,e=this.bones.length;c<e;c++){const h=this.bones[c];if(h.name===a)return h}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,c){this.uuid=a.uuid;for(let e=0,h=a.bones.length;e<h;e++){const l=a.bones[e];let p=c[l];void 0===p&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),p=new pi);this.bones.push(p);
this.boneInverses.push((new Wc).fromArray(a.boneInverses[e]))}this.init();return this}toJSON(){const a={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;const c=this.bones,e=this.boneInverses;for(let h=0,l=c.length;h<l;h++)a.bones.push(c[h].uuid),a.boneInverses.push(e[h].toArray());return a}}class Fh extends mc{constructor(a,c,e,h=1){super(a,c,e);this.isInstancedBufferAttribute=!0;this.meshPerAttribute=h}copy(a){super.copy(a);this.meshPerAttribute=
a.meshPerAttribute;return this}toJSON(){const a=super.toJSON();a.meshPerAttribute=this.meshPerAttribute;a.isInstancedBufferAttribute=!0;return a}}const Xk=new Wc,pk=new Wc,Oj=[],rj=new fe,Xi=new Wc,si=new nf,mg=new $e;class ik extends nf{constructor(a,c,e){super(a,c);this.isInstancedMesh=!0;this.instanceMatrix=new Fh(new Float32Array(16*e),16);this.morphTexture=this.instanceColor=null;this.count=e;this.boundingSphere=this.boundingBox=null;for(a=0;a<e;a++)this.setMatrixAt(a,Xi)}computeBoundingBox(){const a=
this.geometry,c=this.count;null===this.boundingBox&&(this.boundingBox=new fe);null===a.boundingBox&&a.computeBoundingBox();this.boundingBox.makeEmpty();for(let e=0;e<c;e++)this.getMatrixAt(e,Xk),rj.copy(a.boundingBox).applyMatrix4(Xk),this.boundingBox.union(rj)}computeBoundingSphere(){const a=this.geometry,c=this.count;null===this.boundingSphere&&(this.boundingSphere=new $e);null===a.boundingSphere&&a.computeBoundingSphere();this.boundingSphere.makeEmpty();for(let e=0;e<c;e++)this.getMatrixAt(e,Xk),
mg.copy(a.boundingSphere).applyMatrix4(Xk),this.boundingSphere.union(mg)}copy(a,c){super.copy(a,c);this.instanceMatrix.copy(a.instanceMatrix);null!==a.morphTexture&&(this.morphTexture=a.morphTexture.clone());null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone());this.count=a.count;null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this}getColorAt(a,c){c.fromArray(this.instanceColor.array,3*a)}getMatrixAt(a,
c){c.fromArray(this.instanceMatrix.array,16*a)}getMorphAt(a,c){c=c.morphTargetInfluences;const e=this.morphTexture.source.data.data;a=a*(c.length+1)+1;for(let h=0;h<c.length;h++)c[h]=e[a+h]}raycast(a,c){const e=this.matrixWorld,h=this.count;si.geometry=this.geometry;si.material=this.material;if(void 0!==si.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),mg.copy(this.boundingSphere),mg.applyMatrix4(e),!1!==a.ray.intersectsSphere(mg)))for(let l=0;l<h;l++){this.getMatrixAt(l,Xk);
pk.multiplyMatrices(e,Xk);si.matrixWorld=pk;si.raycast(a,Oj);for(let p=0,w=Oj.length;p<w;p++){const x=Oj[p];x.instanceId=l;x.object=this;c.push(x)}Oj.length=0}}setColorAt(a,c){null===this.instanceColor&&(this.instanceColor=new Fh((new Float32Array(3*this.instanceMatrix.count)).fill(1),3));c.toArray(this.instanceColor.array,3*a)}setMatrixAt(a,c){c.toArray(this.instanceMatrix.array,16*a)}setMorphAt(a,c){c=c.morphTargetInfluences;const e=c.length+1;null===this.morphTexture&&(this.morphTexture=new jg(new Float32Array(e*
this.count),e,this.count,1028,1015));const h=this.morphTexture.source.data.data;let l=0;for(let p=0;p<c.length;p++)l+=c[p];a*=e;h[a]=this.geometry.morphTargetsRelative?1:1-l;h.set(c,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"});null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null);return this}}class El{constructor(){this.index=0;this.pool=[];this.list=[]}push(a,c,e){var h=this.pool;const l=this.list;this.index>=h.length&&h.push({start:-1,count:-1,
z:-1,index:-1});h=h[this.index];l.push(h);this.index++;h.start=a.start;h.count=a.count;h.z=c;h.index=e}reset(){this.index=this.list.length=0}}const Uh=new Wc,gm=new Wc,an=new Wc,Mm=new ia(1,1,1),ul=new Wc,Tl=new fk,cm=new fe,vl=new $e,dm=new Da,vm=new Da,aj=new Da,wm=new El,gd=new nf,Nm=[];class Tm extends nf{get maxInstanceCount(){return this._maxInstanceCount}constructor(a,c,e=2*c,h){super(new Xc,h);this.sortObjects=this.perObjectFrustumCulled=this.isBatchedMesh=!0;this.customSort=this.boundingSphere=
this.boundingBox=null;this._drawInfo=[];this._availableInstanceIds=[];this._drawRanges=[];this._reservedRanges=[];this._bounds=[];this._maxInstanceCount=a;this._maxVertexCount=c;this._maxIndexCount=e;this._geometryInitialized=!1;this._geometryCount=0;this._multiDrawCounts=new Int32Array(a);this._multiDrawStarts=new Int32Array(a);this._multiDrawCount=0;this._multiDrawInstances=null;this._visibilityChanged=!0;this._colorsTexture=this._indirectTexture=this._matricesTexture=null;this._initMatricesTexture();
this._initIndirectTexture()}_initMatricesTexture(){let a=Math.sqrt(4*this._maxInstanceCount);a=4*Math.ceil(a/4);a=Math.max(a,4);const c=new Float32Array(a*a*4);this._matricesTexture=new jg(c,a,a,1023,1015)}_initIndirectTexture(){let a=Math.sqrt(this._maxInstanceCount);a=Math.ceil(a);const c=new Uint32Array(a*a);this._indirectTexture=new jg(c,a,a,1029,1014)}_initColorsTexture(){var a=Math.sqrt(this._maxInstanceCount);a=Math.ceil(a);const c=(new Float32Array(a*a*4)).fill(1);a=new jg(c,a,a,1023,1015);
a.colorSpace=Eb.workingColorSpace;this._colorsTexture=a}_initializeGeometry(a){const c=this.geometry,e=this._maxVertexCount,h=this._maxIndexCount;if(!1===this._geometryInitialized){for(const p in a.attributes){var l=a.getAttribute(p);const {array:w,itemSize:x,normalized:y}=l;l=new w.constructor(e*x);l=new mc(l,x,y);c.setAttribute(p,l)}null!==a.getIndex()&&(a=65535<e?new Uint32Array(h):new Uint16Array(h),c.setIndex(new mc(a,1)));this._geometryInitialized=!0}}_validateGeometry(a){const c=this.geometry;
if(!!a.getIndex()!==!!c.getIndex())throw Error('BatchedMesh: All geometries must consistently have "index".');for(const e in c.attributes){if(!a.hasAttribute(e))throw Error(`BatchedMesh: Added geometry missing "${e}". All geometries must have consistent attributes.`);const h=a.getAttribute(e),l=c.getAttribute(e);if(h.itemSize!==l.itemSize||h.normalized!==l.normalized)throw Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.");}}setCustomSort(a){this.customSort=
a;return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fe);const a=this.boundingBox,c=this._drawInfo;a.makeEmpty();for(let e=0,h=c.length;e<h;e++){if(!1===c[e].active)continue;const l=c[e].geometryIndex;this.getMatrixAt(e,Uh);this.getBoundingBoxAt(l,cm).applyMatrix4(Uh);a.union(cm)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $e);const a=this.boundingSphere,c=this._drawInfo;a.makeEmpty();for(let e=0,h=c.length;e<h;e++){if(!1===c[e].active)continue;
const l=c[e].geometryIndex;this.getMatrixAt(e,Uh);this.getBoundingSphereAt(l,vl).applyMatrix4(Uh);a.union(vl)}}addInstance(a){if(this._drawInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw Error("BatchedMesh: Maximum item count reached.");var c={visible:!0,active:!0,geometryIndex:a};0<this._availableInstanceIds.length?(a=this._availableInstanceIds.pop(),this._drawInfo[a]=c):(a=this._drawInfo.length,this._drawInfo.push(c));c=this._matricesTexture;an.toArray(c.image.data,
16*a);c.needsUpdate=!0;if(c=this._colorsTexture)Mm.toArray(c.image.data,4*a),c.needsUpdate=!0;return a}addGeometry(a,c=-1,e=-1){this._initializeGeometry(a);this._validateGeometry(a);if(this._drawInfo.length>=this._maxInstanceCount)throw Error("BatchedMesh: Maximum item count reached.");const h={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let l=null;const p=this._reservedRanges,w=this._drawRanges,x=this._bounds;0!==this._geometryCount&&(l=p[p.length-1]);h.vertexCount=-1===c?a.getAttribute("position").count:
c;h.vertexStart=null===l?0:l.vertexStart+l.vertexCount;const y=a.getIndex();if(c=null!==y)h.indexCount=-1===e?y.count:e,h.indexStart=null===l?0:l.indexStart+l.indexCount;if(-1!==h.indexStart&&h.indexStart+h.indexCount>this._maxIndexCount||h.vertexStart+h.vertexCount>this._maxVertexCount)throw Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");e=this._geometryCount;this._geometryCount++;p.push(h);w.push({start:c?h.indexStart:h.vertexStart,count:-1});x.push({boxInitialized:!1,
box:new fe,sphereInitialized:!1,sphere:new $e});this.setGeometryAt(e,a);return e}setGeometryAt(a,c){if(a>=this._geometryCount)throw Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(c);var e=this.geometry;const h=null!==e.getIndex();var l=e.getIndex();const p=c.getIndex(),w=this._reservedRanges[a];if(h&&p.count>w.indexCount||c.attributes.position.count>w.vertexCount)throw Error("BatchedMesh: Reserved space not large enough for provided geometry.");const x=w.vertexStart;
var y=w.vertexCount;for(const H in e.attributes){var D=c.getAttribute(H);const I=e.getAttribute(H);xk(D,I,x);const L=D.itemSize;for(let Y=D.count,P=y;Y<P;Y++){D=x+Y;for(let Z=0;Z<L;Z++)I.setComponent(D,Z,0)}I.needsUpdate=!0;I.addUpdateRange(x*L,y*L)}if(h){e=w.indexStart;for(y=0;y<p.count;y++)l.setX(e+y,x+p.getX(y));for(let H=p.count,I=w.indexCount;H<I;H++)l.setX(e+H,x);l.needsUpdate=!0;l.addUpdateRange(e,w.indexCount)}l=this._bounds[a];null!==c.boundingBox?(l.box.copy(c.boundingBox),l.boxInitialized=
!0):l.boxInitialized=!1;null!==c.boundingSphere?(l.sphere.copy(c.boundingSphere),l.sphereInitialized=!0):l.sphereInitialized=!1;l=this._drawRanges[a];c=c.getAttribute("position");l.count=h?p.count:c.count;this._visibilityChanged=!0;return a}deleteInstance(a){const c=this._drawInfo;if(a>=c.length||!1===c[a].active)return this;c[a].active=!1;this._availableInstanceIds.push(a);this._visibilityChanged=!0;return this}getBoundingBoxAt(a,c){if(a>=this._geometryCount)return null;const e=this._bounds[a],h=
e.box;var l=this.geometry;if(!1===e.boxInitialized){h.makeEmpty();const p=l.index;l=l.attributes.position;a=this._drawRanges[a];for(let w=a.start,x=a.start+a.count;w<x;w++)a=w,p&&(a=p.getX(a)),h.expandByPoint(dm.fromBufferAttribute(l,a));e.boxInitialized=!0}c.copy(h);return c}getBoundingSphereAt(a,c){if(a>=this._geometryCount)return null;const e=this._bounds[a],h=e.sphere;var l=this.geometry;if(!1===e.sphereInitialized){h.makeEmpty();this.getBoundingBoxAt(a,cm);cm.getCenter(h.center);const w=l.index;
l=l.attributes.position;var p=this._drawRanges[a];a=0;for(let x=p.start,y=p.start+p.count;x<y;x++)p=x,w&&(p=w.getX(p)),dm.fromBufferAttribute(l,p),a=Math.max(a,h.center.distanceToSquared(dm));h.radius=Math.sqrt(a);e.sphereInitialized=!0}c.copy(h);return c}setMatrixAt(a,c){const e=this._drawInfo,h=this._matricesTexture;if(a>=e.length||!1===e[a].active)return this;c.toArray(this._matricesTexture.image.data,16*a);h.needsUpdate=!0;return this}getMatrixAt(a,c){const e=this._drawInfo;return a>=e.length||
!1===e[a].active?null:c.fromArray(this._matricesTexture.image.data,16*a)}setColorAt(a,c){null===this._colorsTexture&&this._initColorsTexture();const e=this._colorsTexture,h=this._drawInfo;if(a>=h.length||!1===h[a].active)return this;c.toArray(this._colorsTexture.image.data,4*a);e.needsUpdate=!0;return this}getColorAt(a,c){const e=this._drawInfo;return a>=e.length||!1===e[a].active?null:c.fromArray(this._colorsTexture.image.data,4*a)}setVisibleAt(a,c){const e=this._drawInfo;if(a>=e.length||!1===e[a].active||
e[a].visible===c)return this;e[a].visible=c;this._visibilityChanged=!0;return this}getVisibleAt(a){const c=this._drawInfo;return a>=c.length||!1===c[a].active?!1:c[a].visible}setGeometryIdAt(a,c){const e=this._drawInfo;if(a>=e.length||!1===e[a].active||0>c||c>=this._geometryCount)return null;e[a].geometryIndex=c;return this}getGeometryIdAt(a){const c=this._drawInfo;return a>=c.length||!1===c[a].active?-1:c[a].geometryIndex}getGeometryRangeAt(a,c={}){if(0>a||a>=this._geometryCount)return null;a=this._drawRanges[a];
c.start=a.start;c.count=a.count;return c}raycast(a,c){const e=this._drawInfo,h=this._drawRanges,l=this.matrixWorld;var p=this.geometry;gd.material=this.material;gd.geometry.index=p.index;gd.geometry.attributes=p.attributes;null===gd.geometry.boundingBox&&(gd.geometry.boundingBox=new fe);null===gd.geometry.boundingSphere&&(gd.geometry.boundingSphere=new $e);for(let w=0,x=e.length;w<x;w++){if(!e[w].visible||!e[w].active)continue;p=e[w].geometryIndex;const y=h[p];gd.geometry.setDrawRange(y.start,y.count);
this.getMatrixAt(w,gd.matrixWorld).premultiply(l);this.getBoundingBoxAt(p,gd.geometry.boundingBox);this.getBoundingSphereAt(p,gd.geometry.boundingSphere);gd.raycast(a,Nm);for(let D=0,H=Nm.length;D<H;D++)p=Nm[D],p.object=this,p.batchId=w,c.push(p);Nm.length=0}gd.material=null;gd.geometry.index=null;gd.geometry.attributes={};gd.geometry.setDrawRange(0,Infinity)}copy(a){super.copy(a);this.geometry=a.geometry.clone();this.perObjectFrustumCulled=a.perObjectFrustumCulled;this.sortObjects=a.sortObjects;
this.boundingBox=null!==a.boundingBox?a.boundingBox.clone():null;this.boundingSphere=null!==a.boundingSphere?a.boundingSphere.clone():null;this._drawRanges=a._drawRanges.map(c=>({...c}));this._reservedRanges=a._reservedRanges.map(c=>({...c}));this._drawInfo=a._drawInfo.map(c=>({...c}));this._bounds=a._bounds.map(c=>({boxInitialized:c.boxInitialized,box:c.box.clone(),sphereInitialized:c.sphereInitialized,sphere:c.sphere.clone()}));this._maxInstanceCount=a._maxInstanceCount;this._maxVertexCount=a._maxVertexCount;
this._maxIndexCount=a._maxIndexCount;this._geometryInitialized=a._geometryInitialized;this._geometryCount=a._geometryCount;this._multiDrawCounts=a._multiDrawCounts.slice();this._multiDrawStarts=a._multiDrawStarts.slice();this._matricesTexture=a._matricesTexture.clone();this._matricesTexture.image.data=this._matricesTexture.image.data.slice();null!==this._colorsTexture&&(this._colorsTexture=a._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice());return this}dispose(){this.geometry.dispose();
this._matricesTexture.dispose();this._matricesTexture=null;this._indirectTexture.dispose();this._indirectTexture=null;null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null);return this}onBeforeRender(a,c,e,h,l){if(this._visibilityChanged||this.perObjectFrustumCulled||this.sortObjects){c=h.getIndex();c=null===c?1:c.array.BYTES_PER_ELEMENT;var p=this._drawInfo;h=this._multiDrawStarts;var w=this._multiDrawCounts,x=this._drawRanges,y=this.perObjectFrustumCulled,D=this._indirectTexture,
H=D.image.data;y&&(ul.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse).multiply(this.matrixWorld),Tl.setFromProjectionMatrix(ul,a.coordinateSystem));a=0;if(this.sortObjects){gm.copy(this.matrixWorld).invert();dm.setFromMatrixPosition(e.matrixWorld).applyMatrix4(gm);vm.set(0,0,-1).transformDirection(e.matrixWorld).transformDirection(gm);for(let L=0,Y=p.length;L<Y;L++)if(p[L].visible&&p[L].active){const P=p[L].geometryIndex;this.getMatrixAt(L,Uh);this.getBoundingSphereAt(P,vl).applyMatrix4(Uh);
var I=!1;y&&(I=!Tl.intersectsSphere(vl));I||(I=aj.subVectors(vl.center,dm).dot(vm),wm.push(x[P],I,L))}p=wm.list;x=this.customSort;null===x?p.sort(l.transparent?Fg:vd):x.call(this,p,e);for(let L=0,Y=p.length;L<Y;L++)e=p[L],h[a]=e.start*c,w[a]=e.count,H[a]=e.index,a++;wm.reset()}else for(let L=0,Y=p.length;L<Y;L++)p[L].visible&&p[L].active&&(e=p[L].geometryIndex,l=!1,y&&(this.getMatrixAt(L,Uh),this.getBoundingSphereAt(e,vl).applyMatrix4(Uh),l=!Tl.intersectsSphere(vl)),l||(e=x[e],h[a]=e.start*c,w[a]=
e.count,H[a]=L,a++));D.needsUpdate=!0;this._multiDrawCount=a;this._visibilityChanged=!1}}onBeforeShadow(a,c,e,h,l,p){this.onBeforeRender(a,null,h,l,p)}}class jh extends Sa{constructor(a){super();this.isLineBasicMaterial=!0;this.type="LineBasicMaterial";this.color=new ia(16777215);this.map=null;this.linewidth=1;this.linejoin=this.linecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=
a.linejoin;this.fog=a.fog;return this}}const yi=new Da,me=new Da,xm=new Wc,Zk=new wh,Ul=new $e,Cm=new Da,bn=new Da;class Vj extends Nd{constructor(a=new Xc,c=new jh){super();this.isLine=!0;this.type="Line";this.geometry=a;this.material=c;this.updateMorphTargets()}copy(a,c){super.copy(a,c);this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}computeLineDistances(){const a=this.geometry;if(null===a.index){const c=a.attributes.position,e=[0];for(let h=
1,l=c.count;h<l;h++)yi.fromBufferAttribute(c,h-1),me.fromBufferAttribute(c,h),e[h]=e[h-1],e[h]+=yi.distanceTo(me);a.setAttribute("lineDistance",new Mc(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,c){var e=this.geometry,h=this.matrixWorld,l=a.params.Line.threshold,p=e.drawRange;null===e.boundingSphere&&e.computeBoundingSphere();Ul.copy(e.boundingSphere);Ul.applyMatrix4(h);Ul.radius+=l;if(!1!==a.ray.intersectsSphere(Ul)){xm.copy(h).invert();
Zk.copy(a.ray).applyMatrix4(xm);h=l/((this.scale.x+this.scale.y+this.scale.z)/3);h*=h;l=this.isLineSegments?2:1;var w=e.index;e=e.attributes.position;if(null!==w){e=Math.max(0,p.start);p=Math.min(w.count,p.start+p.count);for(let y=e,D=p-1;y<D;y+=l){var x=w.getX(y);const H=w.getX(y+1);(x=Vf(this,a,Zk,h,x,H))&&c.push(x)}this.isLineLoop&&(l=w.getX(p-1),w=w.getX(e),(a=Vf(this,a,Zk,h,l,w))&&c.push(a))}else{w=Math.max(0,p.start);p=Math.min(e.count,p.start+p.count);for(let y=w,D=p-1;y<D;y+=l)(e=Vf(this,
a,Zk,h,y,y+1))&&c.push(e);this.isLineLoop&&(a=Vf(this,a,Zk,h,p-1,w))&&c.push(a)}}}updateMorphTargets(){var a=this.geometry.morphAttributes,c=Object.keys(a);if(0<c.length&&(a=a[c[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let e=0,h=a.length;e<h;e++)c=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=e}}}const nj=new Da,em=new Da;class Bc extends Vj{constructor(a,c){super(a,c);this.isLineSegments=!0;this.type="LineSegments"}computeLineDistances(){const a=
this.geometry;if(null===a.index){const c=a.attributes.position,e=[];for(let h=0,l=c.count;h<l;h+=2)nj.fromBufferAttribute(c,h),em.fromBufferAttribute(c,h+1),e[h]=0===h?0:e[h-1],e[h+1]=e[h]+nj.distanceTo(em);a.setAttribute("lineDistance",new Mc(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Zc extends Vj{constructor(a,c){super(a,c);this.isLineLoop=!0;this.type="LineLoop"}}class wl extends Sa{constructor(a){super();
this.isPointsMaterial=!0;this.type="PointsMaterial";this.color=new ia(16777215);this.alphaMap=this.map=null;this.size=1;this.fog=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}const Sm=new Wc,Dl=new wh,Ef=new $e,yg=new Da;class Um extends Nd{constructor(a=new Xc,c=new wl){super();this.isPoints=!0;this.type="Points";this.geometry=a;this.material=
c;this.updateMorphTargets()}copy(a,c){super.copy(a,c);this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}raycast(a,c){var e=this.geometry;const h=this.matrixWorld;var l=a.params.Points.threshold,p=e.drawRange;null===e.boundingSphere&&e.computeBoundingSphere();Ef.copy(e.boundingSphere);Ef.applyMatrix4(h);Ef.radius+=l;if(!1!==a.ray.intersectsSphere(Ef)){Sm.copy(h).invert();Dl.copy(a.ray).applyMatrix4(Sm);l/=(this.scale.x+this.scale.y+this.scale.z)/
3;l*=l;var w=e.index;e=e.attributes.position;if(null!==w){const x=Math.max(0,p.start);p=Math.min(w.count,p.start+p.count);for(let y=x,D=p;y<D;y++)p=w.getX(y),yg.fromBufferAttribute(e,p),pg(yg,p,l,h,a,c,this)}else{w=Math.max(0,p.start);p=Math.min(e.count,p.start+p.count);for(let x=w,y=p;x<y;x++)yg.fromBufferAttribute(e,x),pg(yg,x,l,h,a,c,this)}}}updateMorphTargets(){var a=this.geometry.morphAttributes,c=Object.keys(a);if(0<c.length&&(a=a[c[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary=
{};for(let e=0,h=a.length;e<h;e++)c=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=e}}}class mn extends Ld{constructor(a,c,e,h,l,p,w,x,y){function D(){H.needsUpdate=!0;a.requestVideoFrameCallback(D)}super(a,c,e,h,l,p,w,x,y);this.isVideoTexture=!0;this.minFilter=void 0!==p?p:1006;this.magFilter=void 0!==l?l:1006;this.generateMipmaps=!1;const H=this;"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(D)}clone(){return(new this.constructor(this.image)).copy(this)}update(){const a=
this.image;!1==="requestVideoFrameCallback"in a&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class ln extends Ld{constructor(a,c){super({width:a,height:c});this.isFramebufferTexture=!0;this.minFilter=this.magFilter=1003;this.generateMipmaps=!1;this.needsUpdate=!0}}class am extends Ld{constructor(a,c,e,h,l,p,w,x,y,D,H,I){super(null,p,w,x,y,D,h,l,H,I);this.isCompressedTexture=!0;this.image={width:c,height:e};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}}class sj extends am{constructor(a,
c,e,h,l,p){super(a,c,e,l,p);this.isCompressedArrayTexture=!0;this.image.depth=h;this.wrapR=1001;this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class hf extends am{constructor(a,c,e){super(void 0,a[0].width,a[0].height,c,e,301);this.isCubeTexture=this.isCompressedCubeTexture=!0;this.image=a}}class Qj extends Ld{constructor(a,c,e,h,l,p,w,x,y){super(a,c,e,h,l,p,w,x,y);this.needsUpdate=this.isCanvasTexture=!0}}class ng{constructor(){this.type=
"Curve";this.arcLengthDivisions=200}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.");return null}getPointAt(a,c){a=this.getUtoTmapping(a);return this.getPoint(a,c)}getPoints(a=5){const c=[];for(let e=0;e<=a;e++)c.push(this.getPoint(e/a));return c}getSpacedPoints(a=5){const c=[];for(let e=0;e<=a;e++)c.push(this.getPointAt(e/a));return c}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===
a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let e,h=this.getPoint(0),l=0;c.push(0);for(let p=1;p<=a;p++)e=this.getPoint(p/a),l+=e.distanceTo(h),c.push(l),h=e;return this.cacheArcLengths=c}updateArcLengths(){this.needsUpdate=!0;this.getLengths()}getUtoTmapping(a,c){const e=this.getLengths(),h=e.length;c=c?c:a*e[h-1];var l=0;let p=h-1,w;for(;l<=p;)if(a=Math.floor(l+(p-l)/2),w=e[a]-c,0>w)l=a+1;else if(0<w)p=a-1;else{p=a;break}a=p;if(e[a]===c)return a/(h-1);l=e[a];
return(a+(c-l)/(e[a+1]-l))/(h-1)}getTangent(a,c){var e=a-1E-4;a+=1E-4;0>e&&(e=0);1<a&&(a=1);e=this.getPoint(e);a=this.getPoint(a);c=c||(e.isVector2?new Lb:new Da);c.copy(a).sub(e).normalize();return c}getTangentAt(a,c){a=this.getUtoTmapping(a);return this.getTangent(a,c)}computeFrenetFrames(a,c){var e=new Da;const h=[],l=[],p=[];var w=new Da;const x=new Wc;for(var y=0;y<=a;y++)h[y]=this.getTangentAt(y/a,new Da);l[0]=new Da;p[0]=new Da;y=Number.MAX_VALUE;const D=Math.abs(h[0].x),H=Math.abs(h[0].y),
I=Math.abs(h[0].z);D<=y&&(y=D,e.set(1,0,0));H<=y&&(y=H,e.set(0,1,0));I<=y&&e.set(0,0,1);w.crossVectors(h[0],e).normalize();l[0].crossVectors(h[0],w);p[0].crossVectors(h[0],l[0]);for(e=1;e<=a;e++)l[e]=l[e-1].clone(),p[e]=p[e-1].clone(),w.crossVectors(h[e-1],h[e]),w.length()>Number.EPSILON&&(w.normalize(),y=Math.acos(qc(h[e-1].dot(h[e]),-1,1)),l[e].applyMatrix4(x.makeRotationAxis(w,y))),p[e].crossVectors(h[e],l[e]);if(!0===c)for(c=Math.acos(qc(l[0].dot(l[a]),-1,1)),c/=a,0<h[0].dot(w.crossVectors(l[0],
l[a]))&&(c=-c),w=1;w<=a;w++)l[w].applyMatrix4(x.makeRotationAxis(h[w],c*w)),p[w].crossVectors(h[w],l[w]);return{tangents:h,normals:l,binormals:p}}clone(){return(new this.constructor).copy(this)}copy(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}toJSON(){const a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a}fromJSON(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}}class fl extends ng{constructor(a=
0,c=0,e=1,h=1,l=0,p=2*Math.PI,w=!1,x=0){super();this.isEllipseCurve=!0;this.type="EllipseCurve";this.aX=a;this.aY=c;this.xRadius=e;this.yRadius=h;this.aStartAngle=l;this.aEndAngle=p;this.aClockwise=w;this.aRotation=x}getPoint(a,c=new Lb){for(var e=2*Math.PI,h=this.aEndAngle-this.aStartAngle,l=Math.abs(h)<Number.EPSILON;0>h;)h+=e;for(;h>e;)h-=e;h<Number.EPSILON&&(h=l?0:e);!0!==this.aClockwise||l||(h=h===e?-e:h-e);e=this.aStartAngle+a*h;a=this.aX+this.xRadius*Math.cos(e);var p=this.aY+this.yRadius*
Math.sin(e);0!==this.aRotation&&(e=Math.cos(this.aRotation),h=Math.sin(this.aRotation),l=a-this.aX,p-=this.aY,a=l*e-p*h+this.aX,p=l*h+p*e+this.aY);return c.set(a,p)}copy(a){super.copy(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this}toJSON(){const a=super.toJSON();a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=
this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a}fromJSON(a){super.fromJSON(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this}}class Vl extends fl{constructor(a,c,e,h,l,p){super(a,c,e,e,h,l,p);this.isArcCurve=!0;this.type="ArcCurve"}}const xl=new Da,Qk=new zi,qh=new zi,hm=new zi;class Sj extends ng{constructor(a=
[],c=!1,e="centripetal",h=.5){super();this.isCatmullRomCurve3=!0;this.type="CatmullRomCurve3";this.points=a;this.closed=c;this.curveType=e;this.tension=h}getPoint(a,c=new Da){var e=this.points,h=e.length;a*=h-(this.closed?0:1);var l=Math.floor(a);a-=l;this.closed?l+=0<l?0:(Math.floor(Math.abs(l)/h)+1)*h:0===a&&l===h-1&&(l=h-2,a=1);let p;this.closed||0<l?p=e[(l-1)%h]:(xl.subVectors(e[0],e[1]).add(e[0]),p=xl);const w=e[l%h],x=e[(l+1)%h];this.closed||l+2<h?e=e[(l+2)%h]:(xl.subVectors(e[h-1],e[h-2]).add(e[h-
1]),e=xl);if("centripetal"===this.curveType||"chordal"===this.curveType){var y="chordal"===this.curveType?.5:.25;h=Math.pow(p.distanceToSquared(w),y);l=Math.pow(w.distanceToSquared(x),y);y=Math.pow(x.distanceToSquared(e),y);1E-4>l&&(l=1);1E-4>h&&(h=l);1E-4>y&&(y=l);Qk.initNonuniformCatmullRom(p.x,w.x,x.x,e.x,h,l,y);qh.initNonuniformCatmullRom(p.y,w.y,x.y,e.y,h,l,y);hm.initNonuniformCatmullRom(p.z,w.z,x.z,e.z,h,l,y)}else"catmullrom"===this.curveType&&(Qk.initCatmullRom(p.x,w.x,x.x,e.x,this.tension),
qh.initCatmullRom(p.y,w.y,x.y,e.y,this.tension),hm.initCatmullRom(p.z,w.z,x.z,e.z,this.tension));c.set(Qk.calc(a),qh.calc(a),hm.calc(a));return c}copy(a){super.copy(a);this.points=[];for(let c=0,e=a.points.length;c<e;c++)this.points.push(a.points[c].clone());this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,e=this.points.length;c<e;c++)a.points.push(this.points[c].toArray());a.closed=this.closed;a.curveType=this.curveType;
a.tension=this.tension;return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let c=0,e=a.points.length;c<e;c++){const h=a.points[c];this.points.push((new Da).fromArray(h))}this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this}}class al extends ng{constructor(a=new Lb,c=new Lb,e=new Lb,h=new Lb){super();this.isCubicBezierCurve=!0;this.type="CubicBezierCurve";this.v0=a;this.v1=c;this.v2=e;this.v3=h}getPoint(a,c=new Lb){const e=this.v0,h=this.v1,l=this.v2,p=this.v3;c.set(Gg(a,
e.x,h.x,l.x,p.x),Gg(a,e.y,h.y,l.y,p.y));return c}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class vk extends ng{constructor(a=new Da,c=new Da,e=new Da,h=new Da){super();
this.isCubicBezierCurve3=!0;this.type="CubicBezierCurve3";this.v0=a;this.v1=c;this.v2=e;this.v3=h}getPoint(a,c=new Da){const e=this.v0,h=this.v1,l=this.v2,p=this.v3;c.set(Gg(a,e.x,h.x,l.x,p.x),Gg(a,e.y,h.y,l.y,p.y),Gg(a,e.z,h.z,l.z,p.z));return c}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);
this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class $k extends ng{constructor(a=new Lb,c=new Lb){super();this.isLineCurve=!0;this.type="LineCurve";this.v1=a;this.v2=c}getPoint(a,c=new Lb){1===a?c.copy(this.v2):(c.copy(this.v2).sub(this.v1),c.multiplyScalar(a).add(this.v1));return c}getPointAt(a,c){return this.getPoint(a,c)}getTangent(a,c=new Lb){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,
c)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class Tj extends ng{constructor(a=new Da,c=new Da){super();this.isLineCurve3=!0;this.type="LineCurve3";this.v1=a;this.v2=c}getPoint(a,c=new Da){1===a?c.copy(this.v2):(c.copy(this.v2).sub(this.v1),c.multiplyScalar(a).add(this.v1));return c}getPointAt(a,
c){return this.getPoint(a,c)}getTangent(a,c=new Da){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,c){return this.getTangent(a,c)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class bl extends ng{constructor(a=new Lb,c=new Lb,e=new Lb){super();this.isQuadraticBezierCurve=!0;this.type=
"QuadraticBezierCurve";this.v0=a;this.v1=c;this.v2=e}getPoint(a,c=new Lb){const e=this.v0,h=this.v1,l=this.v2;c.set(Ai(a,e.x,h.x,l.x),Ai(a,e.y,h.y,l.y));return c}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class Gl extends ng{constructor(a=
new Da,c=new Da,e=new Da){super();this.isQuadraticBezierCurve3=!0;this.type="QuadraticBezierCurve3";this.v0=a;this.v1=c;this.v2=e}getPoint(a,c=new Da){const e=this.v0,h=this.v1,l=this.v2;c.set(Ai(a,e.x,h.x,l.x),Ai(a,e.y,h.y,l.y),Ai(a,e.z,h.z,l.z));return c}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);
this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class dl extends ng{constructor(a=[]){super();this.isSplineCurve=!0;this.type="SplineCurve";this.points=a}getPoint(a,c=new Lb){var e=this.points,h=(e.length-1)*a;a=Math.floor(h);h-=a;const l=e[0===a?a:a-1],p=e[a],w=e[a>e.length-2?e.length-1:a+1];e=e[a>e.length-3?e.length-1:a+2];c.set(qf(h,l.x,p.x,w.x,e.x),qf(h,l.y,p.y,w.y,e.y));return c}copy(a){super.copy(a);this.points=[];for(let c=0,e=a.points.length;c<e;c++)this.points.push(a.points[c].clone());
return this}toJSON(){const a=super.toJSON();a.points=[];for(let c=0,e=this.points.length;c<e;c++)a.points.push(this.points[c].toArray());return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let c=0,e=a.points.length;c<e;c++){const h=a.points[c];this.points.push((new Lb).fromArray(h))}return this}}var el=Object.freeze({__proto__:null,ArcCurve:Vl,CatmullRomCurve3:Sj,CubicBezierCurve:al,CubicBezierCurve3:vk,EllipseCurve:fl,LineCurve:$k,LineCurve3:Tj,QuadraticBezierCurve:bl,QuadraticBezierCurve3:Gl,
SplineCurve:dl});class fm extends ng{constructor(){super();this.type="CurvePath";this.curves=[];this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);a.equals(c)||this.curves.push(new el[!0===a.isVector2?"LineCurve":"LineCurve3"](c,a));return this}getPoint(a,c){var e=a*this.getLength(),h=this.getCurveLengths();for(a=0;a<h.length;){if(h[a]>=e)return e=h[a]-e,a=this.curves[a],h=a.getLength(),a.getPointAt(0===h?0:1-
e/h,c);a++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let c=0;for(let e=0,h=this.curves.length;e<h;e++)c+=this.curves[e].getLength(),a.push(c);return this.cacheLengths=a}getSpacedPoints(a=40){const c=[];for(let e=0;e<=a;e++)c.push(this.getPoint(e/a));this.autoClose&&
c.push(c[0]);return c}getPoints(a=12){const c=[];let e;for(let l=0,p=this.curves;l<p.length;l++){var h=p[l];h=h.getPoints(h.isEllipseCurve?2*a:h.isLineCurve||h.isLineCurve3?1:h.isSplineCurve?a*h.points.length:a);for(let w=0;w<h.length;w++){const x=h[w];e&&e.equals(x)||(c.push(x),e=x)}}this.autoClose&&1<c.length&&!c[c.length-1].equals(c[0])&&c.push(c[0]);return c}copy(a){super.copy(a);this.curves=[];for(let c=0,e=a.curves.length;c<e;c++)this.curves.push(a.curves[c].clone());this.autoClose=a.autoClose;
return this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose;a.curves=[];for(let c=0,e=this.curves.length;c<e;c++)a.curves.push(this.curves[c].toJSON());return a}fromJSON(a){super.fromJSON(a);this.autoClose=a.autoClose;this.curves=[];for(let c=0,e=a.curves.length;c<e;c++){const h=a.curves[c];this.curves.push((new el[h.type]).fromJSON(h))}return this}}class Uj extends fm{constructor(a){super();this.type="Path";this.currentPoint=new Lb;a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,
a[0].y);for(let c=1,e=a.length;c<e;c++)this.lineTo(a[c].x,a[c].y);return this}moveTo(a,c){this.currentPoint.set(a,c);return this}lineTo(a,c){const e=new $k(this.currentPoint.clone(),new Lb(a,c));this.curves.push(e);this.currentPoint.set(a,c);return this}quadraticCurveTo(a,c,e,h){a=new bl(this.currentPoint.clone(),new Lb(a,c),new Lb(e,h));this.curves.push(a);this.currentPoint.set(e,h);return this}bezierCurveTo(a,c,e,h,l,p){a=new al(this.currentPoint.clone(),new Lb(a,c),new Lb(e,h),new Lb(l,p));this.curves.push(a);
this.currentPoint.set(l,p);return this}splineThru(a){var c=[this.currentPoint.clone()].concat(a);c=new dl(c);this.curves.push(c);this.currentPoint.copy(a[a.length-1]);return this}arc(a,c,e,h,l,p){this.absarc(a+this.currentPoint.x,c+this.currentPoint.y,e,h,l,p);return this}absarc(a,c,e,h,l,p){this.absellipse(a,c,e,e,h,l,p);return this}ellipse(a,c,e,h,l,p,w,x){this.absellipse(a+this.currentPoint.x,c+this.currentPoint.y,e,h,l,p,w,x);return this}absellipse(a,c,e,h,l,p,w,x){a=new fl(a,c,e,h,l,p,w,x);0<
this.curves.length&&(c=a.getPoint(0),c.equals(this.currentPoint)||this.lineTo(c.x,c.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a);return this}copy(a){super.copy(a);this.currentPoint.copy(a.currentPoint);return this}toJSON(){const a=super.toJSON();a.currentPoint=this.currentPoint.toArray();return a}fromJSON(a){super.fromJSON(a);this.currentPoint.fromArray(a.currentPoint);return this}}class cl extends Xc{constructor(a=[new Lb(0,-.5),new Lb(.5,0),new Lb(0,.5)],c=12,e=0,h=2*Math.PI){super();
this.type="LatheGeometry";this.parameters={points:a,segments:c,phiStart:e,phiLength:h};c=Math.floor(c);h=qc(h,0,2*Math.PI);const l=[],p=[],w=[];var x=[];const y=[];var D=1/c,H=new Da,I=new Lb,L=new Da,Y=new Da,P=new Da;let Z;for(let T=0;T<=a.length-1;T++)switch(T){case 0:var aa=a[T+1].x-a[T].x;Z=a[T+1].y-a[T].y;L.x=1*Z;L.y=-aa;L.z=0*Z;P.copy(L);L.normalize();x.push(L.x,L.y,L.z);break;case a.length-1:x.push(P.x,P.y,P.z);break;default:aa=a[T+1].x-a[T].x,Z=a[T+1].y-a[T].y,L.x=1*Z,L.y=-aa,L.z=0*Z,Y.copy(L),
L.x+=P.x,L.y+=P.y,L.z+=P.z,L.normalize(),x.push(L.x,L.y,L.z),P.copy(Y)}for(L=0;L<=c;L++)for(P=e+L*D*h,Y=Math.sin(P),P=Math.cos(P),aa=0;aa<=a.length-1;aa++)H.x=a[aa].x*Y,H.y=a[aa].y,H.z=a[aa].x*P,p.push(H.x,H.y,H.z),I.x=L/c,I.y=aa/(a.length-1),w.push(I.x,I.y),y.push(x[3*aa]*Y,x[3*aa+1],x[3*aa]*P);for(e=0;e<c;e++)for(h=0;h<a.length-1;h++)x=h+e*a.length,D=x+a.length,H=x+a.length+1,I=x+1,l.push(x,D,I),l.push(H,I,D);this.setIndex(l);this.setAttribute("position",new Mc(p,3));this.setAttribute("uv",new Mc(w,
2));this.setAttribute("normal",new Mc(y,3))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new cl(a.points,a.segments,a.phiStart,a.phiLength)}}class Wl extends cl{constructor(a=1,c=1,e=4,h=8){const l=new Uj;l.absarc(0,-c/2,a,1.5*Math.PI,0);l.absarc(0,c/2,a,0,.5*Math.PI);super(l.getPoints(e),h);this.type="CapsuleGeometry";this.parameters={radius:a,length:c,capSegments:e,radialSegments:h}}static fromJSON(a){return new Wl(a.radius,a.length,
a.capSegments,a.radialSegments)}}class yl extends Xc{constructor(a=1,c=32,e=0,h=2*Math.PI){super();this.type="CircleGeometry";this.parameters={radius:a,segments:c,thetaStart:e,thetaLength:h};c=Math.max(3,c);const l=[],p=[],w=[],x=[],y=new Da,D=new Lb;p.push(0,0,0);w.push(0,0,1);x.push(.5,.5);for(let H=0,I=3;H<=c;H++,I+=3){const L=e+H/c*h;y.x=a*Math.cos(L);y.y=a*Math.sin(L);p.push(y.x,y.y,y.z);w.push(0,0,1);D.x=(p[I]/a+1)/2;D.y=(p[I+1]/a+1)/2;x.push(D.x,D.y)}for(a=1;a<=c;a++)l.push(a,a+1,0);this.setIndex(l);
this.setAttribute("position",new Mc(p,3));this.setAttribute("normal",new Mc(w,3));this.setAttribute("uv",new Mc(x,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new yl(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class jk extends Xc{constructor(a=1,c=1,e=1,h=32,l=1,p=!1,w=0,x=2*Math.PI){function y(ha){const Ca=P;var xa=new Lb,Ha=new Da;let Fa=0;var Ra=!0===ha?a:c;const Ja=!0===ha?1:-1;for(var Ka=1;Ka<=h;Ka++)I.push(0,aa*Ja,0),L.push(0,
Ja,0),Y.push(.5,.5),P++;Ka=P;for(let wb=0;wb<=h;wb++){var lb=wb/h*x+w;const Mb=Math.cos(lb);lb=Math.sin(lb);Ha.x=Ra*lb;Ha.y=aa*Ja;Ha.z=Ra*Mb;I.push(Ha.x,Ha.y,Ha.z);L.push(0,Ja,0);xa.x=.5*Mb+.5;xa.y=.5*lb*Ja+.5;Y.push(xa.x,xa.y);P++}for(xa=0;xa<h;xa++)Ha=Ca+xa,Ra=Ka+xa,!0===ha?H.push(Ra,Ra+1,Ha):H.push(Ra+1,Ra,Ha),Fa+=3;D.addGroup(T,Fa,!0===ha?1:2);T+=Fa}super();this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:c,height:e,radialSegments:h,heightSegments:l,openEnded:p,thetaStart:w,
thetaLength:x};const D=this;h=Math.floor(h);l=Math.floor(l);const H=[],I=[],L=[],Y=[];let P=0;const Z=[],aa=e/2;let T=0;(function(){var ha=new Da,Ca=new Da;let xa=0;var Ha=(c-a)/e;for(var Fa=0;Fa<=l;Fa++){var Ra=[],Ja=Fa/l;const lb=Ja*(c-a)+a;for(let wb=0;wb<=h;wb++){const Mb=wb/h;var Ka=Mb*x+w;const kb=Math.sin(Ka);Ka=Math.cos(Ka);Ca.x=lb*kb;Ca.y=-Ja*e+aa;Ca.z=lb*Ka;I.push(Ca.x,Ca.y,Ca.z);ha.set(kb,Ha,Ka).normalize();L.push(ha.x,ha.y,ha.z);Y.push(Mb,1-Ja);Ra.push(P++)}Z.push(Ra)}for(ha=0;ha<h;ha++)for(Ca=
0;Ca<l;Ca++)Ha=Z[Ca][ha],Fa=Z[Ca+1][ha],Ra=Z[Ca+1][ha+1],Ja=Z[Ca][ha+1],0<a&&(H.push(Ha,Fa,Ja),xa+=3),0<c&&(H.push(Fa,Ra,Ja),xa+=3);D.addGroup(T,xa,0);T+=xa})();!1===p&&(0<a&&y(!0),0<c&&y(!1));this.setIndex(H);this.setAttribute("position",new Mc(I,3));this.setAttribute("normal",new Mc(L,3));this.setAttribute("uv",new Mc(Y,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new jk(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,
a.openEnded,a.thetaStart,a.thetaLength)}}class ym extends jk{constructor(a=1,c=1,e=32,h=1,l=!1,p=0,w=2*Math.PI){super(0,a,c,e,h,l,p,w);this.type="ConeGeometry";this.parameters={radius:a,height:c,radialSegments:e,heightSegments:h,openEnded:l,thetaStart:p,thetaLength:w}}static fromJSON(a){return new ym(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Rk extends Xc{constructor(a=[],c=[],e=1,h=0){function l(D){x.push(D.x,D.y,D.z)}function p(D,H){D*=3;
H.x=a[D+0];H.y=a[D+1];H.z=a[D+2]}function w(D,H,I,L){0>L&&1===D.x&&(y[H]=D.x-1);0===I.x&&0===I.z&&(y[H]=L/2/Math.PI+.5)}super();this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:c,radius:e,detail:h};const x=[],y=[];(function(D){const H=new Da,I=new Da,L=new Da;for(let aa=0;aa<c.length;aa+=3){p(c[aa+0],H);p(c[aa+1],I);p(c[aa+2],L);const T=D+1,ha=[];for(var Y=0;Y<=T;Y++){ha[Y]=[];var P=H.clone().lerp(L,Y/T),Z=I.clone().lerp(L,Y/T);const Ca=T-Y;for(let xa=0;xa<=Ca;xa++)ha[Y][xa]=0===
xa&&Y===T?P:P.clone().lerp(Z,xa/Ca)}for(Y=0;Y<T;Y++)for(P=0;P<2*(T-Y)-1;P++)Z=Math.floor(P/2),0===P%2?(l(ha[Y][Z+1]),l(ha[Y+1][Z]),l(ha[Y][Z])):(l(ha[Y][Z+1]),l(ha[Y+1][Z+1]),l(ha[Y+1][Z]))}})(h);(function(D){const H=new Da;for(let I=0;I<x.length;I+=3)H.x=x[I+0],H.y=x[I+1],H.z=x[I+2],H.normalize().multiplyScalar(D),x[I+0]=H.x,x[I+1]=H.y,x[I+2]=H.z})(e);(function(){var D=new Da;for(var H=0;H<x.length;H+=3)D.x=x[H+0],D.y=x[H+1],D.z=x[H+2],y.push(Math.atan2(D.z,-D.x)/2/Math.PI+.5,1-(Math.atan2(-D.y,
Math.sqrt(D.x*D.x+D.z*D.z))/Math.PI+.5));D=new Da;H=new Da;var I=new Da,L=new Da,Y=new Lb;const P=new Lb,Z=new Lb;for(let aa=0,T=0;aa<x.length;aa+=9,T+=6){D.set(x[aa+0],x[aa+1],x[aa+2]);H.set(x[aa+3],x[aa+4],x[aa+5]);I.set(x[aa+6],x[aa+7],x[aa+8]);Y.set(y[T+0],y[T+1]);P.set(y[T+2],y[T+3]);Z.set(y[T+4],y[T+5]);L.copy(D).add(H).add(I).divideScalar(3);const ha=Math.atan2(L.z,-L.x);w(Y,T+0,D,ha);w(P,T+2,H,ha);w(Z,T+4,I,ha)}for(D=0;D<y.length;D+=6)H=y[D+0],I=y[D+2],L=y[D+4],Y=Math.min(H,I,L),.9<Math.max(H,
I,L)&&.1>Y&&(.2>H&&(y[D+0]+=1),.2>I&&(y[D+2]+=1),.2>L&&(y[D+4]+=1))})();this.setAttribute("position",new Mc(x,3));this.setAttribute("normal",new Mc(x.slice(),3));this.setAttribute("uv",new Mc(y,2));0===h?this.computeVertexNormals():this.normalizeNormals()}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Rk(a.vertices,a.indices,a.radius,a.details)}}class Hk extends Rk{constructor(a=1,c=0){const e=(1+Math.sqrt(5))/2,h=1/e;super([-1,-1,-1,
-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-h,-e,0,-h,e,0,h,-e,0,h,e,-h,-e,0,-h,e,0,h,-e,0,h,e,0,-e,0,-h,e,0,-h,-e,0,h,e,0,h],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,c);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:c}}static fromJSON(a){return new Hk(a.radius,
a.detail)}}const bm=new Da,wk=new Da,Dm=new Da,im=new E;class qm extends Xc{constructor(a=null,c=1){super();this.type="EdgesGeometry";this.parameters={geometry:a,thresholdAngle:c};if(null!==a){const h=Math.pow(10,4);c=Math.cos(Jg*c);const l=a.getIndex();a=a.getAttribute("position");const p=l?l.count:a.count,w=[0,0,0],x=["a","b","c"],y=Array(3),D={},H=[];for(let I=0;I<p;I+=3){l?(w[0]=l.getX(I),w[1]=l.getX(I+1),w[2]=l.getX(I+2)):(w[0]=I,w[1]=I+1,w[2]=I+2);const {a:L,b:Y,c:P}=im;L.fromBufferAttribute(a,
w[0]);Y.fromBufferAttribute(a,w[1]);P.fromBufferAttribute(a,w[2]);im.getNormal(Dm);y[0]=`${Math.round(L.x*h)},${Math.round(L.y*h)},${Math.round(L.z*h)}`;y[1]=`${Math.round(Y.x*h)},${Math.round(Y.y*h)},${Math.round(Y.z*h)}`;y[2]=`${Math.round(P.x*h)},${Math.round(P.y*h)},${Math.round(P.z*h)}`;if(y[0]!==y[1]&&y[1]!==y[2]&&y[2]!==y[0])for(let Z=0;3>Z;Z++){const aa=(Z+1)%3;var e=y[Z];const T=y[aa],ha=im[x[Z]],Ca=im[x[aa]],xa=`${e}_${T}`;e=`${T}_${e}`;e in D&&D[e]?(Dm.dot(D[e].normal)<=c&&(H.push(ha.x,
ha.y,ha.z),H.push(Ca.x,Ca.y,Ca.z)),D[e]=null):xa in D||(D[xa]={index0:w[Z],index1:w[aa],normal:Dm.clone()})}}for(const I in D)if(D[I]){const {index0:L,index1:Y}=D[I];bm.fromBufferAttribute(a,L);wk.fromBufferAttribute(a,Y);H.push(bm.x,bm.y,bm.z);H.push(wk.x,wk.y,wk.z)}this.setAttribute("position",new Mc(H,3))}}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}}class Ej extends Uj{constructor(a){super(a);this.uuid=Na();this.type="Shape";this.holes=[]}getPointsHoles(a){const c=
[];for(let e=0,h=this.holes.length;e<h;e++)c[e]=this.holes[e].getPoints(a);return c}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a);this.holes=[];for(let c=0,e=a.holes.length;c<e;c++)this.holes.push(a.holes[c].clone());return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid;a.holes=[];for(let c=0,e=this.holes.length;c<e;c++)a.holes.push(this.holes[c].toJSON());return a}fromJSON(a){super.fromJSON(a);this.uuid=a.uuid;this.holes=[];for(let c=0,
e=a.holes.length;c<e;c++){const h=a.holes[c];this.holes.push((new Uj).fromJSON(h))}return this}}const Jm={triangulate:function(a,c,e=2){var h=c&&c.length;const l=h?c[0]*e:a.length;var p=Ff(a,0,l,e,!0);const w=[];if(!p||p.next===p.prev)return w;let x,y;var D;if(h){var H=p;p=[];var I;h=0;for(I=c.length;h<I;h++){var L=c[h]*e;var Y=h<I-1?c[h+1]*e:a.length;var P=Ff(a,L,Y,e,!1);P===P.next&&(P.steiner=!0);L=p;Y=L.push;var Z=P,aa=P;do{if(Z.x<aa.x||Z.x===aa.x&&Z.y<aa.y)aa=Z;Z=Z.next}while(Z!==P);Y.call(L,
aa)}p.sort(Mf);for(h=0;h<p.length;h++){I=void 0;c=p[h];b:{L=H;Y=-Infinity;P=c.x;Z=c.y;do{if(Z<=L.y&&Z>=L.next.y&&L.next.y!==L.y&&(aa=L.x+(Z-L.y)*(L.next.x-L.x)/(L.next.y-L.y),aa<=P&&aa>Y&&(Y=aa,I=L.x<L.next.x?L:L.next,aa===P)))break b;L=L.next}while(L!==H);if(I){var T=I,ha=I.x,Ca=I.y,xa=Infinity;L=I;do{if(P>=L.x&&L.x>=ha&&P!==L.x&&zf(Z<Ca?P:Y,Z,ha,Ca,Z<Ca?Y:P,Z,L.x,L.y)){aa=Math.abs(Z-L.y)/(P-L.x);var Ha;if((Ha=bi(L,c))&&!(Ha=aa<xa)&&(Ha=aa===xa)&&!(Ha=L.x>I.x)&&(Ha=L.x===I.x)){Ha=I;var Fa=L;Ha=0>
$c(Ha.prev,Ha,Fa.prev)&&0>$c(Fa.next,Ha,Ha.next)}Ha&&(I=L,xa=aa)}L=L.next}while(L!==T)}else I=null}I&&(c=Xj(I,c),qg(c,c.next),H=qg(I,I.next))}p=H}if(a.length>80*e){x=D=a[0];y=h=a[1];for(I=e;I<l;I+=e)c=a[I],H=a[I+1],c<x&&(x=c),H<y&&(y=H),c>D&&(D=c),H>h&&(h=H);D=Math.max(D-x,h-y);D=0!==D?32767/D:0}kg(p,w,e,x,y,D,0);return w}};class Ij{static area(a){const c=a.length;let e=0;for(let h=c-1,l=0;l<c;h=l++)e+=a[h].x*a[l].y-a[l].x*a[h].y;return.5*e}static isClockWise(a){return 0>Ij.area(a)}static triangulateShape(a,
c){var e=[];const h=[],l=[];Od(a);Nf(e,a);a=a.length;c.forEach(Od);for(let p=0;p<c.length;p++)h.push(a),a+=c[p].length,Nf(e,c[p]);c=Jm.triangulate(e,h);for(e=0;e<c.length;e+=3)l.push(c.slice(e,e+3));return l}}class zm extends Xc{constructor(a=new Ej([new Lb(.5,.5),new Lb(-.5,.5),new Lb(-.5,-.5),new Lb(.5,-.5)]),c={}){function e(w){function x(ka,wa,Oa){wa||console.error("THREE.ExtrudeGeometry: vec does not exist");return ka.clone().addScaledVector(wa,Oa)}function y(ka,wa,Oa){var Ya=ka.x-wa.x;var La=
ka.y-wa.y;var ub=Oa.x-ka.x;var mb=Oa.y-ka.y,ib=Ya*Ya+La*La;if(Math.abs(Ya*mb-La*ub)>Number.EPSILON){const Gb=Math.sqrt(ib),Yb=Math.sqrt(ub*ub+mb*mb);ib=wa.x-La/Gb;wa=wa.y+Ya/Gb;mb=((Oa.x-mb/Yb-ib)*mb-(Oa.y+ub/Yb-wa)*ub)/(Ya*mb-La*ub);ub=ib+Ya*mb-ka.x;Ya=wa+La*mb-ka.y;La=ub*ub+Ya*Ya;if(2>=La)return new Lb(ub,Ya);La=Math.sqrt(La/2)}else ka=!1,Ya>Number.EPSILON?ub>Number.EPSILON&&(ka=!0):Ya<-Number.EPSILON?ub<-Number.EPSILON&&(ka=!0):Math.sign(La)===Math.sign(mb)&&(ka=!0),ka?(ub=-La,La=Math.sqrt(ib)):
(ub=Ya,Ya=La,La=Math.sqrt(ib/2));return new Lb(ub/La,Ya/La)}function D(ka,wa){let Oa=ka.length;for(;0<=--Oa;){const ub=Oa;let mb=Oa-1;0>mb&&(mb=ka.length-1);for(let ib=0,Gb=aa+2*Fa;ib<Gb;ib++){var Ya=wc*ib,La=wc*(ib+1);const Yb=wa+mb+Ya,rc=wa+mb+La;La=wa+ub+La;L(wa+ub+Ya);L(Yb);L(La);L(Yb);L(rc);L(La);Ya=l.length/3;Ya=Ja.generateSideWallUV(h,l,Ya-6,Ya-3,Ya-2,Ya-1);Y(Ya[0]);Y(Ya[1]);Y(Ya[3]);Y(Ya[1]);Y(Ya[2]);Y(Ya[3])}}}function H(ka,wa,Oa){P.push(ka);P.push(wa);P.push(Oa)}function I(ka,wa,Oa){L(ka);
L(wa);L(Oa);ka=l.length/3;ka=Ja.generateTopUV(h,l,ka-3,ka-2,ka-1);Y(ka[0]);Y(ka[1]);Y(ka[2])}function L(ka){l.push(P[3*ka]);l.push(P[3*ka+1]);l.push(P[3*ka+2])}function Y(ka){p.push(ka.x);p.push(ka.y)}const P=[];var Z=void 0!==c.curveSegments?c.curveSegments:12;const aa=void 0!==c.steps?c.steps:1,T=void 0!==c.depth?c.depth:1;let ha=void 0!==c.bevelEnabled?c.bevelEnabled:!0,Ca=void 0!==c.bevelThickness?c.bevelThickness:.2,xa=void 0!==c.bevelSize?c.bevelSize:Ca-.1,Ha=void 0!==c.bevelOffset?c.bevelOffset:
0,Fa=void 0!==c.bevelSegments?c.bevelSegments:3;var Ra=c.extrudePath;const Ja=void 0!==c.UVGenerator?c.UVGenerator:sn;let Ka,lb=!1;if(Ra){Ka=Ra.getSpacedPoints(aa);lb=!0;ha=!1;var wb=Ra.computeFrenetFrames(aa,!1);var Mb=new Da;var kb=new Da;var jc=new Da}ha||(Ha=xa=Ca=Fa=0);w=w.extractPoints(Z);Ra=w.shape;const Wb=w.holes;if(!Ij.isClockWise(Ra)){Ra=Ra.reverse();for(let ka=0,wa=Wb.length;ka<wa;ka++)w=Wb[ka],Ij.isClockWise(w)&&(Wb[ka]=w.reverse())}const Xb=Ij.triangulateShape(Ra,Wb),ad=Ra;for(let ka=
0,wa=Wb.length;ka<wa;ka++)Ra=Ra.concat(Wb[ka]);const wc=Ra.length,Tb=Xb.length;w=[];for(let ka=0,wa=ad.length,Oa=wa-1,Ya=ka+1;ka<wa;ka++,Oa++,Ya++)Oa===wa&&(Oa=0),Ya===wa&&(Ya=0),w[ka]=y(ad[ka],ad[Oa],ad[Ya]);Z=[];let Hb=w.concat();for(let ka=0,wa=Wb.length;ka<wa;ka++){var Ub=Wb[ka];var zc=[];for(let Oa=0,Ya=Ub.length,La=Ya-1,ub=Oa+1;Oa<Ya;Oa++,La++,ub++)La===Ya&&(La=0),ub===Ya&&(ub=0),zc[Oa]=y(Ub[Oa],Ub[La],Ub[ub]);Z.push(zc);Hb=Hb.concat(zc)}for(Ub=0;Ub<Fa;Ub++){zc=Ub/Fa;var cc=Ca*Math.cos(zc*Math.PI/
2),sa=xa*Math.sin(zc*Math.PI/2)+Ha;for(let ka=0,wa=ad.length;ka<wa;ka++)zc=x(ad[ka],w[ka],sa),H(zc.x,zc.y,-cc);for(let ka=0,wa=Wb.length;ka<wa;ka++){const Oa=Wb[ka];zc=Z[ka];for(let Ya=0,La=Oa.length;Ya<La;Ya++){const ub=x(Oa[Ya],zc[Ya],sa);H(ub.x,ub.y,-cc)}}}zc=xa+Ha;for(Ub=0;Ub<wc;Ub++)cc=ha?x(Ra[Ub],Hb[Ub],zc):Ra[Ub],lb?(kb.copy(wb.normals[0]).multiplyScalar(cc.x),Mb.copy(wb.binormals[0]).multiplyScalar(cc.y),jc.copy(Ka[0]).add(kb).add(Mb),H(jc.x,jc.y,jc.z)):H(cc.x,cc.y,0);for(Ub=1;Ub<=aa;Ub++)for(cc=
0;cc<wc;cc++)sa=ha?x(Ra[cc],Hb[cc],zc):Ra[cc],lb?(kb.copy(wb.normals[Ub]).multiplyScalar(sa.x),Mb.copy(wb.binormals[Ub]).multiplyScalar(sa.y),jc.copy(Ka[Ub]).add(kb).add(Mb),H(jc.x,jc.y,jc.z)):H(sa.x,sa.y,T/aa*Ub);for(wb=Fa-1;0<=wb;wb--){kb=wb/Fa;Mb=Ca*Math.cos(kb*Math.PI/2);kb=xa*Math.sin(kb*Math.PI/2)+Ha;for(let ka=0,wa=ad.length;ka<wa;ka++)jc=x(ad[ka],w[ka],kb),H(jc.x,jc.y,T+Mb);for(let ka=0,wa=Wb.length;ka<wa;ka++){jc=Wb[ka];zc=Z[ka];for(let Oa=0,Ya=jc.length;Oa<Ya;Oa++)Ra=x(jc[Oa],zc[Oa],kb),
lb?H(Ra.x,Ra.y+Ka[aa-1].y,Ka[aa-1].x+Mb):H(Ra.x,Ra.y,T+Mb)}}(function(){const ka=l.length/3;if(ha){var wa=0*wc;for(var Oa=0;Oa<Tb;Oa++){var Ya=Xb[Oa];I(Ya[2]+wa,Ya[1]+wa,Ya[0]+wa)}wa=wc*(aa+2*Fa);for(Oa=0;Oa<Tb;Oa++)Ya=Xb[Oa],I(Ya[0]+wa,Ya[1]+wa,Ya[2]+wa)}else{for(wa=0;wa<Tb;wa++)Oa=Xb[wa],I(Oa[2],Oa[1],Oa[0]);for(wa=0;wa<Tb;wa++)Oa=Xb[wa],I(Oa[0]+wc*aa,Oa[1]+wc*aa,Oa[2]+wc*aa)}h.addGroup(ka,l.length/3-ka,0)})();(function(){const ka=l.length/3;let wa=0;D(ad,wa);wa+=ad.length;for(let Oa=0,Ya=Wb.length;Oa<
Ya;Oa++){const La=Wb[Oa];D(La,wa);wa+=La.length}h.addGroup(ka,l.length/3-ka,1)})()}super();this.type="ExtrudeGeometry";this.parameters={shapes:a,options:c};a=Array.isArray(a)?a:[a];const h=this,l=[],p=[];for(let w=0,x=a.length;w<x;w++)e(a[w]);this.setAttribute("position",new Mc(l,3));this.setAttribute("uv",new Mc(p,2));this.computeVertexNormals()}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),c=this.parameters.shapes,e=this.parameters.options;
a.shapes=[];if(Array.isArray(c))for(let h=0,l=c.length;h<l;h++)a.shapes.push(c[h].uuid);else a.shapes.push(c.uuid);a.options=Object.assign({},e);void 0!==e.extrudePath&&(a.options.extrudePath=e.extrudePath.toJSON());return a}static fromJSON(a,c){const e=[];for(let h=0,l=a.shapes.length;h<l;h++)e.push(c[a.shapes[h]]);c=a.options.extrudePath;void 0!==c&&(a.options.extrudePath=(new el[c.type]).fromJSON(c));return new zm(e,a.options)}}const sn={generateTopUV:function(a,c,e,h,l){a=c[3*h];h=c[3*h+1];const p=
c[3*l];l=c[3*l+1];return[new Lb(c[3*e],c[3*e+1]),new Lb(a,h),new Lb(p,l)]},generateSideWallUV:function(a,c,e,h,l,p){a=c[3*e];const w=c[3*e+1];e=c[3*e+2];const x=c[3*h],y=c[3*h+1];h=c[3*h+2];const D=c[3*l],H=c[3*l+1];l=c[3*l+2];const I=c[3*p],L=c[3*p+1];c=c[3*p+2];return Math.abs(w-y)<Math.abs(a-x)?[new Lb(a,1-e),new Lb(x,1-h),new Lb(D,1-l),new Lb(I,1-c)]:[new Lb(w,1-e),new Lb(y,1-h),new Lb(H,1-l),new Lb(L,1-c)]}};class kk extends Rk{constructor(a=1,c=0){const e=(1+Math.sqrt(5))/2;super([-1,e,0,1,
e,0,-1,-e,0,1,-e,0,0,-1,e,0,1,e,0,-1,-e,0,1,-e,e,0,-1,e,0,1,-e,0,-1,-e,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,c);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:c}}static fromJSON(a){return new kk(a.radius,a.detail)}}class ai extends Rk{constructor(a=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,c);this.type="OctahedronGeometry";
this.parameters={radius:a,detail:c}}static fromJSON(a){return new ai(a.radius,a.detail)}}class gl extends Xc{constructor(a=.5,c=1,e=32,h=1,l=0,p=2*Math.PI){super();this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:c,thetaSegments:e,phiSegments:h,thetaStart:l,thetaLength:p};e=Math.max(3,e);h=Math.max(1,h);const w=[],x=[],y=[],D=[];var H=a;a=(c-a)/h;var I=new Da,L=new Lb;for(let Y=0;Y<=h;Y++){for(let P=0;P<=e;P++){const Z=l+P/e*p;I.x=H*Math.cos(Z);I.y=H*Math.sin(Z);x.push(I.x,I.y,
I.z);y.push(0,0,1);L.x=(I.x/c+1)/2;L.y=(I.y/c+1)/2;D.push(L.x,L.y)}H+=a}for(c=0;c<h;c++)for(l=c*(e+1),p=0;p<e;p++)H=p+l,a=H+e+1,I=H+e+2,L=H+1,w.push(H,a,L),w.push(a,I,L);this.setIndex(w);this.setAttribute("position",new Mc(x,3));this.setAttribute("normal",new Mc(y,3));this.setAttribute("uv",new Mc(D,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new gl(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}
class bj extends Xc{constructor(a=new Ej([new Lb(0,.5),new Lb(-.5,-.5),new Lb(.5,-.5)]),c=12){function e(D){const H=l.length/3;var I=D.extractPoints(c);D=I.shape;var L=I.holes;!1===Ij.isClockWise(D)&&(D=D.reverse());for(let Y=0,P=L.length;Y<P;Y++)I=L[Y],!0===Ij.isClockWise(I)&&(L[Y]=I.reverse());I=Ij.triangulateShape(D,L);for(let Y=0,P=L.length;Y<P;Y++)D=D.concat(L[Y]);for(let Y=0,P=D.length;Y<P;Y++)L=D[Y],l.push(L.x,L.y,0),p.push(0,0,1),w.push(L.x,L.y);for(let Y=0,P=I.length;Y<P;Y++)D=I[Y],h.push(D[0]+
H,D[1]+H,D[2]+H),y+=3}super();this.type="ShapeGeometry";this.parameters={shapes:a,curveSegments:c};const h=[],l=[],p=[],w=[];let x=0,y=0;if(!1===Array.isArray(a))e(a);else for(let D=0;D<a.length;D++)e(a[D]),this.addGroup(x,y,D),x+=y,y=0;this.setIndex(h);this.setAttribute("position",new Mc(l,3));this.setAttribute("normal",new Mc(p,3));this.setAttribute("uv",new Mc(w,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),c=this.parameters.shapes;
a.shapes=[];if(Array.isArray(c))for(let e=0,h=c.length;e<h;e++)a.shapes.push(c[e].uuid);else a.shapes.push(c.uuid);return a}static fromJSON(a,c){const e=[];for(let h=0,l=a.shapes.length;h<l;h++)e.push(c[a.shapes[h]]);return new bj(e,a.curveSegments)}}class Hl extends Xc{constructor(a=1,c=32,e=16,h=0,l=2*Math.PI,p=0,w=Math.PI){super();this.type="SphereGeometry";this.parameters={radius:a,widthSegments:c,heightSegments:e,phiStart:h,phiLength:l,thetaStart:p,thetaLength:w};c=Math.max(3,Math.floor(c));
e=Math.max(2,Math.floor(e));const x=Math.min(p+w,Math.PI);var y=0;const D=[];var H=new Da;const I=new Da,L=[],Y=[],P=[],Z=[];for(let aa=0;aa<=e;aa++){const T=[],ha=aa/e;let Ca=0;0===aa&&0===p?Ca=.5/c:aa===e&&x===Math.PI&&(Ca=-.5/c);for(let xa=0;xa<=c;xa++){const Ha=xa/c;H.x=-a*Math.cos(h+Ha*l)*Math.sin(p+ha*w);H.y=a*Math.cos(p+ha*w);H.z=a*Math.sin(h+Ha*l)*Math.sin(p+ha*w);Y.push(H.x,H.y,H.z);I.copy(H).normalize();P.push(I.x,I.y,I.z);Z.push(Ha+Ca,1-ha);T.push(y++)}D.push(T)}for(a=0;a<e;a++)for(h=0;h<
c;h++)l=D[a][h+1],w=D[a][h],y=D[a+1][h],H=D[a+1][h+1],(0!==a||0<p)&&L.push(l,w,H),(a!==e-1||x<Math.PI)&&L.push(w,y,H);this.setIndex(L);this.setAttribute("position",new Mc(Y,3));this.setAttribute("normal",new Mc(P,3));this.setAttribute("uv",new Mc(Z,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Hl(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class Zm extends Rk{constructor(a=1,c=0){super([1,
1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,c);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:c}}static fromJSON(a){return new Zm(a.radius,a.detail)}}class Ik extends Xc{constructor(a=1,c=.4,e=12,h=48,l=2*Math.PI){super();this.type="TorusGeometry";this.parameters={radius:a,tube:c,radialSegments:e,tubularSegments:h,arc:l};e=Math.floor(e);h=Math.floor(h);const p=[],w=[],x=[],y=[];var D=new Da,H=new Da;const I=new Da;for(let L=0;L<=e;L++)for(let Y=0;Y<=h;Y++){const P=Y/
h*l,Z=L/e*Math.PI*2;H.x=(a+c*Math.cos(Z))*Math.cos(P);H.y=(a+c*Math.cos(Z))*Math.sin(P);H.z=c*Math.sin(Z);w.push(H.x,H.y,H.z);D.x=a*Math.cos(P);D.y=a*Math.sin(P);I.subVectors(H,D).normalize();x.push(I.x,I.y,I.z);y.push(Y/h);y.push(L/e)}for(a=1;a<=e;a++)for(c=1;c<=h;c++)l=(h+1)*(a-1)+c-1,D=(h+1)*(a-1)+c,H=(h+1)*a+c,p.push((h+1)*a+c-1,l,H),p.push(l,D,H);this.setIndex(p);this.setAttribute("position",new Mc(w,3));this.setAttribute("normal",new Mc(x,3));this.setAttribute("uv",new Mc(y,2))}copy(a){super.copy(a);
this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Ik(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)}}class Il extends Xc{constructor(a=1,c=.4,e=64,h=8,l=2,p=3){function w(xa,Ha,Fa,Ra,Ja){const Ka=Math.sin(xa);Ha=Fa/Ha*xa;Fa=Math.cos(Ha);Ja.x=Ra*(2+Fa)*.5*Math.cos(xa);Ja.y=Ra*(2+Fa)*Ka*.5;Ja.z=Ra*Math.sin(Ha)*.5}super();this.type="TorusKnotGeometry";this.parameters={radius:a,tube:c,tubularSegments:e,radialSegments:h,p:l,q:p};e=Math.floor(e);h=Math.floor(h);
const x=[],y=[],D=[],H=[];var I=new Da;const L=new Da,Y=new Da,P=new Da,Z=new Da,aa=new Da,T=new Da;for(let xa=0;xa<=e;++xa){var ha=xa/e*l*Math.PI*2;w(ha,l,p,a,Y);w(ha+.01,l,p,a,P);aa.subVectors(P,Y);T.addVectors(P,Y);Z.crossVectors(aa,T);T.crossVectors(Z,aa);Z.normalize();T.normalize();for(ha=0;ha<=h;++ha){var Ca=ha/h*Math.PI*2;const Ha=-c*Math.cos(Ca);Ca=c*Math.sin(Ca);I.x=Y.x+(Ha*T.x+Ca*Z.x);I.y=Y.y+(Ha*T.y+Ca*Z.y);I.z=Y.z+(Ha*T.z+Ca*Z.z);y.push(I.x,I.y,I.z);L.subVectors(I,Y).normalize();D.push(L.x,
L.y,L.z);H.push(xa/e);H.push(ha/h)}}for(a=1;a<=e;a++)for(c=1;c<=h;c++)l=(h+1)*a+(c-1),p=(h+1)*a+c,I=(h+1)*(a-1)+c,x.push((h+1)*(a-1)+(c-1),l,I),x.push(l,p,I);this.setIndex(x);this.setAttribute("position",new Mc(y,3));this.setAttribute("normal",new Mc(D,3));this.setAttribute("uv",new Mc(H,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Il(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)}}class yk extends Xc{constructor(a=
new Gl(new Da(-1,-1,0),new Da(-1,1,0),new Da(1,1,0)),c=64,e=1,h=8,l=!1){function p(Z){H=a.getPointAt(Z/c,H);const aa=w.normals[Z];Z=w.binormals[Z];for(let ha=0;ha<=h;ha++){var T=ha/h*Math.PI*2;const Ca=Math.sin(T);T=-Math.cos(T);y.x=T*aa.x+Ca*Z.x;y.y=T*aa.y+Ca*Z.y;y.z=T*aa.z+Ca*Z.z;y.normalize();L.push(y.x,y.y,y.z);x.x=H.x+e*y.x;x.y=H.y+e*y.y;x.z=H.z+e*y.z;I.push(x.x,x.y,x.z)}}super();this.type="TubeGeometry";this.parameters={path:a,tubularSegments:c,radius:e,radialSegments:h,closed:l};const w=a.computeFrenetFrames(c,
l);this.tangents=w.tangents;this.normals=w.normals;this.binormals=w.binormals;const x=new Da,y=new Da,D=new Lb;let H=new Da;const I=[],L=[],Y=[],P=[];(function(){for(var Z=0;Z<c;Z++)p(Z);p(!1===l?c:0);for(Z=0;Z<=c;Z++)for(var aa=0;aa<=h;aa++)D.x=Z/c,D.y=aa/h,Y.push(D.x,D.y);for(Z=1;Z<=c;Z++)for(aa=1;aa<=h;aa++){const T=(h+1)*Z+(aa-1),ha=(h+1)*Z+aa,Ca=(h+1)*(Z-1)+aa;P.push((h+1)*(Z-1)+(aa-1),T,Ca);P.push(T,ha,Ca)}})();this.setIndex(P);this.setAttribute("position",new Mc(I,3));this.setAttribute("normal",
new Mc(L,3));this.setAttribute("uv",new Mc(Y,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON();a.path=this.parameters.path.toJSON();return a}static fromJSON(a){return new yk((new el[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class Wj extends Xc{constructor(a=null){super();this.type="WireframeGeometry";this.parameters={geometry:a};if(null!==a){const p=[],w=new Set,x=new Da,y=new Da;if(null!==
a.index){var c=a.attributes.position,e=a.index;a=a.groups;0===a.length&&(a=[{start:0,count:e.count,materialIndex:0}]);for(let D=0,H=a.length;D<H;++D){var h=a[D],l=h.start;h=h.count;for(let I=l,L=l+h;I<L;I+=3)for(l=0;3>l;l++){h=e.getX(I+l);const Y=e.getX(I+(l+1)%3);x.fromBufferAttribute(c,h);y.fromBufferAttribute(c,Y);!0===Ue(x,y,w)&&(p.push(x.x,x.y,x.z),p.push(y.x,y.y,y.z))}}}else{c=a.attributes.position;for(let D=0,H=c.count/3;D<H;D++)for(e=0;3>e;e++)a=3*D+(e+1)%3,x.fromBufferAttribute(c,3*D+e),
y.fromBufferAttribute(c,a),!0===Ue(x,y,w)&&(p.push(x.x,x.y,x.z),p.push(y.x,y.y,y.z))}this.setAttribute("position",new Mc(p,3))}}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}}var Hg=Object.freeze({__proto__:null,BoxGeometry:zh,CapsuleGeometry:Wl,CircleGeometry:yl,ConeGeometry:ym,CylinderGeometry:jk,DodecahedronGeometry:Hk,EdgesGeometry:qm,ExtrudeGeometry:zm,IcosahedronGeometry:kk,LatheGeometry:cl,OctahedronGeometry:ai,PlaneGeometry:Cf,PolyhedronGeometry:Rk,RingGeometry:gl,
ShapeGeometry:bj,SphereGeometry:Hl,TetrahedronGeometry:Zm,TorusGeometry:Ik,TorusKnotGeometry:Il,TubeGeometry:yk,WireframeGeometry:Wj});class $g extends Sa{constructor(a){super();this.isShadowMaterial=!0;this.type="ShadowMaterial";this.color=new ia(0);this.fog=this.transparent=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.fog=a.fog;return this}}class zk extends ih{constructor(a){super(a);this.isRawShaderMaterial=!0;this.type="RawShaderMaterial"}}class ah extends Sa{constructor(a){super();
this.isMeshStandardMaterial=!0;this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new ia(16777215);this.roughness=1;this.metalness=0;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new ia(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=
this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapRotation=new Qg;this.envMapIntensity=1;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=
a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;
this.envMapRotation.copy(a.envMapRotation);this.envMapIntensity=a.envMapIntensity;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class hl extends ah{constructor(a){super();this.isMeshPhysicalMaterial=!0;this.defines={STANDARD:"",PHYSICAL:""};this.type="MeshPhysicalMaterial";this.anisotropyRotation=0;this.clearcoatMap=this.anisotropyMap=
null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=null;this.clearcoatNormalScale=new Lb(1,1);this.clearcoatNormalMap=null;this.ior=1.5;Object.defineProperty(this,"reflectivity",{get:function(){return qc(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}});this.iridescenceMap=null;this.iridescenceIOR=1.3;this.iridescenceThicknessRange=[100,400];this.iridescenceThicknessMap=null;this.sheenColor=new ia(0);this.sheenColorMap=null;this.sheenRoughness=1;this.transmissionMap=
this.sheenRoughnessMap=null;this.thickness=0;this.thicknessMap=null;this.attenuationDistance=Infinity;this.attenuationColor=new ia(1,1,1);this.specularIntensity=1;this.specularIntensityMap=null;this.specularColor=new ia(1,1,1);this.specularColorMap=null;this._transmission=this._sheen=this._iridescence=this._dispersion=this._clearcoat=this._anisotropy=0;this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){0<this._anisotropy!==0<a&&this.version++;this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){0<
this._clearcoat!==0<a&&this.version++;this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){0<this._iridescence!==0<a&&this.version++;this._iridescence=a}get dispersion(){return this._dispersion}set dispersion(a){0<this._dispersion!==0<a&&this.version++;this._dispersion=a}get sheen(){return this._sheen}set sheen(a){0<this._sheen!==0<a&&this.version++;this._sheen=a}get transmission(){return this._transmission}set transmission(a){0<this._transmission!==0<a&&this.version++;
this._transmission=a}copy(a){super.copy(a);this.defines={STANDARD:"",PHYSICAL:""};this.anisotropy=a.anisotropy;this.anisotropyRotation=a.anisotropyRotation;this.anisotropyMap=a.anisotropyMap;this.clearcoat=a.clearcoat;this.clearcoatMap=a.clearcoatMap;this.clearcoatRoughness=a.clearcoatRoughness;this.clearcoatRoughnessMap=a.clearcoatRoughnessMap;this.clearcoatNormalMap=a.clearcoatNormalMap;this.clearcoatNormalScale.copy(a.clearcoatNormalScale);this.dispersion=a.dispersion;this.ior=a.ior;this.iridescence=
a.iridescence;this.iridescenceMap=a.iridescenceMap;this.iridescenceIOR=a.iridescenceIOR;this.iridescenceThicknessRange=[...a.iridescenceThicknessRange];this.iridescenceThicknessMap=a.iridescenceThicknessMap;this.sheen=a.sheen;this.sheenColor.copy(a.sheenColor);this.sheenColorMap=a.sheenColorMap;this.sheenRoughness=a.sheenRoughness;this.sheenRoughnessMap=a.sheenRoughnessMap;this.transmission=a.transmission;this.transmissionMap=a.transmissionMap;this.thickness=a.thickness;this.thicknessMap=a.thicknessMap;
this.attenuationDistance=a.attenuationDistance;this.attenuationColor.copy(a.attenuationColor);this.specularIntensity=a.specularIntensity;this.specularIntensityMap=a.specularIntensityMap;this.specularColor.copy(a.specularColor);this.specularColorMap=a.specularColorMap;return this}}class Em extends Sa{constructor(a){super();this.isMeshPhongMaterial=!0;this.type="MeshPhongMaterial";this.color=new ia(16777215);this.specular=new ia(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=
1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new ia(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Qg;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=
a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class il extends Sa{constructor(a){super();this.isMeshToonMaterial=!0;this.defines={TOON:""};this.type="MeshToonMaterial";this.color=new ia(16777215);this.lightMap=this.gradientMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new ia(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;
this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.gradientMap=a.gradientMap;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=a.alphaMap;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;
this.fog=a.fog;return this}}class Ve extends Sa{constructor(a){super();this.isMeshNormalMaterial=!0;this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.flatShading=!1;this.setValues(a)}copy(a){super.copy(a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=
a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.flatShading=a.flatShading;return this}}class km extends Sa{constructor(a){super();this.isMeshLambertMaterial=!0;this.type="MeshLambertMaterial";this.color=new ia(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=
1;this.emissive=new ia(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Qg;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=
!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=
a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class jm extends Sa{constructor(a){super();
this.isMeshMatcapMaterial=!0;this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new ia(16777215);this.bumpMap=this.map=this.matcap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Lb(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={MATCAP:""};this.color.copy(a.color);this.matcap=a.matcap;this.map=a.map;this.bumpMap=
a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=a.alphaMap;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class Kh extends jh{constructor(a){super();this.isLineDashedMaterial=!0;this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}copy(a){super.copy(a);
this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this}}const ei={convertArray:th,isTypedArray:Di,getKeyframeOrder:cj,sortedArray:Af,flattenJSON:Ei,subclip:function(a,c,e,h,l=30){a=a.clone();a.name=c;c=[];for(let w=0;w<a.tracks.length;++w){const x=a.tracks[w],y=x.getValueSize(),D=[],H=[];for(let I=0;I<x.times.length;++I){var p=x.times[I]*l;if(!(p<e||p>=h))for(D.push(x.times[I]),p=0;p<y;++p)H.push(x.values[I*y+p])}0!==D.length&&(x.times=th(D,x.times.constructor),x.values=th(H,
x.values.constructor),c.push(x))}a.tracks=c;e=Infinity;for(h=0;h<a.tracks.length;++h)e>a.tracks[h].times[0]&&(e=a.tracks[h].times[0]);for(h=0;h<a.tracks.length;++h)a.tracks[h].shift(-1*e);a.resetDuration();return a},makeClipAdditive:function(a,c=0,e=a,h=30){0>=h&&(h=30);const l=e.tracks.length;c/=h;for(h=0;h<l;++h){const D=e.tracks[h],H=D.ValueTypeName;if("bool"===H||"string"===H)continue;const I=a.tracks.find(function(P){return P.name===D.name&&P.ValueTypeName===H});if(void 0===I)continue;var p=
0,w=D.getValueSize();D.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=w/3);let L=0;const Y=I.getValueSize();I.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(L=Y/3);var x=D.times.length-1;if(c<=D.times[0])p=D.values.slice(p,w-p);else if(c>=D.times[x])x=x*w+p,p=D.values.slice(x,x+w-p);else{x=D.createInterpolant();var y=p;p=w-p;x.evaluate(c);p=x.resultBuffer.slice(y,p)}"quaternion"===H&&(new Ze).fromArray(p).normalize().conjugate().toArray(p);w=I.times.length;for(x=0;x<
w;++x)if(y=x*Y+L,"quaternion"===H)Ze.multiplyQuaternionsFlat(I.values,y,p,0,I.values,y);else{const P=Y-2*L;for(let Z=0;Z<P;++Z)I.values[y+Z]-=p[Z]}}a.blendMode=2501;return a}};class Ci{constructor(a,c,e,h){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==h?h:new c.constructor(e);this.sampleValues=c;this.valueSize=e;this.settings=null;this.DefaultSettings_={}}evaluate(a){const c=this.parameterPositions;let e=this._cachedIndex;var h=c[e],l=c[e-1];a:{b:{c:{d:if(!(a<h)){for(var p=
e+2;;){if(void 0===h){if(a<l)break d;this._cachedIndex=e=c.length;return this.copySampleValue_(e-1)}if(e===p)break;l=h;h=c[++e];if(a<h)break b}l=c.length;break c}if(a>=l)break a;else{h=c[1];a<h&&(e=2,l=h);for(p=e-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(e===p)break;h=l;l=c[--e-1];if(a>=l)break b}l=e;e=0}}for(;e<l;)h=e+l>>>1,a<c[h]?l=h:e=h+1;h=c[e];l=c[e-1];if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===h)return this._cachedIndex=e=c.length,
this.copySampleValue_(e-1)}this._cachedIndex=e;this.intervalChanged_(e,l,h)}return this.interpolate_(e,l,a,h)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const c=this.resultBuffer,e=this.sampleValues,h=this.valueSize;a*=h;for(let l=0;l!==h;++l)c[l]=e[a+l];return c}interpolate_(){throw Error("call to abstract method");}intervalChanged_(){}}class Lh extends Ci{constructor(a,c,e,h){super(a,c,e,h);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0;
this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,c,e){var h=this.parameterPositions;let l=a-2,p=a+1,w=h[l],x=h[p];if(void 0===w)switch(this.getSettings_().endingStart){case 2401:l=a;w=2*c-e;break;case 2402:l=h.length-2;w=c+h[l]-h[l+1];break;default:l=a,w=e}if(void 0===x)switch(this.getSettings_().endingEnd){case 2401:p=a;x=2*e-c;break;case 2402:p=1;x=e+h[1]-h[0];break;default:p=a-1,x=c}a=.5*(e-c);h=this.valueSize;this._weightPrev=a/(c-w);this._weightNext=a/(x-e);this._offsetPrev=
l*h;this._offsetNext=p*h}interpolate_(a,c,e,h){const l=this.resultBuffer,p=this.sampleValues,w=this.valueSize;a*=w;const x=a-w,y=this._offsetPrev,D=this._offsetNext;var H=this._weightPrev,I=this._weightNext,L=(e-c)/(h-c);e=L*L;h=e*L;c=-H*h+2*H*e-H*L;H=(1+H)*h+(-1.5-2*H)*e+(-.5+H)*L+1;L=(-1-I)*h+(1.5+I)*e+.5*L;I=I*h-I*e;for(e=0;e!==w;++e)l[e]=c*p[y+e]+H*p[x+e]+L*p[a+e]+I*p[D+e];return l}}class Bi extends Ci{constructor(a,c,e,h){super(a,c,e,h)}interpolate_(a,c,e,h){const l=this.resultBuffer,p=this.sampleValues,
w=this.valueSize;a*=w;const x=a-w;c=(e-c)/(h-c);e=1-c;for(h=0;h!==w;++h)l[h]=p[x+h]*e+p[a+h]*c;return l}}class uh extends Ci{constructor(a,c,e,h){super(a,c,e,h)}interpolate_(a){return this.copySampleValue_(a-1)}}class rf{constructor(a,c,e,h){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=th(c,this.TimeBufferType);this.values=th(e,this.ValueBufferType);this.setInterpolation(h||
this.DefaultInterpolation)}static toJSON(a){var c=a.constructor;if(c.toJSON!==this.toJSON)c=c.toJSON(a);else{c={name:a.name,times:th(a.times,Array),values:th(a.values,Array)};const e=a.getInterpolation();e!==a.DefaultInterpolation&&(c.interpolation=e)}c.type=a.ValueTypeName;return c}InterpolantFactoryMethodDiscrete(a){return new uh(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new Bi(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new Lh(this.times,
this.values,this.getValueSize(),a)}setInterpolation(a){switch(a){case 2300:var c=this.InterpolantFactoryMethodDiscrete;break;case 2301:c=this.InterpolantFactoryMethodLinear;break;case 2302:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){c="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(c);console.warn("THREE.KeyframeTrack:",
c);return this}this.createInterpolant=c;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){const c=this.times;for(let e=0,h=c.length;e!==h;++e)c[e]+=a}return this}scale(a){if(1!==a){const c=this.times;for(let e=0,h=c.length;e!==h;++e)c[e]*=a}return this}trim(a,
c){const e=this.times,h=e.length;let l=0,p=h-1;for(;l!==h&&e[l]<a;)++l;for(;-1!==p&&e[p]>c;)--p;++p;if(0!==l||p!==h)l>=p&&(p=Math.max(p,1),l=p-1),a=this.getValueSize(),this.times=e.slice(l,p),this.values=this.values.slice(l*a,p*a);return this}validate(){let a=!0;var c=this.getValueSize();0!==c-Math.floor(c)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var e=this.times;c=this.values;const h=e.length;0===h&&(console.error("THREE.KeyframeTrack: Track is empty.",this),
a=!1);let l=null;for(let p=0;p!==h;p++){const w=e[p];if("number"===typeof w&&isNaN(w)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,p,w);a=!1;break}if(null!==l&&l>w){console.error("THREE.KeyframeTrack: Out of order keys.",this,p,w,l);a=!1;break}l=w}if(void 0!==c&&Di(c))for(let p=0,w=c.length;p!==w;++p)if(e=c[p],isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,e);a=!1;break}return a}optimize(){const a=this.times.slice(),c=this.values.slice(),
e=this.getValueSize(),h=2302===this.getInterpolation(),l=a.length-1;let p=1;for(let D=1;D<l;++D){var w=!1,x=a[D];if(x!==a[D+1]&&(1!==D||x!==a[0]))if(h)w=!0;else{x=D*e;var y=x-e;const H=x+e;for(let I=0;I!==e;++I){const L=c[x+I];if(L!==c[y+I]||L!==c[H+I]){w=!0;break}}}if(w){if(D!==p)for(a[p]=a[D],w=D*e,x=p*e,y=0;y!==e;++y)c[x+y]=c[w+y];++p}}if(0<l){a[p]=a[l];for(let D=l*e,H=p*e,I=0;I!==e;++I)c[H+I]=c[D+I];++p}p!==a.length?(this.times=a.slice(0,p),this.values=c.slice(0,p*e)):(this.times=a,this.values=
c);return this}clone(){var a=this.times.slice();const c=this.values.slice();a=new this.constructor(this.name,a,c);a.createInterpolant=this.createInterpolant;return a}}rf.prototype.TimeBufferType=Float32Array;rf.prototype.ValueBufferType=Float32Array;rf.prototype.DefaultInterpolation=2301;class he extends rf{constructor(a,c,e){super(a,c,e)}}he.prototype.ValueTypeName="bool";he.prototype.ValueBufferType=Array;he.prototype.DefaultInterpolation=2300;he.prototype.InterpolantFactoryMethodLinear=void 0;
he.prototype.InterpolantFactoryMethodSmooth=void 0;class vh extends rf{}vh.prototype.ValueTypeName="color";class ki extends rf{}ki.prototype.ValueTypeName="number";class Bj extends Ci{constructor(a,c,e,h){super(a,c,e,h)}interpolate_(a,c,e,h){const l=this.resultBuffer,p=this.sampleValues,w=this.valueSize;c=(e-c)/(h-c);a*=w;for(e=a+w;a!==e;a+=4)Ze.slerpFlat(l,0,p,a-w,p,a,c);return l}}class nl extends rf{InterpolantFactoryMethodLinear(a){return new Bj(this.times,this.values,this.getValueSize(),a)}}nl.prototype.ValueTypeName=
"quaternion";nl.prototype.InterpolantFactoryMethodSmooth=void 0;class ej extends rf{constructor(a,c,e){super(a,c,e)}}ej.prototype.ValueTypeName="string";ej.prototype.ValueBufferType=Array;ej.prototype.DefaultInterpolation=2300;ej.prototype.InterpolantFactoryMethodLinear=void 0;ej.prototype.InterpolantFactoryMethodSmooth=void 0;class xj extends rf{}xj.prototype.ValueTypeName="vector";class ch{constructor(a="",c=-1,e=[],h=2500){this.name=a;this.tracks=e;this.duration=c;this.blendMode=h;this.uuid=Na();
0>this.duration&&this.resetDuration()}static parse(a){var c=[];const e=a.tracks,h=1/(a.fps||1);for(let x=0,y=e.length;x!==y;++x){var l=c,p=l.push;{var w=e[x];if(void 0===w.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");const D=Gf(w.type);if(void 0===w.times){const H=[],I=[];Ei(w.keys,H,I,"value");w.times=H;w.values=I}w=void 0!==D.parse?D.parse(w):new D(w.name,w.times,w.values,w.interpolation)}p.call(l,w.scale(h))}c=new this(a.name,a.duration,c,a.blendMode);c.uuid=a.uuid;
return c}static toJSON(a){const c=[],e=a.tracks;a={name:a.name,duration:a.duration,tracks:c,uuid:a.uuid,blendMode:a.blendMode};for(let h=0,l=e.length;h!==l;++h)c.push(rf.toJSON(e[h]));return a}static CreateFromMorphTargetSequence(a,c,e,h){const l=c.length,p=[];for(let w=0;w<l;w++){let x=[],y=[];x.push((w+l-1)%l,w,(w+1)%l);y.push(0,1,0);const D=cj(x);x=Af(x,1,D);y=Af(y,1,D);h||0!==x[0]||(x.push(l),y.push(y[0]));p.push((new ki(".morphTargetInfluences["+c[w].name+"]",x,y)).scale(1/e))}return new this(a,
-1,p)}static findByName(a,c){let e=a;Array.isArray(a)||(e=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<e.length;a++)if(e[a].name===c)return e[a];return null}static CreateClipsFromMorphTargetSequences(a,c,e){const h={},l=/^([\w-]*?)([\d]+)$/;for(let w=0,x=a.length;w<x;w++){const y=a[w];var p=y.name.match(l);if(p&&1<p.length){p=p[1];let D=h[p];D||(h[p]=D=[]);D.push(y)}}a=[];for(const w in h)a.push(this.CreateFromMorphTargetSequence(w,h[w],c,e));return a}static parseAnimation(a,c){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),
null;const e=function(H,I,L,Y,P){if(0!==L.length){const Z=[],aa=[];Ei(L,Z,aa,Y);0!==Z.length&&P.push(new H(I,Z,aa))}},h=[],l=a.name||"default",p=a.fps||30,w=a.blendMode;var x=a.length||-1;a=a.hierarchy||[];for(let H=0;H<a.length;H++){const I=a[H].keys;if(I&&0!==I.length)if(I[0].morphTargets){x={};var y=void 0;for(y=0;y<I.length;y++)if(I[y].morphTargets)for(var D=0;D<I[y].morphTargets.length;D++)x[I[y].morphTargets[D]]=-1;for(const L in x){D=[];const Y=[];for(let P=0;P!==I[y].morphTargets.length;++P){const Z=
I[y];D.push(Z.time);Y.push(Z.morphTarget===L?1:0)}h.push(new ki(".morphTargetInfluence["+L+"]",D,Y))}x=x.length*p}else y=".bones["+c[H].name+"]",e(xj,y+".position",I,"pos",h),e(nl,y+".quaternion",I,"rot",h),e(xj,y+".scale",I,"scl",h)}return 0===h.length?null:new this(l,x,h,w)}resetDuration(){var a=this.tracks;let c=0;for(let e=0,h=a.length;e!==h;++e)a=this.tracks[e],c=Math.max(c,a.times[a.times.length-1]);this.duration=c;return this}trim(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,
this.duration);return this}validate(){let a=!0;for(let c=0;c<this.tracks.length;c++)a=a&&this.tracks[c].validate();return a}optimize(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}clone(){const a=[];for(let c=0;c<this.tracks.length;c++)a.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,a,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const Zf={enabled:!1,files:{},add:function(a,c){!1!==this.enabled&&(this.files[a]=c)},get:function(a){if(!1!==
this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Lg{constructor(a,c,e){const h=this;let l=!1,p=0,w=0,x=void 0;const y=[];this.onStart=void 0;this.onLoad=a;this.onProgress=c;this.onError=e;this.itemStart=function(D){w++;if(!1===l&&void 0!==h.onStart)h.onStart(D,p,w);l=!0};this.itemEnd=function(D){p++;if(void 0!==h.onProgress)h.onProgress(D,p,w);if(p===w&&(l=!1,void 0!==h.onLoad))h.onLoad()};this.itemError=function(D){if(void 0!==h.onError)h.onError(D)};
this.resolveURL=function(D){return x?x(D):D};this.setURLModifier=function(D){x=D;return this};this.addHandler=function(D,H){y.push(D,H);return this};this.removeHandler=function(D){D=y.indexOf(D);-1!==D&&y.splice(D,2);return this};this.getHandler=function(D){for(let H=0,I=y.length;H<I;H+=2){const L=y[H],Y=y[H+1];L.global&&(L.lastIndex=0);if(L.test(D))return Y}return null}}}const ag=new Lg;class Ye{constructor(a){this.manager=void 0!==a?a:ag;this.crossOrigin="anonymous";this.withCredentials=!1;this.resourcePath=
this.path="";this.requestHeader={}}load(){}loadAsync(a,c){const e=this;return new Promise(function(h,l){e.load(a,h,c,l)})}parse(){}setCrossOrigin(a){this.crossOrigin=a;return this}setWithCredentials(a){this.withCredentials=a;return this}setPath(a){this.path=a;return this}setResourcePath(a){this.resourcePath=a;return this}setRequestHeader(a){this.requestHeader=a;return this}}Ye.DEFAULT_MATERIAL_NAME="__DEFAULT";const bg={};class Jl extends Error{constructor(a,c){super(a);this.response=c}}class Mh extends Ye{constructor(a){super(a)}load(a,
c,e,h){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const l=Zf.get(a);if(void 0!==l)return this.manager.itemStart(a),setTimeout(()=>{c&&c(l);this.manager.itemEnd(a)},0),l;if(void 0!==bg[a])bg[a].push({onLoad:c,onProgress:e,onError:h});else{bg[a]=[];bg[a].push({onLoad:c,onProgress:e,onError:h});e=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});var p=this.mimeType,w=this.responseType;fetch(e).then(x=>
{if(200===x.status||0===x.status){0===x.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");if("undefined"===typeof ReadableStream||void 0===x.body||void 0===x.body.getReader)return x;const y=bg[a],D=x.body.getReader(),H=(x=x.headers.get("X-File-Size")||x.headers.get("Content-Length"))?parseInt(x):0,I=0!==H;let L=0;x=new ReadableStream({start(Y){function P(){D.read().then(({done:Z,value:aa})=>{if(Z)Y.close();else{L+=aa.byteLength;Z=new ProgressEvent("progress",{lengthComputable:I,loaded:L,
total:H});for(let T=0,ha=y.length;T<ha;T++){const Ca=y[T];if(Ca.onProgress)Ca.onProgress(Z)}Y.enqueue(aa);P()}},Z=>{Y.error(Z)})}P()}});return new Response(x)}throw new Jl(`fetch for "${x.url}" responded with ${x.status}: ${x.statusText}`,x);}).then(x=>{switch(w){case "arraybuffer":return x.arrayBuffer();case "blob":return x.blob();case "document":return x.text().then(H=>(new DOMParser).parseFromString(H,p));case "json":return x.json();default:if(void 0===p)return x.text();var y=/charset="?([^;"\s]*)"?/i.exec(p);
y=y&&y[1]?y[1].toLowerCase():void 0;const D=new TextDecoder(y);return x.arrayBuffer().then(H=>D.decode(H))}}).then(x=>{Zf.add(a,x);const y=bg[a];delete bg[a];for(let D=0,H=y.length;D<H;D++){const I=y[D];if(I.onLoad)I.onLoad(x)}}).catch(x=>{const y=bg[a];if(void 0===y)throw this.manager.itemError(a),x;delete bg[a];for(let D=0,H=y.length;D<H;D++){const I=y[D];if(I.onError)I.onError(x)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)});this.manager.itemStart(a)}}setResponseType(a){this.responseType=
a;return this}setMimeType(a){this.mimeType=a;return this}}class ze extends Ye{constructor(a){super(a)}load(a,c,e,h){const l=this,p=new Mh(this.manager);p.setPath(this.path);p.setRequestHeader(this.requestHeader);p.setWithCredentials(this.withCredentials);p.load(a,function(w){try{c(l.parse(JSON.parse(w)))}catch(x){h?h(x):console.error(x),l.manager.itemError(a)}},e,h)}parse(a){const c=[];for(let e=0;e<a.length;e++){const h=ch.parse(a[e]);c.push(h)}return c}}class lm extends Ye{constructor(a){super(a)}load(a,
c,e,h){function l(H){y.load(a[H],function(I){I=p.parse(I,!0);w[H]={width:I.width,height:I.height,format:I.format,mipmaps:I.mipmaps};D+=1;6===D&&(1===I.mipmapCount&&(x.minFilter=1006),x.image=w,x.format=I.format,x.needsUpdate=!0,c&&c(x))},e,h)}const p=this,w=[],x=new am,y=new Mh(this.manager);y.setPath(this.path);y.setResponseType("arraybuffer");y.setRequestHeader(this.requestHeader);y.setWithCredentials(p.withCredentials);let D=0;if(Array.isArray(a))for(let H=0,I=a.length;H<I;++H)l(H);else y.load(a,
function(H){H=p.parse(H,!0);if(H.isCubemap){const I=H.mipmaps.length/H.mipmapCount;for(let L=0;L<I;L++){w[L]={mipmaps:[]};for(let Y=0;Y<H.mipmapCount;Y++)w[L].mipmaps.push(H.mipmaps[L*H.mipmapCount+Y]),w[L].format=H.format,w[L].width=H.width,w[L].height=H.height}x.image=w}else x.image.width=H.width,x.image.height=H.height,x.mipmaps=H.mipmaps;1===H.mipmapCount&&(x.minFilter=1006);x.format=H.format;x.needsUpdate=!0;c&&c(x)},e,h);return x}}class Yj extends Ye{constructor(a){super(a)}load(a,c,e,h){function l(){w();
Zf.add(a,this);c&&c(this);x.manager.itemEnd(a)}function p(H){w();h&&h(H);x.manager.itemError(a);x.manager.itemEnd(a)}function w(){D.removeEventListener("load",l,!1);D.removeEventListener("error",p,!1)}void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const x=this,y=Zf.get(a);if(void 0!==y)return x.manager.itemStart(a),setTimeout(function(){c&&c(y);x.manager.itemEnd(a)},0),y;const D=Ab("img");D.addEventListener("load",l,!1);D.addEventListener("error",p,!1);"data:"!==a.slice(0,5)&&void 0!==
this.crossOrigin&&(D.crossOrigin=this.crossOrigin);x.manager.itemStart(a);D.src=a;return D}}class nm extends Ye{constructor(a){super(a)}load(a,c,e,h){function l(y){w.load(a[y],function(D){p.images[y]=D;x++;6===x&&(p.needsUpdate=!0,c&&c(p))},void 0,h)}const p=new Ck;p.colorSpace="srgb";const w=new Yj(this.manager);w.setCrossOrigin(this.crossOrigin);w.setPath(this.path);let x=0;for(e=0;e<a.length;++e)l(e);return p}}class Bk extends Ye{constructor(a){super(a)}load(a,c,e,h){const l=this,p=new jg,w=new Mh(this.manager);
w.setResponseType("arraybuffer");w.setRequestHeader(this.requestHeader);w.setPath(this.path);w.setWithCredentials(l.withCredentials);w.load(a,function(x){let y;try{y=l.parse(x)}catch(D){if(void 0!==h)h(D);else{console.error(D);return}}void 0!==y.image?p.image=y.image:void 0!==y.data&&(p.image.width=y.width,p.image.height=y.height,p.image.data=y.data);p.wrapS=void 0!==y.wrapS?y.wrapS:1001;p.wrapT=void 0!==y.wrapT?y.wrapT:1001;p.magFilter=void 0!==y.magFilter?y.magFilter:1006;p.minFilter=void 0!==y.minFilter?
y.minFilter:1006;p.anisotropy=void 0!==y.anisotropy?y.anisotropy:1;void 0!==y.colorSpace&&(p.colorSpace=y.colorSpace);void 0!==y.flipY&&(p.flipY=y.flipY);void 0!==y.format&&(p.format=y.format);void 0!==y.type&&(p.type=y.type);void 0!==y.mipmaps&&(p.mipmaps=y.mipmaps,p.minFilter=1008);1===y.mipmapCount&&(p.minFilter=1006);void 0!==y.generateMipmaps&&(p.generateMipmaps=y.generateMipmaps);p.needsUpdate=!0;c&&c(p,y)},e,h);return p}}class xe extends Ye{constructor(a){super(a)}load(a,c,e,h){const l=new Ld,
p=new Yj(this.manager);p.setCrossOrigin(this.crossOrigin);p.setPath(this.path);p.load(a,function(w){l.image=w;l.needsUpdate=!0;void 0!==c&&c(l)},e,h);return l}}class Oe extends Nd{constructor(a,c=1){super();this.isLight=!0;this.type="Light";this.color=new ia(a);this.intensity=c}dispose(){}copy(a,c){super.copy(a,c);this.color.copy(a.color);this.intensity=a.intensity;return this}toJSON(a){a=super.toJSON(a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&
(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());void 0!==this.target&&(a.object.target=this.target.uuid);return a}}class cg extends Oe{constructor(a,c,e){super(a,e);this.isHemisphereLight=!0;this.type="HemisphereLight";this.position.copy(Nd.DEFAULT_UP);
this.updateMatrix();this.groundColor=new ia(c)}copy(a,c){super.copy(a,c);this.groundColor.copy(a.groundColor);return this}}const ml=new Wc,ll=new Da,Kl=new Da;class Xl{constructor(a){this.camera=a;this.intensity=1;this.normalBias=this.bias=0;this.radius=1;this.blurSamples=8;this.mapSize=new Lb(512,512);this.mapPass=this.map=null;this.matrix=new Wc;this.autoUpdate=!0;this.needsUpdate=!1;this._frustum=new fk;this._frameExtents=new Lb(1,1);this._viewportCount=1;this._viewports=[new yd(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const c=
this.camera,e=this.matrix;ll.setFromMatrixPosition(a.matrixWorld);c.position.copy(ll);Kl.setFromMatrixPosition(a.target.matrixWorld);c.lookAt(Kl);c.updateMatrixWorld();ml.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);this._frustum.setFromProjectionMatrix(ml);e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);e.multiply(ml)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose();this.mapPass&&this.mapPass.dispose()}copy(a){this.camera=
a.camera.clone();this.intensity=a.intensity;this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this}clone(){return(new this.constructor).copy(this)}toJSON(){const a={};1!==this.intensity&&(a.intensity=this.intensity);0!==this.bias&&(a.bias=this.bias);0!==this.normalBias&&(a.normalBias=this.normalBias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;
return a}}class Mg extends Xl{constructor(){super(new Sf(50,1,.5,500));this.isSpotLightShadow=!0;this.focus=1}updateMatrices(a){const c=this.camera,e=2*bh*a.angle*this.focus,h=this.mapSize.width/this.mapSize.height,l=a.distance||c.far;if(e!==c.fov||h!==c.aspect||l!==c.far)c.fov=e,c.aspect=h,c.far=l,c.updateProjectionMatrix();super.updateMatrices(a)}copy(a){super.copy(a);this.focus=a.focus;return this}}class nn extends Oe{constructor(a,c,e=0,h=Math.PI/3,l=0,p=2){super(a,c);this.isSpotLight=!0;this.type=
"SpotLight";this.position.copy(Nd.DEFAULT_UP);this.updateMatrix();this.target=new Nd;this.distance=e;this.angle=h;this.penumbra=l;this.decay=p;this.map=null;this.shadow=new Mg}get power(){return this.intensity*Math.PI}set power(a){this.intensity=a/Math.PI}dispose(){this.shadow.dispose()}copy(a,c){super.copy(a,c);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}const Vm=new Wc,mm=new Da,Ll=
new Da;class on extends Xl{constructor(){super(new Sf(90,1,.5,500));this.isPointLightShadow=!0;this._frameExtents=new Lb(4,2);this._viewportCount=6;this._viewports=[new yd(2,1,1,1),new yd(0,1,1,1),new yd(3,1,1,1),new yd(1,1,1,1),new yd(3,0,1,1),new yd(1,0,1,1)];this._cubeDirections=[new Da(1,0,0),new Da(-1,0,0),new Da(0,0,1),new Da(0,0,-1),new Da(0,1,0),new Da(0,-1,0)];this._cubeUps=[new Da(0,1,0),new Da(0,1,0),new Da(0,1,0),new Da(0,1,0),new Da(0,0,1),new Da(0,0,-1)]}updateMatrices(a,c=0){const e=
this.camera,h=this.matrix,l=a.distance||e.far;l!==e.far&&(e.far=l,e.updateProjectionMatrix());mm.setFromMatrixPosition(a.matrixWorld);e.position.copy(mm);Ll.copy(e.position);Ll.add(this._cubeDirections[c]);e.up.copy(this._cubeUps[c]);e.lookAt(Ll);e.updateMatrixWorld();h.makeTranslation(-mm.x,-mm.y,-mm.z);Vm.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Vm)}}class pn extends Oe{constructor(a,c,e=0,h=2){super(a,c);this.isPointLight=!0;this.type="PointLight";
this.distance=e;this.decay=h;this.shadow=new on}get power(){return 4*this.intensity*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,c){super.copy(a,c);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this}}class dh extends Xl{constructor(){super(new Th(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=!0}}class pm extends Oe{constructor(a,c){super(a,c);this.isDirectionalLight=!0;this.type="DirectionalLight";this.position.copy(Nd.DEFAULT_UP);
this.updateMatrix();this.target=new Nd;this.shadow=new dh}dispose(){this.shadow.dispose()}copy(a){super.copy(a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}class rn extends Oe{constructor(a,c){super(a,c);this.isAmbientLight=!0;this.type="AmbientLight"}}class Xm extends Oe{constructor(a,c,e=10,h=10){super(a,c);this.isRectAreaLight=!0;this.type="RectAreaLight";this.width=e;this.height=h}get power(){return this.intensity*this.width*this.height*Math.PI}set power(a){this.intensity=
a/(this.width*this.height*Math.PI)}copy(a){super.copy(a);this.width=a.width;this.height=a.height;return this}toJSON(a){a=super.toJSON(a);a.object.width=this.width;a.object.height=this.height;return a}}class qn{constructor(){this.isSphericalHarmonics3=!0;this.coefficients=[];for(let a=0;9>a;a++)this.coefficients.push(new Da)}set(a){for(let c=0;9>c;c++)this.coefficients[c].copy(a[c]);return this}zero(){for(let a=0;9>a;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,c){const e=a.x,h=a.y;a=a.z;
const l=this.coefficients;c.copy(l[0]).multiplyScalar(.282095);c.addScaledVector(l[1],.488603*h);c.addScaledVector(l[2],.488603*a);c.addScaledVector(l[3],.488603*e);c.addScaledVector(l[4],1.092548*e*h);c.addScaledVector(l[5],1.092548*h*a);c.addScaledVector(l[6],.315392*(3*a*a-1));c.addScaledVector(l[7],1.092548*e*a);c.addScaledVector(l[8],.546274*(e*e-h*h));return c}getIrradianceAt(a,c){const e=a.x,h=a.y;a=a.z;const l=this.coefficients;c.copy(l[0]).multiplyScalar(.886227);c.addScaledVector(l[1],1.023328*
h);c.addScaledVector(l[2],1.023328*a);c.addScaledVector(l[3],1.023328*e);c.addScaledVector(l[4],.858086*e*h);c.addScaledVector(l[5],.858086*h*a);c.addScaledVector(l[6],.743125*a*a-.247708);c.addScaledVector(l[7],.858086*e*a);c.addScaledVector(l[8],.429043*(e*e-h*h));return c}add(a){for(let c=0;9>c;c++)this.coefficients[c].add(a.coefficients[c]);return this}addScaledSH(a,c){for(let e=0;9>e;e++)this.coefficients[e].addScaledVector(a.coefficients[e],c);return this}scale(a){for(let c=0;9>c;c++)this.coefficients[c].multiplyScalar(a);
return this}lerp(a,c){for(let e=0;9>e;e++)this.coefficients[e].lerp(a.coefficients[e],c);return this}equals(a){for(let c=0;9>c;c++)if(!this.coefficients[c].equals(a.coefficients[c]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(a,c=0){const e=this.coefficients;for(let h=0;9>h;h++)e[h].fromArray(a,c+3*h);return this}toArray(a=[],c=0){const e=this.coefficients;for(let h=0;9>h;h++)e[h].toArray(a,c+3*h);return a}static getBasisAt(a,
c){const e=a.x,h=a.y;a=a.z;c[0]=.282095;c[1]=.488603*h;c[2]=.488603*a;c[3]=.488603*e;c[4]=1.092548*e*h;c[5]=1.092548*h*a;c[6]=.315392*(3*a*a-1);c[7]=1.092548*e*a;c[8]=.546274*(e*e-h*h)}}class pl extends Oe{constructor(a=new qn,c=1){super(void 0,c);this.isLightProbe=!0;this.sh=a}copy(a){super.copy(a);this.sh.copy(a.sh);return this}fromJSON(a){this.intensity=a.intensity;this.sh.fromArray(a.sh);return this}toJSON(a){a=super.toJSON(a);a.object.sh=this.sh.toArray();return a}}class ck extends Ye{constructor(a){super(a);
this.textures={}}load(a,c,e,h){const l=this,p=new Mh(l.manager);p.setPath(l.path);p.setRequestHeader(l.requestHeader);p.setWithCredentials(l.withCredentials);p.load(a,function(w){try{c(l.parse(JSON.parse(w)))}catch(x){h?h(x):console.error(x),l.manager.itemError(a)}},e,h)}parse(a){function c(p){void 0===e[p]&&console.warn("THREE.MaterialLoader: Undefined texture",p);return e[p]}const e=this.textures,h=this.createMaterialFromType(a.type);void 0!==a.uuid&&(h.uuid=a.uuid);void 0!==a.name&&(h.name=a.name);
void 0!==a.color&&void 0!==h.color&&h.color.setHex(a.color);void 0!==a.roughness&&(h.roughness=a.roughness);void 0!==a.metalness&&(h.metalness=a.metalness);void 0!==a.sheen&&(h.sheen=a.sheen);void 0!==a.sheenColor&&(h.sheenColor=(new ia).setHex(a.sheenColor));void 0!==a.sheenRoughness&&(h.sheenRoughness=a.sheenRoughness);void 0!==a.emissive&&void 0!==h.emissive&&h.emissive.setHex(a.emissive);void 0!==a.specular&&void 0!==h.specular&&h.specular.setHex(a.specular);void 0!==a.specularIntensity&&(h.specularIntensity=
a.specularIntensity);void 0!==a.specularColor&&void 0!==h.specularColor&&h.specularColor.setHex(a.specularColor);void 0!==a.shininess&&(h.shininess=a.shininess);void 0!==a.clearcoat&&(h.clearcoat=a.clearcoat);void 0!==a.clearcoatRoughness&&(h.clearcoatRoughness=a.clearcoatRoughness);void 0!==a.dispersion&&(h.dispersion=a.dispersion);void 0!==a.iridescence&&(h.iridescence=a.iridescence);void 0!==a.iridescenceIOR&&(h.iridescenceIOR=a.iridescenceIOR);void 0!==a.iridescenceThicknessRange&&(h.iridescenceThicknessRange=
a.iridescenceThicknessRange);void 0!==a.transmission&&(h.transmission=a.transmission);void 0!==a.thickness&&(h.thickness=a.thickness);void 0!==a.attenuationDistance&&(h.attenuationDistance=a.attenuationDistance);void 0!==a.attenuationColor&&void 0!==h.attenuationColor&&h.attenuationColor.setHex(a.attenuationColor);void 0!==a.anisotropy&&(h.anisotropy=a.anisotropy);void 0!==a.anisotropyRotation&&(h.anisotropyRotation=a.anisotropyRotation);void 0!==a.fog&&(h.fog=a.fog);void 0!==a.flatShading&&(h.flatShading=
a.flatShading);void 0!==a.blending&&(h.blending=a.blending);void 0!==a.combine&&(h.combine=a.combine);void 0!==a.side&&(h.side=a.side);void 0!==a.shadowSide&&(h.shadowSide=a.shadowSide);void 0!==a.opacity&&(h.opacity=a.opacity);void 0!==a.transparent&&(h.transparent=a.transparent);void 0!==a.alphaTest&&(h.alphaTest=a.alphaTest);void 0!==a.alphaHash&&(h.alphaHash=a.alphaHash);void 0!==a.depthFunc&&(h.depthFunc=a.depthFunc);void 0!==a.depthTest&&(h.depthTest=a.depthTest);void 0!==a.depthWrite&&(h.depthWrite=
a.depthWrite);void 0!==a.colorWrite&&(h.colorWrite=a.colorWrite);void 0!==a.blendSrc&&(h.blendSrc=a.blendSrc);void 0!==a.blendDst&&(h.blendDst=a.blendDst);void 0!==a.blendEquation&&(h.blendEquation=a.blendEquation);void 0!==a.blendSrcAlpha&&(h.blendSrcAlpha=a.blendSrcAlpha);void 0!==a.blendDstAlpha&&(h.blendDstAlpha=a.blendDstAlpha);void 0!==a.blendEquationAlpha&&(h.blendEquationAlpha=a.blendEquationAlpha);void 0!==a.blendColor&&void 0!==h.blendColor&&h.blendColor.setHex(a.blendColor);void 0!==a.blendAlpha&&
(h.blendAlpha=a.blendAlpha);void 0!==a.stencilWriteMask&&(h.stencilWriteMask=a.stencilWriteMask);void 0!==a.stencilFunc&&(h.stencilFunc=a.stencilFunc);void 0!==a.stencilRef&&(h.stencilRef=a.stencilRef);void 0!==a.stencilFuncMask&&(h.stencilFuncMask=a.stencilFuncMask);void 0!==a.stencilFail&&(h.stencilFail=a.stencilFail);void 0!==a.stencilZFail&&(h.stencilZFail=a.stencilZFail);void 0!==a.stencilZPass&&(h.stencilZPass=a.stencilZPass);void 0!==a.stencilWrite&&(h.stencilWrite=a.stencilWrite);void 0!==
a.wireframe&&(h.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(h.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(h.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(h.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(h.rotation=a.rotation);void 0!==a.linewidth&&(h.linewidth=a.linewidth);void 0!==a.dashSize&&(h.dashSize=a.dashSize);void 0!==a.gapSize&&(h.gapSize=a.gapSize);void 0!==a.scale&&(h.scale=a.scale);void 0!==a.polygonOffset&&(h.polygonOffset=
a.polygonOffset);void 0!==a.polygonOffsetFactor&&(h.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(h.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.dithering&&(h.dithering=a.dithering);void 0!==a.alphaToCoverage&&(h.alphaToCoverage=a.alphaToCoverage);void 0!==a.premultipliedAlpha&&(h.premultipliedAlpha=a.premultipliedAlpha);void 0!==a.forceSinglePass&&(h.forceSinglePass=a.forceSinglePass);void 0!==a.visible&&(h.visible=a.visible);void 0!==a.toneMapped&&(h.toneMapped=
a.toneMapped);void 0!==a.userData&&(h.userData=a.userData);void 0!==a.vertexColors&&(h.vertexColors="number"===typeof a.vertexColors?0<a.vertexColors?!0:!1:a.vertexColors);if(void 0!==a.uniforms)for(var l in a.uniforms){const p=a.uniforms[l];h.uniforms[l]={};switch(p.type){case "t":h.uniforms[l].value=c(p.value);break;case "c":h.uniforms[l].value=(new ia).setHex(p.value);break;case "v2":h.uniforms[l].value=(new Lb).fromArray(p.value);break;case "v3":h.uniforms[l].value=(new Da).fromArray(p.value);
break;case "v4":h.uniforms[l].value=(new yd).fromArray(p.value);break;case "m3":h.uniforms[l].value=(new nd).fromArray(p.value);break;case "m4":h.uniforms[l].value=(new Wc).fromArray(p.value);break;default:h.uniforms[l].value=p.value}}void 0!==a.defines&&(h.defines=a.defines);void 0!==a.vertexShader&&(h.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(h.fragmentShader=a.fragmentShader);void 0!==a.glslVersion&&(h.glslVersion=a.glslVersion);if(void 0!==a.extensions)for(const p in a.extensions)h.extensions[p]=
a.extensions[p];void 0!==a.lights&&(h.lights=a.lights);void 0!==a.clipping&&(h.clipping=a.clipping);void 0!==a.size&&(h.size=a.size);void 0!==a.sizeAttenuation&&(h.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(h.map=c(a.map));void 0!==a.matcap&&(h.matcap=c(a.matcap));void 0!==a.alphaMap&&(h.alphaMap=c(a.alphaMap));void 0!==a.bumpMap&&(h.bumpMap=c(a.bumpMap));void 0!==a.bumpScale&&(h.bumpScale=a.bumpScale);void 0!==a.normalMap&&(h.normalMap=c(a.normalMap));void 0!==a.normalMapType&&(h.normalMapType=
a.normalMapType);void 0!==a.normalScale&&(l=a.normalScale,!1===Array.isArray(l)&&(l=[l,l]),h.normalScale=(new Lb).fromArray(l));void 0!==a.displacementMap&&(h.displacementMap=c(a.displacementMap));void 0!==a.displacementScale&&(h.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(h.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(h.roughnessMap=c(a.roughnessMap));void 0!==a.metalnessMap&&(h.metalnessMap=c(a.metalnessMap));void 0!==a.emissiveMap&&(h.emissiveMap=c(a.emissiveMap));
void 0!==a.emissiveIntensity&&(h.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(h.specularMap=c(a.specularMap));void 0!==a.specularIntensityMap&&(h.specularIntensityMap=c(a.specularIntensityMap));void 0!==a.specularColorMap&&(h.specularColorMap=c(a.specularColorMap));void 0!==a.envMap&&(h.envMap=c(a.envMap));void 0!==a.envMapRotation&&h.envMapRotation.fromArray(a.envMapRotation);void 0!==a.envMapIntensity&&(h.envMapIntensity=a.envMapIntensity);void 0!==a.reflectivity&&(h.reflectivity=
a.reflectivity);void 0!==a.refractionRatio&&(h.refractionRatio=a.refractionRatio);void 0!==a.lightMap&&(h.lightMap=c(a.lightMap));void 0!==a.lightMapIntensity&&(h.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(h.aoMap=c(a.aoMap));void 0!==a.aoMapIntensity&&(h.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(h.gradientMap=c(a.gradientMap));void 0!==a.clearcoatMap&&(h.clearcoatMap=c(a.clearcoatMap));void 0!==a.clearcoatRoughnessMap&&(h.clearcoatRoughnessMap=c(a.clearcoatRoughnessMap));
void 0!==a.clearcoatNormalMap&&(h.clearcoatNormalMap=c(a.clearcoatNormalMap));void 0!==a.clearcoatNormalScale&&(h.clearcoatNormalScale=(new Lb).fromArray(a.clearcoatNormalScale));void 0!==a.iridescenceMap&&(h.iridescenceMap=c(a.iridescenceMap));void 0!==a.iridescenceThicknessMap&&(h.iridescenceThicknessMap=c(a.iridescenceThicknessMap));void 0!==a.transmissionMap&&(h.transmissionMap=c(a.transmissionMap));void 0!==a.thicknessMap&&(h.thicknessMap=c(a.thicknessMap));void 0!==a.anisotropyMap&&(h.anisotropyMap=
c(a.anisotropyMap));void 0!==a.sheenColorMap&&(h.sheenColorMap=c(a.sheenColorMap));void 0!==a.sheenRoughnessMap&&(h.sheenRoughnessMap=c(a.sheenRoughnessMap));return h}setTextures(a){this.textures=a;return this}createMaterialFromType(a){return ck.createMaterialFromType(a)}static createMaterialFromType(a){return new {ShadowMaterial:$g,SpriteMaterial:$i,RawShaderMaterial:zk,ShaderMaterial:ih,PointsMaterial:wl,MeshPhysicalMaterial:hl,MeshStandardMaterial:ah,MeshPhongMaterial:Em,MeshToonMaterial:il,MeshNormalMaterial:Ve,
MeshLambertMaterial:km,MeshDepthMaterial:Jb,MeshDistanceMaterial:$b,MeshBasicMaterial:ab,MeshMatcapMaterial:jm,LineDashedMaterial:Kh,LineBasicMaterial:jh,Material:Sa}[a]}}class xg{static decodeText(a){console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead.");if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);let c="";for(let e=0,h=a.length;e<h;e++)c+=String.fromCharCode(a[e]);try{return decodeURIComponent(escape(c))}catch(e){return c}}static extractUrlBase(a){const c=
a.lastIndexOf("/");return-1===c?"./":a.slice(0,c+1)}static resolveURL(a,c){if("string"!==typeof a||""===a)return"";/^https?:\/\//i.test(c)&&/^\//.test(a)&&(c=c.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));return/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:c+a}}class Fm extends Xc{constructor(){super();this.isInstancedBufferGeometry=!0;this.type="InstancedBufferGeometry";this.instanceCount=Infinity}copy(a){super.copy(a);this.instanceCount=a.instanceCount;return this}toJSON(){const a=
super.toJSON();a.instanceCount=this.instanceCount;a.isInstancedBufferGeometry=!0;return a}}class Lc extends Ye{constructor(a){super(a)}load(a,c,e,h){const l=this,p=new Mh(l.manager);p.setPath(l.path);p.setRequestHeader(l.requestHeader);p.setWithCredentials(l.withCredentials);p.load(a,function(w){try{c(l.parse(JSON.parse(w)))}catch(x){h?h(x):console.error(x),l.manager.itemError(a)}},e,h)}parse(a){function c(I,L){if(void 0!==e[L])return e[L];const Y=I.interleavedBuffers[L];var P=Y.buffer;void 0!==h[P]?
P=h[P]:(I=(new Uint32Array(I.arrayBuffers[P])).buffer,P=h[P]=I);P=new Xe[Y.type](P);P=new oe(P,Y.stride);P.uuid=Y.uuid;return e[L]=P}const e={},h={},l=a.isInstancedBufferGeometry?new Fm:new Xc;var p=a.data.index;void 0!==p&&(p=new Xe[p.type](p.array),l.setIndex(new mc(p,1)));p=a.data.attributes;for(var w in p){var x=p[w],y=void 0;x.isInterleavedBufferAttribute?(y=c(a.data,x.data),y=new pf(y,x.itemSize,x.offset,x.normalized)):(y=new Xe[x.type](x.array),y=new (x.isInstancedBufferAttribute?Fh:mc)(y,
x.itemSize,x.normalized));void 0!==x.name&&(y.name=x.name);void 0!==x.usage&&y.setUsage(x.usage);l.setAttribute(w,y)}if(w=a.data.morphAttributes)for(var D in w){p=w[D];x=[];for(let I=0,L=p.length;I<L;I++){y=p[I];var H=void 0;y.isInterleavedBufferAttribute?(H=c(a.data,y.data),H=new pf(H,y.itemSize,y.offset,y.normalized)):(H=new Xe[y.type](y.array),H=new mc(H,y.itemSize,y.normalized));void 0!==y.name&&(H.name=y.name);x.push(H)}l.morphAttributes[D]=x}a.data.morphTargetsRelative&&(l.morphTargetsRelative=
!0);D=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==D)for(let I=0,L=D.length;I!==L;++I)w=D[I],l.addGroup(w.start,w.count,w.materialIndex);D=a.data.boundingSphere;void 0!==D&&(w=new Da,void 0!==D.center&&w.fromArray(D.center),l.boundingSphere=new $e(w,D.radius));a.name&&(l.name=a.name);a.userData&&(l.userData=a.userData);return l}}class Ym extends Ye{constructor(a){super(a)}load(a,c,e,h){const l=this;var p=""===this.path?xg.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||
p;p=new Mh(this.manager);p.setPath(this.path);p.setRequestHeader(this.requestHeader);p.setWithCredentials(this.withCredentials);p.load(a,function(w){let x=null;try{x=JSON.parse(w)}catch(y){void 0!==h&&h(y);console.error("THREE:ObjectLoader: Can't parse "+a+".",y.message);return}w=x.metadata;void 0===w||void 0===w.type||"geometry"===w.type.toLowerCase()?(void 0!==h&&h(Error("THREE.ObjectLoader: Can't load "+a)),console.error("THREE.ObjectLoader: Can't load "+a)):l.parse(x,c)},e,h)}async loadAsync(a,
c){var e=""===this.path?xg.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||e;e=new Mh(this.manager);e.setPath(this.path);e.setRequestHeader(this.requestHeader);e.setWithCredentials(this.withCredentials);c=await e.loadAsync(a,c);c=JSON.parse(c);e=c.metadata;if(void 0===e||void 0===e.type||"geometry"===e.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+a);return await this.parseAsync(c)}parse(a,c){const e=this.parseAnimations(a.animations);var h=this.parseShapes(a.shapes);
const l=this.parseGeometries(a.geometries,h);h=this.parseImages(a.images,function(){void 0!==c&&c(x)});const p=this.parseTextures(a.textures,h),w=this.parseMaterials(a.materials,p),x=this.parseObject(a.object,l,w,p,e);a=this.parseSkeletons(a.skeletons,x);this.bindSkeletons(x,a);this.bindLightTargets(x);if(void 0!==c){a=!1;for(const y in h)if(h[y].data instanceof HTMLImageElement){a=!0;break}!1===a&&c(x)}return x}async parseAsync(a){var c=this.parseAnimations(a.animations),e=this.parseShapes(a.shapes);
e=this.parseGeometries(a.geometries,e);var h=await this.parseImagesAsync(a.images);h=this.parseTextures(a.textures,h);const l=this.parseMaterials(a.materials,h);c=this.parseObject(a.object,e,l,h,c);a=this.parseSkeletons(a.skeletons,c);this.bindSkeletons(c,a);this.bindLightTargets(c);return c}parseShapes(a){const c={};if(void 0!==a)for(let e=0,h=a.length;e<h;e++){const l=(new Ej).fromJSON(a[e]);c[l.uuid]=l}return c}parseSkeletons(a,c){const e={},h={};c.traverse(function(l){l.isBone&&(h[l.uuid]=l)});
if(void 0!==a)for(let l=0,p=a.length;l<p;l++)c=(new nk).fromJSON(a[l],h),e[c.uuid]=c;return e}parseGeometries(a,c){const e={};if(void 0!==a){const h=new Lc;for(let l=0,p=a.length;l<p;l++){let w;const x=a[l];switch(x.type){case "BufferGeometry":case "InstancedBufferGeometry":w=h.parse(x);break;default:x.type in Hg?w=Hg[x.type].fromJSON(x,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${x.type}"`)}w.uuid=x.uuid;void 0!==x.name&&(w.name=x.name);void 0!==x.userData&&(w.userData=x.userData);
e[x.uuid]=w}}return e}parseMaterials(a,c){const e={},h={};if(void 0!==a){const l=new ck;l.setTextures(c);for(let p=0,w=a.length;p<w;p++)c=a[p],void 0===e[c.uuid]&&(e[c.uuid]=l.parse(c)),h[c.uuid]=e[c.uuid]}return h}parseAnimations(a){const c={};if(void 0!==a)for(let e=0;e<a.length;e++){const h=ch.parse(a[e]);c[h.uuid]=h}return c}parseImages(a,c){function e(y){l.manager.itemStart(y);return w.load(y,function(){l.manager.itemEnd(y)},void 0,function(){l.manager.itemError(y);l.manager.itemEnd(y)})}function h(y){return"string"===
typeof y?(y=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:l.resourcePath+y,e(y)):y.data?{data:new Xe[y.type](y.data),width:y.width,height:y.height}:null}const l=this,p={};let w;if(void 0!==a&&0<a.length){c=new Lg(c);w=new Yj(c);w.setCrossOrigin(this.crossOrigin);for(let y=0,D=a.length;y<D;y++){c=a[y];var x=c.url;if(Array.isArray(x)){const H=[];for(let I=0,L=x.length;I<L;I++){const Y=h(x[I]);null!==Y&&(Y instanceof HTMLImageElement?H.push(Y):H.push(new jg(Y.data,Y.width,Y.height)))}p[c.uuid]=new sf(H)}else x=
h(c.url),p[c.uuid]=new sf(x)}}return p}async parseImagesAsync(a){async function c(w){return"string"===typeof w?(w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:e.resourcePath+w,await l.loadAsync(w)):w.data?{data:new Xe[w.type](w.data),width:w.width,height:w.height}:null}const e=this,h={};let l;if(void 0!==a&&0<a.length){l=new Yj(this.manager);l.setCrossOrigin(this.crossOrigin);for(let w=0,x=a.length;w<x;w++){const y=a[w];var p=y.url;if(Array.isArray(p)){const D=[];for(let H=0,I=p.length;H<I;H++){const L=
await c(p[H]);null!==L&&(L instanceof HTMLImageElement?D.push(L):D.push(new jg(L.data,L.width,L.height)))}h[y.uuid]=new sf(D)}else p=await c(y.url),h[y.uuid]=new sf(p)}}return h}parseTextures(a,c){function e(l,p){if("number"===typeof l)return l;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",l);return p[l]}const h={};if(void 0!==a)for(let l=0,p=a.length;l<p;l++){const w=a[l];void 0===w.image&&console.warn('THREE.ObjectLoader: No "image" specified for',w.uuid);void 0===
c[w.image]&&console.warn("THREE.ObjectLoader: Undefined image",w.image);const x=c[w.image],y=x.data;let D;Array.isArray(y)?(D=new Ck,6===y.length&&(D.needsUpdate=!0)):(D=y&&y.data?new jg:new Ld,y&&(D.needsUpdate=!0));D.source=x;D.uuid=w.uuid;void 0!==w.name&&(D.name=w.name);void 0!==w.mapping&&(D.mapping=e(w.mapping,Tg));void 0!==w.channel&&(D.channel=w.channel);void 0!==w.offset&&D.offset.fromArray(w.offset);void 0!==w.repeat&&D.repeat.fromArray(w.repeat);void 0!==w.center&&D.center.fromArray(w.center);
void 0!==w.rotation&&(D.rotation=w.rotation);void 0!==w.wrap&&(D.wrapS=e(w.wrap[0],Qi),D.wrapT=e(w.wrap[1],Qi));void 0!==w.format&&(D.format=w.format);void 0!==w.internalFormat&&(D.internalFormat=w.internalFormat);void 0!==w.type&&(D.type=w.type);void 0!==w.colorSpace&&(D.colorSpace=w.colorSpace);void 0!==w.minFilter&&(D.minFilter=e(w.minFilter,tn));void 0!==w.magFilter&&(D.magFilter=e(w.magFilter,tn));void 0!==w.anisotropy&&(D.anisotropy=w.anisotropy);void 0!==w.flipY&&(D.flipY=w.flipY);void 0!==
w.generateMipmaps&&(D.generateMipmaps=w.generateMipmaps);void 0!==w.premultiplyAlpha&&(D.premultiplyAlpha=w.premultiplyAlpha);void 0!==w.unpackAlignment&&(D.unpackAlignment=w.unpackAlignment);void 0!==w.compareFunction&&(D.compareFunction=w.compareFunction);void 0!==w.userData&&(D.userData=w.userData);h[w.uuid]=D}return h}parseObject(a,c,e,h,l){function p(I){void 0===c[I]&&console.warn("THREE.ObjectLoader: Undefined geometry",I);return c[I]}function w(I){if(void 0!==I){if(Array.isArray(I)){const L=
[];for(let Y=0,P=I.length;Y<P;Y++){const Z=I[Y];void 0===e[Z]&&console.warn("THREE.ObjectLoader: Undefined material",Z);L.push(e[Z])}return L}void 0===e[I]&&console.warn("THREE.ObjectLoader: Undefined material",I);return e[I]}}function x(I){void 0===h[I]&&console.warn("THREE.ObjectLoader: Undefined texture",I);return h[I]}switch(a.type){case "Scene":var y=new ie;void 0!==a.background&&(Number.isInteger(a.background)?y.background=new ia(a.background):y.background=x(a.background));void 0!==a.environment&&
(y.environment=x(a.environment));void 0!==a.fog&&("Fog"===a.fog.type?y.fog=new we(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(y.fog=new ff(a.fog.color,a.fog.density)),""!==a.fog.name&&(y.fog.name=a.fog.name));void 0!==a.backgroundBlurriness&&(y.backgroundBlurriness=a.backgroundBlurriness);void 0!==a.backgroundIntensity&&(y.backgroundIntensity=a.backgroundIntensity);void 0!==a.backgroundRotation&&y.backgroundRotation.fromArray(a.backgroundRotation);void 0!==a.environmentIntensity&&(y.environmentIntensity=
a.environmentIntensity);void 0!==a.environmentRotation&&y.environmentRotation.fromArray(a.environmentRotation);break;case "PerspectiveCamera":y=new Sf(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(y.focus=a.focus);void 0!==a.zoom&&(y.zoom=a.zoom);void 0!==a.filmGauge&&(y.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(y.filmOffset=a.filmOffset);void 0!==a.view&&(y.view=Object.assign({},a.view));break;case "OrthographicCamera":y=new Th(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&
(y.zoom=a.zoom);void 0!==a.view&&(y.view=Object.assign({},a.view));break;case "AmbientLight":y=new rn(a.color,a.intensity);break;case "DirectionalLight":y=new pm(a.color,a.intensity);y.target=a.target||"";break;case "PointLight":y=new pn(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":y=new Xm(a.color,a.intensity,a.width,a.height);break;case "SpotLight":y=new nn(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);y.target=a.target||"";break;case "HemisphereLight":y=new cg(a.color,
a.groundColor,a.intensity);break;case "LightProbe":y=(new pl).fromJSON(a);break;case "SkinnedMesh":var D=p(a.geometry);y=w(a.material);y=new Cl(D,y);void 0!==a.bindMode&&(y.bindMode=a.bindMode);void 0!==a.bindMatrix&&y.bindMatrix.fromArray(a.bindMatrix);void 0!==a.skeleton&&(y.skeleton=a.skeleton);break;case "Mesh":D=p(a.geometry);y=w(a.material);y=new nf(D,y);break;case "InstancedMesh":D=p(a.geometry);y=w(a.material);var H=a.instanceMatrix;const I=a.instanceColor;y=new ik(D,y,a.count);y.instanceMatrix=
new Fh(new Float32Array(H.array),16);void 0!==I&&(y.instanceColor=new Fh(new Float32Array(I.array),I.itemSize));break;case "BatchedMesh":D=p(a.geometry);y=w(a.material);y=new Tm(a.maxInstanceCount,a.maxVertexCount,a.maxIndexCount,y);y.geometry=D;y.perObjectFrustumCulled=a.perObjectFrustumCulled;y.sortObjects=a.sortObjects;y._drawRanges=a.drawRanges;y._reservedRanges=a.reservedRanges;y._visibility=a.visibility;y._active=a.active;y._bounds=a.bounds.map(L=>{const Y=new fe;Y.min.fromArray(L.boxMin);Y.max.fromArray(L.boxMax);
const P=new $e;P.radius=L.sphereRadius;P.center.fromArray(L.sphereCenter);return{boxInitialized:L.boxInitialized,box:Y,sphereInitialized:L.sphereInitialized,sphere:P}});y._maxInstanceCount=a.maxInstanceCount;y._maxVertexCount=a.maxVertexCount;y._maxIndexCount=a.maxIndexCount;y._geometryInitialized=a.geometryInitialized;y._geometryCount=a.geometryCount;y._matricesTexture=x(a.matricesTexture.uuid);void 0!==a.colorsTexture&&(y._colorsTexture=x(a.colorsTexture.uuid));break;case "LOD":y=new lg;break;case "Line":y=
new Vj(p(a.geometry),w(a.material));break;case "LineLoop":y=new Zc(p(a.geometry),w(a.material));break;case "LineSegments":y=new Bc(p(a.geometry),w(a.material));break;case "PointCloud":case "Points":y=new Um(p(a.geometry),w(a.material));break;case "Sprite":y=new rk(w(a.material));break;case "Group":y=new md;break;case "Bone":y=new pi;break;default:y=new Nd}y.uuid=a.uuid;void 0!==a.name&&(y.name=a.name);void 0!==a.matrix?(y.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(y.matrixAutoUpdate=
a.matrixAutoUpdate),y.matrixAutoUpdate&&y.matrix.decompose(y.position,y.quaternion,y.scale)):(void 0!==a.position&&y.position.fromArray(a.position),void 0!==a.rotation&&y.rotation.fromArray(a.rotation),void 0!==a.quaternion&&y.quaternion.fromArray(a.quaternion),void 0!==a.scale&&y.scale.fromArray(a.scale));void 0!==a.up&&y.up.fromArray(a.up);void 0!==a.castShadow&&(y.castShadow=a.castShadow);void 0!==a.receiveShadow&&(y.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.intensity&&(y.shadow.intensity=
a.shadow.intensity),void 0!==a.shadow.bias&&(y.shadow.bias=a.shadow.bias),void 0!==a.shadow.normalBias&&(y.shadow.normalBias=a.shadow.normalBias),void 0!==a.shadow.radius&&(y.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&y.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(y.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(y.visible=a.visible);void 0!==a.frustumCulled&&(y.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(y.renderOrder=a.renderOrder);
void 0!==a.userData&&(y.userData=a.userData);void 0!==a.layers&&(y.layers.mask=a.layers);if(void 0!==a.children)for(D=a.children,H=0;H<D.length;H++)y.add(this.parseObject(D[H],c,e,h,l));if(void 0!==a.animations)for(D=a.animations,H=0;H<D.length;H++)y.animations.push(l[D[H]]);if("LOD"===a.type)for(void 0!==a.autoUpdate&&(y.autoUpdate=a.autoUpdate),a=a.levels,l=0;l<a.length;l++)D=a[l],H=y.getObjectByProperty("uuid",D.object),void 0!==H&&y.addLevel(H,D.distance,D.hysteresis);return y}bindSkeletons(a,
c){0!==Object.keys(c).length&&a.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const h=c[e.skeleton];void 0===h?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(h,e.bindMatrix)}})}bindLightTargets(a){a.traverse(function(c){if(c.isDirectionalLight||c.isSpotLight){const e=a.getObjectByProperty("uuid",c.target);c.target=void 0!==e?e:new Nd}})}}const Tg={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,
EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306},Qi={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},tn={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};class Im extends Ye{constructor(a){super(a);this.isImageBitmapLoader=!0;"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===
typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.options={premultiplyAlpha:"none"}}setOptions(a){this.options=a;return this}load(a,c,e,h){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const l=this,p=Zf.get(a);if(void 0!==p){l.manager.itemStart(a);if(p.then){p.then(w=>{c&&c(w);l.manager.itemEnd(a)}).catch(w=>{h&&h(w)});return}setTimeout(function(){c&&c(p);l.manager.itemEnd(a)},0);return p}e={};e.credentials="anonymous"===this.crossOrigin?
"same-origin":"include";e.headers=this.requestHeader;e=fetch(a,e).then(function(w){return w.blob()}).then(function(w){return createImageBitmap(w,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(w){Zf.add(a,w);c&&c(w);l.manager.itemEnd(a);return w}).catch(function(w){h&&h(w);Zf.remove(a);l.manager.itemError(a);l.manager.itemEnd(a)});Zf.add(a,e);l.manager.itemStart(a)}}let Ql;class hg{static getContext(){void 0===Ql&&(Ql=new (window.AudioContext||window.webkitAudioContext));return Ql}static setContext(a){Ql=
a}}class $d extends Ye{constructor(a){super(a)}load(a,c,e,h){function l(x){h?h(x):console.error(x);p.manager.itemError(a)}const p=this,w=new Mh(this.manager);w.setResponseType("arraybuffer");w.setPath(this.path);w.setRequestHeader(this.requestHeader);w.setWithCredentials(this.withCredentials);w.load(a,function(x){try{const y=x.slice(0);hg.getContext().decodeAudioData(y,function(D){c(D)}).catch(l)}catch(y){l(y)}},e,h)}}const Pf=new Wc,wf=new Wc,df=new Wc;class Rh{constructor(){this.type="StereoCamera";
this.aspect=1;this.eyeSep=.064;this.cameraL=new Sf;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new Sf;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(a){const c=this._cache;if(c.focus!==a.focus||c.fov!==a.fov||c.aspect!==a.aspect*this.aspect||c.near!==a.near||c.far!==a.far||c.zoom!==a.zoom||c.eyeSep!==this.eyeSep){c.focus=a.focus;c.fov=a.fov;c.aspect=a.aspect*
this.aspect;c.near=a.near;c.far=a.far;c.zoom=a.zoom;c.eyeSep=this.eyeSep;df.copy(a.projectionMatrix);var e=c.eyeSep/2;const h=e*c.near/c.focus,l=c.near*Math.tan(Jg*c.fov*.5)/c.zoom;let p;wf.elements[12]=-e;Pf.elements[12]=e;e=-l*c.aspect+h;p=l*c.aspect+h;df.elements[0]=2*c.near/(p-e);df.elements[8]=(p+e)/(p-e);this.cameraL.projectionMatrix.copy(df);e=-l*c.aspect-h;p=l*c.aspect-h;df.elements[0]=2*c.near/(p-e);df.elements[8]=(p+e)/(p-e);this.cameraR.projectionMatrix.copy(df)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(wf);
this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(Pf)}}class ol{constructor(a=!0){this.autoStart=a;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}start(){this.oldTime=this.startTime=performance.now();this.elapsedTime=0;this.running=!0}stop(){this.getElapsedTime();this.autoStart=this.running=!1}getElapsedTime(){this.getDelta();return this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=performance.now();a=(c-this.oldTime)/
1E3;this.oldTime=c;this.elapsedTime+=a}return a}}const bf=new Da,Ol=new Ze,kl=new Da,Gj=new Da;class $m extends Nd{constructor(){super();this.type="AudioListener";this.context=hg.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0;this._clock=new ol}getInput(){return this.gain}removeFilter(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),
this.filter=null);return this}getFilter(){return this.filter}setFilter(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}updateMatrixWorld(a){super.updateMatrixWorld(a);
a=this.context.listener;const c=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(bf,Ol,kl);Gj.set(0,0,-1).applyQuaternion(Ol);if(a.positionX){const e=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(bf.x,e);a.positionY.linearRampToValueAtTime(bf.y,e);a.positionZ.linearRampToValueAtTime(bf.z,e);a.forwardX.linearRampToValueAtTime(Gj.x,e);a.forwardY.linearRampToValueAtTime(Gj.y,e);a.forwardZ.linearRampToValueAtTime(Gj.z,e);a.upX.linearRampToValueAtTime(c.x,
e);a.upY.linearRampToValueAtTime(c.y,e);a.upZ.linearRampToValueAtTime(c.z,e)}else a.setPosition(bf.x,bf.y,bf.z),a.setOrientation(Gj.x,Gj.y,Gj.z,c.x,c.y,c.z)}}class Pl extends Nd{constructor(a){super();this.type="Audio";this.listener=a;this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.detune=0;this.loop=!1;this.offset=this.loopEnd=this.loopStart=0;this.duration=void 0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=
!0;this.source=null;this.sourceType="empty";this._progress=this._startedAt=0;this._connected=!1;this.filters=[]}getOutput(){return this.gain}setNodeSource(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this}setMediaElementSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this}setMediaStreamSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaStreamNode";this.source=
this.context.createMediaStreamSource(a);this.connect();return this}setBuffer(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this}play(a=0){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+a,a=this.context.createBufferSource(),a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,
a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||
this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(a=0){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+a),this.source.onended=null),this.isPlaying=!1,this}connect(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(let a=1,c=this.filters.length;a<c;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-
1].connect(this.getOutput())}else this.source.connect(this.getOutput());this._connected=!0;return this}disconnect(){if(!1!==this._connected){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(let a=1,c=this.filters.length;a<c;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());this._connected=!1;return this}}getFilters(){return this.filters}setFilters(a){a||(a=[]);!0===this._connected?
(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice();return this}setDetune(a){this.detune=a;!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01);return this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(a){return this.setFilters(a?[a]:[])}setPlaybackRate(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=
a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(a){this.loopStart=
a;return this}setLoopEnd(a){this.loopEnd=a;return this}getVolume(){return this.gain.gain.value}setVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}}const Jf=new Da,Ml=new Ze,ql=new Da,hh=new Da;class om extends Pl{constructor(a){super(a);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}connect(){super.connect();this.panner.connect(this.gain)}disconnect(){super.disconnect();this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(a){this.panner.refDistance=
a;return this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(a){this.panner.rolloffFactor=a;return this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(a){this.panner.distanceModel=a;return this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(a){this.panner.maxDistance=a;return this}setDirectionalCone(a,c,e){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=c;this.panner.coneOuterGain=e;return this}updateMatrixWorld(a){super.updateMatrixWorld(a);
if(!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(Jf,Ml,ql),hh.set(0,0,1).applyQuaternion(Ml),a=this.panner,a.positionX){const c=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Jf.x,c);a.positionY.linearRampToValueAtTime(Jf.y,c);a.positionZ.linearRampToValueAtTime(Jf.z,c);a.orientationX.linearRampToValueAtTime(hh.x,c);a.orientationY.linearRampToValueAtTime(hh.y,c);a.orientationZ.linearRampToValueAtTime(hh.z,c)}else a.setPosition(Jf.x,
Jf.y,Jf.z),a.setOrientation(hh.x,hh.y,hh.z)}}class Wm{constructor(a,c=2048){this.analyser=a.context.createAnalyser();this.analyser.fftSize=c;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}getFrequencyData(){this.analyser.getByteFrequencyData(this.data);return this.data}getAverageFrequency(){let a=0;const c=this.getFrequencyData();for(let e=0;e<c.length;e++)a+=c[e];return a/c.length}}class Li{constructor(a,c,e){this.binding=a;this.valueSize=e;let h;switch(c){case "quaternion":a=
this._slerp;c=this._slerpAdditive;h=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*e);this._workIndex=5;break;case "string":case "bool":c=a=this._select;h=this._setAdditiveIdentityOther;this.buffer=Array(5*e);break;default:a=this._lerp,c=this._lerpAdditive,h=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*e)}this._mixBufferRegion=a;this._mixBufferRegionAdditive=c;this._setIdentity=h;this._origIndex=3;this._addIndex=4;this.referenceCount=this.useCount=this.cumulativeWeightAdditive=
this.cumulativeWeight=0}accumulate(a,c){const e=this.buffer,h=this.valueSize;a=a*h+h;var l=this.cumulativeWeight;if(0===l){for(l=0;l!==h;++l)e[a+l]=e[l];l=c}else l+=c,this._mixBufferRegion(e,a,0,c/l,h);this.cumulativeWeight=l}accumulateAdditive(a){const c=this.buffer,e=this.valueSize,h=e*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity();this._mixBufferRegionAdditive(c,h,0,a,e);this.cumulativeWeightAdditive+=a}apply(a){const c=this.valueSize,e=this.buffer;a=a*c+c;const h=this.cumulativeWeight,
l=this.cumulativeWeightAdditive,p=this.binding;this.cumulativeWeightAdditive=this.cumulativeWeight=0;1>h&&this._mixBufferRegion(e,a,c*this._origIndex,1-h,c);0<l&&this._mixBufferRegionAdditive(e,a,this._addIndex*c,1,c);for(let w=c,x=c+c;w!==x;++w)if(e[w]!==e[w+c]){p.setValue(e,a);break}}saveOriginalState(){const a=this.buffer,c=this.valueSize,e=c*this._origIndex;this.binding.getValue(a,e);for(let h=c,l=e;h!==l;++h)a[h]=a[e+h%c];this._setIdentity();this.cumulativeWeightAdditive=this.cumulativeWeight=
0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){var a=this._addIndex*this.valueSize;const c=a+this.valueSize;for(;a<c;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const a=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let e=0;e<this.valueSize;e++)this.buffer[c+e]=this.buffer[a+e]}_select(a,c,e,h,l){if(.5<=
h)for(h=0;h!==l;++h)a[c+h]=a[e+h]}_slerp(a,c,e,h){Ze.slerpFlat(a,c,a,c,a,e,h)}_slerpAdditive(a,c,e,h,l){l*=this._workIndex;Ze.multiplyQuaternionsFlat(a,l,a,c,a,e);Ze.slerpFlat(a,c,a,c,a,l,h)}_lerp(a,c,e,h,l){const p=1-h;for(let w=0;w!==l;++w){const x=c+w;a[x]=a[x]*p+a[e+w]*h}}_lerpAdditive(a,c,e,h,l){for(let p=0;p!==l;++p){const w=c+p;a[w]+=a[e+p]*h}}}const Km=RegExp("[\\[\\]\\.:\\/]","g"),Nk=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Lm=/(WCOD+)?/.source.replace("WCOD","[^\\[\\]:\\/]"),
sm=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Hm=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Gm=new RegExp("^"+Nk+Lm+sm+Hm+"$"),Kk=["material","materials","bones","map"];class un{constructor(a,c,e){e=e||ae.parseTrackName(c);this._targetGroup=a;this._bindings=a.subscribe_(c,e)}getValue(a,c){this.bind();const e=this._bindings[this._targetGroup.nCachedObjects_];void 0!==e&&e.getValue(a,c)}setValue(a,c){const e=this._bindings;for(let h=this._targetGroup.nCachedObjects_,
l=e.length;h!==l;++h)e[h].setValue(a,c)}bind(){const a=this._bindings;for(let c=this._targetGroup.nCachedObjects_,e=a.length;c!==e;++c)a[c].bind()}unbind(){const a=this._bindings;for(let c=this._targetGroup.nCachedObjects_,e=a.length;c!==e;++c)a[c].unbind()}}class ae{constructor(a,c,e){this.path=c;this.parsedPath=e||ae.parseTrackName(c);this.node=ae.findNode(a,this.parsedPath.nodeName);this.rootNode=a;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}static create(a,c,e){return a&&
a.isAnimationObjectGroup?new ae.Composite(a,c,e):new ae(a,c,e)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(Km,"")}static parseTrackName(a){var c=Gm.exec(a);if(null===c)throw Error("PropertyBinding: Cannot parse trackName: "+a);c={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]};const e=c.nodeName&&c.nodeName.lastIndexOf(".");if(void 0!==e&&-1!==e){const h=c.nodeName.substring(e+1);-1!==Kk.indexOf(h)&&(c.nodeName=c.nodeName.substring(0,e),c.objectName=
h)}if(null===c.propertyName||0===c.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return c}static findNode(a,c){if(void 0===c||""===c||"."===c||-1===c||c===a.name||c===a.uuid)return a;if(a.skeleton){const e=a.skeleton.getBoneByName(c);if(void 0!==e)return e}if(a.children){const e=function(h){for(let p=0;p<h.length;p++){var l=h[p];if(l.name===c||l.uuid===c||(l=e(l.children)))return l}return null};if(a=e(a.children))return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,
c){a[c]=this.targetObject[this.propertyName]}_getValue_array(a,c){const e=this.resolvedProperty;for(let h=0,l=e.length;h!==l;++h)a[c++]=e[h]}_getValue_arrayElement(a,c){a[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,c){this.resolvedProperty.toArray(a,c)}_setValue_direct(a,c){this.targetObject[this.propertyName]=a[c]}_setValue_direct_setNeedsUpdate(a,c){this.targetObject[this.propertyName]=a[c];this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,c){this.targetObject[this.propertyName]=
a[c];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,c){const e=this.resolvedProperty;for(let h=0,l=e.length;h!==l;++h)e[h]=a[c++]}_setValue_array_setNeedsUpdate(a,c){const e=this.resolvedProperty;for(let h=0,l=e.length;h!==l;++h)e[h]=a[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,c){const e=this.resolvedProperty;for(let h=0,l=e.length;h!==l;++h)e[h]=a[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,c){this.resolvedProperty[this.propertyIndex]=
a[c]}_setValue_arrayElement_setNeedsUpdate(a,c){this.resolvedProperty[this.propertyIndex]=a[c];this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,c){this.resolvedProperty[this.propertyIndex]=a[c];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,c){this.resolvedProperty.fromArray(a,c)}_setValue_fromArray_setNeedsUpdate(a,c){this.resolvedProperty.fromArray(a,c);this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,c){this.resolvedProperty.fromArray(a,
c);this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,c){this.bind();this.getValue(a,c)}_setValue_unbound(a,c){this.bind();this.setValue(a,c)}bind(){let a=this.node;var c=this.parsedPath,e=c.objectName;const h=c.propertyName;let l=c.propertyIndex;a||(this.node=a=ae.findNode(this.rootNode,c.nodeName));this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(e){var p=c.objectIndex;switch(e){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",
this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(e=0;e<a.length;e++)if(a[e].name===p){p=e;break}break;case "map":if("map"in a){a=a.map;break}if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",
this);return}if(!a.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}a=a.material.map;break;default:if(void 0===a[e]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[e]}if(void 0!==p){if(void 0===a[p]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[p]}}p=a[h];if(void 0===p)console.error("THREE.PropertyBinding: Trying to update property for track: "+
c.nodeName+"."+h+" but it wasn't found.",a);else{c=this.Versioning.None;this.targetObject=a;void 0!==a.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);e=this.BindingType.Direct;if(void 0!==l){if("morphTargetInfluences"===h){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
this);return}void 0!==a.morphTargetDictionary[l]&&(l=a.morphTargetDictionary[l])}e=this.BindingType.ArrayElement;this.resolvedProperty=p;this.propertyIndex=l}else void 0!==p.fromArray&&void 0!==p.toArray?(e=this.BindingType.HasFromToArray,this.resolvedProperty=p):Array.isArray(p)?(e=this.BindingType.EntireArray,this.resolvedProperty=p):this.propertyName=h;this.getValue=this.GetterByBindingType[e];this.setValue=this.SetterByBindingTypeAndVersioning[e][c]}}else console.warn("THREE.PropertyBinding: No target node found for track: "+
this.path+".")}unbind(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}}ae.Composite=un;ae.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ae.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ae.prototype.GetterByBindingType=[ae.prototype._getValue_direct,ae.prototype._getValue_array,ae.prototype._getValue_arrayElement,ae.prototype._getValue_toArray];ae.prototype.SetterByBindingTypeAndVersioning=[[ae.prototype._setValue_direct,
ae.prototype._setValue_direct_setNeedsUpdate,ae.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ae.prototype._setValue_array,ae.prototype._setValue_array_setNeedsUpdate,ae.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ae.prototype._setValue_arrayElement,ae.prototype._setValue_arrayElement_setNeedsUpdate,ae.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ae.prototype._setValue_fromArray,ae.prototype._setValue_fromArray_setNeedsUpdate,ae.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];
class Rm{constructor(){this.isAnimationObjectGroup=!0;this.uuid=Na();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;const a={};this._indicesByUUID=a;for(let e=0,h=arguments.length;e!==h;++e)a[arguments[e].uuid]=e;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const a=
this._objects,c=this._indicesByUUID,e=this._paths,h=this._parsedPaths,l=this._bindings,p=l.length;let w=void 0,x=a.length,y=this.nCachedObjects_;for(let I=0,L=arguments.length;I!==L;++I){const Y=arguments[I];var D=Y.uuid;let P=c[D];if(void 0===P){P=x++;c[D]=P;a.push(Y);for(let Z=0,aa=p;Z!==aa;++Z)l[Z].push(new ae(Y,e[Z],h[Z]))}else if(P<y){w=a[P];const Z=--y;var H=a[Z];c[H.uuid]=P;a[P]=H;c[D]=Z;a[Z]=Y;for(let aa=0,T=p;aa!==T;++aa)D=l[aa],H=D[P],D[P]=D[Z],void 0===H&&(H=new ae(Y,e[aa],h[aa])),D[Z]=
H}else a[P]!==w&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const a=this._objects,c=this._indicesByUUID,e=this._bindings,h=e.length;let l=this.nCachedObjects_;for(let x=0,y=arguments.length;x!==y;++x){var p=arguments[x],w=p.uuid;const D=c[w];if(void 0!==D&&D>=l){const H=l++,I=a[H];c[I.uuid]=D;a[D]=I;c[w]=H;a[H]=p;for(let L=0,Y=h;L!==Y;++L)p=e[L],
w=p[D],p[D]=p[H],p[H]=w}}this.nCachedObjects_=l}uncache(){const a=this._objects,c=this._indicesByUUID,e=this._bindings,h=e.length;let l=this.nCachedObjects_,p=a.length;for(let H=0,I=arguments.length;H!==I;++H){var w=arguments[H].uuid;const L=c[w];if(void 0!==L)if(delete c[w],L<l){w=--l;var x=a[w],y=--p,D=a[y];c[x.uuid]=L;a[L]=x;c[D.uuid]=w;a[w]=D;a.pop();for(let Y=0,P=h;Y!==P;++Y)x=e[Y],D=x[y],x[L]=x[w],x[w]=D,x.pop()}else{w=--p;y=a[w];0<w&&(c[y.uuid]=L);a[L]=y;a.pop();for(let Y=0,P=h;Y!==P;++Y)y=
e[Y],y[L]=y[w],y.pop()}}this.nCachedObjects_=l}subscribe_(a,c){const e=this._bindingsIndicesByPath;let h=e[a];const l=this._bindings;if(void 0!==h)return l[h];const p=this._paths,w=this._parsedPaths,x=this._objects,y=this.nCachedObjects_,D=Array(x.length);h=l.length;e[a]=h;p.push(a);w.push(c);l.push(D);for(let H=y,I=x.length;H!==I;++H)D[H]=new ae(x[H],a,c);return D}unsubscribe_(a){const c=this._bindingsIndicesByPath,e=c[a];if(void 0!==e){const h=this._paths,l=this._parsedPaths,p=this._bindings,w=
p.length-1,x=p[w];c[a[w]]=e;p[e]=x;p.pop();l[e]=l[w];l.pop();h[e]=h[w];h.pop()}}}class Zl{constructor(a,c,e=null,h=c.blendMode){this._mixer=a;this._clip=c;this._localRoot=e;this.blendMode=h;a=c.tracks;c=a.length;e=Array(c);h={endingStart:2400,endingEnd:2400};for(let l=0;l!==c;++l){const p=a[l].createInterpolant(null);e[l]=p;p.settings=h}this._interpolantSettings=h;this._interpolants=e;this._propertyBindings=Array(c);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=
null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}play(){this._mixer._activateAction(this);return this}stop(){this._mixer._deactivateAction(this);return this.reset()}reset(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()}isRunning(){return this.enabled&&
!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(a){this._startTime=a;return this}setLoop(a,c){this.loop=a;this.repetitions=c;return this}setEffectiveWeight(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(a){return this._scheduleFading(a,0,1)}fadeOut(a){return this._scheduleFading(a,1,0)}crossFadeFrom(a,
c,e){a.fadeOut(c);this.fadeIn(c);if(e){e=this._clip.duration;const h=a._clip.duration,l=e/h;a.warp(1,h/e,c);this.warp(l,1,c)}return this}crossFadeTo(a,c,e){return a.crossFadeFrom(this,c,e)}stopFading(){const a=this._weightInterpolant;null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this}setEffectiveTimeScale(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(a){this.timeScale=
this._clip.duration/a;return this.stopWarping()}syncWith(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()}halt(a){return this.warp(this._effectiveTimeScale,0,a)}warp(a,c,e){var h=this._mixer;const l=h.time,p=this.timeScale;var w=this._timeScaleInterpolant;null===w&&(this._timeScaleInterpolant=w=h._lendControlInterpolant());h=w.parameterPositions;w=w.sampleValues;h[0]=l;h[1]=l+e;w[0]=a/p;w[1]=c/p;return this}stopWarping(){const a=this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=
null,this._mixer._takeBackControlInterpolant(a));return this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(a,c,e,h){if(this.enabled){var l=this._startTime;null!==l&&(c=(a-l)*e,0>c||0===e?c=0:(this._startTime=null,c*=e));c*=this._updateTimeScale(a);e=this._updateTime(c);a=this._updateWeight(a);if(0<a)switch(c=this._interpolants,l=this._propertyBindings,this.blendMode){case 2501:for(let p=0,w=c.length;p!==w;++p)c[p].evaluate(e),
l[p].accumulateAdditive(a);break;default:for(let p=0,w=c.length;p!==w;++p)c[p].evaluate(e),l[p].accumulate(h,a)}}else this._updateWeight(a)}_updateWeight(a){let c=0;if(this.enabled){c=this.weight;const e=this._weightInterpolant;if(null!==e){const h=e.evaluate(a)[0];c*=h;a>e.parameterPositions[1]&&(this.stopFading(),0===h&&(this.enabled=!1))}}return this._effectiveWeight=c}_updateTimeScale(a){let c=0;if(!this.paused){c=this.timeScale;const e=this._timeScaleInterpolant;if(null!==e){const h=e.evaluate(a)[0];
c*=h;a>e.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c)}}return this._effectiveTimeScale=c}_updateTime(a){const c=this._clip.duration;var e=this.loop;let h=this.time+a,l=this._loopCount;const p=2202===e;if(0===a)return-1===l?h:p&&1===(l&1)?c-h:h;if(2200===e)a:{if(-1===l&&(this._loopCount=0,this._setEndings(!0,!0,!1)),h>=c)h=c;else if(0>h)h=0;else{this.time=h;break a}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this.time=h;this._mixer.dispatchEvent({type:"finished",
action:this,direction:0>a?-1:1})}else{-1===l&&(0<=a?(l=0,this._setEndings(!0,0===this.repetitions,p)):this._setEndings(0===this.repetitions,!0,p));if(h>=c||0>h){e=Math.floor(h/c);h-=c*e;l+=Math.abs(e);const w=this.repetitions-l;0>=w?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=h=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===w?(a=0>a,this._setEndings(a,!a,p)):this._setEndings(!1,!1,p),this._loopCount=l,this.time=h,this._mixer.dispatchEvent({type:"loop",
action:this,loopDelta:e}))}else this.time=h;if(p&&1===(l&1))return c-h}return h}_setEndings(a,c,e){const h=this._interpolantSettings;e?(h.endingStart=2401,h.endingEnd=2401):(h.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,h.endingEnd=c?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(a,c,e){var h=this._mixer;const l=h.time;var p=this._weightInterpolant;null===p&&(this._weightInterpolant=p=h._lendControlInterpolant());h=p.parameterPositions;p=p.sampleValues;h[0]=l;p[0]=c;h[1]=l+a;p[1]=e;return this}}
const kn=new Float32Array(1);class Sk extends Bf{constructor(a){super();this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}_bindAction(a,c){const e=a._localRoot||this._root,h=a._clip.tracks,l=h.length,p=a._propertyBindings;a=a._interpolants;const w=e.uuid;var x=this._bindingsByRootAndName;let y=x[w];void 0===y&&(y={},x[w]=y);for(x=0;x!==l;++x){const D=h[x],H=D.name;let I=y[H];if(void 0!==I)++I.referenceCount;else{I=p[x];if(void 0!==I){null===I._cacheIndex&&(++I.referenceCount,
this._addInactiveBinding(I,w,H));continue}I=new Li(ae.create(e,H,c&&c._propertyBindings[x].binding.parsedPath),D.ValueTypeName,D.getValueSize());++I.referenceCount;this._addInactiveBinding(I,w,H)}p[x]=I;a[x].resultBuffer=I.buffer}}_activateAction(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var c=(a._localRoot||this._root).uuid,e=a._clip.uuid;const h=this._actionsByClip[e];this._bindAction(a,h&&h.knownActions[0]);this._addInactiveAction(a,e,c)}c=a._propertyBindings;for(let h=0,l=c.length;h!==
l;++h)e=c[h],0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState());this._lendAction(a)}}_deactivateAction(a){if(this._isActiveAction(a)){const c=a._propertyBindings;for(let e=0,h=c.length;e!==h;++e){const l=c[e];0===--l.useCount&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(a)}}_initMemoryManager(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];
this._nActiveControlInterpolants=0;const a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}}_isActiveAction(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions}_addInactiveAction(a,c,e){const h=this._actions,l=this._actionsByClip;
let p=l[c];void 0===p?(p={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,l[c]=p):(c=p.knownActions,a._byClipCacheIndex=c.length,c.push(a));a._cacheIndex=h.length;h.push(a);p.actionByRoot[e]=a}_removeInactiveAction(a){var c=this._actions,e=c[c.length-1],h=a._cacheIndex;e._cacheIndex=h;c[h]=e;c.pop();a._cacheIndex=null;c=a._clip.uuid;e=this._actionsByClip;h=e[c];const l=h.knownActions,p=l[l.length-1],w=a._byClipCacheIndex;p._byClipCacheIndex=w;l[w]=p;l.pop();a._byClipCacheIndex=null;delete h.actionByRoot[(a._localRoot||
this._root).uuid];0===l.length&&delete e[c];this._removeInactiveBindingsForAction(a)}_removeInactiveBindingsForAction(a){a=a._propertyBindings;for(let c=0,e=a.length;c!==e;++c){const h=a[c];0===--h.referenceCount&&this._removeInactiveBinding(h)}}_lendAction(a){const c=this._actions,e=a._cacheIndex,h=this._nActiveActions++,l=c[h];a._cacheIndex=h;c[h]=a;l._cacheIndex=e;c[e]=l}_takeBackAction(a){const c=this._actions,e=a._cacheIndex,h=--this._nActiveActions,l=c[h];a._cacheIndex=h;c[h]=a;l._cacheIndex=
e;c[e]=l}_addInactiveBinding(a,c,e){const h=this._bindingsByRootAndName,l=this._bindings;let p=h[c];void 0===p&&(p={},h[c]=p);p[e]=a;a._cacheIndex=l.length;l.push(a)}_removeInactiveBinding(a){const c=this._bindings;var e=a.binding;const h=e.rootNode.uuid;e=e.path;const l=this._bindingsByRootAndName,p=l[h],w=c[c.length-1];a=a._cacheIndex;w._cacheIndex=a;c[a]=w;c.pop();delete p[e];0===Object.keys(p).length&&delete l[h]}_lendBinding(a){const c=this._bindings,e=a._cacheIndex,h=this._nActiveBindings++,
l=c[h];a._cacheIndex=h;c[h]=a;l._cacheIndex=e;c[e]=l}_takeBackBinding(a){const c=this._bindings,e=a._cacheIndex,h=--this._nActiveBindings,l=c[h];a._cacheIndex=h;c[h]=a;l._cacheIndex=e;c[e]=l}_lendControlInterpolant(){const a=this._controlInterpolants,c=this._nActiveControlInterpolants++;let e=a[c];void 0===e&&(e=new Bi(new Float32Array(2),new Float32Array(2),1,kn),e.__cacheIndex=c,a[c]=e);return e}_takeBackControlInterpolant(a){const c=this._controlInterpolants,e=a.__cacheIndex,h=--this._nActiveControlInterpolants,
l=c[h];a.__cacheIndex=h;c[h]=a;l.__cacheIndex=e;c[e]=l}clipAction(a,c,e){var h=c||this._root;const l=h.uuid;h="string"===typeof a?ch.findByName(h,a):a;a=null!==h?h.uuid:a;const p=this._actionsByClip[a];var w=null;void 0===e&&(e=null!==h?h.blendMode:2500);if(void 0!==p){w=p.actionByRoot[l];if(void 0!==w&&w.blendMode===e)return w;w=p.knownActions[0];null===h&&(h=w._clip)}if(null===h)return null;c=new Zl(this,h,c,e);this._bindAction(c,w);this._addInactiveAction(c,a,l);return c}existingAction(a,c){var e=
c||this._root;c=e.uuid;e="string"===typeof a?ch.findByName(e,a):a;a=this._actionsByClip[e?e.uuid:a];return void 0!==a?a.actionByRoot[c]||null:null}stopAllAction(){const a=this._actions;var c=this._nActiveActions;for(--c;0<=c;--c)a[c].stop();return this}update(a){a*=this.timeScale;var c=this._actions,e=this._nActiveActions;const h=this.time+=a,l=Math.sign(a),p=this._accuIndex^=1;for(let w=0;w!==e;++w)c[w]._update(h,a,l,p);a=this._bindings;c=this._nActiveBindings;for(e=0;e!==c;++e)a[e].apply(p);return this}setTime(a){this.time=
0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(a)}getRoot(){return this._root}uncacheClip(a){const c=this._actions;a=a.uuid;const e=this._actionsByClip;var h=e[a];if(void 0!==h){h=h.knownActions;for(let l=0,p=h.length;l!==p;++l){const w=h[l];this._deactivateAction(w);const x=w._cacheIndex,y=c[c.length-1];w._cacheIndex=null;w._byClipCacheIndex=null;y._cacheIndex=x;c[x]=y;c.pop();this._removeInactiveBindingsForAction(w)}delete e[a]}}uncacheRoot(a){a=a.uuid;const c=
this._actionsByClip;for(var e in c){const h=c[e].actionByRoot[a];void 0!==h&&(this._deactivateAction(h),this._removeInactiveAction(h))}e=this._bindingsByRootAndName[a];if(void 0!==e)for(const h in e)a=e[h],a.restoreOriginalState(),this._removeInactiveBinding(a)}uncacheAction(a,c){a=this.existingAction(a,c);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}}class $l{constructor(a){this.value=a}clone(){return new $l(void 0===this.value.clone?this.value:this.value.clone())}}let Am=
0;class Tk extends Bf{constructor(){super();this.isUniformsGroup=!0;Object.defineProperty(this,"id",{value:Am++});this.name="";this.usage=35044;this.uniforms=[]}add(a){this.uniforms.push(a);return this}remove(a){a=this.uniforms.indexOf(a);-1!==a&&this.uniforms.splice(a,1);return this}setName(a){this.name=a;return this}setUsage(a){this.usage=a;return this}dispose(){this.dispatchEvent({type:"dispose"});return this}copy(a){this.name=a.name;this.usage=a.usage;a=a.uniforms;this.uniforms.length=0;for(let c=
0,e=a.length;c<e;c++){const h=Array.isArray(a[c])?a[c]:[a[c]];for(let l=0;l<h.length;l++)this.uniforms.push(h[l].clone())}return this}clone(){return(new this.constructor).copy(this)}}class Cn extends oe{constructor(a,c,e=1){super(a,c);this.isInstancedInterleavedBuffer=!0;this.meshPerAttribute=e}copy(a){super.copy(a);this.meshPerAttribute=a.meshPerAttribute;return this}clone(a){a=super.clone(a);a.meshPerAttribute=this.meshPerAttribute;return a}toJSON(a){a=super.toJSON(a);a.isInstancedInterleavedBuffer=
!0;a.meshPerAttribute=this.meshPerAttribute;return a}}class Om{constructor(a,c,e,h,l){this.isGLBufferAttribute=!0;this.name="";this.buffer=a;this.type=c;this.itemSize=e;this.elementSize=h;this.count=l;this.version=0}set needsUpdate(a){!0===a&&this.version++}setBuffer(a){this.buffer=a;return this}setType(a,c){this.type=a;this.elementSize=c;return this}setItemSize(a){this.itemSize=a;return this}setCount(a){this.count=a;return this}}const n=new Wc;class r{constructor(a,c,e=0,h=Infinity){this.ray=new wh(a,
c);this.near=e;this.far=h;this.camera=null;this.layers=new ke;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,c){this.ray.set(a,c)}setFromCamera(a,c){c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),
this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}setFromXRController(a){n.identity().extractRotation(a.matrixWorld);this.ray.origin.setFromMatrixPosition(a.matrixWorld);this.ray.direction.set(0,0,-1).applyMatrix4(n);return this}intersectObject(a,c=!0,e=[]){wj(a,this,e,c);e.sort(Xf);return e}intersectObjects(a,c=!0,e=[]){for(let h=0,l=a.length;h<l;h++)wj(a[h],this,e,c);e.sort(Xf);return e}}class B{constructor(a=1,c=0,e=0){this.radius=a;this.phi=c;this.theta=e;return this}set(a,
c,e){this.radius=a;this.phi=c;this.theta=e;return this}copy(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this}makeSafe(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,c,e){this.radius=Math.sqrt(a*a+c*c+e*e);0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a,e),this.phi=Math.acos(qc(c/this.radius,-1,1)));return this}clone(){return(new this.constructor).copy(this)}}
class F{constructor(a=1,c=0,e=0){this.radius=a;this.theta=c;this.y=e;return this}set(a,c,e){this.radius=a;this.theta=c;this.y=e;return this}copy(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,c,e){this.radius=Math.sqrt(a*a+e*e);this.theta=Math.atan2(a,e);this.y=c;return this}clone(){return(new this.constructor).copy(this)}}class Q{constructor(a,c,e,h){Q.prototype.isMatrix2=!0;this.elements=
[1,0,0,1];void 0!==a&&this.set(a,c,e,h)}identity(){this.set(1,0,0,1);return this}fromArray(a,c=0){for(let e=0;4>e;e++)this.elements[e]=a[e+c];return this}set(a,c,e,h){const l=this.elements;l[0]=a;l[2]=c;l[1]=e;l[3]=h;return this}}const V=new Lb;class oa{constructor(a=new Lb(Infinity,Infinity),c=new Lb(-Infinity,-Infinity)){this.isBox2=!0;this.min=a;this.max=c}set(a,c){this.min.copy(a);this.max.copy(c);return this}setFromPoints(a){this.makeEmpty();for(let c=0,e=a.length;c<e;c++)this.expandByPoint(a[c]);
return this}setFromCenterAndSize(a,c){c=V.copy(c).multiplyScalar(.5);this.min.copy(a).sub(c);this.max.copy(a).add(c);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?
a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,c){return c.set((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y}clampPoint(a,c){return c.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,V).distanceTo(a)}intersect(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);this.max.max(a.max);return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&
a.max.equals(this.max)}}const Ia=new Da,Ta=new Da;class tb{constructor(a=new Da,c=new Da){this.start=a;this.end=c}set(a,c){this.start.copy(a);this.end.copy(c);return this}copy(a){this.start.copy(a.start);this.end.copy(a.end);return this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,c){return this.delta(c).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,
c){Ia.subVectors(a,this.start);Ta.subVectors(this.end,this.start);a=Ta.dot(Ta);a=Ta.dot(Ia)/a;c&&(a=qc(a,0,1));return a}closestPointToPoint(a,c,e){a=this.closestPointToPointParameter(a,c);return this.delta(e).multiplyScalar(a).add(this.start)}applyMatrix4(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Zb=new Da;class gc extends Nd{constructor(a,c){super();
this.light=a;this.matrixAutoUpdate=!1;this.color=c;this.type="SpotLightHelper";a=new Xc;c=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,h=1,l=32;e<l;e++,h++){const p=e/l*Math.PI*2,w=h/l*Math.PI*2;c.push(Math.cos(p),Math.sin(p),1,Math.cos(w),Math.sin(w),1)}a.setAttribute("position",new Mc(c,3));c=new jh({fog:!1,toneMapped:!1});this.cone=new Bc(a,c);this.add(this.cone);this.update()}dispose(){this.cone.geometry.dispose();this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,
!1);this.light.target.updateWorldMatrix(!0,!1);this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld);this.matrixWorld.copy(this.light.matrixWorld);const a=this.light.distance?this.light.distance:1E3,c=a*Math.tan(this.light.angle);this.cone.scale.set(c,c,a);Zb.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(Zb);void 0!==this.color?this.cone.material.color.set(this.color):
this.cone.material.color.copy(this.light.color)}}const Pb=new Da,Ec=new Wc,Oc=new Wc;class Kc extends Bc{constructor(a){const c=Yf(a),e=new Xc;var h=[];const l=[],p=new ia(0,0,1),w=new ia(0,1,0);for(let x=0;x<c.length;x++){const y=c[x];y.parent&&y.parent.isBone&&(h.push(0,0,0),h.push(0,0,0),l.push(p.r,p.g,p.b),l.push(w.r,w.g,w.b))}e.setAttribute("position",new Mc(h,3));e.setAttribute("color",new Mc(l,3));h=new jh({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(e,h);
this.isSkeletonHelper=!0;this.type="SkeletonHelper";this.root=a;this.bones=c;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}updateMatrixWorld(a){const c=this.bones,e=this.geometry,h=e.getAttribute("position");Oc.copy(this.root.matrixWorld).invert();for(let l=0,p=0;l<c.length;l++){const w=c[l];w.parent&&w.parent.isBone&&(Ec.multiplyMatrices(Oc,w.matrixWorld),Pb.setFromMatrixPosition(Ec),h.setXYZ(p,Pb.x,Pb.y,Pb.z),Ec.multiplyMatrices(Oc,w.parent.matrixWorld),Pb.setFromMatrixPosition(Ec),h.setXYZ(p+
1,Pb.x,Pb.y,Pb.z),p+=2)}e.getAttribute("position").needsUpdate=!0;super.updateMatrixWorld(a)}dispose(){this.geometry.dispose();this.material.dispose()}}class Te extends nf{constructor(a,c,e){c=new Hl(c,4,2);const h=new ab({wireframe:!0,fog:!1,toneMapped:!1});super(c,h);this.light=a;this.color=e;this.type="PointLightHelper";this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}dispose(){this.geometry.dispose();this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);
void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const gb=new Da,Xa=new ia,nb=new ia;class ac extends Nd{constructor(a,c,e){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=e;this.type="HemisphereLightHelper";a=new ai(c);a.rotateY(.5*Math.PI);this.material=new ab({wireframe:!0,fog:!1,toneMapped:!1});void 0===this.color&&(this.material.vertexColors=!0);c=a.getAttribute("position");c=new Float32Array(3*c.count);a.setAttribute("color",
new mc(c,3));this.add(new nf(a,this.material));this.update()}dispose(){this.children[0].geometry.dispose();this.children[0].material.dispose()}update(){const a=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=a.geometry.getAttribute("color");Xa.copy(this.light.color);nb.copy(this.light.groundColor);for(let e=0,h=c.count;e<h;e++){const l=e<h/2?Xa:nb;c.setXYZ(e,l.r,l.g,l.b)}c.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1);a.lookAt(gb.setFromMatrixPosition(this.light.matrixWorld).negate())}}
class Qc extends Bc{constructor(a=10,c=10,e=4473924,h=8947848){e=new ia(e);h=new ia(h);const l=c/2,p=a/c,w=a/2;a=[];const x=[];for(let y=0,D=0,H=-w;y<=c;y++,H+=p){a.push(-w,0,H,w,0,H);a.push(H,0,-w,H,0,w);const I=y===l?e:h;I.toArray(x,D);D+=3;I.toArray(x,D);D+=3;I.toArray(x,D);D+=3;I.toArray(x,D);D+=3}c=new Xc;c.setAttribute("position",new Mc(a,3));c.setAttribute("color",new Mc(x,3));e=new jh({vertexColors:!0,toneMapped:!1});super(c,e);this.type="GridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}
class jd extends Bc{constructor(a=10,c=16,e=8,h=64,l=4473924,p=8947848){l=new ia(l);p=new ia(p);var w=[];const x=[];if(1<c)for(var y=0;y<c;y++){var D=y/c*2*Math.PI,H=Math.sin(D)*a;D=Math.cos(D)*a;w.push(0,0,0);w.push(H,0,D);H=y&1?l:p;x.push(H.r,H.g,H.b);x.push(H.r,H.g,H.b)}for(c=0;c<e;c++)for(y=c&1?l:p,H=a-a/e*c,D=0;D<h;D++){var I=D/h*2*Math.PI;let L=Math.sin(I)*H;I=Math.cos(I)*H;w.push(L,0,I);x.push(y.r,y.g,y.b);I=(D+1)/h*2*Math.PI;L=Math.sin(I)*H;I=Math.cos(I)*H;w.push(L,0,I);x.push(y.r,y.g,y.b)}a=
new Xc;a.setAttribute("position",new Mc(w,3));a.setAttribute("color",new Mc(x,3));w=new jh({vertexColors:!0,toneMapped:!1});super(a,w);this.type="PolarGridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}const hd=new Da,rd=new Da,We=new Da;class Wd extends Nd{constructor(a,c,e){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=e;this.type="DirectionalLightHelper";void 0===c&&(c=1);a=new Xc;a.setAttribute("position",new Mc([-c,c,0,c,c,0,c,-c,0,-c,
-c,0,-c,c,0],3));c=new jh({fog:!1,toneMapped:!1});this.lightPlane=new Vj(a,c);this.add(this.lightPlane);a=new Xc;a.setAttribute("position",new Mc([0,0,0,0,0,1],3));this.targetLine=new Vj(a,c);this.add(this.targetLine);this.update()}dispose(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.light.target.updateWorldMatrix(!0,!1);hd.setFromMatrixPosition(this.light.matrixWorld);
rd.setFromMatrixPosition(this.light.target.matrixWorld);We.subVectors(rd,hd);this.lightPlane.lookAt(rd);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(rd);this.targetLine.scale.z=We.length()}}const dj=new Da,Pd=new Jj;class En extends Bc{constructor(a){function c(H,I){e(H);e(I)}function e(H){p.push(0,
0,0);w.push(0,0,0);void 0===x[H]&&(x[H]=[]);x[H].push(p.length/3-1)}var h=new Xc,l=new jh({color:16777215,vertexColors:!0,toneMapped:!1});const p=[],w=[],x={};c("n1","n2");c("n2","n4");c("n4","n3");c("n3","n1");c("f1","f2");c("f2","f4");c("f4","f3");c("f3","f1");c("n1","f1");c("n2","f2");c("n3","f3");c("n4","f4");c("p","n1");c("p","n2");c("p","n3");c("p","n4");c("u1","u2");c("u2","u3");c("u3","u1");c("c","t");c("p","c");c("cn1","cn2");c("cn3","cn4");c("cf1","cf2");c("cf3","cf4");h.setAttribute("position",
new Mc(p,3));h.setAttribute("color",new Mc(w,3));super(h,l);this.type="CameraHelper";this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=x;this.update();a=new ia(16755200);h=new ia(16711680);l=new ia(43775);const y=new ia(16777215),D=new ia(3355443);this.setColors(a,h,l,y,D)}setColors(a,c,e,h,l){const p=this.geometry.getAttribute("color");p.setXYZ(0,a.r,a.g,a.b);p.setXYZ(1,a.r,a.g,a.b);p.setXYZ(2,a.r,
a.g,a.b);p.setXYZ(3,a.r,a.g,a.b);p.setXYZ(4,a.r,a.g,a.b);p.setXYZ(5,a.r,a.g,a.b);p.setXYZ(6,a.r,a.g,a.b);p.setXYZ(7,a.r,a.g,a.b);p.setXYZ(8,a.r,a.g,a.b);p.setXYZ(9,a.r,a.g,a.b);p.setXYZ(10,a.r,a.g,a.b);p.setXYZ(11,a.r,a.g,a.b);p.setXYZ(12,a.r,a.g,a.b);p.setXYZ(13,a.r,a.g,a.b);p.setXYZ(14,a.r,a.g,a.b);p.setXYZ(15,a.r,a.g,a.b);p.setXYZ(16,a.r,a.g,a.b);p.setXYZ(17,a.r,a.g,a.b);p.setXYZ(18,a.r,a.g,a.b);p.setXYZ(19,a.r,a.g,a.b);p.setXYZ(20,a.r,a.g,a.b);p.setXYZ(21,a.r,a.g,a.b);p.setXYZ(22,a.r,a.g,a.b);
p.setXYZ(23,a.r,a.g,a.b);p.setXYZ(24,c.r,c.g,c.b);p.setXYZ(25,c.r,c.g,c.b);p.setXYZ(26,c.r,c.g,c.b);p.setXYZ(27,c.r,c.g,c.b);p.setXYZ(28,c.r,c.g,c.b);p.setXYZ(29,c.r,c.g,c.b);p.setXYZ(30,c.r,c.g,c.b);p.setXYZ(31,c.r,c.g,c.b);p.setXYZ(32,e.r,e.g,e.b);p.setXYZ(33,e.r,e.g,e.b);p.setXYZ(34,e.r,e.g,e.b);p.setXYZ(35,e.r,e.g,e.b);p.setXYZ(36,e.r,e.g,e.b);p.setXYZ(37,e.r,e.g,e.b);p.setXYZ(38,h.r,h.g,h.b);p.setXYZ(39,h.r,h.g,h.b);p.setXYZ(40,l.r,l.g,l.b);p.setXYZ(41,l.r,l.g,l.b);p.setXYZ(42,l.r,l.g,l.b);p.setXYZ(43,
l.r,l.g,l.b);p.setXYZ(44,l.r,l.g,l.b);p.setXYZ(45,l.r,l.g,l.b);p.setXYZ(46,l.r,l.g,l.b);p.setXYZ(47,l.r,l.g,l.b);p.setXYZ(48,l.r,l.g,l.b);p.setXYZ(49,l.r,l.g,l.b);p.needsUpdate=!0}update(){const a=this.geometry,c=this.pointMap;Pd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);Ge("c",c,a,Pd,0,0,-1);Ge("t",c,a,Pd,0,0,1);Ge("n1",c,a,Pd,-1,-1,-1);Ge("n2",c,a,Pd,1,-1,-1);Ge("n3",c,a,Pd,-1,1,-1);Ge("n4",c,a,Pd,1,1,-1);Ge("f1",c,a,Pd,-1,-1,1);Ge("f2",c,a,Pd,1,-1,1);Ge("f3",c,a,Pd,-1,1,
1);Ge("f4",c,a,Pd,1,1,1);Ge("u1",c,a,Pd,.7,1.1,-1);Ge("u2",c,a,Pd,-.7,1.1,-1);Ge("u3",c,a,Pd,0,2,-1);Ge("cf1",c,a,Pd,-1,0,1);Ge("cf2",c,a,Pd,1,0,1);Ge("cf3",c,a,Pd,0,-1,1);Ge("cf4",c,a,Pd,0,1,1);Ge("cn1",c,a,Pd,-1,0,-1);Ge("cn2",c,a,Pd,1,0,-1);Ge("cn3",c,a,Pd,0,-1,-1);Ge("cn4",c,a,Pd,0,1,-1);a.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose();this.material.dispose()}}const hn=new fe;class Ln extends Bc{constructor(a,c=16776960){const e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,
5,6,6,7,7,4,0,4,1,5,2,6,3,7]),h=new Float32Array(24),l=new Xc;l.setIndex(new mc(e,1));l.setAttribute("position",new mc(h,3));super(l,new jh({color:c,toneMapped:!1}));this.object=a;this.type="BoxHelper";this.matrixAutoUpdate=!1;this.update()}update(a){void 0!==a&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==this.object&&hn.setFromObject(this.object);if(!hn.isEmpty()){a=hn.min;var c=hn.max,e=this.geometry.attributes.position,h=e.array;h[0]=c.x;h[1]=c.y;h[2]=c.z;h[3]=
a.x;h[4]=c.y;h[5]=c.z;h[6]=a.x;h[7]=a.y;h[8]=c.z;h[9]=c.x;h[10]=a.y;h[11]=c.z;h[12]=c.x;h[13]=c.y;h[14]=a.z;h[15]=a.x;h[16]=c.y;h[17]=a.z;h[18]=a.x;h[19]=a.y;h[20]=a.z;h[21]=c.x;h[22]=a.y;h[23]=a.z;e.needsUpdate=!0;this.geometry.computeBoundingSphere()}}setFromObject(a){this.object=a;this.update();return this}copy(a,c){super.copy(a,c);this.object=a.object;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class Fn extends Bc{constructor(a,c=16776960){const e=new Uint16Array([0,
1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),h=new Xc;h.setIndex(new mc(e,1));h.setAttribute("position",new Mc([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));super(h,new jh({color:c,toneMapped:!1}));this.box=a;this.type="Box3Helper";this.geometry.computeBoundingSphere()}updateMatrixWorld(a){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(a))}dispose(){this.geometry.dispose();this.material.dispose()}}
class An extends Vj{constructor(a,c=1,e=16776960){const h=new Xc;h.setAttribute("position",new Mc([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3));h.computeBoundingSphere();super(h,new jh({color:e,toneMapped:!1}));this.type="PlaneHelper";this.plane=a;this.size=c;a=new Xc;a.setAttribute("position",new Mc([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3));a.computeBoundingSphere();this.add(new nf(a,new ab({color:e,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,
0,0);this.scale.set(.5*this.size,.5*this.size,1);this.lookAt(this.plane.normal);this.translateZ(-this.plane.constant);super.updateMatrixWorld(a)}dispose(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()}}const Pm=new Da;let Qm,Gn;class Rn extends Nd{constructor(a=new Da(0,0,1),c=new Da(0,0,0),e=1,h=16776960,l=.2*e,p=.2*l){super();this.type="ArrowHelper";void 0===Qm&&(Qm=new Xc,Qm.setAttribute("position",new Mc([0,0,0,0,1,0],3)),
Gn=new jk(0,.5,1,5,1),Gn.translate(0,-.5,0));this.position.copy(c);this.line=new Vj(Qm,new jh({color:h,toneMapped:!1}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new nf(Gn,new ab({color:h,toneMapped:!1}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(e,l,p)}setDirection(a){.99999<a.y?this.quaternion.set(0,0,0,1):-.99999>a.y?this.quaternion.set(1,0,0,0):(Pm.set(a.z,0,-a.x).normalize(),this.quaternion.setFromAxisAngle(Pm,Math.acos(a.y)))}setLength(a,
c=.2*a,e=.2*c){this.line.scale.set(1,Math.max(1E-4,a-c),1);this.line.updateMatrix();this.cone.scale.set(e,c,e);this.cone.position.y=a;this.cone.updateMatrix()}setColor(a){this.line.material.color.set(a);this.cone.material.color.set(a)}copy(a){super.copy(a,!1);this.line.copy(a.line);this.cone.copy(a.cone);return this}dispose(){this.line.geometry.dispose();this.line.material.dispose();this.cone.geometry.dispose();this.cone.material.dispose()}}class d extends Bc{constructor(a=1){var c=[0,0,0,a,0,0,0,
0,0,0,a,0,0,0,0,0,0,a];a=new Xc;a.setAttribute("position",new Mc(c,3));a.setAttribute("color",new Mc([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));c=new jh({vertexColors:!0,toneMapped:!1});super(a,c);this.type="AxesHelper"}setColors(a,c,e){const h=new ia,l=this.geometry.attributes.color.array;h.set(a);h.toArray(l,0);h.toArray(l,3);h.set(c);h.toArray(l,6);h.toArray(l,9);h.set(e);h.toArray(l,12);h.toArray(l,15);this.geometry.attributes.color.needsUpdate=!0;return this}dispose(){this.geometry.dispose();
this.material.dispose()}}class f{constructor(){this.type="ShapePath";this.color=new ia;this.subPaths=[];this.currentPath=null}moveTo(a,c){this.currentPath=new Uj;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,c);return this}lineTo(a,c){this.currentPath.lineTo(a,c);return this}quadraticCurveTo(a,c,e,h){this.currentPath.quadraticCurveTo(a,c,e,h);return this}bezierCurveTo(a,c,e,h,l,p){this.currentPath.bezierCurveTo(a,c,e,h,l,p);return this}splineThru(a){this.currentPath.splineThru(a);
return this}toShapes(a){function c(P){const Z=[];for(let aa=0,T=P.length;aa<T;aa++){const ha=P[aa],Ca=new Ej;Ca.curves=ha.curves;Z.push(Ca)}return Z}function e(P,Z){const aa=Z.length;let T=!1;for(let Ca=aa-1,xa=0;xa<aa;Ca=xa++){var ha=Z[Ca];let Ha=Z[xa],Fa=Ha.x-ha.x,Ra=Ha.y-ha.y;if(Math.abs(Ra)>Number.EPSILON){if(0>Ra&&(ha=Z[xa],Fa=-Fa,Ha=Z[Ca],Ra=-Ra),!(P.y<ha.y||P.y>Ha.y))if(P.y===ha.y){if(P.x===ha.x)return!0}else{ha=Ra*(P.x-ha.x)-Fa*(P.y-ha.y);if(0===ha)return!0;0>ha||(T=!T)}}else if(P.y===ha.y&&
(Ha.x<=P.x&&P.x<=ha.x||ha.x<=P.x&&P.x<=Ha.x))return!0}return T}var h=Ij.isClockWise,l=this.subPaths;if(0===l.length)return[];const p=[];if(1===l.length){var w=l[0];var x=new Ej;x.curves=w.curves;p.push(x);return p}var y=!h(l[0].getPoints());y=a?!y:y;x=[];const D=[];let H=[];var I=0;let L;D[I]=void 0;H[I]=[];for(let P=0,Z=l.length;P<Z;P++){w=l[P];L=w.getPoints();var Y=h(L);(Y=a?!Y:Y)?(!y&&D[I]&&I++,D[I]={s:new Ej,p:L},D[I].s.curves=w.curves,y&&I++,H[I]=[]):H[I].push({h:w,p:L[0]})}if(!D[0])return c(l);
if(1<D.length){w=!1;a=0;for(let P=0,Z=D.length;P<Z;P++)x[P]=[];for(let P=0,Z=D.length;P<Z;P++)for(h=H[P],l=0;l<h.length;l++){Y=h[l];y=!0;for(I=0;I<D.length;I++)e(Y.p,D[I].p)&&(P!==I&&a++,y?(y=!1,x[I].push(Y)):w=!0);y&&x[P].push(Y)}0<a&&!1===w&&(H=x)}for(let P=0,Z=D.length;P<Z;P++){x=D[P].s;p.push(x);w=H[P];for(let aa=0,T=w.length;aa<T;aa++)x.holes.push(w[aa].h)}return p}}class k extends Bf{constructor(a,c=null){super();this.object=a;this.domElement=c;this.enabled=!0;this.state=-1;this.keys={};this.mouseButtons=
{LEFT:null,MIDDLE:null,RIGHT:null};this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class q extends dd{constructor(a=1,c=1,e=1,h={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.');super(a,c,{...h,count:e});this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",
{detail:{revision:"169"}}));"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="169");ba.ACESFilmicToneMapping=4;ba.AddEquation=100;ba.AddOperation=2;ba.AdditiveAnimationBlendMode=2501;ba.AdditiveBlending=2;ba.AgXToneMapping=6;ba.AlphaFormat=1021;ba.AlwaysCompare=519;ba.AlwaysDepth=1;ba.AlwaysStencilFunc=519;ba.AmbientLight=rn;ba.AnimationAction=Zl;ba.AnimationClip=ch;ba.AnimationLoader=ze;ba.AnimationMixer=Sk;ba.AnimationObjectGroup=
Rm;ba.AnimationUtils=ei;ba.ArcCurve=Vl;ba.ArrayCamera=Yc;ba.ArrowHelper=Rn;ba.AttachedBindMode="attached";ba.Audio=Pl;ba.AudioAnalyser=Wm;ba.AudioContext=hg;ba.AudioListener=$m;ba.AudioLoader=$d;ba.AxesHelper=d;ba.BackSide=1;ba.BasicDepthPacking=3200;ba.BasicShadowMap=0;ba.BatchedMesh=Tm;ba.Bone=pi;ba.BooleanKeyframeTrack=he;ba.Box2=oa;ba.Box3=fe;ba.Box3Helper=Fn;ba.BoxGeometry=zh;ba.BoxHelper=Ln;ba.BufferAttribute=mc;ba.BufferGeometry=Xc;ba.BufferGeometryLoader=Lc;ba.ByteType=1010;ba.Cache=Zf;ba.Camera=
Jj;ba.CameraHelper=En;ba.CanvasTexture=Qj;ba.CapsuleGeometry=Wl;ba.CatmullRomCurve3=Sj;ba.CineonToneMapping=3;ba.CircleGeometry=yl;ba.ClampToEdgeWrapping=1001;ba.Clock=ol;ba.Color=ia;ba.ColorKeyframeTrack=vh;ba.ColorManagement=Eb;ba.CompressedArrayTexture=sj;ba.CompressedCubeTexture=hf;ba.CompressedTexture=am;ba.CompressedTextureLoader=lm;ba.ConeGeometry=ym;ba.ConstantAlphaFactor=213;ba.ConstantColorFactor=211;ba.Controls=k;ba.CubeCamera=Je;ba.CubeReflectionMapping=301;ba.CubeRefractionMapping=302;
ba.CubeTexture=Ck;ba.CubeTextureLoader=nm;ba.CubeUVReflectionMapping=306;ba.CubicBezierCurve=al;ba.CubicBezierCurve3=vk;ba.CubicInterpolant=Lh;ba.CullFaceBack=1;ba.CullFaceFront=2;ba.CullFaceFrontBack=3;ba.CullFaceNone=0;ba.Curve=ng;ba.CurvePath=fm;ba.CustomBlending=5;ba.CustomToneMapping=5;ba.CylinderGeometry=jk;ba.Cylindrical=F;ba.Data3DTexture=ee;ba.DataArrayTexture=ed;ba.DataTexture=jg;ba.DataTextureLoader=Bk;ba.DataUtils=ic;ba.DecrementStencilOp=7683;ba.DecrementWrapStencilOp=34056;ba.DefaultLoadingManager=
ag;ba.DepthFormat=1026;ba.DepthStencilFormat=1027;ba.DepthTexture=g;ba.DetachedBindMode="detached";ba.DirectionalLight=pm;ba.DirectionalLightHelper=Wd;ba.DiscreteInterpolant=uh;ba.DisplayP3ColorSpace="display-p3";ba.DodecahedronGeometry=Hk;ba.DoubleSide=2;ba.DstAlphaFactor=206;ba.DstColorFactor=208;ba.DynamicCopyUsage=35050;ba.DynamicDrawUsage=35048;ba.DynamicReadUsage=35049;ba.EdgesGeometry=qm;ba.EllipseCurve=fl;ba.EqualCompare=514;ba.EqualDepth=4;ba.EqualStencilFunc=514;ba.EquirectangularReflectionMapping=
303;ba.EquirectangularRefractionMapping=304;ba.Euler=Qg;ba.EventDispatcher=Bf;ba.ExtrudeGeometry=zm;ba.FileLoader=Mh;ba.Float16BufferAttribute=Ug;ba.Float32BufferAttribute=Mc;ba.FloatType=1015;ba.Fog=we;ba.FogExp2=ff;ba.FramebufferTexture=ln;ba.FrontSide=0;ba.Frustum=fk;ba.GLBufferAttribute=Om;ba.GLSL1="100";ba.GLSL3="300 es";ba.GreaterCompare=516;ba.GreaterDepth=6;ba.GreaterEqualCompare=518;ba.GreaterEqualDepth=5;ba.GreaterEqualStencilFunc=518;ba.GreaterStencilFunc=516;ba.GridHelper=Qc;ba.Group=
md;ba.HalfFloatType=1016;ba.HemisphereLight=cg;ba.HemisphereLightHelper=ac;ba.IcosahedronGeometry=kk;ba.ImageBitmapLoader=Im;ba.ImageLoader=Yj;ba.ImageUtils=kd;ba.IncrementStencilOp=7682;ba.IncrementWrapStencilOp=34055;ba.InstancedBufferAttribute=Fh;ba.InstancedBufferGeometry=Fm;ba.InstancedInterleavedBuffer=Cn;ba.InstancedMesh=ik;ba.Int16BufferAttribute=Fj;ba.Int32BufferAttribute=Rf;ba.Int8BufferAttribute=xd;ba.IntType=1013;ba.InterleavedBuffer=oe;ba.InterleavedBufferAttribute=pf;ba.Interpolant=
Ci;ba.InterpolateDiscrete=2300;ba.InterpolateLinear=2301;ba.InterpolateSmooth=2302;ba.InvertStencilOp=5386;ba.KeepStencilOp=7680;ba.KeyframeTrack=rf;ba.LOD=lg;ba.LatheGeometry=cl;ba.Layers=ke;ba.LessCompare=513;ba.LessDepth=2;ba.LessEqualCompare=515;ba.LessEqualDepth=3;ba.LessEqualStencilFunc=515;ba.LessStencilFunc=513;ba.Light=Oe;ba.LightProbe=pl;ba.Line=Vj;ba.Line3=tb;ba.LineBasicMaterial=jh;ba.LineCurve=$k;ba.LineCurve3=Tj;ba.LineDashedMaterial=Kh;ba.LineLoop=Zc;ba.LineSegments=Bc;ba.LinearDisplayP3ColorSpace=
"display-p3-linear";ba.LinearFilter=1006;ba.LinearInterpolant=Bi;ba.LinearMipMapLinearFilter=1008;ba.LinearMipMapNearestFilter=1007;ba.LinearMipmapLinearFilter=1008;ba.LinearMipmapNearestFilter=1007;ba.LinearSRGBColorSpace="srgb-linear";ba.LinearToneMapping=1;ba.LinearTransfer="linear";ba.Loader=Ye;ba.LoaderUtils=xg;ba.LoadingManager=Lg;ba.LoopOnce=2200;ba.LoopPingPong=2202;ba.LoopRepeat=2201;ba.LuminanceAlphaFormat=1025;ba.LuminanceFormat=1024;ba.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};
ba.Material=Sa;ba.MaterialLoader=ck;ba.MathUtils=jl;ba.Matrix2=Q;ba.Matrix3=nd;ba.Matrix4=Wc;ba.MaxEquation=104;ba.Mesh=nf;ba.MeshBasicMaterial=ab;ba.MeshDepthMaterial=Jb;ba.MeshDistanceMaterial=$b;ba.MeshLambertMaterial=km;ba.MeshMatcapMaterial=jm;ba.MeshNormalMaterial=Ve;ba.MeshPhongMaterial=Em;ba.MeshPhysicalMaterial=hl;ba.MeshStandardMaterial=ah;ba.MeshToonMaterial=il;ba.MinEquation=103;ba.MirroredRepeatWrapping=1002;ba.MixOperation=1;ba.MultiplyBlending=4;ba.MultiplyOperation=0;ba.NearestFilter=
1003;ba.NearestMipMapLinearFilter=1005;ba.NearestMipMapNearestFilter=1004;ba.NearestMipmapLinearFilter=1005;ba.NearestMipmapNearestFilter=1004;ba.NeutralToneMapping=7;ba.NeverCompare=512;ba.NeverDepth=0;ba.NeverStencilFunc=512;ba.NoBlending=0;ba.NoColorSpace="";ba.NoToneMapping=0;ba.NormalAnimationBlendMode=2500;ba.NormalBlending=1;ba.NotEqualCompare=517;ba.NotEqualDepth=7;ba.NotEqualStencilFunc=517;ba.NumberKeyframeTrack=ki;ba.Object3D=Nd;ba.ObjectLoader=Ym;ba.ObjectSpaceNormalMap=1;ba.OctahedronGeometry=
ai;ba.OneFactor=201;ba.OneMinusConstantAlphaFactor=214;ba.OneMinusConstantColorFactor=212;ba.OneMinusDstAlphaFactor=207;ba.OneMinusDstColorFactor=209;ba.OneMinusSrcAlphaFactor=205;ba.OneMinusSrcColorFactor=203;ba.OrthographicCamera=Th;ba.P3Primaries="p3";ba.PCFShadowMap=1;ba.PCFSoftShadowMap=2;ba.PMREMGenerator=b;ba.Path=Uj;ba.PerspectiveCamera=Sf;ba.Plane=kj;ba.PlaneGeometry=Cf;ba.PlaneHelper=An;ba.PointLight=pn;ba.PointLightHelper=Te;ba.Points=Um;ba.PointsMaterial=wl;ba.PolarGridHelper=jd;ba.PolyhedronGeometry=
Rk;ba.PositionalAudio=om;ba.PropertyBinding=ae;ba.PropertyMixer=Li;ba.QuadraticBezierCurve=bl;ba.QuadraticBezierCurve3=Gl;ba.Quaternion=Ze;ba.QuaternionKeyframeTrack=nl;ba.QuaternionLinearInterpolant=Bj;ba.RED_GREEN_RGTC2_Format=36285;ba.RED_RGTC1_Format=36283;ba.REVISION="169";ba.RGBADepthPacking=3201;ba.RGBAFormat=1023;ba.RGBAIntegerFormat=1033;ba.RGBA_ASTC_10x10_Format=37819;ba.RGBA_ASTC_10x5_Format=37816;ba.RGBA_ASTC_10x6_Format=37817;ba.RGBA_ASTC_10x8_Format=37818;ba.RGBA_ASTC_12x10_Format=37820;
ba.RGBA_ASTC_12x12_Format=37821;ba.RGBA_ASTC_4x4_Format=37808;ba.RGBA_ASTC_5x4_Format=37809;ba.RGBA_ASTC_5x5_Format=37810;ba.RGBA_ASTC_6x5_Format=37811;ba.RGBA_ASTC_6x6_Format=37812;ba.RGBA_ASTC_8x5_Format=37813;ba.RGBA_ASTC_8x6_Format=37814;ba.RGBA_ASTC_8x8_Format=37815;ba.RGBA_BPTC_Format=36492;ba.RGBA_ETC2_EAC_Format=37496;ba.RGBA_PVRTC_2BPPV1_Format=35843;ba.RGBA_PVRTC_4BPPV1_Format=35842;ba.RGBA_S3TC_DXT1_Format=33777;ba.RGBA_S3TC_DXT3_Format=33778;ba.RGBA_S3TC_DXT5_Format=33779;ba.RGBDepthPacking=
3202;ba.RGBFormat=1022;ba.RGBIntegerFormat=1032;ba.RGB_BPTC_SIGNED_Format=36494;ba.RGB_BPTC_UNSIGNED_Format=36495;ba.RGB_ETC1_Format=36196;ba.RGB_ETC2_Format=37492;ba.RGB_PVRTC_2BPPV1_Format=35841;ba.RGB_PVRTC_4BPPV1_Format=35840;ba.RGB_S3TC_DXT1_Format=33776;ba.RGDepthPacking=3203;ba.RGFormat=1030;ba.RGIntegerFormat=1031;ba.RawShaderMaterial=zk;ba.Ray=wh;ba.Raycaster=r;ba.Rec709Primaries="rec709";ba.RectAreaLight=Xm;ba.RedFormat=1028;ba.RedIntegerFormat=1029;ba.ReinhardToneMapping=2;ba.RenderTarget=
Md;ba.RepeatWrapping=1E3;ba.ReplaceStencilOp=7681;ba.ReverseSubtractEquation=102;ba.RingGeometry=gl;ba.SIGNED_RED_GREEN_RGTC2_Format=36286;ba.SIGNED_RED_RGTC1_Format=36284;ba.SRGBColorSpace="srgb";ba.SRGBTransfer="srgb";ba.Scene=ie;ba.ShaderChunk=Uc;ba.ShaderLib=Rg;ba.ShaderMaterial=ih;ba.ShadowMaterial=$g;ba.Shape=Ej;ba.ShapeGeometry=bj;ba.ShapePath=f;ba.ShapeUtils=Ij;ba.ShortType=1011;ba.Skeleton=nk;ba.SkeletonHelper=Kc;ba.SkinnedMesh=Cl;ba.Source=sf;ba.Sphere=$e;ba.SphereGeometry=Hl;ba.Spherical=
B;ba.SphericalHarmonics3=qn;ba.SplineCurve=dl;ba.SpotLight=nn;ba.SpotLightHelper=gc;ba.Sprite=rk;ba.SpriteMaterial=$i;ba.SrcAlphaFactor=204;ba.SrcAlphaSaturateFactor=210;ba.SrcColorFactor=202;ba.StaticCopyUsage=35046;ba.StaticDrawUsage=35044;ba.StaticReadUsage=35045;ba.StereoCamera=Rh;ba.StreamCopyUsage=35042;ba.StreamDrawUsage=35040;ba.StreamReadUsage=35041;ba.StringKeyframeTrack=ej;ba.SubtractEquation=101;ba.SubtractiveBlending=3;ba.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};ba.TangentSpaceNormalMap=
0;ba.TetrahedronGeometry=Zm;ba.Texture=Ld;ba.TextureLoader=xe;ba.TextureUtils=Bb;ba.TorusGeometry=Ik;ba.TorusKnotGeometry=Il;ba.Triangle=E;ba.TriangleFanDrawMode=2;ba.TriangleStripDrawMode=1;ba.TrianglesDrawMode=0;ba.TubeGeometry=yk;ba.UVMapping=300;ba.Uint16BufferAttribute=mf;ba.Uint32BufferAttribute=ij;ba.Uint8BufferAttribute=Sg;ba.Uint8ClampedBufferAttribute=If;ba.Uniform=$l;ba.UniformsGroup=Tk;ba.UniformsLib=oc;ba.UniformsUtils=Lk;ba.UnsignedByteType=1009;ba.UnsignedInt248Type=1020;ba.UnsignedInt5999Type=
35902;ba.UnsignedIntType=1014;ba.UnsignedShort4444Type=1017;ba.UnsignedShort5551Type=1018;ba.UnsignedShortType=1012;ba.VSMShadowMap=3;ba.Vector2=Lb;ba.Vector3=Da;ba.Vector4=yd;ba.VectorKeyframeTrack=xj;ba.VideoTexture=mn;ba.WebGL3DRenderTarget=Ie;ba.WebGLArrayRenderTarget=Jd;ba.WebGLCoordinateSystem=2E3;ba.WebGLCubeRenderTarget=Kj;ba.WebGLMultipleRenderTargets=q;ba.WebGLRenderTarget=dd;ba.WebGLRenderer=Df;ba.WebGLUtils=Eg;ba.WebGPUCoordinateSystem=2001;ba.WireframeGeometry=Wj;ba.WrapAroundEnding=
2402;ba.ZeroCurvatureEnding=2400;ba.ZeroFactor=200;ba.ZeroSlopeEnding=2401;ba.ZeroStencilOp=0;ba.createCanvasElement=$a};
shadow$provide[11]=function(Le,Sd,Yd,ba){(function(Na,qc){"object"===typeof ba&&"undefined"!==typeof Yd?Yd.exports=qc():"function"===typeof define&&define.amd?define(qc):(Na="undefined"!==typeof globalThis?globalThis:Na||self,Na.maplibregl=qc())})(this,function(){function Na(M,v,ta){hb[M]=ta;if("index"===M)return M="var sharedModule \x3d {}; ("+hb.shared+")(sharedModule); ("+hb.worker+")(sharedModule);",v={},hb.shared(v),hb.index(qc,v),"undefined"!==typeof window&&qc.setWorkerUrl(window.URL.createObjectURL(new Blob([M],
{type:"text/javascript"}))),qc}var qc={},hb={};Na("shared",["exports"],function(M){function v(d,f,k,q){return new (k||(k=Promise))(function(a,c){function e(p){try{l(q.next(p))}catch(w){c(w)}}function h(p){try{l(q.throw(p))}catch(w){c(w)}}function l(p){var w;p.done?a(p.value):(w=p.value,w instanceof k?w:new k(function(x){x(w)})).then(e,h)}l((q=q.apply(d,f||[])).next())})}function ta(d,f){this.x=d;this.y=f}function Va(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:
d}function Ab(){return null==fk&&(fk="undefined"!=typeof OffscreenCanvas&&(new OffscreenCanvas(1,1)).getContext("2d")&&"function"==typeof createImageBitmap),fk}function $a(){if(null==Cf&&(Cf=!1,Ab())){var d=(new OffscreenCanvas(5,5)).getContext("2d",{willReadFrequently:!0});if(d){for(var f=0;25>f;f++){const k=4*f;d.fillStyle=`rgb(${k},${k+1},${k+2})`;d.fillRect(f%5,Math.floor(f/5),1,1)}d=d.getImageData(0,0,5,5).data;for(f=0;100>f;f++)if(3!=f%4&&d[f]!==f){Cf=!0;break}}}return Cf||!1}function Sb(){var d=
new Uc(9);return Uc!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function na(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function bb(){var d=new Uc(3);return Uc!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function tc(d){var f=d[0],k=d[1];d=d[2];return Math.sqrt(f*f+k*k+d*d)}function vb(d,f,k){var q=new Uc(3);return q[0]=d,q[1]=f,q[2]=k,q}function Pa(d,f,k){return d[0]=f[0]+k[0],d[1]=
f[1]+k[1],d[2]=f[2]+k[2],d}function yb(d,f,k){return d[0]=f[0]*k,d[1]=f[1]*k,d[2]=f[2]*k,d}function Ib(d,f,k){var q=f[0],a=f[1];f=f[2];var c=k[0],e=k[1];k=k[2];return d[0]=a*k-f*e,d[1]=f*c-q*k,d[2]=q*e-a*c,d}function Fb(d,f,k){var q=f[0],a=f[1],c=f[2];f=f[3];return d[0]=k[0]*q+k[4]*a+k[8]*c+k[12]*f,d[1]=k[1]*q+k[5]*a+k[9]*c+k[13]*f,d[2]=k[2]*q+k[6]*a+k[10]*c+k[14]*f,d[3]=k[3]*q+k[7]*a+k[11]*c+k[15]*f,d}function zb(){var d=new Uc(4);return Uc!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function lc(d,
f,k,q){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"zyx",c=Math.PI/360;f*=c;q*=c;k*=c;c=Math.sin(f);var e=Math.cos(f),h=Math.sin(k),l=Math.cos(k),p=Math.sin(q),w=Math.cos(q);switch(a){case "xyz":d[0]=c*l*w+e*h*p;d[1]=e*h*w-c*l*p;d[2]=e*l*p+c*h*w;d[3]=e*l*w-c*h*p;break;case "xzy":d[0]=c*l*w-e*h*p;d[1]=e*h*w-c*l*p;d[2]=e*l*p+c*h*w;d[3]=e*l*w+c*h*p;break;case "yxz":d[0]=c*l*w+e*h*p;d[1]=e*h*w-c*l*p;d[2]=e*l*p-c*h*w;d[3]=e*l*w+c*h*p;break;case "yzx":d[0]=c*l*w+e*h*p;d[1]=e*h*w+c*l*p;
d[2]=e*l*p-c*h*w;d[3]=e*l*w-c*h*p;break;case "zxy":d[0]=c*l*w-e*h*p;d[1]=e*h*w+c*l*p;d[2]=e*l*p+c*h*w;d[3]=e*l*w-c*h*p;break;case "zyx":d[0]=c*l*w-e*h*p;d[1]=e*h*w+c*l*p;d[2]=e*l*p-c*h*w;d[3]=e*l*w+c*h*p;break;default:throw Error("Unknown angle order "+a);}return d}function bc(){var d=new Uc(2);return Uc!=Float32Array&&(d[0]=0,d[1]=0),d}function Hc(d,f){var k=new Uc(2);return k[0]=d,k[1]=f,k}function Jc(d,f,k){return 8192/(d.tileSize*Math.pow(2,k-d.tileID.overscaledZ))*f}function id(d,f){return(d%
f+f)%f}function sd(d,f,k){return d*(1-k)+f*k}function Dc(d){if(0>=d)return 0;if(1<=d)return 1;const f=d*d,k=f*d;return 4*(.5>d?k:3*(d-f)+k-.75)}function dc(d,f,k,q){const a=new Dk(d,f,k,q);return c=>a.solve(c)}function xc(d,f,k){return Math.min(k,Math.max(f,d))}function Nc(d,f,k){const q=k-f;d=((d-f)%q+q)%q+f;return d===f?k:d}function pd(d,...f){for(const k of f)for(const q in k)d[q]=k[q];return d}function Ic(d,f,k){k={};for(const q in d)k[q]=f.call(this,d[q],q,d);return k}function Rc(d,f,k){k={};
for(const q in d)f.call(this,d[q],q,d)&&(k[q]=d[q]);return k}function Kb(d){return Array.isArray(d)?d.map(Kb):"object"==typeof d&&d?Ic(d,Kb):d}function Ma(d){Kg[d]||("undefined"!=typeof console&&console.warn(d),Kg[d]=!0)}function jb(d,f,k){return(k.y-d.y)*(f.x-d.x)>(f.y-d.y)*(k.x-d.x)}function sc(d){return"undefined"!=typeof WorkerGlobalScope&&void 0!==d&&d instanceof WorkerGlobalScope}function Ac(d){if(null==lj){const f=d.navigator?d.navigator.userAgent:null;lj=!!d.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||
f.match("Safari")&&!f.match("Chrome")))}return lj}function Tc(d){return"undefined"!=typeof ImageBitmap&&d instanceof ImageBitmap}function od(d,f,k,q,a){return v(this,void 0,void 0,function*(){if("undefined"==typeof VideoFrame)throw Error("VideoFrame not supported");const c=new VideoFrame(d,{timestamp:0});try{var e=null==c?void 0:c.format;if(!e||!e.startsWith("BGR")&&!e.startsWith("RGB"))throw Error(`Unrecognized format ${e}`);const h=e.startsWith("BGR"),l=new Uint8ClampedArray(q*a*4),p=Math.max(0,
f),w=Math.max(0,k);if(yield c.copyTo.call(c,l,{rect:{x:p,y:w,width:Math.min(d.width,f+q)-p,height:Math.min(d.height,k+a)-w},layout:[{offset:(Math.max(0,k)-k)*q*4+4*Math.max(-f,0),stride:4*q}]}),h)for(e=0;e<l.length;e+=4){const x=l[e];l[e]=l[e+2];l[e+2]=x}return l}finally{c.close()}})}function Vc(d,f,k,q){return d.addEventListener(f,k,q),{unsubscribe:()=>{d.removeEventListener(f,k,q)}}}function yc(d){return d*Math.PI/180}function Pc(d){return d/Math.PI*180}function td(){return Error("AbortError")}
function Cd(d){return Ah.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}function Gd(d){if(!d||0>=d.indexOf("://")||0===d.indexOf("data:image/")||0===d.indexOf("blob:"))return!0;d=new URL(d);const f=window.location;return d.protocol===f.protocol&&d.host===f.host}function pe(d,f,k){k[d]&&-1!==k[d].indexOf(f)||(k[d]=k[d]||[],k[d].push(f))}function qe(d,f,k){k&&k[d]&&(f=k[d].indexOf(f),-1!==f&&k[d].splice(f,1))}function gf(d,f){const k={};for(const q in d)"ref"!==q&&(k[q]=d[q]);return g.forEach(q=>
{q in f&&(k[q]=f[q])}),k}function da(d,f){if(Array.isArray(d)){if(!Array.isArray(f)||d.length!==f.length)return!1;for(var k=0;k<d.length;k++)if(!da(d[k],f[k]))return!1;return!0}if("object"==typeof d&&null!==d&&null!==f){if("object"!=typeof f||Object.keys(d).length!==Object.keys(f).length)return!1;for(k in d)if(!da(d[k],f[k]))return!1;return!0}return d===f}function J(d,f){d.push(f)}function O(d,f,k){f.push({command:"removeSource",args:[d]});k[d]=!0}function W(d,f,k,q,a,c){d=d||{};f=f||{};for(const e in d)Object.prototype.hasOwnProperty.call(d,
e)&&(da(d[e],f[e])||k.push({command:c,args:[q,e,f[e],a]}));for(const e in f)Object.prototype.hasOwnProperty.call(f,e)&&!Object.prototype.hasOwnProperty.call(d,e)&&(da(d[e],f[e])||k.push({command:c,args:[q,e,f[e],a]}))}function S(d){return d.id}function fa(d,f){return d[f.id]=f,d}function ra(d,...f){for(const k of f)for(const q in k)d[q]=k[q];return d}function ma(d,f){return{kind:"array",itemType:d,N:f}}function ua(d){if("array"===d.kind){const f=ua(d.itemType);return"number"==typeof d.N?`array<${f}, ${d.N}>`:
"value"===d.itemType.kind?"array":`array<${f}>`}return d.kind}function Aa(d,f){if("error"===f.kind)return null;if("array"===d.kind){if("array"===f.kind&&(0===f.N&&"value"===f.itemType.kind||!Aa(d.itemType,f.itemType))&&("number"!=typeof d.N||d.N===f.N))return null}else{if(d.kind===f.kind)return null;if("value"===d.kind)for(const k of sb)if(!Aa(k,f))return null}return`Expected ${ua(d)} but found ${ua(f)} instead.`}function Ua(d,f){return f.some(k=>k.kind===d.kind)}function fb(d,f){return f.some(k=>
"null"===k?null===d:"array"===k?Array.isArray(d):"object"===k?d&&!Array.isArray(d)&&"object"==typeof d:k===typeof d)}function pb(d,f){return"array"===d.kind&&"array"===f.kind?d.itemType.kind===f.itemType.kind&&"number"==typeof d.N:d.kind===f.kind}function Rb(d){return 0>(d%=360)&&(d+=360),d}function ec([d,f,k,q]){let a,c;const e=fc(.2225045*(d=kc(d))+.7168786*(f=kc(f))+.0606169*(k=kc(k)));d===f&&f===k?a=c=e:(a=fc((.4360747*d+.3850649*f+.1430804*k)/.96422),c=fc((.0139322*d+.0971045*f+.7141733*k)/.82521));
d=116*e-16;return[0>d?0:d,500*(a-e),200*(e-c),q]}function kc(d){return.04045>=d?d/12.92:Math.pow((d+.055)/1.055,2.4)}function fc(d){return d>Nb?Math.pow(d,1/3):d/Db+ob}function Gc([d,f,k,q]){d=(d+16)/116;f=isNaN(f)?d:d+f/500;k=isNaN(k)?d:d-k/200;return d=1*Hd(d),f=.96422*Hd(f),k=.82521*Hd(k),[Fc(3.1338561*f-1.6168667*d-.4906146*k),Fc(-.9787684*f+1.9161415*d+.033454*k),Fc(.0719453*f-.2289914*d+1.4052427*k),q]}function Fc(d){return 0>(d=.00304>=d?12.92*d:1.055*Math.pow(d,1/2.4)-.055)?0:1<d?1:d}function Hd(d){return d>
eb?d*d*d:Db*(d-ob)}function de(d,f){return $b(d,f)?d[f]:void 0}function Me(d){return parseInt(d.padEnd(2,d),16)/255}function zg(d,f){return Kf(f?d/100:d,0,1)}function Kf(d,f,k){return Math.min(Math.max(f,d),k)}function Lf(d,f,k){return d+k*(f-d)}function Ag(d,f,k){return d.map((q,a)=>Lf(q,f[a],k))}function Vi(d,f,k,q){return"number"==typeof d&&0<=d&&255>=d&&"number"==typeof f&&0<=f&&255>=f&&"number"==typeof k&&0<=k&&255>=k?void 0===q||"number"==typeof q&&0<=q&&1>=q?null:`Invalid rgba value [${[d,
f,k,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof q?[d,f,k,q]:[d,f,k]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function qi(d){if(null===d||"string"==typeof d||"boolean"==typeof d||"number"==typeof d||d instanceof ie||d instanceof Bb||d instanceof Yc||d instanceof fd||d instanceof ud||d instanceof le||d instanceof wd||d instanceof ff||d instanceof we)return!0;if(Array.isArray(d)){for(const f of d)if(!qi(f))return!1;return!0}if("object"==
typeof d){for(const f in d)if(!qi(d[f]))return!1;return!0}return!1}function re(d){if(null===d)return C;if("string"==typeof d)return K;if("boolean"==typeof d)return R;if("number"==typeof d)return G;if(d instanceof Bb)return X;if(d instanceof ie)return ca;if(d instanceof Yc)return pa;if(d instanceof fd)return ya;if(d instanceof ud)return Ba;if(d instanceof le)return Ea;if(d instanceof wd)return za;if(d instanceof ff)return Za;if(d instanceof we)return Qa;if(Array.isArray(d)){const f=d.length;let k;
for(const q of d){d=re(q);if(k){if(k===d)continue;k=la;break}k=d}return ma(k||la,f)}return ja}function Eh(d){const f=typeof d;return null===d?"":"string"===f||"number"===f||"boolean"===f?String(d):d instanceof Bb||d instanceof ie||d instanceof fd||d instanceof ud||d instanceof le||d instanceof wd||d instanceof ff||d instanceof we?d.toString():JSON.stringify(d)}function ok(d,f){const k=d.length-1;let q,a,c=0,e=k,h=0;for(;c<=e;)if(h=Math.floor((c+e)/2),q=d[h],a=d[h+1],q<=f){if(h===k||f<a)return h;c=
h+1}else{if(!(q>f))throw new Fd("Input is not a number.");e=h-1}return 0}function Nj(d,f,k,q){q-=k;d-=k;return 0===q?0:1===f?d/q:(Math.pow(f,d)-1)/(Math.pow(f,q)-1)}function qj(d,f){return"\x3d\x3d"===d||"!\x3d"===d?"boolean"===f.kind||"string"===f.kind||"number"===f.kind||"null"===f.kind||"value"===f.kind:"string"===f.kind||"number"===f.kind||"value"===f.kind}function Ui(d,f,k,q){return 0===q.compare(f,k)}function mh(d,f,k){const q="\x3d\x3d"!==d&&"!\x3d"!==d,a=class{constructor(c,e,h){this.type=
R;this.lhs=c;this.rhs=e;this.collator=h;this.hasUntypedArgument="value"===c.type.kind||"value"===e.type.kind}static parse(c,e){if(3!==c.length&&4!==c.length)return e.error("Expected two or three arguments.");var h=c[0];let l=e.parse(c[1],1,la);if(!l)return null;if(!qj(h,l.type))return e.concat(1).error(`"${h}" comparisons are not supported for type '${ua(l.type)}'.`);let p=e.parse(c[2],2,la);if(!p)return null;if(!qj(h,p.type))return e.concat(2).error(`"${h}" comparisons are not supported for type '${ua(p.type)}'.`);
if(l.type.kind!==p.type.kind&&"value"!==l.type.kind&&"value"!==p.type.kind)return e.error(`Cannot compare types '${ua(l.type)}' and '${ua(p.type)}'.`);q&&("value"===l.type.kind&&"value"!==p.type.kind?l=new pf(p.type,[l]):"value"!==l.type.kind&&"value"===p.type.kind&&(p=new pf(l.type,[p])));h=null;if(4===c.length){if("string"!==l.type.kind&&"string"!==p.type.kind&&"value"!==l.type.kind&&"value"!==p.type.kind)return e.error("Cannot use collator to compare non-string types.");if(h=e.parse(c[3],3,pa),
!h)return null}return new a(l,p,h)}evaluate(c){const e=this.lhs.evaluate(c),h=this.rhs.evaluate(c);if(q&&this.hasUntypedArgument){var l=re(e),p=re(h);if(l.kind!==p.kind||"string"!==l.kind&&"number"!==l.kind)throw new Fd(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${l.kind}, ${p.kind}) instead.`);}return this.collator&&!q&&this.hasUntypedArgument&&(l=re(e),p=re(h),"string"!==l.kind||"string"!==p.kind)?f(c,e,h):this.collator?k(c,e,h,this.collator.evaluate(c)):
f(c,e,h)}eachChild(c){c(this.lhs);c(this.rhs);this.collator&&c(this.collator)}outputDefined(){return!0}};return a}function ri(d,f){var k,q;const a=Math.pow(2,f.z);return[(k=(d[0]/8192+f.x)/a,360*k-180),(q=(d[1]/8192+f.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*q)*Math.PI/180))-90)]}function Bg(d,f){d[0]=Math.min(d[0],f[0]);d[1]=Math.min(d[1],f[1]);d[2]=Math.max(d[2],f[0]);d[3]=Math.max(d[3],f[1])}function Cg(d,f){return!(d[0]<=f[0]||d[2]>=f[2]||d[1]<=f[1]||d[3]>=f[3])}function Gh(d,f,k,q){var a,
c;return 0!=(c=[q[0]-k[0],q[1]-k[1]])[0]*(a=[f[0]-d[0],f[1]-d[1]])[1]-c[1]*a[0]&&!(!Pj(d,f,k,q)||!Pj(k,q,d,f))}function te(d,f,k=!1){let q=!1;for(const w of f)for(f=0;f<w.length-1;f++){var a=d,c=w[f],e=w[f+1];const x=a[0]-c[0];c=a[1]-c[1];const y=a[0]-e[0];a=a[1]-e[1];if(0==x*a-y*c&&0>=x*y&&0>=c*a)return k;(l=w[f])[1]>(h=d)[1]!=(p=w[f+1])[1]>h[1]&&h[0]<(p[0]-l[0])*(h[1]-l[1])/(p[1]-l[1])+l[0]&&(q=!q)}var h,l,p;return q}function Zh(d,f){for(var k of d)if(!te(k,f))return!1;for(k=0;k<d.length-1;++k){a:{var q=
d[k];var a=d[k+1],c=f;for(const e of c)for(c=0;c<e.length-1;++c)if(Gh(q,a,e[c],e[c+1])){q=!0;break a}q=!1}if(q)return!1}return!0}function Pj(d,f,k,q){const a=q[0]-k[0];q=q[1]-k[1];d=(d[0]-k[0])*q-a*(d[1]-k[1]);f=(f[0]-k[0])*q-a*(f[1]-k[1]);return 0<d&&0>f||0>d&&0<f}function oh(d,f,k){const q=[];for(let c=0;c<d.length;c++){const e=[];for(let h=0;h<d[c].length;h++){var a=d[c][h];const l=Math.pow(2,k.z);a=[Math.round((180+a[0])/360*l*8192),Math.round((180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*
Math.PI/360)))/360*l*8192)];Bg(f,a);e.push(a)}q.push(e)}return q}function Id(d,f,k){const q=[];for(let a=0;a<d.length;a++){const c=oh(d[a],f,k);q.push(c)}return q}function Xg(d,f,k,q){if(d[0]<k[0]||d[0]>k[2]){const a=.5*q;let c=d[0]-k[0]>a?-q:k[0]-d[0]>a?q:0;0===c&&(c=d[0]-k[2]>a?-q:k[2]-d[0]>a?q:0);d[0]+=c}Bg(f,d)}function tk(d,f,k,q){const a=8192*Math.pow(2,q.z);q=[8192*q.x,8192*q.y];const c=[];for(const e of d)for(const h of e)d=[h.x+q[0],h.y+q[1]],Xg(d,f,k,a),c.push(d);return c}function ph(d,
f,k,q){const a=8192*Math.pow(2,q.z);q=[8192*q.x,8192*q.y];const c=[];for(const h of d){d=[];for(const l of h){const p=[l.x+q[0],l.y+q[1]];Bg(f,p);d.push(p)}c.push(d)}if(f[2]-f[0]<=a/2){(e=f)[0]=e[1]=1/0;e[2]=e[3]=-1/0;for(const h of c)for(const l of h)Xg(l,f,k,a)}var e;return c}function Dg(d,f,k=0,q=d.length-1,a=ui){for(;q>k;){if(600<q-k){var c=q-k+1,e=f-k+1,h=Math.log(c),l=.5*Math.exp(2*h/3);h=.5*Math.sqrt(h*l*(c-l)/c)*(0>e-c/2?-1:1);Dg(d,f,Math.max(k,Math.floor(f-e*l/c+h)),Math.min(q,Math.floor(f+
(c-e)*l/c+h)),a)}c=d[f];e=k;l=q;ti(d,k,f);for(0<a(d[q],c)&&ti(d,k,q);e<l;){ti(d,e,l);e++;for(l--;0>a(d[e],c);)e++;for(;0<a(d[l],c);)l--}0===a(d[k],c)?ti(d,k,l):(l++,ti(d,l,q));l<=f&&(k=l+1);f<=l&&(q=l-1)}}function ti(d,f,k){const q=d[f];d[f]=d[k];d[k]=q}function ui(d,f){return d<f?-1:d>f?1:0}function Yi(d,f){if(1>=d.length)return[d];const k=[];var q;let a;for(const c of d){d=0;for(let e,h,l=0,p=c.length,w=p-1;l<p;w=l++)e=c[l],h=c[w],d+=(h.x-e.x)*(e.y+h.y);0!==d&&(c.area=Math.abs(d),void 0===a&&(a=
0>d),a===0>d?(q&&k.push(q),q=[c]):q.push(c))}if(q&&k.push(q),1<f)for(q=0;q<k.length;q++)k[q].length<=f||(Dg(k[q],f,1,k[q].length-1,Fl),k[q]=k[q].slice(0,f));return k}function Fl(d,f){return f.area-d.area}function Rj(d,f){return f[0]-d[0]}function Tf(d,f){return d[1]>=d[0]&&d[1]<f}function vi(d,f){if(d[0]>d[1])return[null,null];const k=d[1]-d[0]+1;if(f){if(2===k)return[d,null];f=Math.floor(k/2);return[[d[0],d[0]+f],[d[0]+f,d[1]]]}if(1===k)return[d,null];f=Math.floor(k/2)-1;return[[d[0],d[0]+f],[d[0]+
f+1,d[1]]]}function tj(d,f){if(!Tf(f,d.length))return[1/0,1/0,-1/0,-1/0];const k=[1/0,1/0,-1/0,-1/0];for(let q=f[0];q<=f[1];++q)Bg(k,d[q]);return k}function Hh(d){const f=[1/0,1/0,-1/0,-1/0];for(const k of d)for(const q of k)Bg(f,q);return f}function uk(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function og(d,f,k){if(!uk(d)||!uk(f))return NaN;let q=0,a=0;return d[2]<f[0]&&(q=f[0]-d[2]),d[0]>f[2]&&(q=d[0]-f[2]),d[1]>f[3]&&(a=d[1]-f[3]),d[3]<f[1]&&(a=f[1]-d[3]),k.distance([0,0],[q,a])}
function Uf(d,f,k){f=k.pointOnLine(f,d);return k.distance(d,f.point)}function qd(d,f,k,q,a){const c=Math.min(Uf(d,[k,q],a),Uf(f,[k,q],a));d=Math.min(Uf(k,[d,f],a),Uf(q,[d,f],a));return Math.min(c,d)}function rb(d,f){for(const k of d)for(const q of k)if(te(q,f,!0))return!0;return!1}function Zi(d,f,k,q=1/0){var a=Hh(d),c=Hh(f);if(q!==1/0&&og(a,c,k)>=q)return q;if(Cg(a,c)){if(rb(d,f))return 0}else if(rb(f,d))return 0;q=1/0;for(const e of d)for(let h=0,l=e.length,p=l-1;h<l;p=h++){d=e[p];a=e[h];for(const w of f)for(let x=
0,y=w.length,D=y-1;x<y;D=x++){c=w[D];const H=w[x];if(Gh(d,a,c,H))return 0;q=Math.min(q,qd(d,a,c,H,k))}}return q}function Zg(d,f,k,q,a,c,e){c&&e&&(k=og(tj(q,c),tj(a,e),k),k<f&&d.push([k,c,e]))}function Ih(d,f,k,q,a=1/0){a=Math.min(q.distance(d[0],k[0][0]),a);if(0===a)return a;const c=new nk([[0,[0,d.length-1],[0,0]]],Rj),e=Hh(k);for(;0<c.length;){var h=c.pop();if(!(h[0]>=a)){var l=h[1];if(l[1]-l[0]+1<=(f?50:100)){if(!Tf(l,d.length))return NaN;if(f){a:{h=d;var p=k,w=q;if(Tf(l,h.length)){for(var x=l[0];x<=
l[1];++x)if(te(h[x],p,!0)){h=0;break a}x=1/0;for(var y=l[0];y<l[1];++y){var D=h[y];const H=h[y+1];for(const I of p)for(let L=0,Y=I.length,P=Y-1;L<Y;P=L++){const Z=I[P],aa=I[L];if(Gh(D,H,Z,aa)){h=0;break a}x=Math.min(x,qd(D,H,Z,aa,w))}}h=x}else h=NaN}if(isNaN(h)||0===h)return h;a=Math.min(a,h)}else for(h=l[0];h<=l[1];++h){a:if(p=d[h],y=k,w=q,te(p,y,!0))p=0;else{x=1/0;for(const H of y){y=H[0];D=H[H.length-1];if(y!==D&&(x=Math.min(x,Uf(p,[D,y],w)),0===x)){p=x;break a}y=w.pointOnLine(H,p);if(x=Math.min(x,
w.distance(p,y.point)),0===x){p=x;break a}}p=x}if(a=Math.min(a,p),0===a)return 0}}else{h=vi(l,f);l=c;p=a;x=q;y=d;D=e;if(w=h[0])x=og(tj(y,w),D,x),x<p&&l.push([x,w,[0,0]]);l=c;p=a;w=q;x=d;y=e;if(h=h[1])w=og(tj(x,h),y,w),w<p&&l.push([w,h,[0,0]])}}}return a}function wi(d,f,k,q,a,c=1/0){c=Math.min(c,a.distance(d[0],k[0]));if(0===c)return c;const e=new nk([[0,[0,d.length-1],[0,k.length-1]]],Rj);for(;0<e.length;){var h=e.pop();if(!(h[0]>=c)){var l=h[1],p=h[2];h=q?50:100;if(l[1]-l[0]+1<=(f?50:100)&&p[1]-
p[0]+1<=h){if(!Tf(l,d.length)&&Tf(p,k.length))return NaN;var w=void 0;if(f&&q){a:{w=d;h=k;var x=a;if(Tf(l,w.length)&&Tf(p,h.length)){var y=1/0;for(var D=l[0];D<l[1];++D){var H=w[D];const I=w[D+1];for(let L=p[0];L<p[1];++L){const Y=h[L],P=h[L+1];if(Gh(H,I,Y,P)){w=0;break a}y=Math.min(y,qd(H,I,Y,P,x))}}w=y}else w=1/0}c=Math.min(c,w)}else if(f&&!q)for(l=d.slice(l[0],l[1]+1),h=p[0];h<=p[1];++h){if(w=Uf(k[h],l,a),c=Math.min(c,w),0===c)return c}else if(!f&&q)for(h=k.slice(p[0],p[1]+1),p=l[0];p<=l[1];++p){if(w=
Uf(d[p],h,a),c=Math.min(c,w),0===c)return c}else{a:if(w=d,h=k,x=a,Tf(l,w.length)&&Tf(p,h.length)){y=1/0;for(D=l[0];D<=l[1];++D)for(H=p[0];H<=p[1];++H)if(y=Math.min(y,x.distance(w[D],h[H])),0===y){w=y;break a}w=y}else w=NaN;c=Math.min(c,w)}}else l=vi(l,f),h=vi(p,q),Zg(e,c,a,d,k,l[0],h[0]),Zg(e,c,a,d,k,l[0],h[1]),Zg(e,c,a,d,k,l[1],h[0]),Zg(e,c,a,d,k,l[1],h[1])}}return c}function rh(d){return"MultiPolygon"===d.type?d.coordinates.map(f=>({type:"Polygon",coordinates:f})):"MultiLineString"===d.type?d.coordinates.map(f=>
({type:"LineString",coordinates:f})):"MultiPoint"===d.type?d.coordinates.map(f=>({type:"Point",coordinates:f})):[d]}function yf(d,[f,k,q,a]){f=f.evaluate(d);k=k.evaluate(d);q=q.evaluate(d);d=a?a.evaluate(d):1;if(a=Vi(f,k,q,d))throw new Fd(a);return new Bb(f/255,k/255,q/255,d,!1)}function Jh(d,f){d=f[d];return void 0===d?null:d}function uj(d){if(d instanceof Se)return uj(d.boundExpression);if(d instanceof mg&&"error"===d.name||d instanceof Wk||d instanceof pj||d instanceof rj||d instanceof Xi)return!1;
const f=d instanceof xf||d instanceof pf;let k=!0;return d.eachChild(q=>{k=f?k&&uj(q):k&&q instanceof oe}),!!k&&Yg(d)&&xi(d,"zoom heatmap-density elevation line-progress accumulated is-supported-script".split(" "))}function Yg(d){if(d instanceof mg&&("get"===d.name&&1===d.args.length||"feature-state"===d.name||"has"===d.name&&1===d.args.length||"properties"===d.name||"geometry-type"===d.name||"id"===d.name||/^filter-/.test(d.name))||d instanceof pj||d instanceof rj)return!1;let f=!0;return d.eachChild(k=>
{f&&!Yg(k)&&(f=!1)}),f}function Ud(d){if(d instanceof mg&&"feature-state"===d.name)return!1;let f=!0;return d.eachChild(k=>{f&&!Ud(k)&&(f=!1)}),f}function xi(d,f){if(d instanceof mg&&0<=f.indexOf(d.name))return!1;let k=!0;return d.eachChild(q=>{k&&!xi(q,f)&&(k=!1)}),k}function Eg(d){return{result:"error",value:d}}function $h(d){return"data-driven"===d["property-type"]||"cross-faded-data-driven"===d["property-type"]}function qk(d){return!!d.expression&&-1<d.expression.parameters.indexOf("zoom")}function sh(d){return!!d.expression&&
d.expression.interpolated}function vd(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":null===d?"null":typeof d}function Fg(d){return"object"==typeof d&&null!==d&&!Array.isArray(d)&&re(d)===ja}function xk(d){return d}function Vf(d,f){var k=d.stops&&"object"==typeof d.stops[0][0],q=k||!(k||void 0!==d.property),a=d.type||(sh(f)?"exponential":"interval");const c=function(y){switch(y.type){case "color":return Bb.parse;case "padding":return ud.parse;
case "numberArray":return le.parse;case "colorArray":return wd.parse;default:return null}}(f);if(c&&((d=ra({},d)).stops&&(d.stops=d.stops.map(y=>[y[0],c(y[1])])),d.default=c(d.default?d.default:f.default)),d.colorSpace&&"rgb"!==(e=d.colorSpace)&&"hcl"!==e&&"lab"!==e)throw Error(`Unknown color space: "${d.colorSpace}"`);var e;const h=function(y){switch(y){case "exponential":return Ai;case "interval":return qf;case "categorical":return zi;case "identity":return Gg;default:throw Error(`Unknown function type "${y}"`);
}}(a);let l,p;if("categorical"===a){l=Object.create(null);for(var w of d.stops)l[w[0]]=w[1];p=typeof d.stops[0][0]}if(k){k={};q=[];for(a=0;a<d.stops.length;a++)e=d.stops[a],w=e[0].zoom,void 0===k[w]&&(k[w]={zoom:w,type:d.type,property:d.property,default:d.default,stops:[]},q.push(w)),k[w].stops.push([e[0].value,e[1]]);const y=[];for(var x of q)y.push([k[x].zoom,Vf(k[x],f)]);x={name:"linear"};return{kind:"composite",interpolationType:x,interpolationFactor:lg.interpolationFactor.bind(void 0,x),zoomStops:y.map(D=>
D[0]),evaluate:({zoom:D},H)=>Ai({stops:y,base:d.base},f,D).evaluate(D,H)}}return q?(x="exponential"===a?{name:"exponential",base:void 0!==d.base?d.base:1}:null,{kind:"camera",interpolationType:x,interpolationFactor:lg.interpolationFactor.bind(void 0,x),zoomStops:d.stops.map(y=>y[0]),evaluate:({zoom:y})=>h(d,f,y,l,p)}):{kind:"source",evaluate(y,D){y=D&&D.properties?D.properties[d.property]:void 0;return void 0===y?pg(d.default,f.default):h(d,f,y,l,p)}}}function pg(d,f,k){return void 0!==d?d:void 0!==
f?f:void 0!==k?k:void 0}function zi(d,f,k,q,a){return pg(typeof k===a?q[k]:void 0,d.default,f.default)}function qf(d,f,k){if("number"!==vd(k))return pg(d.default,f.default);f=d.stops.length;if(1===f||k<=d.stops[0][0])return d.stops[0][1];if(k>=d.stops[f-1][0])return d.stops[f-1][1];k=ok(d.stops.map(q=>q[0]),k);return d.stops[k][1]}function Ai(d,f,k){const q=void 0!==d.base?d.base:1;if("number"!==vd(k))return pg(d.default,f.default);var a=d.stops.length;if(1===a||k<=d.stops[0][0])return d.stops[0][1];
if(k>=d.stops[a-1][0])return d.stops[a-1][1];a=ok(d.stops.map(p=>p[0]),k);const c=function(p,w,x,y){y-=x;p-=x;return 0===y?0:1===w?p/y:(Math.pow(w,p)-1)/(Math.pow(w,y)-1)}(k,q,d.stops[a][0],d.stops[a+1][0]),e=d.stops[a][1],h=d.stops[a+1][1],l=ig[f.type]||xk;return"function"==typeof e.evaluate?{evaluate(...p){const w=e.evaluate.apply(void 0,p);p=h.evaluate.apply(void 0,p);if(void 0!==w&&void 0!==p)return l(w,p,c,d.colorSpace)}}:l(e,h,c,d.colorSpace)}function Gg(d,f,k){switch(f.type){case "color":k=
Bb.parse(k);break;case "formatted":k=fd.fromString(k.toString());break;case "resolvedImage":k=we.fromString(k.toString());break;case "padding":k=ud.parse(k);break;case "colorArray":k=wd.parse(k);break;case "numberArray":k=le.parse(k);break;default:vd(k)===f.type||"enum"===f.type&&f.values[k]||(k=void 0)}return pg(k,d.default,f.default)}function Ff(d){return Array.isArray(d)&&0<d.length&&"string"==typeof d[0]&&d[0]in si}function qg(d,f,k){if(f){var q={color:X,string:K,number:G,enum:K,boolean:R,formatted:ya,
padding:Ba,numberArray:Ea,colorArray:za,projectionDefinition:ca,resolvedImage:Qa,variableAnchorOffsetCollection:Za};q="array"===f.type?ma(q[f.value]||la,f.length):q[f.type]}else q=void 0;q=new Dh(si,uj,[],q);return(d=q.parse(d,void 0,void 0,void 0,f&&"string"===f.type?{typeAnnotation:"coerce"}:void 0))?{result:"success",value:new ik(d,f,k)}:Eg(q.errors)}function kg(d,f,k){d=qg(d,f,k);if("error"===d.result)return d;var q=d.value.expression;const a=Yg(q);if(!a&&!$h(f))return Eg([new u("","data expressions not supported")]);
const c=xi(q,["zoom"]);return c||qk(f)?(q=Td(q))||c?q instanceof u?Eg([q]):q instanceof lg&&!sh(f)?Eg([new u("",'"interpolate" expressions cannot be used with this property')]):{result:"success",value:q?new Uh(a?"camera":"composite",d.value,q.labels,q instanceof lg?q.interpolation:void 0,k):new El(a?"constant":"source",d.value,k)}:Eg([new u("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]):Eg([new u("","zoom expressions not supported")])}function Td(d){let f=
null;if(d instanceof Fe)f=Td(d.result);else if(d instanceof Yh)for(const k of d.args){if(f=Td(k),f)break}else(d instanceof nh||d instanceof lg)&&d.input instanceof mg&&"zoom"===d.input.name&&(f=d);return f instanceof u||d.eachChild(k=>{k=Td(k);k instanceof u?f=k:!f&&k?f=new u("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):f&&k&&f!==k&&(f=new u("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),f}function Mf(d,
f=new Set){return d instanceof Xi&&f.add(d.key),d.eachChild(k=>{Mf(k,f)}),f}function Ee(d,f){const {zoom:k,heatmapDensity:q,elevation:a,lineProgress:c,isSupportedScript:e,accumulated:h}=null!=d?d:{};return{zoom:k,heatmapDensity:q,elevation:a,lineProgress:c,isSupportedScript:e,accumulated:h,globalState:f}}function zf(d){if(!0===d||!1===d)return!0;if(!Array.isArray(d)||0===d.length)return!1;switch(d[0]){case "has":return 2<=d.length&&"$id"!==d[1]&&"$type"!==d[1];case "in":return 3<=d.length&&("string"!=
typeof d[1]||Array.isArray(d[2]));case "!in":case "!has":case "none":return!1;case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3e\x3d":case "\x3c":case "\x3c\x3d":return 3!==d.length||Array.isArray(d[1])||Array.isArray(d[2]);case "any":case "all":for(const f of d.slice(1))if(!zf(f)&&"boolean"!=typeof f)return!1;return!0;default:return!0}}function $c(d,f){if(null==d)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};zf(d)||(d=Vd(d));const k=qg(d,an,f);if("error"===k.result)throw Error(k.value.map(q=>
`${q.key}: ${q.message}`).join(", "));return{filter:(q,a,c)=>k.value.evaluate(q,a,{},c),needGeometry:Wf(d),getGlobalStateRefs:()=>Mf(k.value.expression)}}function Zd(d,f){return d<f?-1:d>f?1:0}function Wf(d){if(!Array.isArray(d))return!1;if("within"===d[0]||"distance"===d[0])return!0;for(let f=1;f<d.length;f++)if(Wf(d[f]))return!0;return!1}function Vd(d){var f;if(!d)return!0;const k=d[0];return 1>=d.length?"any"!==k:"\x3d\x3d"===k?jf(d[1],d[2],"\x3d\x3d"):"!\x3d"===k?ci(jf(d[1],d[2],"\x3d\x3d")):
"\x3c"===k||"\x3e"===k||"\x3c\x3d"===k||"\x3e\x3d"===k?jf(d[1],d[2],k):"any"===k?(f=d.slice(1),["any"].concat(f.map(Vd))):"all"===k?["all"].concat(d.slice(1).map(Vd)):"none"===k?["all"].concat(d.slice(1).map(Vd).map(ci)):"in"===k?bi(d[1],d.slice(2)):"!in"===k?ci(bi(d[1],d.slice(2))):"has"===k?Xj(d[1]):"!has"!==k||ci(Xj(d[1]))}function jf(d,f,k){switch(d){case "$type":return[`filter-type-${k}`,f];case "$id":return[`filter-id-${k}`,f];default:return[`filter-${k}`,d,f]}}function bi(d,f){if(0===f.length)return!1;
switch(d){case "$type":return["filter-type-in",["literal",f]];case "$id":return["filter-id-in",["literal",f]];default:return 200<f.length&&!f.some(k=>typeof k!=typeof f[0])?["filter-in-large",d,["literal",f.sort(Zd)]]:["filter-in-small",d,["literal",f]]}}function Xj(d){switch(d){case "$type":return!0;case "$id":return["filter-has-id"];default:return["filter-has",d]}}function ci(d){return["!",d]}function di(d){var f=typeof d;if("number"===f||"boolean"===f||"string"===f||null==d)return JSON.stringify(d);
if(Array.isArray(d)){f="[";for(var k of d)f+=`${di(k)},`;return`${f}]`}k=Object.keys(d).sort();f="{";for(let q=0;q<k.length;q++)f+=`${JSON.stringify(k[q])}:${di(d[k[q]])},`;return`${f}}`}function vj(d){const f=d.value;return f?[new m(d.key,f,"constants have been deprecated as of v8")]:[]}function Od(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Nf(d){if(Array.isArray(d))return d.map(Nf);if(d instanceof Object&&!(d instanceof Number||d instanceof String||
d instanceof Boolean)){const f={};for(const k in d)f[k]=Nf(d[k]);return f}return Od(d)}function Ue(d){const f=d.key,k=d.value,q=d.valueSpec||{},a=d.objectElementValidators||{},c=d.style,e=d.styleSpec;d=d.validateSpec;let h=[];var l=vd(k);if("object"!==l)return[new m(f,k,`object expected, ${l} found`)];for(const w in k){var p=w.split(".")[0];l=de(q,p)||q["*"];if(de(a,p))p=a[p];else if(de(q,p))p=d;else if(a["*"])p=a["*"];else{if(!q["*"]){h.push(new m(f,k[w],`unknown property "${w}"`));continue}p=d}h=
h.concat(p({key:(f?`${f}.`:f)+w,value:k[w],valueSpec:l,style:c,styleSpec:e,object:k,objectKey:w,validateSpec:d},k))}for(const w in q)a[w]||q[w].required&&void 0===q[w].default&&void 0===k[w]&&h.push(new m(f,k,`missing required property "${w}"`));return h}function th(d){const f=d.value;var k=d.valueSpec;const q=d.style,a=d.styleSpec,c=d.key,e=d.arrayElementValidator||d.validateSpec;if("array"!==vd(f))return[new m(c,f,`array expected, ${vd(f)} found`)];if(k.length&&f.length!==k.length)return[new m(c,
f,`array length ${k.length} expected, length ${f.length} found`)];if(k["min-length"]&&f.length<k["min-length"])return[new m(c,f,`array length at least ${k["min-length"]} expected, length ${f.length} found`)];let h={type:k.value,values:k.values};7>a.$version&&(h.function=k.function);"object"===vd(k.value)&&(h=k.value);k=[];for(let l=0;l<f.length;l++)k=k.concat(e({array:f,arrayIndex:l,value:f[l],valueSpec:h,validateSpec:d.validateSpec,style:q,styleSpec:a,key:`${c}[${l}]`}));return k}function Di(d){const f=
d.key,k=d.value;d=d.valueSpec;let q=vd(k);return"number"===q&&k!=k&&(q="NaN"),"number"!==q?[new m(f,k,`number expected, ${q} found`)]:"minimum"in d&&k<d.minimum?[new m(f,k,`${k} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&k>d.maximum?[new m(f,k,`${k} is greater than the maximum value ${d.maximum}`)]:[]}function cj(d){function f(D){let H=[];const I=D.value,L=D.key;if("array"!==vd(I))return[new m(L,I,`array expected, ${vd(I)} found`)];if(2!==I.length)return[new m(L,I,`array length 2 expected, length ${I.length} found`)];
if(x){if("object"!==vd(I[0]))return[new m(L,I,`object expected, ${vd(I[0])} found`)];if(void 0===I[0].zoom)return[new m(L,I,"object stop key must have zoom")];if(void 0===I[0].value)return[new m(L,I,"object stop key must have value")];if(h&&h>Od(I[0].zoom))return[new m(L,I[0].zoom,"stop zoom values must appear in ascending order")];Od(I[0].zoom)!==h&&(h=Od(I[0].zoom),e=void 0,l={});H=H.concat(Ue({key:`${L}[0]`,value:I[0],valueSpec:{zoom:{}},validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec,
objectElementValidators:{zoom:Di,value:k}}))}else H=H.concat(k({key:`${L}[0]`,value:I[0],validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec},I));return Ff(Nf(I[1]))?H.concat([new m(`${L}[1]`,I[1],"expressions are not allowed in function stops.")]):H.concat(D.validateSpec({key:`${L}[1]`,value:I[1],valueSpec:q,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec}))}function k(D,H){var I=vd(D.value);const L=Od(D.value);H=null!==D.value?D.value:H;if(c){if(I!==c)return[new m(D.key,
H,`${I} stop domain type must match previous stop domain type ${c}`)]}else c=I;return"number"!==I&&"string"!==I&&"boolean"!==I?[new m(D.key,H,"stop domain value must be a number, string, or boolean")]:"number"!==I&&"categorical"!==a?(I=`number expected, ${I} found`,$h(q)&&void 0===a&&(I+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new m(D.key,H,I)]):"categorical"!==a||"number"!==I||isFinite(L)&&Math.floor(L)===L?"categorical"!==a&&"number"===I&&void 0!==e&&
L<e?[new m(D.key,H,"stop domain values must appear in ascending order")]:(e=L,"categorical"===a&&L in l?[new m(D.key,H,"stop domain values must be unique")]:(l[L]=!0,[])):[new m(D.key,H,`integer expected, found ${L}`)]}const q=d.valueSpec,a=Od(d.value.type);let c,e,h,l={};const p="categorical"!==a&&void 0===d.value.property,w=!p,x="array"===vd(d.value.stops)&&"array"===vd(d.value.stops[0])&&"object"===vd(d.value.stops[0][0]),y=Ue({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,
style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(D){if("identity"===a)return[new m(D.key,D.value,'identity function may not have a "stops" property')];let H=[];const I=D.value;return H=H.concat(th({key:D.key,value:I,valueSpec:D.valueSpec,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec,arrayElementValidator:f})),"array"===vd(I)&&0===I.length&&H.push(new m(D.key,I,"array must have at least one stop")),H},default:function(D){return D.validateSpec({key:D.key,
value:D.value,valueSpec:q,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec})}}});return"identity"===a&&p&&y.push(new m(d.key,d.value,'missing required property "property"')),"identity"===a||d.value.stops||y.push(new m(d.key,d.value,'missing required property "stops"')),"exponential"===a&&d.valueSpec.expression&&!sh(d.valueSpec)&&y.push(new m(d.key,d.value,"exponential functions not supported")),8<=d.styleSpec.$version&&(w&&!$h(d.valueSpec)?y.push(new m(d.key,d.value,"property functions not supported")):
p&&!qk(d.valueSpec)&&y.push(new m(d.key,d.value,"zoom functions not supported"))),"categorical"!==a&&!x||void 0!==d.value.property||y.push(new m(d.key,d.value,'"property" property is required')),y}function Af(d){var f=("property"===d.expressionContext?kg:qg)(Nf(d.value),d.valueSpec);if("error"===f.result)return f.value.map(k=>new m(`${d.key}${k.key}`,d.value,k.message));f=f.value.expression||f.value._styleExpression.expression;if("property"===d.expressionContext&&"text-font"===d.propertyKey&&!f.outputDefined())return[new m(d.key,
d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===d.expressionContext&&"layout"===d.propertyType&&!Ud(f))return[new m(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===d.expressionContext&&!Ud(f))return[new m(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&0===d.expressionContext.indexOf("cluster")){if(!xi(f,
["zoom","feature-state"]))return[new m(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===d.expressionContext&&!Yg(f))return[new m(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ei(d){const f=d.key;d=d.value;const k=vd(d);return"string"!==k?[new m(f,d,`color expected, ${k} found`)]:Bb.parse(String(d))?[]:[new m(f,d,`color expected, "${d}" found`)]}
function Gf(d){const f=d.key,k=d.value;d=d.valueSpec;const q=[];return Array.isArray(d.values)?-1===d.values.indexOf(Od(k))&&q.push(new m(f,k,`expected one of [${d.values.join(", ")}], ${JSON.stringify(k)} found`)):-1===Object.keys(d.values).indexOf(Od(k))&&q.push(new m(f,k,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(k)} found`)),q}function Xf(d){return zf(Nf(d.value))?Af(ra({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):wj(d)}function wj(d){const f=d.value,
k=d.key;if("array"!==vd(f))return[new m(k,f,`array expected, ${vd(f)} found`)];var q=d.styleSpec;let a,c=[];if(1>f.length)return[new m(k,f,"filter array must have at least 1 element")];switch(c=c.concat(Gf({key:`${k}[0]`,value:f[0],valueSpec:q.filter_operator,style:d.style,styleSpec:d.styleSpec})),Od(f[0])){case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":2<=f.length&&"$type"===Od(f[1])&&c.push(new m(k,f,`"$type" cannot be use with operator "${f[0]}"`));case "\x3d\x3d":case "!\x3d":3!==f.length&&
c.push(new m(k,f,`filter array for operator "${f[0]}" must have 3 elements`));case "in":case "!in":2<=f.length&&(a=vd(f[1]),"string"!==a&&c.push(new m(`${k}[1]`,f[1],`string expected, ${a} found`)));for(let e=2;e<f.length;e++)a=vd(f[e]),"$type"===Od(f[1])?c=c.concat(Gf({key:`${k}[${e}]`,value:f[e],valueSpec:q.geometry_type,style:d.style,styleSpec:d.styleSpec})):"string"!==a&&"number"!==a&&"boolean"!==a&&c.push(new m(`${k}[${e}]`,f[e],`string, number, or boolean expected, ${a} found`));break;case "any":case "all":case "none":for(q=
1;q<f.length;q++)c=c.concat(wj({key:`${k}[${q}]`,value:f[q],style:d.style,styleSpec:d.styleSpec}));break;case "has":case "!has":a=vd(f[1]),2!==f.length?c.push(new m(k,f,`filter array for "${f[0]}" operator must have 2 elements`)):"string"!==a&&c.push(new m(`${k}[1]`,f[1],`string expected, ${a} found`))}return c}function Yf(d,f){const k=d.key,q=d.validateSpec,a=d.style,c=d.styleSpec,e=d.value,h=d.objectKey;var l=c[`${f}_${d.layerType}`];if(!l)return[];const p=h.match(/^(.*)-transition$/);if("paint"===
f&&p&&l[p[1]]&&l[p[1]].transition)return q({key:k,value:e,valueSpec:c.transition,style:a,styleSpec:c});l=d.valueSpec||l[h];if(!l)return[new m(k,e,`unknown property "${h}"`)];var w;if("string"===vd(e)&&$h(l)&&!l.tokens&&(w=/^{([^}]+)}$/.exec(e)))return[new m(k,e,`"${h}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(w[1])} }\`.`)];w=[];return"symbol"===d.layerType&&("text-field"===h&&a&&!a.glyphs&&w.push(new m(k,
e,'use of "text-field" requires a style "glyphs" property')),"text-font"===h&&Fg(Nf(e))&&"identity"===Od(e.type)&&w.push(new m(k,e,'"text-font" does not support identity functions'))),w.concat(q({key:d.key,value:e,valueSpec:l,style:a,styleSpec:c,expressionContext:"property",propertyType:f,propertyKey:h}))}function Ge(d){return Yf(d,"paint")}function Bf(d){return Yf(d,"layout")}function Ne(d){let f=[];const k=d.value,q=d.key;var a=d.style;const c=d.styleSpec;if("object"!==vd(k))return[new m(q,k,`object expected, ${vd(k)} found`)];
k.type||k.ref||f.push(new m(q,k,'either "type" or "ref" is required'));let e=Od(k.type);const h=Od(k.ref);if(k.id){var l=Od(k.id);for(let p=0;p<d.arrayIndex;p++){const w=a.layers[p];Od(w.id)===l&&f.push(new m(q,k.id,`duplicate layer id "${k.id}", previously used at line ${w.id.__line__}`))}}if("ref"in k){let p;["type","source","source-layer","filter","layout"].forEach(w=>{w in k&&f.push(new m(q,k[w],`"${w}" is prohibited for ref layers`))});a.layers.forEach(w=>{Od(w.id)===h&&(p=w)});p?p.ref?f.push(new m(q,
k.ref,"ref cannot reference another ref layer")):e=Od(p.type):f.push(new m(q,k.ref,`ref layer "${h}" not found`))}else"background"!==e&&(k.source?(l=(a=a.sources&&a.sources[k.source])&&Od(a.type),a?"vector"===l&&"raster"===e?f.push(new m(q,k.source,`layer "${k.id}" requires a raster source`)):"raster-dem"!==l&&"hillshade"===e||"raster-dem"!==l&&"color-relief"===e?f.push(new m(q,k.source,`layer "${k.id}" requires a raster-dem source`)):"raster"===l&&"raster"!==e?f.push(new m(q,k.source,`layer "${k.id}" requires a vector source`)):
"vector"!==l||k["source-layer"]?"raster-dem"===l&&"hillshade"!==e&&"color-relief"!==e?f.push(new m(q,k.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==e||!k.paint||!k.paint["line-gradient"]||"geojson"===l&&a.lineMetrics||f.push(new m(q,k,`layer "${k.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):f.push(new m(q,k,`layer "${k.id}" must specify a "source-layer"`)):f.push(new m(q,k.source,`source "${k.source}" not found`))):
f.push(new m(q,k,'missing required property "source"')));return f=f.concat(Ue({key:q,value:k,valueSpec:c.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${q}.type`,value:k.type,valueSpec:c.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:k,objectKey:"type"}),filter:Xf,layout:p=>Ue({layer:k,key:p.key,value:p.value,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":w=>
Bf(ra({layerType:e},w))}}),paint:p=>Ue({layer:k,key:p.key,value:p.value,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":w=>Ge(ra({layerType:e},w))}})}})),f}function Ig(d){const f=d.value;d=d.key;const k=vd(f);return"string"!==k?[new m(d,f,`string expected, ${k} found`)]:[]}function Jg(d){var f=d.value,k=d.key,q=d.styleSpec,a=d.style,c=d.validateSpec;if(!f.type)return[new m(k,f,'"type" is required')];var e=Od(f.type);let h;switch(e){case "vector":case "raster":return h=
Ue({key:k,value:f,valueSpec:q[`source_${e.replace("-","_")}`],style:d.style,styleSpec:q,objectElementValidators:Mm,validateSpec:c}),h;case "raster-dem":f={sourceName:k,value:f,style:d.style,styleSpec:q,validateSpec:c};var l;k=null!==(l=f.sourceName)&&void 0!==l?l:"";l=f.value;var p=f.styleSpec;d=p.source_raster_dem;q=f.style;a=[];c=vd(l);if(void 0===l)var w=a;else if("object"!==c)w=(a.push(new m("source_raster_dem",l,`object expected, ${c} found`)),a);else{c="custom"===Od(l.encoding);e=["redFactor",
"greenFactor","blueFactor","baseShift"];var x=f.value.encoding?`"${f.value.encoding}"`:"Default";for(w in l)!c&&e.includes(w)?a.push(new m(w,l[w],`In "${k}": "${w}" is only valid when "encoding" is set to "custom". ${x} encoding found`)):d[w]?a=a.concat(f.validateSpec({key:w,value:l[w],valueSpec:d[w],validateSpec:f.validateSpec,style:q,styleSpec:p})):a.push(new m(w,l[w],`unknown property "${w}"`));w=a}return h=w,h;case "geojson":if(h=Ue({key:k,value:f,valueSpec:q.source_geojson,style:a,styleSpec:q,
validateSpec:c,objectElementValidators:Mm}),f.cluster)for(p in f.clusterProperties){const [y,D]=f.clusterProperties[p];w="string"==typeof y?[y,["accumulated"],["get",p]]:y;h.push(...Af({key:`${k}.${p}.map`,value:D,expressionContext:"cluster-map"}));h.push(...Af({key:`${k}.${p}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return h;case "video":return Ue({key:k,value:f,valueSpec:q.source_video,style:a,validateSpec:c,styleSpec:q});case "image":return Ue({key:k,value:f,valueSpec:q.source_image,
style:a,validateSpec:c,styleSpec:q});case "canvas":return[new m(k,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gf({key:`${k}.type`,value:f.type,valueSpec:{values:"vector raster raster-dem geojson video image".split(" ")}})}}function bh(d){const f=d.value,k=d.styleSpec,q=k.light,a=d.style;let c=[];var e=vd(f);if(void 0===f)return c;if("object"!==e)return c=c.concat([new m("light",f,`object expected, ${e} found`)]),
c;for(const h in f)e=h.match(/^(.*)-transition$/),c=c.concat(e&&q[e[1]]&&q[e[1]].transition?d.validateSpec({key:h,value:f[h],valueSpec:k.transition,validateSpec:d.validateSpec,style:a,styleSpec:k}):q[h]?d.validateSpec({key:h,value:f[h],valueSpec:q[h],validateSpec:d.validateSpec,style:a,styleSpec:k}):[new m(h,f[h],`unknown property "${h}"`)]);return c}function jl(d){const f=d.value,k=d.styleSpec,q=k.sky,a=d.style;var c=vd(f);if(void 0===f)return[];if("object"!==c)return[new m("sky",f,`object expected, ${c} found`)];
c=[];for(const e in f)c=c.concat(q[e]?d.validateSpec({key:e,value:f[e],valueSpec:q[e],style:a,styleSpec:k}):[new m(e,f[e],`unknown property "${e}"`)]);return c}function Lb(d){const f=d.value,k=d.styleSpec,q=k.terrain,a=d.style;let c=[];const e=vd(f);if(void 0===f)return c;if("object"!==e)return c=c.concat([new m("terrain",f,`object expected, ${e} found`)]),c;for(const h in f)c=c.concat(q[h]?d.validateSpec({key:h,value:f[h],valueSpec:q[h],validateSpec:d.validateSpec,style:a,styleSpec:k}):[new m(h,
f[h],`unknown property "${h}"`)]);return c}function nd(d){let f=[];const k=d.value,q=d.key;if(Array.isArray(k)){const a=[],c=[];for(const e in k)k[e].id&&a.includes(k[e].id)&&f.push(new m(q,k,`all the sprites' ids must be unique, but ${k[e].id} is duplicated`)),a.push(k[e].id),k[e].url&&c.includes(k[e].url)&&f.push(new m(q,k,`all the sprites' URLs must be unique, but ${k[e].url} is duplicated`)),c.push(k[e].url),f=f.concat(Ue({key:`${q}[${e}]`,value:k[e],valueSpec:{id:{type:"string",required:!0},
url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return f}return Ig({key:q,value:k})}function ue(d){var f;return f=d.value,f&&f.constructor===Object?[]:[new m(d.key,d.value,`object expected, ${vd(d.value)} found`)]}function Xe(d){const f=d.value,k=d.valueSpec,q=d.styleSpec;return d.validateSpec=Xe,k.expression&&Fg(Od(f))?cj(d):k.expression&&Ff(Nf(f))?Af(d):k.type&&ul[k.type]?ul[k.type](d):Ue(ra({},d,{valueSpec:k.type?q[k.type]:k}))}function hc(d){const f=d.value,k=d.key;d=Ig(d);return d.length||
(-1===f.indexOf("{fontstack}")&&d.push(new m(k,f,'"glyphs" url must include a "{fontstack}" token')),-1===f.indexOf("{range}")&&d.push(new m(k,f,'"glyphs" url must include a "{range}" token'))),d}function kf(d,f=b){let k=[];return k=k.concat(Xe({key:"",value:d,valueSpec:f.$root,styleSpec:f,style:d,validateSpec:Xe,objectElementValidators:{glyphs:hc,"*":()=>[]}})),d.constants&&(k=k.concat(vj({key:"constants",value:d.constants}))),sg(k)}function Ed(d){return function(f){return d(Object.assign({},f,{validateSpec:Xe}))}}
function sg(d){return[].concat(d).sort((f,k)=>f.line-k.line)}function He(d){return function(...f){return sg(d.apply(this,f))}}function Eb(d,f){let k=!1;if(f&&f.length)for(const q of f)d.fire(new Ti(Error(q.message))),k=!0;return k}function Cb(d,f,k={}){if(aj[d])throw Error(`${d} is already registered.`);Object.defineProperty(f,"_classRegistryKey",{value:d,writeable:!1});aj[d]={klass:f,omit:k.omit||[],shallow:k.shallow||[]}}function kd(d){return d&&"undefined"!=typeof ArrayBuffer&&(d instanceof ArrayBuffer||
d.constructor&&"ArrayBuffer"===d.constructor.name)}function $f(d){if(null===d||"object"!=typeof d)var f=!1;else f=d.$name||d.constructor._classRegistryKey,f=!(!f||"Object"===f);return!f&&(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||kd(d)||Tc(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function sf(d,f){if($f(d))return(kd(d)||
Tc(d))&&f&&f.push(d),ArrayBuffer.isView(d)&&f&&f.push(d.buffer),d instanceof ImageData&&f&&f.push(d.data.buffer),d;if(Array.isArray(d)){var k=[];for(var q of d)k.push(sf(q,f));return k}if("object"!=typeof d)throw Error("can't serialize object of type "+typeof d);q=d.$name||d.constructor._classRegistryKey;if(!q)throw Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!aj[q])throw Error(`${q} is not registered.`);var {klass:a}=aj[q];const c=a.serialize?a.serialize(d,f):{};
if(a.serialize){if(f&&c===f[f.length-1])throw Error("statically serialized object won't survive transfer of $name property");}else{for(k in d)!d.hasOwnProperty(k)||0<=aj[q].omit.indexOf(k)||(a=d[k],c[k]=0<=aj[q].shallow.indexOf(k)?a:sf(a,f));d instanceof Error&&(c.message=d.message)}if(c.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==q&&(c.$name=q),c}function ld(d){if($f(d))return d;if(Array.isArray(d))return d.map(ld);if("object"!=typeof d)throw Error("can't deserialize object of type "+
typeof d);const f=d.$name||d.constructor._classRegistryKey||"Object";if(!aj[f])throw Error(`can't deserialize unregistered class ${f}`);var {klass:k}=aj[f];if(!k)throw Error(`can't deserialize unregistered class ${f}`);if(k.deserialize)return k.deserialize(d);k=Object.create(k.prototype);for(const q of Object.keys(d)){if("$name"===q)continue;const a=d[q];k[q]=0<=aj[f].shallow.indexOf(q)?a:ld(a)}return k}function Ld(d){for(const f of d)if(dd(f.charCodeAt(0)))return!0;return!1}function yd(d){for(const f of d)if(Nm.test(String.fromCodePoint(f.charCodeAt(0))))return!1;
return!0}function Md(d){d=d.map(f=>{try{return(new RegExp(`\\p{sc=${f}}`,"u")).source}catch(k){return null}}).filter(f=>f);return new RegExp(d.join("|"),"u")}function dd(d){return!(746!==d&&747!==d&&(4352>d||!(gd["CJK Compatibility Forms"](d)&&!(65097<=d&&65103>=d)||gd["CJK Compatibility"](d)||gd["CJK Strokes"](d)||!(!gd["CJK Symbols and Punctuation"](d)||12296<=d&&12305>=d||12308<=d&&12319>=d||12336===d)||gd["Enclosed CJK Letters and Months"](d)||gd["Ideographic Description Characters"](d)||gd.Kanbun(d)||
gd.Katakana(d)&&12540!==d||!(!gd["Halfwidth and Fullwidth Forms"](d)||65288===d||65289===d||65293===d||65306<=d&&65310>=d||65339===d||65341===d||65343===d||65371<=d&&65503>=d||65507===d||65512<=d&&65519>=d)||!(!gd["Small Form Variants"](d)||65112<=d&&65118>=d||65123<=d&&65126>=d)||gd["Vertical Forms"](d)||gd["Yijing Hexagram Symbols"](d)||/\p{sc=Cans}/u.test(String.fromCodePoint(d))||/\p{sc=Hang}/u.test(String.fromCodePoint(d))||Tm.test(String.fromCodePoint(d)))))}function ed(d){var f;(f=dd(d))||
(f=!!(gd["Latin-1 Supplement"](d)&&(167===d||169===d||174===d||177===d||188===d||189===d||190===d||215===d||247===d)||gd["General Punctuation"](d)&&(8214===d||8224===d||8225===d||8240===d||8241===d||8251===d||8252===d||8258===d||8263===d||8264===d||8265===d||8273===d)||gd["Letterlike Symbols"](d)||gd["Number Forms"](d)||gd["Miscellaneous Technical"](d)&&(8960<=d&&8967>=d||8972<=d&&8991>=d||8996<=d&&9E3>=d||9003===d||9085<=d&&9114>=d||9150<=d&&9165>=d||9167===d||9169<=d&&9179>=d||9186<=d&&9215>=d)||
gd["Control Pictures"](d)&&9251!==d||gd["Optical Character Recognition"](d)||gd["Enclosed Alphanumerics"](d)||gd["Geometric Shapes"](d)||gd["Miscellaneous Symbols"](d)&&!(9754<=d&&9759>=d)||gd["Miscellaneous Symbols and Arrows"](d)&&(11026<=d&&11055>=d||11088<=d&&11097>=d||11192<=d&&11243>=d)||gd["CJK Symbols and Punctuation"](d)||gd.Katakana(d)||gd["Private Use Area"](d)||gd["CJK Compatibility Forms"](d)||gd["Small Form Variants"](d)||gd["Halfwidth and Fullwidth Forms"](d)||8734===d||8756===d||8757===
d||9984<=d&&10087>=d||10102<=d&&10131>=d||65532===d||65533===d));return!f}function Jd(d){a:{var f="loaded"===yi.getRTLTextPluginStatus();for(const k of d)if(d=k.charCodeAt(0),!f&&jh.test(String.fromCodePoint(d))||2304<=d&&3583>=d||3840<=d&&4255>=d||gd.Khmer(d)){f=!1;break a}f=!0}return f}function ee(d,f=1){let k=0,q=0;return{members:d.map(a=>{const c=am[a.type].BYTES_PER_ELEMENT,e=k=Ie(k,Math.max(f,c)),h=a.components||1;return q=Math.max(q,c),k+=c*h,{name:a.name,type:a.type,components:h,offset:e}}),
size:Ie(k,Math.max(q,f)),alignment:f}}function Ie(d,f){return Math.ceil(d/f)*f}function Ze(d,f){return 256*xc(Math.floor(d),0,255)+xc(Math.floor(f),0,255)}function Da(d){const f=+d;return!isNaN(f)&&f<=Number.MAX_SAFE_INTEGER?f:he(String(d))}function Fi(d,f,k,q){for(;k<q;){const a=d[k+q>>1];let c=k-1,e=q+1;for(;;){do c++;while(d[c]<a);do e--;while(d[e]>a);if(c>=e)break;tg(d,c,e);tg(f,3*c,3*e);tg(f,3*c+1,3*e+1);tg(f,3*c+2,3*e+2)}e-k<q-e?(Fi(d,f,k,e),k=e+1):(Fi(d,f,e+1,q),q=e)}}function tg(d,f,k){const q=
d[f];d[f]=d[k];d[k]=q}function fe(d){return[Ze(255*d.r,255*d.g),Ze(255*d.b,255*d.a)]}function Ad(d,f,k){const q={color:{source:Qk,composite:ym},number:{source:Uj,composite:Qk}};return(d={"line-pattern":{source:Ik,composite:Ik},"fill-pattern":{source:Ik,composite:Ik},"fill-extrusion-pattern":{source:Ik,composite:Ik},"line-dasharray":{source:Il,composite:Il}}[d])&&d[k]||q[f][k]}function ye(d){const f=8192/d.extent;d=d.loadGeometry();for(let k=0;k<d.length;k++){const q=d[k];for(let a=0;a<q.length;a++){const c=
q[a],e=Math.round(c.x*f),h=Math.round(c.y*f);c.x=xc(e,Yj,lm);c.y=xc(h,Yj,lm);(e<c.x||e>c.x+1||h<c.y||h>c.y+1)&&Ma("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function dg(d,f){return{type:d.type,id:d.id,properties:d.properties,geometry:f?ye(d):[]}}function tf(d,f){for(var k=0;k<d.length;k++)if(Ng(f,d[k]))return!0;for(k=0;k<f.length;k++)if(Ng(d,f[k]))return!0;return!!af(d,f)}function Ce(d,f,k){return!!Ng(d,f)||!!Pe(f,d,k)}function Hf(d,f){if(1===d.length)return ge(f,
d[0]);for(var k=0;k<f.length;k++){const q=f[k];for(let a=0;a<q.length;a++)if(Ng(d,q[a]))return!0}for(k=0;k<d.length;k++)if(ge(f,d[k]))return!0;for(k=0;k<f.length;k++)if(af(d,f[k]))return!0;return!1}function af(d,f){if(0===d.length||0===f.length)return!1;for(let e=0;e<d.length-1;e++){const h=d[e],l=d[e+1];for(let p=0;p<f.length-1;p++){var k=h,q=l,a=f[p],c=f[p+1];if(jb(k,a,c)!==jb(q,a,c)&&jb(k,q,a)!==jb(k,q,c))return!0}}return!1}function Pe(d,f,k){k*=k;if(1===f.length)return d.distSqr(f[0])<k;for(let q=
1;q<f.length;q++)if(ug(d,f[q-1],f[q])<k)return!0;return!1}function ug(d,f,k){var q=f.distSqr(k);if(0===q)return d.distSqr(f);q=((d.x-f.x)*(k.x-f.x)+(d.y-f.y)*(k.y-f.y))/q;return d.distSqr(0>q?f:1<q?k:k.sub(f)._mult(q)._add(f))}function ge(d,f){let k,q,a,c=!1;for(let e=0;e<d.length;e++){k=d[e];for(let h=0,l=k.length-1;h<k.length;l=h++)q=k[h],a=k[l],q.y>f.y!=a.y>f.y&&f.x<(a.x-q.x)*(f.y-q.y)/(a.y-q.y)+q.x&&(c=!c)}return c}function Ng(d,f){let k=!1;for(let q=0,a=d.length-1;q<d.length;a=q++){const c=d[q],
e=d[a];c.y>f.y!=e.y>f.y&&f.x<(e.x-c.x)*(f.y-c.y)/(e.y-c.y)+c.x&&(k=!k)}return k}function Qe(d,f,k){const q=f.paint.get(d).value;return"constant"===q.kind?q.value:k.programConfigurations.get(f.id).getMaxValue(d)}function eh(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function Og(d,f,k,q,a){if(!f[0]&&!f[1])return d;f=ta.convert(f)._mult(a);"viewport"===k&&f._rotate(-q);k=[];for(q=0;q<d.length;q++)k.push(d[q].sub(f));return k}function fi({queryGeometry:d,size:f},k){return Ce(d,k,f)}function yj({queryGeometry:d,
size:f,transform:k,unwrappedTileID:q,getElevation:a},c){return Ce(d,c,f*(k.projectTileCoordinates(c.x,c.y,q,a).signedDistanceFromCamera/k.cameraToCenterDistance))}function $e({queryGeometry:d,size:f,transform:k,unwrappedTileID:q,getElevation:a},c){const e=k.projectTileCoordinates(c.x,c.y,q,a).signedDistanceFromCamera;f*=k.cameraToCenterDistance/e;return Ce(d,Hi(c,k,q,a),f)}function Pg({queryGeometry:d,size:f,transform:k,unwrappedTileID:q,getElevation:a},c){return Ce(d,Hi(c,k,q,a),f)}function Gi({queryGeometry:d,
size:f,transform:k,unwrappedTileID:q,getElevation:a,pitchAlignment:c="map",pitchScale:e="map"},h){c="map"===c?"map"===e?fi:yj:"map"===e?$e:Pg;d={queryGeometry:d,size:f,transform:k,unwrappedTileID:q,getElevation:a};for(const l of h)for(const p of l)if(c(d,p))return!0;return!1}function Hi(d,f,k,q){d=f.projectTileCoordinates(d.x,d.y,k,q).point;return new ta((.5*d.x+.5)*f.width,(.5*-d.y+.5)*f.height)}function eg(d,{width:f,height:k},q,a){if(a)if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);
else{if(a.length!==f*k*q)throw new RangeError(`mismatched image size. expected: ${a.length} but got: ${f*k*q}`);}else a=new Uint8Array(f*k*q);return d.width=f,d.height=k,d.data=a,d}function gi(d,{width:f,height:k},q){if(f!==d.width||k!==d.height){var a=eg({},{width:f,height:k},q);hi(d,a,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,f),height:Math.min(d.height,k)},q);d.width=f;d.height=k;d.data=a.data}}function hi(d,f,k,q,a,c){if(0===a.width||0===a.height)return f;if(a.width>d.width||a.height>d.height||
k.x>d.width-a.width||k.y>d.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>f.width||a.height>f.height||q.x>f.width-a.width||q.y>f.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const e=d.data,h=f.data;if(e===h)throw Error("srcData equals dstData, so image is already copied");for(let l=0;l<a.height;l++){const p=((k.y+l)*d.width+k.x)*c,w=((q.y+l)*f.width+q.x)*c;for(let x=0;x<a.width*c;x++)h[w+x]=e[p+x]}return f}
function zj(d){const f={},k=d.resolution||256,q=d.clips?d.clips.length:1,a=d.image||new Mg({width:k,height:q});if(0!=Math.log(k)/Math.LN2%1)throw Error(`width is not a power of 2 - ${k}`);const c=(e,h,l)=>{f[d.evaluationKey]=l;l=d.expression.evaluate(f);a.setPixel(e/4/k,h/4,l)};if(d.clips)for(let e=0,h=0;e<q;++e,h+=4*k)for(let l=0,p=0;l<k;l++,p+=4){const w=l/(k-1),{start:x,end:y}=d.clips[e];c(h,p,x*(1-w)+y*w)}else for(let e=0,h=0;e<k;e++,h+=4)c(0,h,e/(k-1));return a}function wh(d,f){const k=f[0],
q=f[1],a=f[2],c=Math.min(k,q,a);d=Math.round((d+f[3])/c);return{r:Math.floor(d*c/k)%256,g:Math.floor(d*c/q)%256,b:Math.floor(d*c/a)%256}}function Wc(d,f,k){k=k.patternDependencies;let q=!1;for(const a of f)f=a.paint.get(`${d}-pattern`),f.isConstant()||(q=!0),(f=f.constantOr(null))&&(q=!0,k[f.to]=!0,k[f.from]=!0);return q}function xh(d,f,k,q,a){({zoom:q}=q);const c=a.patternDependencies;for(const h of f){var e=h.paint.get(`${d}-pattern`).value;if("constant"!==e.kind){f=e.evaluate({zoom:q-1},k,{},a.availableImages);
let l=e.evaluate({zoom:q},k,{},a.availableImages);e=e.evaluate({zoom:q+1},k,{},a.availableImages);f=f&&f.name?f.name:f;l=l&&l.name?l.name:l;e=e&&e.name?e.name:e;c[f]=!0;c[l]=!0;c[e]=!0;k.patterns[h.id]={min:f,mid:l,max:e}}}return k}function Re(d,f,k,q,a){let c,e=0;for(let h=f,l=k-q;h<k;h+=q)e+=(d[l]-d[h])*(d[h+1]+d[l+1]),l=h;if(a===0<e)for(;f<k;f+=q)c=Mi(f/q|0,d[f],d[f+1],c);else for(k-=q;k>=f;k-=q)c=Mi(k/q|0,d[k],d[k+1],c);return c&&Ji(c,c.next)&&(hj(c),c=c.next),c}function fj(d,f){if(!d)return d;
f||(f=d);let k=d;do if(d=!1,k.steiner||!Ji(k,k.next)&&0!==ke(k.prev,k,k.next))k=k.next;else{if(hj(k),k=f=k.prev,k===k.next)break;d=!0}while(d||k!==f);return f}function zd(d,f,k,q,a,c,e){if(d){if(!e&&c){var h=d,l=h;do 0===l.z&&(l.z=je(l.x,l.y,q,a,c)),l.prevZ=l.prev,l=l.nextZ=l.next;while(l!==h);l.prevZ.nextZ=null;l.prevZ=null;h=l;var p=1;do{var w=void 0,x=h,y=h=null;for(l=0;x;){l++;var D=x,H=0;for(var I=0;I<p&&(H++,D=D.nextZ,D);I++);for(I=p;0<H||0<I&&D;)0!==H&&(0===I||!D||x.z<=D.z)?(w=x,x=x.nextZ,
H--):(w=D,D=D.nextZ,I--),y?y.nextZ=w:h=w,w.prevZ=y,y=w;x=D}y.nextZ=null;p*=2}while(1<l)}for(w=d;d.prev!==d.next;){h=d.prev;l=d.next;if(c)a:{var L=d,Y=q,P=a,Z=c;p=L.prev;x=L.next;if(0<=ke(p,L,x)){p=!1;break a}y=p.x;D=L.x;H=x.x;I=p.y;var aa=L.y,T=x.y,ha=Math.min(y,D,H),Ca=Math.min(I,aa,T),xa=Math.max(y,D,H),Ha=Math.max(I,aa,T);const Fa=je(ha,Ca,Y,P,Z);Y=je(xa,Ha,Y,P,Z);P=L.prevZ;for(L=L.nextZ;P&&P.z>=Fa&&L&&L.z<=Y;){if(P.x>=ha&&P.x<=xa&&P.y>=Ca&&P.y<=Ha&&P!==p&&P!==x&&gj(y,I,D,aa,H,T,P.x,P.y)&&0<=ke(P.prev,
P,P.next)||(P=P.prevZ,L.x>=ha&&L.x<=xa&&L.y>=Ca&&L.y<=Ha&&L!==p&&L!==x&&gj(y,I,D,aa,H,T,L.x,L.y)&&0<=ke(L.prev,L,L.next))){p=!1;break a}L=L.nextZ}for(;P&&P.z>=Fa;){if(P.x>=ha&&P.x<=xa&&P.y>=Ca&&P.y<=Ha&&P!==p&&P!==x&&gj(y,I,D,aa,H,T,P.x,P.y)&&0<=ke(P.prev,P,P.next)){p=!1;break a}P=P.prevZ}for(;L&&L.z<=Y;){if(L.x>=ha&&L.x<=xa&&L.y>=Ca&&L.y<=Ha&&L!==p&&L!==x&&gj(y,I,D,aa,H,T,L.x,L.y)&&0<=ke(L.prev,L,L.next)){p=!1;break a}L=L.nextZ}p=!0}else a:if(aa=d,p=aa.prev,I=aa.next,0<=ke(p,aa,I))p=!1;else{x=p.x;
y=aa.x;D=I.x;H=p.y;aa=aa.y;T=I.y;ha=Math.min(x,y,D);Ca=Math.min(H,aa,T);xa=Math.max(x,y,D);Ha=Math.max(H,aa,T);for(I=I.next;I!==p;){if(I.x>=ha&&I.x<=xa&&I.y>=Ca&&I.y<=Ha&&gj(x,H,y,aa,D,T,I.x,I.y)&&0<=ke(I.prev,I,I.next)){p=!1;break a}I=I.next}p=!0}if(p)f.push(h.i,d.i,l.i),hj(d),w=d=l.next;else if((d=l)===w){if(e)if(1===e){d=fj(d);e=f;w=d;do h=w.prev,l=w.next.next,!Ji(h,l)&&Nh(h,w,w.next,l)&&Oh(h,l)&&Oh(l,h)&&(e.push(h.i,w.i,l.i),hj(w),hj(w.next),w=d=l),w=w.next;while(w!==d);d=fj(w);zd(d,f,k,q,a,c,
2)}else{if(2===e)a:{e=d;do{for(w=e.next.next;w!==e.prev;){if(e.i!==w.i&&Qg(e,w)){d=Ki(e,w);e=fj(e,e.next);d=fj(d,d.next);zd(e,f,k,q,a,c,0);zd(d,f,k,q,a,c,0);break a}w=w.next}e=e.next}while(e!==d)}}else zd(fj(d),f,k,q,a,c,1);break}}}}function lf(d,f){let k=d.x-f.x;return 0===k&&(k=d.y-f.y,0===k)&&(k=(d.next.y-d.y)/(d.next.x-d.x)-(f.next.y-f.y)/(f.next.x-f.x)),k}function Ii(d,f){const k=function(q,a){let c=a;const e=q.x,h=q.y;let l,p=-1/0;if(Ji(q,c))return c;do{if(Ji(q,c.next))return c.next;if(h<=c.y&&
h>=c.next.y&&c.next.y!==c.y){var w=c.x+(h-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(w<=e&&w>p&&(p=w,l=c.x<c.next.x?c:c.next,w===e))return l}c=c.next}while(c!==a);if(!l)return null;a=l;w=l.x;const x=l.y;let y=1/0;c=l;do{if(e>=c.x&&c.x>=w&&e!==c.x&&Zj(h<x?e:p,h,w,x,h<x?p:e,h,c.x,c.y)){const I=Math.abs(h-c.y)/(e-c.x);var D;if((D=Oh(c,q))&&!(D=I<y)&&(D=I===y)&&!(D=c.x>l.x)&&(D=c.x===l.x)){D=l;var H=c;D=0>ke(D.prev,D,H.prev)&&0>ke(H.next,D,D.next)}D&&(l=c,y=I)}c=c.next}while(c!==a);return l}(d,f);if(!k)return f;
d=Ki(k,d);return fj(d,d.next),fj(k,k.next)}function je(d,f,k,q,a){return 1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-k)*a|0)|d<<8))|d<<4))|d<<2))|d<<1)|(1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-q)*a|0)|f<<8))|f<<4))|f<<2))|f<<1))<<1}function Zj(d,f,k,q,a,c,e,h){return(a-e)*(f-h)>=(d-e)*(c-h)&&(d-e)*(q-h)>=(k-e)*(f-h)&&(k-e)*(c-h)>=(a-e)*(q-h)}function gj(d,f,k,q,a,c,e,h){return!(d===e&&f===h)&&Zj(d,f,k,q,a,c,e,h)}function Qg(d,f){return d.next.i!==f.i&&d.prev.i!==
f.i&&!function(k,q){let a=k;do{if(a.i!==k.i&&a.next.i!==k.i&&a.i!==q.i&&a.next.i!==q.i&&Nh(a,a.next,k,q))return!0;a=a.next}while(a!==k);return!1}(d,f)&&(Oh(d,f)&&Oh(f,d)&&function(k,q){let a=k,c=!1;const e=(k.x+q.x)/2;q=(k.y+q.y)/2;do a.y>q!=a.next.y>q&&a.next.y!==a.y&&e<(a.next.x-a.x)*(q-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==k);return c}(d,f)&&(ke(d.prev,d,f.prev)||ke(d,f.prev,f))||Ji(d,f)&&0<ke(d.prev,d,d.next)&&0<ke(f.prev,f,f.next))}function ke(d,f,k){return(f.y-d.y)*(k.x-f.x)-(f.x-
d.x)*(k.y-f.y)}function Ji(d,f){return d.x===f.x&&d.y===f.y}function Nh(d,f,k,q){const a=Qf(ke(d,f,k)),c=Qf(ke(d,f,q)),e=Qf(ke(k,q,d)),h=Qf(ke(k,q,f));return a!==c&&e!==h||!(0!==a||!fh(d,k,f))||!(0!==c||!fh(d,q,f))||!(0!==e||!fh(k,d,q))||!(0!==h||!fh(k,f,q))}function fh(d,f,k){return f.x<=Math.max(d.x,k.x)&&f.x>=Math.min(d.x,k.x)&&f.y<=Math.max(d.y,k.y)&&f.y>=Math.min(d.y,k.y)}function Qf(d){return 0<d?1:0>d?-1:0}function Oh(d,f){return 0>ke(d.prev,d,d.next)?0<=ke(d,f,d.next)&&0<=ke(d,d.prev,f):0>
ke(d,f,d.prev)||0>ke(d,d.next,f)}function Ki(d,f){const k=Aj(d.i,d.x,d.y),q=Aj(f.i,f.x,f.y),a=d.next,c=f.prev;return d.next=f,f.prev=d,k.next=a,a.prev=k,q.next=k,k.prev=q,c.next=q,q.prev=c,q}function Mi(d,f,k,q){d=Aj(d,f,k);return q?(d.next=q.next,d.prev=q,q.next.prev=d,q.next=d):(d.prev=d,d.next=d),d}function hj(d){d.next.prev=d.prev;d.prev.next=d.next;d.prevZ&&(d.prevZ.nextZ=d.nextZ);d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Aj(d,f,k){return{i:d,x:f,y:k,prev:null,next:null,z:0,prevZ:null,nextZ:null,
steiner:!1}}function uf(d,f,k,q=!0){return(new xg(k,f)).subdividePolygonInternal(d,q)}function Ph(d,f,k=!1){if(!d||1>d.length||2>d.length)return[];var q=d[0],a=d[d.length-1];a=k&&(q.x!==a.x||q.y!==a.y);if(2>f)return a?[...d,d[0]]:[...d];f=Math.floor(8192/f);k=[];k.push(new ta(d[0].x,d[0].y));q=d.length;a=a?q:q-1;for(let w=0;w<a;w++){var c=d[w],e=w<q-1?d[w+1]:d[0],h=c.x,l=c.y;c=e.x;e=e.y;const x=h!==c,y=l!==e;if(!x&&!y)continue;const D=c-h,H=e-l,I=Math.abs(D),L=Math.abs(H);for(;;){var p=0<D?(Math.floor(h/
f)+1)*f:(Math.ceil(h/f)-1)*f;const Y=0<H?(Math.floor(l/f)+1)*f:(Math.ceil(l/f)-1)*f,P=Math.abs(h-p),Z=Math.abs(l-Y),aa=Math.abs(l-e),T=x?P/I:Number.POSITIVE_INFINITY,ha=y?Z/L:Number.POSITIVE_INFINITY;if((Math.abs(h-c)<=P||!x)&&(aa<=Z||!y))break;T<ha&&x||!y?(h=p,l+=H*T,p=new ta(h,Math.round(l)),k[k.length-1].x===p.x&&k[k.length-1].y===p.y||k.push(p)):(h+=D*ha,l=Y,p=new ta(Math.round(h),l),k[k.length-1].x===p.x&&k[k.length-1].y===p.y||k.push(p))}c=new ta(c,e);k[k.length-1].x===c.x&&k[k.length-1].y===
c.y||k.push(c)}return k}function Cj(d,f,k,q,a,c,e,h,l){const p=a.length/2;var w=e&&h&&l;if(p<Ve.MAX_VERTEX_ARRAY_LENGTH){f=f.prepareSegment(p,k,q);const x=f.vertexLength;for(let H=0;H<c.length;H+=3)q.emplaceBack(x+c[H],x+c[H+1],x+c[H+2]);let y,D;f.vertexLength+=p;f.primitiveLength+=c.length/3;w&&(D=e.prepareSegment(p,k,h),y=D.vertexLength,D.vertexLength+=p);for(k=0;k<a.length;k+=2)d(a[k],a[k+1]);if(w)for(d=0;d<l.length;d++){a=l[d];for(w=1;w<a.length;w+=2)h.emplaceBack(y+a[w-1],y+a[w]);D.primitiveLength+=
a.length/2}}else!function(x,y,D,H,I,L){const Y=[];for(var P=0;P<H.length/2;P++)Y.push(-1);P={count:0};let Z=0,aa=x.getOrCreateLatestSegment(y,D),T=aa.vertexLength;for(let Ha=2;Ha<I.length;Ha+=3){var ha=I[Ha-2],Ca=I[Ha-1],xa=I[Ha];let Fa=Y[ha]<Z,Ra=Y[Ca]<Z,Ja=Y[xa]<Z;aa.vertexLength+((Fa?1:0)+(Ra?1:0)+(Ja?1:0))>Ve.MAX_VERTEX_ARRAY_LENGTH&&(aa=x.createNewSegment(y,D),Z=P.count,Fa=!0,Ra=!0,Ja=!0,T=0);ha=yh(Y,H,L,P,ha,Fa,aa);Ca=yh(Y,H,L,P,Ca,Ra,aa);xa=yh(Y,H,L,P,xa,Ja,aa);D.emplaceBack(T+ha-Z,T+Ca-Z,
T+xa-Z);aa.primitiveLength++}}(f,k,q,a,c,d),w&&function(x,y,D,H,I,L){const Y=[];for(var P=0;P<H.length/2;P++)Y.push(-1);P={count:0};let Z=0,aa=x.getOrCreateLatestSegment(y,D),T=aa.vertexLength;for(let xa=0;xa<I.length;xa++){const Ha=I[xa];for(let Fa=1;Fa<I[xa].length;Fa+=2){var ha=Ha[Fa-1],Ca=Ha[Fa];let Ra=Y[ha]<Z,Ja=Y[Ca]<Z;aa.vertexLength+((Ra?1:0)+(Ja?1:0))>Ve.MAX_VERTEX_ARRAY_LENGTH&&(aa=x.createNewSegment(y,D),Z=P.count,Ra=!0,Ja=!0,T=0);ha=yh(Y,H,L,P,ha,Ra,aa);Ca=yh(Y,H,L,P,Ca,Ja,aa);D.emplaceBack(T+
ha-Z,T+Ca-Z);aa.primitiveLength++}}}(e,k,h,a,l,d),f.forceNewSegmentOnNextPrepare(),null==e||e.forceNewSegmentOnNextPrepare()}function yh(d,f,k,q,a,c,e){return c?(c=q.count,k(f[2*a],f[2*a+1]),d[a]=q.count,q.count++,e.vertexLength++,c):d[a]}function Qh(d,f,k){if(1===d)f.id=k.readVarint();else if(2===d)for(d=k.readVarint()+k.pos;k.pos<d;){const q=f._keys[k.readVarint()],a=f._values[k.readVarint()];f.properties[q]=a}else 3===d?f.type=k.readVarint():4===d&&(f._geometry=k.pos)}function vg(d,f,k){if(15===
d)f.version=k.readVarint();else if(1===d)f.name=k.readString();else if(5===d)f.extent=k.readVarint();else if(2===d)f._features.push(k.pos);else if(3===d)f._keys.push(k.readString());else if(4===d){d=f._values;f=d.push;var q=null;const a=k.readVarint()+k.pos;for(;k.pos<a;)q=k.readVarint()>>3,q=1===q?k.readString():2===q?k.readFloat():3===q?k.readDouble():4===q?k.readVarint64():5===q?k.readVarint():6===q?k.readSVarint():7===q?k.readBoolean():null;if(null==q)throw Error("unknown feature value");f.call(d,
q)}}function Nd(d,f,k){3===d&&(d=new $d(k,k.readVarint()+k.pos),d.length&&(f[d.name]=d))}function vf(d,f,k,q,a,c,e,h){d.emplaceBack(f,k,2*Math.floor(q*wf)+e,a*wf*2,c*wf*2,Math.round(h))}function wg(d,f){for(let k=0;k<f.length;k++){const q=f[k];k===f.length-1&&f[0].x===q.x&&f[0].y===q.y||(d.x+=q.x,d.y+=q.y,d.sampleCount++)}}function Ni(d){return d.every(f=>0>f.x)||d.every(f=>8192<f.x)||d.every(f=>0>f.y)||d.every(f=>8192<f.y)}function gg(d,f){return d.x*f.x+d.y*f.y}function ii(d,f){if(1===d.length){var k=
0;const p=f[k++];let w;for(;!w||p.equals(w);)if(w=f[k++],!w)return 1/0;for(;k<f.length;k++){var q=f[k],a=d[0],c=w.sub(p),e=q.sub(p),h=a.sub(p);a=gg(c,c);const x=gg(c,e);var l=gg(e,e);c=gg(h,c);e=gg(h,e);h=a*l-x*x;l=(l*c-x*e)/h;a=(a*e-x*c)/h;q=p.z*(1-l-a)+w.z*l+q.z*a;if(isFinite(q))return q}return 1/0}d=1/0;for(k of f)d=Math.min(d,k.z);return d}function Sh(d,f){return 0<f?f+2*d:d}function ak(d,f,k){return d.sections.forEach(q=>{var a=q.text;const c=f.layout.get("text-transform").evaluate(k,{});var e=
("uppercase"===c?a=a.toLocaleUpperCase():"lowercase"===c&&(a=a.toLocaleLowerCase()),yi.applyArabicShaping&&(a=yi.applyArabicShaping(a)),a);q.text=e}),d}function Ek(d,f,k){f=16383>=f?1:2097151>=f?2:268435455>=f?3:Math.floor(Math.log(f)/(7*Math.LN2));k.realloc(f);for(let q=k.pos-1;q>=d;q--)k.buf[q+f]=k.buf[q]}function Dj(d,f){for(let k=0;k<d.length;k++)f.writeVarint(d[k])}function bk(d,f){for(let k=0;k<d.length;k++)f.writeSVarint(d[k])}function Gk(d,f){for(let k=0;k<d.length;k++)f.writeFloat(d[k])}
function t(d,f){for(let k=0;k<d.length;k++)f.writeDouble(d[k])}function A(d,f){for(let k=0;k<d.length;k++)f.writeBoolean(d[k])}function E(d,f){for(let k=0;k<d.length;k++)f.writeFixed32(d[k])}function N(d,f){for(let k=0;k<d.length;k++)f.writeSFixed32(d[k])}function U(d,f){for(let k=0;k<d.length;k++)f.writeFixed64(d[k])}function ea(d,f){for(let k=0;k<d.length;k++)f.writeSFixed64(d[k])}function ia(d,f,k){1===d&&k.readMessage(va,f)}function va(d,f,k){if(3===d){const {id:q,bitmap:a,width:c,height:e,left:h,
top:l,advance:p}=k.readMessage(Ga,{});f.push({id:q,bitmap:new Xl({width:c+6,height:e+6},a),metrics:{width:c,height:e,left:h,top:l,advance:p}})}}function Ga(d,f,k){1===d?f.id=k.readVarint():2===d?f.bitmap=k.readBytes():3===d?f.width=k.readVarint():4===d?f.height=k.readVarint():5===d?f.left=k.readSVarint():6===d?f.top=k.readSVarint():7===d&&(f.advance=k.readVarint())}function Sa(d){let f=0;var k=0;for(var q of d)f+=q.w*q.h,k=Math.max(k,q.w);d.sort((e,h)=>h.h-e.h);k=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(f/
.95)),k),h:1/0}];let a=q=0;for(const e of d)for(d=k.length-1;0<=d;d--){var c=k[d];if(!(e.w>c.w||e.h>c.h)){(e.x=c.x,e.y=c.y,a=Math.max(a,e.y+e.h),q=Math.max(q,e.x+e.w),e.w===c.w&&e.h===c.h)?(c=k.pop())&&d<k.length&&(k[d]=c):e.h===c.h?(c.x+=e.w,c.w-=e.w):e.w===c.w?(c.y+=e.h,c.h-=e.h):(k.push({x:c.x+e.w,y:c.y,w:c.w-e.w,h:e.h}),c.y+=e.h,c.h-=e.h);break}}return{w:q,h:a,fill:f/(q*a)||0}}function ab(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H){a=Am.fromFeature(d,a);x===M.ao.vertical&&a.verticalizePunctuation();const {processBidirectionalText:I,
processStyledBidirectionalText:L}=yi;if(I&&1===a.sections.length){d=[];var Y=I(a.toString(),mc(a,p,c,f,q,D));for(var P of Y){Y=new Am;Y.text=P;Y.sections=a.sections;for(c=0;c<P.length;c++)Y.sectionIndex.push(0);d.push(Y)}}else if(L){d=[];P=L(a.text,a.sectionIndex,mc(a,p,c,f,q,D));for(Y of P)P=new Am,P.text=Y[0],P.sectionIndex=Y[1],P.sections=a.sections,d.push(P)}else d=function(Z,aa){const T=[],ha=Z.text;let Ca=0;for(const xa of aa)T.push(Z.substring(Ca,xa)),Ca=xa;return Ca<ha.length&&T.push(Z.substring(Ca,
ha.length)),T}(a,mc(a,p,c,f,q,D));P=[];w={positionedLines:P,text:a.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:x,iconsInText:!1,verticalizable:!1};return function(Z,aa,T,ha,Ca,xa,Ha,Fa,Ra,Ja,Ka,lb){var wb=0;let Mb=0,kb=0,jc=0;Fa="right"===Fa?1:"left"===Fa?0:.5;lb=24/lb;let Wb=0;for(const wa of Ca){wa.trim();var Xb=wa.getMaxScale();const Oa={positionedGlyphs:[],lineOffset:0};Z.positionedLines[Wb]=Oa;var ad=Oa.positionedGlyphs;let Ya=0;if(!wa.length()){Mb+=xa;++Wb;continue}var wc=
ha,Tb=24*wa.getMaxScale();const {maxImageWidth:La,maxImageHeight:ub}=wa.getMaxImageSize(wc);wc=Math.max(Tb,La*lb);Tb=Math.max(Tb,ub*lb);for(let mb=0;mb<wa.length();mb++){const ib=wa.getSection(mb),Gb=wa.getSectionIndex(mb),Yb=wa.getCharCode(mb);var Hb=void 0,Ub=Ka;Ub=!(Ra===M.ao.horizontal||!Ub&&!dd(Yb)||Ub&&(Tk[Yb]||(Hb=Yb,/\p{sc=Arab}/u.test(String.fromCodePoint(Hb)))));let rc;if(ib.imageName){Z.iconsInText=!0;ib.scale*=lb;a:{var zc=void 0,cc=ha[ib.imageName];if(!cc){Hb=null;break a}Hb=cc.paddedRect;
cc=cc.displaySize;const Ae={width:cc[0],height:cc[1],left:1,top:-3,advance:Ub?cc[1]:cc[0]};Ub?zc=wc-cc[1]*ib.scale:(zc=Sg(ib.verticalAlign),zc*=Tb-cc[1]*ib.scale);Hb={rect:Hb,metrics:Ae,baselineOffset:zc,imageOffset:(Ub?cc[0]:cc[1])*ib.scale-24*Xb}}if(rc=Hb,!rc)continue;Ya=Math.max(Ya,rc.imageOffset)}else if(Hb=T[ib.fontStack],Hb=Hb&&Hb[Yb],Hb&&Hb.rect||(Hb=(Hb=(Hb=aa[ib.fontStack])&&Hb[Yb])?{rect:null,metrics:Hb.metrics}:null),null===Hb?Hb=null:(Ub?cc=wc-24*ib.scale:(cc=Sg(ib.verticalAlign),cc*=
Tb-24*ib.scale),Hb={rect:Hb.rect,metrics:Hb.metrics,baselineOffset:cc}),rc=Hb,!rc)continue;const {rect:pc,metrics:Kd,baselineOffset:bd}=rc;ad.push({glyph:Yb,imageName:ib.imageName,x:wb,y:Mb+bd+-17,vertical:Ub,scale:ib.scale,fontStack:ib.fontStack,sectionIndex:Gb,metrics:Kd,rect:pc});Ub?(Z.verticalizable=!0,wb+=(ib.imageName?Kd.advance:24)*ib.scale+Ja):wb+=Kd.advance*ib.scale+Ja}if(0!==ad.length&&(kb=Math.max(wb-Ja,kb),wb=ad,ad=ad.length-1,0!==Fa))for(wc=wb[ad],wc=(wb[ad].x+wc.metrics.advance*wc.scale)*
Fa,Tb=0;Tb<=ad;Tb++)wb[Tb].x-=wc;wb=0;Oa.lineOffset=Math.max(Ya,24*(Xb-1));Xb=xa*Xb+Ya;Mb+=Xb;jc=Math.max(Xb,jc);++Wb}const {horizontalAlign:sa,verticalAlign:ka}=xd(Ha);aa=Z.positionedLines;T=(Fa-sa)*kb;Ca=jc!==xa?-Mb*ka- -17:-ka*Ca.length*xa+.5*xa;for(const wa of aa)for(const Oa of wa.positionedGlyphs)Oa.x+=T,Oa.y+=Ca;Z.top+=-ka*Mb;Z.bottom=Z.top+Mb;Z.left+=-sa*kb;Z.right=Z.left+kb}(w,f,k,q,d,e,h,l,x,p,y,H),!function(Z){for(const aa of Z)if(0!==aa.positionedGlyphs.length)return!1;return!0}(P)&&w}
function Qb(d,f,k,q,a,c){return f.imageName?(d=q[f.imageName])?d.displaySize[0]*f.scale*24/c+a:0:(d=(c=k[f.fontStack])&&c[d])?d.metrics.advance*f.scale+a:0}function ic(d,f,k,q){const a=Math.pow(d-f,2);return q?d<f?a/2:2*a:a+Math.abs(k)*k}function Vb(d,f,k,q,a,c){let e=null,h=ic(f,k,a,c);for(const l of q)q=ic(f-l.x,k,a,c)+l.badness,q<=h&&(e=l,h=q);return{index:d,x:f,priorBreak:e,badness:h}}function Sc(d){return d?Sc(d.priorBreak).concat(d.index):[]}function mc(d,f,k,q,a,c){if(!d)return[];const e=[];
var h=0;for(var l=0;l<d.length();l++){var p=d.getSection(l);h+=Qb(d.getCharCode(l),p,q,a,f,c)}k=h/Math.max(1,Math.ceil(h/k));h=0<=d.text.indexOf("");l=0;for(p=0;p<d.length();p++){var w=d.getSection(p),x=d.getCharCode(p);if(Tk[x]||(l+=Qb(x,w,q,a,f,c)),p<d.length()-1){const Z=!(11904>(P=x))&&(!!gd["CJK Compatibility Forms"](P)||!!gd["CJK Compatibility"](P)||!!gd["CJK Strokes"](P)||!!gd["CJK Symbols and Punctuation"](P)||!!gd["Enclosed CJK Letters and Months"](P)||!!gd["Halfwidth and Fullwidth Forms"](P)||
!!gd["Ideographic Description Characters"](P)||!!gd["Vertical Forms"](P)||Tm.test(String.fromCodePoint(P)));if(Cn[x]||Z||w.imageName||p!==d.length()-2&&Om[d.getCharCode(p+1)]){w=e;var y=w.push,D=p+1,H=l,I=k,L=x,Y=d.getCharCode(p+1);let aa=0;x=(10===L&&(aa-=1E4),Z&&h&&(aa+=150),40!==L&&65288!==L||(aa+=50),41!==Y&&65289!==Y||(aa+=50),aa);y.call(w,Vb(D,H,I,e,x,!1))}}}var P;return Sc(Vb(d.length(),l,k,e,0,!0))}function xd(d){let f=.5,k=.5;switch(d){case "right":case "top-right":case "bottom-right":f=
1;break;case "left":case "top-left":case "bottom-left":f=0}switch(d){case "bottom":case "bottom-right":case "bottom-left":k=1;break;case "top":case "top-right":case "top-left":k=0}return{horizontalAlign:f,verticalAlign:k}}function Sg(d){switch(d){case "top":return 0;case "center":return.5;default:return 1}}function If(d,f,k){const {horizontalAlign:q,verticalAlign:a}=xd(k);k=f[0]-d.displaySize[0]*q;f=f[1]-d.displaySize[1]*a;return{image:d,top:f,bottom:f+d.displaySize[1],left:k,right:k+d.displaySize[0]}}
function Fj(d){var f,k;let q=d.left,a=d.top,c=d.right-q,e=d.bottom-a;var h=null!==(f=d.image.textFitWidth)&&void 0!==f?f:"stretchOrShrink";f=null!==(k=d.image.textFitHeight)&&void 0!==k?k:"stretchOrShrink";d=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if("proportional"===f){if("stretchOnly"===h&&c/e<d||"proportional"===h)h=Math.ceil(e*d),q*=h/c,c=h}else"proportional"===h&&"stretchOnly"===f&&0!==d&&c/e>d&&(h=Math.ceil(c/d),a*=h/e,e=h);return{x1:q,y1:a,x2:q+c,y2:a+
e}}function mf(d,f,k,q,a,c){d=d.image;if(d.content){var e=d.content;var h=d.pixelRatio||1;e=[e[0]/h,e[1]/h,d.displaySize[0]-e[2]/h,d.displaySize[1]-e[3]/h]}h=f.left*c;const l=f.right*c;let p,w,x,y;"width"===k||"both"===k?(y=a[0]+h-q[3],w=a[0]+l+q[1]):(y=a[0]+(h+l-d.displaySize[0])/2,w=y+d.displaySize[0]);h=f.top*c;f=f.bottom*c;return"height"===k||"both"===k?(p=a[1]+h-q[0],x=a[1]+f+q[2]):(p=a[1]+(h+f-d.displaySize[1])/2,x=p+d.displaySize[1]),{image:d,top:p,right:w,bottom:x,left:y,collisionPadding:e}}
function Rf(d,f){({expression:f}=f);if("constant"===f.kind)return{kind:"constant",layoutSize:f.evaluate(new me(d+1))};if("source"===f.kind)return{kind:"source"};const {zoomStops:k,interpolationType:q}=f;let a=0;for(;a<k.length&&k[a]<=d;)a++;for(var c=a=Math.max(0,a-1);c<k.length&&k[c]<d+1;)c++;c=Math.min(k.length-1,c);d=k[a];c=k[c];return"composite"===f.kind?{kind:"composite",minZoom:d,maxZoom:c,interpolationType:q}:{kind:"camera",minZoom:d,maxZoom:c,minSize:f.evaluate(new me(d)),maxSize:f.evaluate(new me(c)),
interpolationType:q}}function ij(d,f,k){let q="never";f=d.get(f);return f?q=f:d.get(k)&&(q="always"),q}function Ug(d,f,k,q,a,c,e,h,l,p,w,x,y){d.emplaceBack(f,k,Math.round(32*q),Math.round(32*a),c,e,((h?Math.min(32640,Math.round(h[0])):0)<<1)+(l?1:0),h?Math.min(32640,Math.round(h[1])):0,16*p,16*w,256*x,256*y)}function Mc(d,f,k){d.emplaceBack(f.x,f.y,k);d.emplaceBack(f.x,f.y,k);d.emplaceBack(f.x,f.y,k);d.emplaceBack(f.x,f.y,k)}function Jk(d){for(const f of d.sections){a:{d=f.text;for(const k of d)if(jh.test(String.fromCodePoint(k.charCodeAt(0)))){d=
!0;break a}d=!1}if(d)return!0}return!1}function Vg(d){return(180+d)/360}function rl(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function ji(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function ve(d,f){return d*Te*Math.cos(ji(f)*Math.PI/180)}function fg(d,f,k){k=12756274*Math.PI/256/Math.pow(2,k);return[d*k-12756274*Math.PI/2,f*k-12756274*Math.PI/2]}function Xd(d,f,k,q,a){0>(d*=2)&&(d=-1*d-1);const c=1<<k;return(c*c*d+c*a+q).toString(36)+k.toString(36)+
f.toString(36)}function Xc(d,f,k,q,a){return Ic(d,(c,e)=>(c=f instanceof em?f.get(e):null)&&c.evaluate?c.evaluate(k,q,a):c)}function tm(d,f){return f-d}function Ri(d,f,k,q,a){const c=[];for(let e=0;e<d.length;e++){const h=d[e];let l;for(let p=0;p<h.length-1;p++){let w=h[p],x=h[p+1];w.x<f&&x.x<f||(w.x<f?w=(new ta(f,w.y+(f-w.x)/(x.x-w.x)*(x.y-w.y)))._round():x.x<f&&(x=(new ta(f,w.y+(f-w.x)/(x.x-w.x)*(x.y-w.y)))._round()),w.y<k&&x.y<k||(w.y<k?w=(new ta(w.x+(k-w.y)/(x.y-w.y)*(x.x-w.x),k))._round():x.y<
k&&(x=(new ta(w.x+(k-w.y)/(x.y-w.y)*(x.x-w.x),k))._round()),w.x>=q&&x.x>=q||(w.x>=q?w=(new ta(q,w.y+(q-w.x)/(x.x-w.x)*(x.y-w.y)))._round():x.x>=q&&(x=(new ta(q,w.y+(q-w.x)/(x.x-w.x)*(x.y-w.y)))._round()),w.y>=a&&x.y>=a||(w.y>=a?w=(new ta(w.x+(a-w.y)/(x.y-w.y)*(x.x-w.x),a))._round():x.y>=a&&(x=(new ta(w.x+(a-w.y)/(x.y-w.y)*(x.x-w.x),a))._round()),l&&w.equals(l[l.length-1])||(l=[w],c.push(l)),l.push(x)))))}}return c}function Oi(d,f,k,q,a){if(void 0===f.segment||0===k)return!0;var c=f;f=f.segment+1;
let e=0;for(;e>-k/2;){if(f--,0>f)return!1;e-=d[f].dist(c);c=d[f]}e+=d[f].dist(d[f+1]);f++;c=[];let h=0;for(;e<k/2;){const l=d[f],p=d[f+1];if(!p)return!1;let w=d[f-1].angleTo(l)-l.angleTo(p);w=Math.abs((w+3*Math.PI)%(2*Math.PI)-Math.PI);c.push({distance:e,angleDelta:w});for(h+=w;e-c[0].distance>q;)h-=c.shift().angleDelta;if(h>a)return!1;f++;e+=l.dist(p)}return!0}function um(d){let f=0;for(let k=0;k<d.length-1;k++)f+=d[k].dist(d[k+1]);return f}function gh(d,f,k,q,a,c){a=k?.6*a*c:0;k=Math.max(k?k.right-
k.left:0,q?q.right-q.left:0)*c;var e=0,h=um(d)/2;for(q=0;q<d.length-1;q++){c=d[q];const l=d[q+1],p=c.dist(l);if(e+p>h)return h=(h-e)/p,e=ig.number(c.x,l.x,h),h=ig.number(c.y,l.y,h),q=new We(e,h,l.angleTo(c),q),q._round(),!a||Oi(d,q,k,a,f)?q:void 0;e+=p}}function dk(d,f,k,q,a,c,e,h,l){a=Math.max(q?q.right-q.left:0,a?a.right-a.left:0);const p=a*e,w=0===d[0].x||d[0].x===l||0===d[0].y||d[0].y===l;return f-p<f/4&&(f=p+f/4),jj(d,w?f/2*h%f:(a/2+2*c)*e*h%f,f,q?.6*c*e:0,k,p,w,!1,l)}function jj(d,f,k,q,a,c,
e,h,l){const p=c/2,w=um(d);let x=0;f-=k;let y=[];for(let I=0;I<d.length-1;I++){const L=d[I],Y=d[I+1],P=L.dist(Y),Z=Y.angleTo(L);for(;f+k<x+P;){f+=k;var D=(f-x)/P,H=ig.number(L.x,Y.x,D);D=ig.number(L.y,Y.y,D);0<=H&&H<l&&0<=D&&D<l&&0<=f-p&&f+p<=w&&(H=new We(H,D,Z,I),H._round(),q&&!Oi(d,H,c,q,a)||y.push(H))}x+=P}return h||y.length||e||(y=jj(d,x/2,k,q,a,c,e,!0,l)),y}function ni(d,f,k,q){const a=[],c=d.image,e=c.pixelRatio;var h=c.paddedRect.w-2,l=c.paddedRect.h-2;let p={x1:d.left,y1:d.top,x2:d.right,
y2:d.bottom};var w=c.stretchX||[[0,h]],x=c.stretchY||[[0,l]],y=(Ja,Ka)=>Ja+Ka[1]-Ka[0];const D=w.reduce(y,0),H=x.reduce(y,0),I=h-D;y=l-H;let L=0,Y=D,P=0,Z=H,aa=0,T=I,ha=0,Ca=y;if(c.content&&q){const Ja=c.content,Ka=Ja[2]-Ja[0],lb=Ja[3]-Ja[1];(c.textFitWidth||c.textFitHeight)&&(p=Fj(d));L=Pi(w,0,Ja[0]);P=Pi(x,0,Ja[1]);Y=Pi(w,Ja[0],Ja[2]);Z=Pi(x,Ja[1],Ja[3]);aa=Ja[0]-L;ha=Ja[1]-P;T=Ka-Y;Ca=lb-Z}const xa=p.x1,Ha=p.y1,Fa=p.x2-xa,Ra=p.y2-Ha;d=(Ja,Ka,lb,wb)=>{var Mb=(Ja.stretch-L)/Y*Fa+xa,kb=Ja.fixed-aa-
T*Ja.stretch/D,jc=(Ka.stretch-P)/Z*Ra+Ha,Wb=Ka.fixed-ha-Ca*Ka.stretch/H,Xb=(lb.stretch-L)/Y*Fa+xa,ad=lb.fixed-aa-T*lb.stretch/D;const wc=(wb.stretch-P)/Z*Ra+Ha;var Tb=wb.fixed-ha-Ca*wb.stretch/H;const Hb=new ta(Mb,jc);jc=new ta(Xb,jc);Xb=new ta(Xb,wc);Mb=new ta(Mb,wc);kb=new ta(kb/e,Wb/e);ad=new ta(ad/e,Tb/e);if(Wb=f*Math.PI/180)Tb=Math.sin(Wb),Wb=Math.cos(Wb),Tb=[Wb,-Tb,Tb,Wb],Hb._matMult(Tb),jc._matMult(Tb),Mb._matMult(Tb),Xb._matMult(Tb);Ja=Ja.stretch+Ja.fixed;Ka=Ka.stretch+Ka.fixed;return{tl:Hb,
tr:jc,bl:Mb,br:Xb,tex:{x:c.paddedRect.x+1+Ja,y:c.paddedRect.y+1+Ka,w:lb.stretch+lb.fixed-Ja,h:wb.stretch+wb.fixed-Ka},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kb,pixelOffsetBR:ad,minFontScaleX:T/e/Fa,minFontScaleY:Ca/e/Ra,isSDF:k}};if(q&&(c.stretchX||c.stretchY))for(q=mi(w,I,D),x=mi(x,y,H),h=0;h<q.length-1;h++)for(l=q[h],w=q[h+1],y=0;y<x.length-1;y++)a.push(d(l,x[y],w,x[y+1]));else a.push(d({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:h+1},{fixed:0,stretch:l+
1}));return a}function Pi(d,f,k){let q=0;for(const a of d)q+=Math.max(f,Math.min(k,a[1]))-Math.max(f,Math.min(k,a[0]));return q}function mi(d,f,k){const q=[{fixed:-1,stretch:0}];for(const [a,c]of d)d=q[q.length-1],q.push({fixed:a-d.stretch,stretch:d.stretch}),q.push({fixed:a-d.stretch,stretch:d.stretch+(c-a)});return q.push({fixed:f+1,stretch:k}),q}function Mk(d,f=1,k=!1){var q=Qc.fromPoints(d[0]),a=Math.min(q.width(),q.height());let c=a/2;const e=new dj([],nf),{minX:h,minY:l,maxX:p,maxY:w}=q;if(0===
a)return new ta(h,l);for(q=h;q<p;q+=a)for(var x=l;x<w;x+=a)e.push(new zh(q+c,x+c,c,d));x=q=a=0;const y=d[0];for(let D=0,H=y.length,I=H-1;D<H;I=D++){const L=y[D],Y=y[I],P=L.x*Y.y-Y.x*L.y;q+=(L.x+Y.x)*P;x+=(L.y+Y.y)*P;a+=3*P}a=new zh(q/a,x/a,0,d);for(q=e.length;e.length;)x=e.pop(),(x.d>a.d||!a.d)&&(a=x,k&&console.log("found best %d after %d probes",Math.round(1E4*x.d)/1E4,q)),x.max-a.d<=f||(c=x.h/2,e.push(new zh(x.p.x-c,x.p.y-c,c,d)),e.push(new zh(x.p.x+c,x.p.y-c,c,d)),e.push(new zh(x.p.x-c,x.p.y+c,
c,d)),e.push(new zh(x.p.x+c,x.p.y+c,c,d)),q+=4);return k&&(console.log(`num probes: ${q}`),console.log(`best distance: ${a.d}`)),a.p}function nf(d,f){return f.max-d.max}function zh(d,f,k,q){this.p=new ta(d,f);this.h=k;d=this.p;f=!1;k=1/0;for(let a=0;a<q.length;a++){const c=q[a];for(let e=0,h=c.length,l=h-1;e<h;l=e++){const p=c[e],w=c[l];p.y>d.y!=w.y>d.y&&d.x<(w.x-p.x)*(d.y-p.y)/(w.y-p.y)+p.x&&(f=!f);k=Math.min(k,ug(d,p,w))}}this.d=(f?1:-1)*Math.sqrt(k);this.max=this.d+this.h*Math.SQRT2}function Lk(d,
f){return f[1]!==En?function(k,q,a){let c=0,e=0;switch(q=Math.abs(q),a=Math.abs(a),k){case "top-right":case "top-left":case "top":e=a-7;break;case "bottom-right":case "bottom-left":case "bottom":e=7-a}switch(k){case "top-right":case "bottom-right":case "right":c=-q;break;case "top-left":case "bottom-left":case "left":c=q}return[c,e]}(d,f[0],f[1]):function(k,q){let a=0,c=0;0>q&&(q=0);const e=q/Math.SQRT2;switch(k){case "top-right":case "top-left":c=e-7;break;case "bottom-right":case "bottom-left":c=
7-e;break;case "bottom":c=7-q;break;case "top":c=q-7}switch(k){case "top-right":case "bottom-right":a=-e;break;case "top-left":case "bottom-left":a=e;break;case "left":a=q;break;case "right":a=-q}return[a,c]}(d,f[0])}function ih(d,f,k){var q,a=d.layout;const c=null===(q=a.get("text-variable-anchor-offset"))||void 0===q?void 0:q.evaluate(f,{},k);if(c){var e=c.values;d=[];for(f=0;f<e.length;f+=2)k=d[f]=e[f],a=e[f+1].map(h=>24*h),k.startsWith("top")?a[1]-=7:k.startsWith("bottom")&&(a[1]+=7),d[f+1]=a;
return new ff(d)}if(q=a.get("text-variable-anchor")){d=void 0!==d._unevaluatedLayout.getValue("text-radial-offset")?[24*a.get("text-radial-offset").evaluate(f,{},k),En]:a.get("text-offset").evaluate(f,{},k).map(h=>24*h);f=[];for(e of q)f.push(e,Lk(e,d));return new ff(f)}return null}function Jj(d){switch(d){case "right":case "top-right":case "bottom-right":return"right";case "left":case "top-left":case "bottom-left":return"left"}return"center"}function Wg(d,f,k,q,a,c,e,h,l,p,w,x){var y=c.textMaxSize.evaluate(f,
{});void 0===y&&(y=e);var D=d.layers[0].layout;const H=D.get("icon-offset").evaluate(f,{},w);var I=li(k.horizontal);const L=e/24,Y=d.tilePixelRatio*L;y=d.tilePixelRatio*y/24;const P=d.tilePixelRatio*h,Z=d.tilePixelRatio*D.get("symbol-spacing"),aa=D.get("text-padding")*d.tilePixelRatio,T=function(Mb,kb,jc,Wb=1){Mb=(Mb=Mb.get("icon-padding").evaluate(kb,{},jc))&&Mb.values;return[Mb[0]*Wb,Mb[1]*Wb,Mb[2]*Wb,Mb[3]*Wb]}(D,f,w,d.tilePixelRatio);h=D.get("text-max-angle")/180*Math.PI;const ha="viewport"!==
D.get("text-rotation-alignment")&&"point"!==D.get("symbol-placement"),Ca="map"===D.get("icon-rotation-alignment")&&"point"!==D.get("symbol-placement"),xa=D.get("symbol-placement"),Ha=Z/2,Fa=D.get("icon-text-fit");let Ra;q&&"none"!==Fa&&(d.allowVerticalPlacement&&k.vertical&&(Ra=mf(q,k.vertical,Fa,D.get("icon-text-fit-padding"),H,L)),I&&(q=mf(q,I,Fa,D.get("icon-text-fit-padding"),H,L)));x=w?x.line.getGranularityForZoomLevel(w.z):1;D=(Mb,kb)=>{if(!(0>kb.x||8192<=kb.x||0>kb.y||8192<=kb.y)){var jc=q,
Wb=Ra,Xb=d.layers[0],ad=d.collisionBoxArray,wc=f.index,Tb=f.sourceLayerIndex,Hb=d.index,Ub=[aa,aa,aa,aa],zc=d.addToLineVertexArray(kb,Mb),cc,sa=0;let mb=Mb=0,ib=0;var ka=-1;let Gb=-1;const Yb={};let rc=he("");if(d.allowVerticalPlacement&&k.vertical){var wa=Xb.layout.get("text-rotate").evaluate(f,{},w)+90;var Oa=new Wd(ad,kb,wc,Tb,Hb,k.vertical,Y,Ub,ha,wa);Wb&&(cc=new Wd(ad,kb,wc,Tb,Hb,Wb,P,T,ha,wa))}if(jc){sa=Xb.layout.get("icon-rotate").evaluate(f,{});var Ya="none"!==Xb.layout.get("icon-text-fit");
ka=ni(jc,sa,p,Ya);Wb=Wb?ni(Wb,sa,p,Ya):void 0;Ya=new Wd(ad,kb,wc,Tb,Hb,jc,P,T,!1,sa);sa=4*ka.length;wa=d.iconSizeData;jc=null;"source"===wa.kind?(jc=[128*Xb.layout.get("icon-size").evaluate(f,{})],32640<jc[0]&&Ma(`${d.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===wa.kind&&(jc=[128*c.compositeIconSizes[0].evaluate(f,{},w),128*c.compositeIconSizes[1].evaluate(f,{},w)],(32640<jc[0]||32640<jc[1])&&Ma(`${d.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`));
d.addSymbols(d.icon,ka,jc,H,Ca,f,M.ao.none,kb,zc.lineStartIndex,zc.lineLength,-1,w);ka=d.icon.placedSymbolArray.length-1;Wb&&(Mb=4*Wb.length,d.addSymbols(d.icon,Wb,jc,H,Ca,f,M.ao.vertical,kb,zc.lineStartIndex,zc.lineLength,-1,w),Gb=d.icon.placedSymbolArray.length-1)}jc=Object.keys(k.horizontal);for(var La of jc){Wb=k.horizontal[La];if(!ub){rc=he(Wb.text);var ub=Xb.layout.get("text-rotate").evaluate(f,{},w);ub=new Wd(ad,kb,wc,Tb,Hb,Wb,Y,Ub,ha,ub)}wa=1===Wb.positionedLines.length;if(mb+=Rl(d,kb,Wb,
a,Xb,ha,f,l,zc,k.vertical?M.ao.horizontal:M.ao.horizontalOnly,wa?jc:[La],Yb,ka,c,w),wa)break}k.vertical&&(ib+=Rl(d,kb,k.vertical,a,Xb,ha,f,l,zc,M.ao.vertical,["vertical"],Yb,Gb,c,w));ad=ub?ub.boxStartIndex:d.collisionBoxArray.length;Tb=ub?ub.boxEndIndex:d.collisionBoxArray.length;Hb=Oa?Oa.boxStartIndex:d.collisionBoxArray.length;Ub=Oa?Oa.boxEndIndex:d.collisionBoxArray.length;La=Ya?Ya.boxStartIndex:d.collisionBoxArray.length;zc=Ya?Ya.boxEndIndex:d.collisionBoxArray.length;jc=cc?cc.boxStartIndex:d.collisionBoxArray.length;
Wb=cc?cc.boxEndIndex:d.collisionBoxArray.length;wa=-1;wa=ub&&ub.circleDiameter?Math.max(ub.circleDiameter,wa):wa;wa=Oa&&Oa.circleDiameter?Math.max(Oa.circleDiameter,wa):wa;wa=Ya&&Ya.circleDiameter?Math.max(Ya.circleDiameter,wa):wa;wa=cc&&cc.circleDiameter?Math.max(cc.circleDiameter,wa):wa;(Oa=-1<wa?1:0)&&(wa*=e/24);d.glyphOffsetArray.length>=F.MAX_GLYPHS&&Ma("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");void 0!==f.sortKey&&d.addToSortKeyRanges(d.symbolInstances.length,
f.sortKey);ub=ih(Xb,f,w);Xb=d.textAnchorOffsets;cc=Xb.length;ub=null==ub?void 0:ub.values;if(0<(null==ub?void 0:ub.length))for(Ya=0;Ya<ub.length;Ya+=2){const bd=ub[Ya+1];Xb.emplaceBack(M.aE[ub[Ya]],bd[0],bd[1])}const [pc,Kd]=[cc,Xb.length];d.symbolInstances.emplaceBack(kb.x,kb.y,0<=Yb.right?Yb.right:-1,0<=Yb.center?Yb.center:-1,0<=Yb.left?Yb.left:-1,Yb.vertical||-1,ka,Gb,rc,ad,Tb,Hb,Ub,La,zc,jc,Wb,wc,mb,ib,sa,Mb,Oa,0,Y,wa,pc,Kd)}};if("line"===xa)for(var Ja of Ri(f.geometry,0,0,8192,8192)){var Ka=
Ph(Ja,x),lb=dk(Ka,Z,h,k.vertical||I,q,24,y,d.overscaling,8192);for(var wb of lb)I&&Sf(d,I.text,Ha,wb)||D(Ka,wb)}else if("line-center"===xa)for(Ka of f.geometry)1<Ka.length&&(Ja=Ph(Ka,x),(wb=gh(Ja,h,k.vertical||I,q,24,y))&&D(Ja,wb));else if("Polygon"===f.type)for(lb of Yi(f.geometry,0))I=Mk(lb,16),D(Ph(lb[0],x,!0),new We(I.x,I.y,0));else if("LineString"===f.type)for(const Mb of f.geometry)I=Ph(Mb,x),D(I,new We(I[0].x,I[0].y,0));else if("Point"===f.type)for(const Mb of f.geometry)for(const kb of Mb)D([kb],
new We(kb.x,kb.y,0))}function Rl(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H){var I=d.allowVerticalPlacement;const L=a.layout.get("text-rotate").evaluate(e,{})*Math.PI/180,Y=[];for(const Ra of k.positionedLines)for(const Ja of Ra.positionedGlyphs){if(!Ja.rect)continue;const Ka=Ja.rect||{};var P=4;let lb=!0;var Z=1,aa=0,T=(c||I)&&Ja.vertical,ha=Ja.metrics.advance*Ja.scale/2;if(I&&k.verticalizable&&(aa=Ra.lineOffset/2-(Ja.imageName?-(24-Ja.metrics.width*Ja.scale)/2:24*(Ja.scale-1))),Ja.imageName){var Ca=q[Ja.imageName];
lb=Ca.sdf;Z=Ca.pixelRatio;P=1/Z}Ca=c?[Ja.x+ha,Ja.y]:[0,0];var xa=c?[0,0]:[Ja.x+ha+h[0],Ja.y+h[1]-aa],Ha=[0,0];T&&(Ha=xa,xa=[0,0]);aa=Ja.metrics.isDoubleResolution?2:1;var Fa=(Ja.metrics.left-P)*Ja.scale-ha+xa[0];xa=(-Ja.metrics.top-P)*Ja.scale+xa[1];P=Fa+Ka.w/aa*Ja.scale/Z;const wb=xa+Ka.h/aa*Ja.scale/Z;Z=new ta(Fa,xa);aa=new ta(P,xa);Fa=new ta(Fa,wb);P=new ta(P,wb);T&&(T=new ta(-ha,ha- -17),xa=-Math.PI/2,ha=12-ha,ha=new ta(22-ha,-(Ja.imageName?ha:0)),Ha=new ta(...Ha),Z._rotateAround(xa,T)._add(ha)._add(Ha),
aa._rotateAround(xa,T)._add(ha)._add(Ha),Fa._rotateAround(xa,T)._add(ha)._add(Ha),P._rotateAround(xa,T)._add(ha)._add(Ha));L&&(ha=Math.sin(L),Ha=Math.cos(L),ha=[Ha,-ha,ha,Ha],Z._matMult(ha),aa._matMult(ha),Fa._matMult(ha),P._matMult(ha));ha=new ta(0,0);Ha=new ta(0,0);Y.push({tl:Z,tr:aa,bl:Fa,br:P,tex:Ka,writingMode:k.writingMode,glyphOffset:Ca,sectionIndex:Ja.sectionIndex,isSDF:lb,pixelOffsetTL:ha,pixelOffsetBR:Ha,minFontScaleX:0,minFontScaleY:0})}k=d.textSizeData;q=null;"source"===k.kind?(q=[128*
a.layout.get("text-size").evaluate(e,{})],32640<q[0]&&Ma(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===k.kind&&(q=[128*D.compositeTextSizes[0].evaluate(e,{},H),128*D.compositeTextSizes[1].evaluate(e,{},H)],(32640<q[0]||32640<q[1])&&Ma(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`));d.addSymbols(d.text,Y,q,h,c,e,p,f,l.lineStartIndex,l.lineLength,y,H);for(const Ra of w)x[Ra]=d.text.placedSymbolArray.length-1;return 4*Y.length}
function li(d){for(const f in d)return d[f];return null}function Sf(d,f,k,q){d=d.compareText;if(f in d){const a=d[f];for(let c=a.length-1;0<=c;c--)if(q.dist(a[c])<k)return!0}else d[f]=[];return d[f].push(q),!1}function Je(d,f,k,q,a,c){if(!(a-q<=k)){var e=q+a>>1;Ck(d,f,e,q,a,c);Je(d,f,k,q,e-1,1-c);Je(d,f,k,e+1,a,1-c)}}function Ck(d,f,k,q,a,c){for(;a>q;){if(600<a-q){var e=a-q+1,h=k-q+1,l=Math.log(e),p=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*p*(e-p)/e)*(0>h-e/2?-1:1);Ck(d,f,k,Math.max(q,Math.floor(k-h*p/
e+l)),Math.min(a,Math.floor(k+(e-h)*p/e+l)),c)}e=f[2*k+c];h=q;p=a;Kj(d,f,q,k);for(f[2*a+c]>e&&Kj(d,f,q,a);h<p;){Kj(d,f,h,p);h++;for(p--;f[2*h+c]<e;)h++;for(;f[2*p+c]>e;)p--}f[2*q+c]===e?Kj(d,f,q,p):(p++,Kj(d,f,p,a));p<=k&&(q=p+1);k<=p&&(a=p-1)}}function Kj(d,f,k,q){Fk(d,k,q);Fk(f,2*k,2*q);Fk(f,2*k+1,2*q+1)}function Fk(d,f,k){const q=d[f];d[f]=d[k];d[k]=q}function rm(d,f,k,q){d-=k;f-=q;return d*d+f*f}var Nl,kj;"function"==typeof SuppressedError&&SuppressedError;ta.prototype={clone(){return new ta(this.x,
this.y)},add(d){return this.clone()._add(d)},sub(d){return this.clone()._sub(d)},multByPoint(d){return this.clone()._multByPoint(d)},divByPoint(d){return this.clone()._divByPoint(d)},mult(d){return this.clone()._mult(d)},div(d){return this.clone()._div(d)},rotate(d){return this.clone()._rotate(d)},rotateAround(d,f){return this.clone()._rotateAround(d,f)},matMult(d){return this.clone()._matMult(d)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},
mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(d){return this.x===d.x&&this.y===d.y},dist(d){return Math.sqrt(this.distSqr(d))},distSqr(d){const f=d.x-this.x;d=d.y-this.y;return f*f+d*d},angle(){return Math.atan2(this.y,this.x)},angleTo(d){return Math.atan2(this.y-d.y,this.x-d.x)},angleWith(d){return this.angleWithSep(d.x,d.y)},angleWithSep(d,f){return Math.atan2(this.x*f-this.y*d,this.x*d+this.y*f)},_matMult(d){const f=d[2]*this.x+d[3]*this.y;return this.x=d[0]*this.x+d[1]*this.y,this.y=
f,this},_add(d){return this.x+=d.x,this.y+=d.y,this},_sub(d){return this.x-=d.x,this.y-=d.y,this},_mult(d){return this.x*=d,this.y*=d,this},_div(d){return this.x/=d,this.y/=d,this},_multByPoint(d){return this.x*=d.x,this.y*=d.y,this},_divByPoint(d){return this.x/=d.x,this.y/=d.y,this},_unit(){return this._div(this.mag()),this},_perp(){const d=this.y;return this.y=this.x,this.x=-d,this},_rotate(d){const f=Math.cos(d);d=Math.sin(d);const k=d*this.x+f*this.y;return this.x=f*this.x-d*this.y,this.y=k,
this},_rotateAround(d,f){const k=Math.cos(d);d=Math.sin(d);const q=f.y+d*(this.x-f.x)+k*(this.y-f.y);return this.x=f.x+k*(this.x-f.x)-d*(this.y-f.y),this.y=q,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:ta};ta.convert=function(d){if(d instanceof ta)return d;if(Array.isArray(d))return new ta(+d[0],+d[1]);if(void 0!==d.x&&void 0!==d.y)return new ta(+d.x,+d.y);throw Error("Expected [x, y] or {x, y} point format");};var Of=function(){function d(f,k,q,a){this.cx=
3*f;this.bx=3*(q-f)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*k;this.by=3*(a-k)-this.cy;this.ay=1-this.cy-this.by;this.p1x=f;this.p1y=k;this.p2x=q;this.p2y=a}return kj?Nl:(kj=1,Nl=d,d.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,k){if(void 0===k&&(k=1E-6),0>f)return 0;if(1<f)return 1;for(var q=f,a=0;8>
a;a++){var c=this.sampleCurveX(q)-f;if(Math.abs(c)<k)return q;var e=this.sampleCurveDerivativeX(q);if(1E-6>Math.abs(e))break;q-=c/e}e=0;var h=1;q=f;for(a=0;20>a&&(c=this.sampleCurveX(q),!(Math.abs(c-f)<k));a++)f>c?e=q:h=q,q=.5*(h-e)+e;return q},solve:function(f,k){return this.sampleCurveY(this.solveCurveX(f,k))}},Nl)}(),Dk=Va(Of);let fk,Cf;var Uc="undefined"!=typeof Float32Array?Float32Array:Array;bb();var oc=new Uc(4);Uc!=Float32Array&&(oc[0]=0,oc[1]=0,oc[2]=0,oc[3]=0);bb();vb(1,0,0);vb(0,1,0);zb();
zb();Sb();bc();const Rg=dc(.25,.1,.25,1);let Ak=1;const Kg={};let lj=null,Th,Lj;const tl={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},gk={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ah={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Si extends Error{constructor(d,f,k,q){super(`AJAXError: ${f} (${d}): ${k}`);
this.status=d;this.statusText=f;this.url=k;this.body=q}}const Ok=()=>sc(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,hk=function(d,f){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const q=Cd(d.url);if(q)return q(d,f);if(sc(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:"global-dispatcher"},f)}if(!(/^file:/.test(k=d.url)||/^file:/.test(Ok())&&!/^\w+:/.test(k))){if(fetch&&
Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(q,a){return v(this,void 0,void 0,function*(){var c=new Request(q.url,{method:q.method||"GET",body:q.body,credentials:q.credentials,headers:q.headers,cache:q.cache,referrer:Ok(),signal:a.signal});let e;"json"!==q.type||c.headers.has("Accept")||c.headers.set("Accept","application/json");try{e=yield fetch(c)}catch(h){throw new Si(0,h.message,q.url,new Blob);}if(!e.ok)throw c=yield e.blob(),new Si(e.status,
e.statusText,q.url,c);c=yield"arrayBuffer"===q.type||"image"===q.type?e.arrayBuffer():"json"===q.type?e.json():e.text();if(a.signal.aborted)throw td();return{data:c,cacheControl:e.headers.get("Cache-Control"),expires:e.headers.get("Expires")}})}(d,f);if(sc(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:"global-dispatcher"},f)}var k;return function(q,a){return new Promise((c,e)=>{var h;const l=new XMLHttpRequest;l.open(q.method||
"GET",q.url,!0);"arrayBuffer"!==q.type&&"image"!==q.type||(l.responseType="arraybuffer");for(const p in q.headers)l.setRequestHeader(p,q.headers[p]);"json"===q.type&&(l.responseType="text",(null===(h=q.headers)||void 0===h?void 0:h.Accept)||l.setRequestHeader("Accept","application/json"));l.withCredentials="include"===q.credentials;l.onerror=()=>{e(Error(l.statusText))};l.onload=()=>{if(!a.signal.aborted)if((200<=l.status&&300>l.status||0===l.status)&&null!==l.response){var p=l.response;if("json"===
q.type)try{p=JSON.parse(l.response)}catch(w){return void e(w)}c({data:p,cacheControl:l.getResponseHeader("Cache-Control"),expires:l.getResponseHeader("Expires")})}else p=new Blob([l.response],{type:l.getResponseHeader("Content-Type")}),e(new Si(l.status,l.statusText,q.url,p))};a.signal.addEventListener("abort",()=>{l.abort();e(td())});l.send(q.body)})}(d,f)};class mj{constructor(d,f={}){pd(this,f);this.type=d}}class Ti extends mj{constructor(d,f={}){super("error",pd({error:d},f))}}class Pk{on(d,f){return this._listeners=
this._listeners||{},pe(d,f,this._listeners),{unsubscribe:()=>{this.off(d,f)}}}off(d,f){return qe(d,f,this._listeners),qe(d,f,this._oneTimeListeners),this}once(d,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},pe(d,f,this._oneTimeListeners),this):new Promise(k=>this.once(d,k))}fire(d,f){"string"==typeof d&&(d=new mj(d,f||{}));f=d.type;if(this.listens(f)){d.target=this;const a=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(var k of a)k.call(this,d);k=this._oneTimeListeners&&
this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(var q of k)qe(f,q,this._oneTimeListeners),q.call(this,d);(q=this._eventedParent)&&(pd(d,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),q.fire(d))}else d instanceof Ti&&console.error(d.error);return this}listens(d){return this._listeners&&this._listeners[d]&&0<this._listeners[d].length||this._oneTimeListeners&&this._oneTimeListeners[d]&&0<this._oneTimeListeners[d].length||this._eventedParent&&
this._eventedParent.listens(d)}setEventedParent(d,f){return this._eventedParent=d,this._eventedParentData=f,this}}var b={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},
light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:"source_vector source_raster source_raster_dem source_geojson source_video source_image".split(" "),source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},
url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",
value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,
default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,
type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},
source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},
"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:"layout_fill layout_line layout_circle layout_heatmap layout_fill-extrusion layout_symbol layout_raster layout_hillshade layout_color-relief layout_background".split(" "),layout_background:{visibility:{type:"enum",
values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",
"property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",
expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},
"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},
"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],
expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,
parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},
height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom",
"feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line",
"line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom",
"feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},
auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",
default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",
default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},
"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},
"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},
"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,
parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",
value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},
"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},
none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"\x3d\x3d":{},"!\x3d":{},"\x3e":{},"\x3e\x3d":{},"\x3c":{},"\x3c\x3d":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",
values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",
value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number",
"property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,
parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},
transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:"paint_fill paint_line paint_circle paint_heatmap paint_fill-extrusion paint_symbol paint_raster paint_hillshade paint_color-relief paint_background".split(" "),
paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,
parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],
expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},
"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,
parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],
expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",
default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom",
"feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",
default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",
value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",
values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",
default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,
parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",
transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom",
"feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,
minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom",
"feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",
value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},
"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},
"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",
default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},
"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",
default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",
default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",
transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},
"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const g="type source source-layer minzoom maxzoom filter layout".split(" ");class m{constructor(d,f,k,q){this.message=(d?`${d}: `:"")+k;q&&(this.identifier=q);null!=f&&f.__line__&&(this.line=f.__line__)}}class u extends Error{constructor(d,f){super(f);this.message=f;this.key=d}}class z{constructor(d,f=[]){this.parent=d;this.bindings={};for(const [k,q]of f)this.bindings[k]=
q}concat(d){return new z(this,d)}get(d){if(this.bindings[d])return this.bindings[d];if(this.parent)return this.parent.get(d);throw Error(`${d} not found in scope.`);}has(d){return!!this.bindings[d]||!!this.parent&&this.parent.has(d)}}const C={kind:"null"},G={kind:"number"},K={kind:"string"},R={kind:"boolean"},X={kind:"color"},ca={kind:"projectionDefinition"},ja={kind:"object"},la={kind:"value"},pa={kind:"collator"},ya={kind:"formatted"},Ba={kind:"padding"},za={kind:"colorArray"},Ea={kind:"numberArray"},
Qa={kind:"resolvedImage"},Za={kind:"variableAnchorOffsetCollection"},sb=[C,G,K,R,X,ca,ya,ja,ma(la),Ba,Ea,za,Qa,Za],ob=4/29,eb=6/29,Db=3*eb*eb,Nb=eb*eb*eb,Ob=Math.PI/180,Jb=180/Math.PI,$b=Object.hasOwn||function(d,f){return Object.prototype.hasOwnProperty.call(d,f)},vc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,
226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,
150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,
255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,
178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,
25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],
rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,
130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Bb{constructor(d,f,k,q=1,a=!0){this.r=d;this.g=f;this.b=k;this.a=q;a||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[d,f,k,q]))}static parse(d){if(d instanceof Bb)return d;if("string"==typeof d)return(d=function(f){if("transparent"===(f=f.toLowerCase().trim()))return[0,0,0,0];var k=de(vc,f);if(k){const [q,a,c]=k;return[q/255,a/255,c/255,1]}if(f.startsWith("#")&&
/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){k=6>f.length?1:2;let q=1;return[Me(f.slice(q,q+=k)),Me(f.slice(q,q+=k)),Me(f.slice(q,q+=k)),Me(f.slice(q,q+k)||"ff")]}if(f.startsWith("rgb")&&(k=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/))){const [,q,a,c,e,h,l,p,w,x,y,D]=k;f=[c||" ",l||" ",x].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f)if(f=[a,h,w].join(""),f="%%%"===f?100:""===f?255:0)if(f=
[Kf(+q/f,0,1),Kf(+e/f,0,1),Kf(+p/f,0,1),y?zg(+y,D):1],!f.some(Number.isNaN))return f;return}if(f=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/)){const [,q,a,c,e,h,l,p,w]=f;f=[a||" ",e||" ",l].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f)if(f=[+q,Kf(+c,0,100),Kf(+h,0,100),p?zg(+p,w):1],!f.some(Number.isNaN))return function([x,y,D,H]){function I(L){L=(L+x/30)%12;return D-y*Math.min(D,1-D)*Math.max(-1,
Math.min(L-3,9-L,1))}return x=Rb(x),y/=100,D/=100,[I(0),I(8),I(4),H]}(f)}}(d))?new Bb(...d,!1):void 0}get rgb(){const {r:d,g:f,b:k,a:q}=this,a=q||1/0;return this.overwriteGetter("rgb",[d/a,f/a,k/a,q])}get hcl(){var d=this.overwriteGetter;const [f,k,q,a]=ec(this.rgb);var c=Math.sqrt(k*k+q*q);c=[Math.round(1E4*c)?Rb(Math.atan2(q,k)*Jb):NaN,c,f,a];return d.call(this,"hcl",c)}get lab(){return this.overwriteGetter("lab",ec(this.rgb))}overwriteGetter(d,f){return Object.defineProperty(this,d,{value:f}),
f}toString(){const [d,f,k,q]=this.rgb;return`rgba(${[d,f,k].map(a=>Math.round(255*a)).join(",")},${q})`}static interpolate(d,f,k,q="rgb"){switch(q){case "rgb":const [a,c,e,h]=Ag(d.rgb,f.rgb,k);return new Bb(a,c,e,h,!1);case "hcl":const [l,p,w,x]=d.hcl,[y,D,H,I]=f.hcl;let L,Y;isNaN(l)||isNaN(y)?isNaN(l)?isNaN(y)?L=NaN:(L=y,1!==w&&0!==w||(Y=D)):(L=l,1!==H&&0!==H||(Y=p)):(d=y-l,y>l&&180<d?d-=360:y<l&&180<l-y&&(d+=360),L=l+k*d);const [P,Z,aa,T]=function([Fa,Ra,Ja,Ka]){return Fa=isNaN(Fa)?0:Fa*Ob,Gc([Ja,
Math.cos(Fa)*Ra,Math.sin(Fa)*Ra,Ka])}([L,null!=Y?Y:Lf(p,D,k),Lf(w,H,k),Lf(x,I,k)]);return new Bb(P,Z,aa,T,!1);case "lab":const [ha,Ca,xa,Ha]=Gc(Ag(d.lab,f.lab,k));return new Bb(ha,Ca,xa,Ha,!1)}}}Bb.black=new Bb(0,0,0,1);Bb.white=new Bb(1,1,1,1);Bb.transparent=new Bb(0,0,0,0);Bb.red=new Bb(1,0,0,1);class Yc{constructor(d,f,k){this.sensitivity=d?f?"variant":"case":f?"accent":"base";this.locale=k;this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(d,
f){return this.collator.compare(d,f)}resolvedLocale(){return(new Intl.Collator(this.locale?this.locale:[])).resolvedOptions().locale}}const md=["bottom","center","top"];class Bd{constructor(d,f,k,q,a,c){this.text=d;this.image=f;this.scale=k;this.fontStack=q;this.textColor=a;this.verticalAlign=c}}class fd{constructor(d){this.sections=d}static fromString(d){return new fd([new Bd(d,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(d=>0!==d.text.length||d.image&&
0!==d.image.name.length)}static factory(d){return d instanceof fd?d:fd.fromString(d)}toString(){return 0===this.sections.length?"":this.sections.map(d=>d.text).join("")}}class ud{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof ud)return d;if("number"==typeof d)return new ud([d,d,d,d]);if(Array.isArray(d)&&!(1>d.length||4<d.length)){for(const f of d)if("number"!=typeof f)return;switch(d.length){case 1:d=[d[0],d[0],d[0],d[0]];break;case 2:d=[d[0],d[1],d[0],d[1]];break;case 3:d=
[d[0],d[1],d[2],d[1]]}return new ud(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,f,k){return new ud(Ag(d.values,f.values,k))}}class le{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof le)return d;if("number"==typeof d)return new le([d]);if(Array.isArray(d)){for(const f of d)if("number"!=typeof f)return;return new le(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,f,k){return new le(Ag(d.values,f.values,k))}}class wd{constructor(d){this.values=
d.slice()}static parse(d){if(d instanceof wd)return d;if("string"==typeof d){var f=Bb.parse(d);return f?new wd([f]):void 0}if(Array.isArray(d)){f=[];for(const k of d){if("string"!=typeof k)return;d=Bb.parse(k);if(!d)return;f.push(d)}return new wd(f)}}toString(){return JSON.stringify(this.values)}static interpolate(d,f,k,q="rgb"){const a=[];if(d.values.length!=f.values.length)throw Error(`colorArray: Arrays have mismatched length (${d.values.length} vs. ${f.values.length}), cannot interpolate.`);for(let c=
0;c<d.values.length;c++)a.push(Bb.interpolate(d.values[c],f.values[c],k,q));return new wd(a)}}class Fd extends Error{constructor(d){super(d);this.name="RuntimeError"}toJSON(){return this.message}}const Df=new Set("center left right top bottom top-left top-right bottom-left bottom-right".split(" "));class ff{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof ff)return d;if(Array.isArray(d)&&!(1>d.length)&&0==d.length%2){for(let f=0;f<d.length;f+=2){const k=d[f],q=d[f+1];if("string"!=
typeof k||!Df.has(k)||!Array.isArray(q)||2!==q.length||"number"!=typeof q[0]||"number"!=typeof q[1])return}return new ff(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,f,k){const q=d.values,a=f.values;if(q.length!==a.length)throw new Fd(`Cannot interpolate values of different length. from: ${d.toString()}, to: ${f.toString()}`);d=[];for(f=0;f<q.length;f+=2){if(q[f]!==a[f])throw new Fd(`Cannot interpolate values containing mismatched anchors. from[${f}]: ${q[f]}, to[${f}]: ${a[f]}`);
d.push(q[f]);const [c,e]=q[f+1],[h,l]=a[f+1];d.push([Lf(c,h,k),Lf(e,l,k)])}return new ff(d)}}class we{constructor(d){this.name=d.name;this.available=d.available}toString(){return this.name}static fromString(d){return d?new we({name:d,available:!1}):null}}class ie{constructor(d,f,k){this.from=d;this.to=f;this.transition=k}static interpolate(d,f,k){return new ie(d,f,k)}static parse(d){return d instanceof ie?d:Array.isArray(d)&&3===d.length&&"string"==typeof d[0]&&"string"==typeof d[1]&&"number"==typeof d[2]?
new ie(d[0],d[1],d[2]):"object"==typeof d&&"string"==typeof d.from&&"string"==typeof d.to&&"number"==typeof d.transition?new ie(d.from,d.to,d.transition):"string"==typeof d?new ie(d,d,1):void 0}}class oe{constructor(d,f){this.type=d;this.value=f}static parse(d,f){if(2!==d.length)return f.error(`'literal' expression requires exactly one argument, but found ${d.length-1} instead.`);if(!qi(d[1]))return f.error("invalid value");d=d[1];let k=re(d);f=f.expectedType;return"array"!==k.kind||0!==k.N||!f||
"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(k=f),new oe(k,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ce={string:K,number:G,boolean:R,object:ja};class pf{constructor(d,f){this.type=d;this.args=f}static parse(d,f){if(2>d.length)return f.error("Expected at least one argument.");let k=1;var q=d[0];if("array"===q){if(2<d.length){q=d[1];if("string"!=typeof q||!(q in ce)||"object"===q)return f.error('The item type argument of "array" must be one of string, number, boolean',
1);q=ce[q];k++}else q=la;if(3<d.length){if(null!==d[2]&&("number"!=typeof d[2]||0>d[2]||d[2]!==Math.floor(d[2])))return f.error('The length argument to "array" must be a positive integer literal',2);var a=d[2];k++}a=ma(q,a)}else{if(!ce[q])throw Error(`Types doesn't contain name = ${q}`);a=ce[q]}for(q=[];k<d.length;k++){const c=f.parse(d[k],k,la);if(!c)return null;q.push(c)}return new pf(a,q)}evaluate(d){for(let f=0;f<this.args.length;f++){const k=this.args[f].evaluate(d);if(!Aa(this.type,re(k)))return k;
if(f===this.args.length-1)throw new Fd(`Expected value to be of type ${ua(this.type)}, but found ${ua(re(k))} instead.`);}throw Error();}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>d.outputDefined())}}const $i={"to-boolean":R,"to-color":X,"to-number":G,"to-string":K};class xf{constructor(d,f){this.type=d;this.args=f}static parse(d,f){if(2>d.length)return f.error("Expected at least one argument.");var k=d[0];if(!$i[k])throw Error(`Can't parse ${k} as it is not part of the known types`);
if(("to-boolean"===k||"to-string"===k)&&2!==d.length)return f.error("Expected one argument.");k=$i[k];const q=[];for(let a=1;a<d.length;a++){const c=f.parse(d[a],a,la);if(!c)return null;q.push(c)}return new xf(k,q)}evaluate(d){switch(this.type.kind){case "boolean":return!!this.args[0].evaluate(d);case "color":var f,k;for(const l of this.args){if(f=l.evaluate(d),k=null,f instanceof Bb)return f;if("string"==typeof f){var q=d.parseColor(f);if(q)return q}else if(Array.isArray(f)&&(k=3>f.length||4<f.length?
`Invalid rgba value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Vi(f[0],f[1],f[2],f[3]),!k))return new Bb(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new Fd(k||`Could not parse color from value '${"string"==typeof f?f:JSON.stringify(f)}'`);case "padding":let a;for(const l of this.args)if(a=l.evaluate(d),q=ud.parse(a))return q;throw new Fd(`Could not parse padding from value '${"string"==typeof a?a:JSON.stringify(a)}'`);case "numberArray":let c;for(const l of this.args)if(c=
l.evaluate(d),q=le.parse(c))return q;throw new Fd(`Could not parse numberArray from value '${"string"==typeof c?c:JSON.stringify(c)}'`);case "colorArray":let e;for(const l of this.args)if(e=l.evaluate(d),q=wd.parse(e))return q;throw new Fd(`Could not parse colorArray from value '${"string"==typeof e?e:JSON.stringify(e)}'`);case "variableAnchorOffsetCollection":let h;for(const l of this.args)if(h=l.evaluate(d),q=ff.parse(h))return q;throw new Fd(`Could not parse variableAnchorOffsetCollection from value '${"string"==
typeof h?h:JSON.stringify(h)}'`);case "number":f=null;for(q of this.args){if(f=q.evaluate(d),null===f)return 0;k=Number(f);if(!isNaN(k))return k}throw new Fd(`Could not convert ${JSON.stringify(f)} to number.`);case "formatted":return fd.fromString(Eh(this.args[0].evaluate(d)));case "resolvedImage":return we.fromString(Eh(this.args[0].evaluate(d)));case "projectionDefinition":return this.args[0].evaluate(d);default:return Eh(this.args[0].evaluate(d))}}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>
d.outputDefined())}}const Ch=["Unknown","Point","LineString","Polygon"];class Xh{constructor(){this.formattedSection=this.featureState=this.feature=this.globals=null;this._parseColorCache=new Map;this.canonical=this.availableImages=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ch[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&
this.feature.properties||{}}parseColor(d){let f=this._parseColorCache.get(d);return f||(f=Bb.parse(d),this._parseColorCache.set(d,f)),f}}class Dh{constructor(d,f,k=[],q,a=new z,c=[]){this.registry=d;this.path=k;this.key=k.map(e=>`[${e}]`).join("");this.scope=a;this.errors=c;this.expectedType=q;this._isConstant=f}parse(d,f,k,q,a={}){return f?this.concat(f,k,q)._parse(d,a):this._parse(d,a)}_parse(d,f){function k(c,e,h){return"assert"===h?new pf(e,[c]):"coerce"===h?new xf(e,[c]):c}if(null!==d&&"string"!=
typeof d&&"boolean"!=typeof d&&"number"!=typeof d||(d=["literal",d]),Array.isArray(d)){if(0===d.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var q=d[0];if("string"!=typeof q)return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;var a=this.registry[q];if(a){d=a.parse(d,this);if(!d)return null;if(this.expectedType)if(q=this.expectedType,
a=d.type,"string"!==q.kind&&"number"!==q.kind&&"boolean"!==q.kind&&"object"!==q.kind&&"array"!==q.kind||"value"!==a.kind)if("projectionDefinition"===q.kind&&["string","array"].includes(a.kind)||["color","formatted","resolvedImage"].includes(q.kind)&&["value","string"].includes(a.kind)||["padding","numberArray"].includes(q.kind)&&["value","number","array"].includes(a.kind)||"colorArray"===q.kind&&["value","string","array"].includes(a.kind)||"variableAnchorOffsetCollection"===q.kind&&["value","array"].includes(a.kind))d=
k(d,q,f.typeAnnotation||"coerce");else{if(this.checkSubtype(q,a))return null}else d=k(d,q,f.typeAnnotation||"assert");if(!(d instanceof oe)&&"resolvedImage"!==d.type.kind&&this._isConstant(d)){f=new Xh;try{d=new oe(d.type,d.evaluate(f))}catch(c){return this.error(c.message),null}}return d}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===d?"'undefined' value invalid. Use null instead.":"object"==typeof d?'Bare objects invalid. Use ["literal", {...}] instead.':
`Expected an array, but found ${typeof d} instead.`)}concat(d,f,k){d="number"==typeof d?this.path.concat(d):this.path;k=k?this.scope.concat(k):this.scope;return new Dh(this.registry,this._isConstant,d,f||null,k,this.errors)}error(d,...f){f=`${this.key}${f.map(k=>`[${k}]`).join("")}`;this.errors.push(new u(f,d))}checkSubtype(d,f){d=Aa(d,f);return d&&this.error(d),d}}class Fe{constructor(d,f){this.type=f.type;this.bindings=[].concat(d);this.result=f}evaluate(d){return this.result.evaluate(d)}eachChild(d){for(const f of this.bindings)d(f[1]);
d(this.result)}static parse(d,f){if(4>d.length)return f.error(`Expected at least 3 arguments, but found ${d.length-1} instead.`);const k=[];for(let q=1;q<d.length-1;q+=2){const a=d[q];if("string"!=typeof a)return f.error(`Expected string, but found ${typeof a} instead.`,q);if(/[^a-zA-Z0-9_]/.test(a))return f.error("Variable names must contain only alphanumeric characters or '_'.",q);const c=f.parse(d[q+1],q+1);if(!c)return null;k.push([a,c])}return(d=f.parse(d[d.length-1],d.length-1,f.expectedType,
k))?new Fe(k,d):null}outputDefined(){return this.result.outputDefined()}}class Se{constructor(d,f){this.type=f.type;this.name=d;this.boundExpression=f}static parse(d,f){if(2!==d.length||"string"!=typeof d[1])return f.error("'var' expression requires exactly one string literal argument.");d=d[1];return f.scope.has(d)?new Se(d,f.scope.get(d)):f.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(d){return this.boundExpression.evaluate(d)}eachChild(){}outputDefined(){return!1}}
class rg{constructor(d,f,k){this.type=d;this.index=f;this.input=k}static parse(d,f){if(3!==d.length)return f.error(`Expected 2 arguments, but found ${d.length-1} instead.`);const k=f.parse(d[1],1,G);d=f.parse(d[2],2,ma(f.expectedType||la));return k&&d?new rg(d.type.itemType,k,d):null}evaluate(d){const f=this.index.evaluate(d);d=this.input.evaluate(d);if(0>f)throw new Fd(`Array index out of bounds: ${f} < 0.`);if(f>=d.length)throw new Fd(`Array index out of bounds: ${f} > ${d.length-1}.`);if(f!==Math.floor(f))throw new Fd(`Array index must be an integer, but found ${f} instead.`);
return d[f]}eachChild(d){d(this.index);d(this.input)}outputDefined(){return!1}}class Hj{constructor(d,f){this.type=R;this.needle=d;this.haystack=f}static parse(d,f){if(3!==d.length)return f.error(`Expected 2 arguments, but found ${d.length-1} instead.`);const k=f.parse(d[1],1,la);d=f.parse(d[2],2,la);return k&&d?Ua(k.type,[R,K,G,C,la])?new Hj(k,d):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${ua(k.type)} instead`):null}evaluate(d){const f=this.needle.evaluate(d);
d=this.haystack.evaluate(d);if(!d)return!1;if(!fb(f,["boolean","string","number","null"]))throw new Fd(`Expected first argument to be of type boolean, string, number or null, but found ${ua(re(f))} instead.`);if(!fb(d,["string","array"]))throw new Fd(`Expected second argument to be of type array or string, but found ${ua(re(d))} instead.`);return 0<=d.indexOf(f)}eachChild(d){d(this.needle);d(this.haystack)}outputDefined(){return!0}}class ek{constructor(d,f,k){this.type=G;this.needle=d;this.haystack=
f;this.fromIndex=k}static parse(d,f){if(2>=d.length||5<=d.length)return f.error(`Expected 2 or 3 arguments, but found ${d.length-1} instead.`);const k=f.parse(d[1],1,la),q=f.parse(d[2],2,la);return k&&q?Ua(k.type,[R,K,G,C,la])?4===d.length?(d=f.parse(d[3],3,G))?new ek(k,q,d):null:new ek(k,q):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${ua(k.type)} instead`):null}evaluate(d){const f=this.needle.evaluate(d),k=this.haystack.evaluate(d);if(!fb(f,["boolean",
"string","number","null"]))throw new Fd(`Expected first argument to be of type boolean, string, number or null, but found ${ua(re(f))} instead.`);let q;if(this.fromIndex&&(q=this.fromIndex.evaluate(d)),fb(k,["string"]))return d=k.indexOf(f,q),-1===d?-1:[...k.slice(0,d)].length;if(fb(k,["array"]))return k.indexOf(f,q);throw new Fd(`Expected second argument to be of type array or string, but found ${ua(re(k))} instead.`);}eachChild(d){d(this.needle);d(this.haystack);this.fromIndex&&d(this.fromIndex)}outputDefined(){return!1}}
class sl{constructor(d,f,k,q,a,c){this.inputType=d;this.type=f;this.input=k;this.cases=q;this.outputs=a;this.otherwise=c}static parse(d,f){if(5>d.length)return f.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if(1!=d.length%2)return f.error("Expected an even number of arguments.");let k,q;f.expectedType&&"value"!==f.expectedType.kind&&(q=f.expectedType);const a={},c=[];for(var e=2;e<d.length-1;e+=2){var h=d[e];const l=d[e+1];Array.isArray(h)||(h=[h]);const p=f.concat(e);if(0===
h.length)return p.error("Expected at least one branch label.");for(const w of h){if("number"!=typeof w&&"string"!=typeof w)return p.error("Branch labels must be numbers or strings.");if("number"==typeof w&&Math.abs(w)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof w&&Math.floor(w)!==w)return p.error("Numeric branch labels must be integer values.");if(k){if(p.checkSubtype(k,re(w)))return null}else k=re(w);if(void 0!==
a[String(w)])return p.error("Branch labels must be unique.");a[String(w)]=c.length}h=f.parse(l,e,q);if(!h)return null;q=q||h.type;c.push(h)}e=f.parse(d[1],1,la);return e?(d=f.parse(d[d.length-1],d.length-1,q))?"value"!==e.type.kind&&f.concat(1).checkSubtype(k,e.type)?null:new sl(k,q,e,a,c,d):null:null}evaluate(d){const f=this.input.evaluate(d);return(re(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(d)}eachChild(d){d(this.input);this.outputs.forEach(d);d(this.otherwise)}outputDefined(){return this.outputs.every(d=>
d.outputDefined())&&this.otherwise.outputDefined()}}class cf{constructor(d,f,k){this.type=d;this.branches=f;this.otherwise=k}static parse(d,f){if(4>d.length)return f.error(`Expected at least 3 arguments, but found only ${d.length-1}.`);if(0!=d.length%2)return f.error("Expected an odd number of arguments.");let k;f.expectedType&&"value"!==f.expectedType.kind&&(k=f.expectedType);const q=[];for(let a=1;a<d.length-1;a+=2){const c=f.parse(d[a],a,R);if(!c)return null;const e=f.parse(d[a+1],a+1,k);if(!e)return null;
q.push([c,e]);k=k||e.type}d=f.parse(d[d.length-1],d.length-1,k);if(!d)return null;if(!k)throw Error("Can't infer output type");return new cf(k,q,d)}evaluate(d){for(const [f,k]of this.branches)if(f.evaluate(d))return k.evaluate(d);return this.otherwise.evaluate(d)}eachChild(d){for(const [f,k]of this.branches)d(f),d(k);d(this.otherwise)}outputDefined(){return this.branches.every(([,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class Yk{constructor(d,f,k,q){this.type=d;this.input=f;this.beginIndex=
k;this.endIndex=q}static parse(d,f){if(2>=d.length||5<=d.length)return f.error(`Expected 2 or 3 arguments, but found ${d.length-1} instead.`);const k=f.parse(d[1],1,la),q=f.parse(d[2],2,G);return k&&q?Ua(k.type,[ma(la),K,la])?4===d.length?(d=f.parse(d[3],3,G))?new Yk(k.type,k,q,d):null:new Yk(k.type,k,q):f.error(`Expected first argument to be of type array or string, but found ${ua(k.type)} instead`):null}evaluate(d){const f=this.input.evaluate(d),k=this.beginIndex.evaluate(d);let q;if(this.endIndex&&
(q=this.endIndex.evaluate(d)),fb(f,["string"]))return[...f].slice(k,q).join("");if(fb(f,["array"]))return f.slice(k,q);throw new Fd(`Expected first argument to be of type array or string, but found ${ua(re(f))} instead.`);}eachChild(d){d(this.input);d(this.beginIndex);this.endIndex&&d(this.endIndex)}outputDefined(){return!1}}class nh{constructor(d,f,k){this.type=d;this.input=f;this.labels=[];this.outputs=[];for(const [q,a]of k)this.labels.push(q),this.outputs.push(a)}static parse(d,f){if(4>d.length-
1)return f.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if(0!=(d.length-1)%2)return f.error("Expected an even number of arguments.");const k=f.parse(d[1],1,G);if(!k)return null;const q=[];let a=null;f.expectedType&&"value"!==f.expectedType.kind&&(a=f.expectedType);for(let e=1;e<d.length;e+=2){const h=1===e?-1/0:d[e];var c=d[e+1];const l=e,p=e+1;if("number"!=typeof h)return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',
l);if(q.length&&q[q.length-1][0]>=h)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);c=f.parse(c,p,a);if(!c)return null;a=a||c.type;q.push([h,c])}return new nh(a,k,q)}evaluate(d){const f=this.labels,k=this.outputs;if(1===f.length)return k[0].evaluate(d);const q=this.input.evaluate(d);if(q<=f[0])return k[0].evaluate(d);const a=f.length;return q>=f[a-1]?k[a-1].evaluate(d):k[ok(f,q)].evaluate(d)}eachChild(d){d(this.input);for(const f of this.outputs)d(f)}outputDefined(){return this.outputs.every(d=>
d.outputDefined())}}var rk,Wi,sk=function(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}(function(){function d(f,k,q,a){this.cx=3*f;this.bx=3*(q-f)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*k;this.by=3*(a-k)-this.cy;this.ay=1-this.cy-this.by;this.p1x=f;this.p1y=k;this.p2x=q;this.p2y=a}return Wi?rk:(Wi=1,rk=d,d.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*
this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,k){if(void 0===k&&(k=1E-6),0>f)return 0;if(1<f)return 1;for(var q=f,a=0;8>a;a++){var c=this.sampleCurveX(q)-f;if(Math.abs(c)<k)return q;var e=this.sampleCurveDerivativeX(q);if(1E-6>Math.abs(e))break;q-=c/e}e=0;var h=1;q=f;for(a=0;20>a&&(c=this.sampleCurveX(q),!(Math.abs(c-f)<k));a++)f>c?e=q:h=q,q=.5*(h-e)+e;return q},solve:function(f,k){return this.sampleCurveY(this.solveCurveX(f,k))}},rk)}());class lg{constructor(d,f,k,q,a){this.type=d;this.operator=
f;this.interpolation=k;this.input=q;this.labels=[];this.outputs=[];for(const [c,e]of a)this.labels.push(c),this.outputs.push(e)}static interpolationFactor(d,f,k,q){let a=0;"exponential"===d.name?a=Nj(f,d.base,k,q):"linear"===d.name?a=Nj(f,1,k,q):"cubic-bezier"===d.name&&(d=d.controlPoints,a=(new sk(d[0],d[1],d[2],d[3])).solve(Nj(f,1,k,q)));return a}static parse(d,f){let [k,q,a,...c]=d;if(!Array.isArray(q)||0===q.length)return f.error("Expected an interpolation type expression.",1);if("linear"===q[0])q=
{name:"linear"};else if("exponential"===q[0]){var e=q[1];if("number"!=typeof e)return f.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:e}}else{if("cubic-bezier"!==q[0])return f.error(`Unknown interpolation type ${String(q[0])}`,1,0);e=q.slice(1);if(4!==e.length||e.some(l=>"number"!=typeof l||0>l||1<l))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:e}}if(4>d.length-
1)return f.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if(0!=(d.length-1)%2)return f.error("Expected an even number of arguments.");if(a=f.parse(a,2,G),!a)return null;d=[];e=null;"interpolate-hcl"!==k&&"interpolate-lab"!==k||f.expectedType==za?f.expectedType&&"value"!==f.expectedType.kind&&(e=f.expectedType):e=X;for(let l=0;l<c.length;l+=2){const p=c[l];var h=c[l+1];const w=l+3,x=l+4;if("number"!=typeof p)return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',
w);if(d.length&&d[d.length-1][0]>=p)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',w);h=f.parse(h,x,e);if(!h)return null;e=e||h.type;d.push([p,h])}return pb(e,G)||pb(e,ca)||pb(e,X)||pb(e,Ba)||pb(e,Ea)||pb(e,za)||pb(e,Za)||pb(e,ma(G))?new lg(e,k,q,a,d):f.error(`Type ${ua(e)} is not interpolatable.`)}evaluate(d){var f=this.labels;const k=this.outputs;if(1===f.length)return k[0].evaluate(d);var q=this.input.evaluate(d);
if(q<=f[0])return k[0].evaluate(d);var a=f.length;if(q>=f[a-1])return k[a-1].evaluate(d);a=ok(f,q);f=lg.interpolationFactor(this.interpolation,q,f[a],f[a+1]);q=k[a].evaluate(d);d=k[a+1].evaluate(d);switch(this.operator){case "interpolate":switch(this.type.kind){case "number":return Lf(q,d,f);case "color":return Bb.interpolate(q,d,f);case "padding":return ud.interpolate(q,d,f);case "colorArray":return wd.interpolate(q,d,f);case "numberArray":return le.interpolate(q,d,f);case "variableAnchorOffsetCollection":return ff.interpolate(q,
d,f);case "array":return Ag(q,d,f);case "projectionDefinition":return ie.interpolate(q,d,f)}case "interpolate-hcl":switch(this.type.kind){case "color":return Bb.interpolate(q,d,f,"hcl");case "colorArray":return wd.interpolate(q,d,f,"hcl")}case "interpolate-lab":switch(this.type.kind){case "color":return Bb.interpolate(q,d,f,"lab");case "colorArray":return wd.interpolate(q,d,f,"lab")}}}eachChild(d){d(this.input);for(const f of this.outputs)d(f)}outputDefined(){return this.outputs.every(d=>d.outputDefined())}}
const ig={color:Bb.interpolate,number:Lf,padding:ud.interpolate,numberArray:le.interpolate,colorArray:wd.interpolate,variableAnchorOffsetCollection:ff.interpolate,array:Ag};class Yh{constructor(d,f){this.type=d;this.args=f}static parse(d,f){if(2>d.length)return f.error("Expected at least one argument.");let k=null;const q=f.expectedType;q&&"value"!==q.kind&&(k=q);const a=[];for(const c of d.slice(1)){d=f.parse(c,1+a.length,k,void 0,{typeAnnotation:"omit"});if(!d)return null;k=k||d.type;a.push(d)}if(!k)throw Error("No output type");
f=q&&a.some(c=>Aa(q,c.type));return new Yh(f?la:k,a)}evaluate(d){let f,k=null,q=0;for(const a of this.args)if(q++,k=a.evaluate(d),k&&k instanceof we&&!k.available&&(f||(f=k.name),k=null,q===this.args.length&&(k=f)),null!==k)break;return k}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>d.outputDefined())}}const oi=mh("\x3d\x3d",function(d,f,k){return f===k},Ui),Bn=mh("!\x3d",function(d,f,k){return f!==k},function(d,f,k,q){return!Ui(0,f,k,q)}),jn=mh("\x3c",function(d,f,
k){return f<k},function(d,f,k,q){return 0>q.compare(f,k)}),Vk=mh("\x3e",function(d,f,k){return f>k},function(d,f,k,q){return 0<q.compare(f,k)}),Sl=mh("\x3c\x3d",function(d,f,k){return f<=k},function(d,f,k,q){return 0>=q.compare(f,k)}),se=mh("\x3e\x3d",function(d,f,k){return f>=k},function(d,f,k,q){return 0<=q.compare(f,k)});class Wk{constructor(d,f,k){this.type=pa;this.locale=k;this.caseSensitive=d;this.diacriticSensitive=f}static parse(d,f){if(2!==d.length)return f.error("Expected one argument.");
d=d[1];if("object"!=typeof d||Array.isArray(d))return f.error("Collator options argument must be an object.");const k=f.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,R);if(!k)return null;const q=f.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,R);if(!q)return null;let a=null;return d.locale&&(a=f.parse(d.locale,1,K),!a)?null:new Wk(k,q,a)}evaluate(d){return new Yc(this.caseSensitive.evaluate(d),this.diacriticSensitive.evaluate(d),this.locale?this.locale.evaluate(d):
null)}eachChild(d){d(this.caseSensitive);d(this.diacriticSensitive);this.locale&&d(this.locale)}outputDefined(){return!1}}class Cl{constructor(d,f,k,q,a){this.type=K;this.number=d;this.locale=f;this.currency=k;this.minFractionDigits=q;this.maxFractionDigits=a}static parse(d,f){if(3!==d.length)return f.error("Expected two arguments.");const k=f.parse(d[1],1,G);if(!k)return null;d=d[2];if("object"!=typeof d||Array.isArray(d))return f.error("NumberFormat options argument must be an object.");let q=null;
if(d.locale&&(q=f.parse(d.locale,1,K),!q))return null;let a=null;if(d.currency&&(a=f.parse(d.currency,1,K),!a))return null;let c=null;if(d["min-fraction-digits"]&&(c=f.parse(d["min-fraction-digits"],1,G),!c))return null;let e=null;return d["max-fraction-digits"]&&(e=f.parse(d["max-fraction-digits"],1,G),!e)?null:new Cl(k,q,a,c,e)}evaluate(d){return(new Intl.NumberFormat(this.locale?this.locale.evaluate(d):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(d):
void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(d):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(d):void 0})).format(this.number.evaluate(d))}eachChild(d){d(this.number);this.locale&&d(this.locale);this.currency&&d(this.currency);this.minFractionDigits&&d(this.minFractionDigits);this.maxFractionDigits&&d(this.maxFractionDigits)}outputDefined(){return!1}}class pi{constructor(d){this.type=ya;this.sections=d}static parse(d,f){if(2>
d.length)return f.error("Expected at least one argument.");var k=d[1];if(!Array.isArray(k)&&"object"==typeof k)return f.error("First argument must be an image or text section.");k=[];var q=!1;for(let e=1;e<=d.length-1;++e){var a=d[e];if(q&&"object"==typeof a&&!Array.isArray(a)){q=!1;var c=null;if(a["font-scale"]&&(c=f.parse(a["font-scale"],1,G),!c))return null;let h=null;if(a["text-font"]&&(h=f.parse(a["text-font"],1,ma(K)),!h))return null;let l=null;if(a["text-color"]&&(l=f.parse(a["text-color"],
1,X),!l))return null;let p=null;if(a["vertical-align"]){if("string"==typeof a["vertical-align"]&&!md.includes(a["vertical-align"]))return f.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(p=f.parse(a["vertical-align"],1,K),!p)return null}a=k[k.length-1];a.scale=c;a.font=h;a.textColor=l;a.verticalAlign=p}else{c=f.parse(d[e],1,la);if(!c)return null;q=c.type.kind;if("string"!==q&&"value"!==q&&"null"!==q&&"resolvedImage"!==q)return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
q=!0;k.push({content:c,scale:null,font:null,textColor:null,verticalAlign:null})}}return new pi(k)}evaluate(d){return new fd(this.sections.map(f=>{const k=f.content.evaluate(d);return re(k)===Qa?new Bd("",k,null,null,null,f.verticalAlign?f.verticalAlign.evaluate(d):null):new Bd(Eh(k),null,f.scale?f.scale.evaluate(d):null,f.font?f.font.evaluate(d).join(","):null,f.textColor?f.textColor.evaluate(d):null,f.verticalAlign?f.verticalAlign.evaluate(d):null)}))}eachChild(d){for(const f of this.sections)d(f.content),
f.scale&&d(f.scale),f.font&&d(f.font),f.textColor&&d(f.textColor),f.verticalAlign&&d(f.verticalAlign)}outputDefined(){return!1}}class jg{constructor(d){this.type=Qa;this.input=d}static parse(d,f){return 2!==d.length?f.error("Expected two arguments."):(d=f.parse(d[1],1,K))?new jg(d):f.error("No image name provided.")}evaluate(d){const f=this.input.evaluate(d),k=we.fromString(f);return k&&d.availableImages&&(k.available=-1<d.availableImages.indexOf(f)),k}eachChild(d){d(this.input)}outputDefined(){return!1}}
class oj{constructor(d){this.type=G;this.input=d}static parse(d,f){return 2!==d.length?f.error(`Expected 1 argument, but found ${d.length-1} instead.`):(d=f.parse(d[1],1))?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?f.error(`Expected argument of type string or array, but found ${ua(d.type)} instead.`):new oj(d):null}evaluate(d){d=this.input.evaluate(d);if("string"==typeof d)return[...d].length;if(Array.isArray(d))return d.length;throw new Fd(`Expected value to be of type string or array, but found ${ua(re(d))} instead.`);
}eachChild(d){d(this.input)}outputDefined(){return!1}}class pj{constructor(d,f){this.type=R;this.geojson=d;this.geometries=f}static parse(d,f){if(2!==d.length)return f.error(`'within' expression requires exactly one argument, but found ${d.length-1} instead.`);if(qi(d[1]))if(d=d[1],"FeatureCollection"===d.type){const q=[];for(var k of d.features){const {type:a,coordinates:c}=k.geometry;"Polygon"===a&&q.push(c);"MultiPolygon"===a&&q.push(...c)}if(q.length)return new pj(d,{type:"MultiPolygon",coordinates:q})}else if("Feature"===
d.type){if(k=d.geometry.type,"Polygon"===k||"MultiPolygon"===k)return new pj(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new pj(d,d);return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(d){if(null!=d.geometry()&&null!=d.canonicalID()){if("Point"===d.geometryType())return function(f,k){var q=[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0],c=f.canonicalID();if("Polygon"===k.type){const e=oh(k.coordinates,a,c),
h=tk(f.geometry(),q,a,c);if(!Cg(q,a))return!1;for(const l of h)if(!te(l,e))return!1}if("MultiPolygon"===k.type){k=Id(k.coordinates,a,c);f=tk(f.geometry(),q,a,c);if(!Cg(q,a))return!1;for(const e of f){a:{for(const h of k)if(te(e,h)){q=!0;break a}q=!1}if(!q)return!1}}return!0}(d,this.geometries);if("LineString"===d.geometryType())return function(f,k){var q=[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0],c=f.canonicalID();if("Polygon"===k.type){const e=oh(k.coordinates,a,c),h=ph(f.geometry(),q,a,c);
if(!Cg(q,a))return!1;for(const l of h)if(!Zh(l,e))return!1}if("MultiPolygon"===k.type){k=Id(k.coordinates,a,c);f=ph(f.geometry(),q,a,c);if(!Cg(q,a))return!1;for(const e of f){a:{for(const h of k)if(Zh(e,h)){q=!0;break a}q=!1}if(!q)return!1}}return!0}(d,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let nk=class{constructor(d=[],f=(k,q)=>k<q?-1:k>q?1:0){if(this.data=d,this.length=this.data.length,this.compare=f,0<this.length)for(d=(this.length>>1)-1;0<=d;d--)this._down(d)}push(d){this.data.push(d);
this._up(this.length++)}pop(){if(0!==this.length){var d=this.data[0],f=this.data.pop();return 0<--this.length&&(this.data[0]=f,this._down(0)),d}}peek(){return this.data[0]}_up(d){const {data:f,compare:k}=this,q=f[d];for(;0<d;){const a=d-1>>1,c=f[a];if(0<=k(q,c))break;f[d]=c;d=a}f[d]=q}_down(d){const {data:f,compare:k}=this,q=this.length>>1,a=f[d];for(;d<q;){let c=1+(d<<1);const e=c+1;if(e<this.length&&0>k(f[e],f[c])&&(c=e),0<=k(f[c],a))break;f[d]=f[c];d=c}f[d]=a}};const Fh=1/298.257223563,Xk=Fh*(2-
Fh),pk=Math.PI/180;class Oj{constructor(d){const f=6378137*pk;d=Math.cos(d*pk);const k=1/(1-Xk*(1-d*d)),q=Math.sqrt(k);this.kx=f*q*d;this.ky=f*q*k*(1-Xk)}distance(d,f){const k=this.wrap(d[0]-f[0])*this.kx;d=(d[1]-f[1])*this.ky;return Math.sqrt(k*k+d*d)}pointOnLine(d,f){let k,q,a,c,e=1/0;for(let l=0;l<d.length-1;l++){let p=d[l][0],w=d[l][1];var h=this.wrap(d[l+1][0]-p)*this.kx;let x=(d[l+1][1]-w)*this.ky,y=0;0===h&&0===x||(y=(this.wrap(f[0]-p)*this.kx*h+(f[1]-w)*this.ky*x)/(h*h+x*x),1<y?(p=d[l+1][0],
w=d[l+1][1]):0<y&&(p+=h/this.kx*y,w+=x/this.ky*y));h=this.wrap(f[0]-p)*this.kx;x=(f[1]-w)*this.ky;h=h*h+x*x;h<e&&(e=h,k=p,q=w,a=l,c=y)}return{point:[k,q],index:a,t:Math.max(0,Math.min(1,c))}}wrap(d){for(;-180>d;)d+=360;for(;180<d;)d-=360;return d}}class rj{constructor(d,f){this.type=G;this.geojson=d;this.geometries=f}static parse(d,f){if(2!==d.length)return f.error(`'distance' expression requires exactly one argument, but found ${d.length-1} instead.`);if(qi(d[1])){d=d[1];if("FeatureCollection"===
d.type)return new rj(d,d.features.map(k=>rh(k.geometry)).flat());if("Feature"===d.type)return new rj(d,rh(d.geometry));if("type"in d&&"coordinates"in d)return new rj(d,rh(d))}return f.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(d){if(null!=d.geometry()&&null!=d.canonicalID()){if("Point"===d.geometryType())return function(f,k){var q=f.geometry();const a=q.flat().map(e=>ri([e.x,e.y],f.canonical));if(0===q.length)return NaN;q=new Oj(a[0][1]);
let c=1/0;for(const e of k){switch(e.type){case "Point":c=Math.min(c,wi(a,!1,[e.coordinates],!1,q,c));break;case "LineString":c=Math.min(c,wi(a,!1,e.coordinates,!0,q,c));break;case "Polygon":c=Math.min(c,Ih(a,!1,e.coordinates,q,c))}if(0===c)break}return c}(d,this.geometries);if("LineString"===d.geometryType())return function(f,k){var q=f.geometry();const a=q.flat().map(e=>ri([e.x,e.y],f.canonical));if(0===q.length)return NaN;q=new Oj(a[0][1]);let c=1/0;for(const e of k){switch(e.type){case "Point":c=
Math.min(c,wi(a,!0,[e.coordinates],!1,q,c));break;case "LineString":c=Math.min(c,wi(a,!0,e.coordinates,!0,q,c));break;case "Polygon":c=Math.min(c,Ih(a,!0,e.coordinates,q,c))}if(0===c)break}return c}(d,this.geometries);if("Polygon"===d.geometryType())return function(f,k){var q=f.geometry();if(0===q.length||0===q[0].length)return NaN;q=Yi(q,0).map(e=>e.map(h=>h.map(l=>ri([l.x,l.y],f.canonical))));const a=new Oj(q[0][0][0][1]);let c=1/0;for(const e of k)for(const h of q){switch(e.type){case "Point":c=
Math.min(c,Ih([e.coordinates],!1,h,a,c));break;case "LineString":c=Math.min(c,Ih(e.coordinates,!0,h,a,c));break;case "Polygon":c=Math.min(c,Zi(h,e.coordinates,a,c))}if(0===c)return c}return c}(d,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Xi{constructor(d){this.type=la;this.key=d}static parse(d,f){if(2!==d.length)return f.error(`Expected 1 argument, but found ${d.length-1} instead.`);const k=d[1];return null==k?f.error("Global state property must be defined."):"string"!=
typeof k?f.error(`Global state property must be string, but found ${typeof d[1]} instead.`):new Xi(k)}evaluate(d){var f;return(d=null===(f=d.globals)||void 0===f?void 0:f.globalState)&&0!==Object.keys(d).length?de(d,this.key):null}eachChild(){}outputDefined(){return!1}}const si={"\x3d\x3d":oi,"!\x3d":Bn,"\x3e":Vk,"\x3c":jn,"\x3e\x3d":se,"\x3c\x3d":Sl,array:pf,at:rg,boolean:pf,case:cf,coalesce:Yh,collator:Wk,format:pi,image:jg,in:Hj,"index-of":ek,interpolate:lg,"interpolate-hcl":lg,"interpolate-lab":lg,
length:oj,let:Fe,literal:oe,match:sl,number:pf,"number-format":Cl,object:pf,slice:Yk,step:nh,string:pf,"to-boolean":xf,"to-color":xf,"to-number":xf,"to-string":xf,var:Se,within:pj,distance:rj,"global-state":Xi};class mg{constructor(d,f,k,q){this.name=d;this.type=f;this._evaluate=k;this.args=q}evaluate(d){return this._evaluate(d,this.args)}eachChild(d){this.args.forEach(d)}outputDefined(){return!1}static parse(d,f){var k=d[0],q=mg.definitions[k];if(!q)return f.error(`Unknown expression "${k}". If you wanted a literal array, use ["literal", [...]].`,
0);var a=Array.isArray(q)?q[0]:q.type;q=Array.isArray(q)?[[q[1],q[2]]]:q.overloads;var c=q.filter(([w])=>!Array.isArray(w)||w.length===d.length-1);let e=null;for(const [w,x]of c){e=new Dh(f.registry,uj,f.path,null,f.scope);const y=[];var h=!1;for(var l=1;l<d.length;l++){var p=d[l];const D=Array.isArray(w)?w[l-1]:w.type;p=e.parse(p,1+y.length,D);if(!p){h=!0;break}y.push(p)}if(!h)if(Array.isArray(w)&&w.length!==y.length)e.error(`Expected ${w.length} arguments, but found ${y.length} instead.`);else{for(h=
0;h<y.length;h++)l=Array.isArray(w)?w[h]:w.type,p=y[h],e.concat(h+1).checkSubtype(l,p.type);if(0===e.errors.length)return new mg(k,a,x,y)}}if(1===c.length)f.errors.push(...e.errors);else{k=(c.length?c:q).map(([w])=>Array.isArray(w)?`(${w.map(ua).join(", ")})`:`(${ua(w.type)}...)`).join(" | ");a=[];for(q=1;q<d.length;q++){c=f.parse(d[q],1+a.length);if(!c)return null;a.push(ua(c.type))}f.error(`Expected arguments of type ${k}, but found (${a.join(", ")}) instead.`)}return null}static register(d,f){mg.definitions=
f;for(const k in f)d[k]=mg}}mg.register(si,{error:[{kind:"error"},[K],(d,[f])=>{throw new Fd(f.evaluate(d));}],typeof:[K,[la],(d,[f])=>ua(re(f.evaluate(d)))],"to-rgba":[ma(G,4),[X],(d,[f])=>{const [k,q,a,c]=f.evaluate(d).rgb;return[255*k,255*q,255*a,c]}],rgb:[X,[G,G,G],yf],rgba:[X,[G,G,G,G],yf],has:{type:R,overloads:[[[K],(d,[f])=>{f=f.evaluate(d);d=d.properties();return f in d}],[[K,ja],(d,[f,k])=>{f=f.evaluate(d);d=k.evaluate(d);return f in d}]]},get:{type:la,overloads:[[[K],(d,[f])=>Jh(f.evaluate(d),
d.properties())],[[K,ja],(d,[f,k])=>Jh(f.evaluate(d),k.evaluate(d))]]},"feature-state":[la,[K],(d,[f])=>Jh(f.evaluate(d),d.featureState||{})],properties:[ja,[],d=>d.properties()],"geometry-type":[K,[],d=>d.geometryType()],id:[la,[],d=>d.id()],zoom:[G,[],d=>d.globals.zoom],"heatmap-density":[G,[],d=>d.globals.heatmapDensity||0],elevation:[G,[],d=>d.globals.elevation||0],"line-progress":[G,[],d=>d.globals.lineProgress||0],accumulated:[la,[],d=>void 0===d.globals.accumulated?null:d.globals.accumulated],
"+":[G,{type:G},(d,f)=>{let k=0;for(const q of f)k+=q.evaluate(d);return k}],"*":[G,{type:G},(d,f)=>{let k=1;for(const q of f)k*=q.evaluate(d);return k}],"-":{type:G,overloads:[[[G,G],(d,[f,k])=>f.evaluate(d)-k.evaluate(d)],[[G],(d,[f])=>-f.evaluate(d)]]},"/":[G,[G,G],(d,[f,k])=>f.evaluate(d)/k.evaluate(d)],"%":[G,[G,G],(d,[f,k])=>f.evaluate(d)%k.evaluate(d)],ln2:[G,[],()=>Math.LN2],pi:[G,[],()=>Math.PI],e:[G,[],()=>Math.E],"^":[G,[G,G],(d,[f,k])=>Math.pow(f.evaluate(d),k.evaluate(d))],sqrt:[G,[G],
(d,[f])=>Math.sqrt(f.evaluate(d))],log10:[G,[G],(d,[f])=>Math.log(f.evaluate(d))/Math.LN10],ln:[G,[G],(d,[f])=>Math.log(f.evaluate(d))],log2:[G,[G],(d,[f])=>Math.log(f.evaluate(d))/Math.LN2],sin:[G,[G],(d,[f])=>Math.sin(f.evaluate(d))],cos:[G,[G],(d,[f])=>Math.cos(f.evaluate(d))],tan:[G,[G],(d,[f])=>Math.tan(f.evaluate(d))],asin:[G,[G],(d,[f])=>Math.asin(f.evaluate(d))],acos:[G,[G],(d,[f])=>Math.acos(f.evaluate(d))],atan:[G,[G],(d,[f])=>Math.atan(f.evaluate(d))],min:[G,{type:G},(d,f)=>Math.min(...f.map(k=>
k.evaluate(d)))],max:[G,{type:G},(d,f)=>Math.max(...f.map(k=>k.evaluate(d)))],abs:[G,[G],(d,[f])=>Math.abs(f.evaluate(d))],round:[G,[G],(d,[f])=>{d=f.evaluate(d);return 0>d?-Math.round(-d):Math.round(d)}],floor:[G,[G],(d,[f])=>Math.floor(f.evaluate(d))],ceil:[G,[G],(d,[f])=>Math.ceil(f.evaluate(d))],"filter-\x3d\x3d":[R,[K,la],(d,[f,k])=>d.properties()[f.value]===k.value],"filter-id-\x3d\x3d":[R,[la],(d,[f])=>d.id()===f.value],"filter-type-\x3d\x3d":[R,[K],(d,[f])=>d.geometryType()===f.value],"filter-\x3c":[R,
[K,la],(d,[f,k])=>{d=d.properties()[f.value];k=k.value;return typeof d==typeof k&&d<k}],"filter-id-\x3c":[R,[la],(d,[f])=>{d=d.id();f=f.value;return typeof d==typeof f&&d<f}],"filter-\x3e":[R,[K,la],(d,[f,k])=>{d=d.properties()[f.value];k=k.value;return typeof d==typeof k&&d>k}],"filter-id-\x3e":[R,[la],(d,[f])=>{d=d.id();f=f.value;return typeof d==typeof f&&d>f}],"filter-\x3c\x3d":[R,[K,la],(d,[f,k])=>{d=d.properties()[f.value];k=k.value;return typeof d==typeof k&&d<=k}],"filter-id-\x3c\x3d":[R,
[la],(d,[f])=>{d=d.id();f=f.value;return typeof d==typeof f&&d<=f}],"filter-\x3e\x3d":[R,[K,la],(d,[f,k])=>{d=d.properties()[f.value];k=k.value;return typeof d==typeof k&&d>=k}],"filter-id-\x3e\x3d":[R,[la],(d,[f])=>{d=d.id();f=f.value;return typeof d==typeof f&&d>=f}],"filter-has":[R,[la],(d,[f])=>f.value in d.properties()],"filter-has-id":[R,[],d=>null!==d.id()&&void 0!==d.id()],"filter-type-in":[R,[ma(K)],(d,[f])=>0<=f.value.indexOf(d.geometryType())],"filter-id-in":[R,[ma(la)],(d,[f])=>0<=f.value.indexOf(d.id())],
"filter-in-small":[R,[K,ma(la)],(d,[f,k])=>0<=k.value.indexOf(d.properties()[f.value])],"filter-in-large":[R,[K,ma(la)],(d,[f,k])=>{a:{d=d.properties()[f.value];f=k.value;var q=0;for(k=k.value.length-1;q<=k;){const a=q+k>>1;if(f[a]===d){k=!0;break a}f[a]>d?k=a-1:q=a+1}k=!1}return k}],all:{type:R,overloads:[[[R,R],(d,[f,k])=>f.evaluate(d)&&k.evaluate(d)],[{type:R},(d,f)=>{for(const k of f)if(!k.evaluate(d))return!1;return!0}]]},any:{type:R,overloads:[[[R,R],(d,[f,k])=>f.evaluate(d)||k.evaluate(d)],
[{type:R},(d,f)=>{for(const k of f)if(k.evaluate(d))return!0;return!1}]]},"!":[R,[R],(d,[f])=>!f.evaluate(d)],"is-supported-script":[R,[K],(d,[f])=>{const k=d.globals&&d.globals.isSupportedScript;return!k||k(f.evaluate(d))}],upcase:[K,[K],(d,[f])=>f.evaluate(d).toUpperCase()],downcase:[K,[K],(d,[f])=>f.evaluate(d).toLowerCase()],concat:[K,{type:la},(d,f)=>f.map(k=>Eh(k.evaluate(d))).join("")],"resolved-locale":[K,[pa],(d,[f])=>f.evaluate(d).resolvedLocale()]});class ik{constructor(d,f,k){this.expression=
d;this._warningHistory={};this._evaluator=new Xh;this._defaultValue=f?function(q){if("color"===q.type&&Fg(q.default))return new Bb(0,0,0,0);switch(q.type){case "color":return Bb.parse(q.default)||null;case "padding":return ud.parse(q.default)||null;case "numberArray":return le.parse(q.default)||null;case "colorArray":return wd.parse(q.default)||null;case "variableAnchorOffsetCollection":return ff.parse(q.default)||null;case "projectionDefinition":return ie.parse(q.default)||null;default:return void 0===
q.default?null:q.default}}(f):null;this._enumValues=f&&"enum"===f.type?f.values:null;this._globalState=k}evaluateWithoutErrorHandling(d,f,k,q,a,c){return this._globalState&&(d=Ee(d,this._globalState)),this._evaluator.globals=d,this._evaluator.feature=f,this._evaluator.featureState=k,this._evaluator.canonical=q,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=c,this.expression.evaluate(this._evaluator)}evaluate(d,f,k,q,a,c){this._globalState&&(d=Ee(d,this._globalState));this._evaluator.globals=
d;this._evaluator.feature=f||null;this._evaluator.featureState=k||null;this._evaluator.canonical=q;this._evaluator.availableImages=a||null;this._evaluator.formattedSection=c||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Fd(`Expected value to be one of ${Object.keys(this._enumValues).map(h=>JSON.stringify(h)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||
(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}class El{constructor(d,f,k){this.kind=d;this._styleExpression=f;this.isStateDependent="constant"!==d&&!Ud(f.expression);this.globalStateRefs=Mf(f.expression);this._globalState=k}evaluateWithoutErrorHandling(d,f,k,q,a,c){return this._globalState&&(d=Ee(d,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(d,f,k,q,a,c)}evaluate(d,f,k,q,a,c){return this._globalState&&(d=Ee(d,
this._globalState)),this._styleExpression.evaluate(d,f,k,q,a,c)}}class Uh{constructor(d,f,k,q,a){this.kind=d;this.zoomStops=k;this._styleExpression=f;this.isStateDependent="camera"!==d&&!Ud(f.expression);this.globalStateRefs=Mf(f.expression);this.interpolationType=q;this._globalState=a}evaluateWithoutErrorHandling(d,f,k,q,a,c){return this._globalState&&(d=Ee(d,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(d,f,k,q,a,c)}evaluate(d,f,k,q,a,c){return this._globalState&&(d=Ee(d,
this._globalState)),this._styleExpression.evaluate(d,f,k,q,a,c)}interpolationFactor(d,f,k){return this.interpolationType?lg.interpolationFactor(this.interpolationType,d,f,k):0}}class gm{constructor(d,f){this._parameters=d;this._specification=f;ra(this,Vf(this._parameters,this._specification))}static deserialize(d){return new gm(d._parameters,d._specification)}static serialize(d){return{_parameters:d._parameters,_specification:d._specification}}}const an={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",
expression:{interpolated:!1,parameters:["zoom","feature"]}},Mm={promoteId:function({key:d,value:f}){if("string"===vd(f))return Ig({key:d,value:f});const k=[];for(const q in f)k.push(...Ig({key:`${d}.${q}`,value:f[q]}));return k}},ul={"*":()=>[],array:th,boolean:function(d){const f=d.value;d=d.key;const k=vd(f);return"boolean"!==k?[new m(d,f,`boolean expected, ${k} found`)]:[]},number:Di,color:Ei,constants:vj,enum:Gf,filter:Xf,function:cj,layer:Ne,object:Ue,source:Jg,light:bh,sky:jl,terrain:Lb,projection:function(d){const f=
d.value,k=d.styleSpec,q=k.projection,a=d.style;var c=vd(f);if(void 0===f)return[];if("object"!==c)return[new m("projection",f,`object expected, ${c} found`)];c=[];for(const e in f)c=c.concat(q[e]?d.validateSpec({key:e,value:f[e],valueSpec:q[e],style:a,styleSpec:k}):[new m(e,f[e],`unknown property "${e}"`)]);return c},projectionDefinition:function(d){const f=d.key;d=d.value;d=d instanceof String?d.valueOf():d;const k=vd(d);var q;(q="array"!==k)||(q=d,q=Array.isArray(q)&&3===q.length&&"string"==typeof q[0]&&
"string"==typeof q[1]&&"number"==typeof q[2]);return q||["interpolate","step","literal"].includes(d[0])?["array","string"].includes(k)?[]:[new m(f,d,`projection expected, invalid type "${k}" found`)]:[new m(f,d,`projection expected, invalid array ${JSON.stringify(d)} found`)]},string:Ig,formatted:function(d){return 0===Ig(d).length?[]:Af(d)},resolvedImage:function(d){return 0===Ig(d).length?[]:Af(d)},padding:function(d){const f=d.key,k=d.value;if("array"===vd(k)){if(1>k.length||4<k.length)return[new m(f,
k,`padding requires 1 to 4 values; ${k.length} values found`)];const q={type:"number"};let a=[];for(let c=0;c<k.length;c++)a=a.concat(d.validateSpec({key:`${f}[${c}]`,value:k[c],validateSpec:d.validateSpec,valueSpec:q}));return a}return Di({key:f,value:k,valueSpec:{}})},numberArray:function(d){const f=d.key,k=d.value;if("array"===vd(k)){const q={type:"number"};if(1>k.length)return[new m(f,k,"array length at least 1 expected, length 0 found")];let a=[];for(let c=0;c<k.length;c++)a=a.concat(d.validateSpec({key:`${f}[${c}]`,
value:k[c],validateSpec:d.validateSpec,valueSpec:q}));return a}return Di({key:f,value:k,valueSpec:{}})},colorArray:function(d){const f=d.key;d=d.value;if("array"===vd(d)){if(1>d.length)return[new m(f,d,"array length at least 1 expected, length 0 found")];let k=[];for(let q=0;q<d.length;q++)k=k.concat(Ei({key:`${f}[${q}]`,value:d[q]}));return k}return Ei({key:f,value:d})},variableAnchorOffsetCollection:function(d){const f=d.key,k=d.value;var q=vd(k);const a=d.styleSpec;if("array"!==q||1>k.length||
0!=k.length%2)return[new m(f,k,"variableAnchorOffsetCollection requires a non-empty array of even length")];q=[];for(let c=0;c<k.length;c+=2)q=q.concat(Gf({key:`${f}[${c}]`,value:k[c],valueSpec:a.layout_symbol["text-anchor"]})),q=q.concat(th({key:`${f}[${c+1}]`,value:k[c+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:a}));return q},sprite:nd,state:ue};kf.source=He(Ed(Jg));kf.sprite=He(Ed(nd));kf.glyphs=He(Ed(hc));kf.light=He(Ed(bh));kf.sky=He(Ed(jl));kf.terrain=
He(Ed(Lb));kf.state=He(Ed(ue));kf.layer=He(Ed(Ne));kf.filter=He(Ed(Xf));kf.paintProperty=He(Ed(Ge));kf.layoutProperty=He(Ed(Bf));const Tl=kf.light,cm=kf.sky,vl=kf.paintProperty,dm=kf.layoutProperty;class vm{constructor(d,f,k){const q=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;var a=new Int32Array(this.arrayBuffer);d=a[0];this.d=(f=a[1])+2*(k=a[2]);for(var c=0;c<this.d*this.d;c++){const e=a[3+c],h=a[3+c+1];q.push(e===h?null:a.subarray(e,h))}c=a[3+q.length+1];this.keys=a.subarray(a[3+
q.length],c);this.bboxes=a.subarray(c);this.insert=this._insertReadonly}else{this.d=f+2*k;for(a=0;a<this.d*this.d;a++)q.push([]);this.keys=[];this.bboxes=[]}this.n=f;this.extent=d;this.padding=k;this.scale=f/d;this.uid=0;f=k/f*d;this.min=-f;this.max=d+f}insert(d,f,k,q,a){this._forEachCell(f,k,q,a,this._insertCell,this.uid++,void 0,void 0);this.keys.push(d);this.bboxes.push(f);this.bboxes.push(k);this.bboxes.push(q);this.bboxes.push(a)}_insertReadonly(){throw Error("Cannot insert into a GridIndex created from an ArrayBuffer.");
}_insertCell(d,f,k,q,a,c){this.cells[a].push(c)}query(d,f,k,q,a){var c=this.min;const e=this.max;if(d<=c&&f<=c&&e<=k&&e<=q&&!a)return Array.prototype.slice.call(this.keys);c=[];return this._forEachCell(d,f,k,q,this._queryCell,c,{},a),c}_queryCell(d,f,k,q,a,c,e,h){a=this.cells[a];if(null!==a){const l=this.keys,p=this.bboxes;for(let w=0;w<a.length;w++){const x=a[w];if(void 0===e[x]){const y=4*x;(h?h(p[y+0],p[y+1],p[y+2],p[y+3]):d<=p[y+2]&&f<=p[y+3]&&k>=p[y+0]&&q>=p[y+1])?(e[x]=!0,c.push(l[x])):e[x]=
!1}}}}_forEachCell(d,f,k,q,a,c,e,h){var l=this._convertToCellCoord(d);const p=this._convertToCellCoord(f),w=this._convertToCellCoord(k),x=this._convertToCellCoord(q);for(;l<=w;l++)for(let y=p;y<=x;y++){const D=this.d*y+l;if((!h||h(this._convertFromCellCoord(l),this._convertFromCellCoord(y),this._convertFromCellCoord(l+1),this._convertFromCellCoord(y+1)))&&a.call(this,d,f,k,q,D,c,e,h))return}}_convertFromCellCoord(d){return(d-this.padding)/this.scale}_convertToCellCoord(d){return Math.max(0,Math.min(this.d-
1,Math.floor(d*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const d=this.cells;var f=3+this.cells.length+1+1,k=0;for(var q=0;q<this.cells.length;q++)k+=this.cells[q].length;k=new Int32Array(f+k+this.keys.length+this.bboxes.length);k[0]=this.extent;k[1]=this.n;k[2]=this.padding;for(q=0;q<d.length;q++){const a=d[q];k[3+q]=f;k.set(a,f);f+=a.length}return k[3+d.length]=f,k.set(this.keys,f),f+=this.keys.length,k[3+d.length+1]=f,k.set(this.bboxes,f),k.buffer}static serialize(d,
f){d=d.toArrayBuffer();return f&&f.push(d),{buffer:d}}static deserialize(d){return new vm(d.buffer)}}const aj={};Cb("Object",Object);Cb("Set",Set);Cb("TransferableGridIndex",vm);Cb("Color",Bb);Cb("Error",Error);Cb("AJAXError",Si);Cb("ResolvedImage",we);Cb("StylePropertyFunction",gm);Cb("StyleExpression",ik,{omit:["_evaluator"]});Cb("ZoomDependentExpression",Uh);Cb("ZoomConstantExpression",El);Cb("CompoundExpression",mg,{omit:["_evaluate"]});for(const d in si)si[d]._classRegistryKey||Cb(`Expression_${d}`,
si[d]);class wm{constructor(){this.first=!0}update(d,f){const k=Math.floor(d);return this.first?(this.first=!1,this.lastIntegerZoom=k,this.lastIntegerZoomTime=0,this.lastZoom=d,this.lastFloorZoom=k,!0):(this.lastFloorZoom>k?(this.lastIntegerZoom=k+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<k&&(this.lastIntegerZoom=k,this.lastIntegerZoomTime=f),d!==this.lastZoom&&(this.lastZoom=d,this.lastFloorZoom=k,!0))}}const gd={"Latin-1 Supplement":d=>128<=d&&255>=d,"Hangul Jamo":d=>4352<=d&&4607>=d,Khmer:d=>
6016<=d&&6143>=d,"General Punctuation":d=>8192<=d&&8303>=d,"Letterlike Symbols":d=>8448<=d&&8527>=d,"Number Forms":d=>8528<=d&&8591>=d,"Miscellaneous Technical":d=>8960<=d&&9215>=d,"Control Pictures":d=>9216<=d&&9279>=d,"Optical Character Recognition":d=>9280<=d&&9311>=d,"Enclosed Alphanumerics":d=>9312<=d&&9471>=d,"Geometric Shapes":d=>9632<=d&&9727>=d,"Miscellaneous Symbols":d=>9728<=d&&9983>=d,"Miscellaneous Symbols and Arrows":d=>11008<=d&&11263>=d,"Ideographic Description Characters":d=>12272<=
d&&12287>=d,"CJK Symbols and Punctuation":d=>12288<=d&&12351>=d,Hiragana:d=>12352<=d&&12447>=d,Katakana:d=>12448<=d&&12543>=d,Kanbun:d=>12688<=d&&12703>=d,"CJK Strokes":d=>12736<=d&&12783>=d,"Enclosed CJK Letters and Months":d=>12800<=d&&13055>=d,"CJK Compatibility":d=>13056<=d&&13311>=d,"Yijing Hexagram Symbols":d=>19904<=d&&19967>=d,"CJK Unified Ideographs":d=>19968<=d&&40959>=d,"Hangul Syllables":d=>44032<=d&&55215>=d,"Private Use Area":d=>57344<=d&&63743>=d,"Vertical Forms":d=>65040<=d&&65055>=
d,"CJK Compatibility Forms":d=>65072<=d&&65103>=d,"Small Form Variants":d=>65104<=d&&65135>=d,"Halfwidth and Fullwidth Forms":d=>65280<=d&&65519>=d},Nm=Md(["Arab","Dupl","Mong","Ougr","Syrc"]),Tm=Md("Bopo Hani Hira Kana Kits Nshu Tang Yiii".split(" ")),jh=Md("Adlm Arab Armi Avst Chrs Cprt Egyp Elym Gara Hatr Hebr Hung Khar Lydi Mand Mani Mend Merc Mero Narb Nbat Nkoo Orkh Palm Phli Phlp Phnx Prti Rohg Samr Sarb Sogo Syrc Thaa Todr Yezi".split(" ")),yi=new class{constructor(){this.TIMEOUT=5E3;this.processStyledBidirectionalText=
this.processBidirectionalText=this.applyArabicShaping=null;this.pluginStatus="unavailable";this.pluginURL=null;this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus;this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(yi.isParsed())throw Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping;this.processBidirectionalText=d.processBidirectionalText;this.processStyledBidirectionalText=
d.processStyledBidirectionalText;this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,f){return v(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if("loading"!==d.pluginStatus)return this.setState(d),d;var k=d.pluginURL;const q=new Promise(c=>{this.loadScriptResolve=c});f(k);const a=new Promise(c=>setTimeout(()=>
c(),this.TIMEOUT));if(yield Promise.race([q,a]),this.isParsed())return k={pluginStatus:"loaded",pluginURL:k},this.setState(k),k;throw this.setState({pluginStatus:"error",pluginURL:""}),Error(`RTL Text Plugin failed to import scripts from ${k}`);})}};class me{constructor(d,f){this.isSupportedScript=Jd;this.zoom=d;f?(this.now=f.now||0,this.fadeDuration=f.fadeDuration||0,this.zoomHistory=f.zoomHistory||new wm,this.transition=f.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wm,this.transition=
{})}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const d=this.zoom,f=d-Math.floor(d),k=this.crossFadingFactor();return d>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*k}:{fromScale:.5,toScale:1,t:1-(1-k)*f}}}class xm{constructor(d,f,k){this.property=d;this.value=f;this.expression=function(q,a,c){if(Fg(q))return new gm(q,a);if(Ff(q)){q=kg(q,a,c);if("error"===q.result)throw Error(q.value.map(h=>
`${h.key}: ${h.message}`).join(", "));return q.value}let e=q;return"color"===a.type&&"string"==typeof q?e=Bb.parse(q):"padding"!==a.type||"number"!=typeof q&&!Array.isArray(q)?"numberArray"!==a.type||"number"!=typeof q&&!Array.isArray(q)?"colorArray"!==a.type||"string"!=typeof q&&!Array.isArray(q)?"variableAnchorOffsetCollection"===a.type&&Array.isArray(q)?e=ff.parse(q):"projectionDefinition"===a.type&&"string"==typeof q&&(e=ie.parse(q)):e=wd.parse(q):e=le.parse(q):e=ud.parse(q),{globalStateRefs:new Set,
_globalState:null,kind:"constant",evaluate:()=>e}}(void 0===f?d.specification.default:f,d.specification,k)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(d,f,k){return this.property.possiblyEvaluate(this,d,f,k)}}class Zk{constructor(d,f){this.property=d;this.value=new xm(d,void 0,f)}transitioned(d,f){return new Cm(this.property,this.value,f,pd({},d.transition,this.transition),
d.now)}untransitioned(){return new Cm(this.property,this.value,null,{},0)}}class Ul{constructor(d,f){this._properties=d;this._values=Object.create(d.defaultTransitionablePropertyValues);this._globalState=f}getValue(d){return Kb(this._values[d].value.value)}setValue(d,f){Object.prototype.hasOwnProperty.call(this._values,d)||(this._values[d]=new Zk(this._values[d].property,this._globalState));this._values[d].value=new xm(this._values[d].property,null===f?void 0:Kb(f),this._globalState)}getTransition(d){return Kb(this._values[d].transition)}setTransition(d,
f){Object.prototype.hasOwnProperty.call(this._values,d)||(this._values[d]=new Zk(this._values[d].property,this._globalState));this._values[d].transition=Kb(f)||void 0}serialize(){const d={};for(const k of Object.keys(this._values)){var f=this.getValue(k);void 0!==f&&(d[k]=f);f=this.getTransition(k);void 0!==f&&(d[`${k}-transition`]=f)}return d}transitioned(d,f){const k=new bn(this._properties);for(const q of Object.keys(this._values))k._values[q]=this._values[q].transitioned(d,f._values[q]);return k}untransitioned(){const d=
new bn(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].untransitioned();return d}}class Cm{constructor(d,f,k,q,a){this.property=d;this.value=f;this.begin=a+q.delay||0;this.end=this.begin+q.duration||0;d.specification.transition&&(q.delay||q.duration)&&(this.prior=k)}possiblyEvaluate(d,f,k){var q=d.now||0;const a=this.value.possiblyEvaluate(d,f,k),c=this.prior;if(c){if(q>this.end||this.value.isDataDriven())return this.prior=null,a;if(q<this.begin)return c.possiblyEvaluate(d,
f,k);q=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(d,f,k),a,Dc(q))}return a}}class bn{constructor(d){this._properties=d;this._values=Object.create(d.defaultTransitioningPropertyValues)}possiblyEvaluate(d,f,k){const q=new em(this._properties);for(const a of Object.keys(this._values))q._values[a]=this._values[a].possiblyEvaluate(d,f,k);return q}hasTransition(){for(const d of Object.keys(this._values))if(this._values[d].prior)return!0;return!1}}class Vj{constructor(d,
f){this._properties=d;this._values=Object.create(d.defaultPropertyValues);this._globalState=f}hasValue(d){return void 0!==this._values[d].value}getValue(d){return Kb(this._values[d].value)}setValue(d,f){this._values[d]=new xm(this._values[d].property,null===f?void 0:Kb(f),this._globalState)}serialize(){const d={};for(const f of Object.keys(this._values)){const k=this.getValue(f);void 0!==k&&(d[f]=k)}return d}possiblyEvaluate(d,f,k){const q=new em(this._properties);for(const a of Object.keys(this._values))q._values[a]=
this._values[a].possiblyEvaluate(d,f,k);return q}}class nj{constructor(d,f,k){this.property=d;this.value=f;this.parameters=k}isConstant(){return"constant"===this.value.kind}constantOr(d){return"constant"===this.value.kind?this.value.value:d}evaluate(d,f,k,q){return this.property.evaluate(this.value,this.parameters,d,f,k,q)}}class em{constructor(d){this._properties=d;this._values=Object.create(d.defaultPossiblyEvaluatedValues)}get(d){return this._values[d]}}class Bc{constructor(d){this.specification=
d}possiblyEvaluate(d,f){if(d.isDataDriven())throw Error("Value should not be data driven");return d.expression.evaluate(f)}interpolate(d,f,k){const q=ig[this.specification.type];return q?q(d,f,k):d}}class Zc{constructor(d,f){this.specification=d;this.overrides=f}possiblyEvaluate(d,f,k,q){return new nj(this,"constant"===d.expression.kind||"camera"===d.expression.kind?{kind:"constant",value:d.expression.evaluate(f,null,{},k,q)}:d.expression,f)}interpolate(d,f,k){if("constant"!==d.value.kind||"constant"!==
f.value.kind)return d;if(void 0===d.value.value||void 0===f.value.value)return new nj(this,{kind:"constant",value:void 0},d.parameters);const q=ig[this.specification.type];return q?(f=q(d.value.value,f.value.value,k),new nj(this,{kind:"constant",value:f},d.parameters)):d}evaluate(d,f,k,q,a,c){return"constant"===d.kind?d.value:d.evaluate(f,k,q,a,c)}}class wl extends Zc{possiblyEvaluate(d,f,k,q){return void 0===d.value?new nj(this,{kind:"constant",value:void 0},f):"constant"===d.expression.kind?(k=
d.expression.evaluate(f,null,{},k,q),d="resolvedImage"===d.property.specification.type&&"string"!=typeof k?k.name:k,d=this._calculate(d,d,d,f),new nj(this,{kind:"constant",value:d},f)):"camera"===d.expression.kind?(d=this._calculate(d.expression.evaluate({zoom:f.zoom-1}),d.expression.evaluate({zoom:f.zoom}),d.expression.evaluate({zoom:f.zoom+1}),f),new nj(this,{kind:"constant",value:d},f)):new nj(this,d.expression,f)}evaluate(d,f,k,q,a,c){return"source"===d.kind?(d=d.evaluate(f,k,q,a,c),this._calculate(d,
d,d,f)):"composite"===d.kind?this._calculate(d.evaluate({zoom:Math.floor(f.zoom)-1},k,q),d.evaluate({zoom:Math.floor(f.zoom)},k,q),d.evaluate({zoom:Math.floor(f.zoom)+1},k,q),f):d.value}_calculate(d,f,k,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:d,to:f}:{from:k,to:f}}interpolate(d){return d}}class Sm{constructor(d){this.specification=d}possiblyEvaluate(d,f,k,q){if(void 0!==d.value)return"constant"===d.expression.kind?(d=d.expression.evaluate(f,null,{},k,q),this._calculate(d,d,d,f)):this._calculate(d.expression.evaluate(new me(Math.floor(f.zoom-
1),f)),d.expression.evaluate(new me(Math.floor(f.zoom),f)),d.expression.evaluate(new me(Math.floor(f.zoom+1),f)),f)}_calculate(d,f,k,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:d,to:f}:{from:k,to:f}}interpolate(d){return d}}class Dl{constructor(d){this.specification=d}possiblyEvaluate(d,f,k,q){return!!d.expression.evaluate(f,null,{},k,q)}interpolate(){return!1}}class Ef{constructor(d){this.properties=d;this.defaultPropertyValues={};this.defaultTransitionablePropertyValues={};this.defaultTransitioningPropertyValues=
{};this.defaultPossiblyEvaluatedValues={};this.overridableProperties=[];for(const k in d){var f=d[k];f.specification.overridable&&this.overridableProperties.push(k);const q=this.defaultPropertyValues[k]=new xm(f,void 0,void 0);f=this.defaultTransitionablePropertyValues[k]=new Zk(f,void 0);this.defaultTransitioningPropertyValues[k]=f.untransitioned();this.defaultPossiblyEvaluatedValues[k]=q.possiblyEvaluate({})}}}Cb("DataDrivenProperty",Zc);Cb("DataConstantProperty",Bc);Cb("CrossFadedDataDrivenProperty",
wl);Cb("CrossFadedProperty",Sm);Cb("ColorRampProperty",Dl);class yg extends Pk{constructor(d,f,k){if(super(),this.id=d.id,this.type=d.type,this._globalState=k,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},"custom"!==d.type&&(this.metadata=d.metadata,this.minzoom=d.minzoom,this.maxzoom=d.maxzoom,"background"!==d.type&&(this.source=d.source,this.sourceLayer=d["source-layer"],this.filter=d.filter,this._featureFilter=$c(d.filter,k)),f.layout&&(this._unevaluatedLayout=
new Vj(f.layout,k)),f.paint)){this._transitionablePaint=new Ul(f.paint,k);for(const q in d.paint)this.setPaintProperty(q,d.paint[q],{validate:!1});for(const q in d.layout)this.setLayoutProperty(q,d.layout[q],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned();this.paint=new em(f.paint)}}setFilter(d){this.filter=d;this._featureFilter=$c(d,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(d){return"visibility"===d?this.visibility:
this._unevaluatedLayout.getValue(d)}getLayoutAffectingGlobalStateRefs(){const d=new Set;if(this._unevaluatedLayout)for(const f in this._unevaluatedLayout._values){const k=this._unevaluatedLayout._values[f];for(const q of k.getGlobalStateRefs())d.add(q)}for(const f of this._featureFilter.getGlobalStateRefs())d.add(f);return d}getPaintAffectingGlobalStateRefs(){var d;const f=new globalThis.Map;if(this._transitionablePaint)for(const k in this._transitionablePaint._values){const q=this._transitionablePaint._values[k].value;
for(const a of q.getGlobalStateRefs()){const c=null!==(d=f.get(a))&&void 0!==d?d:[];c.push({name:k,value:q.value});f.set(a,c)}}return f}setLayoutProperty(d,f,k={}){null!=f&&this._validate(dm,`layers.${this.id}.layout.${d}`,d,f,k)||("visibility"!==d?this._unevaluatedLayout.setValue(d,f):this.visibility=f)}getPaintProperty(d){return d.endsWith("-transition")?this._transitionablePaint.getTransition(d.slice(0,-11)):this._transitionablePaint.getValue(d)}setPaintProperty(d,f,k={}){if(null!=f&&this._validate(vl,
`layers.${this.id}.paint.${d}`,d,f,k))return!1;if(d.endsWith("-transition"))return this._transitionablePaint.setTransition(d.slice(0,-11),f||void 0),!1;var q=this._transitionablePaint._values[d];k="cross-faded-data-driven"===q.property.specification["property-type"];const a=q.value.isDataDriven();q=q.value;this._transitionablePaint.setValue(d,f);this._handleSpecialPaintPropertyUpdate(d);f=this._transitionablePaint._values[d].value;return f.isDataDriven()||a||k||this._handleOverridablePaintPropertyUpdate(d,
q,f)}_handleSpecialPaintPropertyUpdate(d){}_handleOverridablePaintPropertyUpdate(d,f,k){return!1}isHidden(d){return!!(this.minzoom&&d<this.minzoom)||!!(this.maxzoom&&d>=this.maxzoom)||"none"===this.visibility}updateTransitions(d){this._transitioningPaint=this._transitionablePaint.transitioned(d,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(d,f){d.getCrossfadeParameters&&(this._crossfadeParameters=d.getCrossfadeParameters());this._unevaluatedLayout&&
(this.layout=this._unevaluatedLayout.possiblyEvaluate(d,void 0,f));this.paint=this._transitioningPaint.possiblyEvaluate(d,void 0,f)}serialize(){const d={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(d.layout=d.layout||{},
d.layout.visibility=this.visibility),Rc(d,(f,k)=>!(void 0===f||"layout"===k&&!Object.keys(f).length||"paint"===k&&!Object.keys(f).length))}_validate(d,f,k,q,a={}){return(!a||!1!==a.validate)&&Eb(this,d.call(kf,{key:f,layerType:this.type,objectKey:k,value:q,styleSpec:b,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const d in this.paint._values){const f=this.paint.get(d);if(f instanceof nj&&$h(f.property.specification)&&
("source"===f.value.kind||"composite"===f.value.kind)&&f.value.isStateDependent)return!0}return!1}}let Um;var mn={get paint(){return Um=Um||new Ef({"raster-opacity":new Bc(b.paint_raster["raster-opacity"]),"raster-hue-rotate":new Bc(b.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Bc(b.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Bc(b.paint_raster["raster-brightness-max"]),"raster-saturation":new Bc(b.paint_raster["raster-saturation"]),"raster-contrast":new Bc(b.paint_raster["raster-contrast"]),
"raster-resampling":new Bc(b.paint_raster["raster-resampling"]),"raster-fade-duration":new Bc(b.paint_raster["raster-fade-duration"])})}};class ln extends yg{constructor(d,f){super(d,mn,f)}}const am={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class sj{constructor(d,f){this._structArray=d;this._pos1=f*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8}}class hf{constructor(){this.isTransferred=
!1;this.capacity=-1;this.resize(0)}static serialize(d,f){return d._trim(),f&&(d.isTransferred=!0,f.push(d.arrayBuffer)),{length:d.length,arrayBuffer:d.arrayBuffer}}static deserialize(d){const f=Object.create(this.prototype);return f.arrayBuffer=d.arrayBuffer,f.length=d.length,f.capacity=d.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=
0}resize(d){this.reserve(d);this.length=d}reserve(d){d>this.capacity&&(this.capacity=Math.max(d,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),d=this.uint8,this._refreshViews(),d&&this.uint8.set(d))}_refreshViews(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout");}}class Qj extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f){const k=
this.length;return this.resize(k+1),this.emplace(k,d,f)}emplace(d,f,k){const q=2*d;return this.int16[q+0]=f,this.int16[q+1]=k,d}}Qj.prototype.bytesPerElement=4;Cb("StructArrayLayout2i4",Qj);class ng extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k){const q=this.length;return this.resize(q+1),this.emplace(q,d,f,k)}emplace(d,f,k,q){const a=3*d;return this.int16[a+0]=f,this.int16[a+1]=k,this.int16[a+2]=q,d}}ng.prototype.bytesPerElement=
6;Cb("StructArrayLayout3i6",ng);class fl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q){const a=this.length;return this.resize(a+1),this.emplace(a,d,f,k,q)}emplace(d,f,k,q,a){const c=4*d;return this.int16[c+0]=f,this.int16[c+1]=k,this.int16[c+2]=q,this.int16[c+3]=a,d}}fl.prototype.bytesPerElement=8;Cb("StructArrayLayout4i8",fl);class Vl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=
new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c){const e=this.length;return this.resize(e+1),this.emplace(e,d,f,k,q,a,c)}emplace(d,f,k,q,a,c,e){const h=6*d;return this.int16[h+0]=f,this.int16[h+1]=k,this.int16[h+2]=q,this.int16[h+3]=a,this.int16[h+4]=c,this.int16[h+5]=e,d}}Vl.prototype.bytesPerElement=12;Cb("StructArrayLayout2i4i12",Vl);class xl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c){const e=
this.length;return this.resize(e+1),this.emplace(e,d,f,k,q,a,c)}emplace(d,f,k,q,a,c,e){const h=4*d,l=8*d;return this.int16[h+0]=f,this.int16[h+1]=k,this.uint8[l+4]=q,this.uint8[l+5]=a,this.uint8[l+6]=c,this.uint8[l+7]=e,d}}xl.prototype.bytesPerElement=8;Cb("StructArrayLayout2i4ub8",xl);class Qk extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f){const k=this.length;return this.resize(k+1),this.emplace(k,d,f)}emplace(d,
f,k){const q=2*d;return this.float32[q+0]=f,this.float32[q+1]=k,d}}Qk.prototype.bytesPerElement=8;Cb("StructArrayLayout2f8",Qk);class qh extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h,l,p){const w=this.length;return this.resize(w+1),this.emplace(w,d,f,k,q,a,c,e,h,l,p)}emplace(d,f,k,q,a,c,e,h,l,p,w){const x=10*d;return this.uint16[x+0]=f,this.uint16[x+1]=k,this.uint16[x+2]=q,this.uint16[x+3]=a,this.uint16[x+
4]=c,this.uint16[x+5]=e,this.uint16[x+6]=h,this.uint16[x+7]=l,this.uint16[x+8]=p,this.uint16[x+9]=w,d}}qh.prototype.bytesPerElement=20;Cb("StructArrayLayout10ui20",qh);class hm extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h){const l=this.length;return this.resize(l+1),this.emplace(l,d,f,k,q,a,c,e,h)}emplace(d,f,k,q,a,c,e,h,l){const p=8*d;return this.uint16[p+0]=f,this.uint16[p+1]=k,this.uint16[p+2]=q,
this.uint16[p+3]=a,this.uint16[p+4]=c,this.uint16[p+5]=e,this.uint16[p+6]=h,this.uint16[p+7]=l,d}}hm.prototype.bytesPerElement=16;Cb("StructArrayLayout8ui16",hm);class Sj extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h,l,p,w,x){const y=this.length;return this.resize(y+1),this.emplace(y,d,f,k,q,a,c,e,h,l,p,w,x)}emplace(d,f,k,q,a,c,e,h,l,p,w,x,y){const D=12*d;
return this.int16[D+0]=f,this.int16[D+1]=k,this.int16[D+2]=q,this.int16[D+3]=a,this.uint16[D+4]=c,this.uint16[D+5]=e,this.uint16[D+6]=h,this.uint16[D+7]=l,this.int16[D+8]=p,this.int16[D+9]=w,this.int16[D+10]=x,this.int16[D+11]=y,d}}Sj.prototype.bytesPerElement=24;Cb("StructArrayLayout4i4ui4i24",Sj);class al extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f,k){const q=this.length;return this.resize(q+1),this.emplace(q,
d,f,k)}emplace(d,f,k,q){const a=3*d;return this.float32[a+0]=f,this.float32[a+1]=k,this.float32[a+2]=q,d}}al.prototype.bytesPerElement=12;Cb("StructArrayLayout3f12",al);class vk extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(d){const f=this.length;return this.resize(f+1),this.emplace(f,d)}emplace(d,f){return this.uint32[1*d]=f,d}}vk.prototype.bytesPerElement=4;Cb("StructArrayLayout1ul4",vk);class $k extends hf{_refreshViews(){this.uint8=
new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h,l){const p=this.length;return this.resize(p+1),this.emplace(p,d,f,k,q,a,c,e,h,l)}emplace(d,f,k,q,a,c,e,h,l,p){const w=10*d;return this.int16[w+0]=f,this.int16[w+1]=k,this.int16[w+2]=q,this.int16[w+3]=a,this.int16[w+4]=c,this.int16[w+5]=e,this.uint32[5*d+3]=h,this.uint16[w+8]=l,this.uint16[w+9]=p,d}}$k.prototype.bytesPerElement=
20;Cb("StructArrayLayout6i1ul2ui20",$k);class Tj extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c){const e=this.length;return this.resize(e+1),this.emplace(e,d,f,k,q,a,c)}emplace(d,f,k,q,a,c,e){const h=6*d;return this.int16[h+0]=f,this.int16[h+1]=k,this.int16[h+2]=q,this.int16[h+3]=a,this.int16[h+4]=c,this.int16[h+5]=e,d}}Tj.prototype.bytesPerElement=12;Cb("StructArrayLayout2i2i2i12",Tj);class bl extends hf{_refreshViews(){this.uint8=
new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a){const c=this.length;return this.resize(c+1),this.emplace(c,d,f,k,q,a)}emplace(d,f,k,q,a,c){const e=4*d,h=8*d;return this.float32[e+0]=f,this.float32[e+1]=k,this.float32[e+2]=q,this.int16[h+6]=a,this.int16[h+7]=c,d}}bl.prototype.bytesPerElement=16;Cb("StructArrayLayout2f1f2i16",bl);class Gl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);
this.float32=new Float32Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c){const e=this.length;return this.resize(e+1),this.emplace(e,d,f,k,q,a,c)}emplace(d,f,k,q,a,c,e){const h=16*d,l=4*d,p=8*d;return this.uint8[h+0]=f,this.uint8[h+1]=k,this.float32[l+1]=q,this.float32[l+2]=a,this.int16[p+6]=c,this.int16[p+7]=e,d}}Gl.prototype.bytesPerElement=16;Cb("StructArrayLayout2ub2f2i16",Gl);class dl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);
this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k){const q=this.length;return this.resize(q+1),this.emplace(q,d,f,k)}emplace(d,f,k,q){const a=3*d;return this.uint16[a+0]=f,this.uint16[a+1]=k,this.uint16[a+2]=q,d}}dl.prototype.bytesPerElement=6;Cb("StructArrayLayout3ui6",dl);class el extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);
this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L){const Y=this.length;return this.resize(Y+1),this.emplace(Y,d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L)}emplace(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L,Y){const P=24*d,Z=12*d,aa=48*d;return this.int16[P+0]=f,this.int16[P+1]=k,this.uint16[P+2]=q,this.uint16[P+3]=a,this.uint32[Z+2]=c,this.uint32[Z+3]=e,this.uint32[Z+4]=h,this.uint16[P+10]=l,this.uint16[P+11]=p,this.uint16[P+12]=w,this.float32[Z+7]=x,this.float32[Z+8]=y,this.uint8[aa+
36]=D,this.uint8[aa+37]=H,this.uint8[aa+38]=I,this.uint32[Z+10]=L,this.int16[P+22]=Y,d}}el.prototype.bytesPerElement=48;Cb("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",el);class fm extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z,aa,T,ha,Ca,xa,Ha,
Fa,Ra){const Ja=this.length;return this.resize(Ja+1),this.emplace(Ja,d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z,aa,T,ha,Ca,xa,Ha,Fa,Ra)}emplace(d,f,k,q,a,c,e,h,l,p,w,x,y,D,H,I,L,Y,P,Z,aa,T,ha,Ca,xa,Ha,Fa,Ra,Ja){const Ka=32*d,lb=16*d;return this.int16[Ka+0]=f,this.int16[Ka+1]=k,this.int16[Ka+2]=q,this.int16[Ka+3]=a,this.int16[Ka+4]=c,this.int16[Ka+5]=e,this.int16[Ka+6]=h,this.int16[Ka+7]=l,this.uint16[Ka+8]=p,this.uint16[Ka+9]=w,this.uint16[Ka+10]=x,this.uint16[Ka+11]=y,this.uint16[Ka+12]=D,this.uint16[Ka+
13]=H,this.uint16[Ka+14]=I,this.uint16[Ka+15]=L,this.uint16[Ka+16]=Y,this.uint16[Ka+17]=P,this.uint16[Ka+18]=Z,this.uint16[Ka+19]=aa,this.uint16[Ka+20]=T,this.uint16[Ka+21]=ha,this.uint16[Ka+22]=Ca,this.uint32[lb+12]=xa,this.float32[lb+13]=Ha,this.float32[lb+14]=Fa,this.uint16[Ka+30]=Ra,this.uint16[Ka+31]=Ja,d}}fm.prototype.bytesPerElement=64;Cb("StructArrayLayout8i15ui1ul2f2ui64",fm);class Uj extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d){const f=
this.length;return this.resize(f+1),this.emplace(f,d)}emplace(d,f){return this.float32[1*d]=f,d}}Uj.prototype.bytesPerElement=4;Cb("StructArrayLayout1f4",Uj);class cl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f,k){const q=this.length;return this.resize(q+1),this.emplace(q,d,f,k)}emplace(d,f,k,q){const a=3*d;return this.uint16[6*d]=f,this.float32[a+1]=k,this.float32[a+
2]=q,d}}cl.prototype.bytesPerElement=12;Cb("StructArrayLayout1ui2f12",cl);class Wl extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f,k){const q=this.length;return this.resize(q+1),this.emplace(q,d,f,k)}emplace(d,f,k,q){const a=4*d;return this.uint32[2*d]=f,this.uint16[a+2]=k,this.uint16[a+3]=q,d}}Wl.prototype.bytesPerElement=8;Cb("StructArrayLayout1ul2ui8",Wl);class yl extends hf{_refreshViews(){this.uint8=
new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,f){const k=this.length;return this.resize(k+1),this.emplace(k,d,f)}emplace(d,f,k){const q=2*d;return this.uint16[q+0]=f,this.uint16[q+1]=k,d}}yl.prototype.bytesPerElement=4;Cb("StructArrayLayout2ui4",yl);class jk extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d){const f=this.length;return this.resize(f+1),this.emplace(f,d)}emplace(d,
f){return this.uint16[1*d]=f,d}}jk.prototype.bytesPerElement=2;Cb("StructArrayLayout1ui2",jk);class ym extends hf{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,f,k,q){const a=this.length;return this.resize(a+1),this.emplace(a,d,f,k,q)}emplace(d,f,k,q,a){const c=4*d;return this.float32[c+0]=f,this.float32[c+1]=k,this.float32[c+2]=q,this.float32[c+3]=a,d}}ym.prototype.bytesPerElement=16;Cb("StructArrayLayout4f16",ym);class Rk extends sj{get anchorPointX(){return this._structArray.int16[this._pos2+
0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ta(this.anchorPointX,
this.anchorPointY)}}Rk.prototype.size=20;class Hk extends $k{get(d){return new Rk(this,d)}}Cb("CollisionBoxArray",Hk);class bm extends sj{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+
3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+
37]}set placedOrientation(d){this._structArray.uint8[this._pos1+37]=d}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(d){this._structArray.uint8[this._pos1+38]=d}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(d){this._structArray.uint32[this._pos4+10]=d}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}bm.prototype.size=48;class wk extends el{get(d){return new bm(this,d)}}Cb("PlacedSymbolArray",wk);class Dm extends sj{get anchorX(){return this._structArray.int16[this._pos2+
0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+
7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+
15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+
22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(d){this._structArray.uint32[this._pos4+12]=d}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Dm.prototype.size=64;class im extends fm{get(d){return new Dm(this,
d)}}Cb("SymbolInstanceArray",im);class qm extends Uj{getoffsetX(d){return this.float32[1*d]}}Cb("GlyphOffsetArray",qm);class Ej extends ng{getx(d){return this.int16[3*d]}gety(d){return this.int16[3*d+1]}gettileUnitDistanceFromAnchor(d){return this.int16[3*d+2]}}Cb("SymbolLineVertexArray",Ej);class Jm extends sj{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+
2]}}Jm.prototype.size=12;class Ij extends cl{get(d){return new Jm(this,d)}}Cb("TextAnchorOffsetArray",Ij);class zm extends sj{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}zm.prototype.size=8;class sn extends Wl{get(d){return new zm(this,d)}}Cb("FeatureIndexArray",sn);class kk extends Qj{}class ai extends Qj{}class gl extends Qj{}class bj extends Vl{}
class Hl extends xl{}class Zm extends Qk{}class Ik extends qh{}class Il extends hm{}class yk extends Sj{}class Wj extends al{}class Hg extends vk{}class $g extends Tj{}class zk extends Gl{}class ah extends dl{}class hl extends yl{}const Em=ee([{name:"a_pos",components:2,type:"Int16"}],4),{members:il}=Em;class Ve{constructor(d=[]){this._forceNewSegmentOnNextPrepare=!1;this.segments=d}prepareSegment(d,f,k,q){const a=this.segments[this.segments.length-1];return d>Ve.MAX_VERTEX_ARRAY_LENGTH&&Ma(`Max vertices per segment is ${Ve.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${d}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ve.MAX_VERTEX_ARRAY_LENGTH} vertices.`),
this._forceNewSegmentOnNextPrepare||!a||a.vertexLength+d>Ve.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==q?this.createNewSegment(f,k,q):a}createNewSegment(d,f,k){d={vertexOffset:d.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==k&&(d.sortKey=k),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(d,f,k){return this.prepareSegment(0,d,f,k)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const d of this.segments)for(const f in d.vaos)d.vaos[f].destroy()}static simpleSegment(d,
f,k,q){return new Ve([{vertexOffset:d,primitiveOffset:f,vertexLength:k,primitiveLength:q,vaos:{},sortKey:0}])}}Ve.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;Cb("SegmentVector",Ve);const km=ee([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),jm=ee([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);
var Kh,ei,Ci,Lh={},Bi={},uh={},rf=function(){if(Ci)return Lh;Ci=1;var d=(Kh||(Kh=1,Bi=function(k,q){var a,c,e;var h=k.length-(a=3&k.length);for(e=0;e<h;){var l=255&k.charCodeAt(e)|(255&k.charCodeAt(++e))<<8|(255&k.charCodeAt(++e))<<16|(255&k.charCodeAt(++e))<<24;++e;q=27492+(65535&(c=5*(65535&(q=(q^=461845907*(65535&(l=(l=3432918353*(65535&l)+((3432918353*(l>>>16)&65535)<<16)&4294967295)<<15|l>>>17))+((461845907*(l>>>16)&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+
(c>>>16)&65535)<<16)}switch(l=0,a){case 3:l^=(255&k.charCodeAt(e+2))<<16;case 2:l^=(255&k.charCodeAt(e+1))<<8;case 1:q^=461845907*(65535&(l=(l=3432918353*(65535&(l^=255&k.charCodeAt(e)))+((3432918353*(l>>>16)&65535)<<16)&4294967295)<<15|l>>>17))+((461845907*(l>>>16)&65535)<<16)&4294967295}return q^=k.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^q>>>16)>>>0}),Bi),f=(ei||(ei=1,uh=
function(k,q){var a=k.length;q^=a;for(var c=0;4<=a;){var e=1540483477*(65535&(e=255&k.charCodeAt(c)|(255&k.charCodeAt(++c))<<8|(255&k.charCodeAt(++c))<<16|(255&k.charCodeAt(++c))<<24))+((1540483477*(e>>>16)&65535)<<16);q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16));a-=4;++c}switch(a){case 3:q^=(255&k.charCodeAt(c+2))<<16;case 2:q^=(255&k.charCodeAt(c+1))<<8;case 1:q=1540483477*(65535&(q^=255&k.charCodeAt(c)))+((1540483477*
(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^q>>>15)>>>0}),uh);return Lh=d,Lh.murmur3=d,Lh.murmur2=f,Lh}(),he=Va(rf);class vh{constructor(){this.ids=[];this.positions=[];this.indexed=!1}add(d,f,k,q){this.ids.push(Da(d));this.positions.push(f,k,q)}getPositions(d){if(!this.indexed)throw Error("Trying to get index, but feature positions are not indexed");d=Da(d);let f=0;for(var k=this.ids.length-1;f<k;){const q=f+k>>1;this.ids[q]>=d?k=q:f=q+1}for(k=
[];this.ids[f]===d;)k.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return k}static serialize(d,f){const k=new Float64Array(d.ids);d=new Uint32Array(d.positions);return Fi(k,d,0,k.length-1),f&&f.push(k.buffer,d.buffer),{ids:k,positions:d}}static deserialize(d){const f=new vh;return f.ids=d.ids,f.positions=d.positions,f.indexed=!0,f}}Cb("FeaturePositionMap",vh);class ki{constructor(d,f){this.gl=d.gl;this.location=f}}class Bj extends ki{constructor(d,f){super(d,
f);this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class nl extends ki{constructor(d,f){super(d,f);this.current=[0,0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3]))}}class ej extends ki{constructor(d,f){super(d,f);this.current=Bb.transparent}set(d){d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||
(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a))}}const xj=new Float32Array(16);class ch{constructor(d,f,k){this.value=d;this.uniformNames=f.map(q=>`u_${q}`);this.type=k}setUniform(d,f,k){d.set(k.constantOr(this.value))}getBinding(d,f,k){return"color"===this.type?new ej(d,f):new Bj(d,f)}}class Zf{constructor(d,f){this.uniformNames=f.map(k=>`u_${k}`);this.patternTo=this.patternFrom=null;this.pixelRatioTo=this.pixelRatioFrom=1}setConstantPatternPositions(d,f){this.pixelRatioFrom=f.pixelRatio;
this.pixelRatioTo=d.pixelRatio;this.patternFrom=f.tlbr;this.patternTo=d.tlbr}setConstantDashPositions(d,f){this.dashTo=[0,d.y,d.height,d.width];this.dashFrom=[0,f.y,f.height,f.width]}setUniform(d,f,k,q){f=null;"u_pattern_to"===q?f=this.patternTo:"u_pattern_from"===q?f=this.patternFrom:"u_dasharray_to"===q?f=this.dashTo:"u_dasharray_from"===q?f=this.dashFrom:"u_pixel_ratio_to"===q?f=this.pixelRatioTo:"u_pixel_ratio_from"===q&&(f=this.pixelRatioFrom);null!==f&&d.set(f)}getBinding(d,f,k){return"u_pattern"===
k.substr(0,9)||"u_dasharray_"===k.substr(0,12)?new nl(d,f):new Bj(d,f)}}class Lg{constructor(d,f,k,q){this.expression=d;this.type=k;this.maxValue=0;this.paintVertexAttributes=f.map(a=>({name:`a_${a}`,type:"Float32",components:"color"===k?2:1,offset:0}));this.paintVertexArray=new q}populatePaintArray(d,f,k){const q=this.paintVertexArray.length;f=this.expression.evaluate(new me(0,k),f,{},k.canonical,[],k.formattedSection);this.paintVertexArray.resize(d);this._setPaintValue(q,d,f)}updatePaintArray(d,
f,k,q,a){k=this.expression.evaluate(new me(0,a),k,q);this._setPaintValue(d,f,k)}_setPaintValue(d,f,k){if("color"===this.type)for(k=fe(k);d<f;d++)this.paintVertexArray.emplace(d,k[0],k[1]);else{for(;d<f;d++)this.paintVertexArray.emplace(d,k);this.maxValue=Math.max(this.maxValue,Math.abs(k))}}upload(d){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=d.createVertexBuffer(this.paintVertexArray,
this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ag{constructor(d,f,k,q,a,c){this.expression=d;this.uniformNames=f.map(e=>`u_${e}_t`);this.type=k;this.useIntegerZoom=q;this.zoom=a;this.maxValue=0;this.paintVertexAttributes=f.map(e=>({name:`a_${e}`,type:"Float32",components:"color"===k?4:2,offset:0}));this.paintVertexArray=new c}populatePaintArray(d,f,k){const q=this.expression.evaluate(new me(this.zoom,k),f,{},
k.canonical,[],k.formattedSection);f=this.expression.evaluate(new me(this.zoom+1,k),f,{},k.canonical,[],k.formattedSection);k=this.paintVertexArray.length;this.paintVertexArray.resize(d);this._setPaintValue(k,d,q,f)}updatePaintArray(d,f,k,q,a){const c=this.expression.evaluate(new me(this.zoom,a),k,q);k=this.expression.evaluate(new me(this.zoom+1,a),k,q);this._setPaintValue(d,f,c,k)}_setPaintValue(d,f,k,q){if("color"===this.type)for(k=fe(k),q=fe(q);d<f;d++)this.paintVertexArray.emplace(d,k[0],k[1],
q[0],q[1]);else{for(;d<f;d++)this.paintVertexArray.emplace(d,k,q);this.maxValue=Math.max(this.maxValue,Math.abs(k),Math.abs(q))}}upload(d){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=d.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(d,
f){f=xc(this.expression.interpolationFactor(this.useIntegerZoom?Math.floor(f.zoom):f.zoom,this.zoom,this.zoom+1),0,1);d.set(f)}getBinding(d,f,k){return new Bj(d,f)}}class Ye{constructor(d,f,k,q,a,c){this.expression=d;this.type=f;this.useIntegerZoom=k;this.zoom=q;this.layerId=c;this.zoomInPaintVertexArray=new a;this.zoomOutPaintVertexArray=new a}populatePaintArray(d,f,k){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(d);this.zoomOutPaintVertexArray.resize(d);this._setPaintValues(q,
d,this.getPositionIds(f),k)}updatePaintArray(d,f,k,q,a){this._setPaintValues(d,f,this.getPositionIds(k),a)}_setPaintValues(d,f,k,q){const a=this.getPositions(q);if(a&&k){q=a[k.min];var c=a[k.mid];k=a[k.max];if(q&&c&&k)for(;d<f;d++)this.emplace(this.zoomInPaintVertexArray,d,c,q),this.emplace(this.zoomOutPaintVertexArray,d,c,k)}}upload(d){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const f=this.getVertexAttributes();
this.zoomInPaintVertexBuffer=d.createVertexBuffer(this.zoomInPaintVertexArray,f,this.expression.isStateDependent);this.zoomOutPaintVertexBuffer=d.createVertexBuffer(this.zoomOutPaintVertexArray,f,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy();this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class bg extends Ye{getPositions(d){return d.imagePositions}getPositionIds(d){return d.patterns&&d.patterns[this.layerId]}getVertexAttributes(){return km.members}emplace(d,
f,k,q){d.emplace(f,k.tlbr[0],k.tlbr[1],k.tlbr[2],k.tlbr[3],q.tlbr[0],q.tlbr[1],q.tlbr[2],q.tlbr[3],k.pixelRatio,q.pixelRatio)}}class Jl extends Ye{getPositions(d){return d.dashPositions}getPositionIds(d){return d.dashes&&d.dashes[this.layerId]}getVertexAttributes(){return jm.members}emplace(d,f,k,q){d.emplace(f,0,k.y,k.height,k.width,0,q.y,q.height,q.width)}}class Mh{constructor(d,f,k){this.binders={};this._buffers=[];const q=[];for(const c in d.paint._values){if(!k(c))continue;var a=d.paint.get(c);
if(!(a instanceof nj&&$h(a.property.specification)))continue;const e={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to",
"pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${d.type}-`,"").replace(/-/g,"_")],h=a.value,l=a.property.specification.type,p=a.property.useIntegerZoom;a=a.property.specification["property-type"];a="cross-faded"===a||"cross-faded-data-driven"===a;if("constant"===h.kind)this.binders[c]=a?new Zf(h.value,e):new ch(h.value,e,l),q.push(`/u_${c}`);
else if("source"===h.kind||a){const w=Ad(c,l,"source");this.binders[c]=a?"line-dasharray"===c?new Jl(h,l,p,f,w,d.id):new bg(h,l,p,f,w,d.id):new Lg(h,e,l,w);q.push(`/a_${c}`)}else a=Ad(c,l,"composite"),this.binders[c]=new ag(h,e,l,p,f,a),q.push(`/z_${c}`)}this.cacheKey=q.sort().join("")}getMaxValue(d){d=this.binders[d];return d instanceof Lg||d instanceof ag?d.maxValue:0}populatePaintArrays(d,f,k){for(const q in this.binders){const a=this.binders[q];(a instanceof Lg||a instanceof ag||a instanceof Ye)&&
a.populatePaintArray(d,f,k)}}setConstantPatternPositions(d,f){for(const k in this.binders){const q=this.binders[k];q instanceof Zf&&q.setConstantPatternPositions(d,f)}}setConstantDashPositions(d,f){for(const k in this.binders){const q=this.binders[k];q instanceof Zf&&q.setConstantDashPositions(d,f)}}updatePaintArrays(d,f,k,q,a){var c=!1;for(const h in d){var e=f.getPositions(h);for(const l of e){e=k.feature(l.index);for(const p in this.binders){const w=this.binders[p];(w instanceof Lg||w instanceof
ag||w instanceof Ye)&&!0===w.expression.isStateDependent&&(c=q.paint.get(p),w.expression=c.value,w.updatePaintArray(l.start,l.end,e,d[h],a),c=!0)}}}return c}defines(){const d=[];for(const f in this.binders){const k=this.binders[f];(k instanceof ch||k instanceof Zf)&&d.push(...k.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return d}getBinderAttributes(){const d=[];for(const k in this.binders){var f=this.binders[k];if(f instanceof Lg||f instanceof ag)for(let q=0;q<f.paintVertexAttributes.length;q++)d.push(f.paintVertexAttributes[q].name);
else if(f instanceof Ye){f=f.getVertexAttributes();for(const q of f)d.push(q.name)}}return d}getBinderUniforms(){const d=[];for(const f in this.binders){const k=this.binders[f];if(k instanceof ch||k instanceof Zf||k instanceof ag)for(const q of k.uniformNames)d.push(q)}return d}getPaintVertexBuffers(){return this._buffers}getUniforms(d,f){const k=[];for(const q in this.binders){const a=this.binders[q];if(a instanceof ch||a instanceof Zf||a instanceof ag)for(const c of a.uniformNames)if(f[c]){const e=
a.getBinding(d,f[c],c);k.push({name:c,property:q,binding:e})}}return k}setUniforms(d,f,k,q){for(const {name:a,property:c,binding:e}of f)this.binders[c].setUniform(e,q,k.get(c),a)}updatePaintBuffers(d){this._buffers=[];for(const k in this.binders){var f=this.binders[k];d&&f instanceof Ye?(f=2===d.fromScale?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer)&&this._buffers.push(f):(f instanceof Lg||f instanceof ag)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(d){for(const f in this.binders){const k=
this.binders[f];(k instanceof Lg||k instanceof ag||k instanceof Ye)&&k.upload(d)}this.updatePaintBuffers()}destroy(){for(const d in this.binders){const f=this.binders[d];(f instanceof Lg||f instanceof ag||f instanceof Ye)&&f.destroy()}}}class ze{constructor(d,f,k=()=>!0){this.programConfigurations={};for(const q of d)this.programConfigurations[q.id]=new Mh(q,f,k);this.needsUpload=!1;this._featureMap=new vh;this._bufferOffset=0}populatePaintArrays(d,f,k,q){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(d,
f,q);void 0!==f.id&&this._featureMap.add(f.id,k,this._bufferOffset,d);this._bufferOffset=d;this.needsUpload=!0}updatePaintArrays(d,f,k,q){for(const a of k)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(d,this._featureMap,f,a,q)||this.needsUpload}get(d){return this.programConfigurations[d]}upload(d){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(d);this.needsUpload=!1}}destroy(){for(const d in this.programConfigurations)this.programConfigurations[d].destroy()}}
Cb("ConstantBinder",ch);Cb("CrossFadedConstantBinder",Zf);Cb("SourceExpressionBinder",Lg);Cb("CrossFadedPatternBinder",bg);Cb("CrossFadedDasharrayBinder",Jl);Cb("CompositeExpressionBinder",ag);Cb("ProgramConfiguration",Mh,{omit:["_buffers"]});Cb("ProgramConfigurationSet",ze);const lm=Math.pow(2,14)-1,Yj=-lm-1;class nm{constructor(d){this.zoom=d.zoom;this.overscaling=d.overscaling;this.layers=d.layers;this.layerIds=this.layers.map(f=>f.id);this.index=d.index;this.hasDependencies=!1;this.layoutVertexArray=
new ai;this.indexArray=new ah;this.segments=new Ve;this.programConfigurations=new ze(d.layers,d.zoom);this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(d,f,k){var q=this.layers[0],a=[];let c=null,e=!1;var h="heatmap"===q.type;"circle"===q.type&&(c=q.layout.get("circle-sort-key"),e=!c.isConstant(),h=h||"map"===q.paint.get("circle-pitch-alignment"));q=h?f.subdivisionGranularity.circle:1;for(const {feature:l,id:p,index:w,sourceLayerIndex:x}of d){h=this.layers[0]._featureFilter.needGeometry;
const y=dg(l,h);if(!this.layers[0]._featureFilter.filter(new me(this.zoom),y,k))continue;const D=e?c.evaluate(y,{},k):void 0;h={id:p,properties:l.properties,type:l.type,sourceLayerIndex:x,index:w,geometry:h?y.geometry:ye(l),patterns:{},sortKey:D};a.push(h)}e&&a.sort((l,p)=>l.sortKey-p.sortKey);for(const l of a){const {geometry:p,index:w,sourceLayerIndex:x}=l;a=d[w].feature;this.addFeature(l,p,w,k,q);f.featureIndex.insert(a,p,w,x,this.index)}}update(d,f,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,
f,this.stateDependentLayers,{imagePositions:k})}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,il),this.indexBuffer=d.createIndexBuffer(this.indexArray));this.programConfigurations.upload(d);this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),
this.segments.destroy())}addFeature(d,f,k,q,a=1){switch(a){case 1:a=[0,7];break;case 3:a=[0,2,5,7];break;case 5:a=[0,1,3,4,6,7];break;case 7:a=[0,1,2,3,4,5,6,7];break;default:throw Error(`Invalid circle bucket granularity: ${a}; valid values are 1, 3, 5, 7.`);}const c=a.length;for(const w of f)for(const x of w){var e=x.x,h=x.y;if(0>e||8192<=e||0>h||8192<=h)continue;f=this.segments.prepareSegment(c*c,this.layoutVertexArray,this.indexArray,d.sortKey);const y=f.vertexLength;for(var l=0;l<c;l++)for(var p=
0;p<c;p++)this.layoutVertexArray.emplaceBack(-32768+8*e+a[p],-32768+8*h+a[l]);for(e=0;e<c-1;e++)for(h=0;h<c-1;h++)l=y+e*c+h,p=y+(e+1)*c+h,this.indexArray.emplaceBack(l,p+1,l+1),this.indexArray.emplaceBack(l,p,p+1);f.vertexLength+=c*c;f.primitiveLength+=(c-1)*(c-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,k,{imagePositions:{},canonical:q})}}let Bk,xe;Cb("CircleBucket",nm,{omit:["layers"]});var Oe={get paint(){return xe=xe||new Ef({"circle-radius":new Zc(b.paint_circle["circle-radius"]),
"circle-color":new Zc(b.paint_circle["circle-color"]),"circle-blur":new Zc(b.paint_circle["circle-blur"]),"circle-opacity":new Zc(b.paint_circle["circle-opacity"]),"circle-translate":new Bc(b.paint_circle["circle-translate"]),"circle-translate-anchor":new Bc(b.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Bc(b.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Bc(b.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zc(b.paint_circle["circle-stroke-width"]),
"circle-stroke-color":new Zc(b.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zc(b.paint_circle["circle-stroke-opacity"])})},get layout(){return Bk=Bk||new Ef({"circle-sort-key":new Zc(b.layout_circle["circle-sort-key"])})}};class cg extends yg{constructor(d,f){super(d,Oe,f)}createBucket(d){return new nm(d)}queryRadius(d){return Qe("circle-radius",this,d)+Qe("circle-stroke-width",this,d)+eh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:d,feature:f,featureState:k,
geometry:q,transform:a,pixelsToTileUnits:c,unwrappedTileID:e,getElevation:h}){d=Og(d,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-a.bearingInRadians,c);f=this.paint.get("circle-radius").evaluate(f,k)+this.paint.get("circle-stroke-width").evaluate(f,k);k=this.paint.get("circle-pitch-scale");const l=this.paint.get("circle-pitch-alignment");let p,w;return"map"===l?(p=d,w=f*c):(p=function(x,y,D,H){return x.map(I=>Hi(I,y,D,H))}(d,a,e,h),w=f),Gi({queryGeometry:p,size:w,
transform:a,unwrappedTileID:e,getElevation:h,pitchAlignment:l,pitchScale:k},q)}}class ml extends nm{}let ll;Cb("HeatmapBucket",ml,{omit:["layers"]});var Kl={get paint(){return ll=ll||new Ef({"heatmap-radius":new Zc(b.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zc(b.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Bc(b.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Dl(b.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Bc(b.paint_heatmap["heatmap-opacity"])})}};class Xl{constructor(d,
f){eg(this,d,1,f)}resize(d){gi(this,d,1)}clone(){return new Xl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(d,f,k,q,a){hi(d,f,k,q,a,1)}}class Mg{constructor(d,f){eg(this,d,4,f)}resize(d){gi(this,d,4)}replace(d,f){f?this.data.set(d):this.data=d instanceof Uint8ClampedArray?new Uint8Array(d.buffer):d}clone(){return new Mg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(d,f,k,q,a){hi(d,f,k,q,a,4)}setPixel(d,f,k){d=4*(d*this.width+f);this.data[d+
0]=Math.round(255*k.r/k.a);this.data[d+1]=Math.round(255*k.g/k.a);this.data[d+2]=Math.round(255*k.b/k.a);this.data[d+3]=Math.round(255*k.a)}}Cb("AlphaImage",Xl);Cb("RGBAImage",Mg);class nn extends yg{createBucket(d){return new ml(d)}constructor(d,f){super(d,Kl,f);this.heatmapFbos=new Map;this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){"heatmap-color"===d&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zj({expression:this._transitionablePaint._values["heatmap-color"].value.expression,
evaluationKey:"heatmapDensity",image:this.colorRamp});this.colorRampTexture=null}resize(){this.heatmapFbos.has("big-fb")&&this.heatmapFbos.delete("big-fb")}queryRadius(d){return Qe("heatmap-radius",this,d)}queryIntersectsFeature({queryGeometry:d,feature:f,featureState:k,geometry:q,transform:a,pixelsToTileUnits:c,unwrappedTileID:e,getElevation:h}){return Gi({queryGeometry:d,size:this.paint.get("heatmap-radius").evaluate(f,k)*c,transform:a,unwrappedTileID:e,getElevation:h},q)}hasOffscreenPass(){return 0!==
this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Vm;var mm={get paint(){return Vm=Vm||new Ef({"hillshade-illumination-direction":new Bc(b.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Bc(b.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Bc(b.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Bc(b.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Bc(b.paint_hillshade["hillshade-shadow-color"]),
"hillshade-highlight-color":new Bc(b.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Bc(b.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Bc(b.paint_hillshade["hillshade-method"])})}};class Ll extends yg{constructor(d,f){super(d,mm,f);this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let d=this.paint.get("hillshade-illumination-direction").values;var f=this.paint.get("hillshade-illumination-altitude").values;let k=this.paint.get("hillshade-highlight-color").values,
q=this.paint.get("hillshade-shadow-color").values;const a=Math.max(d.length,f.length,k.length,q.length);d=d.concat(Array(a-d.length).fill(d.at(-1)));f=f.concat(Array(a-f.length).fill(f.at(-1)));k=k.concat(Array(a-k.length).fill(k.at(-1)));q=q.concat(Array(a-q.length).fill(q.at(-1)));f=f.map(yc);return{directionRadians:d.map(yc),altitudeRadians:f,shadowColor:q,highlightColor:k}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}let on;var pn={get paint(){return on=
on||new Ef({"color-relief-opacity":new Bc(b["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Dl(b["paint_color-relief"]["color-relief-color"])})}};class dh{constructor(d,f,k,q){this.context=d;this.format=k;this.texture=d.gl.createTexture();this.update(f,q)}update(d,f,k){const {width:q,height:a}=d,c=!(this.size&&this.size[0]===q&&this.size[1]===a||k),{context:e}=this,{gl:h}=e;if(this.useMipmap=!(!f||!f.useMipmap),h.bindTexture(h.TEXTURE_2D,this.texture),e.pixelStoreUnpackFlipY.set(!1),
e.pixelStoreUnpack.set(1),e.pixelStoreUnpackPremultiplyAlpha.set(this.format===h.RGBA&&(!f||!1!==f.premultiply)),c)this.size=[q,a],d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData||Tc(d)?h.texImage2D(h.TEXTURE_2D,0,this.format,this.format,h.UNSIGNED_BYTE,d):h.texImage2D(h.TEXTURE_2D,0,this.format,q,a,0,this.format,h.UNSIGNED_BYTE,d.data);else{const {x:l,y:p}=k||{x:0,y:0};d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||
d instanceof HTMLVideoElement||d instanceof ImageData||Tc(d)?h.texSubImage2D(h.TEXTURE_2D,0,l,p,h.RGBA,h.UNSIGNED_BYTE,d):h.texSubImage2D(h.TEXTURE_2D,0,l,p,q,a,h.RGBA,h.UNSIGNED_BYTE,d.data)}this.useMipmap&&this.isSizePowerOfTwo()&&h.generateMipmap(h.TEXTURE_2D);e.pixelStoreUnpackFlipY.setDefault();e.pixelStoreUnpack.setDefault();e.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(d,f,k){var {context:q}=this;({gl:q}=q);q.bindTexture(q.TEXTURE_2D,this.texture);k!==q.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||
(k=q.LINEAR);d!==this.filter&&(q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,d),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,k||d),this.filter=d);f!==this.wrap&&(q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,f),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&0==Math.log(this.size[0])/Math.LN2%1}destroy(){const {gl:d}=this.context;d.deleteTexture(this.texture);this.texture=null}}class pm{constructor(d,f,k,q=1,a=1,c=1,e=0){if(this.uid=
d,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(k&&!["mapbox","terrarium","custom"].includes(k))return void Ma(`"${k}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=f.height;d=this.dim=f.height-2;switch(this.data=new Uint32Array(f.data.buffer),k){case "terrarium":this.redFactor=256;this.greenFactor=1;this.blueFactor=1/256;this.baseShift=32768;break;case "custom":this.redFactor=q;this.greenFactor=a;this.blueFactor=c;this.baseShift=
e;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1E4}for(f=0;f<d;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(d,f)]=this.data[this._idx(d-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,d)]=this.data[this._idx(f,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)];this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)];this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)];this.data[this._idx(d,
d)]=this.data[this._idx(d-1,d-1)];this.min=Number.MAX_SAFE_INTEGER;this.max=Number.MIN_SAFE_INTEGER;for(f=0;f<d;f++)for(k=0;k<d;k++)q=this.get(f,k),q>this.max&&(this.max=q),q<this.min&&(this.min=q)}get(d,f){const k=new Uint8Array(this.data.buffer);d=4*this._idx(d,f);return this.unpack(k[d],k[d+1],k[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(d,f){if(-1>d||d>=this.dim+1||-1>f||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");
return(f+1)*this.stride+(d+1)}unpack(d,f,k){return d*this.redFactor+f*this.greenFactor+k*this.blueFactor-this.baseShift}pack(d){return wh(d,this.getUnpackVector())}getPixels(){return new Mg({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(d,f,k){if(this.dim!==d.dim)throw Error("dem dimension mismatch");let q=f*this.dim,a=f*this.dim+this.dim;var c=k*this.dim;let e=k*this.dim+this.dim;switch(f){case -1:q=a-1;break;case 1:a=q+1}switch(k){case -1:c=e-1;break;case 1:e=
c+1}f=-f*this.dim;for(k=-k*this.dim;c<e;c++)for(let h=q;h<a;h++)this.data[this._idx(h,c)]=d.data[this._idx(h+f,c+k)]}}Cb("DEMData",pm);class rn extends yg{constructor(d,f){super(d,pn,f)}_createColorRamp(d){const f={elevationStops:[],colorStops:[]};var k=this._transitionablePaint._values["color-relief-color"].value.expression;if(k instanceof El&&k._styleExpression.expression instanceof lg){this.colorRampExpression=k;k=k._styleExpression.expression;f.elevationStops=k.labels;f.colorStops=[];for(var q of f.elevationStops)f.colorStops.push(k.evaluate({globals:{elevation:q}}))}if(1>
f.elevationStops.length&&(f.elevationStops=[0],f.colorStops=[Bb.transparent]),2>f.elevationStops.length&&(f.elevationStops.push(f.elevationStops[0]+1),f.colorStops.push(f.colorStops[0])),f.elevationStops.length<=d)return f;q={elevationStops:[],colorStops:[]};d=(f.elevationStops.length-1)/(d-1);for(k=0;k<f.elevationStops.length-.5;k+=d)q.elevationStops.push(f.elevationStops[Math.round(k)]),q.colorStops.push(f.colorStops[Math.round(k)]);return Ma(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),
q}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(d,f,k){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;f=this._createColorRamp(f);const q=new Mg({width:f.colorStops.length,height:1}),a=new Mg({width:f.colorStops.length,height:1});for(let c=0;c<f.elevationStops.length;c++){const e=wh(f.elevationStops[c],k);a.setPixel(0,c,new Bb(e.r/255,e.g/255,e.b/255,1));q.setPixel(0,
c,f.colorStops[c])}return this.colorRampTextures={elevationTexture:new dh(d,a,d.gl.RGBA),colorTexture:new dh(d,q,d.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return"none"!==this.visibility&&!!this.colorRampTextures}}const Xm=ee([{name:"a_pos",components:2,type:"Int16"}],4),{members:qn}=Xm;class pl{constructor(d,f){if(f>d)throw Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=d;this._minGranularity=f}getGranularityForZoomLevel(d){return Math.max(Math.floor(this._baseZoomGranularity/
(1<<d)),this._minGranularity,1)}}class ck{constructor(d){this.fill=d.fill;this.line=d.line;this.tile=d.tile;this.stencil=d.stencil;this.circle=d.circle}}ck.noSubdivision=new ck({fill:new pl(0,0),line:new pl(0,0),tile:new pl(0,0),stencil:new pl(0,0),circle:1});Cb("SubdivisionGranularityExpression",pl);Cb("SubdivisionGranularitySetting",ck);class xg{constructor(d,f){this._vertexBuffer=[];this._vertexDictionary=new Map;this._used=!1;this._granularity=d;this._granularityCellSize=8192/d;this._canonical=
f}_getKey(d,f){return d+32768<<16|f+32768}_vertexToIndex(d,f){if(-32768>d||-32768>f||32767<d||32767<f)throw Error("Vertex coordinates are out of signed 16 bit integer range.");d=0|Math.round(d);f=0|Math.round(f);const k=this._getKey(d,f);if(this._vertexDictionary.has(k))return this._vertexDictionary.get(k);const q=this._vertexBuffer.length/2;return this._vertexDictionary.set(k,q),this._vertexBuffer.push(d,f),q}_subdivideTrianglesScanline(d){if(2>this._granularity){var f=this._vertexBuffer,k=[];for(var q=
0;q<d.length;q+=3){var a=d[q],c=d[q+1],e=d[q+2],h=f[2*a],l=f[2*a+1];0<(f[2*c]-h)*(f[2*e+1]-l)-(f[2*c+1]-l)*(f[2*e]-h)?(k.push(a),k.push(e),k.push(c)):(k.push(a),k.push(c),k.push(e))}return k}f=[];k=d.length;for(q=0;q<k;q+=3){a=[d[q+0],d[q+1],d[q+2]];c=[this._vertexBuffer[2*d[q+0]],this._vertexBuffer[2*d[q+0]+1],this._vertexBuffer[2*d[q+1]],this._vertexBuffer[2*d[q+1]+1],this._vertexBuffer[2*d[q+2]],this._vertexBuffer[2*d[q+2]+1]];h=1/0;var p=1/0;l=-1/0;e=-1/0;for(var w=0;3>w;w++){var x=c[2*w],y=c[2*
w+1];h=Math.min(h,x);l=Math.max(l,x);p=Math.min(p,y);e=Math.max(e,y)}if(h!==l&&p!==e)if(p=Math.floor(p/this._granularityCellSize),e=Math.ceil(e/this._granularityCellSize),Math.floor(h/this._granularityCellSize)!==Math.ceil(l/this._granularityCellSize)||p!==e)for(l=p;l<e;l++){p=this._scanlineGenerateVertexRingForCellRow(l,c,a);h=this._vertexBuffer;if(0===p.length)throw Error("Subdivision vertex ring is empty.");x=0;w=h[2*p[0]];for(y=1;y<p.length;y++){var D=h[2*p[y]];D<w&&(w=D,x=y)}w=p.length;for(y=
(x+1)%w;;){D=0<=x-1?x-1:w-1;const P=(y+1)%w;var H=h[2*p[D]],I=h[2*p[P]],L=h[2*p[x]];const Z=h[2*p[x]+1];var Y=h[2*p[y]+1];let aa=!1;if(H<I)aa=!0;else if(H>I)aa=!1;else{const T=Y-Z,ha=-(h[2*p[y]]-L);Y=Z<Y?1:-1;((H-L)*T+(h[2*p[D]+1]-Z)*ha)*Y>((I-L)*T+(h[2*p[P]+1]-Z)*ha)*Y&&(aa=!0)}aa?(H=p[D],I=p[x],L=p[y],H!==I&&H!==L&&I!==L&&f.push(L,I,H),x--,0>x&&(x=w-1)):(H=p[P],I=p[x],L=p[y],H!==I&&H!==L&&I!==L&&f.push(L,I,H),y++,y>=w&&(y=0));if(D===P)break}}else f.push(...a)}return f}_scanlineGenerateVertexRingForCellRow(d,
f,k){d*=this._granularityCellSize;const q=d+this._granularityCellSize,a=[];for(let l=0;3>l;l++){const p=f[2*l],w=f[2*l+1],x=f[2*(l+1)%6],y=f[(2*(l+1)+1)%6],D=f[2*(l+2)%6],H=f[(2*(l+2)+1)%6],I=x-p,L=y-w,Y=0===I,P=0===L;var c=(d-w)/L,e=(q-w)/L,h=Math.min(c,e);c=Math.max(c,e);!P&&(1<=h||0>=c)||P&&(w<d||w>q)?y>=d&&y<=q&&a.push(k[(l+1)%3]):(!P&&0<h&&a.push(this._vertexToIndex(p+I*h,w+L*h)),h=p+I*Math.max(h,0),e=p+I*Math.min(c,1),Y||this._generateIntraEdgeVertices(a,p,w,x,y,h,e),!P&&1>c&&a.push(this._vertexToIndex(p+
I*c,w+L*c)),(P||y>=d&&y<=q)&&a.push(k[(l+1)%3]),!P&&(y<=d||y>=q)&&this._generateInterEdgeVertices(a,p,w,x,y,D,H,e,d,q))}return a}_generateIntraEdgeVertices(d,f,k,q,a,c,e){const h=q-f;a-=k;const l=0===a;var p=Math.floor((l?Math.min(f,q):Math.min(c,e))/this._granularityCellSize)+1,w=Math.ceil((l?Math.max(f,q):Math.max(c,e))/this._granularityCellSize)-1;if(l?f<q:c<e)for(;p<=w;p++)q=p*this._granularityCellSize,d.push(this._vertexToIndex(q,k+a*(q-f)/h));else for(;w>=p;w--)q=w*this._granularityCellSize,
d.push(this._vertexToIndex(q,k+a*(q-f)/h))}_generateInterEdgeVertices(d,f,k,q,a,c,e,h,l,p){var w=e-a,x=(l-a)/w,y=(p-a)/w,D=Math.min(x,y);y=Math.max(x,y);var H=q+(c-q)*D;q=Math.floor(Math.min(H,h)/this._granularityCellSize)+1;x=Math.ceil(Math.max(H,h)/this._granularityCellSize)-1;H=h<H;w=0===w;if(!w||e!==l&&e!==p){if(w||1<=D||0>=y)D=k-e,f=c+(f-c)*Math.min((l-e)/D,(p-e)/D),q=Math.floor(Math.min(f,h)/this._granularityCellSize)+1,x=Math.ceil(Math.max(f,h)/this._granularityCellSize)-1,H=h<f;k=0<a-k?p:
l;if(H)for(a=q;a<=x;a++)d.push(this._vertexToIndex(a*this._granularityCellSize,k));else for(a=x;a>=q;a--)d.push(this._vertexToIndex(a*this._granularityCellSize,k))}}_generateOutline(d){const f=[];for(const k of d){d=Ph(k,this._granularity,!0);d=this._pointArrayToIndices(d);const q=[];for(let a=1;a<d.length;a++)q.push(d[a-1]),q.push(d[a]);f.push(q)}return f}_handlePoles(d){let f=!1,k=!1;this._canonical&&(0===this._canonical.y&&(f=!0),this._canonical.y===(1<<this._canonical.z)-1&&(k=!0));(f||k)&&this._fillPoles(d,
f,k)}_ensureNoPoleVertices(){const d=this._vertexBuffer;for(let f=0;f<d.length;f+=2){const k=d[f+1];-32768===k&&(d[f+1]=-32767);32767===k&&(d[f+1]=32766)}}_generatePoleQuad(d,f,k,q,a,c){q>a!=(-32768===c)?(d.push(f),d.push(k),d.push(this._vertexToIndex(q,c)),d.push(k),d.push(this._vertexToIndex(a,c)),d.push(this._vertexToIndex(q,c))):(d.push(k),d.push(f),d.push(this._vertexToIndex(q,c)),d.push(this._vertexToIndex(a,c)),d.push(k),d.push(this._vertexToIndex(q,c)))}_fillPoles(d,f,k){const q=this._vertexBuffer,
a=d.length;for(let c=2;c<a;c+=3){const e=d[c-2],h=d[c-1],l=d[c],p=q[2*e],w=q[2*e+1],x=q[2*h],y=q[2*h+1],D=q[2*l],H=q[2*l+1];f&&(0===w&&0===y&&this._generatePoleQuad(d,e,h,p,x,-32768),0===y&&0===H&&this._generatePoleQuad(d,h,l,x,D,-32768),0===H&&0===w&&this._generatePoleQuad(d,l,e,D,p,-32768));k&&(8192===w&&8192===y&&this._generatePoleQuad(d,e,h,p,x,32767),8192===y&&8192===H&&this._generatePoleQuad(d,h,l,x,D,32767),8192===H&&8192===w&&this._generatePoleQuad(d,l,e,D,p,32767))}}_initializeVertices(d){for(let f=
0;f<d.length;f+=2)this._vertexToIndex(d[f],d[f+1])}subdividePolygonInternal(d,f){if(this._used)throw Error("Subdivision: multiple use not allowed.");this._used=!0;const {flattened:k,holeIndices:q}=function(e){const h=[],l=[];for(const p of e)if(0!==p.length){p!==e[0]&&h.push(l.length/2);for(let w=0;w<p.length;w++)l.push(p[w].x),l.push(p[w].y)}return{flattened:l,holeIndices:h}}(d);let a;this._initializeVertices(k);try{var c=function(h,l,p=2){var w=l&&l.length;const x=w?l[0]*p:h.length;var y=Re(h,0,
x,p,!0);const D=[];if(!y||y.next===y.prev)return D;let H,I;if(w){w=[];for(let Z=0,aa=l.length;Z<aa;Z++){const T=Re(h,l[Z]*p,Z<aa-1?l[Z+1]*p:h.length,p,!1);T===T.next&&(T.steiner=!0);var L=w,Y=L.push;let ha=T,Ca=T;do(ha.x<Ca.x||ha.x===Ca.x&&ha.y<Ca.y)&&(Ca=ha),ha=ha.next;while(ha!==T);Y.call(L,Ca)}w.sort(lf);for(l=0;l<w.length;l++)y=Ii(w[l],y)}if(h.length>80*p){H=h[0];I=h[1];var P=H;l=I;for(w=p;w<x;w+=p)L=h[w],Y=h[w+1],L<H&&(H=L),Y<I&&(I=Y),L>P&&(P=L),Y>l&&(l=Y);P=Math.max(P-H,l-I);P=0!==P?32767/P:
0}return zd(y,D,p,H,I,P,0),D}(k,q);const e=this._convertIndices(k,c);a=this._subdivideTrianglesScanline(e)}catch(e){console.error(e)}c=[];return f&&(c=this._generateOutline(d)),this._ensureNoPoleVertices(),this._handlePoles(a),{verticesFlattened:this._vertexBuffer,indicesTriangles:a,indicesLineList:c}}_convertIndices(d,f){const k=[];for(let q=0;q<f.length;q++)k.push(this._vertexToIndex(d[2*f[q]],d[2*f[q]+1]));return k}_pointArrayToIndices(d){const f=[];for(let k=0;k<d.length;k++){const q=d[k];f.push(this._vertexToIndex(q.x,
q.y))}return f}}class Fm{constructor(d){this.zoom=d.zoom;this.overscaling=d.overscaling;this.layers=d.layers;this.layerIds=this.layers.map(f=>f.id);this.index=d.index;this.hasDependencies=!1;this.patternFeatures=[];this.layoutVertexArray=new gl;this.indexArray=new ah;this.indexArray2=new hl;this.programConfigurations=new ze(d.layers,d.zoom);this.segments=new Ve;this.segments2=new Ve;this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(d,f,k){this.hasDependencies=
Wc("fill",this.layers,f);var q=this.layers[0].layout.get("fill-sort-key");const a=!q.isConstant(),c=[];for(const {feature:h,id:l,index:p,sourceLayerIndex:w}of d){var e=this.layers[0]._featureFilter.needGeometry;const x=dg(h,e);if(!this.layers[0]._featureFilter.filter(new me(this.zoom),x,k))continue;const y=a?q.evaluate(x,{},k,f.availableImages):void 0;e={id:l,properties:h.properties,type:h.type,sourceLayerIndex:w,index:p,geometry:e?x.geometry:ye(h),patterns:{},sortKey:y};c.push(e)}a&&c.sort((h,l)=>
h.sortKey-l.sortKey);for(const h of c){const {geometry:l,index:p,sourceLayerIndex:w}=h;this.hasDependencies?(q=xh("fill",this.layers,h,{zoom:this.zoom},f),this.patternFeatures.push(q)):this.addFeature(h,l,p,k,{},f.subdivisionGranularity);f.featureIndex.insert(d[p].feature,l,p,w,this.index)}}update(d,f,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,f,this.stateDependentLayers,{imagePositions:k})}addFeatures(d,f,k){for(const q of this.patternFeatures)this.addFeature(q,
q.geometry,q.index,f,k,d.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,qn),this.indexBuffer=d.createIndexBuffer(this.indexArray),this.indexBuffer2=d.createIndexBuffer(this.indexArray2));this.programConfigurations.upload(d);this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),
this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(d,f,k,q,a,c){for(const e of Yi(f,500)){f=uf(e,q,c.fill.getGranularityForZoomLevel(q.z));const h=this.layoutVertexArray;Cj((l,p)=>{h.emplaceBack(l,p)},this.segments,this.layoutVertexArray,this.indexArray,f.verticesFlattened,f.indicesTriangles,this.segments2,this.indexArray2,f.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,
d,k,{imagePositions:a,canonical:q})}}let Lc,Ym;Cb("FillBucket",Fm,{omit:["layers","patternFeatures"]});var Tg={get paint(){return Ym=Ym||new Ef({"fill-antialias":new Bc(b.paint_fill["fill-antialias"]),"fill-opacity":new Zc(b.paint_fill["fill-opacity"]),"fill-color":new Zc(b.paint_fill["fill-color"]),"fill-outline-color":new Zc(b.paint_fill["fill-outline-color"]),"fill-translate":new Bc(b.paint_fill["fill-translate"]),"fill-translate-anchor":new Bc(b.paint_fill["fill-translate-anchor"]),"fill-pattern":new wl(b.paint_fill["fill-pattern"])})},
get layout(){return Lc=Lc||new Ef({"fill-sort-key":new Zc(b.layout_fill["fill-sort-key"])})}};class Qi extends yg{constructor(d,f){super(d,Tg,f)}recalculate(d,f){super.recalculate(d,f);d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new Fm(d)}queryRadius(){return eh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:d,geometry:f,transform:k,
pixelsToTileUnits:q}){return Hf(Og(d,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-k.bearingInRadians,q),f)}isTileClipped(){return!0}}const tn=ee([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Im=ee([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ql}=tn;class hg{constructor(d,f,k,q,a){this.properties={};this.extent=k;this.type=0;this.id=void 0;this._pbf=d;this._geometry=-1;this._keys=q;this._values=a;d.readFields(Qh,
this,f)}loadGeometry(){const d=this._pbf;d.pos=this._geometry;const f=d.readVarint()+d.pos,k=[];let q,a=1;var c=0;let e=0,h=0;for(;d.pos<f;)if(0>=c&&(c=d.readVarint(),a=7&c,c>>=3),c--,1===a||2===a)e+=d.readSVarint(),h+=d.readSVarint(),1===a&&(q&&k.push(q),q=[]),q&&q.push(new ta(e,h));else{if(7!==a)throw Error(`unknown command ${a}`);q&&q.push(q[0].clone())}return q&&k.push(q),k}bbox(){const d=this._pbf;d.pos=this._geometry;const f=d.readVarint()+d.pos;let k=1;var q=0;let a=0,c=0,e=1/0,h=-1/0,l=1/
0,p=-1/0;for(;d.pos<f;)if(0>=q&&(q=d.readVarint(),k=7&q,q>>=3),q--,1===k||2===k)a+=d.readSVarint(),c+=d.readSVarint(),a<e&&(e=a),a>h&&(h=a),c<l&&(l=c),c>p&&(p=c);else if(7!==k)throw Error(`unknown command ${k}`);return[e,l,h,p]}toGeoJSON(d,f,k){function q(w){return[360*(w.x+e)/c-180,360/Math.PI*Math.atan(Math.exp((1-2*(w.y+h)/c)*Math.PI))-90]}function a(w){return w.map(q)}const c=this.extent*Math.pow(2,k),e=this.extent*d,h=this.extent*f;d=this.loadGeometry();if(1===this.type){var l=[];for(var p of d)l.push(p[0]);
p=a(l);l=1===l.length?{type:"Point",coordinates:p[0]}:{type:"MultiPoint",coordinates:p}}else if(2===this.type)l=d.map(a),l=1===l.length?{type:"LineString",coordinates:l[0]}:{type:"MultiLineString",coordinates:l};else{if(3!==this.type)throw Error("unknown feature type");p=function(w){const x=w.length;if(1>=x)return[w];const y=[];let D,H;for(let L=0;L<x;L++){var I=w[L];let Y=0;for(let P,Z,aa=0,T=I.length,ha=T-1;aa<T;ha=aa++)P=I[aa],Z=I[ha],Y+=(Z.x-P.x)*(P.y+Z.y);I=Y;0!==I&&(void 0===H&&(H=0>I),H===
0>I?(D&&y.push(D),D=[w[L]]):D&&D.push(w[L]))}return D&&y.push(D),y}(d);d=[];for(l of p)d.push(l.map(a));l=1===d.length?{type:"Polygon",coordinates:d[0]}:{type:"MultiPolygon",coordinates:d}}l={type:"Feature",geometry:l,properties:this.properties};return null!=this.id&&(l.id=this.id),l}}hg.types=["Unknown","Point","LineString","Polygon"];class $d{constructor(d,f){this.version=1;this.name="";this.extent=4096;this.length=0;this._pbf=d;this._keys=[];this._values=[];this._features=[];d.readFields(vg,this,
f);this.length=this._features.length}feature(d){if(0>d||d>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[d];d=this._pbf.readVarint()+this._pbf.pos;return new hg(this._pbf,d,this.extent,this._keys,this._values)}}class Pf{constructor(d,f){this.layers=d.readFields(Nd,{},f)}}const wf=Math.pow(2,13);class df{constructor(d){this.zoom=d.zoom;this.overscaling=d.overscaling;this.layers=d.layers;this.layerIds=this.layers.map(f=>f.id);this.index=d.index;this.hasDependencies=
!1;this.layoutVertexArray=new bj;this.centroidVertexArray=new kk;this.indexArray=new ah;this.programConfigurations=new ze(d.layers,d.zoom);this.segments=new Ve;this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(d,f,k){this.features=[];this.hasDependencies=Wc("fill-extrusion",this.layers,f);for(const {feature:q,id:a,index:c,sourceLayerIndex:e}of d){d=this.layers[0]._featureFilter.needGeometry;const h=dg(q,d);this.layers[0]._featureFilter.filter(new me(this.zoom),
h,k)&&(d={id:a,sourceLayerIndex:e,index:c,geometry:d?h.geometry:ye(q),properties:q.properties,type:q.type,patterns:{}},this.hasDependencies?this.features.push(xh("fill-extrusion",this.layers,d,{zoom:this.zoom},f)):this.addFeature(d,d.geometry,c,k,{},f.subdivisionGranularity),f.featureIndex.insert(q,d.geometry,c,e,this.index,!0))}}addFeatures(d,f,k){for(const q of this.features){const {geometry:a}=q;this.addFeature(q,a,q.index,f,k,d.subdivisionGranularity)}}update(d,f,k){this.stateDependentLayers.length&&
this.programConfigurations.updatePaintArrays(d,f,this.stateDependentLayers,{imagePositions:k})}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,Ql),this.centroidVertexBuffer=d.createVertexBuffer(this.centroidVertexArray,Im.members,!0),this.indexBuffer=d.createIndexBuffer(this.indexArray));this.programConfigurations.upload(d);
this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(d,f,k,q,a,c){for(const h of Yi(f,500)){var e={x:0,y:0,sampleCount:0};f=this.layoutVertexArray.length;this.processPolygon(e,q,d,h,c);f=this.layoutVertexArray.length-f;const l=Math.floor(e.x/e.sampleCount);e=Math.floor(e.y/e.sampleCount);for(let p=0;p<f;p++)this.centroidVertexArray.emplaceBack(l,
e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,k,{imagePositions:a,canonical:q})}processPolygon(d,f,k,q,a){if(!(1>q.length||Ni(q[0]))){for(var c of q)0!==c.length&&wg(d,c);d={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)};a=a.fill.getGranularityForZoomLevel(f.z);k="Polygon"===hg.types[k.type];for(const h of q)0===h.length||Ni(h)||(c=Ph(h,a,k),this._generateSideFaces(c,d));if(k){f=uf(q,f,a,!1);var e=this.layoutVertexArray;Cj((h,l)=>
{vf(e,h,l,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,f.verticesFlattened,f.indicesTriangles)}}}_generateSideFaces(d,f){let k=0;for(let a=1;a<d.length;a++){var q=d[a];const c=d[a-1];if(q.x===c.x&&(0>q.x||8192<q.x)||q.y===c.y&&(0>q.y||8192<q.y))continue;f.segment.vertexLength+4>Ve.MAX_VERTEX_ARRAY_LENGTH&&(f.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const e=q.sub(c)._perp()._unit(),h=c.dist(q);32768<k+h&&(k=0);vf(this.layoutVertexArray,q.x,
q.y,e.x,e.y,0,0,k);vf(this.layoutVertexArray,q.x,q.y,e.x,e.y,0,1,k);k+=h;vf(this.layoutVertexArray,c.x,c.y,e.x,e.y,0,0,k);vf(this.layoutVertexArray,c.x,c.y,e.x,e.y,0,1,k);q=f.segment.vertexLength;this.indexArray.emplaceBack(q,q+2,q+1);this.indexArray.emplaceBack(q+1,q+2,q+3);f.segment.vertexLength+=4;f.segment.primitiveLength+=2}}}let Rh;Cb("FillExtrusionBucket",df,{omit:["layers","features"]});var ol={get paint(){return Rh=Rh||new Ef({"fill-extrusion-opacity":new Bc(b["paint_fill-extrusion"]["fill-extrusion-opacity"]),
"fill-extrusion-color":new Zc(b["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Bc(b["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Bc(b["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wl(b["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zc(b["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zc(b["paint_fill-extrusion"]["fill-extrusion-base"]),
"fill-extrusion-vertical-gradient":new Bc(b["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class bf extends yg{constructor(d,f){super(d,ol,f)}createBucket(d){return new df(d)}queryRadius(){return eh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:d,feature:f,featureState:k,geometry:q,transform:a,pixelsToTileUnits:c,pixelPosMatrix:e}){a=Og(d,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),
-a.bearingInRadians,c);d=this.paint.get("fill-extrusion-height").evaluate(f,k);f=this.paint.get("fill-extrusion-base").evaluate(f,k);k=function(h,l){const p=[];for(const w of h)h=[w.x,w.y,0,1],Fb(h,h,l),p.push(new ta(h[0]/h[3],h[1]/h[3]));return p}(a,e);q=function(h,l,p,w){const x=[],y=[],D=w[8]*l,H=w[9]*l,I=w[10]*l;l*=w[11];const L=w[8]*p,Y=w[9]*p,P=w[10]*p;p*=w[11];for(const xa of h){h=[];const Ha=[];for(const Fa of xa){var Z=Fa.x,aa=Fa.y,T=w[0]*Z+w[4]*aa+w[12];const Ra=w[1]*Z+w[5]*aa+w[13];var ha=
w[2]*Z+w[6]*aa+w[14],Ca=w[3]*Z+w[7]*aa+w[15];Z=ha+I;aa=Ca+l;const Ja=T+L,Ka=Ra+Y;ha+=P;Ca+=p;T=new ta((T+D)/aa,(Ra+H)/aa);T.z=Z/aa;h.push(T);T=new ta(Ja/Ca,Ka/Ca);T.z=ha/Ca;Ha.push(T)}x.push(h);y.push(Ha)}return[x,y]}(q,f,d,e);return function(h,l,p){let w=1/0;Hf(p,l)&&(w=ii(p,l[0]));for(let y=0;y<l.length;y++){const D=l[y],H=h[y];for(let I=0;I<D.length-1;I++){var x=D[I];x=[x,D[I+1],H[I+1],H[I],x];tf(p,x)&&(w=Math.min(w,ii(p,x)))}}return w!==1/0&&w}(q[0],q[1],k)}}const Ol=ee([{name:"a_pos_normal",
components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:kl}=Ol,Gj=ee([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:$m}=Gj,Pl=Math.cos(Math.PI/180*37.5),Jf=Math.pow(2,14)/.5;class Ml{constructor(d){this.zoom=d.zoom;this.overscaling=d.overscaling;this.layers=d.layers;this.layerIds=this.layers.map(f=>f.id);this.index=d.index;this.hasDependencies=!1;this.patternFeatures=[];this.lineClipsArray=[];this.gradients={};this.layers.forEach(f=>
{this.gradients[f.id]={}});this.layoutVertexArray=new Hl;this.layoutVertexArray2=new Zm;this.indexArray=new ah;this.programConfigurations=new ze(d.layers,d.zoom);this.segments=new Ve;this.maxLineLength=0;this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(d,f,k){this.hasDependencies=Wc("line",this.layers,f)||this.hasLineDasharray(this.layers);const q=this.layers[0].layout.get("line-sort-key"),a=!q.isConstant(),c=[];for(const {feature:h,id:l,index:p,sourceLayerIndex:w}of d){var e=
this.layers[0]._featureFilter.needGeometry;const x=dg(h,e);if(!this.layers[0]._featureFilter.filter(new me(this.zoom),x,k))continue;const y=a?q.evaluate(x,{},k):void 0;e={id:l,properties:h.properties,type:h.type,sourceLayerIndex:w,index:p,geometry:e?x.geometry:ye(h),patterns:{},dashes:{},sortKey:y};c.push(e)}a&&c.sort((h,l)=>h.sortKey-l.sortKey);for(const h of c){const {geometry:l,index:p,sourceLayerIndex:w}=h;this.hasDependencies?(Wc("line",this.layers,f)?xh("line",this.layers,h,{zoom:this.zoom},
f):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,h,this.zoom,f),this.patternFeatures.push(h)):this.addFeature(h,l,p,k,{},{},f.subdivisionGranularity);f.featureIndex.insert(d[p].feature,l,p,w,this.index)}}update(d,f,k,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,f,this.stateDependentLayers,{imagePositions:k,dashPositions:q})}addFeatures(d,f,k,q){for(const a of this.patternFeatures)this.addFeature(a,a.geometry,a.index,f,k,q,d.subdivisionGranularity)}isEmpty(){return 0===
this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=d.createVertexBuffer(this.layoutVertexArray2,$m)),this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,kl),this.indexBuffer=d.createIndexBuffer(this.indexArray));this.programConfigurations.upload(d);this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),
this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(d){if(d.properties&&Object.prototype.hasOwnProperty.call(d.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(d.properties,"mapbox_clip_end"))return{start:+d.properties.mapbox_clip_start,end:+d.properties.mapbox_clip_end}}addFeature(d,f,k,q,a,c,e){var h=this.layers[0].layout;const l=h.get("line-join").evaluate(d,{}),p=h.get("line-cap"),w=h.get("line-miter-limit");h=h.get("line-round-limit");this.lineClips=
this.lineFeatureClips(d);for(const x of f)this.addLine(x,d,l,p,w,h,q,e);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,k,{imagePositions:a,dashPositions:c,canonical:q})}addLine(d,f,k,q,a,c,e,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,d=Ph(d,e?h.line.getGranularityForZoomLevel(e.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(e=0;e<d.length-1;e++)this.totalDistance+=d[e].dist(d[e+1]);this.updateScaledDistance();this.maxLineLength=
Math.max(this.maxLineLength,this.totalDistance)}f="Polygon"===hg.types[f.type];for(e=d.length;2<=e&&d[e-1].equals(d[e-2]);)e--;for(h=0;h<e-1&&d[h].equals(d[h+1]);)h++;if(!(e<(f?3:2))){"bevel"===k&&(a=1.05);var l=16>=this.overscaling?122880/(512*this.overscaling):0,p=this.segments.prepareSegment(10*e,this.layoutVertexArray,this.indexArray),w,x,y,D,H;this.e1=this.e2=-1;f&&(w=d[e-2],H=d[h].sub(w)._unit()._perp());for(let ha=h;ha<e;ha++){if(y=ha===e-1?f?d[h+1]:void 0:d[ha+1],y&&d[ha].equals(y))continue;
H&&(D=H);w&&(x=w);w=d[ha];H=y?y.sub(w)._unit()._perp():D;D=D||H;var I=D.add(H);0===I.x&&0===I.y||I._unit();var L=D.x*H.x+D.y*H.y,Y=I.x*H.x+I.y*H.y,P=0!==Y?1/Y:1/0,Z=2*Math.sqrt(2-2*Y);Y=Y<Pl&&x&&y;const Ca=0<D.x*H.y-D.y*H.x;if(Y&&ha>h){var aa=w.dist(x);aa>2*l&&(aa=w.sub(w.sub(x)._mult(l/aa)._round()),this.updateDistance(x,aa),this.addCurrentVertex(aa,D,0,0,p),x=aa)}var T=x&&y;aa=T?k:f?"butt":q;if(T&&"round"===aa&&(P<c?aa="miter":2>=P&&(aa="fakeround")),"miter"===aa&&P>a&&(aa="bevel"),"bevel"===aa&&
(2<P&&(aa="flipbevel"),P<a&&(aa="miter")),x&&this.updateDistance(x,w),"miter"===aa)I._mult(P),this.addCurrentVertex(w,I,0,0,p);else if("flipbevel"===aa)100<P?I=H.mult(-1):(L=P*D.add(H).mag()/D.sub(H).mag(),I._perp()._mult(L*(Ca?-1:1))),this.addCurrentVertex(w,I,0,0,p),this.addCurrentVertex(w,I.mult(-1),0,0,p);else if("bevel"===aa||"fakeround"===aa){P=-Math.sqrt(P*P-1);I=Ca?P:0;P=Ca?0:P;if(x&&this.addCurrentVertex(w,D,I,P,p),"fakeround"===aa)for(Z=Math.round(180*Z/Math.PI/20),aa=1;aa<Z;aa++){T=aa/
Z;if(.5!==T){const xa=T-.5;T+=T*xa*(T-1)*((1.0904+L*(L*(3.55645-1.43519*L)-3.2452))*xa*xa+(.848013+L*(.215638*L-1.06021)))}T=H.sub(D)._mult(T)._add(D)._unit()._mult(Ca?-1:1);this.addHalfVertex(w,T.x,T.y,!1,Ca,0,p)}y&&this.addCurrentVertex(w,H,-I,-P,p)}else"butt"===aa?this.addCurrentVertex(w,I,0,0,p):"square"===aa?(L=x?1:-1,this.addCurrentVertex(w,I,L,L,p)):"round"===aa&&(x&&(this.addCurrentVertex(w,D,0,0,p),this.addCurrentVertex(w,D,1,1,p,!0)),y&&(this.addCurrentVertex(w,H,-1,-1,p,!0),this.addCurrentVertex(w,
H,0,0,p)));Y&&ha<e-1&&(Y=w.dist(y),Y>2*l&&(Y=w.add(y.sub(w)._mult(l/Y)._round()),this.updateDistance(w,Y),this.addCurrentVertex(Y,H,0,0,p),w=Y))}}}addCurrentVertex(d,f,k,q,a,c=!1){const e=f.y*q-f.x,h=-f.y-f.x*q;this.addHalfVertex(d,f.x+f.y*k,f.y-f.x*k,c,!1,k,a);this.addHalfVertex(d,e,h,c,!0,-q,a);this.distance>Jf/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(d,f,k,q,a,c))}addHalfVertex({x:d,y:f},k,q,a,c,e,h){const l=.5*(this.lineClips?this.scaledDistance*
(Jf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((d<<1)+(a?1:0),(f<<1)+(c?1:0),Math.round(63*k)+128,Math.round(63*q)+128,1+(0===e?0:0>e?-1:1)|(63&l)<<2,l>>6);this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);d=h.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,d,this.e2),h.primitiveLength++);c?this.e2=d:this.e1=d}updateScaledDistance(){this.scaledDistance=
this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(d,f){this.distance+=d.dist(f);this.updateScaledDistance()}hasLineDasharray(d){for(const f of d)if((d=f.paint.get("line-dasharray"))&&!d.isConstant())return!0;return!1}addLineDashDependencies(d,f,k,q){for(const e of d){var a=e.paint.get("line-dasharray");if(!a||"constant"===a.value.kind)continue;var c="round"===e.layout.get("line-cap");d={dasharray:a.value.evaluate({zoom:k-
1},f,{}),round:c};const h={dasharray:a.value.evaluate({zoom:k},f,{}),round:c};a={dasharray:a.value.evaluate({zoom:k+1},f,{}),round:c};c=`${d.dasharray.join(",")},${d.round}`;const l=`${h.dasharray.join(",")},${h.round}`,p=`${a.dasharray.join(",")},${a.round}`;q.dashDependencies[c]=d;q.dashDependencies[l]=h;q.dashDependencies[p]=a;f.dashes[e.id]={min:c,mid:l,max:p}}}}let ql,hh;Cb("LineBucket",Ml,{omit:["layers","patternFeatures"]});var om={get paint(){return hh=hh||new Ef({"line-opacity":new Zc(b.paint_line["line-opacity"]),
"line-color":new Zc(b.paint_line["line-color"]),"line-translate":new Bc(b.paint_line["line-translate"]),"line-translate-anchor":new Bc(b.paint_line["line-translate-anchor"]),"line-width":new Zc(b.paint_line["line-width"]),"line-gap-width":new Zc(b.paint_line["line-gap-width"]),"line-offset":new Zc(b.paint_line["line-offset"]),"line-blur":new Zc(b.paint_line["line-blur"]),"line-dasharray":new wl(b.paint_line["line-dasharray"]),"line-pattern":new wl(b.paint_line["line-pattern"]),"line-gradient":new Dl(b.paint_line["line-gradient"])})},
get layout(){return ql=ql||new Ef({"line-cap":new Bc(b.layout_line["line-cap"]),"line-join":new Zc(b.layout_line["line-join"]),"line-miter-limit":new Bc(b.layout_line["line-miter-limit"]),"line-round-limit":new Bc(b.layout_line["line-round-limit"]),"line-sort-key":new Zc(b.layout_line["line-sort-key"])})}};class Wm extends Zc{possiblyEvaluate(d,f){return f=new me(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(d,
f)}evaluate(d,f,k,q){return f=pd({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(d,f,k,q)}}let Li;class Km extends yg{constructor(d,f){super(d,om,f);this.gradientVersion=0;Li||(Li=new Wm(om.paint.properties["line-width"].specification),Li.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(d){"line-gradient"===d&&(d=this.gradientExpression(),this.stepInterpolant=void 0!==d._styleExpression&&d._styleExpression.expression instanceof nh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(d,
f){super.recalculate(d,f);this.paint._values["line-floorwidth"]=Li.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new Ml(d)}queryRadius(d){const f=Sh(Qe("line-width",this,d),Qe("line-gap-width",this,d));d=Qe("line-offset",this,d);return f/2+Math.abs(d)+eh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:d,feature:f,featureState:k,geometry:q,transform:a,pixelsToTileUnits:c}){d=Og(d,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),
-a.bearingInRadians,c);a=c/2*Sh(this.paint.get("line-width").evaluate(f,k),this.paint.get("line-gap-width").evaluate(f,k));f=this.paint.get("line-offset").evaluate(f,k);return f&&(q=function(e,h){const l=[];for(let x=0;x<e.length;x++){const y=e[x],D=[];for(let H=0;H<y.length;H++){var p=y[H-1];const I=y[H];var w=y[H+1];p=0===H?new ta(0,0):I.sub(p)._unit()._perp();w=H===y.length-1?new ta(0,0):w.sub(I)._unit()._perp();p=p._add(w)._unit();w=p.x*w.x+p.y*w.y;0!==w&&p._mult(1/w);D.push(p._mult(h)._add(I))}l.push(D)}return l}(q,
f*c)),function(e,h,l){for(let D=0;D<h.length;D++){var p=h[D];if(3<=e.length)for(var w=0;w<p.length;w++)if(Ng(e,p[w]))return!0;a:{w=e;var x=l;if(1<w.length){if(af(w,p)){w=!0;break a}for(var y=0;y<p.length;y++)if(Pe(p[y],w,x)){w=!0;break a}}for(y=0;y<w.length;y++)if(Pe(w[y],p,x)){w=!0;break a}w=!1}if(w)return!0}return!1}(d,q,a)}isTileClipped(){return!0}}const Nk=ee([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],
4),Lm=ee([{name:"a_projected_pos",components:3,type:"Float32"}],4);ee([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const sm=ee([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ee([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",
name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Hm=ee([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gm=ee([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ee([{name:"triangle",components:3,type:"Uint16"}]);ee([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},
{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);ee([{type:"Int16",
name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},
{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",
name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);ee([{type:"Float32",name:"offsetX"}]);ee([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);ee([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Kk={"!":"","#":"",$:"","%":"","\x26":"","(":"",")":"",
"*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","\x3c":"","\x3d":"","\x3e":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",
"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},un=1/4294967296,ae="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class Rm{constructor(d=new Uint8Array(16)){this.buf=ArrayBuffer.isView(d)?d:new Uint8Array(d);this.dataView=new DataView(this.buf.buffer);this.type=this.pos=0;this.length=this.buf.length}readFields(d,f,k=this.length){for(;this.pos<k;){const q=this.readVarint(),a=q>>3,c=this.pos;this.type=7&q;d(a,f,this);this.pos===
c&&this.skip(q)}return f}readMessage(d,f){return this.readFields(d,f,this.readVarint()+this.pos)}readFixed32(){const d=this.dataView.getUint32(this.pos,!0);return this.pos+=4,d}readSFixed32(){const d=this.dataView.getInt32(this.pos,!0);return this.pos+=4,d}readFixed64(){const d=this.dataView.getUint32(this.pos,!0)+4294967296*this.dataView.getUint32(this.pos+4,!0);return this.pos+=8,d}readSFixed64(){const d=this.dataView.getUint32(this.pos,!0)+4294967296*this.dataView.getInt32(this.pos+4,!0);return this.pos+=
8,d}readFloat(){const d=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,d}readDouble(){const d=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,d}readVarint(d){var f=this.buf;let k;k=f[this.pos++];var q=127&k;if(128>k)d=q;else if(k=f[this.pos++],q|=(127&k)<<7,128>k)d=q;else if(k=f[this.pos++],q|=(127&k)<<14,128>k)d=q;else if(k=f[this.pos++],q|=(127&k)<<21,128>k)d=q;else{k=f[this.pos];{f=q|(15&k)<<28;q=this.buf;let a,c;if((c=q[this.pos++],a=(112&c)>>4,128>c)||(c=q[this.pos++],a|=(127&
c)<<3,128>c)||(c=q[this.pos++],a|=(127&c)<<10,128>c)||(c=q[this.pos++],a|=(127&c)<<17,128>c)||(c=q[this.pos++],a|=(127&c)<<24,128>c)||(c=q[this.pos++],a|=(1&c)<<31,128>c))d=d?4294967296*a+(f>>>0):4294967296*(a>>>0)+(f>>>0);else throw Error("Expected varint not more than 10 bytes");}}return d}readVarint64(){return this.readVarint(!0)}readSVarint(){const d=this.readVarint();return 1==d%2?(d+1)/-2:d/2}readBoolean(){return!!this.readVarint()}readString(){var d=this.readVarint()+this.pos,f=this.pos;this.pos=
d;if(12<=d-f&&ae)d=ae.decode(this.buf.subarray(f,d));else{var k=this.buf;let q="";for(;f<d;){const a=k[f];let c,e,h,l=null,p=239<a?4:223<a?3:191<a?2:1;if(f+p>d)break;1===p?128>a&&(l=a):2===p?(c=k[f+1],128==(192&c)&&(l=(31&a)<<6|63&c,127>=l&&(l=null))):3===p?(c=k[f+1],e=k[f+2],128==(192&c)&&128==(192&e)&&(l=(15&a)<<12|(63&c)<<6|63&e,(2047>=l||55296<=l&&57343>=l)&&(l=null))):4===p&&(c=k[f+1],e=k[f+2],h=k[f+3],128==(192&c)&&128==(192&e)&&128==(192&h)&&(l=(15&a)<<18|(63&c)<<12|(63&e)<<6|63&h,(65535>=
l||1114112<=l)&&(l=null)));null===l?(l=65533,p=1):65535<l&&(l-=65536,q+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l);q+=String.fromCharCode(l);f+=p}d=q}return d}readBytes(){const d=this.readVarint()+this.pos,f=this.buf.subarray(this.pos,d);return this.pos=d,f}readPackedVarint(d=[],f){const k=this.readPackedEnd();for(;this.pos<k;)d.push(this.readVarint(f));return d}readPackedSVarint(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readSVarint());return d}readPackedBoolean(d=
[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readBoolean());return d}readPackedFloat(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readFloat());return d}readPackedDouble(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readDouble());return d}readPackedFixed32(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readFixed32());return d}readPackedSFixed32(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readSFixed32());return d}readPackedFixed64(d=
[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readFixed64());return d}readPackedSFixed64(d=[]){const f=this.readPackedEnd();for(;this.pos<f;)d.push(this.readSFixed64());return d}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(d){d&=7;if(0===d)for(;127<this.buf[this.pos++];);else if(2===d)this.pos=this.readVarint()+this.pos;else if(5===d)this.pos+=4;else{if(1!==d)throw Error(`Unimplemented type: ${d}`);this.pos+=8}}writeTag(d,f){this.writeVarint(d<<3|
f)}realloc(d){let f=this.length||16;for(;f<this.pos+d;)f*=2;f!==this.length&&(d=new Uint8Array(f),d.set(this.buf),this.buf=d,this.dataView=new DataView(d.buffer),this.length=f)}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(d){this.realloc(4);this.dataView.setInt32(this.pos,d,!0);this.pos+=4}writeSFixed32(d){this.realloc(4);this.dataView.setInt32(this.pos,d,!0);this.pos+=4}writeFixed64(d){this.realloc(8);this.dataView.setInt32(this.pos,-1&d,!0);this.dataView.setInt32(this.pos+
4,Math.floor(d*un),!0);this.pos+=8}writeSFixed64(d){this.realloc(8);this.dataView.setInt32(this.pos,-1&d,!0);this.dataView.setInt32(this.pos+4,Math.floor(d*un),!0);this.pos+=8}writeVarint(d){268435455<(d=+d||0)||0>d?function(f,k){let q,a;if(0<=f?(q=f%4294967296|0,a=f/4294967296|0):(q=~(-f%4294967296),a=~(-f/4294967296),4294967295^q?q=q+1|0:(q=0,a=a+1|0)),1.8446744073709552E19<=f||-1.8446744073709552E19>f)throw Error("Given varint doesn't fit into 10 bytes");k.realloc(10);(function(c,e,h){h.buf[h.pos++]=
127&c|128;c>>>=7;h.buf[h.pos++]=127&c|128;c>>>=7;h.buf[h.pos++]=127&c|128;c>>>=7;h.buf[h.pos++]=127&c|128;h.buf[h.pos]=127&c>>>7})(q,0,k);(function(c,e){e.buf[e.pos++]|=(7&c)<<4|((c>>>=3)?128:0);c&&(e.buf[e.pos++]=127&c|((c>>>=7)?128:0),c&&(e.buf[e.pos++]=127&c|((c>>>=7)?128:0),c&&(e.buf[e.pos++]=127&c|((c>>>=7)?128:0),c&&(e.buf[e.pos++]=127&c|((c>>>=7)?128:0),c&&(e.buf[e.pos++]=127&c)))))})(a,k)}(d,this):(this.realloc(4),this.buf[this.pos++]=127&d|(127<d?128:0),127>=d||(this.buf[this.pos++]=127&
(d>>>=7)|(127<d?128:0),127>=d||(this.buf[this.pos++]=127&(d>>>=7)|(127<d?128:0),127>=d||(this.buf[this.pos++]=d>>>7&127))))}writeSVarint(d){this.writeVarint(0>d?2*-d-1:2*d)}writeBoolean(d){this.writeVarint(+d)}writeString(d){d=String(d);this.realloc(4*d.length);this.pos++;const f=this.pos;var k=this.buf,q=this.pos;for(let a,c,e=0;e<d.length;e++){if(a=d.charCodeAt(e),55295<a&&57344>a){if(!c){56319<a||e+1===d.length?(k[q++]=239,k[q++]=191,k[q++]=189):c=a;continue}if(56320>a){k[q++]=239;k[q++]=191;k[q++]=
189;c=a;continue}a=c-55296<<10|a-56320|65536;c=null}else c&&(k[q++]=239,k[q++]=191,k[q++]=189,c=null);128>a?k[q++]=a:(2048>a?k[q++]=a>>6|192:(65536>a?k[q++]=a>>12|224:(k[q++]=a>>18|240,k[q++]=a>>12&63|128),k[q++]=a>>6&63|128),k[q++]=63&a|128)}this.pos=q;k=this.pos-f;128<=k&&Ek(f,k,this);this.pos=f-1;this.writeVarint(k);this.pos+=k}writeFloat(d){this.realloc(4);this.dataView.setFloat32(this.pos,d,!0);this.pos+=4}writeDouble(d){this.realloc(8);this.dataView.setFloat64(this.pos,d,!0);this.pos+=8}writeBytes(d){const f=
d.length;this.writeVarint(f);this.realloc(f);for(let k=0;k<f;k++)this.buf[this.pos++]=d[k]}writeRawMessage(d,f){this.pos++;const k=this.pos;d(f,this);d=this.pos-k;128<=d&&Ek(k,d,this);this.pos=k-1;this.writeVarint(d);this.pos+=d}writeMessage(d,f,k){this.writeTag(d,2);this.writeRawMessage(f,k)}writePackedVarint(d,f){f.length&&this.writeMessage(d,Dj,f)}writePackedSVarint(d,f){f.length&&this.writeMessage(d,bk,f)}writePackedBoolean(d,f){f.length&&this.writeMessage(d,A,f)}writePackedFloat(d,f){f.length&&
this.writeMessage(d,Gk,f)}writePackedDouble(d,f){f.length&&this.writeMessage(d,t,f)}writePackedFixed32(d,f){f.length&&this.writeMessage(d,E,f)}writePackedSFixed32(d,f){f.length&&this.writeMessage(d,N,f)}writePackedFixed64(d,f){f.length&&this.writeMessage(d,U,f)}writePackedSFixed64(d,f){f.length&&this.writeMessage(d,ea,f)}writeBytesField(d,f){this.writeTag(d,2);this.writeBytes(f)}writeFixed32Field(d,f){this.writeTag(d,5);this.writeFixed32(f)}writeSFixed32Field(d,f){this.writeTag(d,5);this.writeSFixed32(f)}writeFixed64Field(d,
f){this.writeTag(d,1);this.writeFixed64(f)}writeSFixed64Field(d,f){this.writeTag(d,1);this.writeSFixed64(f)}writeVarintField(d,f){this.writeTag(d,0);this.writeVarint(f)}writeSVarintField(d,f){this.writeTag(d,0);this.writeSVarint(f)}writeStringField(d,f){this.writeTag(d,2);this.writeString(f)}writeFloatField(d,f){this.writeTag(d,5);this.writeFloat(f)}writeDoubleField(d,f){this.writeTag(d,1);this.writeDouble(f)}writeBooleanField(d,f){this.writeVarintField(d,+f)}}class Zl{constructor(d,{pixelRatio:f,
version:k,stretchX:q,stretchY:a,content:c,textFitWidth:e,textFitHeight:h}){this.paddedRect=d;this.pixelRatio=f;this.stretchX=q;this.stretchY=a;this.content=c;this.version=k;this.textFitWidth=e;this.textFitHeight=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}
class kn{constructor(d,f){const k={},q={};this.haveRenderCallbacks=[];var a=[];this.addImages(d,k,a);this.addImages(f,q,a);const {w:c,h:e}=Sa(a);a=new Mg({width:c||1,height:e||1});for(var h in d){var l=d[h],p=k[h].paddedRect;Mg.copy(l.data,a,{x:0,y:0},{x:p.x+1,y:p.y+1},l.data)}for(const w in f){d=f[w];l=q[w].paddedRect;h=l.x+1;l=l.y+1;p=d.data.width;const x=d.data.height;Mg.copy(d.data,a,{x:0,y:0},{x:h,y:l},d.data);Mg.copy(d.data,a,{x:0,y:x-1},{x:h,y:l-1},{width:p,height:1});Mg.copy(d.data,a,{x:0,
y:0},{x:h,y:l+x},{width:p,height:1});Mg.copy(d.data,a,{x:p-1,y:0},{x:h-1,y:l},{width:1,height:x});Mg.copy(d.data,a,{x:0,y:0},{x:h+p,y:l},{width:1,height:x})}this.image=a;this.iconPositions=k;this.patternPositions=q}addImages(d,f,k){for(const q in d){const a=d[q],c={x:0,y:0,w:a.data.width+2,h:a.data.height+2};k.push(c);f[q]=new Zl(c,a);a.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(d,f){d.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const k in d.updatedImages)this.patchUpdatedImage(this.iconPositions[k],
d.getImage(k),f),this.patchUpdatedImage(this.patternPositions[k],d.getImage(k),f)}patchUpdatedImage(d,f,k){if(d&&f&&d.version!==f.version){d.version=f.version;var [q,a]=d.tl;k.update(f.data,void 0,{x:q,y:a})}}}var Sk;Cb("ImagePosition",Zl);Cb("ImageAtlas",kn);M.ao=void 0;(Sk=M.ao||(M.ao={}))[Sk.none=0]="none";Sk[Sk.horizontal=1]="horizontal";Sk[Sk.vertical=2]="vertical";Sk[Sk.horizontalOnly=3]="horizontalOnly";class $l{constructor(){this.scale=1;this.fontStack="";this.imageName=null;this.verticalAlign=
"bottom"}static forText(d,f,k){const q=new $l;return q.scale=d||1,q.fontStack=f,q.verticalAlign=k||"bottom",q}static forImage(d,f){const k=new $l;return k.imageName=d,k.verticalAlign=f||"bottom",k}}class Am{constructor(){this.text="";this.sectionIndex=[];this.sections=[];this.imageSectionID=null}static fromFeature(d,f){const k=new Am;for(let q=0;q<d.sections.length;q++){const a=d.sections[q];a.image?k.addImageSection(a):k.addTextSection(a,f)}return k}length(){return this.text.length}getSection(d){return this.sections[this.sectionIndex[d]]}getSectionIndex(d){return this.sectionIndex[d]}getCharCode(d){return this.text.charCodeAt(d)}verticalizePunctuation(){var d=
this.text;let f="";for(let k=0;k<d.length;k++){const q=d.charCodeAt(k+1)||null,a=d.charCodeAt(k-1)||null;f+=q&&ed(q)&&!Kk[d[k+1]]||a&&ed(a)&&!Kk[d[k-1]]||!Kk[d[k]]?d[k]:Kk[d[k]]}this.text=f}trim(){let d=0;for(var f=0;f<this.text.length&&Tk[this.text.charCodeAt(f)];f++)d++;f=this.text.length;for(let k=this.text.length-1;0<=k&&k>=d&&Tk[this.text.charCodeAt(k)];k--)f--;this.text=this.text.substring(d,f);this.sectionIndex=this.sectionIndex.slice(d,f)}substring(d,f){const k=new Am;return k.text=this.text.substring(d,
f),k.sectionIndex=this.sectionIndex.slice(d,f),k.sections=this.sections,k}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((d,f)=>Math.max(d,this.sections[f].scale),0)}getMaxImageSize(d){let f=0,k=0;for(let a=0;a<this.length();a++){var q=this.getSection(a);q.imageName&&(q=d[q.imageName])&&(q=q.displaySize,f=Math.max(f,q[0]),k=Math.max(k,q[1]))}return{maxImageWidth:f,maxImageHeight:k}}addTextSection(d,f){this.text+=d.text;this.sections.push($l.forText(d.scale,d.fontStack||
f,d.verticalAlign));f=this.sections.length-1;for(let k=0;k<d.text.length;++k)this.sectionIndex.push(f)}addImageSection(d){const f=d.image?d.image.name:"";if(0===f.length)return void Ma("Can't add FormattedSection with an empty image.");const k=this.getNextImageSectionCharCode();k?(this.text+=String.fromCharCode(k),this.sections.push($l.forImage(f,d.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Ma("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?
63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}const Tk={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cn={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Om={40:!0},n=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];class r{constructor(d){this.layoutVertexArray=new yk;this.indexArray=new ah;this.programConfigurations=d;this.segments=new Ve;this.dynamicLayoutVertexArray=new Wj;this.opacityVertexArray=
new Hg;this.hasVisibleVertices=!1;this.placedSymbolArray=new wk}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(d,f,k,q){this.isEmpty()||(k&&(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,Nk.members),this.indexBuffer=d.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=d.createVertexBuffer(this.dynamicLayoutVertexArray,Lm.members,!0),this.opacityVertexBuffer=
d.createVertexBuffer(this.opacityVertexArray,n,!0),this.opacityVertexBuffer.itemSize=1),(k||q)&&this.programConfigurations.upload(d))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Cb("SymbolBuffers",r);class B{constructor(d,f,k){this.layoutVertexArray=new d;this.layoutAttributes=f;this.indexArray=new k;this.segments=
new Ve;this.collisionVertexArray=new zk}upload(d){this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes);this.indexBuffer=d.createIndexBuffer(this.indexArray);this.collisionVertexBuffer=d.createVertexBuffer(this.collisionVertexArray,sm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Cb("CollisionBuffers",B);class F{constructor(d){this.collisionBoxArray=
d.collisionBoxArray;this.zoom=d.zoom;this.overscaling=Ac(globalThis)?Math.min(d.overscaling,128):d.overscaling;this.layers=d.layers;this.layerIds=this.layers.map(a=>a.id);this.index=d.index;this.pixelRatio=d.pixelRatio;this.sourceLayerIndex=d.sourceLayerIndex;this.hasRTLText=this.hasDependencies=!1;this.sortKeyRanges=[];this.collisionCircleArray=[];var f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Rf(this.zoom,f["text-size"]);this.iconSizeData=Rf(this.zoom,f["icon-size"]);f=this.layers[0].layout;
const k=f.get("symbol-sort-key"),q=f.get("symbol-z-order");this.canOverlap="never"!==ij(f,"text-overlap","text-allow-overlap")||"never"!==ij(f,"icon-overlap","icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement");this.sortFeaturesByKey="viewport-y"!==q&&!k.isConstant();this.sortFeaturesByY=("viewport-y"===q||"auto"===q&&!this.sortFeaturesByKey)&&this.canOverlap;"point"===f.get("symbol-placement")&&(this.writingModes=f.get("text-writing-mode").map(a=>M.ao[a]));this.stateDependentLayerIds=
this.layers.filter(a=>a.isStateDependent()).map(a=>a.id);this.sourceID=d.sourceID}createArrays(){this.text=new r(new ze(this.layers,this.zoom,d=>/^text/.test(d)));this.icon=new r(new ze(this.layers,this.zoom,d=>/^icon/.test(d)));this.glyphOffsetArray=new qm;this.lineVertexArray=new Ej;this.symbolInstances=new im;this.textAnchorOffsets=new Ij}calculateGlyphDependencies(d,f,k,q,a){for(let c=0;c<d.length;c++)if(f[d.charCodeAt(c)]=!0,(k||q)&&a){const e=Kk[d.charAt(c)];e&&(f[e.charCodeAt(0)]=!0)}}populate(d,
f,k){const q=this.layers[0],a=q.layout,c=a.get("text-font");var e=a.get("text-field"),h=a.get("icon-image");e=("constant"!==e.value.kind||e.value.value instanceof fd&&!e.value.value.isEmpty()||0<e.value.value.toString().length)&&("constant"!==c.value.kind||0<c.value.value.length);h="constant"!==h.value.kind||!!h.value.value||0<Object.keys(h.parameters).length;const l=a.get("symbol-sort-key");if(this.features=[],e||h){var p=f.iconDependencies,w=f.glyphDependencies;f=f.availableImages;var x=new me(this.zoom);
for(const {feature:L,id:Y,index:P,sourceLayerIndex:Z}of d){var y=q._featureFilter.needGeometry;d=dg(L,y);if(!q._featureFilter.filter(x,d,k))continue;let aa;var D=void 0;if(y||(d.geometry=ye(L)),e){y=q.getValueAndResolveTokens("text-field",d,k,f);y=fd.factory(y);var H=this.hasRTLText=this.hasRTLText||Jk(y);(!H||"unavailable"===yi.getRTLTextPluginStatus()||H&&yi.isParsed())&&(aa=ak(y,q,d))}h&&(D=q.getValueAndResolveTokens("icon-image",d,k,f),D=D instanceof we?D:we.fromString(D));if(aa||D)if(y=this.sortFeaturesByKey?
l.evaluate(d,{},k):void 0,this.features.push({id:Y,text:aa,icon:D,index:P,sourceLayerIndex:Z,geometry:d.geometry,properties:L.properties,type:hg.types[L.type],sortKey:y}),D&&(p[D.name]=!0),aa){d=c.evaluate(d,{},k).join(",");y="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(M.ao.vertical);for(const T of aa.sections)if(T.image)p[T.image.name]=!0;else{H=Ld(aa.toString());var I=T.fontStack||
d;I=w[I]=w[I]||{};this.calculateGlyphDependencies(T.text,I,y,this.allowVerticalPlacement,H)}}}"line"===a.get("symbol-placement")&&(this.features=function(L){function Y(Fa,Ra,Ja){const Ka=T[Fa];return delete T[Fa],T[Ra]=Ka,ha[Ka].geometry[0].pop(),ha[Ka].geometry[0]=ha[Ka].geometry[0].concat(Ja[0]),Ka}function P(Fa,Ra,Ja){const Ka=aa[Ra];return delete aa[Ra],aa[Fa]=Ka,ha[Ka].geometry[0].shift(),ha[Ka].geometry[0]=Ja[0].concat(ha[Ka].geometry[0]),Ka}function Z(Fa,Ra,Ja){Ra=Ja?Ra[0][Ra[0].length-1]:
Ra[0][0];return`${Fa}:${Ra.x}:${Ra.y}`}const aa={},T={},ha=[];let Ca=0;for(let Fa=0;Fa<L.length;Fa++){var xa=L[Fa],Ha=xa.geometry;xa=xa.text?xa.text.toString():null;if(!xa){ha.push(L[Fa]);Ca++;continue}const Ra=Z(xa,Ha),Ja=Z(xa,Ha,!0);if(Ra in T&&Ja in aa&&T[Ra]!==aa[Ja]){Ha=P(Ra,Ja,Ha);const Ka=Y(Ra,Ja,ha[Ha].geometry);delete aa[Ra];delete T[Ja];T[Z(xa,ha[Ka].geometry,!0)]=Ka;ha[Ha].geometry=null}else Ra in T?Y(Ra,Ja,Ha):Ja in aa?P(Ra,Ja,Ha):(ha.push(L[Fa]),Ca++,aa[Ra]=Ca-1,T[Ja]=Ca-1)}return ha.filter(Fa=>
Fa.geometry)}(this.features));this.sortFeaturesByKey&&this.features.sort((L,Y)=>L.sortKey-Y.sortKey)}}update(d,f,k){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(d,f,this.layers,{imagePositions:k}),this.icon.programConfigurations.updatePaintArrays(d,f,this.layers,{imagePositions:k}))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(d){!this.uploaded&&
this.hasDebugData()&&(this.textCollisionBox.upload(d),this.iconCollisionBox.upload(d));this.text.upload(d,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload);this.icon.upload(d,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload);this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy();this.iconCollisionBox.destroy()}destroy(){this.text.destroy();this.icon.destroy();this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(d,
f){const k=this.lineVertexArray.length;if(void 0!==d.segment){let a=d.dist(f[d.segment+1]);var q=d.dist(f[d.segment]);const c={};for(let e=d.segment+1;e<f.length;e++)c[e]={x:f[e].x,y:f[e].y,tileUnitDistanceFromAnchor:a},e<f.length-1&&(a+=f[e+1].dist(f[e]));for(d=d.segment||0;0<=d;d--)c[d]={x:f[d].x,y:f[d].y,tileUnitDistanceFromAnchor:q},0<d&&(q+=f[d-1].dist(f[d]));for(q=0;q<f.length;q++)d=c[q],this.lineVertexArray.emplaceBack(d.x,d.y,d.tileUnitDistanceFromAnchor)}return{lineStartIndex:k,lineLength:this.lineVertexArray.length-
k}}addSymbols(d,f,k,q,a,c,e,h,l,p,w,x){a=d.indexArray;const y=d.layoutVertexArray,D=d.segments.prepareSegment(4*f.length,y,a,this.canOverlap?c.sortKey:void 0),H=this.glyphOffsetArray.length,I=D.vertexLength,L=this.allowVerticalPlacement&&e===M.ao.vertical?Math.PI/2:0,Y=c.text&&c.text.sections;for(let P=0;P<f.length;P++){const {tl:Z,tr:aa,bl:T,br:ha,tex:Ca,pixelOffsetTL:xa,pixelOffsetBR:Ha,minFontScaleX:Fa,minFontScaleY:Ra,glyphOffset:Ja,isSDF:Ka,sectionIndex:lb}=f[P],wb=D.vertexLength,Mb=Ja[1];Ug(y,
h.x,h.y,Z.x,Mb+Z.y,Ca.x,Ca.y,k,Ka,xa.x,xa.y,Fa,Ra);Ug(y,h.x,h.y,aa.x,Mb+aa.y,Ca.x+Ca.w,Ca.y,k,Ka,Ha.x,xa.y,Fa,Ra);Ug(y,h.x,h.y,T.x,Mb+T.y,Ca.x,Ca.y+Ca.h,k,Ka,xa.x,Ha.y,Fa,Ra);Ug(y,h.x,h.y,ha.x,Mb+ha.y,Ca.x+Ca.w,Ca.y+Ca.h,k,Ka,Ha.x,Ha.y,Fa,Ra);Mc(d.dynamicLayoutVertexArray,h,L);a.emplaceBack(wb,wb+2,wb+1);a.emplaceBack(wb+1,wb+2,wb+3);D.vertexLength+=4;D.primitiveLength+=2;this.glyphOffsetArray.emplaceBack(Ja[0]);P!==f.length-1&&lb===f[P+1].sectionIndex||d.programConfigurations.populatePaintArrays(y.length,
c,c.index,{imagePositions:{},canonical:x,formattedSection:Y&&Y[lb]})}d.placedSymbolArray.emplaceBack(h.x,h.y,H,this.glyphOffsetArray.length-H,I,l,p,h.segment,k?k[0]:0,k?k[1]:0,q[0],q[1],e,0,!1,0,w)}_addCollisionDebugVertex(d,f,k,q,a,c){return f.emplaceBack(0,0),d.emplaceBack(k.x,k.y,q,a,Math.round(c.x),Math.round(c.y))}addCollisionDebugVertices(d,f,k,q,a,c,e){const h=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),l=h.vertexLength,p=a.layoutVertexArray,w=a.collisionVertexArray,x=e.anchorX;
e=e.anchorY;this._addCollisionDebugVertex(p,w,c,x,e,new ta(d,f));this._addCollisionDebugVertex(p,w,c,x,e,new ta(k,f));this._addCollisionDebugVertex(p,w,c,x,e,new ta(k,q));this._addCollisionDebugVertex(p,w,c,x,e,new ta(d,q));h.vertexLength+=4;d=a.indexArray;d.emplaceBack(l,l+1);d.emplaceBack(l+1,l+2);d.emplaceBack(l+2,l+3);d.emplaceBack(l+3,l);h.primitiveLength+=4}addDebugCollisionBoxes(d,f,k,q){for(;d<f;d++){const a=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(a.x1,a.y1,a.x2,a.y2,
q?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,k)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData();this.textCollisionBox=new B($g,Hm.members,hl);this.iconCollisionBox=new B($g,Hm.members,hl);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0);this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0);this.addDebugCollisionBoxes(f.iconBoxStartIndex,
f.iconBoxEndIndex,f,!1);this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(d,f,k,q,a,c,e,h,l){const p={};for(;f<k;){k=d.get(f);p.textBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY};p.textFeatureIndex=k.featureIndex;break}for(;q<a;){a=d.get(q);p.verticalTextBox={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,anchorPointX:a.anchorPointX,anchorPointY:a.anchorPointY};p.verticalTextFeatureIndex=a.featureIndex;
break}for(;c<e;){e=d.get(c);p.iconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY};p.iconFeatureIndex=e.featureIndex;break}for(;h<l;){d=d.get(h);p.verticalIconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY};p.verticalIconFeatureIndex=d.featureIndex;break}return p}deserializeCollisionBoxes(d){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const k=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(d,
k.textBoxStartIndex,k.textBoxEndIndex,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k.iconBoxStartIndex,k.iconBoxEndIndex,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex))}}hasTextData(){return 0<this.text.segments.get().length}hasIconData(){return 0<this.icon.segments.get().length}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length}hasIconCollisionBoxData(){return this.hasDebugData()&&
0<this.iconCollisionBox.segments.get().length}addIndicesForPlacedSymbol(d,f){var k=d.placedSymbolArray.get(f);f=k.vertexStartIndex+4*k.numGlyphs;for(k=k.vertexStartIndex;k<f;k+=4)d.indexArray.emplaceBack(k,k+2,k+1),d.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(d){if(this.sortedAngle===d&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const f=Math.sin(d);d=Math.cos(d);const k=[],q=[],a=[];for(let c=0;c<this.symbolInstances.length;++c){a.push(c);const e=this.symbolInstances.get(c);
k.push(0|Math.round(f*e.anchorX+d*e.anchorY));q.push(e.featureIndex)}return a.sort((c,e)=>k[c]-k[e]||q[e]-q[c]),a}addToSortKeyRanges(d,f){const k=this.sortKeyRanges[this.sortKeyRanges.length-1];k&&k.sortKey===f?k.symbolInstanceEnd=d+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:d,symbolInstanceEnd:d+1})}sortFeatures(d){if(this.sortFeaturesByY&&this.sortedAngle!==d&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(d);
this.sortedAngle=d;this.text.indexArray.clear();this.icon.indexArray.clear();this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes)d=this.symbolInstances.get(f),this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((k,q,a)=>{0<=k&&a.indexOf(k)===q&&this.addIndicesForPlacedSymbol(this.text,k)}),0<=d.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),
0<=d.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),0<=d.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex);this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray);this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Q,V;Cb("SymbolBucket",F,{omit:["layers","collisionBoxArray","features","compareText"]});F.MAX_GLYPHS=65535;F.addDynamicAttributes=Mc;var oa=
{get paint(){return V=V||new Ef({"icon-opacity":new Zc(b.paint_symbol["icon-opacity"]),"icon-color":new Zc(b.paint_symbol["icon-color"]),"icon-halo-color":new Zc(b.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zc(b.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zc(b.paint_symbol["icon-halo-blur"]),"icon-translate":new Bc(b.paint_symbol["icon-translate"]),"icon-translate-anchor":new Bc(b.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zc(b.paint_symbol["text-opacity"]),"text-color":new Zc(b.paint_symbol["text-color"],
{runtimeType:X,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Zc(b.paint_symbol["text-halo-color"]),"text-halo-width":new Zc(b.paint_symbol["text-halo-width"]),"text-halo-blur":new Zc(b.paint_symbol["text-halo-blur"]),"text-translate":new Bc(b.paint_symbol["text-translate"]),"text-translate-anchor":new Bc(b.paint_symbol["text-translate-anchor"])})},get layout(){return Q=Q||new Ef({"symbol-placement":new Bc(b.layout_symbol["symbol-placement"]),"symbol-spacing":new Bc(b.layout_symbol["symbol-spacing"]),
"symbol-avoid-edges":new Bc(b.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zc(b.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Bc(b.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Bc(b.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Bc(b.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Bc(b.layout_symbol["icon-ignore-placement"]),"icon-optional":new Bc(b.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Bc(b.layout_symbol["icon-rotation-alignment"]),
"icon-size":new Zc(b.layout_symbol["icon-size"]),"icon-text-fit":new Bc(b.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Bc(b.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zc(b.layout_symbol["icon-image"]),"icon-rotate":new Zc(b.layout_symbol["icon-rotate"]),"icon-padding":new Zc(b.layout_symbol["icon-padding"]),"icon-keep-upright":new Bc(b.layout_symbol["icon-keep-upright"]),"icon-offset":new Zc(b.layout_symbol["icon-offset"]),"icon-anchor":new Zc(b.layout_symbol["icon-anchor"]),
"icon-pitch-alignment":new Bc(b.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Bc(b.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Bc(b.layout_symbol["text-rotation-alignment"]),"text-field":new Zc(b.layout_symbol["text-field"]),"text-font":new Zc(b.layout_symbol["text-font"]),"text-size":new Zc(b.layout_symbol["text-size"]),"text-max-width":new Zc(b.layout_symbol["text-max-width"]),"text-line-height":new Bc(b.layout_symbol["text-line-height"]),"text-letter-spacing":new Zc(b.layout_symbol["text-letter-spacing"]),
"text-justify":new Zc(b.layout_symbol["text-justify"]),"text-radial-offset":new Zc(b.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Bc(b.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zc(b.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zc(b.layout_symbol["text-anchor"]),"text-max-angle":new Bc(b.layout_symbol["text-max-angle"]),"text-writing-mode":new Bc(b.layout_symbol["text-writing-mode"]),"text-rotate":new Zc(b.layout_symbol["text-rotate"]),
"text-padding":new Bc(b.layout_symbol["text-padding"]),"text-keep-upright":new Bc(b.layout_symbol["text-keep-upright"]),"text-transform":new Zc(b.layout_symbol["text-transform"]),"text-offset":new Zc(b.layout_symbol["text-offset"]),"text-allow-overlap":new Bc(b.layout_symbol["text-allow-overlap"]),"text-overlap":new Bc(b.layout_symbol["text-overlap"]),"text-ignore-placement":new Bc(b.layout_symbol["text-ignore-placement"]),"text-optional":new Bc(b.layout_symbol["text-optional"])})}};class Ia{constructor(d){if(void 0===
d.property.overrides)throw Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=d.property.overrides?d.property.overrides.runtimeType:C;this.defaultValue=d}evaluate(d){if(d.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(d.formattedSection))return f.getOverride(d.formattedSection)}return d.feature&&d.featureState?this.defaultValue.evaluate(d.feature,d.featureState):this.defaultValue.property.specification.default}eachChild(d){this.defaultValue.isConstant()||
d(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Cb("FormatSectionOverride",Ia,{omit:["defaultValue"]});class Ta extends yg{constructor(d,f){super(d,oa,f)}recalculate(d,f){if(super.recalculate(d,f),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]=
"point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement"))if(d=this.layout.get("text-writing-mode")){f=[];for(const k of d)0>f.indexOf(k)&&f.push(k);
this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"];this._setPaintOverrides()}getValueAndResolveTokens(d,f,k,q){k=this.layout.get(d).evaluate(f,{},k,q);d=this._unevaluatedLayout._values[d];return d.isDataDriven()||Ff(d.value)||!k?k:function(a,c){return c.replace(/{([^{}]+)}/g,(e,h)=>a&&h in a?String(a[h]):"")}(f.properties,k)}createBucket(d){return new F(d)}queryRadius(){return 0}queryIntersectsFeature(){throw Error("Should take a different path in FeatureIndex");
}_setPaintOverrides(){for(const f of oa.paint.overridableProperties){if(!Ta.hasPaintOverride(this.layout,f))continue;const k=this.paint.get(f);var d=new Ia(k);d=new ik(d,k.property.specification);d="constant"===k.value.kind||"source"===k.value.kind?new El("source",d):new Uh("composite",d,k.value.zoomStops);this.paint._values[f]=new nj(k.property,d,k.parameters)}}_handleOverridablePaintPropertyUpdate(d,f,k){return!(!this.layout||f.isDataDriven()||k.isDataDriven())&&Ta.hasPaintOverride(this.layout,
d)}static hasPaintOverride(d,f){d=d.get("text-field");const k=oa.paint.properties[f];let q=!1;const a=c=>{for(const e of c)if(k.overrides&&k.overrides.hasOverride(e))return void(q=!0)};if("constant"===d.value.kind&&d.value.value instanceof fd)a(d.value.value.sections);else if("source"===d.value.kind||"composite"===d.value.kind){const c=e=>{q||(e instanceof oe&&re(e.value)===ya?a(e.value.sections):e instanceof pi?a(e.sections):e.eachChild(c))};f=d.value;f._styleExpression&&c(f._styleExpression.expression)}return q}}
let tb;var Zb={get paint(){return tb=tb||new Ef({"background-color":new Bc(b.paint_background["background-color"]),"background-pattern":new Sm(b.paint_background["background-pattern"]),"background-opacity":new Bc(b.paint_background["background-opacity"])})}};class gc extends yg{constructor(d,f){super(d,Zb,f)}}class Pb extends yg{constructor(d,f){super(d,{},f);this.onAdd=k=>{this.implementation.onAdd&&this.implementation.onAdd(k,k.painter.context.gl)};this.onRemove=k=>{this.implementation.onRemove&&
this.implementation.onRemove(k,k.painter.context.gl)};this.implementation=d}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw Error("Custom layers cannot be serialized");}}class Ec{constructor(d){this._methodToThrottle=d;this._triggered=!1;"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=
!1;this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1;this._methodToThrottle()},0))}remove(){delete this._channel;this._methodToThrottle=()=>{}}}const Oc={once:!0};class Kc{constructor(d,f){if(isNaN(d)||isNaN(f))throw Error(`Invalid LngLat object: (${d}, ${f})`);if(this.lng=+d,this.lat=+f,90<this.lat||-90>this.lat)throw Error("Invalid LngLat latitude value: must be between -90 and 90");}wrap(){return new Kc(Nc(this.lng,
-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(d){const f=Math.PI/180,k=this.lat*f,q=d.lat*f;return 6371008.8*Math.acos(Math.min(Math.sin(k)*Math.sin(q)+Math.cos(k)*Math.cos(q)*Math.cos((d.lng-this.lng)*f),1))}static convert(d){if(d instanceof Kc)return d;if(Array.isArray(d)&&(2===d.length||3===d.length))return new Kc(Number(d[0]),Number(d[1]));if(!Array.isArray(d)&&"object"==typeof d&&null!==d)return new Kc(Number("lng"in d?
d.lng:d.lon),Number(d.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: \x3clng\x3e, lat: \x3clat\x3e}, an object {lon: \x3clng\x3e, lat: \x3clat\x3e}, or an array of [\x3clng\x3e, \x3clat\x3e]");}}const Te=1.27420176E7*Math.PI;class gb{constructor(d,f,k=0){this.x=+d;this.y=+f;this.z=+k}static fromLngLat(d,f=0){d=Kc.convert(d);return new gb(Vg(d.lng),rl(d.lat),f/(Te*Math.cos(d.lat*Math.PI/180)))}toLngLat(){return new Kc(360*this.x-180,ji(this.y))}toAltitude(){return ve(this.z,
this.y)}meterInMercatorCoordinateUnits(){var d;return 1/Te*(d=ji(this.y),1/Math.cos(d*Math.PI/180))}}class Xa{constructor(d,f,k){if(0>d||25<d||0>k||k>=Math.pow(2,d)||0>f||f>=Math.pow(2,d))throw Error(`x=${f}, y=${k}, z=${d} outside of bounds. 0<=x<${Math.pow(2,d)}, 0<=y<${Math.pow(2,d)} 0<=z<=25 `);this.z=d;this.x=f;this.y=k;this.key=Xd(0,d,d,f,k)}equals(d){return this.z===d.z&&this.x===d.x&&this.y===d.y}url(d,f,k){const q=(c=this.y,e=this.z,h=fg(256*(a=this.x),256*(c=Math.pow(2,e)-c-1),e),l=fg(256*
(a+1),256*(c+1),e),h[0]+","+h[1]+","+l[0]+","+l[1]);var a,c,e,h,l;c="";for(e=this.z;0<e;e--)a=1<<e-1,c+=(this.x&a?1:0)+(this.y&a?2:0);a=c;return d[(this.x+this.y)%d.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===k?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,1<f?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,q)}isChildOf(d){const f=this.z-d.z;return 0<
f&&d.x===this.x>>f&&d.y===this.y>>f}getTilePoint(d){const f=Math.pow(2,this.z);return new ta(8192*(d.x*f-this.x),8192*(d.y*f-this.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class nb{constructor(d,f){this.wrap=d;this.canonical=f;this.key=Xd(d,f.z,f.z,f.x,f.y)}}class ac{constructor(d,f,k,q,a){if(this.terrainRttPosMatrix32f=null,d<k)throw Error(`overscaledZ should be >= z; overscaledZ = ${d}; z = ${k}`);this.overscaledZ=d;this.wrap=f;this.canonical=new Xa(k,+q,+a);this.key=Xd(f,d,k,q,a)}clone(){return new ac(this.overscaledZ,
this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(d){return this.overscaledZ===d.overscaledZ&&this.wrap===d.wrap&&this.canonical.equals(d.canonical)}scaledTo(d){if(d>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${d}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-d;return d>this.canonical.z?new ac(d,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ac(d,this.wrap,d,this.canonical.x>>f,this.canonical.y>>f)}isOverscaled(){return this.overscaledZ>
this.canonical.z}calculateScaledKey(d,f){if(d>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${d}; overscaledZ = ${this.overscaledZ}`);const k=this.canonical.z-d;return d>this.canonical.z?Xd(this.wrap*+f,d,this.canonical.z,this.canonical.x,this.canonical.y):Xd(this.wrap*+f,d,d,this.canonical.x>>k,this.canonical.y>>k)}isChildOf(d){if(d.wrap!==this.wrap||0>=this.overscaledZ-d.overscaledZ)return!1;if(0===d.overscaledZ)return 0<this.overscaledZ;const f=this.canonical.z-d.canonical.z;
return!(0>f)&&d.canonical.x===this.canonical.x>>f&&d.canonical.y===this.canonical.y>>f}children(d){if(this.overscaledZ>=d)return[new ac(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];d=this.canonical.z+1;const f=2*this.canonical.x,k=2*this.canonical.y;return[new ac(d,this.wrap,d,f,k),new ac(d,this.wrap,d,f+1,k),new ac(d,this.wrap,d,f,k+1),new ac(d,this.wrap,d,f+1,k+1)]}isLessThan(d){return this.wrap<d.wrap||!(this.wrap>d.wrap)&&(this.overscaledZ<d.overscaledZ||!(this.overscaledZ>
d.overscaledZ)&&(this.canonical.x<d.canonical.x||!(this.canonical.x>d.canonical.x)&&this.canonical.y<d.canonical.y))}wrapped(){return new ac(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(d){return new ac(this.overscaledZ,d,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(d){return this.canonical.getTilePoint(new gb(d.x-
this.wrap,d.y))}}Cb("CanonicalTileID",Xa);Cb("OverscaledTileID",ac,{omit:["terrainRttPosMatrix32f"]});class Qc{constructor(){this.minX=1/0;this.maxX=-1/0;this.minY=1/0;this.maxY=-1/0}extend(d){return this.minX=Math.min(this.minX,d.x),this.minY=Math.min(this.minY,d.y),this.maxX=Math.max(this.maxX,d.x),this.maxY=Math.max(this.maxY,d.y),this}expandBy(d){return this.minX-=d,this.minY-=d,this.maxX+=d,this.maxY+=d,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=
-1/0),this}shrinkBy(d){return this.expandBy(-d)}map(d){const f=new Qc;return f.extend(d(new ta(this.minX,this.minY))),f.extend(d(new ta(this.maxX,this.minY))),f.extend(d(new ta(this.minX,this.maxY))),f.extend(d(new ta(this.maxX,this.maxY))),f}static fromPoints(d){const f=new Qc;for(const k of d)f.extend(k);return f}contains(d){return d.x>=this.minX&&d.x<=this.maxX&&d.y>=this.minY&&d.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(d){return!this.empty()&&
!d.empty()&&d.minX>=this.minX&&d.maxX<=this.maxX&&d.minY>=this.minY&&d.maxY<=this.maxY}intersects(d){return!this.empty()&&!d.empty()&&d.minX<=this.maxX&&d.maxX>=this.minX&&d.minY<=this.maxY&&d.maxY>=this.minY}}class jd{constructor(d){this._stringToNumber={};this._numberToString=[];for(let f=0;f<d.length;f++){const k=d[f];this._stringToNumber[k]=f;this._numberToString[f]=k}}encode(d){return this._stringToNumber[d]}decode(d){if(d>=this._numberToString.length)throw Error(`Out of bounds. Index requested n=${d} can't be >= this._numberToString.length ${this._numberToString.length}`);
return this._numberToString[d]}}class hd{constructor(d,f,k,q,a){this.type="Feature";this._vectorTileFeature=d;d._z=f;d._x=k;d._y=q;this.properties=d.properties;this.id=a}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(d){this._geometry=d}toJSON(){const d={geometry:this.geometry};for(const f in this)"_geometry"!==f&&"_vectorTileFeature"!==
f&&(d[f]=this[f]);return d}}class rd{constructor(d,f){this.tileID=d;this.x=d.canonical.x;this.y=d.canonical.y;this.z=d.canonical.z;this.grid=new vm(8192,16,0);this.grid3D=new vm(8192,16,0);this.featureIndexArray=new sn;this.promoteId=f}insert(d,f,k,q,a,c){d=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(k,q,a);k=c?this.grid3D:this.grid;for(q=0;q<f.length;q++){a=f[q];c=[1/0,1/0,-1/0,-1/0];for(let e=0;e<a.length;e++){const h=a[e];c[0]=Math.min(c[0],h.x);c[1]=Math.min(c[1],h.y);c[2]=
Math.max(c[2],h.x);c[3]=Math.max(c[3],h.y)}8192>c[0]&&8192>c[1]&&0<=c[2]&&0<=c[3]&&k.insert(d,c[0],c[1],c[2],c[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=(new Pf(new Rm(this.rawTileData))).layers,this.sourceLayerCoder=new jd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(d,f,k,q){this.loadVTLayers();const a=d.params,c=8192/d.tileSize/d.scale,e=$c(a.filter,a.globalState),h=d.queryGeometry,l=d.queryPadding*c;var p=Qc.fromPoints(h);p=this.grid.query(p.minX-
l,p.minY-l,p.maxX+l,p.maxY+l);var w=Qc.fromPoints(d.cameraQueryGeometry).expandBy(l);w=this.grid3D.query(w.minX,w.minY,w.maxX,w.maxY,(H,I,L,Y)=>{a:{var P=d.cameraQueryGeometry;H-=l;I-=l;L+=l;Y+=l;for(var Z of P)if(H<=Z.x&&I<=Z.y&&L>=Z.x&&Y>=Z.y){P=!0;break a}Z=[new ta(H,I),new ta(H,Y),new ta(L,Y),new ta(L,I)];if(2<P.length)for(var aa of Z)if(Ng(P,aa)){P=!0;break a}for(aa=0;aa<P.length-1;aa++)if(Y=P[aa],H=P[aa+1],L=Z[0],I=Z[2],Y.x<L.x&&H.x<L.x||Y.x>I.x&&H.x>I.x||Y.y<L.y&&H.y<L.y||Y.y>I.y&&H.y>I.y?
Y=!1:(L=jb(Y,H,Z[0]),Y=L!==jb(Y,H,Z[1])||L!==jb(Y,H,Z[2])||L!==jb(Y,H,Z[3])),Y){P=!0;break a}P=!1}return P});for(var x of w)p.push(x);p.sort(tm);x={};let y;for(w=0;w<p.length;w++){var D=p[w];if(D===y)continue;y=D;D=this.featureIndexArray.get(D);let H=null;this.loadMatchingFeature(x,D.bucketIndex,D.sourceLayerIndex,D.featureIndex,e,a.layers,a.availableImages,f,k,q,(I,L,Y)=>(H||(H=ye(I)),L.queryIntersectsFeature({queryGeometry:h,feature:I,featureState:Y,geometry:H,zoom:this.z,transform:d.transform,
pixelsToTileUnits:c,pixelPosMatrix:d.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:d.getElevation})))}return x}loadMatchingFeature(d,f,k,q,a,c,e,h,l,p,w){f=this.bucketLayerIDs[f];if(!c||f.some(L=>c.has(L))){var x=this.sourceLayerCoder.decode(k);k=this.vtLayers[x].feature(q);if(a.needGeometry){var y=dg(k,!0);if(!a.filter(new me(this.tileID.overscaledZ),y,this.tileID.canonical))return}else if(!a.filter(new me(this.tileID.overscaledZ),k))return;a=this.getId(k,x);for(x=0;x<f.length;x++)if(y=
f[x],!c||c.has(y)){var D=h[y];if(D){var H={};a&&p&&(H=p.getState(D.sourceLayer||"_geojsonTileLayer",a));var I=pd({},l[y]);I.paint=Xc(I.paint,D.paint,k,H,e);I.layout=Xc(I.layout,D.layout,k,H,e);if(D=!w||w(k,D,H))H=new hd(k,this.z,this.x,this.y,a),H.layer=I,I=d[y],void 0===I&&(I=d[y]=[]),I.push({featureIndex:q,feature:H,intersectionZ:D})}}}}lookupSymbolFeatures(d,f,k,q,a,c,e,h){const l={};this.loadVTLayers();a=$c(a.filterSpec,a.globalState);for(const p of d)this.loadMatchingFeature(l,k,q,p,a,c,e,h,
f);return l}hasLayer(d){for(const f of this.bucketLayerIDs)for(const k of f)if(d===k)return!0;return!1}getId(d,f){var k;let q=d.id;return this.promoteId&&(q=d.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[f]],"boolean"==typeof q&&(q=Number(q)),void 0===q&&(null===(k=d.properties)||void 0===k?void 0:k.cluster)&&this.promoteId&&(q=Number(d.properties.cluster_id))),q}}Cb("FeatureIndex",rd,{omit:["rawTileData","sourceLayerCoder"]});class We extends ta{constructor(d,f,k,q){super(d,
f);this.angle=k;void 0!==q&&(this.segment=q)}clone(){return new We(this.x,this.y,this.angle,this.segment)}}Cb("Anchor",We);class Wd{constructor(d,f,k,q,a,c,e,h,l,p){var w;if(this.boxStartIndex=d.length,l)f=c.top,k=c.bottom,(q=c.collisionPadding)&&(f-=q[1],k+=q[3]),f=k-f,0<f&&(f=Math.max(10,f),this.circleDiameter=f);else{l=(null===(w=c.image)||void 0===w?0:w.content)&&(c.image.textFitWidth||c.image.textFitHeight)?Fj(c):{x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};l.y1=l.y1*e-h[0];l.y2=l.y2*e+h[2];l.x1=
l.x1*e-h[3];l.x2=l.x2*e+h[1];c=c.collisionPadding;if(c&&(l.x1-=c[0]*e,l.y1-=c[1]*e,l.x2+=c[2]*e,l.y2+=c[3]*e),p)c=new ta(l.x1,l.y1),e=new ta(l.x2,l.y1),h=new ta(l.x1,l.y2),w=new ta(l.x2,l.y2),p=p*Math.PI/180,c._rotate(p),e._rotate(p),h._rotate(p),w._rotate(p),l.x1=Math.min(c.x,e.x,h.x,w.x),l.x2=Math.max(c.x,e.x,h.x,w.x),l.y1=Math.min(c.y,e.y,h.y,w.y),l.y2=Math.max(c.y,e.y,h.y,w.y);d.emplaceBack(f.x,f.y,l.x1,l.y1,l.x2,l.y2,k,q,a)}this.boxEndIndex=d.length}}class dj{constructor(d=[],f=(k,q)=>k<q?-1:
k>q?1:0){if(this.data=d,this.length=this.data.length,this.compare=f,0<this.length)for(d=(this.length>>1)-1;0<=d;d--)this._down(d)}push(d){this.data.push(d);this._up(this.length++)}pop(){if(0!==this.length){var d=this.data[0],f=this.data.pop();return 0<--this.length&&(this.data[0]=f,this._down(0)),d}}peek(){return this.data[0]}_up(d){const {data:f,compare:k}=this,q=f[d];for(;0<d;){const a=d-1>>1,c=f[a];if(0<=k(q,c))break;f[d]=c;d=a}f[d]=q}_down(d){const {data:f,compare:k}=this,q=this.length>>1,a=f[d];
for(;d<q;){let c=1+(d<<1);const e=c+1;if(e<this.length&&0>k(f[e],f[c])&&(c=e),0<=k(f[c],a))break;f[d]=f[c];d=c}f[d]=a}}var Pd;M.aE=void 0;(Pd=M.aE||(M.aE={}))[Pd.center=1]="center";Pd[Pd.left=2]="left";Pd[Pd.right=3]="right";Pd[Pd.top=4]="top";Pd[Pd.bottom=5]="bottom";Pd[Pd["top-left"]=6]="top-left";Pd[Pd["top-right"]=7]="top-right";Pd[Pd["bottom-left"]=8]="bottom-left";Pd[Pd["bottom-right"]=9]="bottom-right";const En=Number.POSITIVE_INFINITY,hn=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,
Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ln{static from(d){if(!(d instanceof ArrayBuffer))throw Error("Data must be an instance of ArrayBuffer.");const [f,k]=new Uint8Array(d,0,2);if(219!==f)throw Error("Data does not appear to be in a KDBush format.");var q=k>>4;if(1!==q)throw Error(`Got v${q} data when expected v1.`);q=hn[15&k];if(!q)throw Error("Unrecognized array type.");const [a]=new Uint16Array(d,2,1),[c]=new Uint32Array(d,4,1);return new Ln(c,a,q,d)}constructor(d,
f=64,k=Float64Array,q){if(isNaN(d)||0>d)throw Error(`Unpexpected numItems value: ${d}.`);this.numItems=+d;this.nodeSize=Math.min(Math.max(+f,2),65535);this.ArrayType=k;this.IndexArrayType=65536>d?Uint16Array:Uint32Array;const a=hn.indexOf(this.ArrayType),c=2*d*this.ArrayType.BYTES_PER_ELEMENT,e=d*this.IndexArrayType.BYTES_PER_ELEMENT,h=(8-e%8)%8;if(0>a)throw Error(`Unexpected typed array class: ${k}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,d),this.coords=
new this.ArrayType(this.data,8+e+h,2*d),this._pos=2*d,this._finished=!0):(this.data=new ArrayBuffer(8+c+e+h),this.ids=new this.IndexArrayType(this.data,8,d),this.coords=new this.ArrayType(this.data,8+e+h,2*d),this._pos=0,this._finished=!1,(new Uint8Array(this.data,0,2)).set([219,16+a]),(new Uint16Array(this.data,2,1))[0]=f,(new Uint32Array(this.data,4,1))[0]=d)}add(d,f){const k=this._pos>>1;return this.ids[k]=k,this.coords[this._pos++]=d,this.coords[this._pos++]=f,k}finish(){const d=this._pos>>1;
if(d!==this.numItems)throw Error(`Added ${d} items when expected ${this.numItems}.`);return Je(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(d,f,k,q){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");const {ids:a,coords:c,nodeSize:e}=this,h=[0,a.length-1,0],l=[];for(;h.length;){var p=h.pop()||0;const y=h.pop()||0;var w=h.pop()||0;if(y-w<=e){for(p=w;p<=y;p++){w=c[2*p];var x=c[2*p+1];w>=d&&w<=k&&x>=f&&x<=q&&l.push(a[p])}continue}x=w+
y>>1;const D=c[2*x],H=c[2*x+1];D>=d&&D<=k&&H>=f&&H<=q&&l.push(a[x]);(0===p?d<=D:f<=H)&&(h.push(w),h.push(x-1),h.push(1-p));(0===p?k>=D:q>=H)&&(h.push(x+1),h.push(y),h.push(1-p))}return l}within(d,f,k){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");const {ids:q,coords:a,nodeSize:c}=this,e=[0,q.length-1,0],h=[],l=k*k;for(;e.length;){var p=e.pop()||0;const w=e.pop()||0,x=e.pop()||0;if(w-x<=c){for(p=x;p<=w;p++)rm(a[2*p],a[2*p+1],d,f)<=l&&h.push(q[p]);continue}const y=x+
w>>1,D=a[2*y],H=a[2*y+1];rm(D,H,d,f)<=l&&h.push(q[y]);(0===p?d-k<=D:f-k<=H)&&(e.push(x),e.push(y-1),e.push(1-p));(0===p?d+k>=D:f+k>=H)&&(e.push(y+1),e.push(w),e.push(1-p))}return h}}var Fn;M.cx=void 0;(Fn=M.cx||(M.cx={})).create="create";Fn.load="load";Fn.fullLoad="fullLoad";let An=null,Pm=[];const Qm=1E3/60,Gn=class{constructor(d,f){this.target=d;this.mapId=f;this.resolveRejects={};this.tasks={};this.taskQueue=[];this.abortControllers={};this.messageHandlers={};this.invoker=new Ec(()=>this.process());
this.subscription=Vc(this.target,"message",k=>this.receive(k),!1);this.globalScope=sc(self)?d:window}registerMessageHandler(d,f){this.messageHandlers[d]=f}sendAsync(d,f){return new Promise((k,q)=>{const a=Math.round(1E18*Math.random()).toString(36).substring(0,10),c=f?Vc(f.signal,"abort",()=>{null==c||c.unsubscribe();delete this.resolveRejects[a];this.target.postMessage({id:a,type:"\x3ccancel\x3e",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId})},Oc):null;this.resolveRejects[a]=
{resolve:l=>{null==c||c.unsubscribe();k(l)},reject:l=>{null==c||c.unsubscribe();q(l)}};const e=[],h=Object.assign(Object.assign({},d),{id:a,sourceMapId:this.mapId,origin:location.origin,data:sf(d.data,e)});this.target.postMessage(h,{transfer:e})})}receive(d){var f=d.data;d=f.id;if(!("file://"!==f.origin&&"file://"!==location.origin&&"resource://android"!==f.origin&&"resource://android"!==location.origin&&f.origin!==location.origin||f.targetMapId&&this.mapId!==f.targetMapId)){if("\x3ccancel\x3e"===
f.type)return delete this.tasks[d],f=this.abortControllers[d],delete this.abortControllers[d],void(f&&f.abort());if(sc(self)||f.mustQueue)return this.tasks[d]=f,this.taskQueue.push(d),void this.invoker.trigger();this.processTask(d,f)}}process(){if(0!==this.taskQueue.length){var d=this.taskQueue.shift(),f=this.tasks[d];delete this.tasks[d];0<this.taskQueue.length&&this.invoker.trigger();f&&this.processTask(d,f)}}processTask(d,f){return v(this,void 0,void 0,function*(){if("\x3cresponse\x3e"===f.type){var k=
this.resolveRejects[d];return(delete this.resolveRejects[d],k)?void(f.error?k.reject(ld(f.error)):k.resolve(ld(f.data))):void 0}if(!this.messageHandlers[f.type])return void this.completeTask(d,Error(`Could not find a registered handler for ${f.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));k=ld(f.data);const q=new AbortController;this.abortControllers[d]=q;try{const a=yield this.messageHandlers[f.type](f.sourceMapId,k,q);this.completeTask(d,null,
a)}catch(a){this.completeTask(d,a)}})}completeTask(d,f,k){const q=[];delete this.abortControllers[d];d={id:d,type:"\x3cresponse\x3e",sourceMapId:this.mapId,origin:location.origin,error:f?sf(f):null,data:sf(k,q)};this.target.postMessage(d,{transfer:q})}remove(){this.invoker.remove();this.subscription.unsubscribe()}};M.$=8192;M.A=Uc;M.B=function([d,f,k]){return f+=90,f*=Math.PI/180,k*=Math.PI/180,{x:d*Math.cos(f)*Math.sin(k),y:d*Math.sin(f)*Math.sin(k),z:d*Math.cos(k)}};M.C=ig;M.D=Bc;M.E=Pk;M.F=me;
M.G=cm;M.H=Ac;M.I=Zl;M.J=Gn;M.K="global-dispatcher";M.L=function(){var d=new Uc(16);return Uc!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d};M.M=function(d,f,k){var q,a,c,e,h,l,p,w,x,y,D,H,I=k[0],L=k[1];k=k[2];return f===d?(d[12]=f[0]*I+f[4]*L+f[8]*k+f[12],d[13]=f[1]*I+f[5]*L+f[9]*k+f[13],d[14]=f[2]*I+f[6]*L+f[10]*k+f[14],d[15]=f[3]*I+f[7]*L+f[11]*k+f[15]):(a=f[1],c=f[2],e=f[3],h=f[4],l=f[5],p=f[6],w=f[7],x=
f[8],y=f[9],D=f[10],H=f[11],d[0]=q=f[0],d[1]=a,d[2]=c,d[3]=e,d[4]=h,d[5]=l,d[6]=p,d[7]=w,d[8]=x,d[9]=y,d[10]=D,d[11]=H,d[12]=q*I+h*L+x*k+f[12],d[13]=a*I+l*L+y*k+f[13],d[14]=c*I+p*L+D*k+f[14],d[15]=e*I+w*L+H*k+f[15]),d};M.N=function(d,f,k){var q=k[0],a=k[1];k=k[2];return d[0]=f[0]*q,d[1]=f[1]*q,d[2]=f[2]*q,d[3]=f[3]*q,d[4]=f[4]*a,d[5]=f[5]*a,d[6]=f[6]*a,d[7]=f[7]*a,d[8]=f[8]*k,d[9]=f[9]*k,d[10]=f[10]*k,d[11]=f[11]*k,d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15],d};M.O=function(d,f,k){var q=f[0],
a=f[1],c=f[2],e=f[3],h=f[4],l=f[5],p=f[6],w=f[7],x=f[8],y=f[9],D=f[10],H=f[11],I=f[12],L=f[13],Y=f[14];f=f[15];var P=k[0],Z=k[1],aa=k[2],T=k[3];return d[0]=P*q+Z*h+aa*x+T*I,d[1]=P*a+Z*l+aa*y+T*L,d[2]=P*c+Z*p+aa*D+T*Y,d[3]=P*e+Z*w+aa*H+T*f,d[4]=(P=k[4])*q+(Z=k[5])*h+(aa=k[6])*x+(T=k[7])*I,d[5]=P*a+Z*l+aa*y+T*L,d[6]=P*c+Z*p+aa*D+T*Y,d[7]=P*e+Z*w+aa*H+T*f,d[8]=(P=k[8])*q+(Z=k[9])*h+(aa=k[10])*x+(T=k[11])*I,d[9]=P*a+Z*l+aa*y+T*L,d[10]=P*c+Z*p+aa*D+T*Y,d[11]=P*e+Z*w+aa*H+T*f,d[12]=(P=k[12])*q+(Z=k[13])*
h+(aa=k[14])*x+(T=k[15])*I,d[13]=P*a+Z*l+aa*y+T*L,d[14]=P*c+Z*p+aa*D+T*Y,d[15]=P*e+Z*w+aa*H+T*f,d};M.P=ta;M.Q=function(d,f){const k={};for(let q=0;q<f.length;q++){const a=f[q];a in d&&(k[a]=d[a])}return k};M.R=Mg;M.S=Kc;M.T=dh;M.U=rl;M.V=Vg;M.W=Ab;M.X=$a;M.Y=od;M.Z=ac;M._=v;M.a=Ah;M.a$=tc;M.a0=function(d,f){var k,q,a,c,e;if(!d)return null!=f?f:{};if(!f)return d;let h=Object.assign({},d);if(f.removeAll&&(h={removeAll:!0}),f.remove){const l=new Set(f.remove);h.add&&(h.add=h.add.filter(w=>!l.has(w.id)));
h.update&&(h.update=h.update.filter(w=>!l.has(w.id)));const p=new Set((null!==(k=d.add)&&void 0!==k?k:[]).map(w=>w.id));f.remove=f.remove.filter(w=>!p.has(w))}f.remove&&(d=new Set(h.remove?h.remove.concat(f.remove):f.remove),h.remove=Array.from(d.values()));f.add&&(d=h.add?h.add.concat(f.add):f.add,d=new Map(d.map(l=>[l.id,l])),h.add=Array.from(d.values()));if(f.update){d=new Map(null===(q=h.update)||void 0===q?void 0:q.map(l=>[l.id,l]));for(const l of f.update)f=null!==(a=d.get(l.id))&&void 0!==
a?a:{id:l.id},l.newGeometry&&(f.newGeometry=l.newGeometry),l.addOrUpdateProperties&&(f.addOrUpdateProperties=(null!==(c=f.addOrUpdateProperties)&&void 0!==c?c:[]).concat(l.addOrUpdateProperties)),l.removeProperties&&(f.removeProperties=(null!==(e=f.removeProperties)&&void 0!==e?e:[]).concat(l.removeProperties)),l.removeAllProperties&&(f.removeAllProperties=!0),d.set(l.id,f);h.update=Array.from(d.values())}return h.remove&&h.add&&(h.remove=h.remove.filter(l=>-1===h.add.findIndex(p=>p.id===l))),h};
M.a1=gb;M.a2=Qc;M.a3=25;M.a4=Xa;M.a5=d=>{const f=window.document.createElement("video");return f.muted=!0,new Promise(k=>{f.onloadstart=()=>{k(f)};for(const q of d){const a=window.document.createElement("source");Gd(q)||(f.crossOrigin="Anonymous");a.src=q;f.appendChild(a)}})};M.a6=m;M.a7=function(){return Ak++};M.a8=Hk;M.a9=F;M.aA=function(d){let f=1/0,k=1/0,q=-1/0,a=-1/0;for(const c of d)f=Math.min(f,c.x),k=Math.min(k,c.y),q=Math.max(q,c.x),a=Math.max(a,c.y);return[f,k,q,a]};M.aB=24;M.aC=Jc;M.aD=
function(d,f,k,q,a=!1){if(!k[0]&&!k[1])return[0,0];var c=a?"map"===q?-d.bearingInRadians:0:"viewport"===q?d.bearingInRadians:0;c&&(q=Math.sin(c),c=Math.cos(c),k=[k[0]*c-k[1]*q,k[0]*q+k[1]*c]);return[a?k[0]:Jc(f,k[0],d.zoom),a?k[1]:Jc(f,k[1],d.zoom)]};M.aF=ij;M.aG=Jj;M.aH=xd;M.aI=Ln;M.aJ=ee;M.aK=ck;M.aL=kk;M.aM=Ve;M.aN=ah;M.aO=Nc;M.aP=Pc;M.aQ=ve;M.aR=yb;M.aS=Pa;M.aT=function(d){var f=new Uc(3);return f[0]=d[0],f[1]=d[1],f[2]=d[2],f};M.aU=function(d,f,k){return d[0]=f[0]-k[0],d[1]=f[1]-k[1],d[2]=f[2]-
k[2],d};M.aV=function(d,f){var k=f[0],q=f[1],a=f[2];k=k*k+q*q+a*a;return 0<k&&(k=1/Math.sqrt(k)),d[0]=f[0]*k,d[1]=f[1]*k,d[2]=f[2]*k,d};M.aW=Ib;M.aX=function(d,f){return d[0]*f[0]+d[1]*f[1]+d[2]*f[2]};M.aY=function(d,f,k){return d[0]=f[0]*k[0],d[1]=f[1]*k[1],d[2]=f[2]*k[2],d[3]=f[3]*k[3],d};M.aZ=tc;M.a_=function(d,f,k){f=f[0]*k[0]+f[1]*k[1]+f[2]*k[2];return 0===f?null:(-(d[0]*k[0]+d[1]*k[1]+d[2]*k[2])-k[3])/f};M.aa=$c;M.ab=dg;M.ac=hd;M.ad=function(d){const f={};if(d.replace(/(?:^|(?:\s*,\s*))([^\x00-\x20\(\)<>@,;:\\"\/\[\]\?=\{\}\x7F]+)(?:=(?:([^\x00-\x20\(\)<>@,;:\\"\/\[\]\?=\{\}\x7F]+)|(?:"((?:[^"\\]|\\.)*)")))?/g,
(k,q,a,c)=>{k=a||c;return f[q]=!k||k.toLowerCase(),""}),f["max-age"])d=parseInt(f["max-age"],10),isNaN(d)?delete f["max-age"]:f["max-age"]=d;return f};M.ae=yc;M.af=function(d){return Math.pow(2,d)};M.ag=na;M.ah=xc;M.ai=85.051129;M.aj=function(d,f){return d/(Te*Math.cos(f*Math.PI/180))};M.ak=function(d){return Math.log(d)/Math.LN2};M.al=function(d){var f=d[0];d=d[1];return f*f+d*d};M.am=function(d){if(!d.length)return new Set;var f=Math.max(...d.map(l=>l.canonical.z));let k=1/0,q=-1/0,a=1/0,c=-1/0;
const e=[];for(const l of d){const {x:p,y:w,z:x}=l.canonical;var h=Math.pow(2,f-x);d=p*h;h*=w;e.push({id:l,x:d,y:h});d<k&&(k=d);d>q&&(q=d);h<a&&(a=h);h>c&&(c=h)}f=new Set;for(const l of e)l.x!==k&&l.x!==q&&l.y!==a&&l.y!==c||f.add(l.id);return f};M.an=function(d,f){let k=0,q=0;if("constant"===d.kind)q=d.layoutSize;else if("source"!==d.kind){const {interpolationType:a,minZoom:c,maxZoom:e}=d;f=a?xc(lg.interpolationFactor(a,f,c,e),0,1):0;"camera"===d.kind?q=ig.number(d.minSize,d.maxSize,f):k=f}return{uSizeT:k,
uSize:q}};M.ap=function(d,{uSize:f,uSizeT:k},{lowerSize:q,upperSize:a}){return"source"===d.kind?q/128:"composite"===d.kind?ig.number(q/128,a/128,k):f};M.aq=function(d,f){var k=f[0],q=f[1],a=f[2],c=f[3],e=f[4],h=f[5],l=f[6],p=f[7],w=f[8],x=f[9],y=f[10],D=f[11],H=f[12],I=f[13],L=f[14];f=f[15];var Y=k*h-q*e,P=k*l-a*e,Z=k*p-c*e,aa=q*l-a*h,T=q*p-c*h,ha=a*p-c*l,Ca=w*I-x*H,xa=w*L-y*H,Ha=w*f-D*H,Fa=x*L-y*I,Ra=x*f-D*I,Ja=y*f-D*L,Ka=Y*Ja-P*Ra+Z*Fa+aa*Ha-T*xa+ha*Ca;return Ka?(d[0]=(h*Ja-l*Ra+p*Fa)*(Ka=1/Ka),
d[1]=(a*Ra-q*Ja-c*Fa)*Ka,d[2]=(I*ha-L*T+f*aa)*Ka,d[3]=(y*T-x*ha-D*aa)*Ka,d[4]=(l*Ha-e*Ja-p*xa)*Ka,d[5]=(k*Ja-a*Ha+c*xa)*Ka,d[6]=(L*Z-H*ha-f*P)*Ka,d[7]=(w*ha-y*Z+D*P)*Ka,d[8]=(e*Ra-h*Ha+p*Ca)*Ka,d[9]=(q*Ha-k*Ra-c*Ca)*Ka,d[10]=(H*T-I*Z+f*Y)*Ka,d[11]=(x*Z-w*T-D*Y)*Ka,d[12]=(h*xa-e*Fa-l*Ca)*Ka,d[13]=(k*Fa-q*xa+a*Ca)*Ka,d[14]=(I*P-H*aa-L*Y)*Ka,d[15]=(w*aa-x*P+y*Y)*Ka,d):null};M.ar=bc;M.as=function(d){var f=d[0];d=d[1];return Math.sqrt(f*f+d*d)};M.at=function(d){return d[0]=0,d[1]=0,d};M.au=function(d,
f,k){return d[0]=f[0]*k,d[1]=f[1]*k,d};M.av=Mc;M.aw=Fb;M.ax=function(d,f,k,q){const a=f.y-d.y;f=f.x-d.x;const c=q.y-k.y;q=q.x-k.x;const e=c*f-q*a;if(0===e)return null;k=(q*(d.y-k.y)-c*(d.x-k.x))/e;return new ta(d.x+k*f,d.y+k*a)};M.ay=Ri;M.az=tf;M.b=Tc;M.b$=class extends ki{constructor(d,f){super(d,f);this.current=[]}set(d){d!=this.current&&(this.current=d,d=new Float32Array(d),this.gl.uniform1fv(this.location,d))}};M.b0=function(d,f,k){return d[0]=f[0]*k,d[1]=f[1]*k,d[2]=f[2]*k,d[3]=f[3]*k,d};M.b1=
function(d,f){return d[0]*f[0]+d[1]*f[1]+d[2]*f[2]+d[3]};M.b2=nb;M.b3=Xd;M.b4=function(d,f,k,q,a){f=1/Math.tan(f/2);(d[0]=f/k,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=f,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,null!=a&&a!==1/0)?(k=1/(q-a),d[10]=(a+q)*k,d[14]=2*a*q*k):(d[10]=-1,d[14]=-2*q);return d};M.b5=function(d){var f=new Uc(16);return f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],f[4]=d[4],f[5]=d[5],f[6]=d[6],f[7]=d[7],f[8]=d[8],f[9]=d[9],f[10]=d[10],f[11]=d[11],f[12]=d[12],f[13]=d[13],
f[14]=d[14],f[15]=d[15],f};M.b6=function(d,f,k){var q=Math.sin(k);k=Math.cos(k);var a=f[0],c=f[1],e=f[2],h=f[3],l=f[4],p=f[5],w=f[6],x=f[7];return f!==d&&(d[8]=f[8],d[9]=f[9],d[10]=f[10],d[11]=f[11],d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15]),d[0]=a*k+l*q,d[1]=c*k+p*q,d[2]=e*k+w*q,d[3]=h*k+x*q,d[4]=l*k-a*q,d[5]=p*k-c*q,d[6]=w*k-e*q,d[7]=x*k-h*q,d};M.b7=function(d,f,k){var q=Math.sin(k);k=Math.cos(k);var a=f[4],c=f[5],e=f[6],h=f[7],l=f[8],p=f[9],w=f[10],x=f[11];return f!==d&&(d[0]=f[0],d[1]=f[1],
d[2]=f[2],d[3]=f[3],d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15]),d[4]=a*k+l*q,d[5]=c*k+p*q,d[6]=e*k+w*q,d[7]=h*k+x*q,d[8]=l*k-a*q,d[9]=p*k-c*q,d[10]=w*k-e*q,d[11]=x*k-h*q,d};M.b8=function(){const d=new Float32Array(16);return na(d),d};M.b9=function(){const d=new Float64Array(16);return na(d),d};M.bA=function(d,f){d=id(d,360);const k=id(f,360);f=k-d;d=k>d?f-360:f+360;return Math.abs(f)<Math.abs(d)?f:d};M.bB=function(d){return d[0]=0,d[1]=0,d[2]=0,d};M.bC=function(d,f,k,q){var a=Math.sqrt(d*d+f*
f);const c=Math.sqrt(k*k+q*q);d/=a;f/=a;k/=c;q/=c;a=Math.acos(d*k+f*q);return 0<-f*k+d*q?a:-a};M.bD=function(d,f){d=id(d,2*Math.PI);f=id(f,2*Math.PI);return Math.min(Math.abs(d-f),Math.abs(d-f+2*Math.PI),Math.abs(d-f-2*Math.PI))};M.bE=function(){const d={},f=b.$version;for(const q in b.$root){var k=b.$root[q];k.required&&(k="version"===q?f:"array"===k.type?[]:{},null!=k&&(d[q]=k))}return d};M.bF=wm;M.bG=Ok;M.bH=function q(f,k){if(Array.isArray(f)){if(!Array.isArray(k)||f.length!==k.length)return!1;
for(var a=0;a<f.length;a++)if(!q(f[a],k[a]))return!1;return!0}if("object"==typeof f&&null!==f&&null!==k){if("object"!=typeof k||Object.keys(f).length!==Object.keys(k).length)return!1;for(a in f)if(!q(f[a],k[a]))return!1;return!0}return f===k};M.bI=function(f){f=f.slice();const k=Object.create(null);for(var q=0;q<f.length;q++)k[f[q].id]=f[q];for(q=0;q<f.length;q++)"ref"in f[q]&&(f[q]=gf(f[q],k[f[q].ref]));return f};M.bJ=function(f,k){if("custom"===f.type)return new Pb(f,k);switch(f.type){case "background":return new gc(f,
k);case "circle":return new cg(f,k);case "color-relief":return new rn(f,k);case "fill":return new Qi(f,k);case "fill-extrusion":return new bf(f,k);case "heatmap":return new nn(f,k);case "hillshade":return new Ll(f,k);case "line":return new Km(f,k);case "raster":return new ln(f,k);case "symbol":return new Ta(f,k)}};M.bK=f=>"raster"===f.type;M.bL=Kb;M.bM=function(f,k){if(!f)return[{command:"setStyle",args:[k]}];let q=[];try{if(!da(f.version,k.version))return[{command:"setStyle",args:[k]}];da(f.center,
k.center)||q.push({command:"setCenter",args:[k.center]});da(f.state,k.state)||q.push({command:"setGlobalState",args:[k.state]});da(f.centerAltitude,k.centerAltitude)||q.push({command:"setCenterAltitude",args:[k.centerAltitude]});da(f.zoom,k.zoom)||q.push({command:"setZoom",args:[k.zoom]});da(f.bearing,k.bearing)||q.push({command:"setBearing",args:[k.bearing]});da(f.pitch,k.pitch)||q.push({command:"setPitch",args:[k.pitch]});da(f.roll,k.roll)||q.push({command:"setRoll",args:[k.roll]});da(f.sprite,
k.sprite)||q.push({command:"setSprite",args:[k.sprite]});da(f.glyphs,k.glyphs)||q.push({command:"setGlyphs",args:[k.glyphs]});da(f.transition,k.transition)||q.push({command:"setTransition",args:[k.transition]});da(f.light,k.light)||q.push({command:"setLight",args:[k.light]});da(f.terrain,k.terrain)||q.push({command:"setTerrain",args:[k.terrain]});da(f.sky,k.sky)||q.push({command:"setSky",args:[k.sky]});da(f.projection,k.projection)||q.push({command:"setProjection",args:[k.projection]});const a={},
c=[];!function(h,l,p,w){let x;for(x in l=l||{},h=h||{})Object.prototype.hasOwnProperty.call(h,x)&&(Object.prototype.hasOwnProperty.call(l,x)||O(x,p,w));for(x in l)if(Object.prototype.hasOwnProperty.call(l,x))if(Object.prototype.hasOwnProperty.call(h,x)){if(!da(h[x],l[x])){var y;if(y="geojson"===h[x].type&&"geojson"===l[x].type)a:{let I=void 0;y=h;var D=l,H=x;for(I in y[H])if(Object.prototype.hasOwnProperty.call(y[H],I)&&"data"!==I&&!da(y[H][I],D[H][I])){y=!1;break a}for(I in D[H])if(Object.prototype.hasOwnProperty.call(D[H],
I)&&"data"!==I&&!da(y[H][I],D[H][I])){y=!1;break a}y=!0}y?p.push({command:"setGeoJSONSourceData",args:[x,l[x].data]}):(y=x,D=l,H=p,O(y,H,w),H.push({command:"addSource",args:[y,D[y]]}))}}else p.push({command:"addSource",args:[x,l[x]]})}(f.sources,k.sources,c,a);const e=[];f.layers&&f.layers.forEach(h=>{"source"in h&&a[h.source]?q.push({command:"removeLayer",args:[h.id]}):e.push(h)});q=q.concat(c);(function(h,l,p){l=l||[];var w=(h=h||[]).map(S);const x=l.map(S);h=h.reduce(fa,{});l=l.reduce(fa,{});const y=
w.slice(),D=Object.create(null);let H,I,L,Y;for(let P=0,Z=0;P<w.length;P++)H=w[P],Object.prototype.hasOwnProperty.call(l,H)?Z++:(p.push({command:"removeLayer",args:[H]}),y.splice(y.indexOf(H,Z),1));for(let P=0,Z=0;P<x.length;P++)H=x[x.length-1-P],y[y.length-1-P]!==H&&(Object.prototype.hasOwnProperty.call(h,H)?(p.push({command:"removeLayer",args:[H]}),y.splice(y.lastIndexOf(H,y.length-Z),1)):Z++,w=y[y.length-P],p.push({command:"addLayer",args:[l[H],w]}),y.splice(y.length-P,0,H),D[H]=!0);for(let P=
0;P<x.length;P++)if(H=x[P],I=h[H],L=l[H],!D[H]&&!da(I,L))if(da(I.source,L.source)&&da(I["source-layer"],L["source-layer"])&&da(I.type,L.type)){for(Y in W(I.layout,L.layout,p,H,null,"setLayoutProperty"),W(I.paint,L.paint,p,H,null,"setPaintProperty"),da(I.filter,L.filter)||J(p,{command:"setFilter",args:[H,L.filter]}),da(I.minzoom,L.minzoom)&&da(I.maxzoom,L.maxzoom)||J(p,{command:"setLayerZoomRange",args:[H,L.minzoom,L.maxzoom]}),I)Object.prototype.hasOwnProperty.call(I,Y)&&"layout"!==Y&&"paint"!==Y&&
"filter"!==Y&&"metadata"!==Y&&"minzoom"!==Y&&"maxzoom"!==Y&&(0===Y.indexOf("paint.")?W(I[Y],L[Y],p,H,Y.slice(6),"setPaintProperty"):da(I[Y],L[Y])||p.push({command:"setLayerProperty",args:[H,Y,L[Y]]}));for(Y in L)Object.prototype.hasOwnProperty.call(L,Y)&&!Object.prototype.hasOwnProperty.call(I,Y)&&"layout"!==Y&&"paint"!==Y&&"filter"!==Y&&"metadata"!==Y&&"minzoom"!==Y&&"maxzoom"!==Y&&(0===Y.indexOf("paint.")?W(I[Y],L[Y],p,H,Y.slice(6),"setPaintProperty"):da(I[Y],L[Y])||p.push({command:"setLayerProperty",
args:[H,Y,L[Y]]}))}else p.push({command:"removeLayer",args:[H]}),w=y[y.lastIndexOf(H)+1],p.push({command:"addLayer",args:[L,w]})})(e,k.layers,q)}catch(a){console.warn("Unable to compute style diff:",a),q=[{command:"setStyle",args:[k]}]}return q};M.bN=function(f){const k=[],q=f.id;return void 0===q&&k.push({message:`layers.${q}: missing required property "id"`}),void 0===f.render&&k.push({message:`layers.${q}: missing required method "render"`}),f.renderingMode&&"2d"!==f.renderingMode&&"3d"!==f.renderingMode&&
k.push({message:`layers.${q}: property "renderingMode" must be either "2d" or "3d"`}),k};M.bO=Ic;M.bP=Rc;M.bQ=class extends ki{constructor(f,k){super(f,k);this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}};M.bR=ej;M.bS=class extends ki{constructor(f,k){super(f,k);this.current=xj}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let k=1;16>k;k++)if(f[k]!==this.current[k]){this.current=
f;this.gl.uniformMatrix4fv(this.location,!1,f);break}}};M.bT=nl;M.bU=class extends ki{constructor(f,k){super(f,k);this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}};M.bV=class extends ki{constructor(f,k){super(f,k);this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}};M.bW=Sb;M.bX=function(f,k){var q=Math.sin(k);
k=Math.cos(k);return f[0]=k,f[1]=q,f[2]=0,f[3]=-q,f[4]=k,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f};M.bY=function(f,k,q){var a=k[0],c=k[1];k=k[2];return f[0]=a*q[0]+c*q[3]+k*q[6],f[1]=a*q[1]+c*q[4]+k*q[7],f[2]=a*q[2]+c*q[5]+k*q[8],f};M.bZ=function(f,k,q,a,c,e,h){var l=1/(k-q),p=1/(a-c),w=1/(e-h);return f[0]=-2*l,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*p,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*w,f[11]=0,f[12]=(k+q)*l,f[13]=(c+a)*p,f[14]=(h+e)*w,f[15]=1,f};M.b_=class extends ki{constructor(f,k){super(f,k);this.current=
[]}set(f){if(f!=this.current){this.current=f;const k=new Float32Array(4*f.length);for(let q=0;q<f.length;q++)k[4*q]=f[q].r,k[4*q+1]=f[q].g,k[4*q+2]=f[q].b,k[4*q+3]=f[q].a;this.gl.uniform4fv(this.location,k)}}};M.ba=function(){return new Float64Array(16)};M.bb=function(f,k,q){const a=new Float64Array(4);return lc(a,f,k-90,q),a};M.bc=function(f,k,q,a){var c,e,h,l,p,w=k[0],x=k[1],y=k[2];k=k[3];var D=q[0],H=q[1],I=q[2];q=q[3];return 0>(e=w*D+x*H+y*I+k*q)&&(e=-e,D=-D,H=-H,I=-I,q=-q),1E-6<1-e?(c=Math.acos(e),
h=Math.sin(c),l=Math.sin((1-a)*c)/h,p=Math.sin(a*c)/h):(l=1-a,p=a),f[0]=l*w+p*D,f[1]=l*x+p*H,f[2]=l*y+p*I,f[3]=l*k+p*q,f};M.bd=function(f){const k=new Float64Array(9);var q,a,c,e,h;var l=(q=f[0])*(e=q+q);var p=(a=f[1])*e;var w=(q=f[2])*e;var x=q*(h=a+a);f=(c=f[3])*e;e=c*h;var y=c*(c=q+q);k[0]=1-(a*=h)-(h=q*c);k[3]=p-y;k[6]=w+e;k[1]=p+y;k[4]=1-l-h;k[7]=x-f;k[2]=w-e;k[5]=x+f;k[8]=1-l-a;l=Pc(-Math.asin(xc(k[2],-1,1)));let D,H;return.001>Math.hypot(k[5],k[8])?(D=0,H=-Pc(Math.atan2(k[3],k[4]))):(D=Pc(0===
k[5]&&0===k[8]?0:Math.atan2(k[5],k[8])),H=Pc(0===k[1]&&0===k[0]?0:Math.atan2(k[1],k[0]))),{roll:D,pitch:l+90,bearing:H}};M.be=function(f,k){return f.roll==k.roll&&f.pitch==k.pitch&&f.bearing==k.bearing};M.bf=Bb;M.bg=Bj;M.bh=-32768;M.bi=32767;M.bj=pl;M.bk=sd;M.bl=Dc;M.bm=ie;M.bn=function(f,k,q,a,c){return sd(a,c,xc((f-k)/(q-k),0,1))};M.bo=id;M.bp=function(){return new Float64Array(3)};M.bq=function(f,k,q,a){return f[0]=k[0]+q[0]*a,f[1]=k[1]+q[1]*a,f[2]=k[2]+q[2]*a,f};M.br=lc;M.bs=function(f,k,q){var a=
q[0],c=q[1],e=q[2];q=q[3];var h=k[0],l=k[1];k=k[2];var p=c*k-e*l,w=e*h-a*k,x=a*l-c*h;return f[0]=h+q*(p+=p)+c*(x+=x)-e*(w+=w),f[1]=l+q*w+e*p-a*x,f[2]=k+q*x+a*w-c*p,f};M.bt=function(f,k,q){const a=(c=[f[0],f[1],f[2],k[0],k[1],k[2],q[0],q[1],q[2]])[0]*((x=c[8])*(h=c[4])-(l=c[5])*(w=c[7]))+c[1]*(-x*(e=c[3])+l*(p=c[6]))+c[2]*(w*e-h*p);var c,e,h,l,p,w,x;if(0===a)return null;h=Ib([],[k[0],k[1],k[2]],[q[0],q[1],q[2]]);c=Ib([],[q[0],q[1],q[2]],[f[0],f[1],f[2]]);e=Ib([],[f[0],f[1],f[2]],[k[0],k[1],k[2]]);
f=yb([],h,-f[3]);return Pa(f,f,yb([],c,-k[3])),Pa(f,f,yb([],e,-q[3])),yb(f,f,1/a),f};M.bu=6371008.8;M.bv=function(){return new Float64Array(4)};M.bw=function(f,k,q,a){var c=[],e=[];return c[0]=k[0]-q[0],c[1]=k[1]-q[1],c[2]=k[2]-q[2],e[0]=c[0]*Math.cos(a)-c[1]*Math.sin(a),e[1]=c[0]*Math.sin(a)+c[1]*Math.cos(a),e[2]=c[2],f[0]=e[0]+q[0],f[1]=e[1]+q[1],f[2]=e[2]+q[2],f};M.bx=function(f,k,q,a){var c=[],e=[];return c[0]=k[0]-q[0],c[1]=k[1]-q[1],c[2]=k[2]-q[2],e[0]=c[0],e[1]=c[1]*Math.cos(a)-c[2]*Math.sin(a),
e[2]=c[1]*Math.sin(a)+c[2]*Math.cos(a),f[0]=e[0]+q[0],f[1]=e[1]+q[1],f[2]=e[2]+q[2],f};M.by=function(f,k,q,a){var c=[],e=[];return c[0]=k[0]-q[0],c[1]=k[1]-q[1],c[2]=k[2]-q[2],e[0]=c[2]*Math.sin(a)+c[0]*Math.cos(a),e[1]=c[1],e[2]=c[2]*Math.cos(a)-c[0]*Math.sin(a),f[0]=e[0]+q[0],f[1]=e[1]+q[1],f[2]=e[2]+q[2],f};M.bz=function(f,k,q){var a=Math.sin(q);q=Math.cos(q);var c=k[0],e=k[1],h=k[2],l=k[3],p=k[8],w=k[9],x=k[10],y=k[11];return k!==f&&(f[4]=k[4],f[5]=k[5],f[6]=k[6],f[7]=k[7],f[12]=k[12],f[13]=k[13],
f[14]=k[14],f[15]=k[15]),f[0]=c*q-p*a,f[1]=e*q-w*a,f[2]=h*q-x*a,f[3]=l*q-y*a,f[8]=c*a+p*q,f[9]=e*a+w*q,f[10]=h*a+x*q,f[11]=l*a+y*q,f};M.c=td;M.c0=class extends bl{};M.c1=Gm;M.c2=class extends dl{};M.c3="big-fb";M.c4=function(f){return 1>=f?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))};M.c5=zj;M.c6=function(f,k,q){var a=k[0],c=k[1];k=k[2];var e=q[3]*a+q[7]*c+q[11]*k+q[15];return f[0]=(q[0]*a+q[4]*c+q[8]*k+q[12])/(e=e||1),f[1]=(q[1]*a+q[5]*c+q[9]*k+q[13])/e,f[2]=(q[2]*a+q[6]*c+q[10]*k+q[14])/e,f};
M.c7=class extends fl{};const Rn=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()};performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return 0===f.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),
performance.clearMeasures(this._marks.measure)),f}};M.c8=class extends jk{};M.c9=function(f,k){return f[0]===k[0]&&f[1]===k[1]&&f[2]===k[2]&&f[3]===k[3]&&f[4]===k[4]&&f[5]===k[5]&&f[6]===k[6]&&f[7]===k[7]&&f[8]===k[8]&&f[9]===k[9]&&f[10]===k[10]&&f[11]===k[11]&&f[12]===k[12]&&f[13]===k[13]&&f[14]===k[14]&&f[15]===k[15]};M.cA=function(f,k){Ah.REGISTERED_PROTOCOLS[f]=k};M.cB=function(f){delete Ah.REGISTERED_PROTOCOLS[f]};M.cC=function(f,k){const q={};for(let e=0;e<f.length;e++){var a;if(!(a=k&&k[f[e].id])){a=
f[e];var c="";for(const h of g)c+=`/${di(a[h])}`;a=c}k&&(k[f[e].id]=a);(c=q[a])||(c=q[a]=[]);c.push(f[e])}f=[];for(const e in q)f.push(q[e]);return f};M.cD=Cb;M.cE=jd;M.cF=rd;M.cG=kn;M.cH=function(f){f.bucket.createArrays();f.bucket.tilePixelRatio=8192/(512*f.bucket.overscaling);f.bucket.compareText={};f.bucket.iconsNeedLinear=!1;const k=f.bucket.layers[0],q=k.layout;var a=k._unevaluatedLayout._values;const c={layoutIconSize:a["icon-size"].possiblyEvaluate(new me(f.bucket.zoom+1),f.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new me(f.bucket.zoom+
1),f.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new me(18))};if("composite"===f.bucket.textSizeData.kind){const {minZoom:D,maxZoom:H}=f.bucket.textSizeData;c.compositeTextSizes=[a["text-size"].possiblyEvaluate(new me(D),f.canonical),a["text-size"].possiblyEvaluate(new me(H),f.canonical)]}if("composite"===f.bucket.iconSizeData.kind){const {minZoom:D,maxZoom:H}=f.bucket.iconSizeData;c.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new me(D),f.canonical),a["icon-size"].possiblyEvaluate(new me(H),
f.canonical)]}const e=24*q.get("text-line-height");a="viewport"!==q.get("text-rotation-alignment")&&"point"!==q.get("symbol-placement");const h=q.get("text-keep-upright"),l=q.get("text-size");for(const D of f.bucket.features){const H=q.get("text-font").evaluate(D,{},f.canonical).join(","),I=l.evaluate(D,{},f.canonical),L=c.layoutTextSize.evaluate(D,{},f.canonical),Y=c.layoutIconSize.evaluate(D,{},f.canonical),P={horizontal:{},vertical:void 0},Z=D.text;let aa,T=[0,0];if(Z){const ha=Z.toString();var p=
24*q.get("text-letter-spacing").evaluate(D,{},f.canonical);const Ca=yd(ha)?p:0,xa=q.get("text-anchor").evaluate(D,{},f.canonical);var w=ih(k,D,f.canonical);w||(T=(p=q.get("text-radial-offset").evaluate(D,{},f.canonical))?Lk(xa,[24*p,En]):q.get("text-offset").evaluate(D,{},f.canonical).map(Fa=>24*Fa));var x=a?"center":q.get("text-justify").evaluate(D,{},f.canonical);const Ha="point"===q.get("symbol-placement")?24*q.get("text-max-width").evaluate(D,{},f.canonical):1/0;p=()=>{f.bucket.allowVerticalPlacement&&
Ld(ha)&&(P.vertical=ab(Z,f.glyphMap,f.glyphPositions,f.imagePositions,H,Ha,e,xa,"left",Ca,T,M.ao.vertical,!0,L,I))};if(!a&&w){var y=new Set;if("auto"===x)for(x=0;x<w.values.length;x+=2)y.add(Jj(w.values[x]));else y.add(x);w=!1;for(const Fa of y)P.horizontal[Fa]||(w?P.horizontal[Fa]=P.horizontal[0]:(y=ab(Z,f.glyphMap,f.glyphPositions,f.imagePositions,H,Ha,e,"center",Fa,Ca,T,M.ao.horizontal,!1,L,I))&&(P.horizontal[Fa]=y,w=1===y.positionedLines.length));p()}else"auto"===x&&(x=Jj(xa)),(w=ab(Z,f.glyphMap,
f.glyphPositions,f.imagePositions,H,Ha,e,xa,x,Ca,T,M.ao.horizontal,!1,L,I))&&(P.horizontal[x]=w),p(),Ld(ha)&&a&&h&&(P.vertical=ab(Z,f.glyphMap,f.glyphPositions,f.imagePositions,H,Ha,e,xa,x,Ca,T,M.ao.vertical,!1,L,I))}p=!1;D.icon&&D.icon.name&&(w=f.imageMap[D.icon.name])&&(aa=If(f.imagePositions[D.icon.name],q.get("icon-offset").evaluate(D,{},f.canonical),q.get("icon-anchor").evaluate(D,{},f.canonical)),p=!!w.sdf,void 0===f.bucket.sdfIcons?f.bucket.sdfIcons=p:f.bucket.sdfIcons!==p&&Ma("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),
(w.pixelRatio!==f.bucket.pixelRatio||0!==q.get("icon-rotate").constantOr(1))&&(f.bucket.iconsNeedLinear=!0));w=li(P.horizontal)||P.vertical;f.bucket.iconsInText=!!w&&w.iconsInText;(w||aa)&&Wg(f.bucket,D,P,aa,f.imageMap,c,L,Y,T,p,f.canonical,f.subdivisionGranularity)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()};M.cI=Fm;M.cJ=df;M.cK=Ml;M.cL=Pf;M.cM=Rm;M.cN=Rn;M.cO=function(f,k,q,a,c){return v(this,void 0,void 0,function*(){if($a())try{return yield od(f,k,q,a,c)}catch(p){}const e=
f.width,h=f.height;Th&&Lj||(Th=new OffscreenCanvas(e,h),Lj=Th.getContext("2d",{willReadFrequently:!0}));Th.width=e;Th.height=h;Lj.drawImage(f,0,0,e,h);const l=Lj.getImageData(k,q,a,c);return Lj.clearRect(0,0,e,h),l.data})};M.cP=pm;M.cQ=Va;M.cR=$d;M.cS=hg;M.cT=qg;M.cU=function(f,k){const q=new Map;if(null!=f)if("Feature"===f.type)q.set(k?f.properties[k]:f.id,f);else for(const a of f.features)q.set(k?a.properties[k]:a.id,a);return q};M.cV=function(f,k){if(null==f)return!0;if("Feature"===f.type)return null!=
(k?f.properties[k]:f.id);if("FeatureCollection"===f.type){const q=new Set;for(const a of f.features){f=k?a.properties[k]:a.id;if(null==f||q.has(f))return!1;q.add(f)}return!0}return!1};M.cW=function(f,k,q){var a,c,e,h;if(k.removeAll&&f.clear(),k.remove)for(var l of k.remove)f.delete(l);if(k.add)for(const p of k.add)l=q?p.properties[q]:p.id,null!=l&&f.set(l,p);if(k.update)for(const p of k.update)if(k=f.get(p.id),null!=k){q=!p.removeAllProperties&&(0<(null===(a=p.removeProperties)||void 0===a?void 0:
a.length)||0<(null===(c=p.addOrUpdateProperties)||void 0===c?void 0:c.length));if((p.newGeometry||p.removeAllProperties||q)&&(k=Object.assign({},k),f.set(p.id,k),q&&(k.properties=Object.assign({},k.properties))),p.newGeometry&&(k.geometry=p.newGeometry),p.removeAllProperties)k.properties={};else if(0<(null===(e=p.removeProperties)||void 0===e?void 0:e.length))for(const w of p.removeProperties)Object.prototype.hasOwnProperty.call(k.properties,w)&&delete k.properties[w];if(0<(null===(h=p.addOrUpdateProperties)||
void 0===h?void 0:h.length))for(const {key:w,value:x}of p.addOrUpdateProperties)k.properties[w]=x}};M.cX=yi;M.ca=function(f,k){var q=f[0],a=f[1],c=f[2],e=f[3],h=f[4],l=f[5],p=f[6],w=f[7],x=f[8],y=f[9],D=f[10],H=f[11],I=f[12],L=f[13],Y=f[14];f=f[15];var P=k[0],Z=k[1],aa=k[2],T=k[3],ha=k[4],Ca=k[5],xa=k[6],Ha=k[7],Fa=k[8],Ra=k[9],Ja=k[10],Ka=k[11],lb=k[12],wb=k[13],Mb=k[14];k=k[15];return Math.abs(q-P)<=1E-6*Math.max(1,Math.abs(q),Math.abs(P))&&Math.abs(a-Z)<=1E-6*Math.max(1,Math.abs(a),Math.abs(Z))&&
Math.abs(c-aa)<=1E-6*Math.max(1,Math.abs(c),Math.abs(aa))&&Math.abs(e-T)<=1E-6*Math.max(1,Math.abs(e),Math.abs(T))&&Math.abs(h-ha)<=1E-6*Math.max(1,Math.abs(h),Math.abs(ha))&&Math.abs(l-Ca)<=1E-6*Math.max(1,Math.abs(l),Math.abs(Ca))&&Math.abs(p-xa)<=1E-6*Math.max(1,Math.abs(p),Math.abs(xa))&&Math.abs(w-Ha)<=1E-6*Math.max(1,Math.abs(w),Math.abs(Ha))&&Math.abs(x-Fa)<=1E-6*Math.max(1,Math.abs(x),Math.abs(Fa))&&Math.abs(y-Ra)<=1E-6*Math.max(1,Math.abs(y),Math.abs(Ra))&&Math.abs(D-Ja)<=1E-6*Math.max(1,
Math.abs(D),Math.abs(Ja))&&Math.abs(H-Ka)<=1E-6*Math.max(1,Math.abs(H),Math.abs(Ka))&&Math.abs(I-lb)<=1E-6*Math.max(1,Math.abs(I),Math.abs(lb))&&Math.abs(L-wb)<=1E-6*Math.max(1,Math.abs(L),Math.abs(wb))&&Math.abs(Y-Mb)<=1E-6*Math.max(1,Math.abs(Y),Math.abs(Mb))&&Math.abs(f-k)<=1E-6*Math.max(1,Math.abs(f),Math.abs(k))};M.cb=function(f,k){return f[0]=k[0],f[1]=k[1],f[2]=k[2],f[3]=k[3],f[4]=k[4],f[5]=k[5],f[6]=k[6],f[7]=k[7],f[8]=k[8],f[9]=k[9],f[10]=k[10],f[11]=k[11],f[12]=k[12],f[13]=k[13],f[14]=k[14],
f[15]=k[15],f};M.cc=f=>"symbol"===f.type;M.cd=f=>"circle"===f.type;M.ce=f=>"heatmap"===f.type;M.cf=f=>"line"===f.type;M.cg=f=>"fill"===f.type;M.ch=f=>"fill-extrusion"===f.type;M.ci=f=>"hillshade"===f.type;M.cj=f=>"color-relief"===f.type;M.ck=f=>"background"===f.type;M.cl=f=>"custom"===f.type;M.cm=dc;M.cn=function(f,k,q){k=Hc(k.x-q.x,k.y-q.y);f=Hc(f.x-q.x,f.y-q.y);return Pc(Math.atan2(k[0]*f[1]-k[1]*f[0],k[0]*f[0]+k[1]*f[1]))};M.co=Rg;M.cp=function(f,k){return gk[k]&&(f instanceof MouseEvent||f instanceof
WheelEvent)};M.cq=function(f,k){return tl[k]&&"touches"in f};M.cr=function(f){return tl[f]||gk[f]};M.cs=function(f,k,q){var a=k[0];k=k[1];return f[0]=q[0]*a+q[4]*k+q[12],f[1]=q[1]*a+q[5]*k+q[13],f};M.ct=function(f,k){const {x:q,y:a}=gb.fromLngLat(k);return!(0>f||25<f||0>a||1<=a||0>q||1<=q)};M.cu=function(f,k){return f[0]=k[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=k[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=k[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f};M.cv=class extends ng{};M.cw={mark(f){performance.mark(f)},
frame(f){null!=An&&Pm.push(f-An);An=f},clearMetrics(){An=null;Pm=[];performance.clearMeasures("loadTime");performance.clearMeasures("fullLoadTime");for(const f in M.cx)performance.clearMarks(M.cx[f])},getPerformanceMetrics(){performance.measure("loadTime",M.cx.create,M.cx.load);performance.measure("fullLoadTime",M.cx.create,M.cx.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,k=performance.getEntriesByName("fullLoadTime")[0].duration,q=Pm.length,a=1/(Pm.reduce((e,h)=>e+h,0)/
q/1E3),c=Pm.filter(e=>e>Qm).reduce((e,h)=>e+(h-Qm)/Qm,0);return{loadTime:f,fullLoadTime:k,fps:a,percentDroppedFrames:c/(q+c)*100,totalFrames:q}}};M.cy=function(f){return"AbortError"===f.message};M.cz=Si;M.d=Gd;M.e=pd;M.f=f=>v(void 0,void 0,void 0,function*(){if(0===f.byteLength)return createImageBitmap(new ImageData(1,1));const k=new Blob([new Uint8Array(f)],{type:"image/png"});try{return createImageBitmap(k)}catch(q){throw Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`);
}});M.g=Cd;M.h=f=>new Promise((k,q)=>{const a=new Image;a.onload=()=>{k(a);URL.revokeObjectURL(a.src);a.onload=null;window.requestAnimationFrame(()=>{a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII\x3d"})};a.onerror=()=>q(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const c=new Blob([new Uint8Array(f)],{type:"image/png"});a.src=f.byteLength?
URL.createObjectURL(c):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII\x3d"});M.i=sc;M.j=(f,k)=>hk(pd(f,{type:"json"}),k);M.k=Ti;M.l=mj;M.m=hk;M.n=(f,k)=>hk(pd(f,{type:"arrayBuffer"}),k);M.o=function(f){return(new Rm(f)).readFields(ia,[])};M.p=Sa;M.q=Xl;M.r=Ef;M.s=Vc;M.t=Ul;M.u=gd;M.v=b;M.w=Ma;M.x=Tl;M.y=Eb;M.z=kf});Na("worker",["./shared"],function(M){function v(da,J,O){J=new M.F(J);for(const W of da)W.recalculate(J,O)}function ta(da,
J){J.writeVarintField(15,da.version||1);J.writeStringField(1,da.name||"");J.writeVarintField(5,da.extent||4096);var O={keys:[],values:[],keycache:{},valuecache:{}};for(let W=0;W<da.length;W++)O.feature=da.feature(W),J.writeMessage(2,Va,O);da=O.keys;for(const W of da)J.writeStringField(3,W);O=O.values;for(const W of O)J.writeMessage(4,Sb,W)}function Va(da,J){if(da.feature){var O=da.feature;void 0!==O.id&&J.writeVarintField(1,O.id);J.writeMessage(2,Ab,da);J.writeVarintField(3,O.type);J.writeMessage(4,
$a,O)}}function Ab(da,J){for(const W in da.feature?.properties){let S=da.feature.properties[W];var O=da.keycache[W];if(null===S)continue;void 0===O&&(da.keys.push(W),O=da.keys.length-1,da.keycache[W]=O);J.writeVarint(O);"string"!=typeof S&&"boolean"!=typeof S&&"number"!=typeof S&&(S=JSON.stringify(S));O=typeof S+":"+S;let fa=da.valuecache[O];void 0===fa&&(da.values.push(S),fa=da.values.length-1,da.valuecache[O]=fa);J.writeVarint(fa)}}function $a(da,J){var O=da.loadGeometry();const W=da.type;let S=
0,fa=0;for(const ra of O){O=1;1===W&&(O=ra.length);J.writeVarint((O<<3)+1);O=3===W?ra.length-1:ra.length;for(let ma=0;ma<O;ma++){1===ma&&1!==W&&J.writeVarint((O-1<<3)+2);const ua=ra[ma].x-S,Aa=ra[ma].y-fa;J.writeVarint(ua<<1^ua>>31);J.writeVarint(Aa<<1^Aa>>31);S+=ua;fa+=Aa}3===da.type&&J.writeVarint(15)}}function Sb(da,J){const O=typeof da;"string"===O?J.writeStringField(1,da):"boolean"===O?J.writeBooleanField(7,da):"number"===O&&(0!=da%1?J.writeDoubleField(3,da):0>da?J.writeSVarintField(6,da):J.writeVarintField(5,
da))}function na(da,J,O){var W,S=da[J+3];O=bb(da,J,O);var fa=(W=da[J],360*(W-.5));return{type:"Feature",id:S,properties:O,geometry:{type:"Point",coordinates:[fa,360*Math.atan(Math.exp((180-360*da[J+1])*Math.PI/180))/Math.PI-90]}}}function bb(da,J,O){const W=da[J+5],S=1E4<=W?`${Math.round(W/1E3)}k`:1E3<=W?Math.round(W/100)/10+"k":W,fa=da[J+6];O=-1===fa?{}:Object.assign({},O[fa]);return Object.assign(O,{cluster:!0,cluster_id:da[J+3],point_count:W,point_count_abbreviated:S})}function tc(da){da=Math.sin(da*
Math.PI/180);da=.5-.25*Math.log((1+da)/(1-da))/Math.PI;return 0>da?0:1<da?1:da}function vb(da,J,O,W){let S=W;const fa=J+(O-J>>1);let ra,ma=O-J;const ua=da[J],Aa=da[J+1],Ua=da[O],fb=da[O+1];for(let fc=J+3;fc<O;fc+=3){var pb=da[fc],Rb=da[fc+1],ec=ua,kc=Aa;let Gc=Ua-ec,Fc=fb-kc;if(0!==Gc||0!==Fc){const Hd=((pb-ec)*Gc+(Rb-kc)*Fc)/(Gc*Gc+Fc*Fc);1<Hd?(ec=Ua,kc=fb):0<Hd&&(ec+=Gc*Hd,kc+=Fc*Hd)}pb=(Gc=pb-ec,Fc=Rb-kc,Gc*Gc+Fc*Fc);pb>S?(ra=fc,S=pb):pb===S&&(Rb=Math.abs(fc-fa),Rb<ma&&(ra=fc,ma=Rb))}S>W&&(3<ra-
J&&vb(da,J,ra,W),da[ra+2]=S,3<O-ra&&vb(da,ra,O,W))}function Pa(da,J,O,W){da={id:null==da?null:da,type:J,geometry:O,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===J||"MultiPoint"===J||"LineString"===J)yb(da,O);else if("Polygon"===J)yb(da,O[0]);else if("MultiLineString"===J)for(const S of O)yb(da,S);else if("MultiPolygon"===J)for(const S of O)yb(da,S[0]);return da}function yb(da,J){for(let O=0;O<J.length;O+=3)da.minX=Math.min(da.minX,J[O]),da.minY=Math.min(da.minY,J[O+1]),da.maxX=Math.max(da.maxX,
J[O]),da.maxY=Math.max(da.maxY,J[O+1])}function Ib(da,J,O,W){if(J.geometry){var S=J.geometry.coordinates;if(!S||0!==S.length){var fa=J.geometry.type,ra=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2),ma=[],ua=J.id;if(O.promoteId?ua=J.properties[O.promoteId]:O.generateId&&(ua=W||0),"Point"===fa)ma.push(S[0]/360+.5,lc(S[1]),0);else if("MultiPoint"===fa)for(const Aa of S)ma.push(Aa[0]/360+.5,lc(Aa[1]),0);else if("LineString"===fa)Fb(S,ma,ra,!1);else if("MultiLineString"===fa){if(O.lineMetrics){for(const Aa of S)ma=
[],Fb(Aa,ma,ra,!1),da.push(Pa(ua,"LineString",ma,J.properties));return}zb(S,ma,ra,!1)}else if("Polygon"===fa)zb(S,ma,ra,!0);else{if("MultiPolygon"!==fa){if("GeometryCollection"===fa){for(const Aa of J.geometry.geometries)Ib(da,{id:ua,geometry:Aa,properties:J.properties},O,W);return}throw Error("Input data is not a valid GeoJSON object.");}for(const Aa of S)O=[],zb(Aa,O,ra,!0),ma.push(O)}da.push(Pa(ua,fa,ma,J.properties))}}}function Fb(da,J,O,W){let S,fa,ra=0;for(let ma=0;ma<da.length;ma++){const ua=
da[ma][0]/360+.5,Aa=lc(da[ma][1]);J.push(ua,Aa,0);0<ma&&(ra+=W?(S*Aa-ua*fa)/2:Math.sqrt(Math.pow(ua-S,2)+Math.pow(Aa-fa,2)));S=ua;fa=Aa}da=J.length-3;J[2]=1;vb(J,0,da,O);J[da+2]=1;J.size=Math.abs(ra);J.start=0;J.end=J.size}function zb(da,J,O,W){for(let S=0;S<da.length;S++){const fa=[];Fb(da[S],fa,O,W);J.push(fa)}}function lc(da){da=Math.sin(da*Math.PI/180);da=.5-.25*Math.log((1+da)/(1-da))/Math.PI;return 0>da?0:1<da?1:da}function bc(da,J,O,W,S,fa,ra,ma){if(W/=J,fa>=(O/=J)&&ra<W)return da;if(ra<O||
fa>=W)return null;J=[];for(const Rb of da){ra=Rb.geometry;da=Rb.type;fa=0===S?Rb.minX:Rb.minY;var ua=0===S?Rb.maxX:Rb.maxY;if(fa>=O&&ua<W)J.push(Rb);else if(!(ua<O||fa>=W)){fa=[];if("Point"===da||"MultiPoint"===da){ua=fa;var Aa=O,Ua=W,fb=S;for(var pb=0;pb<ra.length;pb+=3){const ec=ra[pb+fb];ec>=Aa&&ec<=Ua&&ua.push(ra[pb],ra[pb+1],ra[pb+2])}}else if("LineString"===da)Hc(ra,fa,O,W,S,!1,ma.lineMetrics);else if("MultiLineString"===da){ua=fa;Aa=O;Ua=W;fb=S;for(const ec of ra)Hc(ec,ua,Aa,Ua,fb,!1,!1)}else if("Polygon"===
da){ua=fa;Aa=O;Ua=W;fb=S;for(const ec of ra)Hc(ec,ua,Aa,Ua,fb,!0,!1)}else if("MultiPolygon"===da)for(const ec of ra){pb=[];ra=ec;ua=pb;Aa=O;Ua=W;fb=S;for(const kc of ra)Hc(kc,ua,Aa,Ua,fb,!0,!1);pb.length&&fa.push(pb)}if(fa.length)if(ma.lineMetrics&&"LineString"===da)for(const ec of fa)J.push(Pa(Rb.id,da,ec,Rb.tags));else"LineString"!==da&&"MultiLineString"!==da||(1===fa.length?(da="LineString",fa=fa[0]):da="MultiLineString"),"Point"!==da&&"MultiPoint"!==da||(da=3===fa.length?"Point":"MultiPoint"),
J.push(Pa(Rb.id,da,fa,Rb.tags))}}return J.length?J:null}function Hc(da,J,O,W,S,fa,ra){let ma=Jc(da);var ua=0===S?id:sd,Aa;let Ua,fb=da.start;for(let pb=0;pb<da.length-3;pb+=3){const Rb=da[pb],ec=da[pb+1],kc=da[pb+2],fc=da[pb+3],Gc=da[pb+4],Fc=0===S?Rb:ec,Hd=0===S?fc:Gc;let de=!1;ra&&(Aa=Math.sqrt(Math.pow(Rb-fc,2)+Math.pow(ec-Gc,2)));Fc<O?Hd>O&&(Ua=ua(ma,Rb,ec,fc,Gc,O),ra&&(ma.start=fb+Aa*Ua)):Fc>W?Hd<W&&(Ua=ua(ma,Rb,ec,fc,Gc,W),ra&&(ma.start=fb+Aa*Ua)):ma.push(Rb,ec,kc);Hd<O&&Fc>=O&&(Ua=ua(ma,Rb,
ec,fc,Gc,O),de=!0);Hd>W&&Fc<=W&&(Ua=ua(ma,Rb,ec,fc,Gc,W),de=!0);!fa&&de&&(ra&&(ma.end=fb+Aa*Ua),J.push(ma),ma=Jc(da));ra&&(fb+=Aa)}ra=da.length-3;ua=da[ra];Aa=da[ra+1];S=0===S?ua:Aa;S>=O&&S<=W&&ma.push(ua,Aa,da[ra+2]);ra=ma.length-3;fa&&3<=ra&&(ma[ra]!==ma[0]||ma[ra+1]!==ma[1])&&ma.push(ma[0],ma[1],ma[2]);ma.length&&J.push(ma)}function Jc(da){const J=[];return J.size=da.size,J.start=da.start,J.end=da.end,J}function id(da,J,O,W,S,fa){J=(fa-J)/(W-J);da.push(fa,O+(S-O)*J,1);return J}function sd(da,J,
O,W,S,fa){O=(fa-O)/(S-O);da.push(J+(W-J)*O,fa,1);return O}function Dc(da,J){const O=[];for(let W=0;W<da.length;W++){const S=da[W],fa=S.type;let ra;if("Point"===fa||"MultiPoint"===fa||"LineString"===fa)ra=dc(S.geometry,J);else if("MultiLineString"===fa||"Polygon"===fa){ra=[];for(const ma of S.geometry)ra.push(dc(ma,J))}else if("MultiPolygon"===fa){ra=[];for(const ma of S.geometry){const ua=[];for(const Aa of ma)ua.push(dc(Aa,J));ra.push(ua)}}O.push(Pa(S.id,fa,ra,S.tags))}return O}function dc(da,J){const O=
[];O.size=da.size;void 0!==da.start&&(O.start=da.start,O.end=da.end);for(let W=0;W<da.length;W+=3)O.push(da[W]+J,da[W+1],da[W+2]);return O}function xc(da,J){if(da.transformed)return da;const O=1<<da.z,W=da.x,S=da.y;for(const ra of da.features){const ma=ra.geometry;var fa=ra.type;if(ra.geometry=[],1===fa)for(fa=0;fa<ma.length;fa+=2)ra.geometry.push([Math.round(J*(ma[fa]*O-W)),Math.round(J*(ma[fa+1]*O-S))]);else for(fa=0;fa<ma.length;fa++){const ua=[];for(let Aa=0;Aa<ma[fa].length;Aa+=2)ua.push([Math.round(J*
(ma[fa][Aa]*O-W)),Math.round(J*(ma[fa][Aa+1]*O-S))]);ra.geometry.push(ua)}}return da.transformed=!0,da}function Nc(da,J,O,W,S,fa){const ra=W*W;if(0<W&&J.size<(S?ra:W))return void(O.numPoints+=J.length/3);const ma=[];for(let ua=0;ua<J.length;ua+=3)(0===W||J[ua+2]>ra)&&(O.numSimplified++,ma.push(J[ua],J[ua+1])),O.numPoints++;if(S){J=0;for(let ua=0,Aa=ma.length,Ua=Aa-2;ua<Aa;Ua=ua,ua+=2)J+=(ma[ua]-ma[Ua])*(ma[ua+1]+ma[Ua+1]);if(0<J===fa)for(let ua=0,Aa=ma.length;ua<Aa/2;ua+=2)fa=ma[ua],J=ma[ua+1],ma[ua]=
ma[Aa-2-ua],ma[ua+1]=ma[Aa-1-ua],ma[Aa-2-ua]=fa,ma[Aa-1-ua]=J}da.push(ma)}class pd{constructor(da,J){this.keyCache={};da&&this.replace(da,J)}replace(da,J){this._layerConfigs={};this._layers={};this.update(da,[],J)}update(da,J,O){for(var W of da)this._layerConfigs[W.id]=W,da=this._layers[W.id]=M.bJ(W,O),da._featureFilter=M.aa(da.filter,O),this.keyCache[W.id]&&delete this.keyCache[W.id];for(var S of J)delete this.keyCache[S],delete this._layerConfigs[S],delete this._layers[S];this.familiesBySource=
{};J=M.cC(Object.values(this._layerConfigs),this.keyCache);for(const fa of J)J=fa.map(ra=>this._layers[ra.id]),W=J[0],"none"!==W.visibility&&(S=W.source||"",(O=this.familiesBySource[S])||(O=this.familiesBySource[S]={}),W=W.sourceLayer||"_geojsonTileLayer",(S=O[W])||(S=O[W]=[]),S.push(J))}}class Ic{constructor(da){const J={};var O=[];for(var W in da){var S=da[W],fa=J[W]={};for(const ua in S){const Aa=S[+ua];if(!Aa||0===Aa.bitmap.width||0===Aa.bitmap.height)continue;const Ua={x:0,y:0,w:Aa.bitmap.width+
2,h:Aa.bitmap.height+2};O.push(Ua);fa[ua]={rect:Ua,metrics:Aa.metrics}}}const {w:ra,h:ma}=M.p(O);O=new M.q({width:ra||1,height:ma||1});for(const ua in da){W=da[ua];for(const Aa in W)(S=W[+Aa])&&0!==S.bitmap.width&&0!==S.bitmap.height&&(fa=J[ua][Aa].rect,M.q.copy(S.bitmap,O,{x:0,y:0},{x:fa.x+1,y:fa.y+1},S.bitmap))}this.image=O;this.positions=J}}M.cD("GlyphAtlas",Ic);class Rc{constructor(da){this.tileID=new M.Z(da.tileID.overscaledZ,da.tileID.wrap,da.tileID.canonical.z,da.tileID.canonical.x,da.tileID.canonical.y);
this.uid=da.uid;this.zoom=da.zoom;this.pixelRatio=da.pixelRatio;this.tileSize=da.tileSize;this.source=da.source;this.overscaling=this.tileID.overscaleFactor();this.showCollisionBoxes=da.showCollisionBoxes;this.collectResourceTiming=!!da.collectResourceTiming;this.returnDependencies=!!da.returnDependencies;this.promoteId=da.promoteId;this.inFlightDependencies=[]}parse(da,J,O,W,S){return M._(this,void 0,void 0,function*(){this.status="parsing";this.data=da;this.collisionBoxArray=new M.a8;var fa=new M.cE(Object.keys(da.layers).sort());
const ra=new M.cF(this.tileID,this.promoteId);ra.bucketLayerIDs=[];const ma={},ua={featureIndex:ra,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:O,subdivisionGranularity:S};var Aa=J.familiesBySource[this.source];for(var Ua in Aa){var fb=da.layers[Ua];if(fb){1===fb.version&&M.w(`Vector tile source "${this.source}" layer "${Ua}" does not use vector tile spec v2 and therefore may have some rendering errors.`);var pb=fa.encode(Ua),Rb=[];for(let Fc=
0;Fc<fb.length;Fc++){const Hd=fb.feature(Fc),de=ra.getId(Hd,Ua);Rb.push({feature:Hd,id:de,index:Fc,sourceLayerIndex:pb})}for(const Fc of Aa[Ua])fb=Fc[0],fb.source!==this.source&&M.w(`layer.source = ${fb.source} does not equal this.source = ${this.source}`),fb.minzoom&&this.zoom<Math.floor(fb.minzoom)||fb.maxzoom&&this.zoom>=fb.maxzoom||"none"!==fb.visibility&&(v(Fc,this.zoom,O),(ma[fb.id]=fb.createBucket({index:ra.bucketLayerIDs.length,layers:Fc,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,
collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pb,sourceID:this.source})).populate(Rb,ua,this.tileID.canonical),ra.bucketLayerIDs.push(Fc.map(Hd=>Hd.id)))}}Aa=M.bO(ua.glyphDependencies,Fc=>Object.keys(Fc).map(Number));this.inFlightDependencies.forEach(Fc=>null==Fc?void 0:Fc.abort());this.inFlightDependencies=[];fa=Promise.resolve({});Object.keys(Aa).length&&(fa=new AbortController,this.inFlightDependencies.push(fa),fa=W.sendAsync({type:"GG",data:{stacks:Aa,source:this.source,tileID:this.tileID,
type:"glyphs"}},fa));Ua=Object.keys(ua.iconDependencies);Aa=Promise.resolve({});Ua.length&&(Aa=new AbortController,this.inFlightDependencies.push(Aa),Aa=W.sendAsync({type:"GI",data:{icons:Ua,source:this.source,tileID:this.tileID,type:"icons"}},Aa));pb=Object.keys(ua.patternDependencies);Ua=Promise.resolve({});pb.length&&(Ua=new AbortController,this.inFlightDependencies.push(Ua),Ua=W.sendAsync({type:"GI",data:{icons:pb,source:this.source,tileID:this.tileID,type:"patterns"}},Ua));pb=ua.dashDependencies;
Rb=Promise.resolve({});Object.keys(pb).length&&(Rb=new AbortController,this.inFlightDependencies.push(Rb),Rb=W.sendAsync({type:"GDA",data:{dashes:pb}},Rb));const [ec,kc,fc,Gc]=yield Promise.all([fa,Aa,Ua,Rb]);fa=new Ic(ec);Aa=new M.cG(kc,fc);for(const Fc in ma)Ua=ma[Fc],Ua instanceof M.a9?(v(Ua.layers,this.zoom,O),M.cH({bucket:Ua,glyphMap:ec,glyphPositions:fa.positions,imageMap:kc,imagePositions:Aa.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ua.subdivisionGranularity})):
Ua.hasDependencies&&(Ua instanceof M.cI||Ua instanceof M.cJ||Ua instanceof M.cK)&&(v(Ua.layers,this.zoom,O),Ua.addFeatures(ua,this.tileID.canonical,Aa.patternPositions,Gc));return this.status="done",{buckets:Object.values(ma).filter(Fc=>!Fc.isEmpty()),featureIndex:ra,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fa.image,imageAtlas:Aa,dashPositions:Gc,glyphMap:this.returnDependencies?ec:null,iconMap:this.returnDependencies?kc:null,glyphPositions:this.returnDependencies?fa.positions:null}})}}
class Kb{constructor(da,J,O){this.actor=da;this.layerIndex=J;this.availableImages=O;this.fetching={};this.loading={};this.loaded={}}loadVectorTile(da,J){return M._(this,void 0,void 0,function*(){var O=yield M.n(da.request,J);try{return{vectorTile:new M.cL(new M.cM(O.data)),rawData:O.data,cacheControl:O.cacheControl,expires:O.expires}}catch(W){O=new Uint8Array(O.data);let S=`Unable to parse the tile at ${da.request.url}, `;throw S+=31===O[0]&&139===O[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":
`got error: ${W.message}`,Error(S);}})}loadTile(da){return M._(this,void 0,void 0,function*(){const J=da.uid,O=!!(da&&da.request&&da.request.collectResourceTiming)&&new M.cN(da.request),W=new Rc(da);this.loading[J]=W;var S=new AbortController;W.abort=S;try{const fa=yield this.loadVectorTile(da,S);if(delete this.loading[J],!fa)return null;const ra=fa.rawData;S={};fa.expires&&(S.expires=fa.expires);fa.cacheControl&&(S.cacheControl=fa.cacheControl);const ma={};if(O){const Aa=O.finish();Aa&&(ma.resourceTiming=
JSON.parse(JSON.stringify(Aa)))}W.vectorTile=fa.vectorTile;const ua=W.parse(fa.vectorTile,this.layerIndex,this.availableImages,this.actor,da.subdivisionGranularity);this.loaded[J]=W;this.fetching[J]={rawTileData:ra,cacheControl:S,resourceTiming:ma};try{const Aa=yield ua;return M.e({rawTileData:ra.slice(0)},Aa,S,ma)}finally{delete this.fetching[J]}}catch(fa){throw delete this.loading[J],W.status="done",this.loaded[J]=W,fa;}})}reloadTile(da){return M._(this,void 0,void 0,function*(){var J=da.uid;if(!this.loaded||
!this.loaded[J])throw Error("Should not be trying to reload a tile that was never loaded or has been removed");var O=this.loaded[J];if(O.showCollisionBoxes=da.showCollisionBoxes,"parsing"===O.status){O=yield O.parse(O.vectorTile,this.layerIndex,this.availableImages,this.actor,da.subdivisionGranularity);if(this.fetching[J]){const {rawTileData:W,cacheControl:S,resourceTiming:fa}=this.fetching[J];delete this.fetching[J];J=M.e({rawTileData:W.slice(0)},O,S,fa)}else J=O;return J}if("done"===O.status&&O.vectorTile)return O.parse(O.vectorTile,
this.layerIndex,this.availableImages,this.actor,da.subdivisionGranularity)})}abortTile(da){return M._(this,void 0,void 0,function*(){const J=this.loading,O=da.uid;J&&J[O]&&J[O].abort&&(J[O].abort.abort(),delete J[O])})}removeTile(da){return M._(this,void 0,void 0,function*(){this.loaded&&this.loaded[da.uid]&&delete this.loaded[da.uid]})}}class Ma{constructor(){this.loaded={}}loadTile(da){return M._(this,void 0,void 0,function*(){const {uid:J,encoding:O,rawImageData:W,redFactor:S,greenFactor:fa,blueFactor:ra,
baseShift:ma}=da;var ua=W.width+2;const Aa=W.height+2;ua=M.b(W)?new M.R({width:ua,height:Aa},yield M.cO(W,-1,-1,ua,Aa)):W;ua=new M.cP(J,ua,O,S,fa,ra,ma);return this.loaded=this.loaded||{},this.loaded[J]=ua,ua})}removeTile(da){const J=this.loaded;da=da.uid;J&&J[da]&&delete J[da]}}var jb,sc,Ac=function(){function da(O,W){if(0!==O.length){J(O[0],W);for(var S=1;S<O.length;S++)J(O[S],!W)}}function J(O,W){for(var S=0,fa=0,ra=0,ma=O.length,ua=ma-1;ra<ma;ua=ra++){ua=(O[ra][0]-O[ua][0])*(O[ua][1]+O[ra][1]);
var Aa=S+ua;fa+=Math.abs(S)>=Math.abs(ua)?S-Aa+ua:ua-Aa+S;S=Aa}0<=S+fa!=!!W&&O.reverse()}return sc?jb:(sc=1,jb=function fa(W,S){var ra=W&&W.type;if("FeatureCollection"===ra)for(ra=0;ra<W.features.length;ra++)fa(W.features[ra],S);else if("GeometryCollection"===ra)for(ra=0;ra<W.geometries.length;ra++)fa(W.geometries[ra],S);else if("Feature"===ra)fa(W.geometry,S);else if("Polygon"===ra)da(W.coordinates,S);else if("MultiPolygon"===ra)for(ra=0;ra<W.coordinates.length;ra++)da(W.coordinates[ra],S);return W})}(),
Tc=M.cQ(Ac);class od extends M.cS{constructor(da,J){super(new M.cM,0,J,[],[]);this.feature=da;this.type=da.type;this.properties=da.tags?da.tags:{};"id"in da&&("string"==typeof da.id?this.id=parseInt(da.id,10):"number"!=typeof da.id||isNaN(da.id)||(this.id=da.id))}loadGeometry(){const da=[];var J=1===this.feature.type?[this.feature.geometry]:this.feature.geometry;for(const O of J){J=[];for(const W of O)J.push(new M.P(W[0],W[1]));da.push(J)}return da}}class Vc extends M.cR{constructor(da,J){super(new M.cM);
this.layers={_geojsonTileLayer:this};this.name="_geojsonTileLayer";this.version=J?J.version:1;this.extent=J?J.extent:4096;this.length=da.length;this.features=da}feature(da){return new od(this.features[da],this.extent)}}const yc={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:da=>da},Pc=Math.fround||(td=new Float32Array(1),da=>(td[0]=+da,td[0]));var td;class Cd{constructor(da){this.options=Object.assign(Object.create(yc),da);this.trees=Array(this.options.maxZoom+
1);this.stride=this.options.reduce?7:6;this.clusterProps=[]}load(da){const {log:J,minZoom:O,maxZoom:W}=this.options;J&&console.time("total time");var S=`prepare ${da.length} points`;J&&console.time(S);this.points=da;var fa=[];for(let ma=0;ma<da.length;ma++){var ra=da[ma];if(!ra.geometry)continue;const [ua,Aa]=ra.geometry.coordinates;ra=Pc(ua/360+.5);const Ua=Pc(tc(Aa));fa.push(ra,Ua,1/0,ma,-1,1);this.options.reduce&&fa.push(0)}da=this.trees[W+1]=this._createTree(fa);J&&console.timeEnd(S);for(S=W;S>=
O;S--)fa=+Date.now(),da=this.trees[S]=this._createTree(this._cluster(da,S)),J&&console.log("z%d: %d clusters in %dms",S,da.numItems,+Date.now()-fa);return J&&console.timeEnd("total time"),this}getClusters(da,J){let O=((da[0]+180)%360+360)%360-180;var W=Math.max(-90,Math.min(90,da[1])),S=180===da[2]?180:((da[2]+180)%360+360)%360-180,fa=Math.max(-90,Math.min(90,da[3]));if(360<=da[2]-da[0])O=-180,S=180;else if(O>S){var ra=this.getClusters([O,W,180,fa],J);W=this.getClusters([-180,W,S,fa],J);return ra.concat(W)}J=
this.trees[this._limitZoom(J)];W=J.range(O/360+.5,tc(fa),S/360+.5,tc(W));S=J.data;fa=[];for(ra of W)W=this.stride*ra,fa.push(1<S[W+5]?na(S,W,this.clusterProps):this.points[S[W+3]]);return fa}getChildren(da){var J=this._getOriginId(da),O=this._getOriginZoom(da);const W=this.trees[O];if(!W)throw Error("No cluster with the specified id.");const S=W.data;if(J*this.stride>=S.length)throw Error("No cluster with the specified id.");O=W.within(S[J*this.stride],S[J*this.stride+1],this.options.radius/(this.options.extent*
Math.pow(2,O-1)));J=[];for(const fa of O)O=fa*this.stride,S[O+4]===da&&J.push(1<S[O+5]?na(S,O,this.clusterProps):this.points[S[O+3]]);if(0===J.length)throw Error("No cluster with the specified id.");return J}getLeaves(da,J,O){const W=[];return this._appendLeaves(W,da,J||10,O||0,0),W}getTile(da,J,O){const W=this.trees[this._limitZoom(da)];da=Math.pow(2,da);const {extent:S,radius:fa}=this.options,ra=fa/S,ma=(O-ra)/da,ua=(O+1+ra)/da,Aa={features:[]};return this._addTileFeatures(W.range((J-ra)/da,ma,
(J+1+ra)/da,ua),W.data,J,O,da,Aa),0===J&&this._addTileFeatures(W.range(1-ra/da,ma,1,ua),W.data,da,O,da,Aa),J===da-1&&this._addTileFeatures(W.range(0,ma,ra/da,ua),W.data,-1,O,da,Aa),Aa.features.length?Aa:null}getClusterExpansionZoom(da){let J=this._getOriginZoom(da)-1;for(;J<=this.options.maxZoom;){da=this.getChildren(da);if(J++,1!==da.length)break;da=da[0].properties.cluster_id}return J}_appendLeaves(da,J,O,W,S){J=this.getChildren(J);for(const fa of J)if(J=fa.properties,J&&J.cluster?S+J.point_count<=
W?S+=J.point_count:S=this._appendLeaves(da,J.cluster_id,O,W,S):S<W?S++:da.push(fa),da.length===O)break;return S}_createTree(da){const J=new M.aI(da.length/this.stride|0,this.options.nodeSize,Float32Array);for(let O=0;O<da.length;O+=this.stride)J.add(da[O],da[O+1]);return J.finish(),J.data=da,J}_addTileFeatures(da,J,O,W,S,fa){for(const ua of da){da=ua*this.stride;const Aa=1<J[da+5];var ra=void 0,ma=void 0;let Ua;if(Aa)ra=bb(J,da,this.clusterProps),ma=J[da],Ua=J[da+1];else{ma=this.points[J[da+3]];ra=
ma.properties;const [fb,pb]=ma.geometry.coordinates;ma=fb/360+.5;Ua=tc(pb)}ra={type:1,geometry:[[Math.round(this.options.extent*(ma*S-O)),Math.round(this.options.extent*(Ua*S-W))]],tags:ra};da=Aa||this.options.generateId?J[da+3]:this.points[J[da+3]].id;void 0!==da&&(ra.id=da);fa.features.push(ra)}}_limitZoom(da){return Math.max(this.options.minZoom,Math.min(Math.floor(+da),this.options.maxZoom+1))}_cluster(da,J){const {radius:O,extent:W,reduce:S,minPoints:fa}=this.options,ra=O/(W*Math.pow(2,J)),ma=
da.data,ua=[],Aa=this.stride;for(let fc=0;fc<ma.length;fc+=Aa)if(!(ma[fc+2]<=J)){ma[fc+2]=J;var Ua=ma[fc],fb=ma[fc+1],pb=da.within(ma[fc],ma[fc+1],ra),Rb=ma[fc+5],ec=Rb;for(const Gc of pb){var kc=Gc*Aa;ma[kc+2]>J&&(ec+=ma[kc+5])}if(ec>Rb&&ec>=fa){let Gc;Ua*=Rb;fb*=Rb;Rb=-1;kc=(fc/Aa<<5)+(J+1)+this.points.length;for(const Fc of pb){pb=Fc*Aa;if(ma[pb+2]<=J)continue;ma[pb+2]=J;const Hd=ma[pb+5];Ua+=ma[pb]*Hd;fb+=ma[pb+1]*Hd;ma[pb+4]=kc;S&&(Gc||(Gc=this._map(ma,fc,!0),Rb=this.clusterProps.length,this.clusterProps.push(Gc)),
S(Gc,this._map(ma,pb)))}ma[fc+4]=kc;ua.push(Ua/ec,fb/ec,1/0,kc,-1,ec);S&&ua.push(Rb)}else{for(Ua=0;Ua<Aa;Ua++)ua.push(ma[fc+Ua]);if(1<ec)for(const Gc of pb)if(ec=Gc*Aa,!(ma[ec+2]<=J))for(ma[ec+2]=J,pb=0;pb<Aa;pb++)ua.push(ma[ec+pb])}}return ua}_getOriginId(da){return da-this.points.length>>5}_getOriginZoom(da){return(da-this.points.length)%32}_map(da,J,O){if(1<da[J+5])return da=this.clusterProps[da[J+6]],O?Object.assign({},da):da;da=this.points[da[J+3]].properties;J=this.options.map(da);return O&&
J===da?Object.assign({},J):J}}const Gd={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1E5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class pe{constructor(da,J){const O=(J=this.options=function(W,S){for(const fa in S)W[fa]=S[fa];return W}(Object.create(Gd),J)).debug;if(O&&console.time("preprocess data"),0>J.maxZoom||24<J.maxZoom)throw Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw Error("promoteId and generateId cannot be used together.");
da=function(W,S){const fa=[];if("FeatureCollection"===W.type)for(let ra=0;ra<W.features.length;ra++)Ib(fa,W.features[ra],S,ra);else Ib(fa,"Feature"===W.type?W:{geometry:W},S);return fa}(da,J);this.tiles={};this.tileCoords=[];O&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0);da=function(W,S){const fa=S.buffer/S.extent;let ra=W;const ma=bc(W,1,-1-fa,fa,0,-1,2,S),ua=bc(W,1,
1-fa,2+fa,0,-1,2,S);return(ma||ua)&&(ra=bc(W,1,-fa,1+fa,0,-1,2,S)||[],ma&&(ra=Dc(ma,1).concat(ra)),ua&&(ra=ra.concat(Dc(ua,-1)))),ra}(da,J);da.length&&this.splitTile(da,0,0,0);O&&(da.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(da,J,O,W,S,fa,ra){const ma=[da,J,O,W],ua=this.options,Aa=ua.debug;for(;ma.length;){W=ma.pop();O=ma.pop();
J=ma.pop();da=ma.pop();const Me=1<<J;var Ua=32*((1<<J)*W+O)+J,fb=this.tiles[Ua],pb;if(pb=!fb){1<Aa&&console.time("creation");fb=this.tiles;var Rb=da;pb=J===ua.maxZoom?0:ua.tolerance/((1<<J)*ua.extent);var ec={features:[],numPoints:0,numSimplified:0,numFeatures:Rb.length,source:null,x:O,y:W,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const zg of Rb){Rb=ec;var kc=zg,fc=pb,Gc=kc.geometry,Fc=kc.type,Hd=[];if(Rb.minX=Math.min(Rb.minX,kc.minX),Rb.minY=Math.min(Rb.minY,kc.minY),Rb.maxX=Math.max(Rb.maxX,
kc.maxX),Rb.maxY=Math.max(Rb.maxY,kc.maxY),"Point"===Fc||"MultiPoint"===Fc)for(fc=0;fc<Gc.length;fc+=3)Hd.push(Gc[fc],Gc[fc+1]),Rb.numPoints++,Rb.numSimplified++;else if("LineString"===Fc)Nc(Hd,Gc,Rb,fc,!1,!1);else if("MultiLineString"===Fc||"Polygon"===Fc)for(var de=0;de<Gc.length;de++)Nc(Hd,Gc[de],Rb,fc,"Polygon"===Fc,0===de);else if("MultiPolygon"===Fc)for(de=0;de<Gc.length;de++){const Kf=Gc[de];for(let Lf=0;Lf<Kf.length;Lf++)Nc(Hd,Kf[Lf],Rb,fc,!0,0===Lf)}if(Hd.length){fc=kc.tags||null;if("LineString"===
Fc&&ua.lineMetrics){fc={};for(const Kf in kc.tags)fc[Kf]=kc.tags[Kf];fc.mapbox_clip_start=Gc.start/Gc.size;fc.mapbox_clip_end=Gc.end/Gc.size}Gc={geometry:Hd,type:"Polygon"===Fc||"MultiPolygon"===Fc?3:"LineString"===Fc||"MultiLineString"===Fc?2:1,tags:fc};null!==kc.id&&(Gc.id=kc.id);Rb.features.push(Gc)}}pb=(fb=fb[Ua]=ec,this.tileCoords.push({z:J,x:O,y:W}),Aa)}pb&&(1<Aa&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,O,W,fb.numFeatures,fb.numPoints,fb.numSimplified),console.timeEnd("creation")),
Ua=`z${J}`,this.stats[Ua]=(this.stats[Ua]||0)+1,this.total++);if(fb.source=da,null==S){if(J===ua.indexMaxZoom||fb.numPoints<=ua.indexMaxPoints)continue}else{if(J===ua.maxZoom||J===S)continue;if(null!=S&&(Ua=S-J,O!==fa>>Ua||W!==ra>>Ua))continue}if(fb.source=null,0!==da.length)1<Aa&&console.time("clipping"),Ua=.5*ua.buffer/ua.extent,pb=.5-Ua,ec=.5+Ua,Rb=1+Ua,Hd=Fc=Gc=kc=null,fc=bc(da,Me,O-Ua,O+ec,0,fb.minX,fb.maxX,ua),da=bc(da,Me,O+pb,O+Rb,0,fb.minX,fb.maxX,ua),fc&&(kc=bc(fc,Me,W-Ua,W+ec,1,fb.minY,
fb.maxY,ua),Gc=bc(fc,Me,W+pb,W+Rb,1,fb.minY,fb.maxY,ua)),da&&(Fc=bc(da,Me,W-Ua,W+ec,1,fb.minY,fb.maxY,ua),Hd=bc(da,Me,W+pb,W+Rb,1,fb.minY,fb.maxY,ua)),1<Aa&&console.timeEnd("clipping"),ma.push(kc||[],J+1,2*O,2*W),ma.push(Gc||[],J+1,2*O,2*W+1),ma.push(Fc||[],J+1,2*O+1,2*W),ma.push(Hd||[],J+1,2*O+1,2*W+1)}}getTile(da,J,O){da=+da;J=+J;O=+O;const {extent:W,debug:S}=this.options;if(0>da||24<da)return null;var fa=1<<da;var ra=da;fa=J=J+fa&fa-1;ra=32*((1<<ra)*O+fa)+ra;if(this.tiles[ra])return xc(this.tiles[ra],
W);1<S&&console.log("drilling down to z%d-%d-%d",da,J,O);let ma;fa=da;let ua=J,Aa=O;for(;!ma&&0<fa;)fa--,ua>>=1,Aa>>=1,ma=this.tiles[32*((1<<fa)*Aa+ua)+fa];return ma&&ma.source?(1<S&&(console.log("found parent tile z%d-%d-%d",fa,ua,Aa),console.time("drilling down")),this.splitTile(ma.source,fa,ua,Aa,da,J,O),1<S&&console.timeEnd("drilling down"),this.tiles[ra]?xc(this.tiles[ra],W):null):null}}class qe extends Kb{constructor(){super(...arguments);this._dataUpdateable=new Map}loadVectorTile(da,J){return M._(this,
void 0,void 0,function*(){var O=da.tileID.canonical;if(!this._geoJSONIndex)throw Error("Unable to parse the data into a cluster or geojson");O=this._geoJSONIndex.getTile(O.z,O.x,O.y);if(!O)return null;O=new Vc(O.features,{version:2,extent:M.$});const W=new M.cM;for(var S in O.layers)W.writeMessage(3,ta,O.layers[S]);S=W.finish();return 0===S.byteOffset&&S.byteLength===S.buffer.byteLength||(S=new Uint8Array(S)),{vectorTile:O,rawData:S.buffer}})}loadData(da){return M._(this,void 0,void 0,function*(){var J;
null===(J=this._pendingRequest)||void 0===J||J.abort();J=!!(da&&da.request&&da.request.collectResourceTiming)&&new M.cN(da.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(da,this._pendingRequest);var O=yield this._pendingData;this._geoJSONIndex=da.cluster?(new Cd(function({superclusterOptions:W,clusterProperties:S}){if(!S||!W)return W;const fa={},ra={},ma={accumulated:null,zoom:0},ua={properties:null},Aa=Object.keys(S);for(const Ua of Aa){const [fb,
pb]=S[Ua],Rb=M.cT(pb),ec=M.cT("string"==typeof fb?[fb,["accumulated"],["get",Ua]]:fb);fa[Ua]=Rb.value;ra[Ua]=ec.value}return W.map=Ua=>{ua.properties=Ua;Ua={};for(const fb of Aa)Ua[fb]=fa[fb].evaluate(ma,ua);return Ua},W.reduce=(Ua,fb)=>{ua.properties=fb;for(const pb of Aa)ma.accumulated=Ua[pb],Ua[pb]=ra[pb].evaluate(ma,ua)},W}(da))).load(O.features):new pe(O,da.geojsonVtOptions);this.loaded={};O={data:O};if(J){const W=J.finish();W&&(O.resourceTiming={},O.resourceTiming[da.source]=JSON.parse(JSON.stringify(W)))}return O}catch(W){if(delete this._pendingRequest,
M.cy(W))return{abandoned:!0};throw W;}})}getData(){return M._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(da){const J=this.loaded;return J&&J[da.uid]?super.reloadTile(da):this.loadTile(da)}loadAndProcessGeoJSON(da,J){return M._(this,void 0,void 0,function*(){let O=yield this.loadGeoJSON(da,J);if(delete this._pendingRequest,"object"!=typeof O)throw Error(`Input data given to '${da.source}' is not a valid GeoJSON object.`);if(Tc(O,!0),da.filter){const W=M.cT(da.filter,{type:"boolean",
"property-type":"data-driven",overridable:!1,transition:!1});if("error"===W.result)throw Error(W.value.map(S=>`${S.key}: ${S.message}`).join(", "));O={type:"FeatureCollection",features:O.features.filter(S=>W.value.evaluate({zoom:0},S))}}return O})}loadGeoJSON(da,J){return M._(this,void 0,void 0,function*(){const {promoteId:O}=da;if(da.request){var W=yield M.j(da.request,J);return this._dataUpdateable=M.cV(W.data,O)?M.cU(W.data,O):void 0,W.data}if("string"==typeof da.data)try{return W=JSON.parse(da.data),
this._dataUpdateable=M.cV(W,O)?M.cU(W,O):void 0,W}catch(S){throw Error(`Input data given to '${da.source}' is not a valid GeoJSON object.`);}if(!da.dataDiff)throw Error(`Input data given to '${da.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw Error(`Cannot update existing geojson data in ${da.source}`);return M.cW(this._dataUpdateable,da.dataDiff,O),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(da){return M._(this,void 0,void 0,
function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(da){return this._geoJSONIndex.getClusterExpansionZoom(da.clusterId)}getClusterChildren(da){return this._geoJSONIndex.getChildren(da.clusterId)}getClusterLeaves(da){return this._geoJSONIndex.getLeaves(da.clusterId,da.limit,da.offset)}}class gf{constructor(da){this.self=da;this.actor=new M.J(da);this.layerIndexes={};this.availableImages={};this.workerSources={};this.demWorkerSources={};this.externalWorkerSourceTypes=
{};this.globalStates=new Map;this.self.registerWorkerSource=(J,O)=>{if(this.externalWorkerSourceTypes[J])throw Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=O};this.self.addProtocol=M.cA;this.self.removeProtocol=M.cB;this.self.registerRTLTextPlugin=J=>{M.cX.setMethods(J)};this.actor.registerMessageHandler("LDT",(J,O)=>this._getDEMWorkerSource(J,O.source).loadTile(O));this.actor.registerMessageHandler("RDT",(J,O)=>M._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,
O.source).removeTile(O)}));this.actor.registerMessageHandler("GCEZ",(J,O)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(J,O.type,O.source).getClusterExpansionZoom(O)}));this.actor.registerMessageHandler("GCC",(J,O)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(J,O.type,O.source).getClusterChildren(O)}));this.actor.registerMessageHandler("GCL",(J,O)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(J,O.type,O.source).getClusterLeaves(O)}));this.actor.registerMessageHandler("LD",
(J,O)=>this._getWorkerSource(J,O.type,O.source).loadData(O));this.actor.registerMessageHandler("GD",(J,O)=>this._getWorkerSource(J,O.type,O.source).getData());this.actor.registerMessageHandler("LT",(J,O)=>this._getWorkerSource(J,O.type,O.source).loadTile(O));this.actor.registerMessageHandler("RT",(J,O)=>this._getWorkerSource(J,O.type,O.source).reloadTile(O));this.actor.registerMessageHandler("AT",(J,O)=>this._getWorkerSource(J,O.type,O.source).abortTile(O));this.actor.registerMessageHandler("RMT",
(J,O)=>this._getWorkerSource(J,O.type,O.source).removeTile(O));this.actor.registerMessageHandler("RS",(J,O)=>M._(this,void 0,void 0,function*(){if(this.workerSources[J]&&this.workerSources[J][O.type]&&this.workerSources[J][O.type][O.source]){var W=this.workerSources[J][O.type][O.source];delete this.workerSources[J][O.type][O.source];void 0!==W.removeSource&&W.removeSource(O)}}));this.actor.registerMessageHandler("RM",J=>M._(this,void 0,void 0,function*(){delete this.layerIndexes[J];delete this.availableImages[J];
delete this.workerSources[J];delete this.demWorkerSources[J];this.globalStates.delete(J)}));this.actor.registerMessageHandler("SR",(J,O)=>M._(this,void 0,void 0,function*(){this.referrer=O}));this.actor.registerMessageHandler("SRPS",(J,O)=>this._syncRTLPluginState(J,O));this.actor.registerMessageHandler("IS",(J,O)=>M._(this,void 0,void 0,function*(){this.self.importScripts(O)}));this.actor.registerMessageHandler("SI",(J,O)=>this._setImages(J,O));this.actor.registerMessageHandler("UL",(J,O)=>M._(this,
void 0,void 0,function*(){this._getLayerIndex(J).update(O.layers,O.removedIds,this._getGlobalState(J))}));this.actor.registerMessageHandler("UGS",(J,O)=>M._(this,void 0,void 0,function*(){const W=this._getGlobalState(J);for(const S in O)W[S]=O[S]}));this.actor.registerMessageHandler("SL",(J,O)=>M._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(O,this._getGlobalState(J))}))}_getGlobalState(da){let J=this.globalStates.get(da);return J||(J={},this.globalStates.set(da,J)),J}_setImages(da,
J){return M._(this,void 0,void 0,function*(){this.availableImages[da]=J;for(const O in this.workerSources[da]){const W=this.workerSources[da][O];for(const S in W)W[S].availableImages=J}})}_syncRTLPluginState(da,J){return M._(this,void 0,void 0,function*(){return yield M.cX.syncState(J,this.self.importScripts)})}_getAvailableImages(da){da=this.availableImages[da];return da||(da=[]),da}_getLayerIndex(da){let J=this.layerIndexes[da];return J||(J=this.layerIndexes[da]=new pd),J}_getWorkerSource(da,J,
O){if(this.workerSources[da]||(this.workerSources[da]={}),this.workerSources[da][J]||(this.workerSources[da][J]={}),!this.workerSources[da][J][O]){const W={sendAsync:(S,fa)=>(S.targetMapId=da,this.actor.sendAsync(S,fa))};switch(J){case "vector":this.workerSources[da][J][O]=new Kb(W,this._getLayerIndex(da),this._getAvailableImages(da));break;case "geojson":this.workerSources[da][J][O]=new qe(W,this._getLayerIndex(da),this._getAvailableImages(da));break;default:this.workerSources[da][J][O]=new this.externalWorkerSourceTypes[J](W,
this._getLayerIndex(da),this._getAvailableImages(da))}}return this.workerSources[da][J][O]}_getDEMWorkerSource(da,J){return this.demWorkerSources[da]||(this.demWorkerSources[da]={}),this.demWorkerSources[da][J]||(this.demWorkerSources[da][J]=new Ma),this.demWorkerSources[da][J]}}return M.i(self)&&(self.worker=new gf(self)),gf});Na("index",["exports","./shared"],function(M,v){function ta(){var b=new v.A(4);return v.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}function Va(b){const g=b.createTexture();
b.bindTexture(b.TEXTURE_2D,g);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,Ih),b.isContextLost())return;Zi.supported=!0}catch(m){}b.deleteTexture(g);wi=!0}function Ab(b){const g=[];if("string"==typeof b)g.push({id:"default",url:b});else if(b&&0<b.length){const m=[];for(const {id:u,url:z}of b)b=`${u}${z}`,-1===m.indexOf(b)&&(m.push(b),g.push({id:u,url:z}))}return g}function $a(b,g,m){try{const u=new URL(b);return u.pathname+=`${g}${m}`,u.toString()}catch(u){throw Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`);
}}function Sb(b,g,m,u,z,C,G,K,R){for(var X=g;X<g+u;X++)na(b,m*C+X,C,z,G,K,R);for(X=m;X<m+z;X++)na(b,X*C+g,1,u,G,K,R)}function na(b,g,m,u,z,C,G){C[0]=0;G[0]=-1E20;G[1]=1E20;z[0]=b[g];for(let X=1,ca=0,ja=0;X<u;X++){z[X]=b[g+X*m];var K=X*X;do{var R=C[ca];ja=(z[X]-z[R]+K-R*R)/(X-R)/2}while(ja<=G[ca]&&-1<--ca);ca++;C[ca]=X;G[ca]=ja;G[ca+1]=1E20}for(let X=0,ca=0;X<u;X++){for(;G[ca+1]<X;)ca++;K=C[ca];R=X-K;b[g+X*m]=z[K]+R*R}}function bb(){return Vf||(Vf=new Fg),Vf}function tc(){return pg||(pg=new zi(bb(),
v.K),pg.registerMessageHandler("GR",(b,g,m)=>v.m(g,m))),pg}function vb(b,g){const m=v.L();return v.M(m,m,[1,1,0]),v.N(m,m,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?v.O(m,m,b.calculatePosMatrix(g.toUnwrapped())):m}function Pa(b,g,m,u,z,C,G){var K,R=function(X,ca,ja){if(X)for(var la of X){var pa=ca[la];if(pa&&pa.source===ja&&"fill-extrusion"===pa.type)return!0}else for(pa in ca)if(la=ca[pa],la.source===ja&&"fill-extrusion"===la.type)return!0;return!1}(null!==(K=null==z?void 0:z.layers)&&void 0!==
K?K:null,g,b.id);K=C.maxPitchScaleFactor();u=b.tilesIn(u,K,R);u.sort(yb);R=[];for(const X of u)R.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(g,m,b._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,z,C,K,vb(b.transform,X.tileID),G?(ca,ja)=>G(X.tileID,ca,ja):void 0)});return function(X,ca){for(const ja in X)for(const la of X[ja])Ib(la,ca);return X}(function(X){const ca={},ja={};for(const pa of X){X=pa.queryResults;var la=pa.wrappedTileID;la=ja[la]=ja[la]||
{};for(const ya in X){const Ba=X[ya],za=la[ya]=la[ya]||{},Ea=ca[ya]=ca[ya]||[];for(const Qa of Ba)za[Qa.featureIndex]||(za[Qa.featureIndex]=!0,Ea.push(Qa))}}return ca}(R),b)}function yb(b,g){b=b.tileID;g=g.tileID;return b.overscaledZ-g.overscaledZ||b.canonical.y-g.canonical.y||b.wrap-g.wrap||b.canonical.x-g.canonical.x}function Ib(b,g){b=b.feature;g=g.getFeatureState(b.layer["source-layer"],b.id);b.source=b.layer.source;b.layer["source-layer"]&&(b.sourceLayer=b.layer["source-layer"]);b.state=g}function Fb(b,
g,m){return v._(this,void 0,void 0,function*(){let u=b;if(b.url?u=(yield v.j(g.transformRequest(b.url,"Source"),m)).data:yield qd.frameAsync(m),!u)return null;const z=v.Q(v.e(u,b),"tiles minzoom maxzoom attribution bounds scheme tileSize encoding".split(" "));return"vector_layers"in u&&u.vector_layers&&(z.vectorLayerIds=u.vector_layers.map(C=>C.id)),z})}function zb(){return Wf||(Wf=new Zd),Wf}function lc(b,g){const m=v.ah(g.lat,-v.ai,v.ai);return new v.P(v.V(g.lng)*b,v.U(m)*b)}function bc(b,g){return(new v.a1(g.x/
b,g.y/b)).toLngLat()}function Hc(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(v.ae(90-b.pitch)),Math.tan(v.ae(89.25-b.pitch)))}function Jc(b,g){const m=b.canonical;g/=v.af(m.z);b=m.x+Math.pow(2,m.z)*b.wrap;const u=v.ag(new Float64Array(16));return v.M(u,u,[b*g,m.y*g,0]),v.N(u,u,[g/v.$,g/v.$,1]),u}function id(b,g,m,u,z){g=v.a1.fromLngLat(b,g);b=z*v.aj(1,b.lat);m=b*Math.cos(v.ae(m));z=Math.sqrt(b*b-m*m);b=z*Math.sin(v.ae(-u));u=z*Math.cos(v.ae(-u));return new v.a1(g.x+b,g.y+u,g.z+m)}function sd(b,
g,m){b=g.intersectsFrustum(b);if(!m||0===b)return b;g=g.intersectsPlane(m);return 0===g?0:2===b&&2===g?2:1}function Dc(b,g,m){let u=0;const z=(m-g)/10;for(let C=0;10>C;C++)u+=z*Math.pow(Math.cos(g+(C+.5)/10*(m-g)),b);return u}function dc(b,g){return function(m,u,z,C,G){const K=2*((b-1)/v.ak(Math.cos(v.ae(89.25-G))/Math.cos(v.ae(89.25)))-1);var R=Math.acos(z/C);const X=2*Dc(K-1,0,v.ae(G/2));var ca=Math.min(v.ae(89.25),R+v.ae(G/2));R=Dc(K-1,Math.min(ca,R-v.ae(G/2)),ca);ca=Math.atan(u/z);return m+=v.ak(C/
Math.hypot(u,z)/Math.max(.5,Math.cos(v.ae(G/2)))),m+=K*v.ak(Math.cos(ca))/2,m-=v.ak(Math.max(1,R/X/g))/2,m}}function xc(b,g){b=(g.roundZoom?Math.round:Math.floor)(b.zoom+v.ak(b.tileSize/g.tileSize));return Math.max(0,b)}function Nc(b,g){const m=b.getCameraFrustum(),u=b.getClippingPlane(),z=b.screenPointToMercatorCoordinate(b.getCameraPoint()),C=v.a1.fromLngLat(b.center,b.elevation);z.z=C.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const G=b.getCoveringTilesDetailsProvider(),
K=G.allowVariableZoom(b,g),R=xc(b,g),X=g.minzoom||0,ca=void 0!==g.maxzoom?g.maxzoom:b.maxZoom,ja=Math.min(Math.max(0,R),ca);var la=Math.pow(2,ja);const pa=[la*z.x,la*z.y,0];la=[la*C.x,la*C.y,0];const ya=Math.abs(C.z-z.z),Ba=Math.hypot(Math.hypot(C.x-z.x,C.y-z.y),ya);var za=Nb=>({zoom:0,x:0,y:0,wrap:Nb,fullyVisible:!1});const Ea=[],Qa=[];if(b.renderWorldCopies&&G.allowWorldCopies())for(var Za=1;3>=Za;Za++)Ea.push(za(-Za)),Ea.push(za(Za));for(Ea.push(za(0));0<Ea.length;){za=Ea.pop();Za=za.x;const Nb=
za.y;var sb=za.fullyVisible,ob={x:Za,y:Nb,z:za.zoom},eb=G.getTileBoundingVolume(ob,za.wrap,b.elevation,g);if(!sb){sb=sd(m,eb,u);if(0===sb)continue;sb=2===sb}var Db=G.distanceToTile2d(z.x,z.y,ob,eb);eb=R;K&&(eb=(g.calculateTileZoom||di)(b.zoom+v.ak(b.tileSize/g.tileSize),Db,ya,Ba,b.fov));eb=(g.roundZoom?Math.round:Math.floor)(eb);eb=Math.max(0,eb);Db=Math.min(eb,ca);if(za.wrap=G.getWrap(C,ob,za.wrap),za.zoom>=Db)za.zoom<X||(ob=ja-za.zoom,sb=pa[0]-.5-(Za<<ob),ob=pa[1]-.5-(Nb<<ob),eb=g.reparseOverscaled?
Math.max(za.zoom,eb):za.zoom,Qa.push({tileID:new v.Z(za.zoom===ca?eb:za.zoom,za.wrap,za.zoom,Za,Nb),distanceSq:v.al([la[0]-.5-Za,la[1]-.5-Nb]),tileDistanceToCamera:Math.sqrt(sb*sb+ob*ob)}));else for(eb=0;4>eb;eb++)Ea.push({zoom:za.zoom+1,x:(Za<<1)+eb%2,y:(Nb<<1)+(eb>>1),wrap:za.wrap,fullyVisible:sb})}return Qa.sort((Nb,Ob)=>Nb.distanceSq-Ob.distanceSq).map(Nb=>Nb.tileID)}function pd(b,g){const m=Math.abs(2*b.wrap)-+(0>b.wrap),u=Math.abs(2*g.wrap)-+(0>g.wrap);return b.overscaledZ-g.overscaledZ||u-
m||g.canonical.y-b.canonical.y||g.canonical.x-b.canonical.x}function Ic(b){return"raster"===b||"image"===b||"video"===b}function Rc(b,g){let m=!0;return"always"===b||"never"!==b&&"never"!==g||(m=!1),m}function Kb(b,g,m){const u=v.L();if(!b){const {vecSouth:ca,vecEast:ja}=jb(g);g=ta();g[0]=ja[0];g[1]=ja[1];g[2]=ca[0];g[3]=ca[1];b=g;(X=(C=(z=g)[0])*(R=z[3])-(K=z[2])*(G=z[1]))&&(b[0]=R*(X=1/X),b[1]=-G*X,b[2]=-K*X,b[3]=C*X);u[0]=g[0];u[1]=g[1];u[4]=g[2];u[5]=g[3]}var z,C,G,K,R,X;return v.N(u,u,[1/m,1/
m,1]),u}function Ma(b,g,m,u){if(b){b=v.L();if(!g){const {vecSouth:z,vecEast:C}=jb(m);b[0]=C[0];b[1]=C[1];b[4]=z[0];b[5]=z[1]}return v.N(b,b,[u,u,1]),b}return m.pixelsToClipSpaceMatrix}function jb(b){var g=Math.cos(b.rollInRadians);const m=Math.sin(b.rollInRadians),u=Math.cos(b.pitchInRadians),z=Math.cos(b.bearingInRadians),C=Math.sin(b.bearingInRadians);b=v.ar();b[0]=-z*u*m-C*g;b[1]=-C*u*m+z*g;var G=v.as(b);1E-9>G?v.at(b):v.au(b,b,1/G);G=v.ar();G[0]=z*u*g-C*m;G[1]=C*u*g+z*m;g=v.as(G);return 1E-9>
g?v.at(G):v.au(G,G,1/g),{vecEast:G,vecSouth:b}}function sc(b,g,m,u){let z;u?(z=[b,g,u(b,g),1],v.aw(z,z,m)):(z=[b,g,0,1],gf(z,z,m));b=z[3];return{point:new v.P(z[0]/b,z[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}function Ac(b,g,m,u,z,C,G,K,R,X,ca,ja,la){const pa=m?b.textSizeData:b.iconSizeData,ya=v.an(pa,g.transform.zoom),Ba=[256/g.width*2+1,256/g.height*2+1],za=m?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;za.clear();const Ea=b.lineVertexArray,Qa=m?b.text.placedSymbolArray:
b.icon.placedSymbolArray,Za=g.transform.width/g.transform.height;var sb=!1;for(let Nb=0;Nb<Qa.length;Nb++){const Ob=Qa.get(Nb);if(Ob.hidden||Ob.writingMode===v.ao.vertical&&!sb)qe(Ob.numGlyphs,za);else{sb=!1;var ob=new v.P(Ob.anchorX,Ob.anchorY);ob={getElevation:la,pitchedLabelPlaneMatrix:u,lineVertexArray:Ea,pitchWithMap:C,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:g.transform,tileAnchorPoint:ob,unwrappedTileID:R,width:X,height:ca,translation:ja};
var eb=ob.transform.projectTileCoordinates(Ob.anchorX,Ob.anchorY,ob.unwrappedTileID,ob.getElevation),Db=eb.point;Db.x>=-Ba[0]&&Db.x<=Ba[0]&&Db.y>=-Ba[1]&&Db.y<=Ba[1]?(sb=.5+g.transform.cameraToCenterDistance/eb.signedDistanceFromCamera*.5,Db=v.ap(pa,ya,Ob),Db=C?Db*g.transform.getPitchedTextCorrection(Ob.anchorX,Ob.anchorY,R)/sb:Db*sb,eb=Vc({projectionContext:ob,pitchedLabelPlaneMatrixInverse:z,symbol:Ob,fontSize:Db,flip:!1,keepUpright:G,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:za,
aspectRatio:Za,rotateToLine:K}),sb=eb.useVertical,(eb.notEnoughRoom||sb||eb.needsFlipping&&Vc({projectionContext:ob,pitchedLabelPlaneMatrixInverse:z,symbol:Ob,fontSize:Db,flip:!0,keepUpright:G,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:za,aspectRatio:Za,rotateToLine:K}).notEnoughRoom)&&qe(Ob.numGlyphs,za)):qe(Ob.numGlyphs,za)}}m?b.text.dynamicLayoutVertexBuffer.updateData(za):b.icon.dynamicLayoutVertexBuffer.updateData(za)}function Tc(b,g,m,u,z,C,G,K){const R=C.glyphStartIndex+C.numGlyphs,
X=C.lineStartIndex,ca=C.lineStartIndex+C.lineLength;var ja=g.getoffsetX(C.glyphStartIndex);g=g.getoffsetX(R-1);ja=pe(b*ja,m,u,z,C.segment,X,ca,K,G);return ja?(b=pe(b*g,m,u,z,C.segment,X,ca,K,G))?K.projectionCache.anyProjectionOccluded?null:{first:ja,last:b}:null:null}function od(b,g,m,u){return b===v.ao.horizontal&&Math.abs(m.y-g.y)>Math.abs(m.x-g.x)*u?{useVertical:!0}:(b===v.ao.vertical?g.y<m.y:g.x>m.x)?{needsFlipping:!0}:null}function Vc(b){const {projectionContext:g,pitchedLabelPlaneMatrixInverse:m,
symbol:u,fontSize:z,flip:C,keepUpright:G,glyphOffsetArray:K,dynamicLayoutVertexArray:R,aspectRatio:X,rotateToLine:ca}=b;b=z/24;const ja=u.lineOffsetX*b,la=u.lineOffsetY*b;if(1<u.numGlyphs){var pa=u.glyphStartIndex+u.numGlyphs,ya=u.lineStartIndex,Ba=u.lineStartIndex+u.lineLength;const Qa=Tc(b,K,ja,la,C,u,ca,g);if(!Qa)return{notEnoughRoom:!0};var za=Cd(Qa.first.point.x,Qa.first.point.y,g,m);var Ea=Cd(Qa.last.point.x,Qa.last.point.y,g,m);if(G&&!C&&(za=od(u.writingMode,za,Ea,X)))return za;za=[Qa.first];
for(Ea=u.glyphStartIndex+1;Ea<pa-1;Ea++){const Za=pe(b*K.getoffsetX(Ea),ja,la,C,u.segment,ya,Ba,g,ca);if(!Za)return{notEnoughRoom:!0};za.push(Za)}za.push(Qa.last)}else{if(G&&!C&&(pa=td(g.tileAnchorPoint.x,g.tileAnchorPoint.y,g).point,ya=u.lineStartIndex+u.segment+1,ya=new v.P(g.lineVertexArray.getx(ya),g.lineVertexArray.gety(ya)),Ba=td(ya.x,ya.y,g),ya=0<Ba.signedDistanceFromCamera?Ba.point:yc(g.tileAnchorPoint,ya,pa,1,g),pa=Cd(pa.x,pa.y,g,m),ya=Cd(ya.x,ya.y,g,m),pa=od(u.writingMode,pa,ya,X)))return pa;
b=pe(b*K.getoffsetX(u.glyphStartIndex),ja,la,C,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,g,ca);if(!b||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};za=[b]}for(const Qa of za)v.av(R,Qa.point,Qa.angle);return{}}function yc(b,g,m,u,z){b=b.add(b.sub(g)._unit());z=td(b.x,b.y,z).point;z=m.sub(z);return m.add(z._mult(u/z.mag()))}function Pc(b,g,m){const u=g.projectionCache;if(u.projections[b])return u.projections[b];const z=new v.P(g.lineVertexArray.getx(b),g.lineVertexArray.gety(b)),
C=td(z.x,z.y,g);if(0<C.signedDistanceFromCamera)return u.projections[b]=C.point,u.anyProjectionOccluded=u.anyProjectionOccluded||C.isOccluded,C.point;b-=m.direction;return yc(0===m.distanceFromAnchor?g.tileAnchorPoint:new v.P(g.lineVertexArray.getx(b),g.lineVertexArray.gety(b)),z,m.previousVertex,m.absOffsetX-m.distanceFromAnchor+1,g)}function td(b,g,m){b+=m.translation[0];g+=m.translation[1];let u;return m.pitchWithMap?(u=sc(b,g,m.pitchedLabelPlaneMatrix,m.getElevation),u.isOccluded=!1):(u=m.transform.projectTileCoordinates(b,
g,m.unwrappedTileID,m.getElevation),u.point.x=(.5*u.point.x+.5)*m.width,u.point.y=(.5*-u.point.y+.5)*m.height),u}function Cd(b,g,m,u){return m.pitchWithMap?(b=[b,g,0,1],v.aw(b,b,u),m.transform.projectTileCoordinates(b[0]/b[3],b[1]/b[3],m.unwrappedTileID,m.getElevation).point):{x:b/m.width*2-1,y:1-g/m.height*2}}function Gd(b,g,m){return b._unit()._perp()._mult(g*m)}function pe(b,g,m,u,z,C,G,K,R){var X=u?b-g:b+g;g=0<X?1:-1;b=0;u&&(g*=-1,b=Math.PI);0>g&&(b+=Math.PI);var ca;z=0<g?C+z:C+z+1;K.projectionCache.cachedAnchorPoint?
ca=K.projectionCache.cachedAnchorPoint:(ca=td(K.tileAnchorPoint.x,K.tileAnchorPoint.y,K).point,K.projectionCache.cachedAnchorPoint=ca);let ja;u=ca;let la=0;var pa=0;const ya=Math.abs(X);X=[];for(var Ba;la+pa<=ya;){if(z+=g,z<C||z>=G)return null;la+=pa;ca=u;ja=Ea;var za={absOffsetX:ya,direction:g,distanceFromAnchor:la,previousVertex:ca};if(u=Pc(z,K,za),0===m)X.push(ca),Ba=u.sub(ca);else{var Ea=u.sub(ca);Ba=0===Ea.mag()?Gd(Pc(z+g,K,za).sub(u),m,g):Gd(Ea,m,g);ja||(ja=ca.add(Ba));Ea=z;var Qa=Ba,Za=u,sb=
C,ob=G;Ba=ja;var eb=m;pa=K;pa.projectionCache.offsets[Ea]?Ea=pa.projectionCache.offsets[Ea]:(Qa=Za.add(Qa),Ea+za.direction<sb||Ea+za.direction>=ob?Ea=(pa.projectionCache.offsets[Ea]=Qa,Qa):(sb=Pc(Ea+za.direction,pa,za),za=Gd(sb.sub(Za),eb,za.direction),Za=Za.add(za),za=sb.add(za),Ea=(pa.projectionCache.offsets[Ea]=v.ax(Ba,Qa,Za,za)||Qa,pa.projectionCache.offsets[Ea])));X.push(ja);Ba=Ea.sub(ja)}pa=Ba.mag()}m=Ba._mult((ya-la)/pa)._add(ja||ca);C=b+Math.atan2(u.y-ca.y,u.x-ca.x);return X.push(m),{point:m,
angle:R?C:0,path:X}}function qe(b,g){for(let m=0;m<b;m++){const u=g.length;g.resize(u+4);g.float32.set(th,3*u)}}function gf(b,g,m){const u=g[0];g=g[1];return b[0]=m[0]*u+m[4]*g+m[12],b[1]=m[1]*u+m[5]*g+m[13],b[3]=m[3]*u+m[7]*g+m[15],b}function da(b,g,m,u,z){const {horizontalAlign:C,verticalAlign:G}=v.aH(b);return new v.P(-(C-.5)*g+u[0]*z,-(G-.5)*m+u[1]*z)}function J(b,g,m,u,z,C){u&&0!==u.length||(u=[0,0,0,0]);const G=u[0]-100,K=u[1]-100,R=u[2]-100;u=u[3]-100;b.emplaceBack(g?1:0,m?1:0,z||0,C||0,G,
K);b.emplaceBack(g?1:0,m?1:0,z||0,C||0,R,K);b.emplaceBack(g?1:0,m?1:0,z||0,C||0,R,u);b.emplaceBack(g?1:0,m?1:0,z||0,C||0,G,u)}function O(b){if(0===b.opacity&&!b.placed)return 0;if(1===b.opacity&&b.placed)return 4294967295;const g=b.placed?1:0;b=Math.floor(127*b.opacity);return b*Yf+g*Ge+b*Bf+g*Ne+b*Ig+g*Jg+b*bh+g}function W(b,g){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=g.match(/in ([\w]+) ([\w]+)/g);var z=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g);const C=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g);
z=C?C.concat(z):z;const G={};return{fragmentSource:b=b.replace(m,(K,R,X,ca,ja)=>(G[ja]=!0,"define"===R?`\n#ifndef HAS_UNIFORM_u_${ja}\nin ${X} ${ca} ${ja};\n#else\nuniform ${X} ${ca} u_${ja};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${ja}\n    ${X} ${ca} ${ja} = u_${ja};\n#endif\n`)),vertexSource:g=g.replace(m,(K,R,X,ca,ja)=>{K="float"===ca?"vec2":"vec4";const la=ja.match(/color/)?"color":K;return G[ja]?"define"===R?`\n#ifndef HAS_UNIFORM_u_${ja}\nuniform lowp float u_${ja}_t;\nin ${X} ${K} a_${ja};\nout ${X} ${ca} ${ja};\n#else\nuniform ${X} ${ca} u_${ja};\n#endif\n`:
"vec4"===la?`\n#ifndef HAS_UNIFORM_u_${ja}\n    ${ja} = a_${ja};\n#else\n    ${X} ${ca} ${ja} = u_${ja};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ja}\n    ${ja} = unpack_mix_${la}(a_${ja}, u_${ja}_t);\n#else\n    ${X} ${ca} ${ja} = u_${ja};\n#endif\n`:"define"===R?`\n#ifndef HAS_UNIFORM_u_${ja}\nuniform lowp float u_${ja}_t;\nin ${X} ${K} a_${ja};\n#else\nuniform ${X} ${ca} u_${ja};\n#endif\n`:"vec4"===la?`\n#ifndef HAS_UNIFORM_u_${ja}\n    ${X} ${ca} ${ja} = a_${ja};\n#else\n    ${X} ${ca} ${ja} = u_${ja};\n#endif\n`:
`\n#ifndef HAS_UNIFORM_u_${ja}\n    ${X} ${ca} ${ja} = unpack_mix_${la}(a_${ja}, u_${ja}_t);\n#else\n    ${X} ${ca} ${ja} = u_${ja};\n#endif\n`}),staticAttributes:u,staticUniforms:z}}function S(b,g){b.renderWorldCopies&&!b.lngRange&&(b=g.lng-b.center.lng,g.lng+=180<b?-360:-180>b?360:0)}function fa(){v.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ra(b){if(b.useSlerp)if(1>b.k){var g=v.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing);
const m=v.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),u=new Float64Array(4);v.bc(u,g,m,b.k);g=v.bd(u);b.tr.setRoll(g.roll);b.tr.setPitch(g.pitch);b.tr.setBearing(g.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(v.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(v.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(v.C.number(b.startEulerAngles.bearing,
b.endEulerAngles.bearing,b.k))}function ma(b,g,m,u,z){var C=z.padding;const G=lc(z.worldSize,m.getNorthWest());var K=lc(z.worldSize,m.getNorthEast());const R=lc(z.worldSize,m.getSouthEast());var X=lc(z.worldSize,m.getSouthWest()),ca=v.ae(-u);m=G.rotate(ca);K=K.rotate(ca);const ja=R.rotate(ca);ca=X.rotate(ca);X=new v.P(Math.max(m.x,K.x,ca.x,ja.x),Math.max(m.y,K.y,ca.y,ja.y));m=new v.P(Math.min(m.x,K.x,ca.x,ja.x),Math.min(m.y,K.y,ca.y,ja.y));K=X.sub(m);m=(z.width-(C.left+C.right+g.left+g.right))/K.x;
C=(z.height-(C.top+C.bottom+g.top+g.bottom))/K.y;if(0>C||0>m)return void fa();C=Math.min(v.ak(z.scale*Math.min(m,C)),b.maxZoom);b=v.P.convert(b.offset);g=(new v.P((g.left-g.right)/2,(g.top-g.bottom)/2)).rotate(v.ae(u));g=b.add(g).mult(z.scale/v.af(C));return{center:bc(z.worldSize,G.add(R).div(2).sub(g)),zoom:C,bearing:u}}function ua(b){var g;if(ee.has(b))return ee.get(b);const m=null===(g=b.getParameter(b.VERSION))||void 0===g?void 0:g.startsWith("WebGL 2.0");return ee.set(b,m),m}function Aa(b,g){var m=
void 0!==b.granularity?Math.max(b.granularity,1):1;const u=m+(b.generateBorders?2:0),z=m+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),C=u+1;var G=z+1,K=b.generateBorders?-1:0,R=b.generateBorders||b.extendToNorthPole?-1:0,X=m+(b.generateBorders?1:0),ca=m+(b.generateBorders||b.extendToSouthPole?1:0),ja=u*z*6,la=65536<C*G;if(la&&"16bit"===g)throw Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");g=la||"32bit"===g;G=new Int16Array(2*
C*G);for(la=0;R<=ca;R++)for(let pa=K;pa<=X;pa++){let ya=pa/m*v.$;-1===pa&&(ya=-Ze);pa===m+1&&(ya=v.$+Ze);let Ba=R/m*v.$;-1===R&&(Ba=b.extendToNorthPole?v.bh:-Ze);R===m+1&&(Ba=b.extendToSouthPole?v.bi:v.$+Ze);G[la++]=ya;G[la++]=Ba}b=g?new Uint32Array(ja):new Uint16Array(ja);m=0;for(K=0;K<z;K++)for(X=0;X<u;X++)ca=X+1+K*C,ja=X+(K+1)*C,la=X+1+(K+1)*C,b[m++]=X+K*C,b[m++]=ja,b[m++]=ca,b[m++]=ca,b[m++]=ja,b[m++]=la;return{vertices:G.buffer.slice(0),indices:b.buffer.slice(0),uses32bitIndices:g}}function Ua(b){b=
Rb(b.worldSize,b.center.lat);return 2*Math.PI*b}function fb(b,g,m,u,z){z=1/(1<<z);g=g/v.$*z+u*z;b=v.bo((b/v.$*z+m*z)*Math.PI*2+Math.PI,2*Math.PI);m=2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI;g=Math.cos(m);u=new Float64Array(3);return u[0]=Math.sin(b)*g,u[1]=Math.sin(m),u[2]=Math.cos(b)*g,u}function pb(b){var g=b.lng*Math.PI/180;b=b.lat*Math.PI/180;const m=Math.cos(b),u=new Float64Array(3);return u[0]=Math.sin(g)*m,u[1]=Math.sin(b),u[2]=Math.cos(g)*m,u}function Rb(b,g){return b/(2*Math.PI)/
Math.cos(g*Math.PI/180)}function ec(b){const g=Math.asin(b[1])/Math.PI*180,m=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(1E-6<m){const u=Math.acos(b[2]/m);return new v.S(v.aO((0<b[0]/m?u:-u)/Math.PI*180,-180,180),g)}return new v.S(0,g)}function kc(b){return Math.cos(b*Math.PI/180)}function fc(b,g){b=kc(b);g=kc(g);return v.ak(g/b)}function Gc(b,g){b=b.rotate(g.bearingInRadians);var m=g.zoom+fc(g.center.lat,0);m=v.bk(1/kc(g.center.lat),1/kc(Math.min(Math.abs(g.center.lat),60)),v.bn(m,7,3,0,1));const u=360/Ua({worldSize:g.worldSize,
center:{lat:g.center.lat}});return new v.S(g.center.lng-b.x*u*m,v.ah(g.center.lat+b.y*u,-v.ai,v.ai))}function Fc(b){var g=.5*b;b=Math.sin(g);g=Math.cos(g);return Math.log(b+g)-Math.log(g-b)}function Hd(b,g,m,u){const z=b.lat+m*u;if(1<Math.abs(m)){var C=(Math.sign(b.lat+m)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180;m=Math.abs(b.lat+m)*Math.PI/180;u=Fc(C+u*(m-C));C=Fc(C);m=Fc(m);return new v.S(b.lng+(u-C)/(m-C)*g,z)}return new v.S(b.lng+g*u,z)}function de(b,g,m){b-=g;return 0>
b?-b:Math.max(0,b-m)}function Me(b,g,m,u,z){b-=m;let C;return C=0>b?Math.min(-b,1+b-z):1<b?Math.min(Math.max(b-z,0),1-b):0,Math.max(C,de(g,u,z))}function zg(b,g){let m=1/0,u=-1/0;for(const z of g)g=v.aX(b,z),m=Math.min(m,g),u=Math.max(u,g);return{min:m,max:u}}function Kf(b){const g=[];for(let m=0;m<b.length;m++){if(null===b[m])continue;const u=b[m].split(" ");g.push(u.pop())}return g}function Lf(b,g,m){const u=1/v.aC(m,1,g.transform.tileZoom);var z=Math.pow(2,m.tileID.overscaledZ);g=m.tileSize*Math.pow(2,
g.transform.tileZoom)/z;z=g*(m.tileID.canonical.x+m.tileID.wrap*z);g*=m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[u,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[z>>16,g>>16],u_pixel_coord_lower:[65535&z,65535&g]}}function Ag(b,g,m){return v.aD(b.transform,g,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function Vi(b,g,m,u,z){const C=b.context;var G=b.transform;const K=C.gl;var R=b.useProgram("collisionBox"),X=[],ca=0,ja=0;for(var la=
0;la<u.length;la++){var pa=u[la],ya=g.getTile(pa).getBucket(m);if(!ya)continue;const eb=z?ya.textCollisionBox:ya.iconCollisionBox;ya=ya.collisionCircleArray;0<ya.length&&(X.push({circleArray:ya,circleOffset:ja,coord:pa}),ca+=ya.length/4,ja=ca);if(eb){ya=R;var Ba=ya.draw,za=K.LINES,Ea=ed.disabled,Qa=Jd.disabled,Za=b.colorModeForRenderPass(),sb=b.transform;Ba.call(ya,C,za,Ea,Qa,Za,dd.disabled,{u_pixel_extrude_scale:[1/sb.width,1/sb.height]},b.style.map.terrain&&b.style.map.terrain.getTerrainData(pa),
G.getProjectionData({overscaledTileID:pa,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),m.id,eb.layoutVertexBuffer,eb.indexBuffer,eb.segments,null,b.transform.zoom,null,null,eb.collisionVertexBuffer)}}if(z&&X.length){g=b.useProgram("collisionCircle");u=new v.c0;u.resize(4*ca);u._trim();z=0;for(var ob of X)for(G=0;G<ob.circleArray.length/4;G++)pa=4*G,R=ob.circleArray[pa+0],ja=ob.circleArray[pa+1],la=ob.circleArray[pa+2],pa=ob.circleArray[pa+3],u.emplace(z++,R,ja,la,pa,0),u.emplace(z++,R,ja,la,pa,1),u.emplace(z++,
R,ja,la,pa,2),u.emplace(z++,R,ja,la,pa,3);if(!N||N.length<2*ca){ca*=2;ob=new v.c2;ob.resize(ca);ob._trim();for(z=0;z<ca;z++)G=6*z,ob.uint16[G+0]=4*z,ob.uint16[G+1]=4*z+1,ob.uint16[G+2]=4*z+2,ob.uint16[G+3]=4*z+2,ob.uint16[G+4]=4*z+3,ob.uint16[G+5]=4*z;N=ob}ca=C.createIndexBuffer(N,!0);ob=C.createVertexBuffer(u,v.c1.members,!0);for(const eb of X)X=b.transform,X={u_viewport_size:[X.width,X.height]},g.draw(C,K.TRIANGLES,ed.disabled,Jd.disabled,b.colorModeForRenderPass(),dd.disabled,X,b.style.map.terrain&&
b.style.map.terrain.getTerrainData(eb.coord),null,m.id,ob,ca,v.aM.simpleSegment(0,2*eb.circleOffset,eb.circleArray.length,eb.circleArray.length/2),null,b.transform.zoom,null,null,null);ob.destroy();ca.destroy()}}function qi(b,g,m,u,z,C,G,K,R,X,ca,ja){const la=b.text.placedSymbolArray,pa=b.text.dynamicLayoutVertexArray,ya=b.icon.dynamicLayoutVertexArray,Ba={};pa.clear();for(let Nb=0;Nb<la.length;Nb++){const Ob=la.get(Nb);var za=Ob.hidden||!Ob.crossTileID||b.allowVerticalPlacement&&!Ob.placedOrientation?
null:u[Ob.crossTileID];if(za){var Ea=new v.P(Ob.anchorX,Ob.anchorY),Qa={getElevation:ja,width:z.width,height:z.height,pitchedLabelPlaneMatrix:C,pitchWithMap:m,transform:z,tileAnchorPoint:Ea,translation:X,unwrappedTileID:ca},Za=m?Qa.transform.projectTileCoordinates(Ea.x,Ea.y,Qa.unwrappedTileID,Qa.getElevation):td(Ea.x,Ea.y,Qa),sb=.5+z.cameraToCenterDistance/Za.signedDistanceFromCamera*.5,ob=v.ap(b.textSizeData,K,Ob)*sb/v.aB;m&&(ob*=b.tilePixelRatio/G);const {width:Jb,height:$b,anchor:vc,textOffset:Bb,
textBoxScale:Yc}=za;za=Jb;sb=$b;var eb=Bb,Db=Yc;const {horizontalAlign:md,verticalAlign:Bd}=v.aH(vc);sb=new v.P((-(md-.5)*za/Db+eb[0])*ob,(-(Bd-.5)*sb/Db+eb[1])*ob);Ea=z.getPitchedTextCorrection(Ea.x+X[0],Ea.y+X[1],ca);Za=Za.point;za=g;eb=-z.bearingInRadians;Db=Qa.tileAnchorPoint.add(new v.P(Qa.translation[0],Qa.translation[1]));Qa.pitchWithMap?(Za=sb.mult(Ea),za||(Za=Za.rotate(-eb)),Za=Db.add(Za),Qa=sc(Za.x,Za.y,Qa.pitchedLabelPlaneMatrix,Qa.getElevation).point):za?(Qa=td(Qa.tileAnchorPoint.x+1,
Qa.tileAnchorPoint.y,Qa).point.sub(Za),Qa=Za.add(sb.rotate(Math.atan(Qa.y/Qa.x)+(0>Qa.x?Math.PI:0)))):Qa=Za.add(sb);Za=b.allowVerticalPlacement&&Ob.placedOrientation===v.ao.vertical?Math.PI/2:0;for(Ea=0;Ea<Ob.numGlyphs;Ea++)v.av(pa,Qa,Za);R&&0<=Ob.associatedIconIndex&&(Ba[Ob.associatedIconIndex]={shiftedAnchor:Qa,angle:Za})}else qe(Ob.numGlyphs,pa)}if(R){ya.clear();g=b.icon.placedSymbolArray;for(m=0;m<g.length;m++)if(u=g.get(m),u.hidden)qe(u.numGlyphs,ya);else if(z=Ba[m])for(C=0;C<u.numGlyphs;C++)v.av(ya,
z.shiftedAnchor,z.angle);else qe(u.numGlyphs,ya);b.icon.dynamicLayoutVertexBuffer.updateData(ya)}b.text.dynamicLayoutVertexBuffer.updateData(pa)}function re(b,g,m,u,z,C,G,K,R,X,ca,ja,la){const pa=b.context,ya=pa.gl,Ba=b.transform,za="map"===K;R="map"===R;const Ea="viewport"!==K&&"point"!==m.layout.get("symbol-placement"),Qa=za&&!R&&!Ea,Za=!m.layout.get("symbol-sort-key").isConstant();let sb=!1;K=b.getDepthModeForSublayer(0,ed.ReadOnly);const ob=m._unevaluatedLayout.hasValue("text-variable-anchor")||
m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),eb=[],Db=Ba.getCircleRadiusCorrection();for(const fd of u){var Nb=g.getTile(fd);u=Nb.getBucket(m);if(!u)continue;const ud=z?u.text:u.icon;if(!ud||!ud.segments.get().length||!ud.hasVisibleVertices)continue;var Ob=ud.programConfigurations.get(m.id),Jb=z||u.sdfIcons,$b=z?u.textSizeData:u.iconSizeData,vc=R||0!==Ba.pitch;const le=b.useProgram(u.iconsInText&&z?"symbolTextAndIcon":Jb?"symbolSDF":"symbolIcon",Ob),wd=v.an($b,Ba.zoom);Ob=b.style.map.terrain&&
b.style.map.terrain.getTerrainData(fd);let Fd,Df;var Bb=void 0;let ff,we=[0,0],ie=null;z?(Df=Nb.glyphAtlasTexture,Bb=ya.LINEAR,Fd=Nb.glyphAtlasTexture.size,u.iconsInText&&(we=Nb.imageAtlasTexture.size,ie=Nb.imageAtlasTexture,ff=vc||b.options.rotating||b.options.zooming||"composite"===$b.kind||"camera"===$b.kind?ya.LINEAR:ya.NEAREST)):(Bb=1!==m.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear,Df=Nb.imageAtlasTexture,Bb=Jb||b.options.rotating||b.options.zooming||Bb||vc?ya.LINEAR:ya.NEAREST,
Fd=Nb.imageAtlasTexture.size);vc=v.aC(Nb,1,b.transform.zoom);var Yc=Kb(za,b.transform,vc),md=v.L();v.aq(md,Yc);vc=Ma(R,za,b.transform,vc);const oe=v.aD(Ba,Nb,C,G);Nb=Ba.getProjectionData({overscaledTileID:fd,applyGlobeMatrix:!la,applyTerrainMatrix:!0});var Bd=ob&&u.hasTextData();Bd="none"!==m.layout.get("icon-text-fit")&&Bd&&u.hasIconData();if(Ea){const ce=b.style.map.terrain?($i,xf)=>b.style.map.terrain.getElevation(fd,$i,xf):null,pf="map"===m.layout.get("text-rotation-alignment");Ac(u,b,z,Yc,md,
R,X,pf,fd.toUnwrapped(),Ba.width,Ba.height,oe,ce)}md=z&&ob||Bd;Bd=Ea||md?U:R?Yc:b.transform.clipSpaceToPixelsMatrix;Yc=Jb&&0!==m.paint.get(z?"text-halo-width":"icon-halo-width").constantOr(1);$b=Jb?u.iconsInText?zj($b.kind,wd,Qa,R,Ea,md,b,Bd,vc,oe,Fd,we,Db):hi($b.kind,wd,Qa,R,Ea,md,b,Bd,vc,oe,z,Fd,0,Db):gi($b.kind,wd,Qa,R,Ea,md,b,Bd,vc,oe,z,Fd,Db);Jb={program:le,buffers:ud,uniformValues:$b,projectionData:Nb,atlasTexture:Df,atlasTextureIcon:ie,atlasInterpolation:Bb,atlasInterpolationIcon:ff,isSDF:Jb,
hasHalo:Yc};if(Za&&u.canOverlap){sb=!0;u=ud.segments.get();for(const ce of u)eb.push({segments:new v.aM([ce]),sortKey:ce.sortKey,state:Jb,terrainData:Ob})}else eb.push({segments:ud.segments,sortKey:0,state:Jb,terrainData:Ob})}sb&&eb.sort((fd,ud)=>fd.sortKey-ud.sortKey);for(const fd of eb){g=fd.state;if(pa.activeTexture.set(ya.TEXTURE0),g.atlasTexture.bind(g.atlasInterpolation,ya.CLAMP_TO_EDGE),g.atlasTextureIcon&&(pa.activeTexture.set(ya.TEXTURE1),g.atlasTextureIcon&&g.atlasTextureIcon.bind(g.atlasInterpolationIcon,
ya.CLAMP_TO_EDGE)),g.isSDF)z=g.uniformValues,g.hasHalo&&(z.u_is_halo=1,Eh(g.buffers,fd.segments,m,b,g.program,K,ca,ja,z,g.projectionData,fd.terrainData)),z.u_is_halo=0;Eh(g.buffers,fd.segments,m,b,g.program,K,ca,ja,g.uniformValues,g.projectionData,fd.terrainData)}}function Eh(b,g,m,u,z,C,G,K,R,X,ca){const ja=u.context;z.draw(ja,ja.gl.TRIANGLES,C,G,K,dd.backCCW,R,ca,X,m.id,b.layoutVertexBuffer,b.indexBuffer,g,m.paint,u.transform.zoom,b.programConfigurations.get(m.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}
function ok(b,g,m,u,z){const C=b.context,G=C.gl,K=Jd.disabled,R=new Md([G.ONE,G.ONE],v.bf.transparent,[!0,!0,!0,!0]),X=g.getBucket(m);if(X){var ca=u.key,ja=m.heatmapFbos.get(ca);ja||(ja=qj(C,g.tileSize,g.tileSize),m.heatmapFbos.set(ca,ja));C.bindFramebuffer.set(ja.framebuffer);C.viewport.set([0,0,g.tileSize,g.tileSize]);C.clear({color:v.bf.transparent});ca=X.programConfigurations.get(m.id);z=b.useProgram("heatmap",ca,!z);ja=b.transform.getProjectionData({overscaledTileID:g.tileID,applyGlobeMatrix:!0,
applyTerrainMatrix:!0});u=b.style.map.terrain.getTerrainData(u);z.draw(C,G.TRIANGLES,ed.disabled,K,R,dd.disabled,Pg(g,b.transform.zoom,m.paint.get("heatmap-intensity"),1),u,ja,m.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,m.paint,b.transform.zoom,ca)}}function Nj(b,g,m,u,z){const C=b.context,G=C.gl,K=b.transform;C.setColorMode(b.colorModeForRenderPass());const R=Ui(C,g),X=m.key,ca=g.heatmapFbos.get(X);ca&&(C.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,ca.colorAttachment.get()),C.activeTexture.set(G.TEXTURE1),
R.bind(G.LINEAR,G.CLAMP_TO_EDGE),m=K.getProjectionData({overscaledTileID:m,applyTerrainMatrix:z,applyGlobeMatrix:!u}),b.useProgram("heatmapTexture").draw(C,G.TRIANGLES,ed.disabled,Jd.disabled,b.colorModeForRenderPass(),dd.disabled,Gi(b,g,0,1),null,m,g.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,g.paint,K.zoom),ca.destroy(),g.heatmapFbos.delete(X))}function qj(b,g,m){var u,z;const C=b.gl,G=C.createTexture();C.bindTexture(C.TEXTURE_2D,G);C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,
C.CLAMP_TO_EDGE);C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE);C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.LINEAR);C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.LINEAR);const K=null!==(u=b.HALF_FLOAT)&&void 0!==u?u:C.UNSIGNED_BYTE;u=null!==(z=b.RGBA16F)&&void 0!==z?z:C.RGBA;C.texImage2D(C.TEXTURE_2D,0,u,g,m,0,C.RGBA,K,null);b=b.createFramebuffer(g,m,!1,!1);return b.colorAttachment.set(G),b}function Ui(b,g){return g.colorRampTexture||(g.colorRampTexture=new v.T(b,g.colorRamp,
b.gl.RGBA)),g.colorRampTexture}function mh(b,g,m,u,z,C,G,K){let R=256;z.stepInterpolant&&(g=g.getSource().maxzoom,R=v.ah(v.c4(C.maxLineLength/v.$*1024*(G.canonical.z===g?Math.ceil(1<<b.transform.maxZoom-G.canonical.z):1)),256,m.maxTextureSize));return K.gradient=v.c5({expression:z.gradientExpression(),evaluationKey:"lineProgress",resolution:R,image:K.gradient||void 0,clips:C.lineClipsArray}),K.texture?K.texture.update(K.gradient):K.texture=new v.T(m,K.gradient,u.RGBA),K.version=z.gradientVersion,
K.texture}function ri(b,g,m,u,z){if(m&&u&&u.imageAtlas){u=u.imageAtlas.patternPositions;var C=u[m.to.toString()];m=u[m.from.toString()];(!C&&m&&(C=m),!m&&C&&(m=C),C&&m)||(g=z.getPaintProperty(g),C=u[g],m=u[g]);C&&m&&b.setConstantPatternPositions(C,m)}}function Bg(b,g,m,u,z,C,G,K){const R=b.context.gl;var X=m.paint.get("fill-pattern");const ca=X&&X.constantOr(1),ja=m.getCrossfadeParameters();let la,pa;let ya;const Ba=b.transform,za=m.paint.get("fill-translate"),Ea=m.paint.get("fill-translate-anchor");
G?(pa=ca&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",la=R.LINES):(pa=ca?"fillPattern":"fill",la=R.TRIANGLES);X=X.constantOr(null);for(const sb of u){var Qa=g.getTile(sb);if(ca&&!Qa.patternsLoaded())continue;const ob=Qa.getBucket(m);if(!ob)continue;const eb=ob.programConfigurations.get(m.id),Db=b.useProgram(pa,eb),Nb=b.style.map.terrain&&b.style.map.terrain.getTerrainData(sb);ca&&(b.context.activeTexture.set(R.TEXTURE0),Qa.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),
eb.updatePaintBuffers(ja));ri(eb,"fill-pattern",X,Qa,m);const Ob=Ba.getProjectionData({overscaledTileID:sb,applyGlobeMatrix:!K,applyTerrainMatrix:!0});var Za=v.aD(Ba,Qa,za,Ea);if(G){u=ob.indexBuffer2;ya=ob.segments2;const Jb=[R.drawingBufferWidth,R.drawingBufferHeight];Qa="fillOutlinePattern"===pa&&ca?v.e(v.e(Lf(ja,b,Qa),{u_fill_translate:Za}),{u_world:Jb}):{u_world:Jb,u_fill_translate:Za}}else u=ob.indexBuffer,ya=ob.segments,Qa=ca?v.e(Lf(ja,b,Qa),{u_fill_translate:Za}):{u_fill_translate:Za};Za=b.stencilModeForClipping(sb);
Db.draw(b.context,la,z,Za,C,dd.backCCW,Qa,Nb,Ob,m.id,ob.layoutVertexBuffer,u,ya,m.paint,b.transform.zoom,eb)}}function Cg(b,g,m,u,z,C,G,K){const R=b.context,X=R.gl;var ca=m.paint.get("fill-extrusion-pattern");const ja=ca.constantOr(1),la=m.getCrossfadeParameters(),pa=m.paint.get("fill-extrusion-opacity");ca=ca.constantOr(null);const ya=b.transform;for(const za of u){const Ea=g.getTile(za);u=Ea.getBucket(m);if(!u)continue;const Qa=b.style.map.terrain&&b.style.map.terrain.getTerrainData(za),Za=u.programConfigurations.get(m.id),
sb=b.useProgram(ja?"fillExtrusionPattern":"fillExtrusion",Za);ja&&(b.context.activeTexture.set(X.TEXTURE0),Ea.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Za.updatePaintBuffers(la));const ob=ya.getProjectionData({overscaledTileID:za,applyGlobeMatrix:!K,applyTerrainMatrix:!0});ri(Za,"fill-extrusion-pattern",ca,Ea,m);const eb=v.aD(ya,Ea,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Db=m.paint.get("fill-extrusion-vertical-gradient");if(ja){var Ba=b;Ba=v.e(fi(Ba,
Db,pa,eb),Lf(la,Ba,Ea),{u_height_factor:-Math.pow(2,za.overscaledZ)/Ea.tileSize/8})}else Ba=fi(b,Db,pa,eb);sb.draw(R,R.gl.TRIANGLES,z,C,G,dd.backCCW,Ba,Qa,ob,m.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,m.paint,b.transform.zoom,Za,b.style.map.terrain&&u.centroidVertexBuffer)}}function Gh(b,g,m,u,z,C,G,K,R){var X;const ca=b.style.projection,ja=b.context,la=b.transform,pa=ja.gl;var ya=[`#define NUM_ILLUMINATION_SOURCES ${m.paint.get("hillshade-highlight-color").values.length}`];ya=b.useProgram("hillshade",
null,!1,ya);const Ba=!b.options.moving;for(const Nb of u){var za=g.getTile(Nb),Ea=za.fbo;if(!Ea)continue;u=ca.getMeshFromTileID(ja,Nb.canonical,K,!0,"raster");const Ob=null===(X=b.style.map.terrain)||void 0===X?void 0:X.getTerrainData(Nb);ja.activeTexture.set(pa.TEXTURE0);pa.bindTexture(pa.TEXTURE_2D,Ea.colorAttachment.get());const Jb=la.getProjectionData({overscaledTileID:Nb,aligned:Ba,applyGlobeMatrix:!R,applyTerrainMatrix:!0});Ea=ya;var Qa=Ea.draw,Za=pa.TRIANGLES,sb=z[Nb.overscaledZ],ob=dd.backCCW;
let $b;var eb=b,Db=za;za=m;const vc=za.paint.get("hillshade-accent-color");switch(za.paint.get("hillshade-method")){case "basic":$b=4;break;case "combined":$b=1;break;case "igor":$b=2;break;case "multidirectional":$b=3;break;default:$b=0}const Bb=za.getIlluminationProperties();for(let Yc=0;Yc<Bb.directionRadians.length;Yc++)"viewport"===za.paint.get("hillshade-illumination-anchor")&&(Bb.directionRadians[Yc]+=eb.transform.bearingInRadians);Db=Db.tileID;eb=Math.pow(2,Db.canonical.z);Db=Db.canonical.y;
za={u_image:0,u_latrange:[(new v.a1(0,Db/eb)).toLngLat().lat,(new v.a1(0,(Db+1)/eb)).toLngLat().lat],u_exaggeration:za.paint.get("hillshade-exaggeration"),u_altitudes:Bb.altitudeRadians,u_azimuths:Bb.directionRadians,u_accent:vc,u_method:$b,u_highlights:Bb.highlightColor,u_shadows:Bb.shadowColor};Qa.call(Ea,ja,Za,C,sb,G,ob,za,Ob,Jb,m.id,u.vertexBuffer,u.indexBuffer,u.segments)}}function te(b,g,m,u,z,C,G,K,R){var X;const ca=b.style.projection,ja=b.context,la=b.transform,pa=ja.gl,ya=b.useProgram("colorRelief"),
Ba=!b.options.moving;var za=!0;let Ea=0;for(const sb of u){u=g.getTile(sb);var Qa=u.dem;if(za){za=pa.getParameter(pa.MAX_TEXTURE_SIZE);const {elevationTexture:eb,colorTexture:Db}=m.getColorRampTextures(ja,za,Qa.getUnpackVector());ja.activeTexture.set(pa.TEXTURE1);eb.bind(pa.NEAREST,pa.CLAMP_TO_EDGE);ja.activeTexture.set(pa.TEXTURE4);Db.bind(pa.LINEAR,pa.CLAMP_TO_EDGE);za=!1;Ea=eb.size[0]}if(!Qa||!Qa.data)continue;var Za=Qa.stride;Qa=Qa.getPixels();(ja.activeTexture.set(pa.TEXTURE0),ja.pixelStoreUnpackPremultiplyAlpha.set(!1),
u.demTexture=u.demTexture||b.getTileTexture(Za),u.demTexture)?(Za=u.demTexture,Za.update(Qa,{premultiply:!1}),Za.bind(pa.LINEAR,pa.CLAMP_TO_EDGE)):(u.demTexture=new v.T(ja,Qa,pa.RGBA,{premultiply:!1}),u.demTexture.bind(pa.LINEAR,pa.CLAMP_TO_EDGE));Qa=ca.getMeshFromTileID(ja,sb.canonical,K,!0,"raster");Za=null===(X=b.style.map.terrain)||void 0===X?void 0:X.getTerrainData(sb);const ob=la.getProjectionData({overscaledTileID:sb,aligned:Ba,applyGlobeMatrix:!R,applyTerrainMatrix:!0});ya.draw(ja,pa.TRIANGLES,
C,z[sb.overscaledZ],G,dd.backCCW,Hi(m,u.dem,Ea),Za,ob,m.id,Qa.vertexBuffer,Qa.indexBuffer,Qa.segments)}}function Zh(b,g,m,u,z,C,G,K,R=!1,X=!1){const ca=u[u.length-1].overscaledZ,ja=b.context,la=ja.gl,pa=b.useProgram("raster"),ya=b.transform,Ba=b.style.projection,za=b.colorModeForRenderPass(),Ea=!b.options.moving,Qa=m.paint.get("raster-opacity"),Za=m.paint.get("raster-resampling"),sb=m.paint.get("raster-fade-duration"),ob=!!b.style.map.terrain;for(const fd of u){u=b.getDepthModeForSublayer(fd.overscaledZ-
ca,1===Qa?ed.ReadWrite:ed.ReadOnly,la.LESS);var eb=g.getTile(fd),Db="nearest"===Za?la.NEAREST:la.LINEAR;ja.activeTexture.set(la.TEXTURE0);eb.texture.bind(Db,la.CLAMP_TO_EDGE,la.LINEAR_MIPMAP_NEAREST);ja.activeTexture.set(la.TEXTURE1);const {parentTile:ud,parentScaleBy:le,parentTopLeft:wd,fadeValues:Fd}=Pj(eb,g,sb,ob);eb.fadeOpacity=Fd.tileOpacity;ud?(ud.fadeOpacity=Fd.parentTileOpacity,ud.texture.bind(Db,la.CLAMP_TO_EDGE,la.LINEAR_MIPMAP_NEAREST)):eb.texture.bind(Db,la.CLAMP_TO_EDGE,la.LINEAR_MIPMAP_NEAREST);
eb.texture.useMipmap&&ja.extTextureFilterAnisotropic&&20<b.transform.pitch&&la.texParameterf(la.TEXTURE_2D,ja.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ja.extTextureFilterAnisotropicMax);eb=b.style.map.terrain&&b.style.map.terrain.getTerrainData(fd);Db=ya.getProjectionData({overscaledTileID:fd,aligned:Ea,applyGlobeMatrix:!X,applyTerrainMatrix:!0});var Nb=void 0,Ob=void 0,Jb=Fd.fadeMix,$b=m,vc=K,Bb=Jb.mix;Jb=Jb.opacity*$b.paint.get("raster-opacity");var Yc=$b.paint.get("raster-brightness-min"),
md=$b.paint.get("raster-brightness-max"),Bd=(Nb=$b.paint.get("raster-saturation"),0<Nb?1-1/(1.001-Nb):-Nb);Nb=(Ob=$b.paint.get("raster-contrast"),0<Ob?1/(1-Ob):1+Ob);$b=$b.paint.get("raster-hue-rotate");$b*=Math.PI/180;Ob=Math.sin($b);$b=Math.cos($b);vc={u_tl_parent:wd,u_scale_parent:le,u_buffer_scale:1,u_fade_t:Bb,u_opacity:Jb,u_image0:0,u_image1:1,u_brightness_low:Yc,u_brightness_high:md,u_saturation_factor:Bd,u_contrast_factor:Nb,u_spin_weights:[(2*$b+1)/3,(-Math.sqrt(3)*Ob-$b+1)/3,(Math.sqrt(3)*
Ob-$b+1)/3],u_coords_top:[vc[0].x,vc[0].y,vc[1].x,vc[1].y],u_coords_bottom:[vc[3].x,vc[3].y,vc[2].x,vc[2].y]};Bb=Ba.getMeshFromTileID(ja,fd.canonical,C,G,"raster");pa.draw(ja,la.TRIANGLES,u,z?z[fd.overscaledZ]:Jd.disabled,za,R?dd.frontCCW:dd.backCCW,vc,eb,Db,m.id,Bb.vertexBuffer,Bb.indexBuffer,Bb.segments)}}function Pj(b,g,m,u){var z={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(0===m||u)return z;if(b.fadingParentID){g=
g._getLoadedTile(b.fadingParentID);if(!g)return z;z=Math.pow(2,g.tileID.overscaledZ-b.tileID.overscaledZ);u=[b.tileID.canonical.x*z%1,b.tileID.canonical.y*z%1];b=function(C,G,K){var R=qd.now();const X=(R-G.timeAdded)/K;G=C.fadingDirection===jf.Incoming;C=v.ah((R-C.timeAdded)/K,0,1);K=v.ah(1-X,0,1);R=G?C:K;return{tileOpacity:R,parentTileOpacity:G?K:C,fadeMix:{opacity:1,mix:1-R}}}(b,g,m);return{parentTile:g,parentScaleBy:z,parentTopLeft:u,fadeValues:b}}return b.selfFading?{parentTile:null,parentScaleBy:1,
parentTopLeft:[0,0],fadeValues:function(C,G){const K=qd.now();C=v.ah((K-C.timeAdded)/G,0,1);return{tileOpacity:C,fadeMix:{opacity:C,mix:0}}}(b,m)}:z}function oh(b,g,m,u,z,C){const G=b.context,K=G.gl;K.enable(K.SCISSOR_TEST);K.scissor(g*b.pixelRatio,m*b.pixelRatio,u*b.pixelRatio,z*b.pixelRatio);G.clear({color:C});K.disable(K.SCISSOR_TEST)}function Id(b,g,m,u){({isRenderingGlobe:u}=u);const z=b.context,C=z.gl,G=b.transform,K=b.colorModeForRenderPass(),R=b.getDepthModeFor3D(),X=b.useProgram("terrain");
z.bindFramebuffer.set(null);z.viewport.set([0,0,b.width,b.height]);for(const la of m){m=g.getTerrainMesh(la.tileID);var ca=b.renderToTexture.getTexture(la);const pa=g.getTerrainData(la.tileID);z.activeTexture.set(C.TEXTURE0);C.bindTexture(C.TEXTURE_2D,ca.texture);const ya=g.getMeshFrameDelta(G.zoom),Ba=G.calculateFogMatrix(la.tileID.toUnwrapped());ca=b.style.sky;var ja=G.pitch;ca={u_texture:0,u_ele_delta:ya,u_fog_matrix:Ba,u_fog_color:ca?ca.properties.get("fog-color"):v.bf.white,u_fog_ground_blend:ca?
ca.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:ca?ca.calculateFogBlendOpacity(ja):0,u_horizon_color:ca?ca.properties.get("horizon-color"):v.bf.white,u_horizon_fog_blend:ca?ca.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0};ja=G.getProjectionData({overscaledTileID:la.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});X.draw(z,C.TRIANGLES,R,Jd.disabled,K,dd.backCCW,ca,pa,ja,"terrain",m.vertexBuffer,m.indexBuffer,m.segments)}}function Xg(b,g){if(!g.mesh){const m=
new v.aL;m.emplaceBack(-1,-1);m.emplaceBack(1,-1);m.emplaceBack(1,1);m.emplaceBack(-1,1);const u=new v.aN;u.emplaceBack(0,1,2);u.emplaceBack(0,2,3);g.mesh=new sg(b.createVertexBuffer(m,He.members),b.createIndexBuffer(u),v.aM.simpleSegment(0,0,m.length,u.length))}return g.mesh}function tk(b,g){let m,u=!1,z=null,C=null;const G=()=>{z=null;u&&(b.apply(C,m),z=setTimeout(G,g),u=!1)};return(...K)=>(u=!0,C=this,m=K,z||G(),z)}function ph(b,g){(!b.duration||b.duration<g.duration)&&(b.duration=g.duration,b.easing=
g.easing)}function Dg(b,g,m){const {maxSpeed:u,linearity:z,deceleration:C}=m;b=v.ah(b*z/(g/1E3),-u,u);g=Math.abs(b)/(C*z);return{easing:m.easing,duration:1E3*g,amount:g/2*b}}function ti(b,g){if(b.length!==g.length)throw Error(`The number of touches and points are not equal - touches ${b.length}, points ${g.length}`);const m={};for(let u=0;u<b.length;u++)m[b[u].identifier]=g[u];return m}function ui(b,g,m){for(let u=0;u<b.length;u++)if(b[u].identifier===m)return g[u]}function Yi(b){return Math.abs(b.y)>
Math.abs(b.x)}function Fl(b){return b*(2-b)}function Rj(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}function Tf(b,g,m,u=!1){if(u||!m.getCoveringTilesDetailsProvider().allowWorldCopies())return null==b?void 0:b.wrap();u=new v.S(b.lng,b.lat);if(b=new v.S(b.lng,b.lat),g){const z=new v.S(b.lng-360,b.lat),C=new v.S(b.lng+360,b.lat),G=m.locationToScreenPoint(b).distSqr(g);m.locationToScreenPoint(z).distSqr(g)<G?b=z:m.locationToScreenPoint(C).distSqr(g)<
G&&(b=C)}for(;180<Math.abs(b.lng-m.center.lng);){g=m.locationToScreenPoint(b);if(0<=g.x&&0<=g.y&&g.x<=m.width&&g.y<=m.height)break;b.lng>m.center.lng?b.lng-=360:b.lng+=360}return b.lng!==u.lng&&m.isPointOnMapSurface(m.locationToScreenPoint(b))?b:u}function vi(b,g,m){b=b.classList;for(const u in Th)b.remove(`maplibregl-${m}-anchor-${u}`);b.add(`maplibregl-${m}-anchor-${g}`)}function tj(b,g,m){var u=m&&m.maxWidth||100,z=b._container.clientHeight/2,C=b._container.clientWidth/2,G=b.unproject([C-u/2,z]);
z=b.unproject([C+u/2,z]);C=Math.round(b.project(z).x-b.project(G).x);u=Math.min(u,C,b._container.clientWidth);G=G.distanceTo(z);m&&"imperial"===m.unit?(m=3.2808*G,5280<m?Hh(g,u,m/5280,b._getUIString("ScaleControl.Miles")):Hh(g,u,m,b._getUIString("ScaleControl.Feet"))):m&&"nautical"===m.unit?Hh(g,u,G/1852,b._getUIString("ScaleControl.NauticalMiles")):1E3<=G?Hh(g,u,G/1E3,b._getUIString("ScaleControl.Kilometers")):Hh(g,u,G,b._getUIString("ScaleControl.Meters"))}function Hh(b,g,m,u){const z=Math.pow(10,
`${Math.floor(m)}`.length-1);let C=m/z;if(10<=C)var G=10;else 5<=C?G=5:3<=C?G=3:2<=C?G=2:1<=C?G=1:(G=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10)),G=Math.round(C*G)/G);G=(C=G,z*C);b.style.width=G/m*g+"px";b.innerHTML=`${G}&nbsp;${u}`}function uk(b){if(b){if("number"==typeof b){const g=Math.round(Math.abs(b)/Math.SQRT2);return{center:new v.P(0,0),top:new v.P(0,b),"top-left":new v.P(g,g),"top-right":new v.P(-g,g),bottom:new v.P(0,-b),"bottom-left":new v.P(g,-g),"bottom-right":new v.P(-g,-g),left:new v.P(b,
0),right:new v.P(-b,0)}}return b instanceof v.P||Array.isArray(b)?(b=v.P.convert(b),{center:b,top:b,"top-left":b,"top-right":b,bottom:b,"bottom-left":b,"bottom-right":b,left:b,right:b}):{center:v.P.convert(b.center||[0,0]),top:v.P.convert(b.top||[0,0]),"top-left":v.P.convert(b["top-left"]||[0,0]),"top-right":v.P.convert(b["top-right"]||[0,0]),bottom:v.P.convert(b.bottom||[0,0]),"bottom-left":v.P.convert(b["bottom-left"]||[0,0]),"bottom-right":v.P.convert(b["bottom-right"]||[0,0]),left:v.P.convert(b.left||
[0,0]),right:v.P.convert(b.right||[0,0])}}return uk(new v.P(0,0))}let og,Uf;const qd={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,g,m){const u=requestAnimationFrame(C=>{z();g(C)}),{unsubscribe:z}=v.s(b.signal,"abort",()=>{z();cancelAnimationFrame(u);m(v.c())},!1)},frameAsync(b){return new Promise((g,m)=>{this.frame(b,g,m)})},getImageData(b,g=0){return this.getImageCanvasContext(b).getImageData(-g,-g,b.width+2*g,b.height+
2*g)},getImageCanvasContext(b){const g=window.document.createElement("canvas"),m=g.getContext("2d",{willReadFrequently:!0});if(!m)throw Error("failed to create canvas 2d context");return g.width=b.width,g.height=b.height,m.drawImage(b,0,0,b.width,b.height),m},resolveURL:b=>(og||(og=document.createElement("a")),og.href=b,og.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==Uf&&(Uf=matchMedia("(prefers-reduced-motion: reduce)")),
Uf.matches)}};class rb{static testProp(b){if(!rb.docStyle)return b[0];for(let g=0;g<b.length;g++)if(b[g]in rb.docStyle)return b[g];return b[0]}static create(b,g,m){b=window.document.createElement(b);return void 0!==g&&(b.className=g),m&&m.appendChild(b),b}static createNS(b,g){return window.document.createElementNS(b,g)}static disableDrag(){rb.docStyle&&rb.selectProp&&(rb.userSelect=rb.docStyle[rb.selectProp],rb.docStyle[rb.selectProp]="none")}static enableDrag(){rb.docStyle&&rb.selectProp&&(rb.docStyle[rb.selectProp]=
rb.userSelect)}static setTransform(b,g){b.style[rb.transformProp]=g}static addEventListener(b,g,m,u={}){b.addEventListener(g,m,"passive"in u?u:u.capture)}static removeEventListener(b,g,m,u={}){b.removeEventListener(g,m,"passive"in u?u:u.capture)}static suppressClickInternal(b){b.preventDefault();b.stopPropagation();window.removeEventListener("click",rb.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",rb.suppressClickInternal,!0);window.setTimeout(()=>{window.removeEventListener("click",
rb.suppressClickInternal,!0)},0)}static getScale(b){const g=b.getBoundingClientRect();return{x:g.width/b.offsetWidth||1,y:g.height/b.offsetHeight||1,boundingClientRect:g}}static getPoint(b,g,m){const u=g.boundingClientRect;return new v.P((m.clientX-u.left)/g.x-b.clientLeft,(m.clientY-u.top)/g.y-b.clientTop)}static mousePos(b,g){const m=rb.getScale(b);return rb.getPoint(b,m,g)}static touchPos(b,g){const m=[],u=rb.getScale(b);for(let z=0;z<g.length;z++)m.push(rb.getPoint(b,u,g[z]));return m}static mouseButton(b){return b.button}static remove(b){b.parentNode&&
b.parentNode.removeChild(b)}static sanitize(b){b=(new DOMParser).parseFromString(b,"text/html").body||document.createElement("body");const g=b.querySelectorAll("script");for(const m of g)m.remove();return rb.clean(b),b.innerHTML}static isPossiblyDangerous(b,g){g=g.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(b)||!g.includes("javascript:")&&!g.includes("data:"))||!!b.startsWith("on")||void 0}static clean(b){b=b.children;for(const g of b)rb.removeAttributes(g),rb.clean(g)}static removeAttributes(b){for(const {name:g,
value:m}of b.attributes)rb.isPossiblyDangerous(g,m)&&b.removeAttribute(g)}}rb.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style;rb.selectProp=rb.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);rb.transformProp=rb.testProp(["transform","WebkitTransform"]);const Zi={supported:!1,testSupport:function(b){!wi&&Ih&&(rh?Va(b):Zg=b)}};let Zg,Ih,wi=!1,rh=!1;var yf;"undefined"!=typeof document&&(Ih=document.createElement("img"),Ih.onload=
()=>{Zg&&Va(Zg);Zg=null;rh=!0},Ih.onerror=()=>{wi=!0;Zg=null},Ih.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA\x3d");(function(b){let g,m,u,z;b.resetRequestQueue=()=>{g=[];u=m=0;z={}};b.addThrottleControl=R=>{const X=u++;return z[X]=R,X};b.removeThrottleControl=R=>{delete z[R];G()};b.getImage=(R,X,ca=!0)=>new Promise((ja,la)=>{Zi.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*");v.e(R,{type:"image"});g.push({abortController:X,requestParameters:R,
supportImageRefresh:ca,state:"queued",onError:pa=>{la(pa)},onSuccess:pa=>{ja(pa)}});G()});const C=R=>v._(this,void 0,void 0,function*(){R.state="running";const {requestParameters:X,supportImageRefresh:ca,onError:ja,onSuccess:la,abortController:pa}=R;var ya=!1===ca&&!v.i(self)&&!v.g(X.url)&&(!X.headers||Object.keys(X.headers).reduce((za,Ea)=>za&&"accept"===Ea,!0));m++;ya=ya?K(X,pa):v.m(X,pa);try{const za=yield ya;delete R.abortController;R.state="completed";za.data instanceof HTMLImageElement||v.b(za.data)?
la(za):za.data&&la({data:yield(Ba=za.data,"function"==typeof createImageBitmap?v.f(Ba):v.h(Ba)),cacheControl:za.cacheControl,expires:za.expires})}catch(za){delete R.abortController,ja(za)}finally{m--,G()}var Ba}),G=()=>{a:{for(R of Object.keys(z))if(z[R]()){var R=!0;break a}R=!1}R=R?v.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:v.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let X=m;X<R&&0<g.length;X++){const ca=g.shift();ca.abortController.signal.aborted?X--:C(ca)}},K=(R,X)=>new Promise((ca,ja)=>{const la=new Image,
pa=R.url,ya=R.credentials;ya&&"include"===ya?la.crossOrigin="use-credentials":(ya&&"same-origin"===ya||!v.d(pa))&&(la.crossOrigin="anonymous");X.signal.addEventListener("abort",()=>{la.src="";ja(v.c())});la.fetchPriority="high";la.onload=()=>{la.onerror=la.onload=null;ca({data:la})};la.onerror=()=>{la.onerror=la.onload=null;X.signal.aborted||ja(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};la.src=pa})})(yf||(yf=
{}));yf.resetRequestQueue();class Jh{constructor(b){this._transformRequestFn=null!=b?b:null}transformRequest(b,g){return this._transformRequestFn&&this._transformRequestFn(b,g)||{url:b}}setTransformRequest(b){this._transformRequestFn=b}}class uj extends v.E{constructor(){super();this.images={};this.updatedImages={};this.callbackDispatchedThisFrame={};this.loaded=!1;this.requestors=[];this.patterns={};this.atlasImage=new v.R({width:1,height:1});this.dirty=!0}isLoaded(){return this.loaded}setLoaded(b){if(this.loaded!==
b&&(this.loaded=b,b)){for(const {ids:g,promiseResolve:m}of this.requestors)m(this._getImagesForIds(g));this.requestors=[]}}getImage(b){if((b=this.images[b])&&!b.data&&b.spriteData){const g=b.spriteData;b.data=new v.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data);b.spriteData=null}return b}addImage(b,g){if(this.images[b])throw Error(`Image id ${b} already exist, use updateImage instead`);this._validate(b,g)&&(this.images[b]=g)}_validate(b,g){let m=!0;const u=
g.data||g.spriteData;return this._validateStretch(g.stretchX,u&&u.width)||(this.fire(new v.k(Error(`Image "${b}" has invalid "stretchX" value`))),m=!1),this._validateStretch(g.stretchY,u&&u.height)||(this.fire(new v.k(Error(`Image "${b}" has invalid "stretchY" value`))),m=!1),this._validateContent(g.content,g)||(this.fire(new v.k(Error(`Image "${b}" has invalid "content" value`))),m=!1),m}_validateStretch(b,g){if(!b)return!0;let m=0;for(const u of b){if(u[0]<m||u[1]<u[0]||g<u[1])return!1;m=u[1]}return!0}_validateContent(b,
g){if(!b)return!0;if(4!==b.length)return!1;const m=g.spriteData,u=m&&m.width||g.data.width;g=m&&m.height||g.data.height;return!(0>b[0]||u<b[0]||0>b[1]||g<b[1]||0>b[2]||u<b[2]||0>b[3]||g<b[3]||b[2]<b[0]||b[3]<b[1])}updateImage(b,g,m=!0){const u=this.getImage(b);if(m&&(u.data.width!==g.data.width||u.data.height!==g.data.height))throw Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${g.data.width}x${g.data.height}).`);g.version=u.version+1;this.images[b]=g;this.updatedImages[b]=
!0}removeImage(b){const g=this.images[b];delete this.images[b];delete this.patterns[b];g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(b){return new Promise((g,m)=>{m=!0;if(!this.isLoaded())for(const u of b)this.images[u]||(m=!1);this.isLoaded()||m?g(this._getImagesForIds(b)):this.requestors.push({ids:b,promiseResolve:g})})}_getImagesForIds(b){const g={};for(const m of b)(b=this.getImage(m))||(this.fire(new v.l("styleimagemissing",{id:m})),
b=this.getImage(m)),b?g[m]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,textFitWidth:b.textFitWidth,textFitHeight:b.textFitHeight,hasRenderCallback:!(!b.userImage||!b.userImage.render)}:v.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);return g}getPixelSize(){const {width:b,
height:g}=this.atlasImage;return{width:b,height:g}}getPattern(b){var g=this.patterns[b],m=this.getImage(b);if(!m)return null;if(g&&g.position.version===m.version)return g.position;g?g.position.version=m.version:(g={w:m.data.width+2,h:m.data.height+2,x:0,y:0},m=new v.I(g,m),this.patterns[b]={bin:g,position:m});return this._updatePatternAtlas(),this.patterns[b].position}bind(b){const g=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.T(b,
this.atlasImage,g.RGBA);this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){var b=[];for(var g in this.patterns)b.push(this.patterns[g].bin);const {w:m,h:u}=v.p(b);b=this.atlasImage;b.resize({width:m||1,height:u||1});for(const C in this.patterns){var {bin:z}=this.patterns[C];g=z.x+1;z=z.y+1;const G=this.getImage(C).data,K=G.width,R=G.height;v.R.copy(G,b,{x:0,y:0},{x:g,y:z},{width:K,height:R});v.R.copy(G,b,{x:0,y:R-1},{x:g,y:z-1},{width:K,height:1});v.R.copy(G,b,{x:0,y:0},{x:g,y:z+
R},{width:K,height:1});v.R.copy(G,b,{x:K-1,y:0},{x:g-1,y:z},{width:1,height:R});v.R.copy(G,b,{x:0,y:0},{x:g+K,y:z},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(b){for(const g of b){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;(b=this.getImage(g))||v.w(`Image with ID: "${g}" was not found`);const {userImage:m}=b;m&&m.render&&m.render()&&(b.data.replace(new Uint8Array(m.data.buffer)),!0)&&this.updateImage(g,
b)}}}class Yg{constructor(b,g,m){this.requestManager=b;this.localIdeographFontFamily=g;this.entries={};this.lang=m}setURL(b){this.url=b}getGlyphs(b){return v._(this,void 0,void 0,function*(){var g=[];for(var m in b)for(const u of b[m])g.push(this._getAndCacheGlyphsPromise(m,u));g=yield Promise.all(g);m={};for(const {stack:u,id:z,glyph:C}of g)m[u]||(m[u]={}),m[u][z]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return m})}_getAndCacheGlyphsPromise(b,g){return v._(this,void 0,void 0,function*(){let m=
this.entries[b];m||(m=this.entries[b]={glyphs:{},requests:{},ranges:{}});var u=m.glyphs[g];if(void 0!==u)return{stack:b,id:g,glyph:u};if(u=this._tinySDF(m,b,g),u)return m.glyphs[g]=u,{stack:b,id:g,glyph:u};const z=Math.floor(g/256);if(65535<256*z)throw Error("glyphs \x3e 65535 not supported");if(m.ranges[z])return{stack:b,id:g,glyph:u};if(!this.url)throw Error("glyphsUrl is not set");m.requests[z]||(u=Yg.loadGlyphRange(b,z,this.url,this.requestManager),m.requests[z]=u);u=yield m.requests[z];for(const C in u)this._doesCharSupportLocalGlyph(+C)||
(m.glyphs[+C]=u[+C]);return m.ranges[z]=!0,{stack:b,id:g,glyph:u[g]||null}})}_doesCharSupportLocalGlyph(b){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(b))||v.u["CJK Unified Ideographs"](b)||v.u["Hangul Syllables"](b)||v.u.Hiragana(b)||v.u.Katakana(b)||v.u["CJK Symbols and Punctuation"](b)||v.u["Halfwidth and Fullwidth Forms"](b))}_tinySDF(b,g,m){const u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(m)){var z=
b.tinySDF;z||(z="400",/bold/i.test(g)?z="900":/medium/i.test(g)?z="500":/light/i.test(g)&&(z="200"),z=b.tinySDF=new Yg.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:u,fontWeight:z}));b=z.draw(String.fromCharCode(m));return{id:m,bitmap:new v.q({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}}const Ud=class{constructor({fontSize:b=
24,buffer:g=3,radius:m=8,cutoff:u=.25,fontFamily:z="sans-serif",fontWeight:C="normal",fontStyle:G="normal",lang:K=null}={}){this.buffer=g;this.cutoff=u;this.radius=m;this.lang=K;g=this.size=b+4*g;m=this.ctx=this._createCanvas(g).getContext("2d",{willReadFrequently:!0});m.font=`${G} ${C} ${b}px ${z}`;m.textBaseline="alphabetic";m.textAlign="left";m.fillStyle="black";this.gridOuter=new Float64Array(g*g);this.gridInner=new Float64Array(g*g);this.f=new Float64Array(g);this.z=new Float64Array(g+1);this.v=
new Uint16Array(g)}_createCanvas(b){const g=document.createElement("canvas");return g.width=g.height=b,g}draw(b){const {width:g,actualBoundingBoxAscent:m,actualBoundingBoxDescent:u,actualBoundingBoxLeft:z,actualBoundingBoxRight:C}=this.ctx.measureText(b);var G=Math.ceil(m),K=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(C-z)));const R=Math.min(this.size-this.buffer,G+Math.ceil(u)),X=K+2*this.buffer,ca=R+2*this.buffer,ja=Math.max(X*ca,0),la=new Uint8ClampedArray(ja),pa={data:la,width:X,height:ca,
glyphWidth:K,glyphHeight:R,glyphTop:G,glyphLeft:0,glyphAdvance:g};if(0===K||0===R)return pa;const {ctx:ya,buffer:Ba,gridInner:za,gridOuter:Ea}=this;this.lang&&(ya.lang=this.lang);ya.clearRect(Ba,Ba,K,R);ya.fillText(b,Ba,Ba+G);b=ya.getImageData(Ba,Ba,K,R);Ea.fill(1E20,0,ja);za.fill(0,0,ja);for(G=0;G<R;G++)for(let Za=0;Za<K;Za++){var Qa=b.data[4*(G*K+Za)+3]/255;if(0===Qa)continue;const sb=(G+Ba)*X+Za+Ba;1===Qa?(Ea[sb]=0,za[sb]=1E20):(Qa=.5-Qa,Ea[sb]=0<Qa?Qa*Qa:0,za[sb]=0>Qa?Qa*Qa:0)}Sb(Ea,0,0,X,ca,
X,this.f,this.v,this.z);Sb(za,Ba,Ba,K,R,X,this.f,this.v,this.z);for(K=0;K<ja;K++)la[K]=Math.round(255-255*((Math.sqrt(Ea[K])-Math.sqrt(za[K]))/this.radius+this.cutoff));return pa}};Yg.loadGlyphRange=function(b,g,m,u){return v._(this,void 0,void 0,function*(){var z=256*g;const C=z+255;var G=u.transformRequest(m.replace("{fontstack}",b).replace("{range}",`${z}-${C}`),"Glyphs");G=yield v.n(G,new AbortController);if(!G||!G.data)throw Error(`Could not load glyph range. range: ${g}, ${z}-${C}`);z={};for(const K of v.o(G.data))z[K.id]=
K;return z})};Yg.TinySDF=Ud;class xi{constructor(){this.specification=v.v.light.position}possiblyEvaluate(b,g){return v.B(b.expression.evaluate(g))}interpolate(b,g,m){return{x:v.C.number(b.x,g.x,m),y:v.C.number(b.y,g.y,m),z:v.C.number(b.z,g.z,m)}}}let Eg;class $h extends v.E{constructor(b){super();Eg=Eg||new v.r({anchor:new v.D(v.v.light.anchor),position:new xi,color:new v.D(v.v.light.color),intensity:new v.D(v.v.light.intensity)});this._transitionable=new v.t(Eg,void 0);this.setLight(b);this._transitioning=
this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(b,g={}){if(!this._validate(v.x,b,g))for(const m in b)g=b[m],m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),g):this._transitionable.setValue(m,g)}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,
g,m){return(!m||!1!==m.validate)&&v.y(this,b.call(v.z,{value:g,style:{glyphs:!0,sprite:!0},styleSpec:v.v}))}}const qk=new v.r({"sky-color":new v.D(v.v.sky["sky-color"]),"horizon-color":new v.D(v.v.sky["horizon-color"]),"fog-color":new v.D(v.v.sky["fog-color"]),"fog-ground-blend":new v.D(v.v.sky["fog-ground-blend"]),"horizon-fog-blend":new v.D(v.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new v.D(v.v.sky["sky-horizon-blend"]),"atmosphere-blend":new v.D(v.v.sky["atmosphere-blend"])});class sh extends v.E{constructor(b){super();
this._transitionable=new v.t(qk,void 0);this.setSky(b);this._transitioning=this._transitionable.untransitioned();this.recalculate(new v.F(0))}setSky(b,g={}){if(!this._validate(v.G,b,g)){b||(b={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const m in b)g=b[m],m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),g):this._transitionable.setValue(m,g)}}getSky(){return this._transitionable.serialize()}updateTransitions(b){this._transitioning=
this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,g,m={}){return!1!==(null==m?void 0:m.validate)&&v.y(this,b.call(v.z,v.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:v.v})))}calculateFogBlendOpacity(b){return 60>b?0:70>b?(b-60)/10:1}}class vd{constructor(b,g){this.width=b;this.height=g;this.nextRow=0;this.data=new Uint8Array(this.width*this.height);
this.dashEntry={}}getDash(b,g){const m=b.join(",")+String(g);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(b,g)),this.dashEntry[m]}getDashRanges(b,g,m){g=[];let u=1==b.length%2?-b[b.length-1]*m:0,z=b[0]*m,C=!0;g.push({left:u,right:z,isDash:C,zeroLength:0===b[0]});let G=b[0];for(let K=1;K<b.length;K++){C=!C;const R=b[K];u=G*m;G+=R;z=G*m;g.push({left:u,right:z,isDash:C,zeroLength:0===R})}return g}addRoundDash(b,g,m){g/=2;for(let C=-m;C<=m;C++){const G=this.width*(this.nextRow+m+C);let K=
0,R=b[K];for(let X=0;X<this.width;X++){1<X/R.right&&(R=b[++K]);var u=Math.min(Math.abs(X-R.left),Math.abs(X-R.right)),z=C/m*(g+1);R.isDash?(z=g-Math.abs(z),u=Math.sqrt(u*u+z*z)):u=g-Math.sqrt(u*u+z*z);this.data[G+X]=Math.max(0,Math.min(255,u+128))}}}addRegularDash(b){for(var g=b.length-1;0<=g;--g){var m=b[g],u=b[g+1];m.zeroLength?b.splice(g,1):u&&u.isDash===m.isDash&&(u.left=m.left,b.splice(g,1))}g=b[0];m=b[b.length-1];g.isDash===m.isDash&&(g.left=m.left-this.width,m.right=g.right+this.width);g=this.width*
this.nextRow;m=0;u=b[m];for(let z=0;z<this.width;z++){1<z/u.right&&(u=b[++m]);const C=Math.min(Math.abs(z-u.left),Math.abs(z-u.right));this.data[g+z]=Math.max(0,Math.min(255,(u.isDash?C:-C)+128))}}addDash(b,g){const m=g?7:0,u=2*m+1;if(this.nextRow+u>this.height)return v.w("LineAtlas out of space"),null;let z=0;for(var C=0;C<b.length;C++)z+=b[C];0!==z&&(C=this.width/z,b=this.getDashRanges(b,this.width,C),g?this.addRoundDash(b,C,m):this.addRegularDash(b));g={y:this.nextRow+m,height:2*m,width:z};return this.nextRow+=
u,this.dirty=!0,g}bind(b){b=b.gl;this.texture?(b.bindTexture(b.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,b.texSubImage2D(b.TEXTURE_2D,0,0,0,this.width,this.height,b.ALPHA,b.UNSIGNED_BYTE,this.data))):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,
b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.ALPHA,this.width,this.height,0,b.ALPHA,b.UNSIGNED_BYTE,this.data))}}class Fg{constructor(){this.active={}}acquire(b){if(!this.workers)for(this.workers=[];this.workers.length<Fg.workerCount;)this.workers.push(new Worker(v.a.WORKER_URL));return this.active[b]=!0,this.workers.slice()}release(b){delete this.active[b];0===this.numActive()&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active.maplibre_preloaded_worker_pool}numActive(){return Object.keys(this.active).length}}
const xk=Math.floor(qd.hardwareConcurrency/2);let Vf,pg;Fg.workerCount=v.H(globalThis)?Math.max(Math.min(xk,3),1):1;class zi{constructor(b,g){this.workerPool=b;this.actors=[];this.currentActor=0;this.id=g;b=this.workerPool.acquire(g);for(let m=0;m<b.length;m++){const u=new v.J(b[m],g);u.name=`Worker ${m}`;this.actors.push(u)}if(!this.actors.length)throw Error("No actors found");}broadcast(b,g){const m=[];for(const u of this.actors)m.push(u.sendAsync({type:b,data:g}));return Promise.all(m)}getActor(){return this.currentActor=
(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(b=!0){this.actors.forEach(g=>{g.remove()});this.actors=[];b&&this.workerPool.release(this.id)}registerMessageHandler(b,g){for(const m of this.actors)m.registerMessageHandler(b,g)}}class qf{constructor(b,g){b&&(g?this.setSouthWest(b).setNorthEast(g):Array.isArray(b)&&(4===b.length?this.setSouthWest([b[0],b[1]]).setNorthEast([b[2],b[3]]):this.setSouthWest(b[0]).setNorthEast(b[1])))}setNorthEast(b){return this._ne=b instanceof
v.S?new v.S(b.lng,b.lat):v.S.convert(b),this}setSouthWest(b){return this._sw=b instanceof v.S?new v.S(b.lng,b.lat):v.S.convert(b),this}extend(b){const g=this._sw,m=this._ne;let u,z;if(b instanceof v.S)z=u=b;else{if(!(b instanceof qf))return Array.isArray(b)?4===b.length||b.every(Array.isArray)?this.extend(qf.convert(b)):this.extend(v.S.convert(b)):b&&("lng"in b||"lon"in b)&&"lat"in b?this.extend(v.S.convert(b)):this;if(u=b._sw,z=b._ne,!u||!z)return this}return g||m?(g.lng=Math.min(u.lng,g.lng),g.lat=
Math.min(u.lat,g.lat),m.lng=Math.max(z.lng,m.lng),m.lat=Math.max(z.lat,m.lat)):(this._sw=new v.S(u.lng,u.lat),this._ne=new v.S(z.lng,z.lat)),this}getCenter(){return new v.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new v.S(this.getWest(),this.getNorth())}getSouthEast(){return new v.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),
this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(b){const {lng:g,lat:m}=v.S.convert(b);b=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&b}static convert(b){return b instanceof qf?b:b?new qf(b):b}static fromLngLat(b,g=0){g=360*g/40075017;const m=g/Math.cos(Math.PI/180*b.lat);return new qf(new v.S(b.lng-m,b.lat-g),
new v.S(b.lng+m,b.lat+g))}adjustAntiMeridian(){const b=new v.S(this._sw.lng,this._sw.lat),g=new v.S(this._ne.lng,this._ne.lat);return new qf(b,b.lng>g.lng?new v.S(g.lng+360,g.lat):g)}}class Ai{constructor(b,g,m){this.bounds=qf.convert(this.validateBounds(b));this.minzoom=g||0;this.maxzoom=m||24}validateBounds(b){return Array.isArray(b)&&4===b.length?[Math.max(-180,b[0]),Math.max(-90,b[1]),Math.min(180,b[2]),Math.min(90,b[3])]:[-180,-90,180,90]}contains(b){var g=Math.pow(2,b.z);const m=Math.floor(v.V(this.bounds.getWest())*
g),u=Math.floor(v.U(this.bounds.getNorth())*g),z=Math.ceil(v.V(this.bounds.getEast())*g);g=Math.ceil(v.U(this.bounds.getSouth())*g);return b.x>=m&&b.x<z&&b.y>=u&&b.y<g}}class Gg extends v.E{constructor(b,g,m,u){if(super(),this.id=b,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.e(this,v.Q(g,["url","scheme","tileSize","promoteId"])),this._options=v.e({type:"vector"},g),this._collectResourceTiming=
g.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return v._(this,void 0,void 0,function*(){this._loaded=!1;this.fire(new v.l("dataloading",{dataType:"source"}));this._tileJSONRequest=new AbortController;try{const b=yield Fb(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null;this._loaded=!0;this.map.style.sourceCaches[this.id].clearTiles();b&&(v.e(this,b),b.bounds&&(this.tileBounds=
new Ai(b.bounds,this.minzoom,this.maxzoom)),this.fire(new v.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.l("data",{dataType:"source",sourceDataType:"content"})))}catch(b){this._tileJSONRequest=null,this._loaded=!0,this.fire(new v.k(b))}})}loaded(){return this._loaded}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}onAdd(b){this.map=b;this.load()}setSourceProperty(b){this._tileJSONRequest&&this._tileJSONRequest.abort();b();this.load()}setTiles(b){return this.setSourceProperty(()=>
{this._options.tiles=b}),this}setUrl(b){return this.setSourceProperty(()=>{this.url=b;this._options.url=b}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return v.e({},this._options)}loadTile(b){return v._(this,void 0,void 0,function*(){var g=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);g={request:this.map._requestManager.transformRequest(g,"Tile"),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*
b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};g.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(b.actor&&"expired"!==b.state){if("loading"===b.state)return new Promise((u,z)=>{b.reloadPromise={resolve:u,reject:z}})}else b.actor=this.dispatcher.getActor(),m="LT";b.abortController=new AbortController;
try{const u=yield b.actor.sendAsync({type:m,data:g},b.abortController);(delete b.abortController,b.aborted)||this._afterTileLoadWorkerResponse(b,u)}catch(u){if(delete b.abortController,!b.aborted){if(u&&404!==u.status)throw u;this._afterTileLoadWorkerResponse(b,null)}}})}_afterTileLoadWorkerResponse(b,g){if(g&&g.resourceTiming&&(b.resourceTiming=g.resourceTiming),g&&this.map._refreshExpiredTiles&&b.setExpiryData(g),b.loadVectorData(g,this.map.painter),b.reloadPromise)g=b.reloadPromise,b.reloadPromise=
null,this.loadTile(b).then(g.resolve).catch(g.reject)}abortTile(b){return v._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController);b.actor&&(yield b.actor.sendAsync({type:"AT",data:{uid:b.uid,type:this.type,source:this.id}}))})}unloadTile(b){return v._(this,void 0,void 0,function*(){b.unloadVectorData();b.actor&&(yield b.actor.sendAsync({type:"RMT",data:{uid:b.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ff extends v.E{constructor(b,
g,m,u){super();this.id=b;this.dispatcher=m;this.setEventedParent(u);this.type="raster";this.minzoom=0;this.maxzoom=22;this.roundZoom=!0;this.scheme="xyz";this.tileSize=512;this._loaded=!1;this._options=v.e({type:"raster"},g);v.e(this,v.Q(g,["url","scheme","tileSize"]))}load(){return v._(this,arguments,void 0,function*(b=!1){this._loaded=!1;this.fire(new v.l("dataloading",{dataType:"source"}));this._tileJSONRequest=new AbortController;try{const g=yield Fb(this._options,this.map._requestManager,this._tileJSONRequest);
this._tileJSONRequest=null;this._loaded=!0;g&&(v.e(this,g),g.bounds&&(this.tileBounds=new Ai(g.bounds,this.minzoom,this.maxzoom)),this.fire(new v.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:b})))}catch(g){this._tileJSONRequest=null,this._loaded=!0,this.fire(new v.k(g))}})}loaded(){return this._loaded}onAdd(b){this.map=b;this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=
null)}setSourceProperty(b){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null);b();this.load(!0)}setTiles(b){return this.setSourceProperty(()=>{this._options.tiles=b}),this}setUrl(b){return this.setSourceProperty(()=>{this.url=b;this._options.url=b}),this}serialize(){return v.e({},this._options)}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b){return v._(this,void 0,void 0,function*(){const g=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),
this.scheme);b.abortController=new AbortController;try{const m=yield yf.getImage(this.map._requestManager.transformRequest(g,"Tile"),b.abortController,this.map._refreshExpiredTiles);if(delete b.abortController,b.aborted)return void(b.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&b.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const u=this.map.painter.context,z=u.gl,C=m.data;b.texture=this.map.painter.getTileTexture(C.width);b.texture?
b.texture.update(C,{useMipmap:!0}):(b.texture=new v.T(u,C,z.RGBA,{useMipmap:!0}),b.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST));b.state="loaded"}}catch(m){if(delete b.abortController,b.aborted)b.state="unloaded";else if(m)throw b.state="errored",m;}})}abortTile(b){return v._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController)})}unloadTile(b){return v._(this,void 0,void 0,function*(){b.texture&&this.map.painter.saveTileTexture(b.texture)})}hasTransition(){return!1}}
class qg extends Ff{constructor(b,g,m,u){super(b,g,m,u);this.type="raster-dem";this.maxzoom=22;this._options=v.e({type:"raster-dem"},g);this.encoding=g.encoding||"mapbox";this.redFactor=g.redFactor;this.greenFactor=g.greenFactor;this.blueFactor=g.blueFactor;this.baseShift=g.baseShift}loadTile(b){return v._(this,void 0,void 0,function*(){var g=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);g=this.map._requestManager.transformRequest(g,"Tile");b.neighboringTiles=this._getNeighboringTiles(b.tileID);
b.abortController=new AbortController;try{const m=yield yf.getImage(g,b.abortController,this.map._refreshExpiredTiles);if(delete b.abortController,b.aborted)return void(b.state="unloaded");if(m&&m.data){const u=m.data;this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&b.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const z=v.b(u)&&v.W()?u:yield this.readImageNow(u),C={type:this.type,uid:b.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,
blueFactor:this.blueFactor,baseShift:this.baseShift};if(!b.actor||"expired"===b.state){b.actor=this.dispatcher.getActor();const G=yield b.actor.sendAsync({type:"LDT",data:C});b.dem=G;b.needsHillshadePrepare=!0;b.needsTerrainPrepare=!0;b.state="loaded"}}}catch(m){if(delete b.abortController,b.aborted)b.state="unloaded";else if(m)throw b.state="errored",m;}})}readImageNow(b){return v._(this,void 0,void 0,function*(){if("undefined"!=typeof VideoFrame&&v.X()){const g=b.width+2,m=b.height+2;try{return new v.R({width:g,
height:m},yield v.Y(b,-1,-1,g,m))}catch(u){}}return qd.getImageData(b,1)})}_getNeighboringTiles(b){const g=b.canonical,m=Math.pow(2,g.z),u=(g.x-1+m)%m,z=0===g.x?b.wrap-1:b.wrap,C=(g.x+1+m)%m,G=g.x+1===m?b.wrap+1:b.wrap,K={};return K[(new v.Z(b.overscaledZ,z,g.z,u,g.y)).key]={backfilled:!1},K[(new v.Z(b.overscaledZ,G,g.z,C,g.y)).key]={backfilled:!1},0<g.y&&(K[(new v.Z(b.overscaledZ,z,g.z,u,g.y-1)).key]={backfilled:!1},K[(new v.Z(b.overscaledZ,b.wrap,g.z,g.x,g.y-1)).key]={backfilled:!1},K[(new v.Z(b.overscaledZ,
G,g.z,C,g.y-1)).key]={backfilled:!1}),g.y+1<m&&(K[(new v.Z(b.overscaledZ,z,g.z,u,g.y+1)).key]={backfilled:!1},K[(new v.Z(b.overscaledZ,b.wrap,g.z,g.x,g.y+1)).key]={backfilled:!1},K[(new v.Z(b.overscaledZ,G,g.z,C,g.y+1)).key]={backfilled:!1}),K}unloadTile(b){return v._(this,void 0,void 0,function*(){b.demTexture&&this.map.painter.saveTileTexture(b.demTexture);b.fbo&&(b.fbo.destroy(),delete b.fbo);b.dem&&delete b.dem;delete b.neighboringTiles;b.state="unloaded";b.actor&&(yield b.actor.sendAsync({type:"RDT",
data:{type:this.type,uid:b.uid,source:this.id}}))})}}class kg extends v.E{constructor(b,g,m,u){super();this.id=b;this.type="geojson";this.minzoom=0;this.maxzoom=18;this.tileSize=512;this.reparseOverscaled=this.isTileClipped=!0;this._isUpdatingWorker=this._removed=!1;this._pendingWorkerUpdate={data:g.data};this.actor=m.getActor();this.setEventedParent(u);this._data=g.data;this._options=v.e({},g);this._collectResourceTiming=g.collectResourceTiming;void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom);g.type&&
(this.type=g.type);g.attribution&&(this.attribution=g.attribution);this.promoteId=g.promoteId;void 0!==g.clusterMaxZoom&&this.maxzoom<=g.clusterMaxZoom&&v.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${g.clusterMaxZoom}".`);this.workerOptions=v.e({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==g.buffer?g.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==g.tolerance?g.tolerance:.375),extent:v.$,
maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(g.clusterMaxZoom),minPoints:Math.max(2,g.clusterMinPoints||2),extent:v.$,radius:this._pixelsToTileUnits(g.clusterRadius||50),log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions);"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(b){return v.$/this.tileSize*b}_getClusterMaxZoom(b){const g=
b?Math.round(b):this.maxzoom-1;return Number.isInteger(b)||void 0===b||v.w(`Integer expected for option 'clusterMaxZoom': provided value "${b}" rounded to "${g}"`),g}load(){return v._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(b){this.map=b;this.load()}setData(b){return this._data=b,this._pendingWorkerUpdate={data:b},this._updateWorkerData(),this}updateData(b){return this._pendingWorkerUpdate.diff=v.a0(this._pendingWorkerUpdate.diff,b),this._updateWorkerData(),this}getData(){return v._(this,
void 0,void 0,function*(){const b=v.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:b})})}getCoordinatesFromGeometry(b){return"GeometryCollection"===b.type?b.geometries.map(g=>g.coordinates).flat(1/0):b.coordinates.flat(1/0)}getBounds(){return v._(this,void 0,void 0,function*(){const b=new qf;var g=yield this.getData();switch(g.type){case "FeatureCollection":g=g.features.map(m=>this.getCoordinatesFromGeometry(m.geometry)).flat(1/0);break;case "Feature":g=this.getCoordinatesFromGeometry(g.geometry);
break;default:g=this.getCoordinatesFromGeometry(g)}if(0==g.length)return b;for(let m=0;m<g.length-1;m+=2)b.extend([g[m],g[m+1]]);return b})}setClusterOptions(b){return this.workerOptions.cluster=b.cluster,b&&(void 0!==b.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(b.clusterRadius)),void 0!==b.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(b.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(b){return this.actor.sendAsync({type:"GCEZ",
data:{type:this.type,clusterId:b,source:this.id}})}getClusterChildren(b){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:b,source:this.id}})}getClusterLeaves(b,g,m){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:b,limit:g,offset:m}})}_updateWorkerData(){return v._(this,void 0,void 0,function*(){if(!this._isUpdatingWorker){var {data:b,diff:g}=this._pendingWorkerUpdate;if(!b&&!g)return void v.w(`No data or diff provided to GeoJSONSource ${this.id}.`);
var m=v.e({type:this.type},this.workerOptions);b?("string"==typeof b?(m.request=this.map._requestManager.transformRequest(qd.resolveURL(b),"Source"),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(b),this._pendingWorkerUpdate.data=void 0):g&&(m.dataDiff=g,this._pendingWorkerUpdate.diff=void 0);this._isUpdatingWorker=!0;this.fire(new v.l("dataloading",{dataType:"source"}));try{var u=yield this.actor.sendAsync({type:"LD",data:m});if(this._isUpdatingWorker=!1,this._removed||
u.abandoned)return void this.fire(new v.l("dataabort",{dataType:"source"}));this._data=u.data;m=null;u.resourceTiming&&u.resourceTiming[this.id]&&(m=u.resourceTiming[this.id].slice(0));u={dataType:"source"};this._collectResourceTiming&&m&&0<m.length&&v.e(u,{resourceTiming:m});this.fire(new v.l("data",Object.assign(Object.assign({},u),{sourceDataType:"metadata"})));this.fire(new v.l("data",Object.assign(Object.assign({},u),{sourceDataType:"content"})))}catch(z){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new v.l("dataabort",
{dataType:"source"}));this.fire(new v.k(z))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}})}loaded(){return!this._isUpdatingWorker&&void 0===this._pendingWorkerUpdate.data&&void 0===this._pendingWorkerUpdate.diff}loadTile(b){return v._(this,void 0,void 0,function*(){const g=b.actor?"RT":"LT";b.actor=this.actor;var m={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),
showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};b.abortController=new AbortController;m=yield this.actor.sendAsync({type:g,data:m},b.abortController);delete b.abortController;b.unloadVectorData();b.aborted||b.loadVectorData(m,this.map.painter,"RT"===g)})}abortTile(b){return v._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController);b.aborted=!0})}unloadTile(b){return v._(this,
void 0,void 0,function*(){b.unloadVectorData();yield this.actor.sendAsync({type:"RMT",data:{uid:b.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0;this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return v.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Td extends v.E{constructor(b,g,m,u){super();this.flippedWindingOrder=!1;this.id=b;this.dispatcher=m;this.coordinates=g.coordinates;this.type="image";this.minzoom=
0;this.maxzoom=22;this.tileSize=512;this.tiles={};this._loaded=!1;this.setEventedParent(u);this.options=g}load(b){return v._(this,void 0,void 0,function*(){this._loaded=!1;this.fire(new v.l("dataloading",{dataType:"source"}));this.url=this.options.url;this._request=new AbortController;try{const g=yield yf.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null;this._loaded=!0;g&&g.data&&(this.image=g.data,b&&(this.coordinates=b),this._finishLoading())}catch(g){this._request=
null,this._loaded=!0,this.fire(new v.k(g))}})}loaded(){return this._loaded}updateImage(b){return b.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=b.url,this.load(b.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(b){this.map=b;this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(b){this.coordinates=
b;b=b.map(v.a1.fromLngLat);var g;return this.tileID=function(m){m=v.a2.fromPoints(m);var u=m.width(),z=m.height();u=Math.max(0,Math.floor(-Math.log(Math.max(u,z))/Math.LN2));z=Math.pow(2,u);return new v.a4(u,Math.floor((m.minX+m.maxX)/2*z),Math.floor((m.minY+m.maxY)/2*z))}(b),this.terrainTileRanges=this._getOverlappingTileRanges(b),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=b.map(m=>this.tileID.getTilePoint(m)._round()),this.flippedWindingOrder=0>((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-
g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x),this.fire(new v.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0!==Object.keys(this.tiles).length&&this.image){var b=this.map.painter.context,g=b.gl;this.texture||(this.texture=new v.T(b,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));b=!1;for(const m in this.tiles)g=this.tiles[m],"loaded"!==g.state&&(g.state="loaded",g.texture=this.texture,b=!0);b&&this.fire(new v.l("data",{dataType:"source",sourceDataType:"idle",
sourceId:this.id}))}}loadTile(b){return v._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(b.tileID.canonical)?(this.tiles[String(b.tileID.wrap)]=b,b.buckets={}):b.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(b){const {minX:g,minY:m,maxX:u,maxY:z}=v.a2.fromPoints(b);b={};for(let C=0;C<=v.a3;C++){const G=Math.pow(2,C);b[C]={minTileX:Math.floor(g*G),minTileY:Math.floor(m*G),maxTileX:Math.floor(u*
G),maxTileY:Math.floor(z*G)}}return b}}class Mf extends Td{constructor(b,g,m,u){super(b,g,m,u);this.roundZoom=!0;this.type="video";this.options=g}load(){return v._(this,void 0,void 0,function*(){this._loaded=!1;const b=this.options;this.urls=[];for(const g of b.urls)this.urls.push(this.map._requestManager.transformRequest(g,"Source").url);try{const g=yield v.a5(this.urls);if(this._loaded=!0,g)this.video=g,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&
this.video.play(),this._finishLoading()}catch(g){this.fire(new v.k(g))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const g=this.video.seekable;b<g.start(0)||b>g.end(0)?this.fire(new v.k(new v.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${g.start(0)} and ${g.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),
this.setCoordinates(this.coordinates)))}prepare(){if(!(0===Object.keys(this.tiles).length||2>this.video.readyState)){var b=this.map.painter.context,g=b.gl;this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new v.T(b,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));b=!1;for(const m in this.tiles)g=this.tiles[m],"loaded"!==g.state&&(g.state="loaded",g.texture=this.texture,b=
!0);b&&this.fire(new v.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ee extends Td{constructor(b,g,m,u){super(b,g,m,u);g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(z=>!Array.isArray(z)||2!==z.length||z.some(C=>"number"!=typeof C))||this.fire(new v.k(new v.a6(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):
this.fire(new v.k(new v.a6(`sources.${b}`,null,'missing required property "coordinates"')));g.animate&&"boolean"!=typeof g.animate&&this.fire(new v.k(new v.a6(`sources.${b}`,null,'optional "animate" property must be a boolean value')));g.canvas?"string"==typeof g.canvas||g.canvas instanceof HTMLCanvasElement||this.fire(new v.k(new v.a6(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.k(new v.a6(`sources.${b}`,
null,'missing required property "canvas"')));this.options=g;this.animate=void 0===g.animate||g.animate}load(){return v._(this,void 0,void 0,function*(){this._loaded=!0;this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas));this.width=this.canvas.width;this.height=this.canvas.height;this._hasInvalidDimensions()?this.fire(new v.k(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=
!0;this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(b){this.map=b;this.load();this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){var b=!1;if((this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions())&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,
m=g.gl;this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.T(g,this.canvas,m.RGBA,{premultiply:!0});b=!1;for(const u in this.tiles)g=this.tiles[u],"loaded"!==g.state&&(g.state="loaded",g.texture=this.texture,b=!0);b&&this.fire(new v.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,
this.canvas.height])if(isNaN(b)||0>=b)return!0;return!1}}const zf={},$c=b=>{switch(b){case "geojson":return kg;case "image":return Td;case "raster":return Ff;case "raster-dem":return qg;case "vector":return Gg;case "video":return Mf;case "canvas":return Ee}return zf[b]};class Zd extends v.E{constructor(){super(...arguments);this.status="unavailable";this.url=null;this.dispatcher=tc()}_syncState(b){return this.status=b,this.dispatcher.broadcast("SRPS",{pluginStatus:b,pluginURL:this.url}).catch(g=>
{throw this.status="error",g;})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable";this.url=null}setRTLTextPlugin(b){return v._(this,arguments,void 0,function*(g,m=!1){if(this.url)throw Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=qd.resolveURL(g),!this.url)throw Error(`requested url ${g} is invalid`);if("unavailable"===this.status){if(!m)return this._requestImport();this.status="deferred";this._syncState(this.status)}else if("requested"===
this.status)return this._requestImport()})}_requestImport(){return v._(this,void 0,void 0,function*(){yield this._syncState("loading");this.status="loaded";this.fire(new v.l("RTLPluginLoaded"))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let Wf=null;var Vd,jf;!function(b){b[b.Base=0]="Base";b[b.Parent=1]="Parent"}(Vd||(Vd={}));(function(b){b[b.Departing=0]="Departing";b[b.Incoming=1]="Incoming"})(jf||(jf={}));class bi{constructor(b,
g){this.fadeEndTime=this.timeAdded=0;this.fadeOpacity=1;this.tileID=b;this.uid=v.a7();this.uses=0;this.tileSize=g;this.buckets={};this.expirationTime=null;this.queryPadding=0;this.hasRTLText=this.hasSymbolBuckets=!1;this.dependencies={};this.rtt=[];this.rttCoords={};this.expiredRequestCount=0;this.state="loading"}isRenderable(b){return this.hasData()&&(!this.fadeEndTime||0<this.fadeOpacity)&&(b||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:b,fadingDirection:g,fadingParentID:m,fadeEndTime:u}){this.resetFadeLogic();
this.fadingRole=b;this.fadingDirection=g;this.fadingParentID=m;this.fadeEndTime=u}setSelfFadeLogic(b){this.resetFadeLogic();this.selfFading=!0;this.fadeEndTime=b}resetFadeLogic(){this.fadingParentID=this.fadingDirection=this.fadingRole=null;this.selfFading=!1;this.timeAdded=qd.now();this.fadeEndTime=0;this.fadeOpacity=1}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(b){this.demTexture&&b.saveTileTexture(this.demTexture);this.demTexture=null}loadVectorData(b,
g,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",b){b.featureIndex&&(this.latestFeatureIndex=b.featureIndex,b.rawTileData?(this.latestRawTileData=b.rawTileData,this.latestFeatureIndex.rawTileData=b.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData));this.collisionBoxArray=b.collisionBoxArray;this.buckets=function(z,C){const G={};if(!C)return G;for(const K of z){const R=K.layerIds.map(X=>C.getLayer(X)).filter(Boolean);if(0!==R.length){K.layers=
R;K.stateDependentLayerIds&&(K.stateDependentLayers=K.stateDependentLayerIds.map(X=>R.filter(ca=>ca.id===X)[0]));for(const X of R)G[X.id]=K}}return G}(b.buckets,null==g?void 0:g.style);this.hasSymbolBuckets=!1;for(const z in this.buckets){const C=this.buckets[z];if(C instanceof v.a9){if(this.hasSymbolBuckets=!0,!m)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var u in this.buckets)if(m=this.buckets[u],m instanceof v.a9&&m.hasRTLText){this.hasRTLText=!0;zb().lazyLoad();break}this.queryPadding=
0;for(const z in this.buckets)u=this.buckets[z],this.queryPadding=Math.max(this.queryPadding,g.style.getLayer(z).queryRadius(u));b.imageAtlas&&(this.imageAtlas=b.imageAtlas);b.glyphAtlasImage&&(this.glyphAtlasImage=b.glyphAtlasImage);this.dashPositions=b.dashPositions}else this.collisionBoxArray=new v.a8}unloadVectorData(){for(const b in this.buckets)this.buckets[b].destroy();this.buckets={};this.imageAtlasTexture&&this.imageAtlasTexture.destroy();this.imageAtlas&&(this.imageAtlas=null);this.glyphAtlasTexture&&
this.glyphAtlasTexture.destroy();this.dashPositions&&(this.dashPositions=null);this.latestFeatureIndex=null;this.state="unloaded"}getBucket(b){return this.buckets[b.id]}upload(b){for(var g in this.buckets){const m=this.buckets[g];m.uploadPending()&&m.upload(b)}g=b.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new v.T(b,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0);this.glyphAtlasImage&&(this.glyphAtlasTexture=new v.T(b,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=
null)}prepare(b){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(b,this.imageAtlasTexture)}queryRenderedFeatures(b,g,m,u,z,C,G,K,R,X,ca){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:z,scale:C,tileSize:this.tileSize,pixelPosMatrix:X,transform:K,params:G,queryPadding:this.queryPadding*R,getElevation:ca},b,g,m):{}}querySourceFeatures(b,g){const m=this.latestFeatureIndex;if(m&&m.rawTileData){var u=m.loadVTLayers(),
z=g&&g.sourceLayer?g.sourceLayer:"";if(u=u._geojsonTileLayer||u[z]){g=v.aa(null==g?void 0:g.filter,null==g?void 0:g.globalState);var {z:C,x:G,y:K}=this.tileID.canonical,R={z:C,x:G,y:K};for(let ja=0;ja<u.length;ja++){var X=u.feature(ja);if(g.needGeometry){var ca=v.ab(X,!0);if(!g.filter(new v.F(this.tileID.overscaledZ),ca,this.tileID.canonical))continue}else if(!g.filter(new v.F(this.tileID.overscaledZ),X))continue;ca=m.getId(X,z);X=new v.ac(X,C,G,K,ca);X.tile=R;b.push(X)}}}}hasData(){return"loaded"===
this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(b){var g=this.expirationTime;b.cacheControl?(b=v.ad(b.cacheControl),b["max-age"]&&(this.expirationTime=Date.now()+1E3*b["max-age"])):b.expires&&(this.expirationTime=(new Date(b.expires)).getTime());if(this.expirationTime){b=Date.now();let m=!1;this.expirationTime>b?m=!1:g?this.expirationTime<g?m=!0:(g=this.expirationTime-g)?this.expirationTime=
b+Math.max(g,3E4):m=!0:m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1E3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(b,g){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(b).length){var m=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!g.style.hasLayer(C))continue;
const G=this.buckets[C];var u=G.layers[0].sourceLayer||"_geojsonTileLayer",z=m[u];u=b[u];z&&u&&0!==Object.keys(u).length&&(G.update(u,z,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{}),(z=g&&g.style&&g.style.getLayer(C))&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(G))))}}}holdingForSymbolFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<qd.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=
void 0}setSymbolHoldDuration(b){this.symbolFadeHoldUntil=qd.now()+b}setDependencies(b,g){const m={};for(const u of g)m[u]=!0;this.dependencies[b]=m}hasDependency(b,g){for(const m of b)if(b=this.dependencies[m])for(const u of g)if(b[u])return!0;return!1}}class Xj{constructor(b,g){this.max=b;this.onRemove=g;this.reset()}reset(){for(const b in this.data)for(const g of this.data[b])g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value);return this.data={},this.order=[],this}add(b,g,m){const u=b.wrapped().key;
void 0===this.data[u]&&(this.data[u]=[]);const z={value:g,timeout:void 0};(void 0!==m&&(z.timeout=setTimeout(()=>{this.remove(b,z)},m)),this.data[u].push(z),this.order.push(u),this.order.length>this.max)&&(g=this._getAndRemoveByKey(this.order[0]))&&this.onRemove(g);return this}has(b){return b.wrapped().key in this.data}getAndRemove(b){return this.has(b)?this._getAndRemoveByKey(b.wrapped().key):null}_getAndRemoveByKey(b){const g=this.data[b].shift();return g.timeout&&clearTimeout(g.timeout),0===this.data[b].length&&
delete this.data[b],this.order.splice(this.order.indexOf(b),1),g.value}getByKey(b){return(b=this.data[b])?b[0].value:null}get(b){return this.has(b)?this.data[b.wrapped().key][0].value:null}remove(b,g){if(!this.has(b))return this;b=b.wrapped().key;g=void 0===g?0:this.data[b].indexOf(g);const m=this.data[b][g];return this.data[b].splice(g,1),m.timeout&&clearTimeout(m.timeout),0===this.data[b].length&&delete this.data[b],this.onRemove(m.value),this.order.splice(this.order.indexOf(b),1),this}setMaxSize(b){for(this.max=
b;this.order.length>this.max;)(b=this._getAndRemoveByKey(this.order[0]))&&this.onRemove(b);return this}filter(b){const g=[];for(const m in this.data)for(const u of this.data[m])b(u.value)||g.push(u);for(const m of g)this.remove(m.value.tileID,m)}}class ci{constructor(){this.state={};this.stateChanges={};this.deletedStates={}}updateState(b,g,m){g=String(g);if(this.stateChanges[b]=this.stateChanges[b]||{},this.stateChanges[b][g]=this.stateChanges[b][g]||{},v.e(this.stateChanges[b][g],m),null===this.deletedStates[b]){this.deletedStates[b]=
{};for(const u in this.state[b])u!==g&&(this.deletedStates[b][u]=null)}else if(this.deletedStates[b]&&null===this.deletedStates[b][g]){this.deletedStates[b][g]={};for(const u in this.state[b][g])m[u]||(this.deletedStates[b][g][u]=null)}else for(const u in m)this.deletedStates[b]&&this.deletedStates[b][g]&&null===this.deletedStates[b][g][u]&&delete this.deletedStates[b][g][u]}removeFeatureState(b,g,m){if(null!==this.deletedStates[b]){var u=String(g);if(this.deletedStates[b]=this.deletedStates[b]||
{},m&&void 0!==g)null!==this.deletedStates[b][u]&&(this.deletedStates[b][u]=this.deletedStates[b][u]||{},this.deletedStates[b][u][m]=null);else if(void 0!==g)if(this.stateChanges[b]&&this.stateChanges[b][u])for(m in this.deletedStates[b][u]={},this.stateChanges[b][u])this.deletedStates[b][u][m]=null;else this.deletedStates[b][u]=null;else this.deletedStates[b]=null}}getState(b,g){var m=String(g);m=v.e({},(this.state[b]||{})[m],(this.stateChanges[b]||{})[m]);if(null===this.deletedStates[b])return{};
if(this.deletedStates[b]){b=this.deletedStates[b][g];if(null===b)return{};for(const u in b)delete m[u]}return m}initializeTileState(b,g){b.setFeatureState(this.state,g)}coalesceChanges(b,g){const m={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};const z={};for(const C in this.stateChanges[u])this.state[u][C]||(this.state[u][C]={}),v.e(this.state[u][C],this.stateChanges[u][C]),z[C]=this.state[u][C];m[u]=z}for(const z in this.deletedStates){this.state[z]=this.state[z]||{};u={};if(null===
this.deletedStates[z])for(const C in this.state[z])u[C]={},this.state[z][C]={};else for(const C in this.deletedStates[z]){if(null===this.deletedStates[z][C])this.state[z][C]={};else for(const G of Object.keys(this.deletedStates[z][C]))delete this.state[z][C][G];u[C]=this.state[z][C]}m[z]=m[z]||{};v.e(m[z],u)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(m).length)for(const z in b)b[z].setFeatureState(m,g)}}const di=dc(9.314,3),vj=v.a2.fromPoints([new v.P(0,0),new v.P(v.$,v.$)]);class Od extends v.E{constructor(b,
g,m){super();this.id=b;this.dispatcher=m;this.on("data",u=>this._dataHandler(u));this.on("dataloading",()=>{this._sourceErrored=!1});this.on("error",()=>{this._sourceErrored=this._source.loaded()});this._source=((u,z,C,G)=>{z=new ($c(z.type))(u,z,C,G);if(z.id!==u)throw Error(`Expected Source id to be ${u} instead of ${z.id}`);return z})(b,g,m,this);this._tiles={};this._cache=new Xj(0,u=>this._unloadTile(u));this._timers={};this._cacheTimers={};this._maxTileCacheZoomLevels=this._maxTileCacheSize=null;
this._rasterFadeDuration=0;this._maxFadingAncestorLevels=5;this._state=new ci;this._updated=this._didEmitContent=!1}onAdd(b){this._maxTileCacheSize=(this.map=b)?b._maxTileCacheSize:null;this._maxTileCacheZoomLevels=b?b._maxTileCacheZoomLevels:null;this._source&&this._source.onAdd&&this._source.onAdd(b)}onRemove(b){this.clearTiles();this._source&&this._source.onRemove&&this._source.onRemove(b)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===
this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const b in this._tiles){const g=this._tiles[b];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(this._paused){var b=this._shouldReloadOnResume;this._shouldReloadOnResume=this._paused=!1;b&&this.reload();this.transform&&this.update(this.transform,this.terrain)}}_loadTile(b,g,m){return v._(this,void 0,void 0,
function*(){try{yield this._source.loadTile(b),this._tileLoaded(b,g,m)}catch(u){b.state="errored",404!==u.status?this._source.fire(new v.k(u,{tile:b})):this.update(this.transform,this.terrain)}})}_unloadTile(b){this._source.unloadTile&&this._source.unloadTile(b)}_abortTile(b){this._source.abortTile&&this._source.abortTile(b);this._source.fire(new v.l("dataabort",{tile:b,coord:b.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(b){this._source.prepare&&this._source.prepare();
this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const g in this._tiles){const m=this._tiles[g];m.upload(b);m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(b=>b.tileID).sort(pd).map(b=>b.key)}getRenderableIds(b){const g=[];for(const m in this._tiles)this._isIdRenderable(m,b)&&g.push(this._tiles[m]);return b?g.sort((m,u)=>{m=m.tileID;u=u.tileID;const z=(new v.P(m.canonical.x,m.canonical.y))._rotate(-this.transform.bearingInRadians),
C=(new v.P(u.canonical.x,u.canonical.y))._rotate(-this.transform.bearingInRadians);return m.overscaledZ-u.overscaledZ||C.y-z.y||C.x-z.x}).map(m=>m.tileID.key):g.map(m=>m.tileID).sort(pd).map(m=>m.key)}hasRenderableParent(b){const g=b.overscaledZ-1;return g>=this._source.minzoom&&(b=this._getLoadedTile(b.scaledTo(g)))?this._isIdRenderable(b.tileID.key):!1}_isIdRenderable(b,g=!1){var m;return null===(m=this._tiles[b])||void 0===m?void 0:m.isRenderable(g)}reload(b){if(this._paused)this._shouldReloadOnResume=
!0;else{this._cache.reset();for(const g in this._tiles)b?this._reloadTile(g,"expired"):"errored"!==this._tiles[g].state&&this._reloadTile(g,"reloading")}}_reloadTile(b,g){return v._(this,void 0,void 0,function*(){const m=this._tiles[b];m&&("loading"!==m.state&&(m.state=g),yield this._loadTile(m,b,g))})}_tileLoaded(b,g,m){b.timeAdded=qd.now();"expired"===m&&(b.refreshedUponExpiration=!0);this._setTileReloadTimer(g,b);"raster-dem"===this.getSource().type&&b.dem&&this._backfillDEM(b);this._state.initializeTileState(b,
this.map?this.map.painter:null);b.aborted||this._source.fire(new v.l("data",{dataType:"source",tile:b,coord:b.tileID}))}_backfillDEM(b){function g(z,C){z.needsHillshadePrepare=!0;z.needsTerrainPrepare=!0;let G=C.tileID.canonical.x-z.tileID.canonical.x;const K=C.tileID.canonical.y-z.tileID.canonical.y,R=Math.pow(2,z.tileID.canonical.z),X=C.tileID.key;0===G&&0===K||1<Math.abs(K)||(1<Math.abs(G)&&(1===Math.abs(G+R)?G+=R:1===Math.abs(G-R)&&(G-=R)),C.dem&&z.dem&&(z.dem.backfillBorder(C.dem,G,K),z.neighboringTiles&&
z.neighboringTiles[X]&&(z.neighboringTiles[X].backfilled=!0)))}const m=this.getRenderableIds();for(let z=0;z<m.length;z++){var u=m[z];b.neighboringTiles&&b.neighboringTiles[u]&&(u=this.getTileByID(u),g(b,u),g(u,b))}}getTile(b){return this.getTileByID(b.key)}getTileByID(b){return this._tiles[b]}_retainLoadedChildren(b,g){var m=Object.values(b);b=this._getLoadedDescendents(m);const u={};for(const z of m){m=b[z.key];if(null==m||!m.length){u[z.key]=z;continue}const C=z.overscaledZ+Od.maxUnderzooming;
m=m.filter(K=>K.tileID.overscaledZ<=C);if(!m.length){u[z.key]=z;continue}const G=Math.min(...m.map(K=>K.tileID.overscaledZ));m=m.filter(K=>K.tileID.overscaledZ===G).map(K=>K.tileID);for(const K of m)g[K.key]=K;this._areDescendentsComplete(m,G,z.overscaledZ)||(u[z.key]=z)}return u}_getLoadedDescendents(b){var g;const m={};for(const u in this._tiles){const z=this._tiles[u];if(z.hasData())for(const C of b)z.tileID.isChildOf(C)&&(m[g=C.key]||(m[g]=[])).push(z)}return m}_areDescendentsComplete(b,g,m){return 1===
b.length&&b[0].isOverscaled()?b[0].overscaledZ===g:Math.pow(4,g-m)===b.length}_getLoadedTile(b){b=this._tiles[b.key];return(null==b?0:b.hasData())?b:null}updateCacheSize(b){b=Math.floor((Math.ceil(b.width/this._source.tileSize)+1)*(Math.ceil(b.height/this._source.tileSize)+1)*(null===this._maxTileCacheZoomLevels?v.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels));this._cache.setMaxSize("number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,b):b)}handleWrapJump(b){const g=
Math.round((b-(void 0===this._prevLng?b:this._prevLng))/360);if(this._prevLng=b,g){b={};for(const m in this._tiles){const u=this._tiles[m];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+g);b[u.tileID.key]=u}this._tiles=b;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}update(b,g){if(this._sourceLoaded&&!this._paused){var m;this.transform=b;this.terrain=g;this.updateCacheSize(b);this.handleWrapJump(this.transform.center.lng);
this.used||this.usedForTerrain?this._source.tileID?m=b.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new v.Z(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(m=Nc(b,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:g,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&
(m=m.filter(z=>this._source.hasTile(z)))):m=[];this.usedForTerrain&&(m=this._addTerrainIdealTiles(m));var u=0===m.length&&!this._updated&&this._didEmitContent;this._updated=!0;u&&this.fire(new v.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));b=xc(b,this._source);b=this._updateRetainedTiles(m,b);(u=Ic(this._source.type))&&0<this._rasterFadeDuration&&!g&&this._updateFadingTiles(m,b);u?this._cleanUpRasterTiles(b):this._cleanUpVectorTiles(b)}}_cleanUpRasterTiles(b){for(const g in this._tiles)b[g]||
this._removeTile(g)}_cleanUpVectorTiles(b){for(const g in this._tiles){const m=this._tiles[g];b[g]?m.clearSymbolFadeHold():m.hasSymbolBuckets?m.holdingForSymbolFade()?m.symbolFadeFinished()&&this._removeTile(g):m.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(g)}}_addTerrainIdealTiles(b){const g=[];for(const u of b)if(u.canonical.z>this._source.minzoom){var m=u.scaledTo(u.canonical.z-1);g.push(m);m=u.scaledTo(Math.max(this._source.minzoom,Math.min(u.canonical.z,5)));g.push(m)}return b.concat(g)}releaseSymbolFadeTiles(){for(const b in this._tiles)this._tiles[b].holdingForSymbolFade()&&
this._removeTile(b)}_updateRetainedTiles(b,g){var m;const u={},z={};g=Math.max(g-Od.maxOverzooming,this._source.minzoom);let C={};for(var G of b)b=this._addTile(G),u[G.key]=G,b.hasData()||(C[G.key]=G);C=this._retainLoadedChildren(C,u);for(const K in C){G=C[K];b=this._tiles[K];let R=null==b?void 0:b.wasRequested();for(let X=G.overscaledZ-1;X>=g;--X){const ca=G.scaledTo(X);if(z[ca.key])break;if(z[ca.key]=!0,b=this.getTile(ca),!b&&R&&(b=this._addTile(ca)),b){const ja=b.hasData();if((ja||!(null===(m=
this.map)||void 0===m?0:m.cancelPendingTileRequestsWhileZooming)||R)&&(u[ca.key]=ca),R=b.wasRequested(),ja)break}}}return u}_updateFadingTiles(b,g){const m=qd.now(),u=v.am(b);for(const z of b)b=this._tiles[z.key],b.fadingDirection!==jf.Departing&&0!==b.fadeOpacity||b.resetFadeLogic(),this._updateFadingAncestor(b,g,m)||this._updateFadingDescendents(b,g,m)||this._updateFadingEdge(b,u,m)||b.resetFadeLogic()}_updateFadingAncestor(b,g,m){if(!b.hasData())return!1;const {tileID:u,fadingRole:z,fadingDirection:C,
fadingParentID:G}=b;if(z===Vd.Base&&C===jf.Incoming&&G)return g[G.key]=G,!0;const K=Math.max(u.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let R=u.overscaledZ-1;R>=K;R--){const X=u.scaledTo(R),ca=this._getLoadedTile(X);if(ca)return b.setCrossFadeLogic({fadingRole:Vd.Base,fadingDirection:jf.Incoming,fadingParentID:ca.tileID,fadeEndTime:m+this._rasterFadeDuration}),ca.setCrossFadeLogic({fadingRole:Vd.Parent,fadingDirection:jf.Departing,fadeEndTime:m+this._rasterFadeDuration}),
g[X.key]=X,!0}return!1}_updateFadingDescendents(b,g,m){if(!b.hasData())return!1;var u=b.tileID.children(this._source.maxzoom);let z=this._updateFadingChildren(b,u,g,m);if(z)return!0;for(const C of u)u=C.children(this._source.maxzoom),this._updateFadingChildren(b,u,g,m)&&(z=!0);return z}_updateFadingChildren(b,g,m,u){if(g[0].overscaledZ>=this._source.maxzoom)return!1;let z=!1;for(const C of g){g=this._getLoadedTile(C);if(!g)continue;const {fadingRole:G,fadingDirection:K,fadingParentID:R}=g;G===Vd.Base&&
K===jf.Departing&&R||(g.setCrossFadeLogic({fadingRole:Vd.Base,fadingDirection:jf.Departing,fadingParentID:b.tileID,fadeEndTime:u+this._rasterFadeDuration}),b.setCrossFadeLogic({fadingRole:Vd.Parent,fadingDirection:jf.Incoming,fadeEndTime:u+this._rasterFadeDuration}));m[C.key]=C;z=!0}return z}_updateFadingEdge(b,g,m){const u=b.tileID;return!!b.selfFading||!b.hasData()&&!!g.has(u)&&(b.setSelfFadeLogic(m+this._rasterFadeDuration),!0)}_addTile(b){let g=this._tiles[b.key];if(g)return g;(g=this._cache.getAndRemove(b))&&
(g.resetFadeLogic(),this._setTileReloadTimer(b.key,g),g.tileID=b,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[b.key]&&(clearTimeout(this._cacheTimers[b.key]),delete this._cacheTimers[b.key],this._setTileReloadTimer(b.key,g)));const m=g;return g||(g=new bi(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(g,b.key,g.state)),g.uses++,this._tiles[b.key]=g,m||this._source.fire(new v.l("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g}_setTileReloadTimer(b,
g){b in this._timers&&(clearTimeout(this._timers[b]),delete this._timers[b]);(g=g.getExpiryTimeout())&&(this._timers[b]=setTimeout(()=>{this._reloadTile(b,"expired");delete this._timers[b]},g))}refreshTiles(b){for(const g in this._tiles)(this._isIdRenderable(g)||"errored"==this._tiles[g].state)&&b.some(m=>m.equals(this._tiles[g].tileID.canonical))&&this._reloadTile(g,"expired")}_removeTile(b){const g=this._tiles[b];g&&(g.uses--,delete this._tiles[b],this._timers[b]&&(clearTimeout(this._timers[b]),
delete this._timers[b]),0<g.uses||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}_dataHandler(b){"source"===b.dataType&&("metadata"!==b.sourceDataType?"content"===b.sourceDataType&&this._sourceLoaded&&!this._paused&&(this.reload(b.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._paused=this._shouldReloadOnResume=
!1;for(const b in this._tiles)this._removeTile(b);this._cache.reset()}tilesIn(b,g,m){const u=[],z=this.transform;if(!z)return u;const C=z.getCoveringTilesDetailsProvider().allowWorldCopies();m=m?z.getCameraQueryGeometry(b):b;var G=X=>z.screenPointToMercatorCoordinate(X,this.terrain);b=this.transformBbox(b,G,!C);m=this.transformBbox(m,G,!C);G=this.getIds();const K=v.a2.fromPoints(m);for(let X=0;X<G.length;X++){const ca=this._tiles[G[X]];if(ca.holdingForSymbolFade())continue;var R=C?[ca.tileID]:[ca.tileID.unwrapTo(-1),
ca.tileID.unwrapTo(0)];const ja=Math.pow(2,z.zoom-ca.tileID.overscaledZ),la=g*ca.queryPadding*v.$/ca.tileSize/ja;for(const pa of R)if(R=K.map(ya=>pa.getTilePoint(new v.a1(ya.x,ya.y))),R.expandBy(la),R.intersects(vj)){R=b.map(Ba=>pa.getTilePoint(Ba));const ya=m.map(Ba=>pa.getTilePoint(Ba));u.push({tile:ca,tileID:C?pa:pa.unwrapTo(0),queryGeometry:R,cameraQueryGeometry:ya,scale:ja})}}return u}transformBbox(b,g,m){let u=b.map(g);m&&(b=v.a2.fromPoints(b),b.shrinkBy(.001*Math.min(b.width(),b.height())),
g=b.map(g),v.a2.fromPoints(u).covers(g)||(u=u.map(z=>.5<z.x?new v.a1(z.x-1,z.y,z.z):z)));return u}getVisibleCoordinates(b){b=this.getRenderableIds(b).map(g=>this._tiles[g].tileID);return this.transform&&this.transform.populateCache(b),b}hasTransition(){if(this._source.hasTransition())return!0;if(Ic(this._source.type)&&0<this._rasterFadeDuration){const b=qd.now();for(const g in this._tiles)if(this._tiles[g].fadeEndTime>=b)return!0}return!1}setRasterFadeDuration(b){this._rasterFadeDuration=b}setFeatureState(b,
g,m){this._state.updateState(b||"_geojsonTileLayer",g,m)}removeFeatureState(b,g,m){this._state.removeFeatureState(b||"_geojsonTileLayer",g,m)}getFeatureState(b,g){return this._state.getState(b||"_geojsonTileLayer",g)}setDependencies(b,g,m){(b=this._tiles[b])&&b.setDependencies(g,m)}reloadTilesForDependencies(b,g){for(const m in this._tiles)this._tiles[m].hasDependency(b,g)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(b,g))}}Od.maxOverzooming=10;Od.maxUnderzooming=3;class Nf{constructor(b,
g){this.reset(b,g)}reset(b,g){this.points=b||[];this._distances=[0];for(b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1];this.padding=Math.min(g||0,.5*this.length);this.paddedLength=this.length-2*this.padding}lerp(b){if(1===this.points.length)return this.points[0];b=v.ah(b,0,1);let g=1;var m=this._distances[g];const u=b*this.paddedLength+this.padding;for(;m<u&&g<this._distances.length;)m=
this._distances[++g];b=g-1;const z=this._distances[b];m-=z;m=0<m?(u-z)/m:0;return this.points[b].mult(1-m).add(this.points[g].mult(m))}}class Ue{constructor(b,g,m){const u=this.boxCells=[],z=this.circleCells=[];this.xCellCount=Math.ceil(b/m);this.yCellCount=Math.ceil(g/m);for(m=0;m<this.xCellCount*this.yCellCount;m++)u.push([]),z.push([]);this.circleKeys=[];this.boxKeys=[];this.bboxes=[];this.circles=[];this.width=b;this.height=g;this.xScale=this.xCellCount/b;this.yScale=this.yCellCount/g;this.circleUid=
this.boxUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(b,g,m,u,z){this._forEachCell(g,m,u,z,this._insertBoxCell,this.boxUid++);this.boxKeys.push(b);this.bboxes.push(g);this.bboxes.push(m);this.bboxes.push(u);this.bboxes.push(z)}insertCircle(b,g,m,u){this._forEachCell(g-u,m-u,g+u,m+u,this._insertCircleCell,this.circleUid++);this.circleKeys.push(b);this.circles.push(g);this.circles.push(m);this.circles.push(u)}_insertBoxCell(b,g,m,u,z,C){this.boxCells[z].push(C)}_insertCircleCell(b,
g,m,u,z,C){this.circleCells[z].push(C)}_query(b,g,m,u,z,C,G){if(0>m||b>this.width||0>u||g>this.height)return[];const K=[];if(0>=b&&0>=g&&this.width<=m&&this.height<=u){if(z)return[{key:null,x1:b,y1:g,x2:m,y2:u}];for(b=0;b<this.boxKeys.length;b++)K.push({key:this.boxKeys[b],x1:this.bboxes[4*b],y1:this.bboxes[4*b+1],x2:this.bboxes[4*b+2],y2:this.bboxes[4*b+3]});for(b=0;b<this.circleKeys.length;b++)g=this.circles[3*b],m=this.circles[3*b+1],u=this.circles[3*b+2],K.push({key:this.circleKeys[b],x1:g-u,
y1:m-u,x2:g+u,y2:m+u})}else this._forEachCell(b,g,m,u,this._queryCell,K,{hitTest:z,overlapMode:C,seenUids:{box:{},circle:{}}},G);return K}query(b,g,m,u){return this._query(b,g,m,u,!1,null)}hitTest(b,g,m,u,z,C){return 0<this._query(b,g,m,u,!0,z,C).length}hitTestCircle(b,g,m,u,z){const C=b-m,G=b+m,K=g-m,R=g+m;if(0>G||C>this.width||0>R||K>this.height)return!1;const X=[];return this._forEachCell(C,K,G,R,this._queryCellCircle,X,{hitTest:!0,overlapMode:u,circle:{x:b,y:g,radius:m},seenUids:{box:{},circle:{}}},
z),0<X.length}_queryCell(b,g,m,u,z,C,G,K){const {seenUids:R,hitTest:X,overlapMode:ca}=G;var ja=this.boxCells[z];if(null!==ja){G=this.bboxes;for(var la of ja)if(!R.box[la]){R.box[la]=!0;ja=4*la;var pa=this.boxKeys[la];if(b<=G[ja+2]&&g<=G[ja+3]&&m>=G[ja+0]&&u>=G[ja+1]&&(!K||K(pa))&&(!X||!Rc(ca,pa.overlapMode))&&(C.push({key:pa,x1:G[ja],y1:G[ja+1],x2:G[ja+2],y2:G[ja+3]}),X))return!0}}la=this.circleCells[z];if(null!==la){z=this.circles;for(const ya of la)if(!R.circle[ya]&&(R.circle[ya]=!0,pa=3*ya,la=
this.circleKeys[ya],!(!this._circleAndRectCollide(z[pa],z[pa+1],z[pa+2],b,g,m,u)||K&&!K(la)||X&&Rc(ca,la.overlapMode))&&(G=z[pa],ja=z[pa+1],pa=z[pa+2],C.push({key:la,x1:G-pa,y1:ja-pa,x2:G+pa,y2:ja+pa}),X)))return!0}return!1}_queryCellCircle(b,g,m,u,z,C,G,K){const {circle:R,seenUids:X,overlapMode:ca}=G;g=this.boxCells[z];if(null!==g){b=this.bboxes;for(var ja of g)if(!X.box[ja]&&(X.box[ja]=!0,g=4*ja,m=this.boxKeys[ja],this._circleAndRectCollide(R.x,R.y,R.radius,b[g+0],b[g+1],b[g+2],b[g+3])&&(!K||K(m))&&
!Rc(ca,m.overlapMode)))return C.push(!0),!0}ja=this.circleCells[z];if(null!==ja){z=this.circles;for(const la of ja)if(!X.circle[la]&&(X.circle[la]=!0,ja=3*la,b=this.circleKeys[la],this._circlesCollide(z[ja],z[ja+1],z[ja+2],R.x,R.y,R.radius)&&(!K||K(b))&&!Rc(ca,b.overlapMode)))return C.push(!0),!0}}_forEachCell(b,g,m,u,z,C,G,K){var R=this._convertToXCellCoord(b);const X=this._convertToYCellCoord(g),ca=this._convertToXCellCoord(m),ja=this._convertToYCellCoord(u);for(;R<=ca;R++)for(let la=X;la<=ja;la++)if(z.call(this,
b,g,m,u,this.xCellCount*la+R,C,G,K))return}_convertToXCellCoord(b){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(b*this.xScale)))}_convertToYCellCoord(b){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(b*this.yScale)))}_circlesCollide(b,g,m,u,z,C){b=u-b;g=z-g;m+=C;return m*m>b*b+g*g}_circleAndRectCollide(b,g,m,u,z,C,G){C=(C-u)/2;b=Math.abs(b-(u+C));if(b>C+m)return!1;G=(G-z)/2;g=Math.abs(g-(z+G));if(g>G+m)return!1;if(b<=C||g<=G)return!0;z=b-C;g-=G;return z*z+g*g<=m*m}}const th=new Float32Array([-1/
0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);class Di{constructor(b,g=new Ue(b.width+200,b.height+200,25),m=new Ue(b.width+200,b.height+200,25)){this.transform=b;this.grid=g;this.ignoredGrid=m;this.pitchFactor=Math.cos(b.pitch*Math.PI/180)*b.cameraToCenterDistance;this.screenRightBoundary=b.width+100;this.screenBottomBoundary=b.height+100;this.gridRightBoundary=b.width+200;this.gridBottomBoundary=b.height+200;this.perspectiveRatioCutoff=.6}placeCollisionBox(b,g,m,u,z,C,G,K,R,X,ca,ja){const la=this.projectAndGetPerspectiveRatio(b.anchorPointX+
K[0],b.anchorPointY+K[1],z,X,ja);m*=la.perspectiveRatio;C||G?b=this._projectCollisionBox(b,m,u,z,C,G,K,la,X,ca,ja):(u=la.x+(ca?ca.x*m:0),ca=la.y+(ca?ca.y*m:0),b={allPointsOccluded:!1,box:[u+b.x1*m,ca+b.y1*m,u+b.x2*m,ca+b.y2*m]});const [pa,ya,Ba,za]=b.box;b=C=C?b.allPointsOccluded:la.isOccluded;return b||(b=la.perspectiveRatio<this.perspectiveRatioCutoff),b||(b=!this.isInsideGrid(pa,ya,Ba,za)),b||"always"!==g&&this.grid.hitTest(pa,ya,Ba,za,g,R)?{box:[pa,ya,Ba,za],placeable:!1,offscreen:!1,occluded:C}:
{box:[pa,ya,Ba,za],placeable:!0,offscreen:this.isOffscreen(pa,ya,Ba,za),occluded:C}}placeCollisionCircles(b,g,m,u,z,C,G,K,R,X,ca,ja,la,pa){const ya=[];var Ba=new v.P(g.anchorX,g.anchorY);const za=this.getPerspectiveRatio(Ba.x,Ba.y,C,pa);z=(R?z*this.transform.getPitchedTextCorrection(g.anchorX,g.anchorY,C)/za:z*za)/v.aB;G={getElevation:pa,pitchedLabelPlaneMatrix:G,lineVertexArray:m,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,
tileAnchorPoint:Ba,unwrappedTileID:C,width:this.transform.width,height:this.transform.height,translation:la};Ba=Tc(z,u,g.lineOffsetX*z,g.lineOffsetY*z,!1,g,!1,G);u=g=!1;m=!0;if(Ba){ca=.5*ca*za+ja;la=new v.P(-100,-100);pa=new v.P(this.screenRightBoundary,this.screenBottomBoundary);ja=new Nf;C=Ba.first;z=Ba.last;Ba=[];for(var Ea=C.path.length-1;1<=Ea;Ea--)Ba.push(C.path[Ea]);for(C=1;C<z.path.length;C++)Ba.push(z.path[C]);C=2.5*ca;R&&(R=this.projectPathToScreenSpace(Ba,G),Ba=R.some(Qa=>0>=Qa.signedDistanceFromCamera)?
[]:R.map(Qa=>Qa.point));R=[];if(0<Ba.length){R=Ba[0].clone();G=Ba[0].clone();for(z=1;z<Ba.length;z++)R.x=Math.min(R.x,Ba[z].x),R.y=Math.min(R.y,Ba[z].y),G.x=Math.max(G.x,Ba[z].x),G.y=Math.max(G.y,Ba[z].y);R=R.x>=la.x&&G.x<=pa.x&&R.y>=la.y&&G.y<=pa.y?[Ba]:G.x<la.x||R.x>pa.x||G.y<la.y||R.y>pa.y?[]:v.ay([Ba],la.x,la.y,pa.x,pa.y)}for(const Qa of R)for(ja.reset(Qa,.25*ca),R=0,R=ja.length<=.5*ca?1:Math.ceil(ja.paddedLength/C)+1,G=0;G<R;G++){pa=ja.lerp(G/Math.max(R-1,1));la=pa.x+100;pa=pa.y+100;ya.push(la,
pa,ca,0);Ba=la-ca;z=pa-ca;Ea=la+ca;const Za=pa+ca;if(m=m&&this.isOffscreen(Ba,z,Ea,Za),u=u||this.isInsideGrid(Ba,z,Ea,Za),"always"!==b&&this.grid.hitTestCircle(la,pa,ca,b,X)&&(g=!0,!K))return{circles:[],offscreen:!1,collisionDetected:g}}}return{circles:!K&&g||!u||za<this.perspectiveRatioCutoff?[]:ya,offscreen:m,collisionDetected:g}}projectPathToScreenSpace(b,g){return function(m){let u=0,z=0,C=0,G=0;for(let K=0;K<m.length;K++)m[K].isOccluded?(C=K+1,G=0):(G++,G>z&&(z=G,u=C));return m.slice(u,u+z)}(function(m,
u){const z=v.L();return v.aq(z,u.pitchedLabelPlaneMatrix),m.map(C=>{C=sc(C.x,C.y,z,u.getElevation);C=u.transform.projectTileCoordinates(C.point.x,C.point.y,u.unwrappedTileID,u.getElevation);return C.point.x=(.5*C.point.x+.5)*u.width,C.point.y=(.5*-C.point.y+.5)*u.height,C})}(b,g))}queryRenderedSymbols(b){if(0===b.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const g=[];var m=new v.a2;for(var u of b)b=new v.P(u.x+100,u.y+100),m.extend(b),g.push(b);const {minX:z,minY:C,
maxX:G,maxY:K}=m;b=this.grid.query(z,C,G,K).concat(this.ignoredGrid.query(z,C,G,K));m={};u={};for(const R of b){b=R.key;if(void 0===m[b.bucketInstanceId]&&(m[b.bucketInstanceId]={}),m[b.bucketInstanceId][b.featureIndex])continue;const X=[new v.P(R.x1,R.y1),new v.P(R.x2,R.y1),new v.P(R.x2,R.y2),new v.P(R.x1,R.y2)];v.az(g,X)&&(m[b.bucketInstanceId][b.featureIndex]=!0,void 0===u[b.bucketInstanceId]&&(u[b.bucketInstanceId]=[]),u[b.bucketInstanceId].push(b.featureIndex))}return u}insertCollisionBox(b,
g,m,u,z,C){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:z,collisionGroupID:C,overlapMode:g},b[0],b[1],b[2],b[3])}insertCollisionCircles(b,g,m,u,z,C){m=m?this.ignoredGrid:this.grid;g={bucketInstanceId:u,featureIndex:z,collisionGroupID:C,overlapMode:g};for(u=0;u<b.length;u+=4)m.insertCircle(g,b[u],b[u+1],b[u+2])}projectAndGetPerspectiveRatio(b,g,m,u,z){if(z){var C;u?(C=[b,g,u(b,g),1],v.aw(C,C,z)):(C=[b,g,0,1],gf(C,C,z));b=C[3];return{x:(C[0]/b+1)/2*this.transform.width+100,
y:(-C[1]/b+1)/2*this.transform.height+100,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}C=this.transform.projectTileCoordinates(b,g,m,u);return{x:(C.point.x+1)/2*this.transform.width+100,y:(1-C.point.y)/2*this.transform.height+100,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C.signedDistanceFromCamera*.5,isOccluded:C.isOccluded,signedDistanceFromCamera:C.signedDistanceFromCamera}}getPerspectiveRatio(b,g,m,u){b=this.transform.projectTileCoordinates(b,
g,m,u);return.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(b,g,m,u){return 100>m||b>=this.screenRightBoundary||100>u||g>this.screenBottomBoundary}isInsideGrid(b,g,m,u){return 0<=m&&b<this.gridRightBoundary&&0<=u&&g<this.gridBottomBoundary}getViewportMatrix(){const b=v.ag([]);return v.M(b,b,[-100,-100,0]),b}_projectCollisionBox(b,g,m,u,z,C,G,K,R,X,ca){var ja=1,la=0,pa=0,ya=1,Ba=b.anchorPointX+G[0];const za=b.anchorPointY+G[1];C&&!z?(ja=this.projectAndGetPerspectiveRatio(Ba+
1,za,u,R,ca),la=ja.x-K.x,ja=Math.atan((ja.y-K.y)/la)+(0>la?Math.PI:0),pa=Math.sin(ja),ja=ya=Math.cos(ja),la=pa,pa=-pa):!C&&z&&(ya=jb(this.transform),ja=ya.vecEast[0],la=ya.vecEast[1],pa=ya.vecSouth[0],ya=ya.vecSouth[1]);C=K.x;G=K.y;z&&(C=Ba,G=za,g=Math.pow(2,-(this.transform.zoom-m.overscaledZ)),g*=this.transform.getPitchedTextCorrection(Ba,za,u),X||(g*=v.ah(.5+K.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4)));X&&(C+=ja*X.x*g+pa*X.y*g,G+=la*X.x*g+ya*X.y*g);m=b.x1*g;K=b.x2*
g;X=(m+K)/2;Ba=b.y1*g;b=b.y2*g;g=(Ba+b)/2;m=[{offsetX:m,offsetY:Ba},{offsetX:X,offsetY:Ba},{offsetX:K,offsetY:Ba},{offsetX:K,offsetY:g},{offsetX:K,offsetY:b},{offsetX:X,offsetY:b},{offsetX:m,offsetY:b},{offsetX:m,offsetY:g}];b=[];for(const {offsetX:Ea,offsetY:Qa}of m)b.push(new v.P(C+ja*Ea+pa*Qa,G+la*Ea+ya*Qa));ja=!1;z?(z=b.map(Ea=>this.projectAndGetPerspectiveRatio(Ea.x,Ea.y,u,R,ca)),ja=z.some(Ea=>!Ea.isOccluded),b=z.map(Ea=>new v.P(Ea.x,Ea.y))):ja=!0;return{box:v.aA(b),allPointsOccluded:!ja}}}class cj{constructor(b,
g,m,u){this.opacity=b?Math.max(0,Math.min(1,b.opacity+(b.placed?g:-g))):u&&m?1:0;this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class Af{constructor(b,g,m,u,z){this.text=new cj(b?b.text:null,g,m,z);this.icon=new cj(b?b.icon:null,g,u,z)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ei{constructor(b,g,m){this.text=b;this.icon=g;this.skipFade=m}}class Gf{constructor(b,g,m,u,z){this.bucketInstanceId=b;this.featureIndex=g;this.sourceLayerIndex=m;this.bucketIndex=
u;this.tileID=z}}class Xf{constructor(b){this.crossSourceCollisions=b;this.maxGroupID=0;this.collisionGroups={}}get(b){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[b]){const g=++this.maxGroupID;this.collisionGroups[b]={ID:g,predicate:m=>m.collisionGroupID===g}}return this.collisionGroups[b]}}class wj{constructor(b,g,m,u,z){this.transform=b.clone();this.terrain=g;this.collisionIndex=new Di(this.transform);this.placements={};this.opacities={};this.variableOffsets=
{};this.stale=!1;this.commitTime=0;this.fadeDuration=m;this.retainedQueryData={};this.collisionGroups=new Xf(u);this.collisionCircleArrays={};this.collisionBoxArrays=new Map;(this.prevPlacement=z)&&(z.prevPlacement=void 0);this.placedOrientations={}}_getTerrainElevationFunc(b){const g=this.terrain;return g?(m,u)=>g.getElevation(b,m,u):null}getBucketParts(b,g,m,u){const z=m.getBucket(g),C=m.latestFeatureIndex;if(z&&C&&g.id===z.layerIds[0]){g=m.collisionBoxArray;var G=z.layers[0].layout,K=z.layers[0].paint,
R=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),X=m.tileSize/v.$,ca=m.tileID.toUnwrapped(),ja="map"===G.get("text-rotation-alignment"),la=v.aC(m,1,this.transform.zoom),pa=v.aD(this.collisionIndex.transform,m,K.get("text-translate"),K.get("text-translate-anchor"));K=v.aD(this.collisionIndex.transform,m,K.get("icon-translate"),K.get("icon-translate-anchor"));ja=Kb(ja,this.transform,la);this.retainedQueryData[z.bucketInstanceId]=new Gf(z.bucketInstanceId,C,z.sourceLayerIndex,z.index,m.tileID);
m={bucket:z,layout:G,translationText:pa,translationIcon:K,unwrappedTileID:ca,pitchedLabelPlaneMatrix:ja,scale:R,textPixelRatio:X,holdingForFade:m.holdingForSymbolFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:v.an(z.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(z.sourceID)};if(u)for(const ya of z.sortKeyRanges){const {sortKey:Ba,symbolInstanceStart:za,symbolInstanceEnd:Ea}=ya;b.push({sortKey:Ba,symbolInstanceStart:za,symbolInstanceEnd:Ea,parameters:m})}else b.push({symbolInstanceStart:0,
symbolInstanceEnd:z.symbolInstances.length,parameters:m})}}attemptAnchorPlacement(b,g,m,u,z,C,G,K,R,X,ca,ja,la,pa,ya,Ba,za,Ea,Qa,Za){const sb=v.aE[b.textAnchor];b=[b.textOffset0,b.textOffset1];const ob=da(sb,m,u,b,z);g=this.collisionIndex.placeCollisionBox(g,ja,K,R,X,G,C,Ba,ca.predicate,Qa,ob,Za);if((!Ea||this.collisionIndex.placeCollisionBox(Ea,ja,K,R,X,G,C,za,ca.predicate,Qa,ob,Za).placeable)&&g.placeable){let eb;if(this.prevPlacement&&this.prevPlacement.variableOffsets[la.crossTileID]&&this.prevPlacement.placements[la.crossTileID]&&
this.prevPlacement.placements[la.crossTileID].text&&(eb=this.prevPlacement.variableOffsets[la.crossTileID].anchor),0===la.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[la.crossTileID]={textOffset:b,width:m,height:u,anchor:sb,textBoxScale:z,prevAnchor:eb},this.markUsedJustification(pa,sb,la,ya),pa.allowVerticalPlacement&&(this.markUsedOrientation(pa,ya,la),this.placedOrientations[la.crossTileID]=ya),{shift:ob,placedGlyphBoxes:g}}}placeLayerBucketPart(b,
g,m){const {bucket:u,layout:z,translationText:C,translationIcon:G,unwrappedTileID:K,pitchedLabelPlaneMatrix:R,textPixelRatio:X,holdingForFade:ca,collisionBoxArray:ja,partiallyEvaluatedTextSize:la,collisionGroup:pa}=b.parameters,ya=z.get("text-optional"),Ba=z.get("icon-optional"),za=v.aF(z,"text-overlap","text-allow-overlap"),Ea="always"===za,Qa=v.aF(z,"icon-overlap","icon-allow-overlap");var Za="always"===Qa;const sb="map"===z.get("text-rotation-alignment"),ob="map"===z.get("text-pitch-alignment"),
eb="none"!==z.get("icon-text-fit");var Db="viewport-y"===z.get("symbol-z-order");const Nb=Ea&&(Za||!u.hasIconData()||Ba),Ob=Za&&(Ea||!u.hasTextData()||ya);!u.collisionArrays&&ja&&u.deserializeCollisionBoxes(ja);const Jb=this.retainedQueryData[u.bucketInstanceId].tileID,$b=this._getTerrainElevationFunc(Jb),vc=this.transform.getFastPathSimpleProjectionMatrix(Jb);Za=(Bb,Yc,md)=>{var Bd,fd;if(!g[Bb.crossTileID]){if(ca)return void(this.placements[Bb.crossTileID]=new Ei(!1,!1,!1));var ud=!1,le=!1,wd=!0,
Fd=null,Df={box:null,placeable:!1,offscreen:null,occluded:!1},ff={placeable:!1},we=null,ie=null,oe=null,ce=0,pf=0,$i=0;Yc.textFeatureIndex?ce=Yc.textFeatureIndex:Bb.useRuntimeCollisionCircles&&(ce=Bb.featureIndex);Yc.verticalTextFeatureIndex&&(pf=Yc.verticalTextFeatureIndex);var xf=Yc.textBox;if(xf){const Ch=Fe=>{let Se=v.ao.horizontal;u.allowVerticalPlacement&&!Fe&&this.prevPlacement&&(Fe=this.prevPlacement.placedOrientations[Bb.crossTileID])&&(this.placedOrientations[Bb.crossTileID]=Fe,Se=Fe,this.markUsedOrientation(u,
Se,Bb));return Se};wd=(Fe,Se)=>{if(u.allowVerticalPlacement&&0<Bb.numVerticalGlyphVertices&&Yc.verticalTextBox)for(const rg of u.writingModes){if(rg===v.ao.vertical?(Df=Se(),ff=Df):Df=Fe(),Df&&Df.placeable)break}else Df=Fe()};const Xh=Bb.textAnchorOffsetStartIndex,Dh=Bb.textAnchorOffsetEndIndex;if(Dh===Xh){const Fe=(Se,rg)=>{Se=this.collisionIndex.placeCollisionBox(Se,za,X,Jb,K,ob,sb,C,pa.predicate,$b,void 0,vc);return Se&&Se.placeable&&(this.markUsedOrientation(u,rg,Bb),this.placedOrientations[Bb.crossTileID]=
rg),Se};wd(()=>Fe(xf,v.ao.horizontal),()=>{const Se=Yc.verticalTextBox;return u.allowVerticalPlacement&&0<Bb.numVerticalGlyphVertices&&Se?Fe(Se,v.ao.vertical):{box:null,offscreen:null}});Ch(Df&&Df.placeable)}else{let Fe=v.aE[null===(fd=null===(Bd=this.prevPlacement)||void 0===Bd?void 0:Bd.variableOffsets[Bb.crossTileID])||void 0===fd?void 0:fd.anchor];const Se=(rg,Hj,ek)=>{const sl=rg.x2-rg.x1,cf=rg.y2-rg.y1,Yk=Bb.textBoxScale;Hj=eb&&"never"===Qa?Hj:null;let nh=null,rk="never"===za?1:2,Wi="never";
Fe&&rk++;for(let lg=0;lg<rk;lg++){for(let ig=Xh;ig<Dh;ig++){var sk=u.textAnchorOffsets.get(ig);if((!Fe||sk.textAnchor===Fe)&&(sk=this.attemptAnchorPlacement(sk,rg,sl,cf,Yk,sb,ob,X,Jb,K,pa,Wi,Bb,u,ek,C,G,Hj,$b))&&(nh=sk.placedGlyphBoxes,nh&&nh.placeable))return ud=!0,Fd=sk.shift,nh}Fe?Fe=null:Wi=za}return m&&!nh&&(nh={box:this.collisionIndex.placeCollisionBox(xf,"always",X,Jb,K,ob,sb,C,pa.predicate,$b,void 0,vc).box,offscreen:!1,placeable:!1,occluded:!1}),nh};wd(()=>Se(xf,Yc.iconBox,v.ao.horizontal),
()=>{const rg=Yc.verticalTextBox;return u.allowVerticalPlacement&&(!Df||!Df.placeable)&&0<Bb.numVerticalGlyphVertices&&rg?Se(rg,Yc.verticalIconBox,v.ao.vertical):{box:null,occluded:!0,offscreen:null}});Df&&(ud=Df.placeable,wd=Df.offscreen);wd=Ch(Df&&Df.placeable);!ud&&this.prevPlacement&&(Bd=this.prevPlacement.variableOffsets[Bb.crossTileID])&&(this.variableOffsets[Bb.crossTileID]=Bd,this.markUsedJustification(u,Bd.anchor,Bb,wd))}}if(we=Df,ud=we&&we.placeable,wd=we&&we.offscreen,Bb.useRuntimeCollisionCircles&&
0<=Bb.centerJustifiedTextSymbolIndex)ie=u.text.placedSymbolArray.get(Bb.centerJustifiedTextSymbolIndex),Bd=v.ap(u.textSizeData,la,ie),fd=z.get("text-padding"),ie=this.collisionIndex.placeCollisionCircles(za,ie,u.lineVertexArray,u.glyphOffsetArray,Bd,K,R,m,ob,pa.predicate,Bb.collisionCircleDiameter,fd,C,$b),ie.circles.length&&ie.collisionDetected&&!m&&v.w("Collisions detected, but collision boxes are not shown"),ud=Ea||0<ie.circles.length&&!ie.collisionDetected,wd=wd&&ie.offscreen;if(Yc.iconFeatureIndex&&
($i=Yc.iconFeatureIndex),Yc.iconBox)Bd=Ch=>this.collisionIndex.placeCollisionBox(Ch,Qa,X,Jb,K,ob,sb,G,pa.predicate,$b,eb&&Fd?Fd:void 0,vc),ff&&ff.placeable&&Yc.verticalIconBox?(oe=Bd(Yc.verticalIconBox),le=oe.placeable):(oe=Bd(Yc.iconBox),le=oe.placeable),wd=wd&&oe.offscreen;Bd=ya||0===Bb.numHorizontalGlyphVertices&&0===Bb.numVerticalGlyphVertices;fd=Ba||0===Bb.numIconVertices;Bd||fd?fd?Bd||(le=le&&ud):ud=le&&ud:le=ud=le&&ud;Bd=le&&oe.placeable;if(ud&&we.placeable&&this.collisionIndex.insertCollisionBox(we.box,
za,z.get("text-ignore-placement"),u.bucketInstanceId,ff&&ff.placeable&&pf?pf:ce,pa.ID),Bd&&this.collisionIndex.insertCollisionBox(oe.box,Qa,z.get("icon-ignore-placement"),u.bucketInstanceId,$i,pa.ID),ie&&ud&&this.collisionIndex.insertCollisionCircles(ie.circles,za,z.get("text-ignore-placement"),u.bucketInstanceId,ce,pa.ID),m&&this.storeCollisionData(u.bucketInstanceId,md,Yc,we,oe,ie),0===Bb.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");if(0===u.bucketInstanceId)throw Error("bucket.bucketInstanceId can't be 0");
this.placements[Bb.crossTileID]=new Ei((ud||Nb)&&!(null==we?0:we.occluded),(le||Ob)&&!(null==oe?0:oe.occluded),wd||u.justReloaded);g[Bb.crossTileID]=!0}};if(Db){if(0!==b.symbolInstanceStart)throw Error("bucket.bucketInstanceId should be 0");b=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(Db=b.length-1;0<=Db;--Db){const Bb=b[Db];Za(u.symbolInstances.get(Bb),u.collisionArrays[Bb],Bb)}}else for(Db=b.symbolInstanceStart;Db<b.symbolInstanceEnd;Db++)Za(u.symbolInstances.get(Db),u.collisionArrays[Db],
Db);u.justReloaded=!1}storeCollisionData(b,g,m,u,z,C){if(m.textBox||m.iconBox){let G,K;this.collisionBoxArrays.has(b)?G=this.collisionBoxArrays.get(b):(G=new Map,this.collisionBoxArrays.set(b,G));G.has(g)?K=G.get(g):(K={text:null,icon:null},G.set(g,K));m.textBox&&(K.text=u.box);m.iconBox&&(K.icon=z.box)}if(C)for(g=this.collisionCircleArrays[b],void 0===g&&(g=this.collisionCircleArrays[b]=[]),b=0;b<C.circles.length;b+=4)g.push(C.circles[b+0]-100),g.push(C.circles[b+1]-100),g.push(C.circles[b+2]),g.push(C.collisionDetected?
1:0)}markUsedJustification(b,g,m,u){g=u===v.ao.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[v.aG(g)];u=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const z of u)0<=z&&(b.text.placedSymbolArray.get(z).crossTileID=0<=g&&z!==g?0:m.crossTileID)}markUsedOrientation(b,g,m){const u=g===v.ao.horizontal||g===
v.ao.horizontalOnly?g:0;g=g===v.ao.vertical?g:0;const z=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const C of z)b.text.placedSymbolArray.get(C).placedOrientation=u;m.verticalPlacedTextSymbolIndex&&(b.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(b){this.commitTime=b;this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let m=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):
0;const u=g?g.symbolFadeChange(b):1,z=g?g.opacities:{},C=g?g.variableOffsets:{},G=g?g.placedOrientations:{};for(var K in this.placements){var R=this.placements[K];const X=z[K];X?(this.opacities[K]=new Af(X,u,R.text,R.icon),m=m||R.text!==X.text.placed||R.icon!==X.icon.placed):(this.opacities[K]=new Af(null,u,R.text,R.icon,R.skipFade),m=m||R.text||R.icon)}for(const X in z)K=z[X],this.opacities[X]||(R=new Af(K,u,!1,!1),R.isHidden()||(this.opacities[X]=R,m=m||K.text.placed||K.icon.placed));for(const X in C)this.variableOffsets[X]||
!this.opacities[X]||this.opacities[X].isHidden()||(this.variableOffsets[X]=C[X]);for(const X in G)this.placedOrientations[X]||!this.opacities[X]||this.opacities[X].isHidden()||(this.placedOrientations[X]=G[X]);if(g&&void 0===g.lastPlacementChangeTime)throw Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=b:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:b)}updateLayerOpacities(b,g){const m={};
for(const u of g)(g=u.getBucket(b))&&u.latestFeatureIndex&&b.id===g.layerIds[0]&&this.updateBucketOpacities(g,u.tileID,m,u.collisionBoxArray)}updateBucketOpacities(b,g,m,u){b.hasTextData()&&(b.text.opacityVertexArray.clear(),b.text.hasVisibleVertices=!1);b.hasIconData()&&(b.icon.opacityVertexArray.clear(),b.icon.hasVisibleVertices=!1);b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexArray.clear();b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexArray.clear();var z=b.layers[0],
C=z.layout;g=new Af(null,0,!1,!1,!0);var G=C.get("text-allow-overlap"),K=C.get("icon-allow-overlap");z=z._unevaluatedLayout.hasValue("text-variable-anchor")||z._unevaluatedLayout.hasValue("text-variable-anchor-offset");const R="map"===C.get("text-rotation-alignment"),X="map"===C.get("text-pitch-alignment"),ca="none"!==C.get("icon-text-fit");C=new Af(null,0,G&&(K||!b.hasIconData()||C.get("icon-optional")),K&&(G||!b.hasTextData()||C.get("text-optional")),!0);!b.collisionArrays&&u&&(b.hasIconCollisionBoxData()||
b.hasTextCollisionBoxData())&&b.deserializeCollisionBoxes(u);u=(za,Ea,Qa)=>{for(let Za=0;Za<Ea/4;Za++)za.opacityVertexArray.emplaceBack(Qa);za.hasVisibleVertices=za.hasVisibleVertices||0!==Qa};G=this.collisionBoxArrays.get(b.bucketInstanceId);for(K=0;K<b.symbolInstances.length;K++){var ja=b.symbolInstances.get(K);const {numHorizontalGlyphVertices:za,numVerticalGlyphVertices:Ea,crossTileID:Qa}=ja;let Za=this.opacities[Qa];m[Qa]?Za=g:Za||(Za=C,this.opacities[Qa]=Za);m[Qa]=!0;var la=0<ja.numIconVertices,
pa=this.placedOrientations[ja.crossTileID];const sb=pa===v.ao.vertical;var ya=pa===v.ao.horizontal||pa===v.ao.horizontalOnly;if(0<za||0<Ea){var Ba=O(Za.text);u(b.text,za,sb?0:Ba);u(b.text,Ea,ya?0:Ba);const ob=Za.text.isHidden();[ja.rightJustifiedTextSymbolIndex,ja.centerJustifiedTextSymbolIndex,ja.leftJustifiedTextSymbolIndex].forEach(eb=>{0<=eb&&(b.text.placedSymbolArray.get(eb).hidden=ob||sb?1:0)});0<=ja.verticalPlacedTextSymbolIndex&&(b.text.placedSymbolArray.get(ja.verticalPlacedTextSymbolIndex).hidden=
ob||ya?1:0);(Ba=this.variableOffsets[ja.crossTileID])&&this.markUsedJustification(b,Ba.anchor,ja,pa);(pa=this.placedOrientations[ja.crossTileID])&&(this.markUsedJustification(b,"left",ja,pa),this.markUsedOrientation(b,pa,ja))}la&&(la=O(Za.icon),pa=!(ca&&ja.verticalPlacedIconSymbolIndex&&sb),0<=ja.placedIconSymbolIndex&&(u(b.icon,ja.numIconVertices,pa?la:0),b.icon.placedSymbolArray.get(ja.placedIconSymbolIndex).hidden=Za.icon.isHidden()),0<=ja.verticalPlacedIconSymbolIndex&&(u(b.icon,ja.numVerticalIconVertices,
pa?0:la),b.icon.placedSymbolArray.get(ja.verticalPlacedIconSymbolIndex).hidden=Za.icon.isHidden()));ja=G&&G.has(K)?G.get(K):{text:null,icon:null};if(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData())if(la=b.collisionArrays[K]){pa=new v.P(0,0);if(la.textBox||la.verticalTextBox){Ba=!0;if(z){const ob=this.variableOffsets[Qa];ob?(pa=da(ob.anchor,ob.width,ob.height,ob.textOffset,ob.textBoxScale),R&&pa._rotate(X?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ba=!1}if(la.textBox||
la.verticalTextBox){let ob;la.textBox&&(ob=sb);la.verticalTextBox&&(ob=ya);J(b.textCollisionBox.collisionVertexArray,Za.text.placed,!Ba||ob,ja.text,pa.x,pa.y)}}if(la.iconBox||la.verticalIconBox){ya=!(ya||!la.verticalIconBox);let ob;la.iconBox&&(ob=ya);la.verticalIconBox&&(ob=!ya);J(b.iconCollisionBox.collisionVertexArray,Za.icon.placed,ob,ja.icon,ca?pa.x:0,ca?pa.y:0)}}}if(b.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=
b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexBuffer&&b.iconCollisionBox.collisionVertexBuffer.updateData(b.iconCollisionBox.collisionVertexArray),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexBuffer&&b.textCollisionBox.collisionVertexBuffer.updateData(b.textCollisionBox.collisionVertexArray),
b.text.opacityVertexArray.length!==b.text.layoutVertexArray.length/4)throw Error(`bucket.text.opacityVertexArray.length (= ${b.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${b.text.layoutVertexArray.length}) / 4`);if(b.icon.opacityVertexArray.length!==b.icon.layoutVertexArray.length/4)throw Error(`bucket.icon.opacityVertexArray.length (= ${b.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${b.icon.layoutVertexArray.length}) / 4`);b.bucketInstanceId in
this.collisionCircleArrays&&(b.collisionCircleArray=this.collisionCircleArrays[b.bucketInstanceId],delete this.collisionCircleArrays[b.bucketInstanceId])}symbolFadeChange(b){return 0===this.fadeDuration?1:(b-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(b){return Math.max(0,(this.transform.zoom-b)/1.5)}hasTransitions(b){return this.stale||b-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(b,g){const m=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;
return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*m>b}setStale(){this.stale=!0}}const Yf=Math.pow(2,25),Ge=Math.pow(2,24),Bf=Math.pow(2,17),Ne=Math.pow(2,16),Ig=Math.pow(2,9),Jg=Math.pow(2,8),bh=Math.pow(2,1);class jl{constructor(b){this._sortAcrossTiles="viewport-y"!==b.layout.get("symbol-z-order")&&!b.layout.get("symbol-sort-key").isConstant();this._currentPartIndex=this._currentTileIndex=0;this._seenCrossTileIDs={};this._bucketParts=[]}continuePlacement(b,g,m,u,z){const C=
this._bucketParts;for(;this._currentTileIndex<b.length;)if(g.getBucketParts(C,u,b[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,z())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((G,K)=>G.sortKey-K.sortKey));this._currentPartIndex<C.length;)if(g.placeLayerBucketPart(C[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,z())return!0;return!1}}class Lb{constructor(b,g,m,u,z,C,G,K){this.placement=new wj(b,g,C,G,K);this._currentPlacementIndex=
m.length-1;this._forceFullPlacement=u;this._showCollisionBoxes=z;this._done=!1}isDone(){return this._done}continuePlacement(b,g,m){const u=qd.now(),z=()=>!this._forceFullPlacement&&2<qd.now()-u;for(;0<=this._currentPlacementIndex;){const C=g[b[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if("symbol"===C.type&&(!C.minzoom||C.minzoom<=G)&&(!C.maxzoom||C.maxzoom>G)){if(this._inProgressLayer||(this._inProgressLayer=new jl(C)),this._inProgressLayer.continuePlacement(m[C.source],
this.placement,this._showCollisionBoxes,C,z))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(b){return this.placement.commit(b),this.placement}}const nd=512/v.$/2;class ue{constructor(b,g,m){this.tileID=b;this.bucketInstanceId=m;this._symbolsByKey={};b=new Map;for(m=0;m<g.length;m++){const u=g.get(m),z=u.key,C=b.get(z);C?C.push(u):b.set(z,[u])}for(const [u,z]of b){g={positions:z.map(C=>({x:Math.floor(C.anchorX*nd),y:Math.floor(C.anchorY*nd)})),crossTileIDs:z.map(C=>
C.crossTileID)};if(128<g.positions.length){b=new v.aI(g.positions.length,16,Uint16Array);for(const {x:C,y:G}of g.positions)b.add(C,G);b.finish();delete g.positions;g.index=b}this._symbolsByKey[u]=g}}getScaledCoordinates(b,g){const {x:m,y:u,z}=this.tileID.canonical,{x:C,y:G,z:K}=g.canonical;g=nd/Math.pow(2,K-z);return{x:Math.floor((C*v.$+b.anchorX)*g-m*v.$*nd),y:Math.floor((G*v.$+b.anchorY)*g-u*v.$*nd)}}findMatches(b,g,m){const u=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-
g.canonical.z);for(let C=0;C<b.length;C++){const G=b.get(C);if(G.crossTileID)continue;const K=this._symbolsByKey[G.key];if(K){var z=this.getScaledCoordinates(G,g);if(K.index){z=K.index.range(z.x-u,z.y-u,z.x+u,z.y+u).sort();for(const R of z)if(z=K.crossTileIDs[R],!m[z]){m[z]=!0;G.crossTileID=z;break}}else if(K.positions)for(let R=0;R<K.positions.length;R++){const X=K.positions[R],ca=K.crossTileIDs[R];if(Math.abs(X.x-z.x)<=u&&Math.abs(X.y-z.y)<=u&&!m[ca]){m[ca]=!0;G.crossTileID=ca;break}}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:b})=>
b)}}class Xe{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class hc{constructor(){this.indexes={};this.usedCrossTileIDs={};this.lng=0}handleWrapJump(b){const g=Math.round((b-this.lng)/360);if(0!==g)for(const m in this.indexes){const u=this.indexes[m],z={};for(const C in u){const G=u[C];G.tileID=G.tileID.unwrapTo(G.tileID.wrap+g);z[G.tileID.key]=G}this.indexes[m]=z}this.lng=b}addBucket(b,g,m){if(this.indexes[b.overscaledZ]&&this.indexes[b.overscaledZ][b.key]){if(this.indexes[b.overscaledZ][b.key].bucketInstanceId===
g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(b.overscaledZ,this.indexes[b.overscaledZ][b.key])}for(var u=0;u<g.symbolInstances.length;u++)g.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[b.overscaledZ]||(this.usedCrossTileIDs[b.overscaledZ]={});u=this.usedCrossTileIDs[b.overscaledZ];for(var z in this.indexes){var C=this.indexes[z];if(Number(z)>b.overscaledZ)for(var G in C){const K=C[G];K.tileID.isChildOf(b)&&K.findMatches(g.symbolInstances,b,u)}else(C=C[b.scaledTo(Number(z)).key])&&
C.findMatches(g.symbolInstances,b,u)}for(z=0;z<g.symbolInstances.length;z++)G=g.symbolInstances.get(z),G.crossTileID||(G.crossTileID=m.generate(),u[G.crossTileID]=!0);return void 0===this.indexes[b.overscaledZ]&&(this.indexes[b.overscaledZ]={}),this.indexes[b.overscaledZ][b.key]=new ue(b,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(b,g){for(const m of g.getCrossTileIDsLists())for(const u of m)delete this.usedCrossTileIDs[b][u]}removeStaleBuckets(b){let g=!1;for(const m in this.indexes){const u=
this.indexes[m];for(const z in u)b[u[z].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,u[z]),delete u[z],g=!0)}return g}}class kf{constructor(){this.layerIndexes={};this.crossTileIDs=new Xe;this.maxBucketInstanceId=0;this.bucketsInCurrentPlacement={}}addLayer(b,g,m){let u=this.layerIndexes[b.id];void 0===u&&(u=this.layerIndexes[b.id]=new hc);let z=!1;const C={};u.handleWrapJump(m);for(const G of g)(g=G.getBucket(b))&&b.id===g.layerIds[0]&&(g.bucketInstanceId||(g.bucketInstanceId=++this.maxBucketInstanceId),
u.addBucket(G.tileID,g,this.crossTileIDs)&&(z=!0),C[g.bucketInstanceId]=!0);return u.removeStaleBuckets(C)&&(z=!0),z}pruneUnusedLayers(b){const g={};b.forEach(m=>{g[m]=!0});for(const m in this.layerIndexes)g[m]||delete this.layerIndexes[m]}}const Ed={prelude:W("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue\x3dint(packedValue);int v0\x3dpackedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity\x3dint(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor\x3ddecode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor\x3ddecode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset\x3dmod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c\x3dcos(angle);float s\x3dsin(angle);float c2\x3d1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh\x3dvec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts\x3dvec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d\x3dunpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag\x3dpos.xyz/pos.w;highp float d\x3ddepthOpacity(frag);if (d \x3e 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb\x3d(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y \x3c-32767.5) || (pos.y \x3e 32766.5)) {return 0.0;}\n#endif\nvec2 coord\x3d(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f\x3dfract(coord);vec2 c\x3d(floor(coord)+0.5)/(u_terrain_dim+2.0);float d\x3d1.0/(u_terrain_dim+2.0);float tl\x3dele(c);float tr\x3dele(c+vec2(d,0.0));float bl\x3dele(c+vec2(0.0,d));float br\x3dele(c+vec2(d,d));float elevation\x3dmix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI\x3d3.141592653589793;uniform mat4 u_projection_matrix;"),
projectionMercator:W("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result\x3du_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result\x3du_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y \x3c-32767.5 || rawPos.y \x3e 32766.5) {result.z\x3d-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),
projectionGlobe:W("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight\x3dvec3(vec.z,0.0,-vec.x);vec3 axisUp\x3dcross(axisRight,vec);axisRight\x3dnormalize(axisRight);axisUp\x3dnormalize(axisUp);vec2 t\x3dtan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight\x3dvec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown\x3dcross(axisRight,spherePos);axisRight\x3dnormalize(axisRight);axisDown\x3dnormalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y\x3du_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y\x3d2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness\x3d1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition \x3c 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos\x3du_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x\x3dmercator_pos.x*PI*2.0+PI;spherical.y\x3d2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len\x3dcos(spherical.y);vec3 pos\x3dvec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y \x3c-32767.5) {pos\x3dvec3(0.0,1.0,0.0);}if (rawPos.y \x3e 32766.5) {pos\x3dvec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos\x3dspherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition\x3du_projection_matrix*vec4(elevatedPos,1.0);globePosition.z\x3dglobeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition \x3e 0.999) {return globePosition;}vec4 flatPosition\x3du_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold\x3d0.2;vec4 result\x3dglobePosition;result.z\x3dmix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw\x3dmix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y \x3c-32767.5) || (posInTile.y \x3e 32766.5)) {result\x3dglobePosition;const float poles_hidden_anim_percentage\x3d0.02;result.z\x3dmix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos\x3dspherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition\x3du_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition \x3e 0.999) {return globePosition;}vec4 fallbackPosition\x3du_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos\x3dprojectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),
background:W("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor\x3du_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position\x3dprojectTile(a_pos);}"),backgroundPattern:W("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord\x3dmod(v_pos_a,1.0);vec2 pos\x3dmix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1\x3dtexture(u_image,pos);vec2 imagecoord_b\x3dmod(v_pos_b,1.0);vec2 pos2\x3dmix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2\x3dtexture(u_image,pos2);fragColor\x3dmix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position\x3dprojectTile(a_pos);v_pos_a\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),
circle:W("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude\x3dv_data.xy;float extrude_length\x3dlength(extrude);float antialiased_blur\x3dv_data.z;float opacity_t\x3dsmoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t\x3dstroke_width \x3c 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor\x3dv_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon\x3d0.5/255.0;if (fragColor.r \x3c epsilon \x26\x26 fragColor.g \x3c epsilon \x26\x26 fragColor.b \x3c epsilon \x26\x26 fragColor.a \x3c epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw\x3da_pos+32768.0;vec2 extrude\x3dvec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center\x3dfloor(pos_raw/8.0)+u_translate;float ele\x3dget_elevation(circle_center);v_visibility\x3dcalculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector\x3dprojectToSphere(circle_center);\n#endif\nfloat angle_scale\x3du_globe_extrude_scale;vec2 corner_position\x3dcircle_center;if (u_scale_with_map) {angle_scale*\x3d(radius+stroke_width);corner_position+\x3dextrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center\x3dinterpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center\x3dprojectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+\x3dextrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*\x3d(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles\x3dextrude*angle_scale;vec3 corner_vector\x3dglobeRotateVector(center_vector,angles);gl_Position\x3dinterpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position\x3dprojectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position\x3dprojectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w \x3e 1.0) {gl_Position.xy\x3dvec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+\x3dextrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+\x3dextrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur\x3d-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data\x3dvec3(extrude.x,extrude.y,antialiasblur);}"),
clippingMask:W("void main() {fragColor\x3dvec4(1.0);}","in vec2 a_pos;void main() {gl_Position\x3dprojectTile(a_pos);}"),heatmap:W("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d\x3d-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val\x3dweight*u_intensity*GAUSS_COEF*exp(d);fragColor\x3dvec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO\x3d1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw\x3da_pos+32768.0;vec2 unscaled_extrude\x3dvec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S\x3dsqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude\x3dS*unscaled_extrude;vec2 extrude\x3dv_extrude*radius*u_extrude_scale;vec2 circle_center\x3dfloor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles\x3dv_extrude*radius*u_globe_extrude_scale;vec3 center_vector\x3dprojectToSphere(circle_center);vec3 corner_vector\x3dglobeRotateVector(center_vector,angles);gl_Position\x3dinterpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position\x3dprojectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),
heatmapTexture:W("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t\x3dtexture(u_image,v_pos).r;vec4 color\x3dtexture(u_color_ramp,vec2(t,0.5));fragColor\x3dcolor*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position\x3du_matrix*vec4(a_pos*u_world,0,1);v_pos.x\x3da_pos.x;v_pos.y\x3d1.0-a_pos.y;}"),collisionBox:W("in float v_placed;in float v_notUsed;void main() {float alpha\x3d0.5;fragColor\x3dvec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed \x3e 0.5) {fragColor\x3dvec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed \x3e 0.5) {fragColor*\x3d.1;}}",
"in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position\x3dprojectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy\x3d((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w \x3c 1.1) {gl_Position.z\x3d0.5;}v_placed\x3da_placed.x;v_notUsed\x3da_placed.y;}"),collisionCircle:W("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha\x3d0.5;float stroke_radius\x3d0.9;float distance_to_center\x3dlength(v_extrude);float distance_to_edge\x3dabs(distance_to_center-v_radius);float opacity_t\x3dsmoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color\x3dmix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor\x3dcolor*alpha*opacity_t;}",
"in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius\x3da_radius;float collision\x3da_flags.x;float vertexIdx\x3da_flags.y;vec2 quadVertexOffset\x3dvec2(mix(-1.0,1.0,float(vertexIdx \x3e\x3d2.0)),mix(-1.0,1.0,float(vertexIdx \x3e\x3d1.0 \x26\x26 vertexIdx \x3c\x3d2.0)));vec2 quadVertexExtent\x3dquadVertexOffset*radius;float padding_factor\x3d1.2;v_radius\x3dradius;v_extrude\x3dquadVertexExtent*padding_factor;v_collision\x3dcollision;gl_Position\x3dvec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),
colorRelief:W("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data\x3dtexture(u_image,coord)*255.0;data.a\x3d-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x\x3d(float(stop)+0.5)/float(u_color_ramp_size);vec4 data\x3dtexture(u_elevation_stops,vec2(x,0))*255.0;data.a\x3d-1.0;return dot(data,u_unpack);}void main() {float el\x3dgetElevation(v_pos);int r\x3d(u_color_ramp_size-1);int l\x3d0;float el_l\x3dgetElevationStop(l);float el_r\x3dgetElevationStop(r);while(r-l \x3e 1){int m\x3d(r+l)/2;float el_m\x3dgetElevationStop(m);if(el \x3c el_m){r\x3dm;el_r\x3del_m;}else\n{l\x3dm;el_l\x3del_m;}}float x\x3d(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor\x3du_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position\x3dprojectTile(a_pos,a_pos);highp vec2 epsilon\x3d1.0/u_dimension;float scale\x3d(u_dimension.x-2.0)/u_dimension.x;v_pos\x3d(a_pos/8192.0)*scale+epsilon;if (a_pos.y \x3c-32767.5) {v_pos.y\x3d0.0;}if (a_pos.y \x3e 32766.5) {v_pos.y\x3d1.0;}}"),debug:W("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color\x3dtexture(u_overlay,v_uv);fragColor\x3dmix(u_color,overlay_color,overlay_color.a);}",
"in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv\x3da_pos/8192.0;gl_Position\x3dprojectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:W("void main() {fragColor\x3dvec4(1.0);}","in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position\x3dprojectTileFor3D(a_pos,0.0);\n#else\ngl_Position\x3du_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:W("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor\x3dcolor*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position\x3dprojectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:W("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist\x3dlength(v_pos-gl_FragCoord.xy);float alpha\x3d1.0-smoothstep(0.0,1.0,dist);fragColor\x3doutline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position\x3dprojectTile(a_pos+u_fill_translate,a_pos);v_pos\x3d(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n}"),
fillOutlinePattern:W("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;vec2 imagecoord\x3dmod(v_pos_a,1.0);vec2 pos\x3dmix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1\x3dtexture(u_image,pos);vec2 imagecoord_b\x3dmod(v_pos_b,1.0);vec2 pos2\x3dmix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2\x3dtexture(u_image,pos2);float dist\x3dlength(v_pos-gl_FragCoord.xy);float alpha\x3d1.0-smoothstep(0.0,1.0,dist);fragColor\x3dmix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;float tileRatio\x3du_scale.x;float fromScale\x3du_scale.y;float toScale\x3du_scale.z;gl_Position\x3dprojectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a\x3d(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b\x3d(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos\x3d(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n}"),
fillPattern:W("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;vec2 imagecoord\x3dmod(v_pos_a,1.0);vec2 pos\x3dmix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1\x3dtexture(u_image,pos);vec2 imagecoord_b\x3dmod(v_pos_b,1.0);vec2 pos2\x3dmix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2\x3dtexture(u_image,pos2);fragColor\x3dmix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;float tileZoomRatio\x3du_scale.x;float fromScale\x3du_scale.y;float toScale\x3du_scale.z;vec2 display_size_a\x3d(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b\x3d(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position\x3dprojectTile(a_pos+u_fill_translate,a_pos);v_pos_a\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),
fillExtrusion:W("in vec4 v_color;void main() {fragColor\x3dv_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal\x3da_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset\x3dget_elevation(a_centroid);float base_terrain3d_offset\x3dheight_terrain3d_offset-(base \x3e 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset\x3d0.0;float base_terrain3d_offset\x3d0.0;\n#endif\nbase\x3dmax(0.0,base)+base_terrain3d_offset;height\x3dmax(0.0,height)+height_terrain3d_offset;float t\x3dmod(normal.x,2.0);float elevation\x3dt \x3e 0.0 ? height : base;vec2 posInTile\x3da_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos\x3dprojectToSphere(posInTile,a_pos);gl_Position\x3dinterpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position\x3du_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue\x3dcolor.r*0.2126+color.g*0.7152+color.b*0.0722;v_color\x3dvec4(0.0,0.0,0.0,1.0);vec4 ambientlight\x3dvec4(0.03,0.03,0.03,1.0);color+\x3dambientlight;vec3 normalForLighting\x3dnormal/16384.0;float directional\x3dclamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix\x3dglobeGetRotationMatrix(spherePos);normalForLighting\x3drotMatrix*normalForLighting;directional\x3dmix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional\x3dmix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !\x3d0.0) {directional*\x3d((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+\x3dclamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+\x3dclamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+\x3dclamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*\x3du_opacity;}"),
fillExtrusionPattern:W("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;vec2 imagecoord\x3dmod(v_pos_a,1.0);vec2 pos\x3dmix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1\x3dtexture(u_image,pos);vec2 imagecoord_b\x3dmod(v_pos_b,1.0);vec2 pos2\x3dmix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2\x3dtexture(u_image,pos2);vec4 mixedColor\x3dmix(color1,color2,u_fade);fragColor\x3dmixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;float tileRatio\x3du_scale.x;float fromScale\x3du_scale.y;float toScale\x3du_scale.z;vec3 normal\x3da_normal_ed.xyz;float edgedistance\x3da_normal_ed.w;vec2 display_size_a\x3d(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b\x3d(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset\x3dget_elevation(a_centroid);float base_terrain3d_offset\x3dheight_terrain3d_offset-(base \x3e 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset\x3d0.0;float base_terrain3d_offset\x3d0.0;\n#endif\nbase\x3dmax(0.0,base)+base_terrain3d_offset;height\x3dmax(0.0,height)+height_terrain3d_offset;float t\x3dmod(normal.x,2.0);float elevation\x3dt \x3e 0.0 ? height : base;vec2 posInTile\x3da_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos\x3dprojectToSphere(posInTile,a_pos);vec3 elevatedPos\x3dspherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos\x3delevatedPos;gl_Position\x3dinterpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position\x3du_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos\x3dnormal.x\x3d\x3d1.0 \x26\x26 normal.y\x3d\x3d0.0 \x26\x26 normal.z\x3d\x3d16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b\x3dget_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting\x3dvec4(0.0,0.0,0.0,1.0);float directional\x3dclamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional\x3dmix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !\x3d0.0) {directional*\x3d((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+\x3dclamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*\x3du_opacity;}"),
hillshadePrepare:W("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data\x3dtexture(u_image,coord)*255.0;data.a\x3d-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon\x3d1.0/u_dimension;float tileSize\x3du_dimension.x-2.0;float a\x3dgetElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b\x3dgetElevation(v_pos+vec2(0,-epsilon.y),0.0);float c\x3dgetElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d\x3dgetElevation(v_pos+vec2(-epsilon.x,0),0.0);float e\x3dgetElevation(v_pos,0.0);float f\x3dgetElevation(v_pos+vec2(epsilon.x,0),0.0);float g\x3dgetElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h\x3dgetElevation(v_pos+vec2(0,epsilon.y),0.0);float i\x3dgetElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor\x3du_zoom \x3c 2.0 ? 0.4 : u_zoom \x3c 4.5 ? 0.35 : 0.3;float exaggeration\x3du_zoom \x3c 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv\x3dvec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor\x3dclamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position\x3du_matrix*vec4(a_pos,0,1);highp vec2 epsilon\x3d1.0/u_dimension;float scale\x3d(u_dimension.x-2.0)/u_dimension.x;v_pos\x3d(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:W("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !\x3d0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y \x3e 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv\x3dderiv*u_exaggeration*2.0;float aspect\x3dget_aspect(deriv);float azimuth\x3du_azimuths[0]+PI;float slope_stength\x3datan(length(deriv))*2.0/PI;float aspect_strength\x3d1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength\x3dslope_stength*aspect_strength;float highlight_strength\x3dslope_stength*(1.0-aspect_strength);fragColor\x3du_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth\x3du_azimuths[0]+PI;float slope\x3datan(0.625*length(deriv));float aspect\x3dget_aspect(deriv);float intensity\x3du_exaggeration;float base\x3d1.875-intensity*1.75;float maxValue\x3d0.5*PI;float scaledSlope\x3dintensity !\x3d0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent\x3dcos(scaledSlope);vec4 accent_color\x3d(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade\x3dabs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color\x3dmix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor\x3daccent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv\x3dderiv*u_exaggeration*2.0;float azimuth\x3du_azimuths[0]+PI;float cos_az\x3dcos(azimuth);float sin_az\x3dsin(azimuth);float cos_alt\x3dcos(u_altitudes[0]);float sin_alt\x3dsin(u_altitudes[0]);float cang\x3d(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade\x3dclamp(cang,0.0,1.0);if(shade \x3e 0.5){fragColor\x3du_highlights[0]*(2.0*shade-1.0);}else\n{fragColor\x3du_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv\x3dderiv*u_exaggeration*2.0;fragColor\x3dvec4(0,0,0,0);for(int i\x3d0; i \x3c NUM_ILLUMINATION_SOURCES; i++){float cos_alt\x3dcos(u_altitudes[i]);float sin_alt\x3dsin(u_altitudes[i]);float cos_az\x3d-cos(u_azimuths[i]);float sin_az\x3d-sin(u_azimuths[i]);float cang\x3d(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade\x3dclamp(cang,0.0,1.0);if(shade \x3e 0.5){fragColor+\x3du_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+\x3du_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv\x3dderiv*u_exaggeration*2.0;float azimuth\x3du_azimuths[0]+PI;float cos_az\x3dcos(azimuth);float sin_az\x3dsin(azimuth);float cos_alt\x3dcos(u_altitudes[0]);float sin_alt\x3dsin(u_altitudes[0]);float cang\x3dacos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang\x3dclamp(cang,0.0,PI/2.0);float shade\x3dcang*atan(length(deriv))*4.0/PI/PI;float highlight\x3d(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor\x3du_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel\x3dtexture(u_image,v_pos);float scaleFactor\x3dcos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv\x3d((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method\x3d\x3dBASIC) {basic_hillshade(deriv);} else if (u_method\x3d\x3dCOMBINED) {combined_hillshade(deriv);} else if (u_method\x3d\x3dIGOR) {igor_hillshade(deriv);} else if (u_method\x3d\x3dMULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method\x3d\x3dSTANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position\x3dprojectTile(a_pos,a_pos);v_pos\x3da_pos/8192.0;if (a_pos.y \x3c-32767.5) {v_pos.y\x3d0.0;}if (a_pos.y \x3e 32766.5) {v_pos.y\x3d1.0;}}"),line:W("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist\x3dlength(v_normal)*v_width2.s;float blur2\x3d(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha\x3dclamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor\x3dcolor*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING\x3d1.0/u_device_pixel_ratio/2.0;vec2 a_extrude\x3da_data.xy-128.0;float a_direction\x3dmod(a_data.z,4.0)-1.0;v_linesofar\x3d(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos\x3dfloor(a_pos_normal*0.5);mediump vec2 normal\x3da_pos_normal-2.0*pos;normal.y\x3dnormal.y*2.0-1.0;v_normal\x3dnormal;gapwidth\x3dgapwidth/2.0;float halfwidth\x3dwidth/2.0;offset\x3d-1.0*offset;float inset\x3dgapwidth+(gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);float outset\x3dgapwidth+halfwidth*(gapwidth \x3e 0.0 ? 2.0 : 1.0)+(halfwidth\x3d\x3d0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist\x3doutset*a_extrude*scale;mediump float u\x3d0.5*a_direction;mediump float t\x3d1.0-abs(u);mediump vec2 offset2\x3doffset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness\x3dprojectLineThickness(pos.y);vec4 projected_no_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position\x3dprojected_with_extrude;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale\x3d1.0;\n#else\nfloat extrude_length_without_perspective\x3dlength(dist);float extrude_length_with_perspective\x3dlength((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale\x3dextrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2\x3dvec2(outset,inset);}"),
lineGradient:W("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist\x3dlength(v_normal)*v_width2.s;float blur2\x3d(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha\x3dclamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color\x3dtexture(u_image,v_uv);fragColor\x3dcolor*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING\x3d1.0/u_device_pixel_ratio/2.0;vec2 a_extrude\x3da_data.xy-128.0;float a_direction\x3dmod(a_data.z,4.0)-1.0;highp float texel_height\x3d1.0/u_image_height;highp float half_texel_height\x3d0.5*texel_height;v_uv\x3dvec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos\x3dfloor(a_pos_normal*0.5);mediump vec2 normal\x3da_pos_normal-2.0*pos;normal.y\x3dnormal.y*2.0-1.0;v_normal\x3dnormal;gapwidth\x3dgapwidth/2.0;float halfwidth\x3dwidth/2.0;offset\x3d-1.0*offset;float inset\x3dgapwidth+(gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);float outset\x3dgapwidth+halfwidth*(gapwidth \x3e 0.0 ? 2.0 : 1.0)+(halfwidth\x3d\x3d0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist\x3doutset*a_extrude*scale;mediump float u\x3d0.5*a_direction;mediump float t\x3d1.0-abs(u);mediump vec2 offset2\x3doffset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness\x3dprojectLineThickness(pos.y);vec4 projected_no_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position\x3dprojected_with_extrude;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale\x3d1.0;\n#else\nfloat extrude_length_without_perspective\x3dlength(dist);float extrude_length_with_perspective\x3dlength((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale\x3dextrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2\x3dvec2(outset,inset);}"),
linePattern:W("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a\x3dpattern_from.xy;vec2 pattern_br_a\x3dpattern_from.zw;vec2 pattern_tl_b\x3dpattern_to.xy;vec2 pattern_br_b\x3dpattern_to.zw;float tileZoomRatio\x3du_scale.x;float fromScale\x3du_scale.y;float toScale\x3du_scale.z;vec2 display_size_a\x3d(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b\x3d(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a\x3dvec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b\x3dvec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a\x3ddisplay_size_a.y/v_width;float aspect_b\x3ddisplay_size_b.y/v_width;float dist\x3dlength(v_normal)*v_width2.s;float blur2\x3d(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha\x3dclamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a\x3dmod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b\x3dmod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y\x3d0.5*v_normal.y+0.5;vec2 texel_size\x3d1.0/u_texsize;vec2 pos_a\x3dmix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b\x3dmix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color\x3dmix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor\x3dcolor*alpha*opacity;\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING\x3d1.0/u_device_pixel_ratio/2.0;vec2 a_extrude\x3da_data.xy-128.0;float a_direction\x3dmod(a_data.z,4.0)-1.0;float a_linesofar\x3d(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos\x3dfloor(a_pos_normal*0.5);mediump vec2 normal\x3da_pos_normal-2.0*pos;normal.y\x3dnormal.y*2.0-1.0;v_normal\x3dnormal;gapwidth\x3dgapwidth/2.0;float halfwidth\x3dwidth/2.0;offset\x3d-1.0*offset;float inset\x3dgapwidth+(gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);float outset\x3dgapwidth+halfwidth*(gapwidth \x3e 0.0 ? 2.0 : 1.0)+(halfwidth\x3d\x3d0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist\x3doutset*a_extrude*scale;mediump float u\x3d0.5*a_direction;mediump float t\x3d1.0-abs(u);mediump vec2 offset2\x3doffset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness\x3dprojectLineThickness(pos.y);vec4 projected_no_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position\x3dprojected_with_extrude;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale\x3d1.0;\n#else\nfloat extrude_length_without_perspective\x3dlength(dist);float extrude_length_with_perspective\x3dlength((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale\x3dextrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar\x3da_linesofar;v_width2\x3dvec2(outset,inset);v_width\x3dfloorwidth;}"),
lineSDF:W("uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist\x3dlength(v_normal)*v_width2.s;float blur2\x3d(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha\x3dclamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a\x3dtexture(u_image,v_tex_a).a;float sdfdist_b\x3dtexture(u_image,v_tex_b).a;float sdfdist\x3dmix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma\x3d(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*\x3dsmoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor\x3dcolor*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING\x3d1.0/u_device_pixel_ratio/2.0;vec2 a_extrude\x3da_data.xy-128.0;float a_direction\x3dmod(a_data.z,4.0)-1.0;float a_linesofar\x3d(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos\x3dfloor(a_pos_normal*0.5);mediump vec2 normal\x3da_pos_normal-2.0*pos;normal.y\x3dnormal.y*2.0-1.0;v_normal\x3dnormal;gapwidth\x3dgapwidth/2.0;float halfwidth\x3dwidth/2.0;offset\x3d-1.0*offset;float inset\x3dgapwidth+(gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);float outset\x3dgapwidth+halfwidth*(gapwidth \x3e 0.0 ? 2.0 : 1.0)+(halfwidth\x3d\x3d0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist\x3doutset*a_extrude*scale;mediump float u\x3d0.5*a_direction;mediump float t\x3d1.0-abs(u);mediump vec2 offset2\x3doffset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness\x3dprojectLineThickness(pos.y);vec4 projected_no_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position\x3dprojected_with_extrude;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale\x3d1.0;\n#else\nfloat extrude_length_without_perspective\x3dlength(dist);float extrude_length_with_perspective\x3dlength((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale\x3dextrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x\x3du_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y\x3d-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x\x3du_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y\x3d-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a\x3dvec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b\x3dvec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2\x3dvec2(outset,inset);}"),
lineGradientSDF:W("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist\x3dlength(v_normal)*v_width2.s;float blur2\x3d(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha\x3dclamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color\x3dtexture(u_image,v_uv);float sdfdist_a\x3dtexture(u_image_dash,v_tex_a).a;float sdfdist_b\x3dtexture(u_image_dash,v_tex_b).a;float sdfdist\x3dmix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma\x3d(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha\x3dsmoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor\x3dcolor*(alpha*dash_alpha*opacity);\n#ifdef GLOBE\nif (v_depth \x3e 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING\x3d1.0/u_device_pixel_ratio/2.0;vec2 a_extrude\x3da_data.xy-128.0;float a_direction\x3dmod(a_data.z,4.0)-1.0;float a_linesofar\x3d(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height\x3d1.0/u_image_height;float half_texel_height\x3d0.5*texel_height;v_uv\x3dvec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos\x3dfloor(a_pos_normal*0.5);mediump vec2 normal\x3da_pos_normal-2.0*pos;normal.y\x3dnormal.y*2.0-1.0;v_normal\x3dnormal;gapwidth\x3dgapwidth/2.0;float halfwidth\x3dwidth/2.0;offset\x3d-1.0*offset;float inset\x3dgapwidth+(gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);float outset\x3dgapwidth+halfwidth*(gapwidth \x3e 0.0 ? 2.0 : 1.0)+(halfwidth\x3d\x3d0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist\x3doutset*a_extrude*scale;mediump float u\x3d0.5*a_direction;mediump float t\x3d1.0-abs(u);mediump vec2 offset2\x3doffset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness\x3dprojectLineThickness(pos.y);vec4 projected_no_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude\x3dprojectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position\x3dprojected_with_extrude;\n#ifdef GLOBE\nv_depth\x3dgl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale\x3d1.0;\n#else\nfloat extrude_length_without_perspective\x3dlength(dist);float extrude_length_with_perspective\x3dlength((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale\x3dextrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x\x3du_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y\x3d-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x\x3du_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y\x3d-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a\x3dvec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b\x3dvec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2\x3dvec2(outset,inset);}"),
raster:W("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0\x3dtexture(u_image0,v_pos0);vec4 color1\x3dtexture(u_image1,v_pos1);if (color0.a \x3e 0.0) {color0.rgb\x3dcolor0.rgb/color0.a;}if (color1.a \x3e 0.0) {color1.rgb\x3dcolor1.rgb/color1.a;}vec4 color\x3dmix(color0,color1,u_fade_t);color.a*\x3du_opacity;vec3 rgb\x3dcolor.rgb;rgb\x3dvec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average\x3d(color.r+color.g+color.b)/3.0;rgb+\x3d(average-rgb)*u_saturation_factor;rgb\x3d(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec\x3dvec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec\x3dvec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor\x3dvec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos\x3da_pos/8192.0;vec2 position\x3dmix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position\x3dprojectTile(position,position);v_pos0\x3d((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y \x3c-32767.5) {v_pos0.y\x3d0.0;}if (a_pos.y \x3e 32766.5) {v_pos0.y\x3d1.0;}\n#endif\nv_pos1\x3d(v_pos0*u_scale_parent)+u_tl_parent;}"),
symbolIcon:W("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha\x3dopacity*v_fade_opacity;fragColor\x3dtexture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos\x3da_pos_offset.xy;vec2 a_offset\x3da_pos_offset.zw;vec2 a_tex\x3da_data.xy;vec2 a_size\x3da_data.zw;float a_size_min\x3dfloor(a_size[0]*0.5);vec2 a_pxoffset\x3da_pixeloffset.xy;vec2 a_minFontScale\x3da_pixeloffset.zw/256.0;float ele\x3dget_elevation(a_pos);highp float segment_angle\x3d-a_projected_pos[2];float size;if (!u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3dmix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3da_size_min/128.0;} else {size\x3du_size;}vec2 translated_a_pos\x3da_pos+u_translation;vec4 projectedPoint\x3dprojectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance\x3dprojectedPoint.w;highp float distance_ratio\x3du_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio\x3dclamp(0.5+0.5*distance_ratio,0.0,4.0);size*\x3dperspective_ratio;float fontScale\x3du_is_text ? size/24.0 : size;highp float symbol_rotation\x3d0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint\x3dprojectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a\x3dprojectedPoint.xy/projectedPoint.w;vec2 b\x3doffsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation\x3datan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin\x3dsin(segment_angle+symbol_rotation);highp float angle_cos\x3dcos(segment_angle+symbol_rotation);mat2 rotation_matrix\x3dmat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos\x3dvec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos\x3du_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos\x3du_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z\x3dfloat(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling\x3d1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y\x3d(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling\x3dmix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos\x3du_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos\x3dprojectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position\x3dfinalPos;v_tex\x3da_tex/u_texsize;vec2 fade_opacity\x3dunpack_opacity(a_fade_opacity);float fade_change\x3dfade_opacity[1] \x3e 0.5 ? u_fade_change :-u_fade_change;float visibility\x3dcalculate_visibility(projectedPoint);v_fade_opacity\x3dmax(0.0,min(visibility,fade_opacity[0]+fade_change));}"),
symbolSDF:W("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA\x3d0.105/u_device_pixel_ratio;vec2 tex\x3dv_data0.xy;float gamma_scale\x3dv_data1.x;float size\x3dv_data1.y;float fade_opacity\x3dv_data1[2];float fontScale\x3du_is_text ? size/24.0 : size;lowp vec4 color\x3dfill_color;highp float gamma\x3dEDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge\x3d(256.0-64.0)/256.0;if (u_is_halo) {color\x3dhalo_color;gamma\x3d(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge\x3dinner_edge+gamma*gamma_scale;}lowp float dist\x3dtexture(u_texture,tex).a;highp float gamma_scaled\x3dgamma*gamma_scale;highp float alpha\x3dsmoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge\x3d(6.0-halo_width/fontScale)/SDF_PX;alpha\x3dmin(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor\x3dcolor*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos\x3da_pos_offset.xy;vec2 a_offset\x3da_pos_offset.zw;vec2 a_tex\x3da_data.xy;vec2 a_size\x3da_data.zw;float a_size_min\x3dfloor(a_size[0]*0.5);vec2 a_pxoffset\x3da_pixeloffset.xy;float ele\x3dget_elevation(a_pos);highp float segment_angle\x3d-a_projected_pos[2];float size;if (!u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3dmix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3da_size_min/128.0;} else {size\x3du_size;}vec2 translated_a_pos\x3da_pos+u_translation;vec4 projectedPoint\x3dprojectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance\x3dprojectedPoint.w;highp float distance_ratio\x3du_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio\x3dclamp(0.5+0.5*distance_ratio,0.0,4.0);size*\x3dperspective_ratio;float fontScale\x3du_is_text ? size/24.0 : size;highp float symbol_rotation\x3d0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint\x3dprojectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a\x3dprojectedPoint.xy/projectedPoint.w;vec2 b\x3doffsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation\x3datan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin\x3dsin(segment_angle+symbol_rotation);highp float angle_cos\x3dcos(segment_angle+symbol_rotation);mat2 rotation_matrix\x3dmat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos\x3dvec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos\x3du_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos\x3du_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z\x3dfloat(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling\x3d1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y\x3d(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling\x3dmix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos\x3du_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos\x3dprojectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale\x3dfinalPos.w;gl_Position\x3dfinalPos;vec2 fade_opacity\x3dunpack_opacity(a_fade_opacity);float visibility\x3dcalculate_visibility(projectedPoint);float fade_change\x3dfade_opacity[1] \x3e 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity\x3dmax(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0\x3da_tex/u_texsize;v_data1\x3dvec3(gamma_scale,size,interpolated_fade_opacity);}"),
symbolTextAndIcon:W("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity\x3dv_data1[2];if (v_data1.w\x3d\x3dICON) {vec2 tex_icon\x3dv_data0.zw;lowp float alpha\x3dopacity*fade_opacity;fragColor\x3dtexture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\nreturn;}vec2 tex\x3dv_data0.xy;float EDGE_GAMMA\x3d0.105/u_device_pixel_ratio;float gamma_scale\x3dv_data1.x;float size\x3dv_data1.y;float fontScale\x3dsize/24.0;lowp vec4 color\x3dfill_color;highp float gamma\x3dEDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff\x3d(256.0-64.0)/256.0;if (u_is_halo) {color\x3dhalo_color;gamma\x3d(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff\x3d(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist\x3dtexture(u_texture,tex).a;highp float gamma_scaled\x3dgamma*gamma_scale;highp float alpha\x3dsmoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor\x3dcolor*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor\x3dvec4(1.0);\n#endif\n}",
"in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos\x3da_pos_offset.xy;vec2 a_offset\x3da_pos_offset.zw;vec2 a_tex\x3da_data.xy;vec2 a_size\x3da_data.zw;float a_size_min\x3dfloor(a_size[0]*0.5);float is_sdf\x3da_size[0]-2.0*a_size_min;float ele\x3dget_elevation(a_pos);highp float segment_angle\x3d-a_projected_pos[2];float size;if (!u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3dmix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {size\x3da_size_min/128.0;} else {size\x3du_size;}vec2 translated_a_pos\x3da_pos+u_translation;vec4 projectedPoint\x3dprojectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance\x3dprojectedPoint.w;highp float distance_ratio\x3du_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio\x3dclamp(0.5+0.5*distance_ratio,0.0,4.0);size*\x3dperspective_ratio;float fontScale\x3dsize/24.0;highp float symbol_rotation\x3d0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint\x3dprojectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a\x3dprojectedPoint.xy/projectedPoint.w;vec2 b\x3doffsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation\x3datan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin\x3dsin(segment_angle+symbol_rotation);highp float angle_cos\x3dcos(segment_angle+symbol_rotation);mat2 rotation_matrix\x3dmat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos\x3dvec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos\x3du_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos\x3du_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z\x3dfloat(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling\x3d1.0;\n#ifdef GLOBE\nif(u_pitch_with_map \x26\x26 !u_is_along_line) {float anchor_pos_tile_y\x3d(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling\x3dmix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos\x3du_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos\x3dprojectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale\x3dfinalPos.w;gl_Position\x3dfinalPos;vec2 fade_opacity\x3dunpack_opacity(a_fade_opacity);float visibility\x3dcalculate_visibility(projectedPoint);float fade_change\x3dfade_opacity[1] \x3e 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity\x3dmax(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy\x3da_tex/u_texsize;v_data0.zw\x3da_tex/u_texsize_icon;v_data1\x3dvec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),
terrain:W("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma\x3d2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color\x3dtexture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode \x26\x26 v_fog_depth \x3e u_fog_ground_blend) {vec4 surface_color_linear\x3dgammaToLinear(surface_color);float blend_color\x3dsmoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear\x3dmix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog\x3dmax(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor\x3dlinearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor\x3dsurface_color;}}",
"in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele\x3dget_elevation(a_pos3d.xy);float ele_delta\x3da_pos3d.z\x3d\x3d1.0 ? u_ele_delta : 0.0;v_texture_pos\x3da_pos3d.xy/8192.0;gl_Position\x3dprojectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos\x3du_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth\x3dpos.z/pos.w*0.5+0.5;}"),terrainDepth:W("in float v_depth;const highp vec4 bitSh\x3dvec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk\x3dvec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp\x3dfract(value*bitSh);comp-\x3dcomp.xxyz*bitMsk;return comp;}void main() {fragColor\x3dpack(v_depth);}",
"in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele\x3dget_elevation(a_pos3d.xy);float ele_delta\x3da_pos3d.z\x3d\x3d1.0 ? u_ele_delta : 0.0;gl_Position\x3dprojectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth\x3dgl_Position.z/gl_Position.w;}"),terrainCoords:W("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba\x3dtexture(u_texture,v_texture_pos);fragColor\x3dvec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",
"in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele\x3dget_elevation(a_pos3d.xy);float ele_delta\x3da_pos3d.z\x3d\x3d1.0 ? u_ele_delta : 0.0;v_texture_pos\x3da_pos3d.xy/8192.0;gl_Position\x3dprojectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:W("in vec4 v_output_error_encoded;void main() {fragColor\x3dv_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output\x3d2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error\x3dreal_output-u_output_expected;float abs_error\x3dabs(error)*128.0;v_output_error_encoded.x\x3dmin(floor(abs_error*256.0),255.0)/255.0;abs_error-\x3dv_output_error_encoded.x;v_output_error_encoded.y\x3dmin(floor(abs_error*65536.0),255.0)/255.0;abs_error-\x3dv_output_error_encoded.x/255.0;v_output_error_encoded.z\x3dmin(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w\x3derror \x3e\x3d0.0 ? 1.0 : 0.0;gl_Position\x3dvec4(a_pos,0.0,1.0);}"),
atmosphere:W("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI\x3d3.141592653589793;const int iSteps\x3d5;const int jSteps\x3d3;/*radius of the planet*/const float EARTH_RADIUS\x3d6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS\x3d6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a\x3ddot(rd,rd);float b\x3d2.0*dot(rd,r0);float c\x3ddot(r0,r0)-(sr*sr);float d\x3d(b*b)-4.0*a*c;if (d \x3c 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun\x3dnormalize(pSun);r\x3dnormalize(r);vec2 p\x3drsi(r0,r,rAtmos);if (p.x \x3e p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x \x3c 0.0) {p.x\x3d0.0;}vec3 pos\x3dr0+r*p.x;vec2 p2\x3drsi(r0,r,rPlanet);if (p2.x \x3c\x3dp2.y \x26\x26 p2.x \x3e 0.0) {p.y\x3dmin(p.y,p2.x);}float iStepSize\x3d(p.y-p.x)/float(iSteps);float iTime\x3dp.x+iStepSize*0.5;vec3 totalRlh\x3dvec3(0,0,0);vec3 totalMie\x3dvec3(0,0,0);float iOdRlh\x3d0.0;float iOdMie\x3d0.0;float mu\x3ddot(r,pSun);float mumu\x3dmu*mu;float gg\x3dg*g;float pRlh\x3d3.0/(16.0*PI)*(1.0+mumu);float pMie\x3d3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i\x3d0; i \x3c iSteps; i++) {vec3 iPos\x3dr0+r*iTime;float iHeight\x3dlength(iPos)-rPlanet;float odStepRlh\x3dexp(-iHeight/shRlh)*iStepSize;float odStepMie\x3dexp(-iHeight/shMie)*iStepSize;iOdRlh+\x3dodStepRlh;iOdMie+\x3dodStepMie;float jStepSize\x3drsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime\x3djStepSize*0.5;float jOdRlh\x3d0.0;float jOdMie\x3d0.0;for (int j\x3d0; j \x3c jSteps; j++) {vec3 jPos\x3diPos+pSun*jTime;float jHeight\x3dlength(jPos)-rPlanet;jOdRlh+\x3dexp(-jHeight/shRlh)*jStepSize;jOdMie+\x3dexp(-jHeight/shMie)*jStepSize;jTime+\x3djStepSize;}vec3 attn\x3dexp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+\x3dodStepRlh*attn;totalMie+\x3dodStepMie*attn;iTime+\x3diStepSize;}float opacity\x3dexp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color\x3diSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos\x3d-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color\x3datmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb\x3d1.0-exp(-1.0*color.rgb);color\x3dpow(color,vec4(1.0/2.2));fragColor\x3dvec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}",
"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction\x3d(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position\x3dvec4(a_pos,0.0,1.0);}"),sky:W("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x\x3dgl_FragCoord.x;float y\x3dgl_FragCoord.y;float blend\x3d(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend \x3e 0.0) {if (blend \x3c u_sky_horizon_blend) {fragColor\x3dmix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor\x3du_sky_color;}}fragColor\x3dmix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}",
"in vec2 a_pos;void main() {gl_Position\x3dvec4(a_pos,1.0,1.0);}")};class sg{constructor(b,g,m){this.vertexBuffer=b;this.indexBuffer=g;this.segments=m}destroy(){this.vertexBuffer.destroy();this.indexBuffer.destroy();this.segments.destroy();this.segments=this.indexBuffer=this.vertexBuffer=null}}var He=v.aJ([{name:"a_pos",type:"Int16",components:2}]);class Eb{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return"mercator"}get shaderDefine(){return"#define PROJECTION_MERCATOR"}get shaderPreludeCode(){return Ed.projectionMercator}get vertexShaderPreludeCode(){return Ed.projectionMercator.vertexSource}get subdivisionGranularity(){return v.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(b){}getMeshFromTileID(b,
g,m,u,z){if(this._cachedMesh)return this._cachedMesh;g=new v.aL;g.emplaceBack(0,0);g.emplaceBack(v.$,0);g.emplaceBack(0,v.$);g.emplaceBack(v.$,v.$);g=b.createVertexBuffer(g,He.members);m=v.aM.simpleSegment(0,0,4,2);u=new v.aN;u.emplaceBack(1,0,2);u.emplaceBack(1,2,3);b=b.createIndexBuffer(u);return this._cachedMesh=new sg(g,b,m),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(b){}}class Cb{constructor(b=0,g=0,m=0,u=0){if(isNaN(b)||0>b||isNaN(g)||0>g||isNaN(m)||
0>m||isNaN(u)||0>u)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=b;this.bottom=g;this.left=m;this.right=u}interpolate(b,g,m){return null!=g.top&&null!=b.top&&(this.top=v.C.number(b.top,g.top,m)),null!=g.bottom&&null!=b.bottom&&(this.bottom=v.C.number(b.bottom,g.bottom,m)),null!=g.left&&null!=b.left&&(this.left=v.C.number(b.left,g.left,m)),null!=g.right&&null!=b.right&&(this.right=v.C.number(b.right,g.right,m)),this}getCenter(b,g){b=v.ah((this.left+
b-this.right)/2,0,b);g=v.ah((this.top+g-this.bottom)/2,0,g);return new v.P(b,g)}equals(b){return this.top===b.top&&this.bottom===b.bottom&&this.left===b.left&&this.right===b.right}clone(){return new Cb(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class kd{constructor(b,g,m,u,z,C){this._callbacks=b;this._tileSize=512;this._renderWorldCopies=void 0===C||!!C;this._minZoom=g||0;this._maxZoom=m||22;this._minPitch=null==u?0:
u;this._maxPitch=null==z?60:z;this.setMaxBounds();this._height=this._width=0;this._center=new v.S(0,0);this._zoom=this._elevation=0;this._tileZoom=Math.max(0,Math.floor(this._zoom));this._scale=v.af(this._zoom);this._bearingInRadians=0;this._fovInRadians=.6435011087932844;this._rollInRadians=this._pitchInRadians=0;this._unmodified=!0;this._edgeInsets=new Cb;this._minElevationForCurrentTile=0;this._autoCalculateNearFarZ=!0}apply(b,g,m){this._latRange=b.latRange;this._lngRange=b.lngRange;this._width=
b.width;this._height=b.height;this._center=b.center;this._elevation=b.elevation;this._minElevationForCurrentTile=b.minElevationForCurrentTile;this._zoom=b.zoom;this._tileZoom=Math.max(0,Math.floor(this._zoom));this._scale=v.af(this._zoom);this._bearingInRadians=b.bearingInRadians;this._fovInRadians=b.fovInRadians;this._pitchInRadians=b.pitchInRadians;this._rollInRadians=b.rollInRadians;this._unmodified=b.unmodified;this._edgeInsets=new Cb(b.padding.top,b.padding.bottom,b.padding.left,b.padding.right);
this._minZoom=b.minZoom;this._maxZoom=b.maxZoom;this._minPitch=b.minPitch;this._maxPitch=b.maxPitch;this._renderWorldCopies=b.renderWorldCopies;this._cameraToCenterDistance=b.cameraToCenterDistance;this._nearZ=b.nearZ;this._farZ=b.farZ;this._autoCalculateNearFarZ=!m&&b.autoCalculateNearFarZ;g&&this._constrain();this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(b){this._minElevationForCurrentTile=
b}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(b){this._minZoom!==b&&(this._minZoom=b,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(b){this._maxZoom!==
b&&(this._maxZoom=b,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(b){this._minPitch!==b&&(this._minPitch=b,this.setPitch(Math.max(this.pitch,b)))}get maxPitch(){return this._maxPitch}setMaxPitch(b){this._maxPitch!==b&&(this._maxPitch=b,this.setPitch(Math.min(this.pitch,b)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(b){void 0===b?b=!0:null===b&&(b=!1);this._renderWorldCopies=b}get worldSize(){return this._tileSize*
this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new v.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(b){b=v.aO(b,-180,180)*Math.PI/180;var g,m,u,z,C,G,K,R,X;this._bearingInRadians!==b&&(this._unmodified=!1,this._bearingInRadians=b,this._calcMatrices(),this._rotationMatrix=ta(),g=this._rotationMatrix,u=-this._bearingInRadians,z=(m=this._rotationMatrix)[0],C=m[1],G=m[2],K=m[3],R=Math.sin(u),X=Math.cos(u),
g[0]=z*X+G*R,g[1]=C*X+K*R,g[2]=z*-R+G*X,g[3]=C*-R+K*X)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(b){b=v.ah(b,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==b&&(this._unmodified=!1,this._pitchInRadians=b,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(b){b=b/180*Math.PI;this._rollInRadians!==
b&&(this._unmodified=!1,this._rollInRadians=b,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return v.aP(this._fovInRadians)}setFov(b){b=v.ah(b,.1,150);this.fov!==b&&(this._unmodified=!1,this._fovInRadians=v.ae(b),this._calcMatrices())}get zoom(){return this._zoom}setZoom(b){b=this.getConstrained(this._center,b).zoom;this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this._tileZoom=Math.max(0,Math.floor(b)),this._scale=v.af(b),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(b){b.lat===
this._center.lat&&b.lng===this._center.lng||(this._unmodified=!1,this._center=b,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(b){b!==this._elevation&&(this._elevation=b,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(b){this._edgeInsets.equals(b)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,b,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,
this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(b,g){this._autoCalculateNearFarZ=!1;this._nearZ=b;this._farZ=g;this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0;this._calcMatrices()}isPaddingEqual(b){return this._edgeInsets.equals(b)}interpolatePadding(b,
g,m){this._unmodified=!1;this._edgeInsets.interpolate(b,g,m);this._constrain();this._calcMatrices()}resize(b,g,m=!0){this._width=b;this._height=g;m&&this._constrain();this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new qf([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(b){b?(this._lngRange=[b.getWest(),b.getEast()],this._latRange=[b.getSouth(),b.getNorth()],this._constrain()):
(this._lngRange=null,this._latRange=[-v.ai,v.ai])}getConstrained(b,g){return this._callbacks.getConstrained(b,g)}getCameraQueryGeometry(b,g){if(1===g.length)return[g[0],b];const {minX:m,minY:u,maxX:z,maxY:C}=v.a2.fromPoints(g).extend(b);return[new v.P(m,u),new v.P(z,u),new v.P(z,C),new v.P(m,C),new v.P(m,u)]}_constrain(){if(this.center&&this._width&&this._height&&!this._constraining){this._constraining=!0;var b=this._unmodified,{center:g,zoom:m}=this.getConstrained(this.center,this.zoom);this.setCenter(g);
this.setZoom(m);this._unmodified=b;this._constraining=!1}}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let b=v.ag(new Float64Array(16));v.N(b,b,[this._width/2,-this._height/2,1]);v.M(b,b,[1,-1,0]);this._clipSpaceToPixelsMatrix=b;b=v.ag(new Float64Array(16));v.N(b,b,[1,-1,1]);v.M(b,b,[-1,-1,0]);v.N(b,b,[2/this._width,2/this._height,1]);this._pixelsToClipSpaceMatrix=b;this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(b,
g,m,u){var z=void 0!==m?m:this.bearing;m=u=void 0!==u?u:this.pitch;b=v.a1.fromLngLat(b,g);u=-Math.cos(v.ae(m));var C=Math.sin(v.ae(m));m=C*Math.sin(v.ae(z));z=-C*Math.cos(v.ae(z));C=this.elevation;const G=g-C;let K;0<=u*G||.1>Math.abs(u)?(K=1E4,C=g+K*u):K=-G/u;let R,X;g=v.aQ(1,b.y);u=0;do{if(u+=1,10<u)break;X=K/g;R=new v.a1(b.x+m*X,b.y+z*X);g=1/R.meterInMercatorCoordinateUnits()}while(1E-12<Math.abs(K-X*g));return{center:R.toLngLat(),elevation:C,zoom:v.ak(this.height/2/Math.tan(this.fovInRadians/
2)/X/this.tileSize)}}recalculateZoomAndCenter(b){if(0!=this.elevation-b){var g=v.aj(1,this.center.lat)*this.worldSize,m=this.cameraToCenterDistance/g;g=v.a1.fromLngLat(this.center,this.elevation);m=id(this.center,this.elevation,this.pitch,this.bearing,m);this._elevation=b;b=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),v.aQ(m.z,g.y),this.bearing,this.pitch);this._elevation=b.elevation;this._center=b.center;this.setZoom(b.zoom)}}getCameraPoint(){const b=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||
1);return this.centerPoint.add(new v.P(b*Math.sin(this.rollInRadians),b*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const b=v.aj(1,this.center.lat)*this.worldSize;return id(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/b).toLngLat()}getMercatorTileCoordinates(b){if(!b)return[0,0,1,1];const g=0<=b.canonical.z?1<<b.canonical.z:Math.pow(2,b.canonical.z);
return[b.canonical.x/g,b.canonical.y/g,1/g/v.$,1/g/v.$]}}class $f{constructor(b,g){this.min=b;this.max=g;this.center=v.aR([],v.aS([],this.min,this.max),.5)}quadrant(b){b=[0==b%2,2>b];const g=v.aT(this.min),m=v.aT(this.max);for(let u=0;u<b.length;u++)g[u]=b[u]?this.min[u]:this.center[u],m[u]=b[u]?this.center[u]:this.max[u];return m[2]=this.max[2],new $f(g,m)}distanceX(b){return Math.max(Math.min(this.max[0],b[0]),this.min[0])-b[0]}distanceY(b){return Math.max(Math.min(this.max[1],b[1]),this.min[1])-
b[1]}intersectsFrustum(b){let g=!0;for(let m=0;m<b.planes.length;m++){const u=this.intersectsPlane(b.planes[m]);if(0===u)return 0;1===u&&(g=!1)}return g?2:b.aabb.min[0]>this.max[0]||b.aabb.min[1]>this.max[1]||b.aabb.min[2]>this.max[2]||b.aabb.max[0]<this.min[0]||b.aabb.max[1]<this.min[1]||b.aabb.max[2]<this.min[2]?0:1}intersectsPlane(b){let g=b[3],m=b[3];for(let u=0;3>u;u++)0<b[u]?(g+=b[u]*this.min[u],m+=b[u]*this.max[u]):(m+=b[u]*this.min[u],g+=b[u]*this.max[u]);return 0<=g?2:0>m?0:1}}class sf{distanceToTile2d(b,
g,m,u){m=u.distanceX([b,g]);b=u.distanceY([b,g]);return Math.hypot(m,b)}getWrap(b,g,m){return m}getTileBoundingVolume(b,g,m,u){var z,C,G=0;let K=0;if(null==u?0:u.terrain)G=new v.Z(b.z,g,b.z,b.x,b.y),u=u.terrain.getMinMaxElevation(G),G=null!==(z=u.minElevation)&&void 0!==z?z:Math.min(0,m),K=null!==(C=u.maxElevation)&&void 0!==C?C:Math.max(0,m);m=1<<b.z;return new $f([g+b.x/m,b.y/m,G],[g+(b.x+1)/m,(b.y+1)/m,K])}allowVariableZoom(b,g){const m=v.ah(78.5-b.fov*(Math.abs(Math.cos(b.rollInRadians))*b.height+
Math.abs(Math.sin(b.rollInRadians))*b.width)/b.height/2,0,60);return!!g.terrain||b.pitch>m}allowWorldCopies(){return!0}prepareNextFrame(){}}class ld{constructor(b,g,m){this.points=b;this.planes=g;this.aabb=m}static fromInvProjectionMatrix(b,g=1,m=0,u,z){var C=z?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]];const G=Math.pow(2,m),K=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{R=v.aw([],R,b);
const X=1/R[3]/g*G;return v.aY(R,R,[X,X,1/R[3],X])});u&&function(R,X,ca,ja){const la=ja?4:0;ja=ja?0:4;let pa=0;const ya=[],Ba=[];for(var za=0;4>za;za++){var Ea=v.aU([],R[za+ja],R[za+la]);const Qa=v.aZ(Ea);v.aR(Ea,Ea,1/Qa);ya.push(Qa);Ba.push(Ea)}for(za=0;4>za;za++)Ea=v.a_(R[za+la],Ba[za],ca),pa=null!==Ea&&0<=Ea?Math.max(pa,Ea):Math.max(pa,ya[za]);X=function(Qa,Za){const sb=v.aU([],Qa[Za[0]],Qa[Za[1]]),ob=v.aU([],Qa[Za[2]],Qa[Za[1]]),eb=[0,0,0,0];return v.aV(eb,v.aW([],sb,ob)),eb[3]=-v.aX(eb,Qa[Za[0]]),
eb}(R,X);ca=function(Qa,Za){var sb=v.a$(Qa),ob=v.b0([],Qa,1/sb);Qa=v.aU([],Za,v.aR([],ob,v.aX(Za,ob)));sb=v.a$(Qa);if(0<sb){const eb=Math.sqrt(1-ob[3]*ob[3]);ob=v.aR([],ob,-ob[3]);Qa=v.aS([],ob,v.aR([],Qa,eb/sb));return v.b1(Za,Qa)}return null}(ca,X);null!==ca&&(ca/=v.aX(Ba[0],X),pa=Math.min(pa,ca));for(ca=0;4>ca;ca++)X=Math.min(pa,ya[ca]),R[ca+ja]=[R[ca+la][0]+Ba[ca][0]*X,R[ca+la][1]+Ba[ca][1]*X,R[ca+la][2]+Ba[ca][2]*X,1]}(K,C[0],u,z);m=C.map(R=>{var X=v.aU([],K[R[0]],K[R[1]]);const ca=v.aU([],K[R[2]],
K[R[1]]);X=v.aV([],v.aW([],X,ca));R=-v.aX(X,K[R[1]]);return X.concat(R)});u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY];z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const R of K)for(C=0;3>C;C++)u[C]=Math.min(u[C],R[C]),z[C]=Math.max(z[C],R[C]);return new ld(K,m,new $f(u,z))}}class Ld{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,
g,m){return this._helper.interpolatePadding(b,g,m)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,g,m=!0){this._helper.resize(b,g,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}overrideNearFarZ(b,g){this._helper.overrideNearFarZ(b,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(b,
g){}constructor(b,g,m,u,z){this._posMatrixCache=new Map;this._alignedPosMatrixCache=new Map;this._fogMatrixCacheF32=new Map;this._helper=new kd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(C,G)=>this.getConstrained(C,G)},b,g,m,u,z);this._coveringTilesDetailsProvider=new sf}clone(){const b=new Ld;return b.apply(this),b}apply(b,g,m){this._helper.apply(b,g,m)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(b){const g=
[new v.b2(0,b)];if(this._helper._renderWorldCopies){var m=this.screenPointToMercatorCoordinate(new v.P(0,0));const z=this.screenPointToMercatorCoordinate(new v.P(this._helper._width,0)),C=this.screenPointToMercatorCoordinate(new v.P(this._helper._width,this._helper._height)),G=this.screenPointToMercatorCoordinate(new v.P(0,this._helper._height));var u=Math.floor(Math.min(m.x,z.x,C.x,G.x));m=Math.floor(Math.max(m.x,z.x,C.x,G.x));for(--u;u<=m+1;u++)0!==u&&g.push(new v.b2(u,b))}return g}getCameraFrustum(){return ld.fromInvProjectionMatrix(this._invViewProjMatrix,
this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(b){const g=this.screenPointToLocation(this.centerPoint,b);b=b?b.getElevationForLngLatZoom(g,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(b)}setLocationAtPoint(b,g){var m=v.aj(this.elevation,this.center.lat);g=this.screenPointToMercatorCoordinateAtZ(g,m);m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,m);b=v.a1.fromLngLat(b);
b=new v.a1(b.x-(g.x-m.x),b.y-(g.y-m.y));this.setCenter(null==b?void 0:b.toLngLat());this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(b,g){return g?this.coordinatePoint(v.a1.fromLngLat(b),g.getElevationForLngLatZoom(b,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(v.a1.fromLngLat(b))}screenPointToLocation(b,g){var m;return null===(m=this.screenPointToMercatorCoordinate(b,g))||void 0===m?void 0:m.toLngLat()}screenPointToMercatorCoordinate(b,
g){return g&&(g=g.pointCoordinate(b),null!=g)?g:this.screenPointToMercatorCoordinateAtZ(b)}screenPointToMercatorCoordinateAtZ(b,g){g=g||0;const m=[b.x,b.y,0,1];b=[b.x,b.y,1,1];v.aw(m,m,this._pixelMatrixInverse);v.aw(b,b,this._pixelMatrixInverse);const u=m[3],z=b[3],C=m[1]/u,G=b[1]/z;var K=m[2]/u;const R=b[2]/z;K=K===R?0:(g-K)/(R-K);return new v.a1(v.C.number(m[0]/u,b[0]/z,K)/this.worldSize,v.C.number(C,G,K)/this.worldSize,g)}coordinatePoint(b,g=0,m=this._pixelMatrix){b=[b.x*this.worldSize,b.y*this.worldSize,
g,1];return v.aw(b,b,m),new v.P(b[0]/b[3],b[1]/b[3])}getBounds(){const b=Math.max(0,this._helper._height/2-Hc(this));return(new qf).extend(this.screenPointToLocation(new v.P(0,b))).extend(this.screenPointToLocation(new v.P(this._helper._width,b))).extend(this.screenPointToLocation(new v.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new v.P(0,this._helper._height)))}isPointOnMapSurface(b,g){return g?null!=g.pointCoordinate(b):b.y>this.height/2-Hc(this)}calculatePosMatrix(b,
g=!1,m){var u,z=null!==(u=b.key)&&void 0!==u?u:v.b3(b.wrap,b.canonical.z,b.canonical.z,b.canonical.x,b.canonical.y);u=g?this._alignedPosMatrixCache:this._posMatrixCache;if(u.has(z))return z=u.get(z),m?z.f32:z.f64;b=Jc(b,this.worldSize);v.O(b,g?this._alignedProjMatrix:this._viewProjMatrix,b);g={f64:b,f32:new Float32Array(b)};return u.set(z,g),m?g.f32:g.f64}calculateFogMatrix(b){const g=b.key,m=this._fogMatrixCacheF32;if(m.has(g))return m.get(g);b=Jc(b,this.worldSize);return v.O(b,this._fogMatrix,b),
m.set(g,new Float32Array(b)),m.get(g)}getConstrained(b,g){g=v.ah(+g,this.minZoom,this.maxZoom);g={center:new v.S(b.lng,b.lat),zoom:g};var m=this._helper._lngRange;if(!this._helper._renderWorldCopies&&null===m){var u=180-1E-10;m=[-u,u]}u=this.tileSize*v.af(g.zoom);let z=0;var C=u;let G=0,K=u,R=0,X=0;const {x:ca,y:ja}=this.size;this._helper._latRange&&(C=this._helper._latRange,z=v.U(C[1])*u,C=v.U(C[0])*u,C-z<ja&&(R=ja/(C-z)));m&&(G=v.aO(v.V(m[0])*u,0,u),K=v.aO(v.V(m[1])*u,0,u),K<G&&(K+=u),K-G<ca&&(X=
ca/(K-G)));const {x:la,y:pa}=lc(u,b);let ya;if(b=Math.max(X||0,R||0)){var Ba=new v.P(X?(K+G)/2:la,R?(C+z)/2:pa);return g.center=bc(u,Ba).wrap(),g.zoom+=v.ak(b),g}this._helper._latRange&&(b=ja/2,pa-b<z&&(ya=z+b),pa+b>C&&(ya=C-b));m&&(m=(G+K)/2,b=la,this._helper._renderWorldCopies&&(b=v.aO(la,m-u/2,m+u/2)),m=ca/2,b-m<G&&(Ba=G+m),b+m>K&&(Ba=K-m));if(void 0!==Ba||void 0!==ya)Ba=new v.P(null!=Ba?Ba:la,null!=ya?ya:pa),g.center=bc(u,Ba).wrap();return g}calculateCenterFromCameraLngLatAlt(b,g,m,u){return this._helper.calculateCenterFromCameraLngLatAlt(b,
g,m,u)}_calculateNearFarZIfNeeded(b,g,m){if(this._helper.autoCalculateNearFarZ){var u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),z=b-u*this._helper._pixelPerMeter/Math.cos(g);b=0>u?z:b;u=Math.PI/2+this.pitchInRadians;z=v.ae(this.fov)*(Math.abs(Math.cos(v.ae(this.roll)))*this.height+Math.abs(Math.sin(v.ae(this.roll)))*this.width)/this.height*(.5+m.y/this.height);z=Math.sin(z)*b/Math.sin(v.ah(Math.PI-u-z,.01,Math.PI-.01));var C=Hc(this),G=Math.atan(C/this._helper.cameraToCenterDistance),
K=v.ae(.75);m=G>K?2*G*(.5+m.y/(2*C)):K;m=Math.sin(m)*b/Math.sin(v.ah(Math.PI-u-m,.01,Math.PI-.01));this._helper._farZ=1.01*(Math.cos(Math.PI/2-g)*Math.min(z,m)+b);this._helper._nearZ=this._helper._height/50}}_calcMatrices(){if(this._helper._height){var b=this.centerOffset,g=lc(this.worldSize,this.center),m=g.x,u=g.y;this._helper._pixelPerMeter=v.aj(1,this.center.lat)*this.worldSize;g=v.ae(Math.min(this.pitch,89.25));var z=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+
this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g));this._calculateNearFarZIfNeeded(z,g,b);g=new Float64Array(16);v.b4(g,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ);this._invProjMatrix=new Float64Array(16);v.aq(this._invProjMatrix,g);g[8]=2*-b.x/this._helper._width;g[9]=2*b.y/this._helper._height;this._projectionMatrix=v.b5(g);v.N(g,g,[1,-1,1]);v.M(g,g,[0,0,-this._helper.cameraToCenterDistance]);v.b6(g,g,-this.rollInRadians);v.b7(g,
g,this.pitchInRadians);v.b6(g,g,-this.bearingInRadians);v.M(g,g,[-m,-u,0]);this._mercatorMatrix=v.N([],g,[this.worldSize,this.worldSize,this.worldSize]);v.N(g,g,[1,1,this._helper._pixelPerMeter]);this._pixelMatrix=v.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,g);v.M(g,g,[0,0,-this.elevation]);this._viewProjMatrix=g;this._invViewProjMatrix=v.aq([],g);var C=[0,0,-1,1];v.aw(C,C,this._invViewProjMatrix);this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]];this._fogMatrix=new Float64Array(16);
v.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,z,this._helper._farZ);this._fogMatrix[8]=2*-b.x/this.width;this._fogMatrix[9]=2*b.y/this.height;v.N(this._fogMatrix,this._fogMatrix,[1,-1,1]);v.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]);v.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians);v.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians);v.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians);v.M(this._fogMatrix,this._fogMatrix,[-m,-u,0]);v.N(this._fogMatrix,
this._fogMatrix,[1,1,this._helper._pixelPerMeter]);v.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]);this._pixelMatrix3D=v.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,g);b=this._helper._width%2/2;z=this._helper._height%2/2;C=Math.cos(this.bearingInRadians);var G=Math.sin(-this.bearingInRadians);m=m-Math.round(m)+C*b+G*z;u=u-Math.round(u)+C*z+G*b;b=new Float64Array(g);if(v.M(b,b,[.5<m?m-1:m,.5<u?u-1:u,0]),this._alignedProjMatrix=b,g=v.aq(new Float64Array(16),this._pixelMatrix),!g)throw Error("failed to invert matrix");
this._pixelMatrixInverse=g;this._clearMatrixCaches()}}_clearMatrixCaches(){this._posMatrixCache.clear();this._alignedPosMatrixCache.clear();this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;var b=this.screenPointToMercatorCoordinate(new v.P(0,0));b=[b.x*this.worldSize,b.y*this.worldSize,0,1];return v.aw(b,b,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const b=
v.aj(1,this.center.lat)*this.worldSize;return id(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/b).toLngLat()}lngLatToCameraDepth(b,g){b=v.a1.fromLngLat(b);g=[b.x*this.worldSize,b.y*this.worldSize,g,1];return v.aw(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(b){const {overscaledTileID:g,aligned:m,applyTerrainMatrix:u}=b;b=this._helper.getMercatorTileCoordinates(g);const z=g?this.calculatePosMatrix(g,m,!0):null;let C;return C=g&&g.terrainRttPosMatrix32f&&
u?g.terrainRttPosMatrix32f:z||v.b8(),{mainMatrix:C,tileMercatorCoords:b,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(b){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(b,g,m){return 1}transformLightDirection(b){return v.aT(b)}getRayDirectionFromPixel(b){throw Error("Not implemented.");}projectTileCoordinates(b,g,m,u){m=this.calculatePosMatrix(m);let z;u?(z=[b,g,u(b,g),1],v.aw(z,z,m)):(z=[b,g,0,1],gf(z,z,m));b=z[3];
return{point:new v.P(z[0]/b,z[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}populateCache(b){for(const g of b)this.calculatePosMatrix(g)}getMatrixForModel(b,g){b=v.a1.fromLngLat(b,g);g=b.meterInMercatorCoordinateUnits();const m=v.b9();return v.M(m,m,[b.x,b.y,b.z]),v.b6(m,m,Math.PI),v.b7(m,m,Math.PI/2),v.N(m,m,[-g,g,g]),m}getProjectionDataForCustomLayer(b=!0){var g=new v.Z(0,0,0,0,0);b=this.getProjectionData({overscaledTileID:g,applyGlobeMatrix:b});g=Jc(g,this.worldSize);v.O(g,this._viewProjMatrix,
g);b.tileMercatorCoords=[0,0,1,1];const m=[v.$,v.$,this.worldSize/this._helper.pixelsPerMeter],u=v.ba();return v.N(u,g,m),b.fallbackMatrix=u,b.mainMatrix=u,b}getFastPathSimpleProjectionMatrix(b){return this.calculatePosMatrix(b)}}class yd{get useGlobeControls(){return!1}handlePanInertia(b,g){const m=b.mag(),u=Math.abs(Hc(g));return{easingOffset:b.mult(Math.min(.75*u/m,1)),easingCenter:g.center}}handleMapControlsRollPitchBearingZoom(b,g){b.bearingDelta&&g.setBearing(g.bearing+b.bearingDelta);b.pitchDelta&&
g.setPitch(g.pitch+b.pitchDelta);b.rollDelta&&g.setRoll(g.roll+b.rollDelta);b.zoomDelta&&g.setZoom(g.zoom+b.zoomDelta)}handleMapControlsPan(b,g,m){.01>b.around.distSqr(g.centerPoint)||g.setLocationAtPoint(m,b.around)}cameraForBoxAndBearing(b,g,m,u,z){return ma(b,g,m,u,z)}handleJumpToCenterZoom(b,g){b.zoom!==(void 0!==g.zoom?+g.zoom:b.zoom)&&b.setZoom(+g.zoom);void 0!==g.center&&b.setCenter(v.S.convert(g.center))}handleEaseTo(b,g){const m=b.zoom,u=b.padding,z={roll:b.roll,pitch:b.pitch,bearing:b.bearing},
C={roll:void 0===g.roll?b.roll:g.roll,pitch:void 0===g.pitch?b.pitch:g.pitch,bearing:void 0===g.bearing?b.bearing:g.bearing};var G=void 0!==g.zoom;const K=!b.isPaddingEqual(g.padding);let R=!1;G=G?+g.zoom:b.zoom;let X=b.centerPoint.add(g.offsetAsPoint);const ca=b.screenPointToLocation(X),{center:ja,zoom:la}=b.getConstrained(v.S.convert(g.center||ca),null!=G?G:m);S(b,ja);const pa=lc(b.worldSize,ca),ya=lc(b.worldSize,ja).sub(pa),Ba=v.af(la-m);return R=la!==m,{easeFunc:za=>{if(R&&b.setZoom(v.C.number(m,
la,za)),v.be(z,C)||ra({startEulerAngles:z,endEulerAngles:C,tr:b,k:za,useSlerp:z.roll!=C.roll}),K&&(b.interpolatePadding(u,g.padding,za),X=b.centerPoint.add(g.offsetAsPoint)),g.around)b.setLocationAtPoint(g.around,g.aroundPoint);else{const Ea=v.af(b.zoom-m);za=bc(b.worldSize,pa.add(ya.mult(za*Math.pow(la>m?Math.min(2,Ba):Math.max(.5,Ba),1-za))).mult(Ea));b.setLocationAtPoint(b.renderWorldCopies?za.wrap():za,X)}},isZooming:R,elevationCenter:ja}}handleFlyTo(b,g){var m=void 0!==g.zoom;const u=b.zoom;
m=b.getConstrained(v.S.convert(g.center||g.locationAtOffset),m?+g.zoom:u);const z=m.center,C=m.zoom;S(b,z);const G=lc(b.worldSize,g.locationAtOffset),K=lc(b.worldSize,z).sub(G);m=K.mag();const R=v.af(C-u);let X;void 0!==g.minZoom&&(g=b.getConstrained(z,Math.min(+g.minZoom,u,C)).zoom,X=v.af(g-u));return{easeFunc:(ca,ja,la,pa)=>{b.setZoom(1===ca?C:u+v.ak(ja));ca=1===ca?z:bc(b.worldSize,G.add(K.mult(la)).mult(ja));b.setLocationAtPoint(b.renderWorldCopies?ca.wrap():ca,pa)},scaleOfZoom:R,targetCenter:z,
scaleOfMinZoom:X,pixelPathLength:m}}}class Md{constructor(b,g,m){this.blendFunction=b;this.blendColor=g;this.mask=m}}Md.Replace=[1,0];Md.disabled=new Md(Md.Replace,v.bf.transparent,[!1,!1,!1,!1]);Md.unblended=new Md(Md.Replace,v.bf.transparent,[!0,!0,!0,!0]);Md.alphaBlended=new Md([1,771],v.bf.transparent,[!0,!0,!0,!0]);class dd{constructor(b,g,m){this.enable=b;this.mode=g;this.frontFace=m}}dd.disabled=new dd(!1,1029,2305);dd.backCCW=new dd(!0,1029,2305);dd.frontCCW=new dd(!0,1028,2305);class ed{constructor(b,
g,m){this.func=b;this.mask=g;this.range=m}}ed.ReadOnly=!1;ed.ReadWrite=!0;ed.disabled=new ed(519,ed.ReadOnly,[0,1]);class Jd{constructor(b,g,m,u,z,C){this.test=b;this.ref=g;this.mask=m;this.fail=u;this.depthFail=z;this.pass=C}}Jd.disabled=new Jd({func:519,mask:0},0,0,7680,7680,7680);const ee=new WeakMap;class Ie{get awaitingQuery(){return!!this._readbackQueue}constructor(b){this._readbackWaitFrames=4;this._measureWaitFrames=6;this._texHeight=this._texWidth=1;this._updateCount=this._measuredError=
0;this._lastReadbackFrame=-1E3;this._readbackQueue=null;this._cachedRenderContext=b;b=b.context;const g=b.gl;this._texFormat=g.RGBA;this._texType=g.UNSIGNED_BYTE;var m=new v.aL;m.emplaceBack(-1,-1);m.emplaceBack(2,-1);m.emplaceBack(-1,2);const u=new v.aN;u.emplaceBack(0,1,2);this._fullscreenTriangle=new sg(b.createVertexBuffer(m,He.members),b.createIndexBuffer(u),v.aM.simpleSegment(0,0,m.length,u.length));this._resultBuffer=new Uint8Array(4);b.activeTexture.set(g.TEXTURE1);m=g.createTexture();g.bindTexture(g.TEXTURE_2D,
m);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null);this._fbo=b.createFramebuffer(this._texWidth,this._texHeight,!1,!1);this._fbo.colorAttachment.set(m);ua(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,
this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const b=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy();this._fbo.destroy();b.deleteBuffer(this._pbo);this._resultBuffer=this._pbo=this._fbo=this._fullscreenTriangle=null}updateErrorLoop(b,g){const m=this._updateCount;return this._readbackQueue?m>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():m>=this._lastReadbackFrame+this._measureWaitFrames&&
this._renderErrorTexture(b,g),this._updateCount++,this._measuredError}_bindFramebuffer(){const b=this._cachedRenderContext.context,g=b.gl;b.activeTexture.set(g.TEXTURE1);g.bindTexture(g.TEXTURE_2D,this._fbo.colorAttachment.get());b.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(b,g){const m=this._cachedRenderContext.context,u=m.gl;(this._bindFramebuffer(),m.viewport.set([0,0,this._texWidth,this._texHeight]),m.clear({color:v.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(m,
u.TRIANGLES,ed.disabled,Jd.disabled,Md.unblended,dd.disabled,{u_input:b,u_output_expected:g},null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ua(u))?(u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),b=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0),u.flush(),this._readbackQueue=
{frameNumberIssued:this._updateCount,sync:b}):this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const b=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ua(b)){const g=b.clientWaitSync(this._readbackQueue.sync,0,0);if(g===b.WAIT_FAILED)return v.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(g===b.TIMEOUT_EXPIRED)return;b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo);b.getBufferSubData(b.PIXEL_PACK_BUFFER,
0,this._resultBuffer,0,4);b.bindBuffer(b.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),b.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null;this._measuredError=Ie._parseRGBA8float(this._resultBuffer);this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(b){let g=0;return g+=b[0]/256,g+=b[1]/65536,g+=b[2]/16777216,127>b[3]&&(g=-g),g/128}}const Ze=v.$/128,Da=new v.aK({fill:new v.bj(128,2),line:new v.bj(512,0),tile:new v.bj(128,
32),stencil:new v.bj(128,1),circle:3});class Fi{constructor(){this._tileMeshCache={};this._errorCorrectionPreviousValue=this._errorMeasurementLastValue=this._errorCorrectionUsable=0;this._errorMeasurementLastChangeTime=-1E3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ed.projectionGlobe}get vertexShaderPreludeCode(){return Ed.projectionMercator.vertexSource}get subdivisionGranularity(){return Da}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&
this._errorMeasurement.destroy()}updateGPUdependent(b){this._errorMeasurement||(this._errorMeasurement=new Ie(b));b=v.U(this._errorQueryLatitudeDegrees);b=this._errorMeasurement.updateErrorLoop(b,2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI);const g=qd.now();b!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=b,this._errorMeasurementLastChangeTime=g);this._errorCorrectionUsable=v.bk(this._errorCorrectionPreviousValue,
-this._errorMeasurementLastValue,v.bl(Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1E3/.5,0),1)))}_getMeshKey(b){return`${b.granularity.toString(36)}_${b.generateBorders?"b":""}${b.extendToNorthPole?"n":""}${b.extendToSouthPole?"s":""}`}getMeshFromTileID(b,g,m,u,z){z=("stencil"===z?Da.stencil:Da.tile).getGranularityForZoomLevel(g.z);return this._getMesh(b,{granularity:z,generateBorders:m,extendToNorthPole:0===g.y&&u,extendToSouthPole:g.y===(1<<g.z)-1&&u})}_getMesh(b,g){const m=this._getMeshKey(g);
if(m in this._tileMeshCache)return this._tileMeshCache[m];var u=Aa(g,"16bit");g=v.aL.deserialize({arrayBuffer:u.vertices,length:u.vertices.byteLength/2/2});u=v.aN.deserialize({arrayBuffer:u.indices,length:u.indices.byteLength/2/3});b=new sg(b.createVertexBuffer(g,He.members),b.createIndexBuffer(u),v.aM.simpleSegment(0,0,g.length,u.length));return this._tileMeshCache[m]=b,b}recalculate(b){}hasTransition(){const b=qd.now();let g=!1;return g=g||.7>(b-this._errorMeasurementLastChangeTime)/1E3,g=g||this._errorMeasurement&&
this._errorMeasurement.awaitingQuery,g}setErrorQueryLatitudeDegrees(b){this._errorQueryLatitudeDegrees=b}}const tg=new v.r({type:new v.D(v.v.projection.type)});class fe extends v.E{constructor(b){super();this._transitionable=new v.t(tg,void 0);this.setProjection(b);this._transitioning=this._transitionable.untransitioned();this.recalculate(new v.F(0));this._mercatorProjection=new Eb;this._verticalPerspectiveProjection=new Fi}get transitionState(){const b=this.properties.get("type");if("string"==typeof b&&
"mercator"===b)return 0;if("string"==typeof b&&"vertical-perspective"===b)return 1;if(b instanceof v.bm){if("vertical-perspective"===b.from&&"mercator"===b.to)return 1-b.transition;if("mercator"===b.from&&"vertical-perspective"===b.to)return b.transition}return 1}get useGlobeRendering(){return 0<this.transitionState}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:
this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return 0<
this.transitionState}destroy(){this._mercatorProjection.destroy();this._verticalPerspectiveProjection.destroy()}updateGPUdependent(b){this._mercatorProjection.updateGPUdependent(b);this._verticalPerspectiveProjection.updateGPUdependent(b)}getMeshFromTileID(b,g,m,u,z){return this.currentProjection.getMeshFromTileID(b,g,m,u,z)}setProjection(b){this._transitionable.setValue("type",(null==b?void 0:b.type)||"mercator")}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||
this.currentProjection.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}setErrorQueryLatitudeDegrees(b){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(b);this._mercatorProjection.setErrorQueryLatitudeDegrees(b)}}class Ad{constructor(b){this._cachePrevious=new Map;this._cache=new Map;this._hadAnyChanges=!1;this._boundingVolumeFactory=b}swapBuffers(){if(this._hadAnyChanges){var b=this._cachePrevious;this._cachePrevious=this._cache;this._cache=
b;this._cache.clear();this._hadAnyChanges=!1}}getTileBoundingVolume(b,g,m,u){const z=`${b.z}_${b.x}_${b.y}_${(null==u?0:u.terrain)?"t":""}`;var C=this._cache.get(z);if(C)return C;if(C=this._cachePrevious.get(z))return this._cache.set(z,C),C;b=this._boundingVolumeFactory(b,g,m,u);return this._cache.set(z,b),this._hadAnyChanges=!0,b}}class ye{constructor(b,g,m,u){this.min=m;this.max=u;this.points=b;this.planes=g}static fromAabb(b,g){const m=[];for(let u=0;8>u;u++)m.push([1&~u?b[0]:g[0],1==(u>>1&1)?
g[1]:b[1],1==(u>>2&1)?g[2]:b[2]]);return new ye(m,[[-1,0,0,g[0]],[1,0,0,-b[0]],[0,-1,0,g[1]],[0,1,0,-b[1]],[0,0,-1,g[2]],[0,0,1,-b[2]]],b,g)}static fromCenterSizeAngles(b,g,m){var u=v.br([],m[0],m[1],m[2]);m=v.bs([],[g[0],0,0],u);const z=v.bs([],[0,g[1],0],u);g=v.bs([],[0,0,g[2]],u);u=[...b];const C=[...b];for(var G=0;8>G;G++)for(var K=0;3>K;K++){var R=b[K]+m[K]*(1&~G?-1:1)+z[K]*(1==(G>>1&1)?1:-1)+g[K]*(1==(G>>2&1)?1:-1);u[K]=Math.min(u[K],R);C[K]=Math.max(C[K],R)}G=[];for(K=0;8>K;K++)R=[...b],v.aS(R,
R,v.aR([],m,1&~K?-1:1)),v.aS(R,R,v.aR([],z,1==(K>>1&1)?1:-1)),v.aS(R,R,v.aR([],g,1==(K>>2&1)?1:-1)),G.push(R);return new ye(G,[[...m,-v.aX(m,G[0])],[...z,-v.aX(z,G[0])],[...g,-v.aX(g,G[0])],[-m[0],-m[1],-m[2],-v.aX(m,G[7])],[-z[0],-z[1],-z[2],-v.aX(z,G[7])],[-g[0],-g[1],-g[2],-v.aX(g,G[7])]],u,C)}intersectsFrustum(b){var g=!0,m=this.points.length;const u=this.planes.length;var z=b.planes.length;const C=b.points.length;for(var G=0;G<z;G++){var K=b.planes[G];let R=0;for(let X=0;X<m;X++){const ca=this.points[X];
0<=K[0]*ca[0]+K[1]*ca[1]+K[2]*ca[2]+K[3]&&R++}if(0===R)return 0;R<m&&(g=!1)}if(g)return 2;for(g=0;g<u;g++){m=this.planes[g];z=0;for(G=0;G<C;G++)K=b.points[G],0<=m[0]*K[0]+m[1]*K[1]+m[2]*K[2]+m[3]&&z++;if(0===z)return 0}return 1}intersectsPlane(b){const g=this.points.length;let m=0;for(let u=0;u<g;u++){const z=this.points[u];0<=b[0]*z[0]+b[1]*z[1]+b[2]*z[2]+b[3]&&m++}return m===g?2:0===m?0:1}}class dg{constructor(){this._boundingVolumeCache=new Ad(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(b,
g,m,u){var z=1<<m.z;u=1/z;const C=m.x/z;m=m.y/z;z=2;return z=Math.min(z,Me(b,g,C,m,u)),z=Math.min(z,Me(b,g,C+.5,-m-u,u)),z=Math.min(z,Me(b,g,C+.5,2-m-u,u)),z}getWrap(b,g,m){var u=1<<g.z;m=1/u;const z=g.x/u;u=de(b.x,z,m);g=de(b.x,z-1,m);b=de(b.x,z+1,m);m=Math.min(u,g,b);return m===b?1:m===g?-1:0}allowVariableZoom(b,g){return 4<xc(b,g)}allowWorldCopies(){return!1}getTileBoundingVolume(b,g,m,u){return this._boundingVolumeCache.getTileBoundingVolume(b,g,m,u)}_computeTileBoundingVolume(b,g,m,u){var z,
C,G=0,K=0;if(null==u?0:u.terrain)K=new v.Z(b.z,g,b.z,b.x,b.y),K=u.terrain.getMinMaxElevation(K),G=null!==(z=K.minElevation)&&void 0!==z?z:Math.min(0,m),K=null!==(C=K.maxElevation)&&void 0!==C?C:Math.max(0,m);if(G/=v.bu,K/=v.bu,G+=1,K+=1,0>=b.z)return ye.fromAabb([-K,-K,-K],[K,K,K]);if(1===b.z)return ye.fromAabb([0===b.x?-K:0,0===b.y?0:-K,-K],[0===b.x?0:K,0===b.y?K:0,K]);z=[fb(0,0,b.x,b.y,b.z),fb(v.$,0,b.x,b.y,b.z),fb(v.$,v.$,b.x,b.y,b.z),fb(0,v.$,b.x,b.y,b.z)];m=[];for(var R of z)m.push(v.aR([],R,
K));if(K!==G)for(var X of z)m.push(v.aR([],X,G));0===b.y&&m.push([0,1,0]);b.y===(1<<b.z)-1&&m.push([0,-1,0]);R=[1,1,1];X=[-1,-1,-1];for(var ca of m)for(G=0;3>G;G++)R[G]=Math.min(R[G],ca[G]),X[G]=Math.max(X[G],ca[G]);C=fb(v.$/2,v.$/2,b.x,b.y,b.z);ca=v.aW([],[0,1,0],C);v.aV(ca,ca);G=v.aW([],C,ca);v.aV(G,G);ca=v.aW([],z[2],z[1]);v.aV(ca,ca);z=v.aW([],z[0],z[3]);v.aV(z,z);m.push(v.aR([],C,K));b.y>=(1<<b.z)/2&&m.push(v.aR([],fb(v.$/2,0,b.x,b.y,b.z),K));b.y<(1<<b.z)/2&&m.push(v.aR([],fb(v.$/2,v.$,b.x,b.y,
b.z),K));g=zg(C,m);u=zg(G,m);K=[-C[0],-C[1],-C[2],g.max];m=[C[0],C[1],C[2],-g.min];C=[-G[0],-G[1],-G[2],u.max];G=[G[0],G[1],G[2],-u.min];ca=[...ca,0];z=[...z,0];u=[];return 0===b.y?u.push(v.bt(z,ca,K),v.bt(z,ca,m)):u.push(v.bt(C,ca,K),v.bt(C,ca,m),v.bt(C,z,K),v.bt(C,z,m)),b.y===(1<<b.z)-1?u.push(v.bt(z,ca,K),v.bt(z,ca,m)):u.push(v.bt(G,ca,K),v.bt(G,ca,m),v.bt(G,z,K),v.bt(G,z,m)),new ye(u,[K,m,C,G,ca,z],R,X)}}class tf{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,
g,m){return this._helper.interpolatePadding(b,g,m)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,g){this._helper.resize(b,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}overrideNearFarZ(b,g){this._helper.overrideNearFarZ(b,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(b){}constructor(){this._cachedClippingPlane=
v.bv();this._projectionMatrix=v.b9();this._globeViewProjMatrix32f=v.b8();this._globeViewProjMatrixNoCorrection=v.b9();this._globeViewProjMatrixNoCorrectionInverted=v.b9();this._globeProjMatrixInverted=v.b9();this._cameraPosition=v.bp();this._globeLatitudeErrorCorrectionRadians=0;this._helper=new kd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(b,g)=>this.getConstrained(b,g)});this._coveringTilesDetailsProvider=new dg}clone(){const b=new tf;return b.apply(this),b}apply(b,g){this._globeLatitudeErrorCorrectionRadians=
g||0;this._helper.apply(b)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const b=v.bp();return b[0]=this._cameraPosition[0],b[1]=this._cameraPosition[1],b[2]=this._cameraPosition[2],b}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(b){const {overscaledTileID:g,applyGlobeMatrix:m}=b;b=this._helper.getMercatorTileCoordinates(g);
return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:b,clippingPlane:this._cachedClippingPlane,projectionTransition:m?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(b){var g=this.pitchInRadians,m=this.cameraToCenterDistance/b;b=Math.sin(g)*m;m=Math.cos(g)*m+1;g=1/Math.sqrt(b*b+m*m);b=-b;const u=Math.sqrt(b*b+m*m);b=[0,b/u,m/u];v.bw(b,b,[0,0,0],-this.bearingInRadians);v.bx(b,b,[0,0,0],-1*this.center.lat*Math.PI/180);v.by(b,b,[0,0,0],this.center.lng*Math.PI/180);
m=1/v.aZ(b);return v.aR(b,b,m),[...b,-g*m]}isLocationOccluded(b){return!this.isSurfacePointVisible(pb(b))}transformLightDirection(b){var g=this._helper._center.lng*Math.PI/180,m=this._helper._center.lat*Math.PI/180,u=Math.cos(m);g=[Math.sin(g)*u,Math.sin(m),Math.cos(g)*u];m=[g[2],0,-g[0]];u=[0,0,0];v.aW(u,m,g);v.aV(m,m);v.aV(u,u);const z=[0,0,0];return v.aV(z,[m[0]*b[0]+u[0]*b[1]+g[0]*b[2],m[1]*b[0]+u[1]*b[1]+g[1]*b[2],m[2]*b[0]+u[2]*b[1]+g[2]*b[2]]),z}getPixelScale(){return 1/Math.cos(this._helper._center.lat*
Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(b,g,m){m=m.canonical;const u=1/(1<<m.z);b=new v.a1(b/v.$*u+m.x*u,g/v.$*u+m.y*u);g=(z=b.y,[v.bo(b.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI]);var z;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(b,g,m,u){m=m.canonical;m=fb(b,g,m.x,m.y,m.z);b=1+(u?u(b,g):0)/v.bu;b=[m[0]*b,m[1]*b,m[2]*b,1];v.aw(b,b,this._globeViewProjMatrixNoCorrection);
g=this._cachedClippingPlane;m=0>g[0]*m[0]+g[1]*m[1]+g[2]*m[2]+g[3];return{point:new v.P(b[0]/b[3],b[1]/b[3]),signedDistanceFromCamera:b[3],isOccluded:m}}_calcMatrices(){if(this._helper._width&&this._helper._height){var b=Rb(this.worldSize,this.center.lat),g=v.ba(),m=v.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*b);v.b4(g,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);var u=this.centerOffset;g[8]=
2*-u.x/this._helper._width;g[9]=2*u.y/this._helper._height;this._projectionMatrix=v.b5(g);this._globeProjMatrixInverted=v.ba();v.aq(this._globeProjMatrixInverted,g);v.M(g,g,[0,0,-this.cameraToCenterDistance]);v.b6(g,g,this.rollInRadians);v.b7(g,g,-this.pitchInRadians);v.b6(g,g,this.bearingInRadians);v.M(g,g,[0,0,-b]);u=v.bp();u[0]=b;u[1]=b;u[2]=b;v.b7(m,g,this.center.lat*Math.PI/180);v.bz(m,m,-this.center.lng*Math.PI/180);v.N(m,m,u);this._globeViewProjMatrixNoCorrection=m;v.b7(g,g,this.center.lat*
Math.PI/180-this._globeLatitudeErrorCorrectionRadians);v.bz(g,g,-this.center.lng*Math.PI/180);v.N(g,g,u);this._globeViewProjMatrix32f=new Float32Array(g);this._globeViewProjMatrixNoCorrectionInverted=v.ba();v.aq(this._globeViewProjMatrixNoCorrectionInverted,m);g=v.bp();this._cameraPosition=v.bp();this._cameraPosition[2]=this.cameraToCenterDistance/b;v.bw(this._cameraPosition,this._cameraPosition,g,-this.rollInRadians);v.bx(this._cameraPosition,this._cameraPosition,g,this.pitchInRadians);v.bw(this._cameraPosition,
this._cameraPosition,g,-this.bearingInRadians);v.aS(this._cameraPosition,this._cameraPosition,[0,0,1]);v.bx(this._cameraPosition,this._cameraPosition,g,-this.center.lat*Math.PI/180);v.by(this._cameraPosition,this._cameraPosition,g,this.center.lng*Math.PI/180);this._cachedClippingPlane=this._computeClippingPlane(b);b=v.b5(this._globeViewProjMatrixNoCorrectionInverted);v.N(b,b,[1,1,-1]);this._cachedFrustum=ld.fromInvProjectionMatrix(b,1,0,this._cachedClippingPlane,!0)}}calculateFogMatrix(b){v.w("calculateFogMatrix is not supported on globe projection.");
b=v.ba();return v.ag(b),b}getVisibleUnwrappedCoordinates(b){return[new v.b2(0,b)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(b){b&&v.w("terrain is not fully supported on vertical perspective projection.");this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(b,
g){if(!this._globeViewProjMatrixNoCorrection)return 1;b=pb(b);v.aR(b,b,1+g/v.bu);g=v.bv();return v.aw(g,[b[0],b[1],b[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(b){}getBounds(){var b=.5*this.width,g=.5*this.height;g=[new v.P(0,0),new v.P(b,0),new v.P(this.width,0),new v.P(this.width,g),new v.P(this.width,this.height),new v.P(b,this.height),new v.P(0,this.height),new v.P(0,g)];b=[];for(var m of g)b.push(this.unprojectScreenPoint(m));let u=g=m=0,z=0;const C=this.center;for(var G of b){b=
v.bA(C.lng,G.lng);const K=v.bA(C.lat,G.lat);b<g&&(g=b);b>m&&(m=b);K<z&&(z=K);K>u&&(u=K)}G=[C.lng+g,C.lat+z,C.lng+m,C.lat+u];return this.isSurfacePointOnScreen([0,1,0])&&(G[3]=90,G[0]=-180,G[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(G[1]=-90,G[0]=-180,G[2]=180),new qf(G)}getConstrained(b,g){const m=v.ah(b.lat,-v.ai,v.ai);g=v.ah(+g,this.minZoom+fc(0,m),this.maxZoom);return{center:new v.S(b.lng,m),zoom:g}}calculateCenterFromCameraLngLatAlt(b,g,m,u){return this._helper.calculateCenterFromCameraLngLatAlt(b,
g,m,u)}setLocationAtPoint(b,g){g=pb(this.unprojectScreenPoint(g));var m=pb(b),u=v.bp();v.bB(u);var z=v.bp();v.by(z,g,u,-this.center.lng*Math.PI/180);v.bx(z,z,u,this.center.lat*Math.PI/180);g=m[0]*m[0]+m[2]*m[2];b=z[0]*z[0];if(!(g<b)){g=Math.sqrt(g-b);b=-g;g=v.bC(m[0],m[2],z[0],g);b=v.bC(m[0],m[2],z[0],b);var C=v.bp();v.by(C,m,u,-g);C=v.bC(C[1],C[2],z[1],z[2]);var G=v.bp();v.by(G,m,u,-b);m=v.bC(G[1],G[2],z[1],z[2]);z=.5*Math.PI;u=C>=-z&&C<=z;z=m>=-z&&m<=z;var K,R;if(u&&z)u=this.center.lng*Math.PI/
180,z=this.center.lat*Math.PI/180,v.bD(g,u)+v.bD(C,z)<v.bD(b,u)+v.bD(m,z)?(K=g,R=C):(K=b,R=m);else if(u)K=g,R=C;else{if(!z)return;K=b;R=m}g=this.center.lat;this.setCenter(new v.S(K/Math.PI*180,v.ah(R/Math.PI*180,-90,90)));this.setZoom(this.zoom+fc(g,this.center.lat))}}locationToScreenPoint(b,g){const m=pb(b);g&&(b=g.getElevationForLngLatZoom(b,this._helper._tileZoom),v.aR(m,m,1+b/v.bu));return this._projectSurfacePointToScreen(m)}_projectSurfacePointToScreen(b){const g=v.bv();return v.aw(g,[...b,
1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],new v.P((.5*g[0]+.5)*this.width,(.5*-g[1]+.5)*this.height)}screenPointToMercatorCoordinate(b,g){return g&&(g=g.pointCoordinate(b))?g:v.a1.fromLngLat(this.unprojectScreenPoint(b))}screenPointToLocation(b,g){var m;return null===(m=this.screenPointToMercatorCoordinate(b,g))||void 0===m?void 0:m.toLngLat()}isPointOnMapSurface(b,g){g=this._cameraPosition;b=this.getRayDirectionFromPixel(b);return!!this.rayPlanetIntersection(g,b)}getRayDirectionFromPixel(b){var g=
v.bv();g[0]=b.x/this.width*2-1;g[1]=-1*(b.y/this.height*2-1);g[2]=1;g[3]=1;v.aw(g,g,this._globeViewProjMatrixNoCorrectionInverted);g[0]/=g[3];g[1]/=g[3];g[2]/=g[3];b=v.bp();b[0]=g[0]-this._cameraPosition[0];b[1]=g[1]-this._cameraPosition[1];b[2]=g[2]-this._cameraPosition[2];g=v.bp();return v.aV(g,b),g}isSurfacePointVisible(b){const g=this._cachedClippingPlane;return 0<=g[0]*b[0]+g[1]*b[1]+g[2]*b[2]+g[3]}isSurfacePointOnScreen(b){if(!this.isSurfacePointVisible(b))return!1;const g=v.bv();return v.aw(g,
[...b,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3],-1<g[0]&&1>g[0]&&-1<g[1]&&1>g[1]&&-1<g[2]&&1>g[2]}rayPlanetIntersection(b,g){var m=v.aX(b,g);const u=v.bp(),z=v.bp();v.aR(z,g,m);v.aU(u,b,z);g=1-v.aX(u,u);if(0>g)return null;b=v.aX(b,b)-1;m=-m+(0>m?1:-1)*Math.sqrt(g);b/=m;return{tMin:Math.min(b,m),tMax:Math.max(b,m)}}unprojectScreenPoint(b){var g=this._cameraPosition;b=this.getRayDirectionFromPixel(b);var m=this.rayPlanetIntersection(g,b);if(m){var u=v.bp();v.aS(u,g,
[b[0]*m.tMin,b[1]*m.tMin,b[2]*m.tMin]);g=v.bp();return v.aV(g,u),ec(g)}u=this._cachedClippingPlane;m=u[0]*b[0]+u[1]*b[1]+u[2]*b[2];var z=-v.b1(u,g)/m;m=v.bp();0<z?v.aS(m,g,[b[0]*z,b[1]*z,b[2]*z]):(z=v.bp(),v.aS(z,g,[2*b[0],2*b[1],2*b[2]]),g=v.b1(this._cachedClippingPlane,z),v.aU(m,z,[this._cachedClippingPlane[0]*g,this._cachedClippingPlane[1]*g,this._cachedClippingPlane[2]*g]));g=function(C){const G=v.bp();return G[0]=C[0]*-C[3],G[1]=C[1]*-C[3],G[2]=C[2]*-C[3],{center:G,radius:Math.sqrt(1-C[3]*C[3])}}(u);
return ec(function(C,G,K){const R=v.bp();v.aU(R,K,C);K=v.bp();return v.bq(K,C,R,G/v.a$(R)),K}(g.center,g.radius,m))}getMatrixForModel(b,g){b=v.S.convert(b);const m=1/v.bu,u=v.b9();return v.bz(u,u,b.lng/180*Math.PI),v.b7(u,u,-b.lat/180*Math.PI),v.M(u,u,[0,0,1+g/v.bu]),v.b7(u,u,.5*Math.PI),v.N(u,u,[m,m,m]),u}getProjectionDataForCustomLayer(b=!0){b=this.getProjectionData({overscaledTileID:new v.Z(0,0,0,0,0),applyGlobeMatrix:b});return b.tileMercatorCoords=[0,0,1,1],b}getFastPathSimpleProjectionMatrix(b){}}
class Ce{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,
g,m){return this._helper.interpolatePadding(b,g,m)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,g,m=!0){this._helper.resize(b,g,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}overrideNearFarZ(b,g){this._helper.overrideNearFarZ(b,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return 0<
this._globeness}setTransitionState(b,g){this._globeness=b;this._globeLatitudeErrorCorrectionRadians=g;this._calcMatrices();this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame();this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0;this._globeness=1;this._helper=new kd({calcMatrices:()=>
{this._calcMatrices()},getConstrained:(b,g)=>this.getConstrained(b,g)});this._globeness=1;this._mercatorTransform=new Ld;this._verticalPerspectiveTransform=new tf}clone(){const b=new Ce;return b._globeness=this._globeness,b._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,b.apply(this),b}apply(b){this._helper.apply(b);this._mercatorTransform.apply(this);this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(b){const g=
this._mercatorTransform.getProjectionData(b),m=this._verticalPerspectiveTransform.getProjectionData(b);return{mainMatrix:this.isGlobeRendering?m.mainMatrix:g.mainMatrix,clippingPlane:m.clippingPlane,tileMercatorCoords:m.tileMercatorCoords,projectionTransition:b.applyGlobeMatrix?this._globeness:0,fallbackMatrix:g.fallbackMatrix}}isLocationOccluded(b){return this.currentTransform.isLocationOccluded(b)}transformLightDirection(b){return this.currentTransform.transformLightDirection(b)}getPixelScale(){return v.bk(this._mercatorTransform.getPixelScale(),
this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return v.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(b,g,m){const u=this._mercatorTransform.getPitchedTextCorrection(b,g,m);b=this._verticalPerspectiveTransform.getPitchedTextCorrection(b,g,m);return v.bk(u,b,this._globeness)}projectTileCoordinates(b,g,m,u){return this.currentTransform.projectTileCoordinates(b,
g,m,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(b){return this.currentTransform.calculateFogMatrix(b)}getVisibleUnwrappedCoordinates(b){return this.currentTransform.getVisibleUnwrappedCoordinates(b)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(b){this._mercatorTransform.recalculateZoomAndCenter(b);
this._verticalPerspectiveTransform.recalculateZoomAndCenter(b)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(b,g){return this.currentTransform.lngLatToCameraDepth(b,g)}populateCache(b){this._mercatorTransform.populateCache(b);this._verticalPerspectiveTransform.populateCache(b)}getBounds(){return this.currentTransform.getBounds()}getConstrained(b,
g){return this.currentTransform.getConstrained(b,g)}calculateCenterFromCameraLngLatAlt(b,g,m,u){return this._helper.calculateCenterFromCameraLngLatAlt(b,g,m,u)}setLocationAtPoint(b,g){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(b,g),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(b,g);this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(b,g){return this.currentTransform.locationToScreenPoint(b,g)}screenPointToMercatorCoordinate(b,
g){return this.currentTransform.screenPointToMercatorCoordinate(b,g)}screenPointToLocation(b,g){return this.currentTransform.screenPointToLocation(b,g)}isPointOnMapSurface(b,g){return this.currentTransform.isPointOnMapSurface(b,g)}getRayDirectionFromPixel(b){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(b)}getMatrixForModel(b,g){return this.currentTransform.getMatrixForModel(b,g)}getProjectionDataForCustomLayer(b=!0){const g=this._mercatorTransform.getProjectionDataForCustomLayer(b);
if(!this.isGlobeRendering)return g;b=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(b);return b.fallbackMatrix=g.mainMatrix,b}getFastPathSimpleProjectionMatrix(b){return this.currentTransform.getFastPathSimpleProjectionMatrix(b)}}class Hf{get useGlobeControls(){return!0}handlePanInertia(b,g){b=Gc(b,g);return 180<Math.abs(b.lng-g.center.lng)&&(b.lng=g.center.lng+179.5*Math.sign(b.lng-g.center.lng)),{easingCenter:b,easingOffset:new v.P(0,0)}}handleMapControlsRollPitchBearingZoom(b,
g){var m=b.around,u=g.screenPointToLocation(m);b.bearingDelta&&g.setBearing(g.bearing+b.bearingDelta);b.pitchDelta&&g.setPitch(g.pitch+b.pitchDelta);b.rollDelta&&g.setRoll(g.roll+b.rollDelta);var z=g.zoom;b.zoomDelta&&g.setZoom(g.zoom+b.zoomDelta);var C=g.zoom-z;if(0!==C){b=v.bA(g.center.lng,u.lng);z=b/(Math.abs(b/180)+1);var G=v.bA(g.center.lat,u.lat),K=g.getRayDirectionFromPixel(m),R=g.cameraPosition,X=-1*v.aX(R,K),ca=v.bp();v.aS(ca,R,[K[0]*X,K[1]*X,K[2]*X]);K=v.aZ(ca)-1;K=Math.exp(.5*-Math.max(K-
.3,0));R=Rb(g.worldSize,g.center.lat)/Math.min(g.width,g.height);X=v.bn(R,.9,.5,1,.25);X=(1-v.af(-C))*Math.min(K,X);C=g.center.lat;K=g.zoom;z=new v.S(g.center.lng+z*X,v.ah(g.center.lat+G*X,-v.ai,v.ai));g.setLocationAtPoint(u,m);m=g.center;u=v.bn(Math.abs(b),45,85,0,1);b=v.bn(R,.75,.35,0,1);u=Math.pow(Math.max(u,b),.25);b=v.bA(m.lng,z.lng);z=v.bA(m.lat,z.lat);g.setCenter((new v.S(m.lng+b*u,m.lat+z*u)).wrap());g.setZoom(K+fc(C,g.center.lat))}}handleMapControlsPan(b,g,m){if(b.panDelta){m=g.center.lat;
var u=g.zoom;g.setCenter(Gc(b.panDelta,g).wrap());g.setZoom(u+fc(m,g.center.lat))}}cameraForBoxAndBearing(b,g,m,u,z){b=ma(b,g,m,u,z);u=g.left/z.width*2-1;const C=(z.width-g.right)/z.width*2-1,G=g.top/z.height*-2+1;g=(z.height-g.bottom)/z.height*-2+1;var K=0>v.bA(m.getWest(),m.getEast()),R=K?m.getEast():m.getWest(),X=K?m.getWest():m.getEast();const ca=Math.max(m.getNorth(),m.getSouth()),ja=Math.min(m.getNorth(),m.getSouth()),la=R+.5*v.bA(R,X),pa=ca+.5*v.bA(ca,ja);z=z.clone();z.setCenter(b.center);
z.setBearing(b.bearing);z.setPitch(0);z.setRoll(0);z.setZoom(b.zoom);K=z.modelViewProjectionMatrix;m=[pb(m.getNorthWest()),pb(m.getNorthEast()),pb(m.getSouthWest()),pb(m.getSouthEast()),pb(new v.S(X,pa)),pb(new v.S(R,pa)),pb(new v.S(la,ca)),pb(new v.S(la,ja))];R=pb(b.center);X=Number.POSITIVE_INFINITY;for(const ya of m)0>u&&(X=Hf.getLesserNonNegativeNonNull(X,Hf.solveVectorScale(ya,R,K,"x",u))),0<C&&(X=Hf.getLesserNonNegativeNonNull(X,Hf.solveVectorScale(ya,R,K,"x",C))),0<G&&(X=Hf.getLesserNonNegativeNonNull(X,
Hf.solveVectorScale(ya,R,K,"y",G))),0>g&&(X=Hf.getLesserNonNegativeNonNull(X,Hf.solveVectorScale(ya,R,K,"y",g)));if(Number.isFinite(X)&&0!==X)return b.zoom=z.zoom+v.ak(X),b;fa()}handleJumpToCenterZoom(b,g){const m=b.center.lat,u=b.getConstrained(g.center?v.S.convert(g.center):b.center,b.zoom).center;b.setCenter(u.wrap());g=void 0!==g.zoom?+g.zoom:b.zoom+fc(m,u.lat);b.zoom!==g&&b.setZoom(g)}handleEaseTo(b,g){const m=b.zoom,u=b.center,z=b.padding,C={roll:b.roll,pitch:b.pitch,bearing:b.bearing},G={roll:void 0===
g.roll?b.roll:g.roll,pitch:void 0===g.pitch?b.pitch:g.pitch,bearing:void 0===g.bearing?b.bearing:g.bearing};var K=void 0!==g.zoom;const R=!b.isPaddingEqual(g.padding);let X=!1;var ca=g.center?v.S.convert(g.center):u,ja=b.getConstrained(ca,m).center;S(b,ja);const la=b.clone();la.setCenter(ja);la.setZoom(K?+g.zoom:m+fc(u.lat,ca.lat));la.setBearing(g.bearing);ca=new v.P(v.ah(b.centerPoint.x+g.offsetAsPoint.x,0,b.width),v.ah(b.centerPoint.y+g.offsetAsPoint.y,0,b.height));la.setLocationAtPoint(ja,ca);
ja=0<(g.offset&&g.offsetAsPoint.mag())?la.center:ja;K=K?+g.zoom:m+fc(u.lat,ja.lat);const pa=m+fc(u.lat,0),ya=K+fc(ja.lat,0),Ba=v.bA(u.lng,ja.lng),za=v.bA(u.lat,ja.lat),Ea=v.af(ya-pa);return X=K!==m,{easeFunc:Qa=>{if(v.be(C,G)||ra({startEulerAngles:C,endEulerAngles:G,tr:b,k:Qa,useSlerp:C.roll!=G.roll}),R&&b.interpolatePadding(z,g.padding,Qa),g.around)v.w("Easing around a point is not supported under globe projection."),b.setLocationAtPoint(g.around,g.aroundPoint);else{const Za=Hd(u,Ba,za,Qa*Math.pow(ya>
pa?Math.min(2,Ea):Math.max(.5,Ea),1-Qa));b.setCenter(Za.wrap())}X&&(Qa=v.C.number(pa,ya,Qa)+fc(0,b.center.lat),b.setZoom(Qa))},isZooming:X,elevationCenter:ja}}handleFlyTo(b,g){var m=void 0!==g.zoom;const u=b.center;var z=b.zoom;const C=b.padding,G=!b.isPaddingEqual(g.padding);var K=b.getConstrained(v.S.convert(g.center||g.locationAtOffset),z).center;const R=m?+g.zoom:b.zoom+fc(b.center.lat,K.lat);m=b.clone();m.setCenter(K);m.setZoom(R);m.setBearing(g.bearing);const X=new v.P(v.ah(b.centerPoint.x+
g.offsetAsPoint.x,0,b.width),v.ah(b.centerPoint.y+g.offsetAsPoint.y,0,b.height));m.setLocationAtPoint(K,X);const ca=m.center;S(b,ca);K=function(Ba,za,Ea){za=pb(za);Ea=pb(Ea);Ea=v.aX(za,Ea);Ea=Math.acos(Ea);Ba=Ua(Ba);return Ea/(2*Math.PI)*Ba}(b,u,ca);const ja=z+fc(u.lat,0);m=R+fc(ca.lat,0);z=v.af(m-ja);if("number"==typeof g.minZoom){var la=+g.minZoom+fc(ca.lat,0);la=Math.min(la,ja,m)+fc(0,ca.lat);la=b.getConstrained(ca,la).zoom+fc(ca.lat,0);la=v.af(la-ja)}const pa=v.bA(u.lng,ca.lng),ya=v.bA(u.lat,
ca.lat);return{easeFunc:(Ba,za,Ea,Qa)=>{Ea=Hd(u,pa,ya,Ea);G&&b.interpolatePadding(C,g.padding,Ba);Ea=1===Ba?ca:Ea;b.setCenter(Ea.wrap());za=ja+v.ak(za);b.setZoom(1===Ba?R:za+fc(0,Ea.lat))},scaleOfZoom:z,targetCenter:ca,scaleOfMinZoom:la,pixelPathLength:K}}static solveVectorScale(b,g,m,u,z){u="x"===u?[m[0],m[4],m[8],m[12]]:[m[1],m[5],m[9],m[13]];m=[m[3],m[7],m[11],m[15]];const C=b[0]*u[0]+b[1]*u[1]+b[2]*u[2];b=b[0]*m[0]+b[1]*m[1]+b[2]*m[2];const G=g[0]*u[0]+g[1]*u[1]+g[2]*u[2];g=g[0]*m[0]+g[1]*m[1]+
g[2]*m[2];return G+z*b===C+z*g||m[3]*(C-G)+u[3]*(g-b)+C*g==G*b?null:(G+u[3]-z*g-z*m[3])/(G-C-z*g+z*b)}static getLesserNonNegativeNonNull(b,g){return null!==g&&0<=g&&g<b?g:b}}class af{constructor(b){this._globe=b;this._mercatorCameraHelper=new yd;this._verticalPerspectiveCameraHelper=new Hf}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(b,g){return this.currentHelper.handlePanInertia(b,
g)}handleMapControlsRollPitchBearingZoom(b,g){return this.currentHelper.handleMapControlsRollPitchBearingZoom(b,g)}handleMapControlsPan(b,g,m){this.currentHelper.handleMapControlsPan(b,g,m)}cameraForBoxAndBearing(b,g,m,u,z){return this.currentHelper.cameraForBoxAndBearing(b,g,m,u,z)}handleJumpToCenterZoom(b,g){this.currentHelper.handleJumpToCenterZoom(b,g)}handleEaseTo(b,g){return this.currentHelper.handleEaseTo(b,g)}handleFlyTo(b,g){return this.currentHelper.handleFlyTo(b,g)}}const Pe=(b,g)=>v.y(b,
g&&g.filter(m=>"source.canvas"!==m.identifier)),ug=v.bE();class ge extends v.E{constructor(b,g={}){var m,u;super();this._rtlPluginLoaded=()=>{for(const C in this.sourceCaches){const G=this.sourceCaches[C].getSource().type;"vector"!==G&&"geojson"!==G||this.sourceCaches[C].reload()}};this.map=b;this.dispatcher=new zi(bb(),b._getMapId());this.dispatcher.registerMessageHandler("GG",(C,G)=>this.getGlyphs(C,G));this.dispatcher.registerMessageHandler("GI",(C,G)=>this.getImages(C,G));this.dispatcher.registerMessageHandler("GDA",
(C,G)=>this.getDashes(C,G));this.imageManager=new uj;this.imageManager.setEventedParent(this);const z=(null===(m=b._container)||void 0===m?void 0:m.lang)||"undefined"!=typeof document&&(null===(u=document.documentElement)||void 0===u?void 0:u.lang)||void 0;this.glyphManager=new Yg(b._requestManager,g.localIdeographFontFamily,z);this.lineAtlas=new vd(256,512);this.crossTileSymbolIndex=new kf;this._spritesImagesIds={};this._layers={};this._order=[];this.sourceCaches={};this.zoomHistory=new v.bF;this._loaded=
!1;this._availableImages=[];this._globalState={};this._resetUpdates();this.dispatcher.broadcast("SR",v.bG());zb().on("RTLPluginLoaded",this._rtlPluginLoaded);this.on("data",C=>{if("source"===C.dataType&&"metadata"===C.sourceDataType&&(C=this.sourceCaches[C.sourceId])&&(C=C.getSource())&&C.vectorLayerIds)for(const G in this._layers){const K=this._layers[G];K.source===C.id&&this._validateLayer(K)}})}setGlobalStateProperty(b,g){var m,u,z;this._checkLoaded();const C=null===g?null!==(z=null===(u=null===
(m=this.stylesheet.state)||void 0===m?void 0:m[b])||void 0===u?void 0:u.default)&&void 0!==z?z:null:g;if(v.bH(C,this._globalState[b]))return this;this._globalState[b]=C;this._applyGlobalStateChanges([b])}getGlobalState(){return this._globalState}setGlobalState(b){this._checkLoaded();const g=[];for(const m in b)!v.bH(this._globalState[m],b[m].default)&&(g.push(m),this._globalState[m]=b[m].default);this._applyGlobalStateChanges(g)}_applyGlobalStateChanges(b){if(0!==b.length){var g=new Set,m={};for(const u of b){m[u]=
this._globalState[u];for(const z in this._layers){b=this._layers[z];const C=b.getLayoutAffectingGlobalStateRefs(),G=b.getPaintAffectingGlobalStateRefs();if(C.has(u)&&g.add(b.source),G.has(u))for(const {name:K,value:R}of G.get(u))this._updatePaintProperty(b,K,R)}}this.dispatcher.broadcast("UGS",m);for(const u in this.sourceCaches)g.has(u)&&(this._reloadSource(u),this._changed=!0)}}loadURL(b,g={},m){this.fire(new v.l("dataloading",{dataType:"style"}));g.validate="boolean"!=typeof g.validate||g.validate;
b=this.map._requestManager.transformRequest(b,"Style");const u=this._loadStyleRequest=new AbortController;v.j(b,this._loadStyleRequest).then(z=>{this._loadStyleRequest=null;this._load(z.data,g,m)}).catch(z=>{this._loadStyleRequest=null;z&&!u.signal.aborted&&this.fire(new v.k(z))})}loadJSON(b,g={},m){this.fire(new v.l("dataloading",{dataType:"style"}));this._frameRequest=new AbortController;qd.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null;g.validate=!1!==g.validate;this._load(b,
g,m)}).catch(()=>{})}loadEmpty(){this.fire(new v.l("dataloading",{dataType:"style"}));this._load(ug,{validate:!1})}_load(b,g,m){var u,z;b=g.transformStyle?g.transformStyle(m,b):b;if(!g.validate||!Pe(this,v.z(b))){b=Object.assign({},b);this._loaded=!0;this.stylesheet=b;for(const C in b.sources)this.addSource(C,b.sources[C],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0);this.glyphManager.setURL(b.glyphs);this._createLayers();this.light=new $h(this.stylesheet.light);
this._setProjectionInternal((null===(u=this.stylesheet.projection)||void 0===u?void 0:u.type)||"mercator");this.sky=new sh(this.stylesheet.sky);this.map.setTerrain(null!==(z=this.stylesheet.terrain)&&void 0!==z?z:null);this.fire(new v.l("data",{dataType:"style"}));this.fire(new v.l("style.load"))}}_createLayers(){var b,g,m,u=v.bI(this.stylesheet.layers);this.setGlobalState(null!==(b=this.stylesheet.state)&&void 0!==b?b:null);this.dispatcher.broadcast("SL",u);this._order=u.map(z=>z.id);this._layers=
{};this._serializedLayers=null;for(const z of u)if(b=v.bJ(z,this._globalState),b.setEventedParent(this,{layer:{id:z.id}}),this._layers[z.id]=b,v.bK(b)&&this.sourceCaches[b.source])u=null!==(m=null===(g=z.paint)||void 0===g?void 0:g["raster-fade-duration"])&&void 0!==m?m:b.paint.get("raster-fade-duration"),this.sourceCaches[b.source].setRasterFadeDuration(u)}_loadSprite(b,g=!1,m){let u;this.imageManager.setLoaded(!1);this._spriteRequest=new AbortController;(function(z,C,G,K){return v._(this,void 0,
void 0,function*(){var R=Ab(z);const X=1<G?"@2x":"",ca={},ja={};for(const {id:la,url:pa}of R)R=C.transformRequest($a(pa,X,".json"),"SpriteJSON"),ca[la]=v.j(R,K),R=C.transformRequest($a(pa,X,".png"),"SpriteImage"),ja[la]=yf.getImage(R,K);return yield Promise.all([...Object.values(ca),...Object.values(ja)]),function(la,pa){return v._(this,void 0,void 0,function*(){const ya={};for(const Ba in la){ya[Ba]={};const za=qd.getImageCanvasContext((yield pa[Ba]).data),Ea=(yield la[Ba]).data;for(const Qa in Ea){const {width:Za,
height:sb,x:ob,y:eb,sdf:Db,pixelRatio:Nb,stretchX:Ob,stretchY:Jb,content:$b,textFitWidth:vc,textFitHeight:Bb}=Ea[Qa];ya[Ba][Qa]={data:null,pixelRatio:Nb,sdf:Db,stretchX:Ob,stretchY:Jb,content:$b,textFitWidth:vc,textFitHeight:Bb,spriteData:{width:Za,height:sb,x:ob,y:eb,context:za}}}}return ya})}(ca,ja)})})(b,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(z=>{if(this._spriteRequest=null,z)for(const G in z){this._spritesImagesIds[G]=[];var C=this._spritesImagesIds[G]?this._spritesImagesIds[G].filter(K=>
!(K in z)):[];for(const K of C)this.imageManager.removeImage(K),this._changedImages[K]=!0;for(const K in z[G])C="default"===G?K:`${G}:${K}`,this._spritesImagesIds[G].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,z[G][K],!1):this.imageManager.addImage(C,z[G][K]),g&&(this._changedImages[C]=!0)}}).catch(z=>{this._spriteRequest=null;u=z;this.fire(new v.k(u))}).finally(()=>{this.imageManager.setLoaded(!0);this._availableImages=this.imageManager.listImages();g&&(this._changed=!0);
this.dispatcher.broadcast("SI",this._availableImages);this.fire(new v.l("data",{dataType:"style"}));m&&m(u)})}_unloadSprite(){for(const b of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(b),this._changedImages[b]=!0;this._spritesImagesIds={};this._availableImages=this.imageManager.listImages();this._changed=!0;this.dispatcher.broadcast("SI",this._availableImages);this.fire(new v.l("data",{dataType:"style"}))}_validateLayer(b){var g=this.sourceCaches[b.source];if(g){var m=
b.sourceLayer;m&&(g=g.getSource(),("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(m))&&this.fire(new v.k(Error(`Source layer "${m}" does not exist on source "${g.id}" as specified by style layer "${b.id}".`))))}}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const b in this.sourceCaches)if(!this.sourceCaches[b].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(b,g=!1){const m=this._serializedAllLayers();if(!b||0===b.length)return Object.values(g?
v.bL(m):m);const u=[];for(const z of b)m[z]&&(b=g?v.bL(m[z]):m[z],u.push(b));return u}_serializedAllLayers(){let b=this._serializedLayers;if(b)return b;b=this._serializedLayers={};var g=Object.keys(this._layers);for(const m of g)g=this._layers[m],"custom"!==g.type&&(b[m]=g.serialize());return b}hasTransitions(){var b,g,m;if((null===(b=this.light)||void 0===b?0:b.hasTransition())||(null===(g=this.sky)||void 0===g?0:g.hasTransition())||(null===(m=this.projection)||void 0===m?0:m.hasTransition()))return!0;
for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw Error("Style is not done loading.");}update(b){if(this._loaded){var g=this._changed;if(g){var m=Object.keys(this._updatedLayers);const K=Object.keys(this._removedLayers);(m.length||K.length)&&this._updateWorkerLayers(m,K);for(var u in this._updatedSources)if(m=this._updatedSources[u],"reload"===m)this._reloadSource(u);
else{if("clear"!==m)throw Error(`Invalid action ${m}`);this._clearSource(u)}this._updateTilesForChangedImages();this._updateTilesForChangedGlyphs();for(var z in this._updatedPaintProps)this._layers[z].updateTransitions(b);this.light.updateTransitions(b);this.sky.updateTransitions(b);this._resetUpdates()}u={};for(var C in this.sourceCaches)z=this.sourceCaches[C],u[C]=z.used,z.used=!1;for(var G of this._order)C=this._layers[G],C.recalculate(b,this._availableImages),!C.isHidden(b.zoom)&&C.source&&(this.sourceCaches[C.source].used=
!0);for(const K in u)G=this.sourceCaches[K],!!u[K]!=!!G.used&&G.fire(new v.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:K}));this.light.recalculate(b);this.sky.recalculate(b);this.projection.recalculate(b);this.z=b.zoom;g&&this.fire(new v.l("data",{dataType:"style"}))}}_updateTilesForChangedImages(){const b=Object.keys(this._changedImages);if(b.length){for(const g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],b);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const b in this.sourceCaches)this.sourceCaches[b].reloadTilesForDependencies(["glyphs"],
[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(b,g){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(b,!1),removedIds:g})}_resetUpdates(){this._changed=!1;this._updatedLayers={};this._removedLayers={};this._updatedSources={};this._updatedPaintProps={};this._changedImages={};this._glyphsDidChange=!1}setState(b,g={}){var m;this._checkLoaded();const u=this.serialize();if(b=g.transformStyle?g.transformStyle(u,b):b,(null===(m=g.validate)||void 0===m||m)&&Pe(this,v.z(b)))return!1;(b=v.bL(b)).layers=
v.bI(b.layers);g=v.bM(u,b);g=this._getOperationsToPerform(g);if(0<g.unimplemented.length)throw Error(`Unimplemented: ${g.unimplemented.join(", ")}.`);if(0===g.operations.length)return!1;for(const z of g.operations)z();return this.stylesheet=b,this._serializedLayers=null,!0}_getOperationsToPerform(b){const g=[],m=[];for(const u of b)switch(u.command){case "setCenter":case "setZoom":case "setBearing":case "setPitch":case "setRoll":continue;case "addLayer":g.push(()=>this.addLayer.apply(this,u.args));
break;case "removeLayer":g.push(()=>this.removeLayer.apply(this,u.args));break;case "setPaintProperty":g.push(()=>this.setPaintProperty.apply(this,u.args));break;case "setLayoutProperty":g.push(()=>this.setLayoutProperty.apply(this,u.args));break;case "setFilter":g.push(()=>this.setFilter.apply(this,u.args));break;case "addSource":g.push(()=>this.addSource.apply(this,u.args));break;case "removeSource":g.push(()=>this.removeSource.apply(this,u.args));break;case "setLayerZoomRange":g.push(()=>this.setLayerZoomRange.apply(this,
u.args));break;case "setLight":g.push(()=>this.setLight.apply(this,u.args));break;case "setGeoJSONSourceData":g.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case "setGlyphs":g.push(()=>this.setGlyphs.apply(this,u.args));break;case "setSprite":g.push(()=>this.setSprite.apply(this,u.args));break;case "setTerrain":g.push(()=>this.map.setTerrain.apply(this,u.args));break;case "setSky":g.push(()=>this.setSky.apply(this,u.args));break;case "setProjection":this.setProjection.apply(this,u.args);
break;case "setGlobalState":g.push(()=>this.setGlobalState.apply(this,u.args));break;case "setTransition":g.push(()=>{});break;default:m.push(u.command)}return{operations:g,unimplemented:m}}addImage(b,g){if(this.getImage(b))return this.fire(new v.k(Error(`An image named "${b}" already exists.`)));this.imageManager.addImage(b,g);this._afterImageUpdated(b)}updateImage(b,g){this.imageManager.updateImage(b,g)}getImage(b){return this.imageManager.getImage(b)}removeImage(b){if(!this.getImage(b))return this.fire(new v.k(Error(`An image named "${b}" does not exist.`)));
this.imageManager.removeImage(b);this._afterImageUpdated(b)}_afterImageUpdated(b){this._availableImages=this.imageManager.listImages();this._changed=this._changedImages[b]=!0;this.dispatcher.broadcast("SI",this._availableImages);this.fire(new v.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(b,g,m={}){if(this._checkLoaded(),void 0!==this.sourceCaches[b])throw Error(`Source "${b}" already exists.`);if(!g.type)throw Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);
if(!(0<=["vector","raster","geojson","video","image"].indexOf(g.type)&&this._validate(v.z.source,`sources.${b}`,g,null,m))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var u=this.sourceCaches[b]=new Od(b,g,this.dispatcher);u.style=this;u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:b}));u.onAdd(this.map);this._changed=!0}}removeSource(b){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw Error("There is no source with this ID");
for(var g in this._layers)if(this._layers[g].source===b)return this.fire(new v.k(Error(`Source "${b}" cannot be removed while layer "${g}" is using it.`)));g=this.sourceCaches[b];delete this.sourceCaches[b];delete this._updatedSources[b];g.fire(new v.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:b}));g.setEventedParent(null);g.onRemove(this.map);this._changed=!0}setGeoJSONSourceData(b,g){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw Error(`There is no source with this ID=${b}`);
b=this.sourceCaches[b].getSource();if("geojson"!==b.type)throw Error(`geojsonSource.type is ${b.type}, which is !== 'geojson`);b.setData(g);this._changed=!0}getSource(b){return this.sourceCaches[b]&&this.sourceCaches[b].getSource()}addLayer(b,g,m={}){this._checkLoaded();const u=b.id;if(this.getLayer(u))return void this.fire(new v.k(Error(`Layer "${u}" already exists on this map.`)));if("custom"===b.type){if(Pe(this,v.bN(b)))return;b=v.bJ(b,this._globalState)}else{if("source"in b&&"object"==typeof b.source&&
(this.addSource(u,b.source),b=v.bL(b),b=v.e(b,{source:u})),this._validate(v.z.layer,`layers.${u}`,b,{arrayIndex:-1},m))return;b=v.bJ(b,this._globalState);this._validateLayer(b);b.setEventedParent(this,{layer:{id:u}})}m=g?this._order.indexOf(g):this._order.length;if(g&&-1===m)this.fire(new v.k(Error(`Cannot add layer "${u}" before non-existing layer "${g}".`)));else{if(this._order.splice(m,0,u),this._layerOrderChanged=!0,this._layers[u]=b,this._removedLayers[u]&&b.source&&"custom"!==b.type)g=this._removedLayers[u],
delete this._removedLayers[u],g.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause());this._updateLayer(b);b.onAdd&&b.onAdd(this.map)}}moveLayer(b,g){if(this._checkLoaded(),this._changed=!0,!this._layers[b])return void this.fire(new v.k(Error(`The layer '${b}' does not exist in the map's style and cannot be moved.`)));if(b!==g){var m=this._order.indexOf(b);this._order.splice(m,1);m=g?this._order.indexOf(g):this._order.length;
g&&-1===m?this.fire(new v.k(Error(`Cannot move layer "${b}" before non-existing layer "${g}".`))):(this._order.splice(m,0,b),this._layerOrderChanged=!0)}}removeLayer(b){this._checkLoaded();const g=this._layers[b];if(!g)return void this.fire(new v.k(Error(`Cannot remove non-existing layer "${b}".`)));g.setEventedParent(null);const m=this._order.indexOf(b);this._order.splice(m,1);this._changed=this._layerOrderChanged=!0;this._removedLayers[b]=g;delete this._layers[b];this._serializedLayers&&delete this._serializedLayers[b];
delete this._updatedLayers[b];delete this._updatedPaintProps[b];g.onRemove&&g.onRemove(this.map)}getLayer(b){return this._layers[b]}getLayersOrder(){return[...this._order]}hasLayer(b){return b in this._layers}setLayerZoomRange(b,g,m){this._checkLoaded();const u=this.getLayer(b);u?u.minzoom===g&&u.maxzoom===m||(null!=g&&(u.minzoom=g),null!=m&&(u.maxzoom=m),this._updateLayer(u)):this.fire(new v.k(Error(`Cannot set the zoom range of non-existing layer "${b}".`)))}setFilter(b,g,m={}){this._checkLoaded();
const u=this.getLayer(b);if(u){if(!v.bH(u.filter,g))return null==g?(u.setFilter(void 0),void this._updateLayer(u)):void(this._validate(v.z.filter,`layers.${u.id}.filter`,g,null,m)||(u.setFilter(v.bL(g)),this._updateLayer(u)))}else this.fire(new v.k(Error(`Cannot filter non-existing layer "${b}".`)))}getFilter(b){return v.bL(this.getLayer(b).filter)}setLayoutProperty(b,g,m,u={}){this._checkLoaded();const z=this.getLayer(b);z?v.bH(z.getLayoutProperty(g),m)||(z.setLayoutProperty(g,m,u),this._updateLayer(z)):
this.fire(new v.k(Error(`Cannot style non-existing layer "${b}".`)))}getLayoutProperty(b,g){const m=this.getLayer(b);if(m)return m.getLayoutProperty(g);this.fire(new v.k(Error(`Cannot get style of non-existing layer "${b}".`)))}setPaintProperty(b,g,m,u={}){this._checkLoaded();const z=this.getLayer(b);z?v.bH(z.getPaintProperty(g),m)||this._updatePaintProperty(z,g,m,u):this.fire(new v.k(Error(`Cannot style non-existing layer "${b}".`)))}_updatePaintProperty(b,g,m,u={}){b.setPaintProperty(g,m,u)&&this._updateLayer(b);
v.bK(b)&&"raster-fade-duration"===g&&this.sourceCaches[b.source].setRasterFadeDuration(m);this._changed=!0;this._updatedPaintProps[b.id]=!0;this._serializedLayers=null}getPaintProperty(b,g){return this.getLayer(b).getPaintProperty(g)}setFeatureState(b,g){this._checkLoaded();var m=b.source;const u=b.sourceLayer,z=this.sourceCaches[m];if(void 0===z)return void this.fire(new v.k(Error(`The source '${m}' does not exist in the map's style.`)));m=z.getSource().type;"geojson"===m&&u?this.fire(new v.k(Error("GeoJSON sources cannot have a sourceLayer parameter."))):
"vector"!==m||u?(void 0===b.id&&this.fire(new v.k(Error("The feature id parameter must be provided."))),z.setFeatureState(u,b.id,g)):this.fire(new v.k(Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(b,g){this._checkLoaded();var m=b.source;const u=this.sourceCaches[m];if(void 0===u)return void this.fire(new v.k(Error(`The source '${m}' does not exist in the map's style.`)));m=u.getSource().type;const z="vector"===m?b.sourceLayer:void 0;"vector"!==m||
z?g&&"string"!=typeof b.id&&"number"!=typeof b.id?this.fire(new v.k(Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(z,b.id,g):this.fire(new v.k(Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(b){this._checkLoaded();const g=b.source,m=b.sourceLayer,u=this.sourceCaches[g];if(void 0!==u)return"vector"!==u.getSource().type||m?(void 0===b.id&&this.fire(new v.k(Error("The feature id parameter must be provided."))),
u.getFeatureState(m,b.id)):void this.fire(new v.k(Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new v.k(Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return v.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(this._loaded){var b=v.bO(this.sourceCaches,z=>z.serialize()),g=this._serializeByIds(this._order,!0),m=this.map.getTerrain()||void 0,u=this.stylesheet;return v.bP({version:u.version,
name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:b,layers:g,terrain:m},z=>void 0!==z)}}_updateLayer(b){this._updatedLayers[b.id]=!0;b.source&&!this._updatedSources[b.source]&&"raster"!==this.sourceCaches[b.source].getSource().type&&(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause());this._serializedLayers=null;this._changed=
!0}_flattenAndSortRenderedFeatures(b){const g=R=>"fill-extrusion"===this._layers[R].type,m={},u=[];for(var z=this._order.length-1;0<=z;z--){var C=this._order[z];if(g(C)){m[C]=z;for(var G of b){var K=G[C];if(K)for(const R of K)u.push(R)}}}u.sort((R,X)=>X.intersectionZ-R.intersectionZ);z=[];for(C=this._order.length-1;0<=C;C--)if(G=this._order[C],g(G))for(G=u.length-1;0<=G;G--){K=u[G].feature;if(m[K.layer.id]<C)break;z.push(K);u.pop()}else for(const R of b)if(K=R[G])for(const X of K)z.push(X.feature);
return z}queryRenderedFeatures(b,g,m){g&&g.filter&&this._validate(v.z.filter,"queryRenderedFeatures.filter",g.filter,null,g);const u={};if(g&&g.layers){if(!(Array.isArray(g.layers)||g.layers instanceof Set))return this.fire(new v.k(Error("parameters.layers must be an Array or a Set of strings"))),[];for(var z of g.layers){var C=this._layers[z];if(!C)return this.fire(new v.k(Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];u[C.source]=!0}}z=[];g.availableImages=
this._availableImages;C=this._serializedAllLayers();var G=g.layers instanceof Set?g.layers:Array.isArray(g.layers)?new Set(g.layers):null;G=Object.assign(Object.assign({},g),{layers:G,globalState:this._globalState});for(const K in this.sourceCaches)g.layers&&!u[K]||z.push(Pa(this.sourceCaches[K],this._layers,C,b,G,m,this.map.terrain?(R,X,ca)=>this.map.terrain.getElevation(R,X,ca):void 0));return this.placement&&z.push(function(K,R,X,ca,ja,la,pa){const ya={};ca=la.queryRenderedSymbols(ca);la=[];for(var Ba of Object.keys(ca).map(Number))la.push(pa[Ba]);
la.sort(yb);for(const za of la){pa=za.featureIndex.lookupSymbolFeatures(ca[za.bucketInstanceId],R,za.bucketIndex,za.sourceLayerIndex,{filterSpec:ja.filter,globalState:ja.globalState},ja.layers,ja.availableImages,K);for(const Ea in pa){Ba=ya[Ea]=ya[Ea]||[];la=pa[Ea];la.sort((Qa,Za)=>{const sb=za.featureSortOrder;return sb?(Qa=sb.indexOf(Qa.featureIndex),sb.indexOf(Za.featureIndex)-Qa):Za.featureIndex-Qa.featureIndex});for(const Qa of la)Ba.push(Qa)}}return function(za,Ea,Qa){for(const Za in za)for(const sb of za[Za])Ib(sb,
Qa[Ea[Za].source]);return za}(ya,K,X)}(this._layers,C,this.sourceCaches,b,G,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(z)}querySourceFeatures(b,g){(null==g?0:g.filter)&&this._validate(v.z.filter,"querySourceFeatures.filter",g.filter,null,g);return(b=this.sourceCaches[b])?function(m,u){const z=m.getRenderableIds().map(K=>m.getTileByID(K)),C=[],G={};for(let K=0;K<z.length;K++){const R=z[K],X=R.tileID.canonical.key;G[X]||(G[X]=!0,R.querySourceFeatures(C,
u))}return C}(b,g?Object.assign(Object.assign({},g),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(b,g={}){this._checkLoaded();var m=this.light.getLight();let u=!1;for(const z in b)if(!v.bH(b[z],m[z])){u=!0;break}u&&(m={now:qd.now(),transition:v.e({duration:300,delay:0},this.stylesheet.transition)},this.light.setLight(b,g),this.light.updateTransitions(m))}getProjection(){var b;return null===(b=this.stylesheet)||void 0===b?void 0:
b.projection}setProjection(b){if(this._checkLoaded(),this.projection){if(this.projection.name===b.type)return;this.projection.destroy();delete this.projection}this.stylesheet.projection=b;this._setProjectionInternal(b.type)}getSky(){var b;return null===(b=this.stylesheet)||void 0===b?void 0:b.sky}setSky(b,g={}){this._checkLoaded();var m=this.getSky();let u=!1;if(b||m){if(b&&!m)u=!0;else if(!b&&m)u=!0;else for(const z in b)if(!v.bH(b[z],m[z])){u=!0;break}u&&(m={now:qd.now(),transition:v.e({duration:300,
delay:0},this.stylesheet.transition)},this.stylesheet.sky=b,this.sky.setSky(b,g),this.sky.updateTransitions(m))}}_setProjectionInternal(b){b=function(g){if(Array.isArray(g))return g=new fe({type:g}),{projection:g,transform:new Ce,cameraHelper:new af(g)};switch(g){case "mercator":return{projection:new Eb,transform:new Ld,cameraHelper:new yd};case "globe":return g=new fe({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]}),{projection:g,transform:new Ce,cameraHelper:new af(g)};
case "vertical-perspective":return{projection:new Fi,transform:new tf,cameraHelper:new Hf};default:return v.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new Eb,transform:new Ld,cameraHelper:new yd}}}(b);this.projection=b.projection;this.map.migrateProjection(b.transform,b.cameraHelper);for(const g in this.sourceCaches)this.sourceCaches[g].reload()}_validate(b,g,m,u,z={}){return(!z||!1!==z.validate)&&Pe(this,b.call(v.z,v.e({key:g,style:this.serialize(),value:m,
styleSpec:v.v},u)))}_remove(b=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null);this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null);this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);zb().off("RTLPluginLoaded",this._rtlPluginLoaded);for(var g in this._layers)this._layers[g].setEventedParent(null);for(const m in this.sourceCaches)g=this.sourceCaches[m],g.setEventedParent(null),g.onRemove(this.map);this.imageManager.setEventedParent(null);
this.setEventedParent(null);b&&this.dispatcher.broadcast("RM",void 0);this.dispatcher.remove(b)}_clearSource(b){this.sourceCaches[b].clearTiles()}_reloadSource(b){this.sourceCaches[b].resume();this.sourceCaches[b].reload()}_updateSources(b){for(const g in this.sourceCaches)this.sourceCaches[g].update(b,this.map.terrain)}_generateCollisionBoxes(){for(const b in this.sourceCaches)this._reloadSource(b)}_updatePlacement(b,g,m,u,z=!1){let C=!1,G=!1;const K={};for(const X of this._order){var R=this._layers[X];
if("symbol"===R.type){if(!K[R.source]){const ca=this.sourceCaches[R.source];K[R.source]=ca.getRenderableIds(!0).map(ja=>ca.getTileByID(ja)).sort((ja,la)=>la.tileID.overscaledZ-ja.tileID.overscaledZ||(ja.tileID.isLessThan(la.tileID)?-1:1))}R=this.crossTileSymbolIndex.addLayer(R,K[R.source],b.center.lng);C=C||R}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((z=z||this._layerOrderChanged||0===m)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(qd.now(),
b.zoom))&&(this.pauseablePlacement=new Lb(b,this.map.terrain,this._order,z,g,m,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,K),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(qd.now()),G=!0),C&&this.pauseablePlacement.placement.setStale()),G||C)for(const X of this._order)b=this._layers[X],"symbol"===b.type&&this.placement.updateLayerOpacities(b,
K[b.source]);return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(qd.now())}_releaseSymbolFadeTiles(){for(const b in this.sourceCaches)this.sourceCaches[b].releaseSymbolFadeTiles()}getImages(b,g){return v._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(g.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[g.source];return u&&u.setDependencies(g.tileID.key,g.type,g.icons),m})}getGlyphs(b,g){return v._(this,void 0,void 0,function*(){const m=
yield this.glyphManager.getGlyphs(g.stacks),u=this.sourceCaches[g.source];return u&&u.setDependencies(g.tileID.key,g.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(b,g={}){this._checkLoaded();b&&this._validate(v.z.glyphs,"glyphs",b,null,g)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=b,this.glyphManager.entries={},this.glyphManager.setURL(b))}getDashes(b,g){return v._(this,void 0,void 0,function*(){const m={};for(const [u,z]of Object.entries(g.dashes))m[u]=this.lineAtlas.getDash(z.dasharray,
z.round);return m})}addSprite(b,g,m={},u){this._checkLoaded();b=[{id:b,url:g}];g=[...Ab(this.stylesheet.sprite),...b];this._validate(v.z.sprite,"sprite",g,null,m)||(this.stylesheet.sprite=g,this._loadSprite(b,!0,u))}removeSprite(b){this._checkLoaded();const g=Ab(this.stylesheet.sprite);if(g.find(m=>m.id===b)){if(this._spritesImagesIds[b])for(const m of this._spritesImagesIds[b])this.imageManager.removeImage(m),this._changedImages[m]=!0;g.splice(g.findIndex(m=>m.id===b),1);this.stylesheet.sprite=0<
g.length?g:void 0;delete this._spritesImagesIds[b];this._availableImages=this.imageManager.listImages();this._changed=!0;this.dispatcher.broadcast("SI",this._availableImages);this.fire(new v.l("data",{dataType:"style"}))}else this.fire(new v.k(Error(`Sprite "${b}" doesn't exists on this map.`)))}getSprite(){return Ab(this.stylesheet.sprite)}setSprite(b,g={},m){this._checkLoaded();b&&this._validate(v.z.sprite,"sprite",b,null,g)||(this.stylesheet.sprite=b,b?this._loadSprite(b,!0,m):(this._unloadSprite(),
m&&m(null)))}}var Ng=v.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Qe{constructor(){this.boundLayoutVertexBuffer=this.boundProgram=null;this.boundPaintVertexBuffers=[];this.vao=this.boundDynamicVertexBuffer=this.boundVertexOffset=this.boundIndexBuffer=null}bind(b,g,m,u,z,C,G,K,R){this.context=b;let X=this.boundPaintVertexBuffers.length!==u.length;for(let ca=0;!X&&ca<u.length;ca++)this.boundPaintVertexBuffers[ca]!==u[ca]&&(X=!0);!this.vao||
this.boundProgram!==g||this.boundLayoutVertexBuffer!==m||X||this.boundIndexBuffer!==z||this.boundVertexOffset!==C||this.boundDynamicVertexBuffer!==G||this.boundDynamicVertexBuffer2!==K||this.boundDynamicVertexBuffer3!==R?this.freshBind(g,m,u,z,C,G,K,R):(b.bindVertexArray.set(this.vao),G&&G.bind(),z&&z.dynamicDraw&&z.bind(),K&&K.bind(),R&&R.bind())}freshBind(b,g,m,u,z,C,G,K){const R=b.numAttributes,X=this.context,ca=X.gl;this.vao&&this.destroy();this.vao=X.createVertexArray();X.bindVertexArray.set(this.vao);
this.boundProgram=b;this.boundLayoutVertexBuffer=g;this.boundPaintVertexBuffers=m;this.boundIndexBuffer=u;this.boundVertexOffset=z;this.boundDynamicVertexBuffer=C;this.boundDynamicVertexBuffer2=G;this.boundDynamicVertexBuffer3=K;g.enableAttributes(ca,b);for(const ja of m)ja.enableAttributes(ca,b);C&&C.enableAttributes(ca,b);G&&G.enableAttributes(ca,b);K&&K.enableAttributes(ca,b);g.bind();g.setVertexAttribPointers(ca,b,z);for(const ja of m)ja.bind(),ja.setVertexAttribPointers(ca,b,z);C&&(C.bind(),
C.setVertexAttribPointers(ca,b,z));u&&u.bind();G&&(G.bind(),G.setVertexAttribPointers(ca,b,z));K&&(K.bind(),K.setVertexAttribPointers(ca,b,z));X.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const eh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};class Og{constructor(b,
g,m,u,z,C,G,K,R=[]){const X=b.gl;this.program=X.createProgram();var ca=Kf(g.staticAttributes),ja=m?m.getBinderAttributes():[];ca=ca.concat(ja);ja=Ed.prelude.staticUniforms?Kf(Ed.prelude.staticUniforms):[];var la=G.staticUniforms?Kf(G.staticUniforms):[];const pa=g.staticUniforms?Kf(g.staticUniforms):[],ya=m?m.getBinderUniforms():[];la=ja.concat(la).concat(pa).concat(ya);ja=[];for(var Ba of la)0>ja.indexOf(Ba)&&ja.push(Ba);Ba=m?m.defines():[];ua(X)&&Ba.unshift("#version 300 es");z&&Ba.push("#define OVERDRAW_INSPECTOR;");
C&&Ba.push("#define TERRAIN3D;");K&&Ba.push(K);R&&Ba.push(...R);z=Ba.concat(Ed.prelude.fragmentSource,G.fragmentSource,g.fragmentSource).join("\n");g=Ba.concat(Ed.prelude.vertexSource,G.vertexSource,g.vertexSource).join("\n");ua(X)||(z=z.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D("),g=g.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D("));G=X.createShader(X.FRAGMENT_SHADER);
if(X.isContextLost())return void(this.failedToCreate=!0);if(X.shaderSource(G,z),X.compileShader(G),!X.getShaderParameter(G,X.COMPILE_STATUS))throw Error(`Could not compile fragment shader: ${X.getShaderInfoLog(G)}`);X.attachShader(this.program,G);z=X.createShader(X.VERTEX_SHADER);if(X.isContextLost())return void(this.failedToCreate=!0);if(X.shaderSource(z,g),X.compileShader(z),!X.getShaderParameter(z,X.COMPILE_STATUS))throw Error(`Could not compile vertex shader: ${X.getShaderInfoLog(z)}`);X.attachShader(this.program,
z);this.attributes={};g={};this.numAttributes=ca.length;for(C=0;C<this.numAttributes;C++)ca[C]&&(X.bindAttribLocation(this.program,C,ca[C]),this.attributes[ca[C]]=C);if(X.linkProgram(this.program),!X.getProgramParameter(this.program,X.LINK_STATUS))throw Error(`Program failed to link: ${X.getProgramInfoLog(this.program)}`);X.deleteShader(z);X.deleteShader(G);for(ca=0;ca<ja.length;ca++)(G=ja[ca])&&!g[G]&&(z=X.getUniformLocation(this.program,G))&&(g[G]=z);this.fixedUniforms=u(b,g);this.terrainUniforms=
((za,Ea)=>({u_depth:new v.bQ(za,Ea.u_depth),u_terrain:new v.bQ(za,Ea.u_terrain),u_terrain_dim:new v.bg(za,Ea.u_terrain_dim),u_terrain_matrix:new v.bS(za,Ea.u_terrain_matrix),u_terrain_unpack:new v.bT(za,Ea.u_terrain_unpack),u_terrain_exaggeration:new v.bg(za,Ea.u_terrain_exaggeration)}))(b,g);this.projectionUniforms=((za,Ea)=>({u_projection_matrix:new v.bS(za,Ea.u_projection_matrix),u_projection_tile_mercator_coords:new v.bT(za,Ea.u_projection_tile_mercator_coords),u_projection_clipping_plane:new v.bT(za,
Ea.u_projection_clipping_plane),u_projection_transition:new v.bg(za,Ea.u_projection_transition),u_projection_fallback_matrix:new v.bS(za,Ea.u_projection_fallback_matrix)}))(b,g);this.binderUniforms=m?m.getUniforms(b,g):[]}draw(b,g,m,u,z,C,G,K,R,X,ca,ja,la,pa,ya,Ba,za,Ea,Qa){const Za=b.gl;if(!this.failedToCreate){if(b.program.set(this.program),b.setDepthMode(m),b.setStencilMode(u),b.setColorMode(z),b.setCullFace(C),K){b.activeTexture.set(Za.TEXTURE2);Za.bindTexture(Za.TEXTURE_2D,K.depthTexture);b.activeTexture.set(Za.TEXTURE3);
Za.bindTexture(Za.TEXTURE_2D,K.texture);for(const sb in this.terrainUniforms)this.terrainUniforms[sb].set(K[sb])}if(R)for(const sb in R)this.projectionUniforms[eh[sb]].set(R[sb]);if(G)for(const sb in this.fixedUniforms)this.fixedUniforms[sb].set(G[sb]);Ba&&Ba.setUniforms(b,this.binderUniforms,pa,{zoom:ya});m=0;switch(g){case Za.LINES:m=2;break;case Za.TRIANGLES:m=3;break;case Za.LINE_STRIP:m=1}for(const sb of la.get())la=sb.vaos||(sb.vaos={}),(la[X]||(la[X]=new Qe)).bind(b,this,ca,Ba?Ba.getPaintVertexBuffers():
[],ja,sb.vertexOffset,za,Ea,Qa),Za.drawElements(g,sb.primitiveLength*m,Za.UNSIGNED_SHORT,sb.primitiveOffset*m*2)}}}const fi=(b,g,m,u)=>{const z=b.style.light;var C=z.properties.get("position");C=[C.x,C.y,C.z];var G=v.bW();"viewport"===z.properties.get("anchor")&&v.bX(G,b.transform.bearingInRadians);v.bY(C,C,G);b=b.transform.transformLightDirection(C);G=z.properties.get("color");return{u_lightpos:C,u_lightpos_globe:b,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+g,
u_opacity:m,u_fill_translate:u}},yj=(b,g,m,u,z)=>{const C=b.transform;let G,K;var R=0;"map"===m.paint.get("circle-pitch-alignment")?(R=v.aC(g,1,C.zoom),G=!0,K=[R,R],R=R/(v.$*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*z):(G=!1,K=C.pixelsToGLUnits);return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+("map"===m.paint.get("circle-pitch-scale")),u_pitch_with_map:+G,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:K,u_globe_extrude_scale:R,u_translate:u}},$e=(b,g=1)=>({u_color:b,
u_overlay:0,u_overlay_scale:g}),Pg=(b,g,m,u)=>{u*=v.aC(b,1,g)/(v.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI;return{u_extrude_scale:v.aC(b,1,g),u_intensity:m,u_globe_extrude_scale:u}},Gi=(b,g,m,u)=>{const z=v.L();v.bZ(z,0,b.width,b.height,0,0,1);b=b.context.gl;return{u_matrix:z,u_world:[b.drawingBufferWidth,b.drawingBufferHeight],u_image:m,u_color_ramp:u,u_opacity:g.paint.get("heatmap-opacity")}},Hi=(b,g,m=0)=>({u_image:0,u_unpack:g.getUnpackVector(),u_dimension:[g.stride,g.stride],u_elevation_stops:1,
u_color_stops:4,u_color_ramp_size:m,u_opacity:b.paint.get("color-relief-opacity")}),eg=(b,g,m,u)=>{const z=b.transform;return{u_translation:Ag(b,g,m),u_ratio:u/v.aC(g,1,z.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]]}},gi=(b,g,m,u,z,C,G,K,R,X,ca,ja,la)=>{const pa=G.transform;return{u_is_size_zoom_constant:+("constant"===b||"source"===b),u_is_size_feature_constant:+("constant"===b||"camera"===b),u_size_t:g?g.uSizeT:0,u_size:g?g.uSize:0,u_camera_to_center_distance:pa.cameraToCenterDistance,
u_pitch:pa.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:pa.width/pa.height,u_fade_change:G.options.fadeDuration?G.symbolFadeChange:1,u_label_plane_matrix:K,u_coord_matrix:R,u_is_text:+ca,u_pitch_with_map:+u,u_is_along_line:z,u_is_variable_anchor:C,u_texsize:ja,u_texture:0,u_translation:X,u_pitched_scale:la}},hi=(b,g,m,u,z,C,G,K,R,X,ca,ja,la,pa)=>{la=G.transform;return v.e(gi(b,g,m,u,z,C,G,K,R,X,ca,ja,pa),{u_gamma_scale:u?Math.cos(la.pitch*Math.PI/180)*la.cameraToCenterDistance:1,u_device_pixel_ratio:G.pixelRatio,
u_is_halo:1})},zj=(b,g,m,u,z,C,G,K,R,X,ca,ja,la)=>v.e(hi(b,g,m,u,z,C,G,K,R,X,!0,ca,0,la),{u_texsize_icon:ja,u_texture_icon:1}),wh=(b,g)=>{},Wc={fillExtrusion:(b,g)=>({u_lightpos:new v.bU(b,g.u_lightpos),u_lightpos_globe:new v.bU(b,g.u_lightpos_globe),u_lightintensity:new v.bg(b,g.u_lightintensity),u_lightcolor:new v.bU(b,g.u_lightcolor),u_vertical_gradient:new v.bg(b,g.u_vertical_gradient),u_opacity:new v.bg(b,g.u_opacity),u_fill_translate:new v.bV(b,g.u_fill_translate)}),fillExtrusionPattern:(b,
g)=>({u_lightpos:new v.bU(b,g.u_lightpos),u_lightpos_globe:new v.bU(b,g.u_lightpos_globe),u_lightintensity:new v.bg(b,g.u_lightintensity),u_lightcolor:new v.bU(b,g.u_lightcolor),u_vertical_gradient:new v.bg(b,g.u_vertical_gradient),u_height_factor:new v.bg(b,g.u_height_factor),u_opacity:new v.bg(b,g.u_opacity),u_fill_translate:new v.bV(b,g.u_fill_translate),u_image:new v.bQ(b,g.u_image),u_texsize:new v.bV(b,g.u_texsize),u_pixel_coord_upper:new v.bV(b,g.u_pixel_coord_upper),u_pixel_coord_lower:new v.bV(b,
g.u_pixel_coord_lower),u_scale:new v.bU(b,g.u_scale),u_fade:new v.bg(b,g.u_fade)}),fill:(b,g)=>({u_fill_translate:new v.bV(b,g.u_fill_translate)}),fillPattern:(b,g)=>({u_image:new v.bQ(b,g.u_image),u_texsize:new v.bV(b,g.u_texsize),u_pixel_coord_upper:new v.bV(b,g.u_pixel_coord_upper),u_pixel_coord_lower:new v.bV(b,g.u_pixel_coord_lower),u_scale:new v.bU(b,g.u_scale),u_fade:new v.bg(b,g.u_fade),u_fill_translate:new v.bV(b,g.u_fill_translate)}),fillOutline:(b,g)=>({u_world:new v.bV(b,g.u_world),u_fill_translate:new v.bV(b,
g.u_fill_translate)}),fillOutlinePattern:(b,g)=>({u_world:new v.bV(b,g.u_world),u_image:new v.bQ(b,g.u_image),u_texsize:new v.bV(b,g.u_texsize),u_pixel_coord_upper:new v.bV(b,g.u_pixel_coord_upper),u_pixel_coord_lower:new v.bV(b,g.u_pixel_coord_lower),u_scale:new v.bU(b,g.u_scale),u_fade:new v.bg(b,g.u_fade),u_fill_translate:new v.bV(b,g.u_fill_translate)}),circle:(b,g)=>({u_camera_to_center_distance:new v.bg(b,g.u_camera_to_center_distance),u_scale_with_map:new v.bQ(b,g.u_scale_with_map),u_pitch_with_map:new v.bQ(b,
g.u_pitch_with_map),u_extrude_scale:new v.bV(b,g.u_extrude_scale),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_globe_extrude_scale:new v.bg(b,g.u_globe_extrude_scale),u_translate:new v.bV(b,g.u_translate)}),collisionBox:(b,g)=>({u_pixel_extrude_scale:new v.bV(b,g.u_pixel_extrude_scale)}),collisionCircle:(b,g)=>({u_viewport_size:new v.bV(b,g.u_viewport_size)}),debug:(b,g)=>({u_color:new v.bR(b,g.u_color),u_overlay:new v.bQ(b,g.u_overlay),u_overlay_scale:new v.bg(b,g.u_overlay_scale)}),
depth:wh,clippingMask:wh,heatmap:(b,g)=>({u_extrude_scale:new v.bg(b,g.u_extrude_scale),u_intensity:new v.bg(b,g.u_intensity),u_globe_extrude_scale:new v.bg(b,g.u_globe_extrude_scale)}),heatmapTexture:(b,g)=>({u_matrix:new v.bS(b,g.u_matrix),u_world:new v.bV(b,g.u_world),u_image:new v.bQ(b,g.u_image),u_color_ramp:new v.bQ(b,g.u_color_ramp),u_opacity:new v.bg(b,g.u_opacity)}),hillshade:(b,g)=>({u_image:new v.bQ(b,g.u_image),u_latrange:new v.bV(b,g.u_latrange),u_exaggeration:new v.bg(b,g.u_exaggeration),
u_altitudes:new v.b$(b,g.u_altitudes),u_azimuths:new v.b$(b,g.u_azimuths),u_accent:new v.bR(b,g.u_accent),u_method:new v.bQ(b,g.u_method),u_shadows:new v.b_(b,g.u_shadows),u_highlights:new v.b_(b,g.u_highlights)}),hillshadePrepare:(b,g)=>({u_matrix:new v.bS(b,g.u_matrix),u_image:new v.bQ(b,g.u_image),u_dimension:new v.bV(b,g.u_dimension),u_zoom:new v.bg(b,g.u_zoom),u_unpack:new v.bT(b,g.u_unpack)}),colorRelief:(b,g)=>({u_image:new v.bQ(b,g.u_image),u_unpack:new v.bT(b,g.u_unpack),u_dimension:new v.bV(b,
g.u_dimension),u_elevation_stops:new v.bQ(b,g.u_elevation_stops),u_color_stops:new v.bQ(b,g.u_color_stops),u_color_ramp_size:new v.bQ(b,g.u_color_ramp_size),u_opacity:new v.bg(b,g.u_opacity)}),line:(b,g)=>({u_translation:new v.bV(b,g.u_translation),u_ratio:new v.bg(b,g.u_ratio),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_units_to_pixels:new v.bV(b,g.u_units_to_pixels)}),lineGradient:(b,g)=>({u_translation:new v.bV(b,g.u_translation),u_ratio:new v.bg(b,g.u_ratio),u_device_pixel_ratio:new v.bg(b,
g.u_device_pixel_ratio),u_units_to_pixels:new v.bV(b,g.u_units_to_pixels),u_image:new v.bQ(b,g.u_image),u_image_height:new v.bg(b,g.u_image_height)}),linePattern:(b,g)=>({u_translation:new v.bV(b,g.u_translation),u_texsize:new v.bV(b,g.u_texsize),u_ratio:new v.bg(b,g.u_ratio),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_image:new v.bQ(b,g.u_image),u_units_to_pixels:new v.bV(b,g.u_units_to_pixels),u_scale:new v.bU(b,g.u_scale),u_fade:new v.bg(b,g.u_fade)}),lineSDF:(b,g)=>({u_translation:new v.bV(b,
g.u_translation),u_ratio:new v.bg(b,g.u_ratio),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_units_to_pixels:new v.bV(b,g.u_units_to_pixels),u_image:new v.bQ(b,g.u_image),u_mix:new v.bg(b,g.u_mix),u_tileratio:new v.bg(b,g.u_tileratio),u_crossfade_from:new v.bg(b,g.u_crossfade_from),u_crossfade_to:new v.bg(b,g.u_crossfade_to),u_lineatlas_width:new v.bg(b,g.u_lineatlas_width),u_lineatlas_height:new v.bg(b,g.u_lineatlas_height)}),lineGradientSDF:(b,g)=>({u_translation:new v.bV(b,g.u_translation),
u_ratio:new v.bg(b,g.u_ratio),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_units_to_pixels:new v.bV(b,g.u_units_to_pixels),u_image:new v.bQ(b,g.u_image),u_image_height:new v.bg(b,g.u_image_height),u_tileratio:new v.bg(b,g.u_tileratio),u_crossfade_from:new v.bg(b,g.u_crossfade_from),u_crossfade_to:new v.bg(b,g.u_crossfade_to),u_image_dash:new v.bQ(b,g.u_image_dash),u_mix:new v.bg(b,g.u_mix),u_lineatlas_width:new v.bg(b,g.u_lineatlas_width),u_lineatlas_height:new v.bg(b,g.u_lineatlas_height)}),
raster:(b,g)=>({u_tl_parent:new v.bV(b,g.u_tl_parent),u_scale_parent:new v.bg(b,g.u_scale_parent),u_buffer_scale:new v.bg(b,g.u_buffer_scale),u_fade_t:new v.bg(b,g.u_fade_t),u_opacity:new v.bg(b,g.u_opacity),u_image0:new v.bQ(b,g.u_image0),u_image1:new v.bQ(b,g.u_image1),u_brightness_low:new v.bg(b,g.u_brightness_low),u_brightness_high:new v.bg(b,g.u_brightness_high),u_saturation_factor:new v.bg(b,g.u_saturation_factor),u_contrast_factor:new v.bg(b,g.u_contrast_factor),u_spin_weights:new v.bU(b,g.u_spin_weights),
u_coords_top:new v.bT(b,g.u_coords_top),u_coords_bottom:new v.bT(b,g.u_coords_bottom)}),symbolIcon:(b,g)=>({u_is_size_zoom_constant:new v.bQ(b,g.u_is_size_zoom_constant),u_is_size_feature_constant:new v.bQ(b,g.u_is_size_feature_constant),u_size_t:new v.bg(b,g.u_size_t),u_size:new v.bg(b,g.u_size),u_camera_to_center_distance:new v.bg(b,g.u_camera_to_center_distance),u_pitch:new v.bg(b,g.u_pitch),u_rotate_symbol:new v.bQ(b,g.u_rotate_symbol),u_aspect_ratio:new v.bg(b,g.u_aspect_ratio),u_fade_change:new v.bg(b,
g.u_fade_change),u_label_plane_matrix:new v.bS(b,g.u_label_plane_matrix),u_coord_matrix:new v.bS(b,g.u_coord_matrix),u_is_text:new v.bQ(b,g.u_is_text),u_pitch_with_map:new v.bQ(b,g.u_pitch_with_map),u_is_along_line:new v.bQ(b,g.u_is_along_line),u_is_variable_anchor:new v.bQ(b,g.u_is_variable_anchor),u_texsize:new v.bV(b,g.u_texsize),u_texture:new v.bQ(b,g.u_texture),u_translation:new v.bV(b,g.u_translation),u_pitched_scale:new v.bg(b,g.u_pitched_scale)}),symbolSDF:(b,g)=>({u_is_size_zoom_constant:new v.bQ(b,
g.u_is_size_zoom_constant),u_is_size_feature_constant:new v.bQ(b,g.u_is_size_feature_constant),u_size_t:new v.bg(b,g.u_size_t),u_size:new v.bg(b,g.u_size),u_camera_to_center_distance:new v.bg(b,g.u_camera_to_center_distance),u_pitch:new v.bg(b,g.u_pitch),u_rotate_symbol:new v.bQ(b,g.u_rotate_symbol),u_aspect_ratio:new v.bg(b,g.u_aspect_ratio),u_fade_change:new v.bg(b,g.u_fade_change),u_label_plane_matrix:new v.bS(b,g.u_label_plane_matrix),u_coord_matrix:new v.bS(b,g.u_coord_matrix),u_is_text:new v.bQ(b,
g.u_is_text),u_pitch_with_map:new v.bQ(b,g.u_pitch_with_map),u_is_along_line:new v.bQ(b,g.u_is_along_line),u_is_variable_anchor:new v.bQ(b,g.u_is_variable_anchor),u_texsize:new v.bV(b,g.u_texsize),u_texture:new v.bQ(b,g.u_texture),u_gamma_scale:new v.bg(b,g.u_gamma_scale),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_is_halo:new v.bQ(b,g.u_is_halo),u_translation:new v.bV(b,g.u_translation),u_pitched_scale:new v.bg(b,g.u_pitched_scale)}),symbolTextAndIcon:(b,g)=>({u_is_size_zoom_constant:new v.bQ(b,
g.u_is_size_zoom_constant),u_is_size_feature_constant:new v.bQ(b,g.u_is_size_feature_constant),u_size_t:new v.bg(b,g.u_size_t),u_size:new v.bg(b,g.u_size),u_camera_to_center_distance:new v.bg(b,g.u_camera_to_center_distance),u_pitch:new v.bg(b,g.u_pitch),u_rotate_symbol:new v.bQ(b,g.u_rotate_symbol),u_aspect_ratio:new v.bg(b,g.u_aspect_ratio),u_fade_change:new v.bg(b,g.u_fade_change),u_label_plane_matrix:new v.bS(b,g.u_label_plane_matrix),u_coord_matrix:new v.bS(b,g.u_coord_matrix),u_is_text:new v.bQ(b,
g.u_is_text),u_pitch_with_map:new v.bQ(b,g.u_pitch_with_map),u_is_along_line:new v.bQ(b,g.u_is_along_line),u_is_variable_anchor:new v.bQ(b,g.u_is_variable_anchor),u_texsize:new v.bV(b,g.u_texsize),u_texsize_icon:new v.bV(b,g.u_texsize_icon),u_texture:new v.bQ(b,g.u_texture),u_texture_icon:new v.bQ(b,g.u_texture_icon),u_gamma_scale:new v.bg(b,g.u_gamma_scale),u_device_pixel_ratio:new v.bg(b,g.u_device_pixel_ratio),u_is_halo:new v.bQ(b,g.u_is_halo),u_translation:new v.bV(b,g.u_translation),u_pitched_scale:new v.bg(b,
g.u_pitched_scale)}),background:(b,g)=>({u_opacity:new v.bg(b,g.u_opacity),u_color:new v.bR(b,g.u_color)}),backgroundPattern:(b,g)=>({u_opacity:new v.bg(b,g.u_opacity),u_image:new v.bQ(b,g.u_image),u_pattern_tl_a:new v.bV(b,g.u_pattern_tl_a),u_pattern_br_a:new v.bV(b,g.u_pattern_br_a),u_pattern_tl_b:new v.bV(b,g.u_pattern_tl_b),u_pattern_br_b:new v.bV(b,g.u_pattern_br_b),u_texsize:new v.bV(b,g.u_texsize),u_mix:new v.bg(b,g.u_mix),u_pattern_size_a:new v.bV(b,g.u_pattern_size_a),u_pattern_size_b:new v.bV(b,
g.u_pattern_size_b),u_scale_a:new v.bg(b,g.u_scale_a),u_scale_b:new v.bg(b,g.u_scale_b),u_pixel_coord_upper:new v.bV(b,g.u_pixel_coord_upper),u_pixel_coord_lower:new v.bV(b,g.u_pixel_coord_lower),u_tile_units_to_pixels:new v.bg(b,g.u_tile_units_to_pixels)}),terrain:(b,g)=>({u_texture:new v.bQ(b,g.u_texture),u_ele_delta:new v.bg(b,g.u_ele_delta),u_fog_matrix:new v.bS(b,g.u_fog_matrix),u_fog_color:new v.bR(b,g.u_fog_color),u_fog_ground_blend:new v.bg(b,g.u_fog_ground_blend),u_fog_ground_blend_opacity:new v.bg(b,
g.u_fog_ground_blend_opacity),u_horizon_color:new v.bR(b,g.u_horizon_color),u_horizon_fog_blend:new v.bg(b,g.u_horizon_fog_blend),u_is_globe_mode:new v.bg(b,g.u_is_globe_mode)}),terrainDepth:(b,g)=>({u_ele_delta:new v.bg(b,g.u_ele_delta)}),terrainCoords:(b,g)=>({u_texture:new v.bQ(b,g.u_texture),u_terrain_coords_id:new v.bg(b,g.u_terrain_coords_id),u_ele_delta:new v.bg(b,g.u_ele_delta)}),projectionErrorMeasurement:(b,g)=>({u_input:new v.bg(b,g.u_input),u_output_expected:new v.bg(b,g.u_output_expected)}),
atmosphere:(b,g)=>({u_sun_pos:new v.bU(b,g.u_sun_pos),u_atmosphere_blend:new v.bg(b,g.u_atmosphere_blend),u_globe_position:new v.bU(b,g.u_globe_position),u_globe_radius:new v.bg(b,g.u_globe_radius),u_inv_proj_matrix:new v.bS(b,g.u_inv_proj_matrix)}),sky:(b,g)=>({u_sky_color:new v.bR(b,g.u_sky_color),u_horizon_color:new v.bR(b,g.u_horizon_color),u_horizon:new v.bV(b,g.u_horizon),u_horizon_normal:new v.bV(b,g.u_horizon_normal),u_sky_horizon_blend:new v.bg(b,g.u_sky_horizon_blend),u_sky_blend:new v.bg(b,
g.u_sky_blend)})};class xh{constructor(b,g,m){this.context=b;const u=b.gl;this.buffer=u.createBuffer();this.dynamicDraw=!!m;this.context.unbindVAO();b.bindElementBuffer.set(this.buffer);u.bufferData(u.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW);this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(b){const g=this.context.gl;if(!this.dynamicDraw)throw Error("Attempted to update data while not in dynamic mode.");
this.context.unbindVAO();this.bind();g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,b.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Re={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fj{constructor(b,g,m,u){this.length=g.length;this.attributes=m;this.itemSize=g.bytesPerElement;this.dynamicDraw=u;this.context=b;m=b.gl;this.buffer=m.createBuffer();b.bindVertexBuffer.set(this.buffer);
m.bufferData(m.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW);this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(b){if(b.length!==this.length)throw Error(`Length of new data is ${b.length}, which doesn't match current length of ${this.length}`);const g=this.context.gl;this.bind();g.bufferSubData(g.ARRAY_BUFFER,0,b.arrayBuffer)}enableAttributes(b,g){for(let m=0;m<this.attributes.length;m++){const u=g.attributes[this.attributes[m].name];
void 0!==u&&b.enableVertexAttribArray(u)}}setVertexAttribPointers(b,g,m){for(let u=0;u<this.attributes.length;u++){const z=this.attributes[u],C=g.attributes[z.name];void 0!==C&&b.vertexAttribPointer(C,z.components,b[Re[z.type]],!1,this.itemSize,z.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zd{constructor(b){this.gl=b.gl;this.current=this.default=this.getDefault();this.dirty=!1}get(){return this.current}set(b){}getDefault(){return this.default}setDefault(){this.set(this.default)}}
class lf extends zd{getDefault(){return v.bf.transparent}set(b){const g=this.current;(b.r!==g.r||b.g!==g.g||b.b!==g.b||b.a!==g.a||this.dirty)&&(this.gl.clearColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)}}class Ii extends zd{getDefault(){return 1}set(b){(b!==this.current||this.dirty)&&(this.gl.clearDepth(b),this.current=b,this.dirty=!1)}}class je extends zd{getDefault(){return 0}set(b){(b!==this.current||this.dirty)&&(this.gl.clearStencil(b),this.current=b,this.dirty=!1)}}class Zj extends zd{getDefault(){return[!0,
!0,!0,!0]}set(b){const g=this.current;(b[0]!==g[0]||b[1]!==g[1]||b[2]!==g[2]||b[3]!==g[3]||this.dirty)&&(this.gl.colorMask(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)}}class gj extends zd{getDefault(){return!0}set(b){(b!==this.current||this.dirty)&&(this.gl.depthMask(b),this.current=b,this.dirty=!1)}}class Qg extends zd{getDefault(){return 255}set(b){(b!==this.current||this.dirty)&&(this.gl.stencilMask(b),this.current=b,this.dirty=!1)}}class ke extends zd{getDefault(){return{func:this.gl.ALWAYS,
ref:0,mask:255}}set(b){const g=this.current;(b.func!==g.func||b.ref!==g.ref||b.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(b.func,b.ref,b.mask),this.current=b,this.dirty=!1)}}class Ji extends zd{getDefault(){const b=this.gl;return[b.KEEP,b.KEEP,b.KEEP]}set(b){const g=this.current;(b[0]!==g[0]||b[1]!==g[1]||b[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(b[0],b[1],b[2]),this.current=b,this.dirty=!1)}}class Nh extends zd{getDefault(){return!1}set(b){if(b!==this.current||this.dirty){var g=this.gl;
b?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST);this.current=b;this.dirty=!1}}}class fh extends zd{getDefault(){return[0,1]}set(b){const g=this.current;(b[0]!==g[0]||b[1]!==g[1]||this.dirty)&&(this.gl.depthRange(b[0],b[1]),this.current=b,this.dirty=!1)}}class Qf extends zd{getDefault(){return!1}set(b){if(b!==this.current||this.dirty){var g=this.gl;b?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST);this.current=b;this.dirty=!1}}}class Oh extends zd{getDefault(){return this.gl.LESS}set(b){(b!==this.current||
this.dirty)&&(this.gl.depthFunc(b),this.current=b,this.dirty=!1)}}class Ki extends zd{getDefault(){return!1}set(b){if(b!==this.current||this.dirty){var g=this.gl;b?g.enable(g.BLEND):g.disable(g.BLEND);this.current=b;this.dirty=!1}}}class Mi extends zd{getDefault(){const b=this.gl;return[b.ONE,b.ZERO]}set(b){const g=this.current;(b[0]!==g[0]||b[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(b[0],b[1]),this.current=b,this.dirty=!1)}}class hj extends zd{getDefault(){return v.bf.transparent}set(b){const g=
this.current;(b.r!==g.r||b.g!==g.g||b.b!==g.b||b.a!==g.a||this.dirty)&&(this.gl.blendColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)}}class Aj extends zd{getDefault(){return this.gl.FUNC_ADD}set(b){(b!==this.current||this.dirty)&&(this.gl.blendEquation(b),this.current=b,this.dirty=!1)}}class uf extends zd{getDefault(){return!1}set(b){if(b!==this.current||this.dirty){var g=this.gl;b?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE);this.current=b;this.dirty=!1}}}class Ph extends zd{getDefault(){return this.gl.BACK}set(b){(b!==
this.current||this.dirty)&&(this.gl.cullFace(b),this.current=b,this.dirty=!1)}}class Cj extends zd{getDefault(){return this.gl.CCW}set(b){(b!==this.current||this.dirty)&&(this.gl.frontFace(b),this.current=b,this.dirty=!1)}}class yh extends zd{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}}class Qh extends zd{getDefault(){return this.gl.TEXTURE0}set(b){(b!==this.current||this.dirty)&&(this.gl.activeTexture(b),this.current=b,this.dirty=
!1)}}class vg extends zd{getDefault(){const b=this.gl;return[0,0,b.drawingBufferWidth,b.drawingBufferHeight]}set(b){const g=this.current;(b[0]!==g[0]||b[1]!==g[1]||b[2]!==g[2]||b[3]!==g[3]||this.dirty)&&(this.gl.viewport(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)}}class Nd extends zd{getDefault(){return null}set(b){if(b!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,b);this.current=b;this.dirty=!1}}}class vf extends zd{getDefault(){return null}set(b){if(b!==this.current||
this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,b);this.current=b;this.dirty=!1}}}class wg extends zd{getDefault(){return null}set(b){if(b!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,b);this.current=b;this.dirty=!1}}}class Ni extends zd{getDefault(){return null}set(b){if(b!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,b);this.current=b;this.dirty=!1}}}class gg extends zd{getDefault(){return null}set(b){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,
b);this.current=b;this.dirty=!1}}class ii extends zd{getDefault(){return null}set(b){var g;if(b!==this.current||this.dirty){var m=this.gl;ua(m)?m.bindVertexArray(b):null===(g=m.getExtension("OES_vertex_array_object"))||void 0===g||g.bindVertexArrayOES(b);this.current=b;this.dirty=!1}}}class Sh extends zd{getDefault(){return 4}set(b){if(b!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,b);this.current=b;this.dirty=!1}}}class ak extends zd{getDefault(){return!1}set(b){if(b!==
this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b);this.current=b;this.dirty=!1}}}class Ek extends zd{getDefault(){return!1}set(b){if(b!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,b);this.current=b;this.dirty=!1}}}class Dj extends zd{constructor(b,g){super(b);this.context=b;this.parent=g}getDefault(){return null}}class bk extends Dj{setDirty(){this.dirty=!0}set(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);
var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,b,0);this.current=b;this.dirty=!1}}}class Gk extends Dj{set(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,b);this.current=b;this.dirty=!1}}}class t extends Dj{set(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,
g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,b);this.current=b;this.dirty=!1}}}class A{constructor(b,g,m,u,z){this.context=b;this.width=g;this.height=m;g=b.gl;m=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new bk(b,m),u)this.depthAttachment=z?new t(b,m):new Gk(b,m);else if(z)throw Error("Stencil cannot be set without depth");if(g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw Error("Framebuffer is not complete");}destroy(){const b=this.context.gl;var g=this.colorAttachment.get();
(g&&b.deleteTexture(g),this.depthAttachment)&&(g=this.depthAttachment.get())&&b.deleteRenderbuffer(g);b.deleteFramebuffer(this.framebuffer)}}class E{constructor(b){var g,m;if(this.gl=b,this.clearColor=new lf(this),this.clearDepth=new Ii(this),this.clearStencil=new je(this),this.colorMask=new Zj(this),this.depthMask=new gj(this),this.stencilMask=new Qg(this),this.stencilFunc=new ke(this),this.stencilOp=new Ji(this),this.stencilTest=new Nh(this),this.depthRange=new fh(this),this.depthTest=new Qf(this),
this.depthFunc=new Oh(this),this.blend=new Ki(this),this.blendFunc=new Mi(this),this.blendColor=new hj(this),this.blendEquation=new Aj(this),this.cullFace=new uf(this),this.cullFaceSide=new Ph(this),this.frontFace=new Cj(this),this.program=new yh(this),this.activeTexture=new Qh(this),this.viewport=new vg(this),this.bindFramebuffer=new Nd(this),this.bindRenderbuffer=new vf(this),this.bindTexture=new wg(this),this.bindVertexBuffer=new Ni(this),this.bindElementBuffer=new gg(this),this.bindVertexArray=
new ii(this),this.pixelStoreUnpack=new Sh(this),this.pixelStoreUnpackPremultiplyAlpha=new ak(this),this.pixelStoreUnpackFlipY=new Ek(this),this.extTextureFilterAnisotropic=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=b.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=
b.getParameter(b.MAX_TEXTURE_SIZE),ua(b)){this.HALF_FLOAT=b.HALF_FLOAT;const u=b.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(g=b.RGBA16F)&&void 0!==g?g:null==u?void 0:u.RGBA16F_EXT;this.RGB16F=null!==(m=b.RGB16F)&&void 0!==m?m:null==u?void 0:u.RGB16F_EXT;b.getExtension("EXT_color_buffer_float")}else b.getExtension("EXT_color_buffer_half_float"),b.getExtension("OES_texture_half_float_linear"),b=b.getExtension("OES_texture_half_float"),this.HALF_FLOAT=null==b?void 0:b.HALF_FLOAT_OES}setDefault(){this.unbindVAO();
this.clearColor.setDefault();this.clearDepth.setDefault();this.clearStencil.setDefault();this.colorMask.setDefault();this.depthMask.setDefault();this.stencilMask.setDefault();this.stencilFunc.setDefault();this.stencilOp.setDefault();this.stencilTest.setDefault();this.depthRange.setDefault();this.depthTest.setDefault();this.depthFunc.setDefault();this.blend.setDefault();this.blendFunc.setDefault();this.blendColor.setDefault();this.blendEquation.setDefault();this.cullFace.setDefault();this.cullFaceSide.setDefault();
this.frontFace.setDefault();this.program.setDefault();this.activeTexture.setDefault();this.bindFramebuffer.setDefault();this.pixelStoreUnpack.setDefault();this.pixelStoreUnpackPremultiplyAlpha.setDefault();this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0;this.clearDepth.dirty=!0;this.clearStencil.dirty=!0;this.colorMask.dirty=!0;this.depthMask.dirty=!0;this.stencilMask.dirty=!0;this.stencilFunc.dirty=!0;this.stencilOp.dirty=!0;this.stencilTest.dirty=!0;this.depthRange.dirty=
!0;this.depthTest.dirty=!0;this.depthFunc.dirty=!0;this.blend.dirty=!0;this.blendFunc.dirty=!0;this.blendColor.dirty=!0;this.blendEquation.dirty=!0;this.cullFace.dirty=!0;this.cullFaceSide.dirty=!0;this.frontFace.dirty=!0;this.program.dirty=!0;this.activeTexture.dirty=!0;this.viewport.dirty=!0;this.bindFramebuffer.dirty=!0;this.bindRenderbuffer.dirty=!0;this.bindTexture.dirty=!0;this.bindVertexBuffer.dirty=!0;this.bindElementBuffer.dirty=!0;this.bindVertexArray.dirty=!0;this.pixelStoreUnpack.dirty=
!0;this.pixelStoreUnpackPremultiplyAlpha.dirty=!0;this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(b,g){return new xh(this,b,g)}createVertexBuffer(b,g,m){return new fj(this,b,g,m)}createRenderbuffer(b,g,m){const u=this.gl,z=u.createRenderbuffer();return this.bindRenderbuffer.set(z),u.renderbufferStorage(u.RENDERBUFFER,b,g,m),this.bindRenderbuffer.set(null),z}createFramebuffer(b,g,m,u){return new A(this,b,g,m,u)}clear({color:b,depth:g,stencil:m}){const u=this.gl;let z=0;b&&(z|=u.COLOR_BUFFER_BIT,
this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0]));void 0!==g&&(z|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0));void 0!==m&&(z|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255));u.clear(z)}setCullFace(b){!1===b.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(b.mode),this.frontFace.set(b.frontFace))}setDepthMode(b){b.func!==this.gl.ALWAYS||b.mask?(this.depthTest.set(!0),this.depthFunc.set(b.func),
this.depthMask.set(b.mask),this.depthRange.set(b.range)):this.depthTest.set(!1)}setStencilMode(b){b.test.func!==this.gl.ALWAYS||b.mask?(this.stencilTest.set(!0),this.stencilMask.set(b.mask),this.stencilOp.set([b.fail,b.depthFail,b.pass]),this.stencilFunc.set({func:b.test.func,ref:b.ref,mask:b.test.mask})):this.stencilTest.set(!1)}setColorMode(b){v.bH(b.blendFunction,Md.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor));this.colorMask.set(b.mask)}createVertexArray(){var b;
return ua(this.gl)?this.gl.createVertexArray():null===(b=this.gl.getExtension("OES_vertex_array_object"))||void 0===b?void 0:b.createVertexArrayOES()}deleteVertexArray(b){var g;return ua(this.gl)?this.gl.deleteVertexArray(b):null===(g=this.gl.getExtension("OES_vertex_array_object"))||void 0===g?void 0:g.deleteVertexArrayOES(b)}unbindVAO(){this.bindVertexArray.set(null)}}let N;const U=v.ag(new Float32Array(16)),ea=[new v.P(0,0),new v.P(v.$,0),new v.P(v.$,v.$),new v.P(0,v.$)],ia=new v.bf(1,0,0,1),va=
new v.bf(0,1,0,1),Ga=new v.bf(0,0,1,1),Sa=new v.bf(1,0,1,1),ab=new v.bf(0,1,1,1);class Qb{constructor(b,g){this.context=new E(b);this.transform=g;this._tileTextures={};this.terrainFacilitator={dirty:!0,matrix:v.ag(new Float64Array(16)),renderTime:0};this.setup();this.numSublayers=Od.maxUnderzooming+Od.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.crossTileSymbolIndex=new kf}resize(b,g,m){if(this.width=Math.floor(b*m),this.height=Math.floor(g*m),this.pixelRatio=m,this.context.viewport.set([0,
0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){var b=this.context,g=new v.aL;g.emplaceBack(0,0);g.emplaceBack(v.$,0);g.emplaceBack(0,v.$);g.emplaceBack(v.$,v.$);this.tileExtentBuffer=b.createVertexBuffer(g,He.members);this.tileExtentSegments=v.aM.simpleSegment(0,0,4,2);g=new v.aL;g.emplaceBack(0,0);g.emplaceBack(v.$,0);g.emplaceBack(0,v.$);g.emplaceBack(v.$,v.$);this.debugBuffer=b.createVertexBuffer(g,He.members);this.debugSegments=v.aM.simpleSegment(0,
0,4,5);g=new v.c7;g.emplaceBack(0,0,0,0);g.emplaceBack(v.$,0,v.$,0);g.emplaceBack(0,v.$,0,v.$);g.emplaceBack(v.$,v.$,v.$,v.$);this.rasterBoundsBuffer=b.createVertexBuffer(g,Ng.members);this.rasterBoundsSegments=v.aM.simpleSegment(0,0,4,2);g=new v.aL;g.emplaceBack(0,0);g.emplaceBack(v.$,0);g.emplaceBack(0,v.$);g.emplaceBack(v.$,v.$);this.rasterBoundsBufferPosOnly=b.createVertexBuffer(g,He.members);this.rasterBoundsSegmentsPosOnly=v.aM.simpleSegment(0,0,4,5);g=new v.aL;g.emplaceBack(0,0);g.emplaceBack(1,
0);g.emplaceBack(0,1);g.emplaceBack(1,1);this.viewportBuffer=b.createVertexBuffer(g,He.members);this.viewportSegments=v.aM.simpleSegment(0,0,4,2);g=new v.c8;g.emplaceBack(0);g.emplaceBack(1);g.emplaceBack(3);g.emplaceBack(2);g.emplaceBack(0);this.tileBorderIndexBuffer=b.createIndexBuffer(g);g=new v.aN;g.emplaceBack(1,0,2);g.emplaceBack(1,2,3);this.quadTriangleIndexBuffer=b.createIndexBuffer(g);b=this.context.gl;this.stencilClearMode=new Jd({func:b.ALWAYS,mask:0},0,255,b.ZERO,b.ZERO,b.ZERO);this.tileExtentMesh=
new sg(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const b=this.context,g=b.gl;this.nextStencilID=1;this.currentStencilSource=void 0;var m=v.L();v.bZ(m,0,this.width,this.height,0,0,1);v.N(m,m,[g.drawingBufferWidth,g.drawingBufferHeight,0]);m={mainMatrix:m,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:m};this.useProgram("clippingMask",null,!0).draw(b,g.TRIANGLES,ed.disabled,this.stencilClearMode,Md.disabled,
dd.disabled,null,null,m,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(b,g,m){if(this.currentStencilSource!==b.source&&b.isTileClipped()&&g&&g.length){this.currentStencilSource=b.source;256<this.nextStencilID+g.length&&this.clearStencil();b=this.context;b.setColorMode(Md.disabled);b.setDepthMode(ed.disabled);b={};for(const u of g)b[u.key]=this.nextStencilID++;this._renderTileMasks(b,g,m,!0);this._renderTileMasks(b,g,m,!1);this._tileClippingMaskIDs=
b}}_renderTileMasks(b,g,m,u){const z=this.context,C=z.gl,G=this.style.projection,K=this.transform,R=this.useProgram("clippingMask");for(const X of g){g=b[X.key];const ca=this.style.map.terrain&&this.style.map.terrain.getTerrainData(X),ja=G.getMeshFromTileID(this.context,X.canonical,u,!0,"stencil"),la=K.getProjectionData({overscaledTileID:X,applyGlobeMatrix:!m,applyTerrainMatrix:!0});R.draw(z,C.TRIANGLES,ed.disabled,new Jd({func:C.ALWAYS,mask:0},g,255,C.KEEP,C.KEEP,C.REPLACE),Md.disabled,m?dd.disabled:
dd.backCCW,null,ca,la,"$clipping",ja.vertexBuffer,ja.indexBuffer,ja.segments)}}_renderTilesDepthBuffer(){const b=this.context,g=b.gl,m=this.style.projection,u=this.transform,z=this.useProgram("depth"),C=this.getDepthModeFor3D();var G=Nc(u,{tileSize:u.tileSize});for(const K of G){G=this.style.map.terrain&&this.style.map.terrain.getTerrainData(K);const R=m.getMeshFromTileID(this.context,K.canonical,!0,!0,"raster"),X=u.getProjectionData({overscaledTileID:K,applyGlobeMatrix:!0,applyTerrainMatrix:!0});
z.draw(b,g.TRIANGLES,C,Jd.disabled,Md.disabled,dd.backCCW,null,G,X,"$clipping",R.vertexBuffer,R.indexBuffer,R.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0;256<this.nextStencilID+1&&this.clearStencil();const b=this.nextStencilID++,g=this.context.gl;return new Jd({func:g.NOTEQUAL,mask:255},b,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(b){const g=this.context.gl;return new Jd({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[b.key],0,g.KEEP,g.KEEP,g.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(b){const g=
this.context.gl;b=b.sort((z,C)=>C.overscaledZ-z.overscaledZ);const m=b[b.length-1].overscaledZ,u=b[0].overscaledZ-m+1;if(1<u){this.currentStencilSource=void 0;256<this.nextStencilID+u&&this.clearStencil();const z={};for(let C=0;C<u;C++)z[C+m]=new Jd({func:g.GEQUAL,mask:255},C+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=u,[z,b]}return[{[m]:Jd.disabled},b]}stencilConfigForOverlapTwoPass(b){const g=this.context.gl;b=b.sort((z,C)=>C.overscaledZ-z.overscaledZ);const m=b[b.length-
1].overscaledZ,u=b[0].overscaledZ-m+1;if(this.clearStencil(),1<u){const z={},C={};for(let G=0;G<u;G++)z[G+m]=new Jd({func:g.GREATER,mask:255},u+1+G,255,g.KEEP,g.KEEP,g.REPLACE),C[G+m]=new Jd({func:g.GREATER,mask:255},1+G,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID=2*u+1,[z,C,b]}return this.nextStencilID=3,[{[m]:new Jd({func:g.GREATER,mask:255},2,255,g.KEEP,g.KEEP,g.REPLACE)},{[m]:new Jd({func:g.GREATER,mask:255},1,255,g.KEEP,g.KEEP,g.REPLACE)},b]}colorModeForRenderPass(){const b=this.context.gl;
return this._showOverdrawInspector?new Md([b.CONSTANT_COLOR,b.ONE],new v.bf(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Md.unblended:Md.alphaBlended}getDepthModeForSublayer(b,g,m){if(!this.opaquePassEnabledForLayer())return ed.disabled;b=1-((1+this.currentLayer)*this.numSublayers+b)*this.depthEpsilon;return new ed(m||this.context.gl.LEQUAL,g,[b,b])}getDepthModeFor3D(){return new ed(this.context.gl.LEQUAL,ed.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<
this.opaquePassCutoff}render(b,g){var m,u;this.style=b;this.options=g;this.lineAtlas=b.lineAtlas;this.imageManager=b.imageManager;this.glyphManager=b.glyphManager;this.symbolFadeChange=b.placement.symbolFadeChange(qd.now());this.imageManager.beginFrame();var z=this.style._order;const C=this.style.sourceCaches,G={},K={},R={},X={isRenderingToTexture:!1,isRenderingGlobe:0<(null===(m=b.projection)||void 0===m?void 0:m.transitionState)};for(var ca in C)m=C[ca],m.used&&m.prepare(this.context),G[ca]=m.getVisibleCoordinates(!1),
K[ca]=G[ca].slice().reverse(),R[ca]=m.getVisibleCoordinates(!0).reverse();this.opaquePassCutoff=1/0;for(ca=0;ca<z.length;ca++)if(this.style._layers[z[ca]].is3D()){this.opaquePassCutoff=ca;break}this.maybeDrawDepthAndCoords(!1);this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0);this.renderPass="offscreen";for(var ja of z)ca=this.style._layers[ja],ca.hasOffscreenPass()&&!ca.isHidden(this.transform.zoom)&&(m=K[ca.source],("custom"===
ca.type||m.length)&&this.renderLayer(this,C[ca.source],ca,m,X));if(null===(u=this.style.projection)||void 0===u||u.updateGPUdependent({context:this.context,useProgram:la=>this.useProgram(la)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?v.bf.black:v.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(la,pa){const ya=la.context,Ba=ya.gl;var za=la.style.map.transform;var Ea=la.pixelRatio,
Qa=Math.cos(za.rollInRadians),Za=Math.sin(za.rollInRadians);const sb=Hc(za),ob=za.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;za={u_sky_color:pa.properties.get("sky-color"),u_horizon_color:pa.properties.get("horizon-color"),u_horizon:[(za.width/2-sb*Za)*Ea,(za.height/2+sb*Qa)*Ea],u_horizon_normal:[-Za,Qa],u_sky_horizon_blend:pa.properties.get("sky-horizon-blend")*za.height/2*Ea,u_sky_blend:ob};Ea=new ed(Ba.LEQUAL,ed.ReadWrite,[0,1]);Qa=
Jd.disabled;Za=la.colorModeForRenderPass();la=la.useProgram("sky");pa=Xg(ya,pa);la.draw(ya,Ba.TRIANGLES,Ea,Qa,Za,dd.disabled,za,null,void 0,"sky",pa.vertexBuffer,pa.indexBuffer,pa.segments)}(this,this.style.sky),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(b._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=z.length-1;0<=this.currentLayer;this.currentLayer--)b=this.style._layers[z[this.currentLayer]],
g=C[b.source],u=G[b.source],this._renderTileClippingMasks(b,u,!1),this.renderLayer(this,g,b,u,X);this.renderPass="translucent";b=!1;for(this.currentLayer=0;this.currentLayer<z.length;this.currentLayer++)g=this.style._layers[z[this.currentLayer]],u=C[g.source],this.renderToTexture&&this.renderToTexture.renderLayer(g,X)||(this.opaquePassEnabledForLayer()||b||(b=!0,X.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer()),ja=("symbol"===g.type?R:K)[g.source],this._renderTileClippingMasks(g,
G[g.source],!!this.renderToTexture),this.renderLayer(this,u,g,ja,X));(X.isRenderingGlobe&&function(la,pa,ya){const Ba=la.context,za=Ba.gl,Ea=la.useProgram("atmosphere"),Qa=new ed(za.LEQUAL,ed.ReadOnly,[0,1]);var Za=la.transform;la=function(Db,Nb){var Ob=Db.properties.get("position");Ob=[-Ob.x,-Ob.y,-Ob.z];const Jb=v.ag(new Float64Array(16));return"map"===Db.properties.get("anchor")&&(v.b6(Jb,Jb,Nb.rollInRadians),v.b7(Jb,Jb,-Nb.pitchInRadians),v.b6(Jb,Jb,Nb.bearingInRadians),v.b7(Jb,Jb,Nb.center.lat*
Math.PI/180),v.bz(Jb,Jb,-Nb.center.lng*Math.PI/180)),v.c6(Ob,Ob,Jb),Ob}(ya,la.transform);ya=Za.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0});ya=pa.properties.get("atmosphere-blend")*ya.projectionTransition;if(0!==ya){var sb=Rb(Za.worldSize,Za.center.lat),ob=Za.inverseProjectionMatrix,eb=new Float64Array(4);eb[3]=1;v.aw(eb,eb,Za.modelViewProjectionMatrix);eb[0]/=eb[3];eb[1]/=eb[3];eb[2]/=eb[3];eb[3]=1;v.aw(eb,eb,ob);eb[0]/=eb[3];eb[1]/=eb[3];eb[2]/=eb[3];eb[3]=
1;Za=((Db,Nb,Ob,Jb,$b)=>({u_sun_pos:Db,u_atmosphere_blend:Nb,u_globe_position:Ob,u_globe_radius:Jb,u_inv_proj_matrix:$b}))(la,ya,[eb[0],eb[1],eb[2]],sb,ob);pa=Xg(Ba,pa);Ea.draw(Ba,za.TRIANGLES,Qa,Jd.disabled,Md.alphaBlended,dd.disabled,Za,null,null,"atmosphere",pa.vertexBuffer,pa.indexBuffer,pa.segments)}}(this,this.style.sky,this.style.light),this.options.showTileBoundaries)&&(z=function(la,pa){let ya=null;var Ba=Object.values(la._layers).flatMap(Ea=>Ea.source&&!Ea.isHidden(pa)?[la.sourceCaches[Ea.source]]:
[]);const za=Ba.filter(Ea=>"vector"===Ea.getSource().type);Ba=Ba.filter(Ea=>"vector"!==Ea.getSource().type);return za.forEach(Ea=>{(!ya||ya.getSource().maxzoom<Ea.getSource().maxzoom)&&(ya=Ea)}),ya||Ba.forEach(Ea=>{(!ya||ya.getSource().maxzoom<Ea.getSource().maxzoom)&&(ya=Ea)}),ya}(this.style,this.transform.zoom))&&function(la,pa,ya){for(let sb=0;sb<ya.length;sb++){var Ba=la,za=pa,Ea=ya[sb];const ob=Ba.context,eb=ob.gl,Db=Ba.useProgram("debug"),Nb=ed.disabled,Ob=Jd.disabled,Jb=Ba.colorModeForRenderPass(),
$b=Ba.style.map.terrain&&Ba.style.map.terrain.getTerrainData(Ea);ob.activeTexture.set(eb.TEXTURE0);var Qa=za.getTileByID(Ea.key).latestRawTileData;Qa=Math.floor((Qa&&Qa.byteLength||0)/1024);za=za.getTile(Ea).tileSize;za=512/Math.min(za,512)*(Ea.overscaledZ/Ba.transform.zoom)*.5;var Za=Ea.canonical.toString();Ea.overscaledZ!==Ea.canonical.z&&(Za+=` => ${Ea.overscaledZ}`);Qa=`${Za} ${Qa}kB`;Ba.initDebugOverlayCanvas();Za=Ba.debugOverlayCanvas;const vc=Ba.context.gl,Bb=Ba.debugOverlayCanvas.getContext("2d");
Bb.clearRect(0,0,Za.width,Za.height);Bb.shadowColor="white";Bb.shadowBlur=2;Bb.lineWidth=1.5;Bb.strokeStyle="white";Bb.textBaseline="top";Bb.font="bold 36px Open Sans, sans-serif";Bb.fillText(Qa,5,5);Bb.strokeText(Qa,5,5);Ba.debugOverlayTexture.update(Za);Ba.debugOverlayTexture.bind(vc.LINEAR,vc.CLAMP_TO_EDGE);Ea=Ba.transform.getProjectionData({overscaledTileID:Ea,applyGlobeMatrix:!0,applyTerrainMatrix:!0});Db.draw(ob,eb.TRIANGLES,Nb,Ob,Md.alphaBlended,dd.disabled,$e(v.bf.transparent,za),null,Ea,
"$debug",Ba.debugBuffer,Ba.quadTriangleIndexBuffer,Ba.debugSegments);Db.draw(ob,eb.LINE_STRIP,Nb,Ob,Jb,dd.disabled,$e(v.bf.red),$b,Ea,"$debug",Ba.debugBuffer,Ba.tileBorderIndexBuffer,Ba.debugSegments)}}(this,z,z.getVisibleCoordinates());this.options.showPadding&&function(la){var pa=la.transform.padding;oh(la,0,la.transform.height-(pa.top||0)+1.5,la.transform.width,3,ia);oh(la,0,(pa.bottom||0)+1.5,la.transform.width,3,va);oh(la,(pa.left||0)-1.5,0,3,la.transform.height,Ga);oh(la,la.transform.width-
(pa.right||0)-1.5,0,3,la.transform.height,Sa);var ya=la.transform.centerPoint;pa=ya.x;ya=la.transform.height-ya.y;oh(la,pa-1,ya-10,2,20,ab);oh(la,pa-10,ya-1,20,2,ab);!0}(this);this.context.setDefault()}maybeDrawDepthAndCoords(b){if(this.style&&this.style.map&&this.style.map.terrain){var g=this.terrainFacilitator.matrix,m=this.transform.modelViewProjectionMatrix,u=this.terrainFacilitator.dirty;u||(u=b?!v.c9(g,m):!v.ca(g,m));u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime));
u&&(v.cb(g,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(z,C){const G=z.context,K=G.gl,R=z.transform,X=Md.unblended,ca=new ed(K.LEQUAL,ed.ReadWrite,[0,1]);var ja=C.sourceCache.getRenderableTiles();const la=z.useProgram("terrainDepth");G.bindFramebuffer.set(C.getFramebuffer("depth").framebuffer);G.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]);G.clear({color:v.bf.transparent,depth:1});for(const pa of ja){ja=C.getTerrainMesh(pa.tileID);
const ya=C.getTerrainData(pa.tileID),Ba=R.getProjectionData({overscaledTileID:pa.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),za={u_ele_delta:C.getMeshFrameDelta(R.zoom)};la.draw(G,K.TRIANGLES,ca,Jd.disabled,X,dd.backCCW,za,ya,Ba,"terrain",ja.vertexBuffer,ja.indexBuffer,ja.segments)}G.bindFramebuffer.set(null);G.viewport.set([0,0,z.width,z.height])}(this,this.style.map.terrain),function(z,C){const G=z.context,K=G.gl,R=z.transform,X=Md.unblended,ca=new ed(K.LEQUAL,ed.ReadWrite,[0,1]),ja=C.getCoordsTexture();
var la=C.sourceCache.getRenderableTiles();const pa=z.useProgram("terrainCoords");G.bindFramebuffer.set(C.getFramebuffer("coords").framebuffer);G.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]);G.clear({color:v.bf.transparent,depth:1});C.coordsIndex=[];for(const ya of la){la=C.getTerrainMesh(ya.tileID);const Ba=C.getTerrainData(ya.tileID);G.activeTexture.set(K.TEXTURE0);K.bindTexture(K.TEXTURE_2D,ja.texture);const za={u_terrain_coords_id:(255-C.coordsIndex.length)/255,u_texture:0,
u_ele_delta:C.getMeshFrameDelta(R.zoom)},Ea=R.getProjectionData({overscaledTileID:ya.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});pa.draw(G,K.TRIANGLES,ca,Jd.disabled,X,dd.backCCW,za,Ba,Ea,"terrain",la.vertexBuffer,la.indexBuffer,la.segments);C.coordsIndex.push(ya.tileID.key)}G.bindFramebuffer.set(null);G.viewport.set([0,0,z.width,z.height])}(this,this.style.map.terrain))}}renderLayer(b,g,m,u,z){m.isHidden(this.transform.zoom)||("background"===m.type||"custom"===m.type||(u||[]).length)&&(this.id=
m.id,v.cc(m)?function(C,G,K,R,X,ca){if("translucent"===C.renderPass){({isRenderingToTexture:ca}=ca);var ja=Jd.disabled,la=C.colorModeForRenderPass();(K._unevaluatedLayout.hasValue("text-variable-anchor")||K._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(pa,ya,Ba,za,Ea,Qa,Za,sb,ob){const eb=ya.transform,Db=ya.style.map.terrain;Ea="map"===Ea;Qa="map"===Qa;for(const Ob of pa){pa=za.getTile(Ob);const Jb=pa.getBucket(Ba);if(!Jb||!Jb.text||!Jb.text.segments.get().length)continue;
const $b=v.an(Jb.textSizeData,eb.zoom);var Nb=v.aC(pa,1,ya.transform.zoom);Nb=Kb(Ea,ya.transform,Nb);const vc="none"!==Ba.layout.get("icon-text-fit")&&Jb.hasIconData();if($b){const Bb=Db?(Yc,md)=>Db.getElevation(Ob,Yc,md):null;qi(Jb,Ea,Qa,ob,eb,Nb,Math.pow(2,eb.zoom-pa.tileID.overscaledZ),$b,vc,v.aD(eb,pa,Za,sb),Ob.toUnwrapped(),Bb)}}}(R,C,K,G,K.layout.get("text-rotation-alignment"),K.layout.get("text-pitch-alignment"),K.paint.get("text-translate"),K.paint.get("text-translate-anchor"),X);0!==K.paint.get("icon-opacity").constantOr(1)&&
re(C,G,K,R,!1,K.paint.get("icon-translate"),K.paint.get("icon-translate-anchor"),K.layout.get("icon-rotation-alignment"),K.layout.get("icon-pitch-alignment"),K.layout.get("icon-keep-upright"),ja,la,ca);0!==K.paint.get("text-opacity").constantOr(1)&&re(C,G,K,R,!0,K.paint.get("text-translate"),K.paint.get("text-translate-anchor"),K.layout.get("text-rotation-alignment"),K.layout.get("text-pitch-alignment"),K.layout.get("text-keep-upright"),ja,la,ca);G.map.showCollisionBoxes&&(Vi(C,G,K,R,!0),Vi(C,G,K,
R,!1))}}(b,g,m,u,this.style.placement.variableOffsets,z):v.cd(m)?function(C,G,K,R,X){if("translucent"===C.renderPass){({isRenderingToTexture:X}=X);var ca=K.paint.get("circle-opacity"),ja=K.paint.get("circle-stroke-width"),la=K.paint.get("circle-stroke-opacity"),pa=!K.layout.get("circle-sort-key").isConstant();if(0!==ca.constantOr(1)||0!==ja.constantOr(1)&&0!==la.constantOr(1)){ca=C.context;ja=ca.gl;la=C.transform;var ya=C.getDepthModeForSublayer(0,ed.ReadOnly),Ba=Jd.disabled,za=C.colorModeForRenderPass(),
Ea=[],Qa=la.getCircleRadiusCorrection();for(let Db=0;Db<R.length;Db++){var Za=R[Db];const Nb=G.getTile(Za);var sb=Nb.getBucket(K);if(!sb)continue;var ob=K.paint.get("circle-translate"),eb=K.paint.get("circle-translate-anchor");ob=v.aD(la,Nb,ob,eb);eb=sb.programConfigurations.get(K.id);const Ob=C.useProgram("circle",eb),Jb=sb.layoutVertexBuffer,$b=sb.indexBuffer,vc=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Za);Za={programConfiguration:eb,program:Ob,layoutVertexBuffer:Jb,indexBuffer:$b,
uniformValues:yj(C,Nb,K,ob,Qa),terrainData:vc,projectionData:la.getProjectionData({overscaledTileID:Za,applyGlobeMatrix:!X,applyTerrainMatrix:!0})};if(pa){sb=sb.segments.get();for(const Bb of sb)Ea.push({segments:new v.aM([Bb]),sortKey:Bb.sortKey,state:Za})}else Ea.push({segments:sb.segments,sortKey:0,state:Za})}pa&&Ea.sort((Db,Nb)=>Db.sortKey-Nb.sortKey);for(const Db of Ea){const {programConfiguration:Nb,program:Ob,layoutVertexBuffer:Jb,indexBuffer:$b,uniformValues:vc,terrainData:Bb,projectionData:Yc}=
Db.state;Ob.draw(ca,ja.TRIANGLES,ya,Ba,za,dd.backCCW,vc,Bb,Yc,K.id,Jb,$b,Db.segments,K.paint,C.transform.zoom,Nb)}}}}(b,g,m,u,z):v.ce(m)?function(C,G,K,R,X){if(0!==K.paint.get("heatmap-opacity")){var ca=C.context,{isRenderingToTexture:ja,isRenderingGlobe:la}=X;if(C.style.map.terrain){for(const pa of R)R=G.getTile(pa),G.hasRenderableParent(pa)||("offscreen"===C.renderPass?ok(C,R,K,pa,la):"translucent"===C.renderPass&&Nj(C,K,pa,ja,la));ca.viewport.set([0,0,C.width,C.height])}else"offscreen"===C.renderPass?
function(pa,ya,Ba,za){const Ea=pa.context,Qa=Ea.gl,Za=pa.transform,sb=Jd.disabled,ob=new Md([Qa.ONE,Qa.ONE],v.bf.transparent,[!0,!0,!0,!0]);var eb=Ea.gl;Ea.activeTexture.set(eb.TEXTURE1);Ea.viewport.set([0,0,pa.width/4,pa.height/4]);var Db=Ba.heatmapFbos.get(v.c3);Db?(eb.bindTexture(eb.TEXTURE_2D,Db.colorAttachment.get()),Ea.bindFramebuffer.set(Db.framebuffer)):(Db=qj(Ea,pa.width/4,pa.height/4),Ba.heatmapFbos.set(v.c3,Db));Ea.clear({color:v.bf.transparent});for(eb=0;eb<za.length;eb++){var Nb=za[eb];
if(ya.hasRenderableParent(Nb))continue;Db=ya.getTile(Nb);const Ob=Db.getBucket(Ba);if(!Ob)continue;const Jb=Ob.programConfigurations.get(Ba.id),$b=pa.useProgram("heatmap",Jb);Nb=Za.getProjectionData({overscaledTileID:Nb,applyGlobeMatrix:!0,applyTerrainMatrix:!1});const vc=Za.getCircleRadiusCorrection();$b.draw(Ea,Qa.TRIANGLES,ed.disabled,sb,ob,dd.backCCW,Pg(Db,Za.zoom,Ba.paint.get("heatmap-intensity"),vc),null,Nb,Ba.id,Ob.layoutVertexBuffer,Ob.indexBuffer,Ob.segments,Ba.paint,Za.zoom,Jb)}Ea.viewport.set([0,
0,pa.width,pa.height])}(C,G,K,R):"translucent"===C.renderPass&&function(pa,ya){const Ba=pa.context,za=Ba.gl;Ba.setColorMode(pa.colorModeForRenderPass());const Ea=ya.heatmapFbos.get(v.c3);Ea&&(Ba.activeTexture.set(za.TEXTURE0),za.bindTexture(za.TEXTURE_2D,Ea.colorAttachment.get()),Ba.activeTexture.set(za.TEXTURE1),Ui(Ba,ya).bind(za.LINEAR,za.CLAMP_TO_EDGE),pa.useProgram("heatmapTexture").draw(Ba,za.TRIANGLES,ed.disabled,Jd.disabled,pa.colorModeForRenderPass(),dd.disabled,Gi(pa,ya,0,1),null,null,ya.id,
pa.viewportBuffer,pa.quadTriangleIndexBuffer,pa.viewportSegments,ya.paint,pa.transform.zoom))}(C,K)}}(b,g,m,u,z):v.cf(m)?function(C,G,K,R,X){if("translucent"===C.renderPass){({isRenderingToTexture:X}=X);var ca=K.paint.get("line-opacity"),ja=K.paint.get("line-width");if(0!==ca.constantOr(1)&&0!==ja.constantOr(1)){ca=C.getDepthModeForSublayer(0,ed.ReadOnly);ja=C.colorModeForRenderPass();var la=K.paint.get("line-dasharray"),pa=la.constantOr(1),ya=K.paint.get("line-pattern"),Ba=ya.constantOr(1),za=K.paint.get("line-gradient"),
Ea=K.getCrossfadeParameters();var Qa=Ba?"linePattern":pa&&za?"lineGradientSDF":pa?"lineSDF":za?"lineGradient":"line";var Za=C.context,sb=Za.gl,ob=C.transform,eb=!0;for(const Bd of R){var Db=G.getTile(Bd);if(Ba&&!Db.patternsLoaded())continue;R=Db.getBucket(K);if(!R)continue;const fd=R.programConfigurations.get(K.id);var Nb=C.context.program.get();const ud=C.useProgram(Qa,fd);var Ob=eb||ud.program!==Nb;eb=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Bd);Nb=ya.constantOr(null);var Jb=la&&
la.constantOr(null);if(Nb&&Db.imageAtlas){var $b=Db.imageAtlas;Jb=$b.patternPositions[Nb.to.toString()];Nb=$b.patternPositions[Nb.from.toString()];Jb&&Nb&&fd.setConstantPatternPositions(Jb,Nb)}else Jb&&($b="round"===K.layout.get("line-cap"),Nb=C.lineAtlas.getDash(Jb.to,$b),Jb=C.lineAtlas.getDash(Jb.from,$b),fd.setConstantDashPositions(Nb,Jb));Nb=ob.getProjectionData({overscaledTileID:Bd,applyGlobeMatrix:!X,applyTerrainMatrix:!0});Jb=ob.getPixelScale();if(Ba){Ob=C;$b=Db;var vc=K,Bb=Ob.transform,Yc=
1/v.aC($b,1,Bb.tileZoom);Jb={u_translation:Ag(Ob,$b,vc),u_texsize:$b.imageAtlasTexture.size,u_ratio:Jb/v.aC($b,1,Bb.zoom),u_device_pixel_ratio:Ob.pixelRatio,u_image:0,u_scale:[Yc,Ea.fromScale,Ea.toScale],u_fade:Ea.t,u_units_to_pixels:[1/Bb.pixelsToGLUnits[0],1/Bb.pixelsToGLUnits[1]]};Za.activeTexture.set(sb.TEXTURE0);Db.imageAtlasTexture.bind(sb.LINEAR,sb.CLAMP_TO_EDGE);fd.updatePaintBuffers(Ea)}else if(pa&&za){Ob=C;$b=K;vc=Ea;Bb=R.lineClipsArray.length;Yc=1/v.aC(Db,1,Ob.transform.tileZoom);Jb=v.e(eg(Ob,
Db,$b,Jb),{u_image:0,u_image_height:Bb,u_tileratio:Yc,u_crossfade_from:vc.fromScale,u_crossfade_to:vc.toScale,u_image_dash:1,u_mix:vc.t,u_lineatlas_width:Ob.lineAtlas.width,u_lineatlas_height:Ob.lineAtlas.height});Db=C;Ob=G;$b=Za;vc=sb;Bb=K;Yc=R.gradients[Bb.id];var md=Yc.texture;Bb.gradientVersion!==Yc.version&&(md=mh(Db,Ob,$b,vc,Bb,R,Bd,Yc));$b.activeTexture.set(vc.TEXTURE0);md.bind(Bb.stepInterpolant?vc.NEAREST:vc.LINEAR,vc.CLAMP_TO_EDGE);$b.activeTexture.set(vc.TEXTURE1);Db.lineAtlas.bind($b);
fd.updatePaintBuffers(Ea)}else pa?($b=C,vc=K,Bb=1/v.aC(Db,1,$b.transform.tileZoom),Jb=v.e(eg($b,Db,vc,Jb),{u_tileratio:Bb,u_crossfade_from:Ea.fromScale,u_crossfade_to:Ea.toScale,u_image:0,u_mix:Ea.t,u_lineatlas_width:$b.lineAtlas.width,u_lineatlas_height:$b.lineAtlas.height}),Db=C,(Ob||Db.lineAtlas.dirty)&&(Za.activeTexture.set(sb.TEXTURE0),Db.lineAtlas.bind(Za)),fd.updatePaintBuffers(Ea)):za?(Ob=R.lineClipsArray.length,Jb=v.e(eg(C,Db,K,Jb),{u_image:0,u_image_height:Ob}),Db=C,Ob=G,$b=Za,vc=sb,Bb=
K,Yc=R.gradients[Bb.id],md=Yc.texture,Bb.gradientVersion!==Yc.version&&(md=mh(Db,Ob,$b,vc,Bb,R,Bd,Yc)),$b.activeTexture.set(vc.TEXTURE0),md.bind(Bb.stepInterpolant?vc.NEAREST:vc.LINEAR,vc.CLAMP_TO_EDGE)):Jb=eg(C,Db,K,Jb);Db=C.stencilModeForClipping(Bd);ud.draw(Za,sb.TRIANGLES,ca,Db,ja,dd.disabled,Jb,eb,Nb,K.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,K.paint,C.transform.zoom,fd,R.layoutVertexBuffer2);eb=!1}}}}(b,g,m,u,z):v.cg(m)?function(C,G,K,R,X){var ca=K.paint.get("fill-color");const ja=K.paint.get("fill-opacity");
if(0!==ja.constantOr(1)){({isRenderingToTexture:X}=X);var la=C.colorModeForRenderPass(),pa=K.paint.get("fill-pattern");ca=C.opaquePassEnabledForLayer()&&!pa.constantOr(1)&&1===ca.constantOr(v.bf.transparent).a&&1===ja.constantOr(0)?"opaque":"translucent";C.renderPass===ca&&(ca=C.getDepthModeForSublayer(1,"opaque"===C.renderPass?ed.ReadWrite:ed.ReadOnly),Bg(C,G,K,R,ca,la,!1,X));"translucent"===C.renderPass&&K.paint.get("fill-antialias")&&(ca=C.getDepthModeForSublayer(K.getPaintProperty("fill-outline-color")?
2:0,ed.ReadOnly),Bg(C,G,K,R,ca,la,!0,X))}}(b,g,m,u,z):v.ch(m)?function(C,G,K,R,X){var ca=K.paint.get("fill-extrusion-opacity");if(0!==ca&&({isRenderingToTexture:X}=X,"translucent"===C.renderPass)){const ja=new ed(C.context.gl.LEQUAL,ed.ReadWrite,C.depthRangeFor3D);1!==ca||K.paint.get("fill-extrusion-pattern").constantOr(1)?(Cg(C,G,K,R,ja,Jd.disabled,Md.disabled,X),Cg(C,G,K,R,ja,C.stencilModeFor3D(),C.colorModeForRenderPass(),X)):(ca=C.colorModeForRenderPass(),Cg(C,G,K,R,ja,Jd.disabled,ca,X))}}(b,
g,m,u,z):v.ci(m)?function(C,G,K,R,X){if("offscreen"===C.renderPass||"translucent"===C.renderPass){var {isRenderingToTexture:ca}=X;X=C.context;var ja=C.style.projection.useSubdivision,la=C.getDepthModeForSublayer(0,ed.ReadOnly),pa=C.colorModeForRenderPass();if("offscreen"===C.renderPass){ca=Jd.disabled;ja=C.context;const ob=ja.gl;for(const eb of R){R=G.getTile(eb);var ya=R.dem;if(!ya||!ya.data)continue;if(!R.needsHillshadePrepare)continue;var Ba=ya.dim,za=ya.stride,Ea=ya.getPixels();(ja.activeTexture.set(ob.TEXTURE1),
ja.pixelStoreUnpackPremultiplyAlpha.set(!1),R.demTexture=R.demTexture||C.getTileTexture(za),R.demTexture)?(za=R.demTexture,za.update(Ea,{premultiply:!1}),za.bind(ob.NEAREST,ob.CLAMP_TO_EDGE)):(R.demTexture=new v.T(ja,Ea,ob.RGBA,{premultiply:!1}),R.demTexture.bind(ob.NEAREST,ob.CLAMP_TO_EDGE));ja.activeTexture.set(ob.TEXTURE0);Ea=R.fbo;Ea||(za=new v.T(ja,{width:Ba,height:Ba,data:null},ob.RGBA),za.bind(ob.LINEAR,ob.CLAMP_TO_EDGE),Ea=R.fbo=ja.createFramebuffer(Ba,Ba,!0,!1),Ea.colorAttachment.set(za.texture));
ja.bindFramebuffer.set(Ea.framebuffer);ja.viewport.set([0,0,Ba,Ba]);Ba=C.useProgram("hillshadePrepare");Ea=Ba.draw;za=ob.TRIANGLES;var Qa=ca,Za=dd.disabled,sb=R.tileID;const Db=ya.stride,Nb=v.L();ya=(v.bZ(Nb,0,v.$,-v.$,0,0,1),v.M(Nb,Nb,[0,-v.$,0]),{u_matrix:Nb,u_image:1,u_dimension:[Db,Db],u_zoom:sb.overscaledZ,u_unpack:ya.getUnpackVector()});Ea.call(Ba,ja,za,la,Qa,pa,Za,ya,null,null,K.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments);R.needsHillshadePrepare=!1}!0;X.viewport.set([0,
0,C.width,C.height])}else if("translucent"===C.renderPass)if(ja){const [ob,eb,Db]=C.stencilConfigForOverlapTwoPass(R);Gh(C,G,K,Db,ob,la,pa,!1,ca);Gh(C,G,K,Db,eb,la,pa,!0,ca)}else{const [ob,eb]=C.getStencilConfigForOverlapAndUpdateStencilID(R);Gh(C,G,K,eb,ob,la,pa,!1,ca)}}}(b,g,m,u,z):v.cj(m)?function(C,G,K,R,X){if("translucent"===C.renderPass&&R.length){({isRenderingToTexture:X}=X);var ca=C.style.projection.useSubdivision,ja=C.getDepthModeForSublayer(0,ed.ReadOnly),la=C.colorModeForRenderPass();if(ca){const [pa,
ya,Ba]=C.stencilConfigForOverlapTwoPass(R);te(C,G,K,Ba,pa,ja,la,!1,X);te(C,G,K,Ba,ya,ja,la,!0,X)}else{const [pa,ya]=C.getStencilConfigForOverlapAndUpdateStencilID(R);te(C,G,K,ya,pa,ja,la,!1,X)}}}(b,g,m,u,z):v.bK(m)?function(C,G,K,R,X){if("translucent"===C.renderPass&&0!==K.paint.get("raster-opacity")&&R.length){({isRenderingToTexture:X}=X);var ca=G.getSource(),ja=C.style.projection.useSubdivision;if(ca instanceof Td)Zh(C,G,K,R,null,!1,!1,ca.tileCoords,ca.flippedWindingOrder,X);else if(ja){const [la,
pa,ya]=C.stencilConfigForOverlapTwoPass(R);Zh(C,G,K,ya,la,!1,!0,ea,!1,X);Zh(C,G,K,ya,pa,!0,!0,ea,!1,X)}else{const [la,pa]=C.getStencilConfigForOverlapAndUpdateStencilID(R);Zh(C,G,K,pa,la,!1,!0,ea,!1,X)}}}(b,g,m,u,z):v.ck(m)?function(C,G,K,R,X){G=K.paint.get("background-color");const ca=K.paint.get("background-opacity");if(0!==ca){({isRenderingToTexture:X}=X);var ja=C.context,la=ja.gl,pa=C.style.projection,ya=C.transform,Ba=ya.tileSize,za=K.paint.get("background-pattern");if(!C.isPatternMissing(za)){var Ea=
!za&&1===G.a&&1===ca&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===Ea){var Qa=Jd.disabled;Ea=C.getDepthModeForSublayer(0,"opaque"===Ea?ed.ReadWrite:ed.ReadOnly);var Za=C.colorModeForRenderPass(),sb=C.useProgram(za?"backgroundPattern":"background"),ob=R||Nc(ya,{tileSize:Ba,terrain:C.style.map.terrain});za&&(ja.activeTexture.set(la.TEXTURE0),C.imageManager.bind(C.context));R=K.getCrossfadeParameters();for(const Bb of ob){ob=ya.getProjectionData({overscaledTileID:Bb,applyGlobeMatrix:!X,
applyTerrainMatrix:!0});if(za){var eb=ca;var Db=C;var Nb=za,Ob={tileID:Bb,tileSize:Ba},Jb=v.e;const Yc=Db.imageManager.getPattern(Nb.from.toString());Nb=Db.imageManager.getPattern(Nb.to.toString());const {width:md,height:Bd}=Db.imageManager.getPixelSize();var $b=Math.pow(2,Ob.tileID.overscaledZ),vc=Ob.tileSize*Math.pow(2,Db.transform.tileZoom)/$b;$b=vc*(Ob.tileID.canonical.x+Ob.tileID.wrap*$b);vc*=Ob.tileID.canonical.y;Db={u_image:0,u_pattern_tl_a:Yc.tl,u_pattern_br_a:Yc.br,u_pattern_tl_b:Nb.tl,u_pattern_br_b:Nb.br,
u_texsize:[md,Bd],u_mix:R.t,u_pattern_size_a:Yc.displaySize,u_pattern_size_b:Nb.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/v.aC(Ob,1,Db.transform.tileZoom),u_pixel_coord_upper:[$b>>16,vc>>16],u_pixel_coord_lower:[65535&$b,65535&vc]};eb=Jb.call(v,Db,{u_opacity:eb})}else eb={u_opacity:ca,u_color:G};Jb=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Bb);Db=pa.getMeshFromTileID(ja,Bb.canonical,!1,!0,"raster");sb.draw(ja,la.TRIANGLES,Ea,Qa,Za,dd.backCCW,eb,Jb,
ob,K.id,Db.vertexBuffer,Db.indexBuffer,Db.segments)}}}}}(b,0,m,u,z):v.cl(m)&&function(C,G,K,R){({isRenderingGlobe:R}=R);G=C.context;K=K.implementation;var X=C.style.projection;const ca=C.transform;R=ca.getProjectionDataForCustomLayer(R);R={farZ:ca.farZ,nearZ:ca.nearZ,fov:ca.fov*Math.PI/180,modelViewProjectionMatrix:ca.modelViewProjectionMatrix,projectionMatrix:ca.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${X.shaderPreludeCode.vertexSource}`,
define:X.shaderDefine},defaultProjectionData:R};X=K.renderingMode?K.renderingMode:"2d";"offscreen"===C.renderPass?(X=K.prerender)&&(C.setCustomLayerDefaults(),G.setColorMode(C.colorModeForRenderPass()),X.call(K,G.gl,R),G.setDirty(),C.setBaseState()):"translucent"===C.renderPass&&(C.setCustomLayerDefaults(),G.setColorMode(C.colorModeForRenderPass()),G.setStencilMode(Jd.disabled),X="3d"===X?C.getDepthModeFor3D():C.getDepthModeForSublayer(0,ed.ReadOnly),G.setDepthMode(X),K.render(G.gl,R),G.setDirty(),
C.setBaseState(),G.bindFramebuffer.set(null))}(b,0,m,z))}saveTileTexture(b){const g=this._tileTextures[b.size[0]];g?g.push(b):this._tileTextures[b.size[0]]=[b]}getTileTexture(b){return(b=this._tileTextures[b])&&0<b.length?b.pop():null}isPatternMissing(b){if(!b)return!1;if(!b.from||!b.to)return!0;const g=this.imageManager.getPattern(b.from.toString());b=this.imageManager.getPattern(b.to.toString());return!g||!b}useProgram(b,g,m=!1,u=[]){this.cache=this.cache||{};const z=!!this.style.map.terrain,C=
this.style.projection,G=m?Ed.projectionMercator:C.shaderPreludeCode,K=m?"#define PROJECTION_MERCATOR":C.shaderDefine;m=b+(g?g.cacheKey:"")+`/${m?"mercator":C.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(z?"/terrain":"")+(u?`/${u.join("/")}`:"");return this.cache[m]||(this.cache[m]=new Og(this.context,Ed[b],g,Wc[b],this._showOverdrawInspector,z,G,K,u)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO();this.context.cullFace.setDefault();this.context.activeTexture.setDefault();
this.context.pixelStoreUnpack.setDefault();this.context.pixelStoreUnpackPremultiplyAlpha.setDefault();this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const b=this.context.gl;this.context.cullFace.set(!1);this.context.viewport.set([0,0,this.width,this.height]);this.context.blendEquation.set(b.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,
this.debugOverlayTexture=new v.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const {drawingBufferWidth:b,drawingBufferHeight:g}=this.context.gl;return this.width!==b||this.height!==g}}class ic{constructor(b){this._getCurrentHash=()=>{const g=window.location.hash.replace("#","");if(this._hashName){let m;return g.split("\x26").map(u=>u.split("\x3d")).forEach(u=>{u[0]===this._hashName&&(m=u)}),(m&&m[1]||
"").split("/")}return g.split("/")};this._onHashChange=()=>{const g=this._getCurrentHash();if(!this._isValidHash(g))return!1;const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(g[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:m,pitch:+(g[4]||0)}),!0};this._updateHashUnthrottled=()=>{const g=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,g)};this._removeHash=
()=>{var g=this._getCurrentHash();if(0!==g.length){var m=g=g.join("/");0<m.split("\x26").length&&(m=m.split("\x26")[0]);this._hashName&&(m=`${this._hashName}=${g}`);g=window.location.hash.replace(m,"");g.startsWith("#\x26")?g=g.slice(0,1)+g.slice(2):"#"===g&&(g="");g=window.location.href.replace(/(#.+)?$/,g);g=g.replace("\x26\x26","\x26");window.history.replaceState(window.history.state,null,g)}};this._updateHash=tk(this._updateHashUnthrottled,300);this._hashName=b&&encodeURIComponent(b)}addTo(b){return this._map=
b,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(b){var g=this._map.getCenter();const m=Math.round(100*this._map.getZoom())/100;var u=Math.pow(10,Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10));const z=Math.round(g.lng*u)/u;g=Math.round(g.lat*
u)/u;u=this._map.getBearing();const C=this._map.getPitch();let G="";if(G+=b?`/${z}/${g}/${m}`:`${m}/${g}/${z}`,(u||C)&&(G+="/"+Math.round(10*u)/10),C&&(G+=`/${Math.round(C)}`),this._hashName){const K=this._hashName;let R=!1;b=window.location.hash.slice(1).split("\x26").map(X=>{const ca=X.split("\x3d")[0];return ca===K?(R=!0,`${ca}=${G}`):X}).filter(X=>X);return R||b.push(`${K}=${G}`),`#${b.join("\x26")}`}return`#${G}`}_isValidHash(b){if(3>b.length||b.some(isNaN))return!1;try{new v.S(+b[2],+b[1])}catch(u){return!1}const g=
+b[0],m=+(b[3]||0);b=+(b[4]||0);return g>=this._map.getMinZoom()&&g<=this._map.getMaxZoom()&&-180<=m&&180>=m&&b>=this._map.getMinPitch()&&b<=this._map.getMaxPitch()}}const Vb={linearity:.3,easing:v.cm(0,0,.3,1)},Sc=v.e({deceleration:2500,maxSpeed:1400},Vb),mc=v.e({deceleration:20,maxSpeed:1400},Vb),xd=v.e({deceleration:1E3,maxSpeed:360},Vb),Sg=v.e({deceleration:1E3,maxSpeed:90},Vb),If=v.e({deceleration:1E3,maxSpeed:360},Vb);class Fj{constructor(b){this._map=b;this.clear()}clear(){this._inertiaBuffer=
[]}record(b){this._drainInertiaBuffer();this._inertiaBuffer.push({time:qd.now(),settings:b})}_drainInertiaBuffer(){const b=this._inertiaBuffer,g=qd.now();for(;0<b.length&&160<g-b[0].time;)b.shift()}_onMoveEnd(b){if(!(this._drainInertiaBuffer(),2>this._inertiaBuffer.length)){var g=0,m=0,u=0,z=0,C=new v.P(0,0),G=void 0,K=void 0;for(var {settings:R}of this._inertiaBuffer)g+=R.zoomDelta||0,m+=R.bearingDelta||0,u+=R.pitchDelta||0,z+=R.rollDelta||0,R.panDelta&&C._add(R.panDelta),R.around&&(K=R.around),
R.pinchAround&&(G=R.pinchAround);var X=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time;R={};C.mag()&&(b=Dg(C.mag(),X,v.e({},Sc,b||{})),C=C.mult(b.amount/C.mag()),C=this._map.cameraHelper.handlePanInertia(C,this._map.transform),R.center=C.easingCenter,R.offset=C.easingOffset,ph(R,b));g&&(g=Dg(g,X,mc),R.zoom=this._map.transform.zoom+g.amount,ph(R,g));m&&(m=Dg(m,X,xd),R.bearing=this._map.transform.bearing+v.ah(m.amount,-179,179),ph(R,m));u&&(u=Dg(u,X,Sg),R.pitch=this._map.transform.pitch+
u.amount,ph(R,u));z&&(z=Dg(z,X,If),R.roll=this._map.transform.roll+v.ah(z.amount,-179,179),ph(R,z));if(R.zoom||R.bearing)G=void 0===G?K:G,R.around=G?this._map.unproject(G):this._map.getCenter();return this.clear(),v.e(R,{noMoveStart:!0})}}}class mf extends v.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,g,m,u={}){m=m instanceof MouseEvent?m:new MouseEvent(b,m);const z=rb.mousePos(g.getCanvas(),m),C=g.unproject(z);super(b,v.e({point:z,
lngLat:C,originalEvent:m},u));this._defaultPrevented=!1;this.target=g}}class Rf extends v.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,g,m){var u="touchend"===b?m.changedTouches:m.touches;u=rb.touchPos(g.getCanvasContainer(),u);const z=u.map(G=>g.unproject(G)),C=u.reduce((G,K,R,X)=>G.add(K.div(X.length)),new v.P(0,0));super(b,{points:u,point:C,lngLats:z,lngLat:g.unproject(C),originalEvent:m});this._defaultPrevented=!1}}class ij extends v.l{preventDefault(){this._defaultPrevented=
!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,g,m){super(b,{originalEvent:m});this._defaultPrevented=!1}}class Ug{constructor(b,g){this._map=b;this._clickTolerance=g.clickTolerance}reset(){delete this._mousedownPos}wheel(b){return this._firePreventable(new ij(b.type,this._map,b))}mousedown(b,g){return this._mousedownPos=g,this._firePreventable(new mf(b.type,this._map,b))}mouseup(b){this._map.fire(new mf(b.type,this._map,b))}click(b,g){this._mousedownPos&&this._mousedownPos.dist(g)>=
this._clickTolerance||this._map.fire(new mf(b.type,this._map,b))}dblclick(b){return this._firePreventable(new mf(b.type,this._map,b))}mouseover(b){this._map.fire(new mf(b.type,this._map,b))}mouseout(b){this._map.fire(new mf(b.type,this._map,b))}touchstart(b){return this._firePreventable(new Rf(b.type,this._map,b))}touchmove(b){this._map.fire(new Rf(b.type,this._map,b))}touchend(b){this._map.fire(new Rf(b.type,this._map,b))}touchcancel(b){this._map.fire(new Rf(b.type,this._map,b))}_firePreventable(b){if(this._map.fire(b),
b.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mc{constructor(b){this._map=b}reset(){this._delayContextMenu=!1;this._ignoreContextMenu=!0;delete this._contextMenuEvent}mousemove(b){this._map.fire(new mf(b.type,this._map,b))}mousedown(){this._delayContextMenu=!0;this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1;this._contextMenuEvent&&(this._map.fire(new mf("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(b){this._delayContextMenu?
this._contextMenuEvent=b:this._ignoreContextMenu||this._map.fire(new mf(b.type,this._map,b));this._map.listens("contextmenu")&&b.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jk{constructor(b){this._map=b}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(b){return this.transform.screenPointToLocation(v.P.convert(b),
this._map.terrain)}}class Vg{constructor(b,g){this._map=b;this._tr=new Jk(b);this._el=b.getCanvasContainer();this._container=b.getContainer();this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(b,g){this.isEnabled()&&b.shiftKey&&0===b.button&&(rb.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(b,g){if(this._active&&
!(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=g;this._box||(this._box=rb.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",b));b=Math.min(m.x,g.x);var u=Math.max(m.x,g.x),z=Math.min(m.y,g.y);g=Math.max(m.y,g.y);rb.setTransform(this._box,`translate(${b}px,${z}px)`);this._box.style.width=u-b+"px";this._box.style.height=g-z+"px"}}mouseupWindow(b,
g){if(this._active&&0===b.button){var m=this._startPos;if(this.reset(),rb.suppressClick(),m.x!==g.x||m.y!==g.y)return this._map.fire(new v.l("boxzoomend",{originalEvent:b})),{cameraAnimation:u=>u.fitScreenCoordinates(m,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",b)}}keydown(b){this._active&&27===b.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",b))}reset(){this._active=!1;this._container.classList.remove("maplibregl-crosshair");this._box&&(rb.remove(this._box),this._box=
null);rb.enableDrag();delete this._startPos;delete this._lastPos}_fireEvent(b,g){return this._map.fire(new v.l(b,{originalEvent:g}))}}class rl{constructor(b){this.reset();this.numTouches=b.numTouches}reset(){delete this.centroid;delete this.startTime;delete this.touches;this.aborted=!1}touchstart(b,g,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0);if(!this.aborted&&(void 0===this.startTime&&(this.startTime=b.timeStamp),m.length===this.numTouches)){b=new v.P(0,0);for(const u of g)b._add(u);
this.centroid=b.div(g.length);this.touches=ti(m,g)}}touchmove(b,g,m){if(!this.aborted&&this.centroid){b=ti(m,g);for(const u in this.touches)g=b[u],(!g||30<g.dist(this.touches[u]))&&(this.aborted=!0)}}touchend(b,g,m){if((!this.centroid||500<b.timeStamp-this.startTime)&&(this.aborted=!0),0===m.length)if(b=!this.aborted&&this.centroid,this.reset(),b)return b}}class ji{constructor(b){this.singleTap=new rl(b);this.numTaps=b.numTaps;this.reset()}reset(){this.lastTime=1/0;delete this.lastTap;this.count=
0;this.singleTap.reset()}touchstart(b,g,m){this.singleTap.touchstart(b,g,m)}touchmove(b,g,m){this.singleTap.touchmove(b,g,m)}touchend(b,g,m){if(g=this.singleTap.touchend(b,g,m)){m=500>b.timeStamp-this.lastTime;const u=!this.lastTap||30>this.lastTap.dist(g);if(m&&u||this.reset(),this.count++,this.lastTime=b.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class ve{constructor(b){this._tr=new Jk(b);this._zoomIn=new ji({numTouches:1,numTaps:2});this._zoomOut=new ji({numTouches:2,
numTaps:1});this.reset()}reset(){this._active=!1;this._zoomIn.reset();this._zoomOut.reset()}touchstart(b,g,m){this._zoomIn.touchstart(b,g,m);this._zoomOut.touchstart(b,g,m)}touchmove(b,g,m){this._zoomIn.touchmove(b,g,m);this._zoomOut.touchmove(b,g,m)}touchend(b,g,m){const u=this._zoomIn.touchend(b,g,m),z=this._zoomOut.touchend(b,g,m),C=this._tr;return u?(this._active=!0,b.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:G=>G.easeTo({duration:300,zoom:C.zoom+1,around:C.unproject(u)},
{originalEvent:b})}):z?(this._active=!0,b.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:G=>G.easeTo({duration:300,zoom:C.zoom-1,around:C.unproject(z)},{originalEvent:b})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fg{constructor(b){this._enabled=!!b.enable;this._moveStateManager=b.moveStateManager;this._clickTolerance=b.clickTolerance||1;this._moveFunction=
b.move;this._activateOnStart=!!b.activateOnStart;b.assignEvents(this);this.reset()}reset(b){this._moved=this._active=!1;delete this._lastPoint;this._moveStateManager.endMove(b)}_move(...b){b=this._moveFunction(...b);if(b.bearingDelta||b.pitchDelta||b.rollDelta||b.around||b.panDelta)return this._active=!0,b}dragStart(b,g){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(b)&&(this._moveStateManager.startMove(b),this._lastPoint=Array.isArray(g)?g[0]:g,this._activateOnStart&&
this._lastPoint&&(this._active=!0))}dragMove(b,g){if(this.isEnabled()){var m=this._lastPoint;if(m){if(b.preventDefault(),!this._moveStateManager.isValidMoveEvent(b))return void this.reset(b);b=Array.isArray(g)?g[0]:g;return!this._moved&&b.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=b,this._move(m,b))}}}dragEnd(b){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(b)&&(this._moved&&rb.suppressClick(),this.reset(b))}enable(){this._enabled=!0}disable(){this._enabled=
!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Xd={[0]:1,[2]:2};class Xc{constructor(b){this._correctEvent=b.checkCorrectEvent}startMove(b){this._eventButton=rb.mouseButton(b)}endMove(b){delete this._eventButton}isValidStartEvent(b){return this._correctEvent(b)}isValidMoveEvent(b){const g=Xd[this._eventButton];return!(void 0===b.buttons||(b.buttons&g)!==g)}isValidEndEvent(b){return rb.mouseButton(b)===this._eventButton}}
class tm{constructor(){this._firstTouch=void 0}_isOneFingerTouch(b){return 1===b.targetTouches.length}_isSameTouchEvent(b){return b.targetTouches[0].identifier===this._firstTouch}startMove(b){this._firstTouch=b.targetTouches[0].identifier}endMove(b){delete this._firstTouch}isValidStartEvent(b){return this._isOneFingerTouch(b)}isValidMoveEvent(b){return this._isOneFingerTouch(b)&&this._isSameTouchEvent(b)}isValidEndEvent(b){return this._isOneFingerTouch(b)&&this._isSameTouchEvent(b)}}class Ri{constructor(b=
new Xc({checkCorrectEvent:()=>!0}),g=new tm){this.mouseMoveStateManager=b;this.oneFingerTouchMoveStateManager=g}_executeRelevantHandler(b,g,m){return b instanceof MouseEvent?g(b):"undefined"!=typeof TouchEvent&&b instanceof TouchEvent?m(b):void 0}startMove(b){this._executeRelevantHandler(b,g=>this.mouseMoveStateManager.startMove(g),g=>this.oneFingerTouchMoveStateManager.startMove(g))}endMove(b){this._executeRelevantHandler(b,g=>this.mouseMoveStateManager.endMove(g),g=>this.oneFingerTouchMoveStateManager.endMove(g))}isValidStartEvent(b){return this._executeRelevantHandler(b,
g=>this.mouseMoveStateManager.isValidStartEvent(g),g=>this.oneFingerTouchMoveStateManager.isValidStartEvent(g))}isValidMoveEvent(b){return this._executeRelevantHandler(b,g=>this.mouseMoveStateManager.isValidMoveEvent(g),g=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(g))}isValidEndEvent(b){return this._executeRelevantHandler(b,g=>this.mouseMoveStateManager.isValidEndEvent(g),g=>this.oneFingerTouchMoveStateManager.isValidEndEvent(g))}}const Oi=b=>{b.mousedown=b.dragStart;b.mousemoveWindow=
b.dragMove;b.mouseup=b.dragEnd;b.contextmenu=g=>{g.preventDefault()}};class um{constructor(b,g){this._clickTolerance=b.clickTolerance||1;this._map=g;this.reset()}reset(){this._active=!1;this._touches={};this._sum=new v.P(0,0)}_shouldBePrevented(b){return b<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(b,g,m){return this._calculateTransform(b,g,m)}touchmove(b,g,m){if(this._active){if(!this._shouldBePrevented(m.length))return b.preventDefault(),this._calculateTransform(b,g,m);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",
b)}}touchend(b,g,m){this._calculateTransform(b,g,m);this._active&&this._shouldBePrevented(m.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(b,g,m){0<m.length&&(this._active=!0);m=ti(m,g);b=new v.P(0,0);const u=new v.P(0,0);g=0;for(var z in m){const C=m[z],G=this._touches[z];G&&(b._add(C),u._add(C.sub(G)),g++,m[z]=C)}if(this._touches=m,!this._shouldBePrevented(g)&&u.mag())return z=u.div(g),this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(g),panDelta:z}}enable(){this._enabled=
!0}disable(){this._enabled=!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gh{constructor(){this.reset()}reset(){this._active=!1;delete this._firstTwoTouches}touchstart(b,g,m){this._firstTwoTouches||2>m.length||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([g[0],g[1]]))}touchmove(b,g,m){if(this._firstTwoTouches){b.preventDefault();var [u,z]=this._firstTwoTouches,C=ui(m,g,u);g=ui(m,g,z);if(C&&g)return m=this._aroundCenter?null:C.add(g).div(2),
this._move([C,g],m,b)}}touchend(b,g,m){if(this._firstTwoTouches){var [u,z]=this._firstTwoTouches;b=ui(m,g,u);g=ui(m,g,z);b&&g||(this._active&&rb.suppressClick(),this.reset())}}touchcancel(){this.reset()}enable(b){this._enabled=!0;this._aroundCenter=!!b&&"center"===b.around}disable(){this._enabled=!1;this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}class dk extends gh{reset(){super.reset();delete this._distance;delete this._startDistance}_start(b){this._startDistance=
this._distance=b[0].dist(b[1])}_move(b,g){const m=this._distance;if(this._distance=b[0].dist(b[1]),this._active||!(.1>Math.abs(Math.log(this._distance/this._startDistance)/Math.LN2)))return this._active=!0,{zoomDelta:Math.log(this._distance/m)/Math.LN2,pinchAround:g}}}class jj extends gh{reset(){super.reset();delete this._minDiameter;delete this._startVector;delete this._vector}_start(b){this._startVector=this._vector=b[0].sub(b[1]);this._minDiameter=b[0].dist(b[1])}_move(b,g,m){m=this._vector;if(this._vector=
b[0].sub(b[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:180*this._vector.angleWith(m)/Math.PI,pinchAround:g}}_isBelowThreshold(b){this._minDiameter=Math.min(this._minDiameter,b.mag());const g=25/(Math.PI*this._minDiameter)*360;b=180*b.angleWith(this._startVector)/Math.PI;return Math.abs(b)<g}}class ni extends gh{constructor(b){super();this._currentTouchCount=0;this._map=b}reset(){super.reset();this._valid=void 0;delete this._firstMove;delete this._lastPoints}touchstart(b,
g,m){super.touchstart(b,g,m);this._currentTouchCount=m.length}_start(b){this._lastPoints=b;Yi(b[0].sub(b[1]))&&(this._valid=!1)}_move(b,g,m){if(!(this._map.cooperativeGestures.isEnabled()&&3>this._currentTouchCount)){g=b[0].sub(this._lastPoints[0]);var u=b[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,u,m.timeStamp),this._valid?(this._lastPoints=b,this._active=!0,{pitchDelta:(g.y+u.y)/2*-.5}):void 0}}gestureBeginsVertically(b,g,m){if(void 0!==this._valid)return this._valid;
const u=2<=b.mag(),z=2<=g.mag();if(u||z){if(!u||!z)return void 0===this._firstMove&&(this._firstMove=m),100>m-this._firstMove&&void 0;m=0<b.y==0<g.y;return Yi(b)&&Yi(g)&&m}}}class Pi{constructor(b){this._tr=new Jk(b);this._panStep=100;this._bearingStep=15;this._pitchStep=10;this._rotationDisabled=!1}reset(){this._active=!1}keydown(b){if(!(b.altKey||b.ctrlKey||b.metaKey)){var g=0,m=0,u=0,z=0,C=0;switch(b.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:b.shiftKey?
m=-1:(b.preventDefault(),z=-1);break;case 39:b.shiftKey?m=1:(b.preventDefault(),z=1);break;case 38:b.shiftKey?u=1:(b.preventDefault(),C=-1);break;case 40:b.shiftKey?u=-1:(b.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(m=0,u=0),{cameraAnimation:G=>{const K=this._tr;G.easeTo({duration:300,easeId:"keyboardHandler",easing:Fl,zoom:g?Math.round(K.zoom)+g*(b.shiftKey?2:1):K.zoom,bearing:K.bearing+m*this._bearingStep,pitch:K.pitch+u*this._pitchStep,offset:[-z*this._panStep,-C*
this._panStep],center:K.center},{originalEvent:b})}}}}enable(){this._enabled=!0}disable(){this._enabled=!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}const mi=1/450;class Mk{constructor(b,g){this._onTimeout=m=>{this._type="wheel";this._delta-=this._lastValue;this._active||this._start(m)};this._map=b;this._tr=new Jk(b);this._triggerRenderFrame=g;this._delta=0;this._defaultZoomRate=
.01;this._wheelZoomRate=mi}setZoomRate(b){this._defaultZoomRate=b}setWheelZoomRate(b){this._wheelZoomRate=b}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(b){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!b&&"center"===b.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(b){return!!this._map.cooperativeGestures.isEnabled()&&!(b.ctrlKey||this._map.cooperativeGestures.isBypassed(b))}wheel(b){if(this.isEnabled()){if(this._shouldBePrevented(b))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",
b);var g=b.deltaMode===WheelEvent.DOM_DELTA_LINE?40*b.deltaY:b.deltaY,m=qd.now(),u=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m;0!==g&&0==g%4.000244140625?this._type="wheel":0!==g&&4>Math.abs(g)?this._type="trackpad":400<u?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,b)):this._type||(this._type=200>Math.abs(u*g)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue));b.shiftKey&&g&&(g/=4);this._type&&(this._lastWheelEvent=
b,this._delta-=g,this._active||this._start(b));b.preventDefault()}}_start(b){if(this._delta){this._frameId&&(this._frameId=null);this._active=!0;this.isZooming()||(this._zooming=!0);this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);b=rb.mousePos(this._map.getCanvas(),b);var g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(v.S.convert(g.center)):b;this._frameId||(this._frameId=!0,this._triggerRenderFrame())}}renderFrame(){if(this._frameId&&
(this._frameId=null,this.isActive())){var b=this._tr.transform;if("number"==typeof this._lastExpectedZoom){var g=b.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=g);"number"==typeof this._targetZoom&&(this._targetZoom+=g)}if(0!==this._delta){g=2/(1+Math.exp(-Math.abs(this._delta*("wheel"===this._type&&4.000244140625<Math.abs(this._delta)?this._wheelZoomRate:this._defaultZoomRate))));0>this._delta&&0!==g&&(g=1/g);var m="number"!=typeof this._targetZoom?b.scale:v.af(this._targetZoom);
this._targetZoom=b.getConstrained(b.getCameraLngLat(),v.ak(m*g)).zoom;"wheel"===this._type&&(this._startZoom=b.zoom,this._easing=this._smoothOutEasing(200));this._delta=0}m="number"!=typeof this._targetZoom?b.zoom:this._targetZoom;var u=this._startZoom,z=this._easing;g=!1;if("wheel"===this._type&&u&&z){var C=qd.now()-this._lastWheelEventTime;C=Math.min((C+5)/200,1);z=z(C);m=v.C.number(u,m,z);1>C?this._frameId||(this._frameId=!0):g=!0}else g=!0;return this._active=!0,g&&(this._active=!1,this._finishTimeout=
setTimeout(()=>{this._zooming=!1;this._triggerRenderFrame();delete this._targetZoom;delete this._lastExpectedZoom;delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!g,zoomDelta:m-b.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}}_smoothOutEasing(b){var g=v.co;if(this._prevEase){g=this._prevEase;const m=(qd.now()-g.start)/g.duration;g=g.easing(m+.01)-g.easing(m);g=.27/Math.sqrt(g*g+1E-4)*.01;g=v.cm(g,Math.sqrt(.0729-g*g),.25,1)}return this._prevEase=
{start:qd.now(),duration:b,easing:g},g}reset(){this._zooming=this._active=!1;delete this._targetZoom;delete this._lastExpectedZoom;this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nf{constructor(b,g){this._clickZoom=b;this._tapZoom=g}enable(){this._clickZoom.enable();this._tapZoom.enable()}disable(){this._clickZoom.disable();this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||
this._tapZoom.isActive()}}class zh{constructor(b){this._tr=new Jk(b);this.reset()}reset(){this._active=!1}dblclick(b,g){return b.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(b.shiftKey?-1:1),around:this._tr.unproject(g)},{originalEvent:b})}}}enable(){this._enabled=!0}disable(){this._enabled=!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lk{constructor(){this._tap=new ji({numTouches:1,numTaps:1});this.reset()}reset(){this._active=
!1;delete this._swipePoint;delete this._swipeTouch;delete this._tapTime;delete this._tapPoint;this._tap.reset()}touchstart(b,g,m){if(!this._swipePoint)if(this._tapTime){g=g[0];b=500>b.timeStamp-this._tapTime;const u=30>this._tapPoint.dist(g);b&&u?0<m.length&&(this._swipePoint=g,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(b,g,m)}touchmove(b,g,m){if(this._tapTime){if(this._swipePoint&&m[0].identifier===this._swipeTouch)return g=g[0],m=g.y-this._swipePoint.y,this._swipePoint=
g,b.preventDefault(),this._active=!0,{zoomDelta:m/128}}else this._tap.touchmove(b,g,m)}touchend(b,g,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():(g=this._tap.touchend(b,g,m))&&(this._tapTime=b.timeStamp,this._tapPoint=g)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1;this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ih{constructor(b,g,m){this._el=b;this._mousePan=g;this._touchPan=m}enable(b){this._inertiaOptions=b||
{};this._mousePan.enable();this._touchPan.enable();this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable();this._touchPan.disable();this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jj{constructor(b,g,m,u){this._pitchWithRotate=b.pitchWithRotate;this._rollEnabled=b.rollEnabled;this._mouseRotate=g;this._mousePitch=
m;this._mouseRoll=u}enable(){this._mouseRotate.enable();this._pitchWithRotate&&this._mousePitch.enable();this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable();this._mousePitch.disable();this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}
class Wg{constructor(b,g,m,u){this._el=b;this._touchZoom=g;this._touchRotate=m;this._tapDragZoom=u;this._rotationDisabled=!1;this._enabled=!0}enable(b){this._touchZoom.enable(b);this._rotationDisabled||this._touchRotate.enable(b);this._tapDragZoom.enable();this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable();this._touchRotate.disable();this._tapDragZoom.disable();this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&
(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0;this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1;this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Rl{constructor(b,g){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey";this._map=b;this._options=g;this._enabled=
!1}isActive(){return!1}reset(){}_setupUI(){if(!this._container){var b=this._map.getCanvasContainer();b.classList.add("maplibregl-cooperative-gestures");this._container=rb.create("div","maplibregl-cooperative-gesture-screen",b);var g=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(g=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));b=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText");var m=document.createElement("div");
m.className="maplibregl-desktop-message";m.textContent=g;this._container.appendChild(m);g=document.createElement("div");g.className="maplibregl-mobile-message";g.textContent=b;this._container.appendChild(g);this._container.setAttribute("aria-hidden","true")}}_destroyUI(){this._container&&(rb.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures"));delete this._container}enable(){this._setupUI();this._enabled=!0}disable(){this._enabled=!1;this._destroyUI()}isEnabled(){return this._enabled}isBypassed(b){return b[this._bypassKey]}notifyGestureBlocked(b,
g){this._enabled&&(this._map.fire(new v.l("cooperativegestureprevented",{gestureType:b,originalEvent:g})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const li=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Sf extends v.l{}class Je{constructor(b,g){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)};this.handleEvent=(m,u)=>{if("blur"===m.type)return void this.stop(!0);this._updatingCamera=!0;var z="renderFrame"===
m.type?void 0:m;const C={needsRenderFrame:!1},G={},K={};for(const {handlerName:X,handler:ca,allowed:ja}of this._handlers)if(ca.isEnabled()){var R=void 0;if(this._blockedByActive(K,ja,X))ca.reset();else if(ca[u||m.type]){if(v.cp(m,u||m.type))R=rb.mousePos(this._map.getCanvas(),m),R=ca[u||m.type](m,R);else if(v.cq(m,u||m.type)){R=this._getMapTouches(m.touches);const la=rb.touchPos(this._map.getCanvas(),R);R=ca[u||m.type](m,la,R)}else v.cr(u||m.type)||(R=ca[u||m.type](m));this.mergeHandlerResult(C,G,
R,X,z);R&&R.needsRenderFrame&&this._triggerRenderFrame()}(R||ca.isActive())&&(K[X]=ca)}m={};for(const X in this._previousActiveHandlers)K[X]||(m[X]=z);this._previousActiveHandlers=K;(Object.keys(m).length||Rj(C))&&(this._changes.push([C,G,m]),this._triggerRenderFrame());(Object.keys(K).length||Rj(C))&&this._map._stop(!0);this._updatingCamera=!1;({cameraAnimation:z}=C);z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))};this._map=b;this._el=this._map.getCanvasContainer();
this._handlers=[];this._handlersById={};this._changes=[];this._inertia=new Fj(b);this._bearingSnap=g.bearingSnap;this._previousActiveHandlers={};this._eventsInProgress={};this._addDefaultHandlers(g);b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",
void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[window,"blur",void 0]];for(const [m,u,z]of this._listeners)rb.addEventListener(m,u,m===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const [b,g,m]of this._listeners)rb.removeEventListener(b,g,b===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(b){const g=this._map;var m=g.getCanvasContainer();this._add("mapEvent",
new Ug(g,b));var u=g.boxZoom=new Vg(g,b);this._add("boxZoom",u);b.interactive&&b.boxZoom&&u.enable();u=g.cooperativeGestures=new Rl(g,b.cooperativeGestures);this._add("cooperativeGestures",u);b.cooperativeGestures&&u.enable();u=new ve(g);var z=new zh(g);g.doubleClickZoom=new nf(z,u);this._add("tapZoom",u);this._add("clickZoom",z);b.interactive&&b.doubleClickZoom&&g.doubleClickZoom.enable();u=new Lk;this._add("tapDragZoom",u);z=g.touchPitch=new ni(g);this._add("touchPitch",z);b.interactive&&b.touchPitch&&
g.touchPitch.enable(b.touchPitch);var C=()=>g.project(g.getCenter());z=function({enable:K,clickTolerance:R,aroundCenter:X=!0,minPixelCenterThreshold:ca=100,rotateDegreesPerPixelMoved:ja=.8},la){const pa=new Xc({checkCorrectEvent:ya=>0===rb.mouseButton(ya)&&ya.ctrlKey||2===rb.mouseButton(ya)&&!ya.ctrlKey});return new fg({clickTolerance:R,move:(ya,Ba)=>{const za=la();if(X&&Math.abs(za.y-ya.y)>ca)return{bearingDelta:v.cn(new v.P(ya.x,Ba.y),Ba,za)};ya=(Ba.x-ya.x)*ja;return X&&Ba.y<za.y&&(ya=-ya),{bearingDelta:ya}},
moveStateManager:pa,enable:K,assignEvents:Oi})}(b,C);var G=function({enable:K,clickTolerance:R,pitchDegreesPerPixelMoved:X=-.5}){const ca=new Xc({checkCorrectEvent:ja=>0===rb.mouseButton(ja)&&ja.ctrlKey||2===rb.mouseButton(ja)});return new fg({clickTolerance:R,move:(ja,la)=>({pitchDelta:(la.y-ja.y)*X}),moveStateManager:ca,enable:K,assignEvents:Oi})}(b);C=function({enable:K,clickTolerance:R,rollDegreesPerPixelMoved:X=.3},ca){const ja=new Xc({checkCorrectEvent:la=>2===rb.mouseButton(la)&&la.ctrlKey});
return new fg({clickTolerance:R,move:(la,pa)=>{const ya=ca();la=(pa.x-la.x)*X;return pa.y<ya.y&&(la=-la),{rollDelta:la}},moveStateManager:ja,enable:K,assignEvents:Oi})}(b,C);g.dragRotate=new Jj(b,z,G,C);this._add("mouseRotate",z,["mousePitch"]);this._add("mousePitch",G,["mouseRotate","mouseRoll"]);this._add("mouseRoll",C,["mousePitch"]);b.interactive&&b.dragRotate&&g.dragRotate.enable();z=function({enable:K,clickTolerance:R}){const X=new Xc({checkCorrectEvent:ca=>0===rb.mouseButton(ca)&&!ca.ctrlKey});
return new fg({clickTolerance:R,move:(ca,ja)=>({around:ja,panDelta:ja.sub(ca)}),activateOnStart:!0,moveStateManager:X,enable:K,assignEvents:Oi})}(b);G=new um(b,g);g.dragPan=new ih(m,z,G);this._add("mousePan",z);this._add("touchPan",G,["touchZoom","touchRotate"]);b.interactive&&b.dragPan&&g.dragPan.enable(b.dragPan);z=new jj;G=new dk;g.touchZoomRotate=new Wg(m,G,z,u);this._add("touchRotate",z,["touchPan","touchZoom"]);this._add("touchZoom",G,["touchPan","touchRotate"]);b.interactive&&b.touchZoomRotate&&
g.touchZoomRotate.enable(b.touchZoomRotate);m=g.scrollZoom=new Mk(g,()=>this._triggerRenderFrame());this._add("scrollZoom",m,["mousePan"]);b.interactive&&b.scrollZoom&&g.scrollZoom.enable(b.scrollZoom);m=g.keyboard=new Pi(g);this._add("keyboard",m);b.interactive&&b.keyboard&&g.keyboard.enable();this._add("blockableMapEvent",new Mc(g))}_add(b,g,m){this._handlers.push({handlerName:b,handler:g,allowed:m});this._handlersById[b]=g}stop(b){if(!this._updatingCamera){for(const {handler:g}of this._handlers)g.reset();
this._inertia.clear();this._fireEvents({},{},b);this._changes=[]}}isActive(){for(const {handler:b}of this._handlers)if(b.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!li(this._eventsInProgress)||this.isZooming()}_blockedByActive(b,g,m){for(const u in b)if(u!==m&&(!g||0>g.indexOf(u)))return!0;return!1}_getMapTouches(b){const g=[];for(const m of b)this._el.contains(m.target)&&
g.push(m);return g}mergeHandlerResult(b,g,m,u,z){m&&(v.e(b,m),b={handlerName:u,originalEvent:m.originalEvent||z},void 0!==m.zoomDelta&&(g.zoom=b),void 0!==m.panDelta&&(g.drag=b),void 0!==m.rollDelta&&(g.roll=b),void 0!==m.pitchDelta&&(g.pitch=b),void 0!==m.bearingDelta&&(g.rotate=b))}_applyChanges(){const b={},g={},m={};for(const [u,z,C]of this._changes)u.panDelta&&(b.panDelta=(b.panDelta||new v.P(0,0))._add(u.panDelta)),u.zoomDelta&&(b.zoomDelta=(b.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(b.bearingDelta=
(b.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(b.pitchDelta=(b.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(b.rollDelta=(b.rollDelta||0)+u.rollDelta),void 0!==u.around&&(b.around=u.around),void 0!==u.pinchAround&&(b.pinchAround=u.pinchAround),u.noInertia&&(b.noInertia=u.noInertia),v.e(g,z),v.e(m,C);this._updateMapTransform(b,g,m);this._changes=[]}_updateMapTransform(b,g,m){const u=this._map,z=u._getTransformForUpdate(),C=u.terrain;if(!(Rj(b)||C&&this._terrainMovement))return this._fireEvents(g,
m,!0);u._stop(!0);let {panDelta:G,zoomDelta:K,bearingDelta:R,pitchDelta:X,rollDelta:ca,around:ja,pinchAround:la}=b;void 0!==la&&(ja=la);ja=ja||u.transform.centerPoint;C&&!z.isPointOnMapSurface(ja)&&(ja=z.centerPoint);const pa={panDelta:G,zoomDelta:K,rollDelta:ca,pitchDelta:X,bearingDelta:R,around:ja};this._map.cameraHelper.useGlobeControls&&!z.isPointOnMapSurface(ja)&&(ja=z.centerPoint);const ya=.01>ja.distSqr(z.centerPoint)?z.center:z.screenPointToLocation(G?ja.sub(G):ja);this._handleMapControls({terrain:C,
tr:z,deltasForHelper:pa,preZoomAroundLoc:ya,combinedEventsInProgress:g,panDelta:G});u._applyUpdatedTransform(z);this._map._update();b.noInertia||this._inertia.record(b);this._fireEvents(g,m,!0)}_handleMapControls({terrain:b,tr:g,deltasForHelper:m,preZoomAroundLoc:u,combinedEventsInProgress:z,panDelta:C}){const G=this._map.cameraHelper;if(G.handleMapControlsRollPitchBearingZoom(m,g),b)return G.useGlobeControls?(this._terrainMovement||!z.drag&&!z.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=
!0),void G.handleMapControlsPan(m,g,u)):this._terrainMovement||!z.drag&&!z.zoom?void(z.drag&&this._terrainMovement&&C?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(C))):G.handleMapControlsPan(m,g,u)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void G.handleMapControlsPan(m,g,u));G.handleMapControlsPan(m,g,u)}_fireEvents(b,g,m){var u=li(this._eventsInProgress),z=li(b),C={};for(const K in b){const {originalEvent:R}=b[K];this._eventsInProgress[K]||(C[`${K}start`]=R);this._eventsInProgress[K]=
b[K]}!u&&z&&this._fireEvent("movestart",z.originalEvent);for(const K in C)this._fireEvent(K,C[K]);z&&this._fireEvent("move",z.originalEvent);for(const K in b)({originalEvent:C}=b[K]),this._fireEvent(K,C);b={};let G;for(const K in this._eventsInProgress){const {handlerName:R,originalEvent:X}=this._eventsInProgress[K];this._handlersById[R].isActive()||(delete this._eventsInProgress[K],G=g[R]||X,b[`${K}end`]=G)}for(const K in b)this._fireEvent(K,b[K]);g=li(this._eventsInProgress);(u=(u||z)&&!g)&&this._terrainMovement&&
(this._terrainMovement=this._map._elevationFreeze=!1,z=this._map._getTransformForUpdate(),this._map.getCenterClampedToGround()&&z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(z));m&&u&&(this._updatingCamera=!0,m=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),u=K=>0!==K&&-this._bearingSnap<K&&K<this._bearingSnap,!m||!m.essential&&qd.prefersReducedMotion?(this._map.fire(new v.l("moveend",{originalEvent:G})),u(this._map.getBearing())&&this._map.resetNorth()):
(u(m.bearing||this._map.getBearing())&&(m.bearing=0),m.freezeElevation=!0,this._map.easeTo(m,{originalEvent:G})),this._updatingCamera=!1)}_fireEvent(b,g){this._map.fire(new v.l(b,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(b=>{delete this._frameId;this.handleEvent(new Sf("renderFrame",{timeStamp:b}));this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Ck extends v.E{constructor(b,
g,m){super();this._renderFrameCallback=()=>{const u=Math.min((qd.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u));1>u&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()};this._zooming=this._moving=!1;this.transform=b;this._bearingSnap=m.bearingSnap;this.cameraHelper=g;this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(b,g){b.apply(this.transform);this.transform=b;this.cameraHelper=
g}getCenter(){return new v.S(this.transform.center.lng,this.transform.center.lat)}setCenter(b,g){return this.jumpTo({center:b},g)}getCenterElevation(){return this.transform.elevation}setCenterElevation(b,g){return this.jumpTo({elevation:b},g),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(b){this._centerClampedToGround=b}panBy(b,g,m){return b=v.P.convert(b).mult(-1),this.panTo(this.transform.center,v.e({offset:b},g),m)}panTo(b,g,m){return this.easeTo(v.e({center:b},
g),m)}getZoom(){return this.transform.zoom}setZoom(b,g){return this.jumpTo({zoom:b},g),this}zoomTo(b,g,m){return this.easeTo(v.e({zoom:b},g),m)}zoomIn(b,g){return this.zoomTo(this.getZoom()+1,b,g),this}zoomOut(b,g){return this.zoomTo(this.getZoom()-1,b,g),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(b,g){return b!=this.transform.fov&&(this.transform.setFov(b),this.fire(new v.l("movestart",g)).fire(new v.l("move",g)).fire(new v.l("moveend",g))),this}getBearing(){return this.transform.bearing}setBearing(b,
g){return this.jumpTo({bearing:b},g),this}getPadding(){return this.transform.padding}setPadding(b,g){return this.jumpTo({padding:b},g),this}rotateTo(b,g,m){return this.easeTo(v.e({bearing:b},g),m)}resetNorth(b,g){return this.rotateTo(0,v.e({duration:1E3},b),g),this}resetNorthPitch(b,g){return this.easeTo(v.e({bearing:0,pitch:0,roll:0,duration:1E3},b),g),this}snapToNorth(b,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(b,g):this}getPitch(){return this.transform.pitch}setPitch(b,
g){return this.jumpTo({pitch:b},g),this}getRoll(){return this.transform.roll}setRoll(b,g){return this.jumpTo({roll:b},g),this}cameraForBounds(b,g){b=qf.convert(b).adjustAntiMeridian();const m=g&&g.bearing||0;return this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),m,g)}_cameraForBoxAndBearing(b,g,m,u){var z={top:0,bottom:0,right:0,left:0};if("number"==typeof(u=v.e({padding:z,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding){var C=u.padding;u.padding={top:C,bottom:C,right:C,left:C}}z=
v.e(z,u.padding);u.padding=z;C=this.transform;b=new qf(b,g);return this.cameraHelper.cameraForBoxAndBearing(u,z,b,m,C)}fitBounds(b,g,m){return this._fitInternal(this.cameraForBounds(b,g),g,m)}fitScreenCoordinates(b,g,m,u,z){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(v.P.convert(b)),this.transform.screenPointToLocation(v.P.convert(g)),m,u),u,z)}_fitInternal(b,g,m){return b?(delete (g=v.e(b,g)).padding,g.linear?this.easeTo(g,m):this.flyTo(g,m)):this}jumpTo(b,
g){this.stop();const m=this._getTransformForUpdate();let u=!1,z=!1,C=!1;var G=m.zoom;this.cameraHelper.handleJumpToCenterZoom(m,b);G=m.zoom!==G;return"elevation"in b&&m.elevation!==+b.elevation&&m.setElevation(+b.elevation),"bearing"in b&&m.bearing!==+b.bearing&&(u=!0,m.setBearing(+b.bearing)),"pitch"in b&&m.pitch!==+b.pitch&&(z=!0,m.setPitch(+b.pitch)),"roll"in b&&m.roll!==+b.roll&&(C=!0,m.setRoll(+b.roll)),null==b.padding||m.isPaddingEqual(b.padding)||m.setPadding(b.padding),this._applyUpdatedTransform(m),
this.fire(new v.l("movestart",g)).fire(new v.l("move",g)),G&&this.fire(new v.l("zoomstart",g)).fire(new v.l("zoom",g)).fire(new v.l("zoomend",g)),u&&this.fire(new v.l("rotatestart",g)).fire(new v.l("rotate",g)).fire(new v.l("rotateend",g)),z&&this.fire(new v.l("pitchstart",g)).fire(new v.l("pitch",g)).fire(new v.l("pitchend",g)),C&&this.fire(new v.l("rollstart",g)).fire(new v.l("roll",g)).fire(new v.l("rollend",g)),this.fire(new v.l("moveend",g))}calculateCameraOptionsFromTo(b,g,m,u=0){b=v.a1.fromLngLat(b,
g);m=v.a1.fromLngLat(m,u);var z=m.x-b.x,C=m.y-b.y;b=m.z-b.z;const G=Math.hypot(z,C,b);if(0===G)throw Error("Can't calculate camera options with same From and To");const K=Math.hypot(z,C);g=v.ak(this.transform.cameraToCenterDistance/G/this.transform.tileSize);z=180*Math.atan2(z,-C)/Math.PI;C=180*Math.acos(K/G)/Math.PI;return C=0>b?90-C:90+C,{center:m.toLngLat(),elevation:u,zoom:g,pitch:C,bearing:z}}calculateCameraOptionsFromCameraLngLatAltRotation(b,g,m,u,z){b=this.transform.calculateCenterFromCameraLngLatAlt(b,
g,m,u);return{center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:m,pitch:u,roll:z}}easeTo(b,g){this._stop(!1,b.easeId);(!1===(b=v.e({offset:[0,0],duration:500,easing:v.co},b)).animate||!b.essential&&qd.prefersReducedMotion)&&(b.duration=0);const m=this._getTransformForUpdate(),u=this.getBearing(),z=m.pitch,C=m.roll,G="bearing"in b?this._normalizeBearing(b.bearing,u):u,K="pitch"in b?+b.pitch:z,R="roll"in b?this._normalizeBearing(b.roll,C):C,X="padding"in b?b.padding:m.padding,ca=v.P.convert(b.offset);
let ja,la;b.around&&(ja=v.S.convert(b.around),la=m.locationToScreenPoint(ja));const pa={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ya=this.cameraHelper.handleEaseTo(m,{bearing:G,pitch:K,roll:R,padding:X,around:ja,aroundPoint:la,offsetAsPoint:ca,offset:b.offset,zoom:b.zoom,center:b.center});return this._rotating=this._rotating||u!==G,this._pitching=this._pitching||K!==z,this._rolling=this._rolling||R!==C,this._padding=!m.isPaddingEqual(X),
this._zooming=this._zooming||ya.isZooming,this._easeId=b.easeId,this._prepareEase(g,b.noMoveStart,pa),this.terrain&&this._prepareElevation(ya.elevationCenter),this._ease(Ba=>{ya.easeFunc(Ba);this.terrain&&!b.freezeElevation&&this._updateElevation(Ba);this._applyUpdatedTransform(m);this._fireMoveEvents(g)},Ba=>{this.terrain&&b.freezeElevation&&this._finalizeElevation();this._afterEase(g,Ba)},b),this}_prepareEase(b,g,m={}){this._moving=!0;g||m.moving||this.fire(new v.l("movestart",b));this._zooming&&
!m.zooming&&this.fire(new v.l("zoomstart",b));this._rotating&&!m.rotating&&this.fire(new v.l("rotatestart",b));this._pitching&&!m.pitching&&this.fire(new v.l("pitchstart",b));this._rolling&&!m.rolling&&this.fire(new v.l("rollstart",b))}_prepareElevation(b){this._elevationCenter=b;this._elevationStart=this.transform.elevation;this._elevationTarget=this.terrain.getElevationForLngLatZoom(b,this.transform.tileZoom);this._elevationFreeze=!0}_updateElevation(b){void 0!==this._elevationStart&&void 0!==this._elevationCenter||
this._prepareElevation(this.transform.center);this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const g=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(1>b&&g!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=b*(m-(g-(m*b+this._elevationStart))/(1-b));this._elevationTarget=g}this.transform.setElevation(v.C.number(this._elevationStart,
this._elevationTarget,b))}_finalizeElevation(){this._elevationFreeze=!1;this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(b){if(!this.terrain&&0<=b.elevation&&90>=b.pitch)return{};const g=b.getCameraLngLat(),m=b.getCameraAltitude(),u=this.terrain?
this.terrain.getElevationForLngLatZoom(g,b.zoom):0;return m<u?(b=this.calculateCameraOptionsFromTo(g,u,b.center,b.elevation),{pitch:b.pitch,zoom:b.zoom}):{}}_applyUpdatedTransform(b){var g=[];if(g.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&g.push(m=>this.transformCameraUpdate(m)),g.length){b=b.clone();for(const m of g){g=b.clone();const {center:u,zoom:z,roll:C,pitch:G,bearing:K,elevation:R}=m(g);u&&g.setCenter(u);void 0!==R&&g.setElevation(R);void 0!==z&&g.setZoom(z);
void 0!==C&&g.setRoll(C);void 0!==G&&g.setPitch(G);void 0!==K&&g.setBearing(K);b.apply(g)}this.transform.apply(b)}}_fireMoveEvents(b){this.fire(new v.l("move",b));this._zooming&&this.fire(new v.l("zoom",b));this._rotating&&this.fire(new v.l("rotate",b));this._pitching&&this.fire(new v.l("pitch",b));this._rolling&&this.fire(new v.l("roll",b))}_afterEase(b,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;g=this._zooming;var m=this._rotating,u=this._pitching,z=this._rolling;this._padding=
this._rolling=this._pitching=this._rotating=this._zooming=this._moving=!1;g&&this.fire(new v.l("zoomend",b));m&&this.fire(new v.l("rotateend",b));u&&this.fire(new v.l("pitchend",b));z&&this.fire(new v.l("rollend",b));this.fire(new v.l("moveend",b))}}flyTo(b,g){function m(Jb){Jb=(Za*Za-Qa*Qa+(Jb?-1:1)*ob*ob*sb*sb)/(2*(Jb?Za:Qa)*ob*sb);return Math.log(Math.sqrt(Jb*Jb+1)-Jb)}function u(Jb){return(Math.exp(Jb)+Math.exp(-Jb))/2}if(!b.essential&&qd.prefersReducedMotion){var z=v.Q(b,"center zoom bearing pitch roll elevation".split(" "));
return this.jumpTo(z,g)}this.stop();b=v.e({offset:[0,0],speed:1.2,curve:1.42,easing:v.co},b);const C=this._getTransformForUpdate(),G=C.bearing,K=C.pitch,R=C.roll,X=C.padding,ca="bearing"in b?this._normalizeBearing(b.bearing,G):G,ja="pitch"in b?+b.pitch:K,la="roll"in b?this._normalizeBearing(b.roll,R):R,pa="padding"in b?b.padding:C.padding,ya=v.P.convert(b.offset);let Ba=C.centerPoint.add(ya);z=C.screenPointToLocation(Ba);const za=this.cameraHelper.handleFlyTo(C,{bearing:ca,pitch:ja,roll:la,padding:pa,
locationAtOffset:z,offsetAsPoint:ya,center:b.center,minZoom:b.minZoom,zoom:b.zoom});let Ea=b.curve;const Qa=Math.max(C.width,C.height),Za=Qa/za.scaleOfZoom,sb=za.pixelPathLength;"number"==typeof za.scaleOfMinZoom&&(Ea=Math.sqrt(Qa/za.scaleOfMinZoom/sb*2));const ob=Ea*Ea,eb=m(!1);let Db=function(Jb){return u(eb)/u(eb+Ea*Jb)},Nb=function(Jb){var $b=u(eb),vc=Jb=eb+Ea*Jb;return Qa*(($b*((Math.exp(vc)-Math.exp(-vc))/2/u(Jb))-(Math.exp(eb)-Math.exp(-eb))/2)/ob)/sb},Ob=(m(!0)-eb)/Ea;if(2E-6>Math.abs(sb)||
!isFinite(Ob)){if(1E-6>Math.abs(Qa-Za))return this.easeTo(b,g);const Jb=Za<Qa?-1:1;Ob=Math.abs(Math.log(Za/Qa))/Ea;Nb=()=>0;Db=$b=>Math.exp(Jb*Ea*$b)}return b.duration="duration"in b?+b.duration:1E3*Ob/("screenSpeed"in b?+b.screenSpeed/Ea:+b.speed),b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=G!==ca,this._pitching=ja!==K,this._rolling=la!==R,this._padding=!C.isPaddingEqual(pa),this._prepareEase(g,!1),this.terrain&&this._prepareElevation(za.targetCenter),
this._ease(Jb=>{var $b=Jb*Ob;const vc=1/Db($b);$b=Nb($b);this._rotating&&C.setBearing(v.C.number(G,ca,Jb));this._pitching&&C.setPitch(v.C.number(K,ja,Jb));this._rolling&&C.setRoll(v.C.number(R,la,Jb));this._padding&&(C.interpolatePadding(X,pa,Jb),Ba=C.centerPoint.add(ya));za.easeFunc(Jb,vc,$b,Ba);this.terrain&&!b.freezeElevation&&this._updateElevation(Jb);this._applyUpdatedTransform(C);this._fireMoveEvents(g)},()=>{this.terrain&&b.freezeElevation&&this._finalizeElevation();this._afterEase(g)},b),
this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(b,g){var m;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd;u.call(this,g)}return b||null===(m=this.handlers)||void 0===m||m.stop(!1),this}_ease(b,g,m){!1===m.animate||0===m.duration?(b(1),g()):(this._easeStart=qd.now(),this._easeOptions=m,this._onEaseFrame=b,this._onEaseEnd=g,this._easeFrameId=
this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(b,g){b=v.aO(b,-180,180);const m=Math.abs(b-g);return Math.abs(b-360-g)<m&&(b-=360),Math.abs(b+360-g)<m&&(b+=360),b}queryTerrainElevation(b){return this.terrain?this.terrain.getElevationForLngLatZoom(v.S.convert(b),this.transform.tileZoom):null}}const Kj={compact:!0,customAttribution:'\x3ca href\x3d"https://maplibre.org/" target\x3d"_blank"\x3eMapLibre\x3c/a\x3e'};class Fk{constructor(b=Kj){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&
(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))};this._updateData=g=>{!g||"metadata"!==g.sourceDataType&&"visibility"!==g.sourceDataType&&"style"!==g.dataType&&"terrain"!==g.type||this._updateAttributions()};this._updateCompact=()=>{640>=this._map.getCanvasContainer().offsetWidth||this._compact?
!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))};this._updateCompactMinimize=
()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")};this.options=b}getDefaultPosition(){return"bottom-right"}onAdd(b){return this._map=b,this._compact=this.options.compact,this._container=rb.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=rb.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",
this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=rb.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){rb.remove(this._container);this._map.off("styledata",
this._updateData);this._map.off("sourcedata",this._updateData);this._map.off("terrain",this._updateData);this._map.off("resize",this._updateCompact);this._map.off("drag",this._updateCompactMinimize);this._attribHTML=this._compact=this._map=void 0}_setElementTitle(b,g){g=this._map._getUIString(`AttributionControl.${g}`);b.title=g;b.setAttribute("aria-label",g)}_updateAttributions(){if(this._map.style){var b=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?b=b.concat(this.options.customAttribution.map(z=>
"string"!=typeof z?"":z)):"string"==typeof this.options.customAttribution&&b.push(this.options.customAttribution)),this._map.style.stylesheet){var g=this._map.style.stylesheet;this.styleOwner=g.owner;this.styleId=g.id}g=this._map.style.sourceCaches;for(var m in g){var u=g[m];if(u.used||u.usedForTerrain)u=u.getSource(),u.attribution&&0>b.indexOf(u.attribution)&&b.push(u.attribution)}b=b.filter(z=>String(z).trim());b.sort((z,C)=>z.length-C.length);b=b.filter((z,C)=>{for(C+=1;C<b.length;C++)if(0<=b[C].indexOf(z))return!1;
return!0});m=b.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,b.length?(this._innerContainer.innerHTML=rb.sanitize(m),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}}class rm{constructor(b={}){this._updateCompact=()=>{var g=this._container.children;g.length&&(g=g[0],640>=this._map.getCanvasContainer().offsetWidth||this._compact?!1!==this._compact&&g.classList.add("maplibregl-compact"):
g.classList.remove("maplibregl-compact"))};this.options=b}getDefaultPosition(){return"bottom-left"}onAdd(b){this._map=b;this._compact=this.options&&this.options.compact;this._container=rb.create("div","maplibregl-ctrl");b=rb.create("a","maplibregl-ctrl-logo");return b.target="_blank",b.rel="noopener nofollow",b.href="https://maplibre.org/",b.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),b.setAttribute("rel","noopener nofollow"),this._container.appendChild(b),this._container.style.display=
"block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){rb.remove(this._container);this._map.off("resize",this._updateCompact);this._compact=this._map=void 0}}class Nl{constructor(){this._queue=[];this._id=0;this._currentlyRunning=this._cleared=!1}add(b){const g=++this._id;return this._queue.push({callback:b,id:g,cancelled:!1}),g}remove(b){var g=this._currentlyRunning;g=g?this._queue.concat(g):this._queue;for(const m of g)if(m.id===b)return void(m.cancelled=
!0)}run(b=0){if(this._currentlyRunning)throw Error("Attempting to run(), but is already running.");const g=this._currentlyRunning=this._queue;this._queue=[];for(const m of g)if(!m.cancelled&&(m.callback(b),this._cleared))break;this._currentlyRunning=this._cleared=!1}clear(){this._currentlyRunning&&(this._cleared=!0);this._queue=[]}}var kj=v.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Of extends v.E{constructor(b){super();this._lastTilesetChange=qd.now();this.sourceCache=b;this._tiles={};
this._renderableTilesKeys=[];this._sourceTileCache={};this.minzoom=0;this.maxzoom=22;this.deltaZoom=1;this.tileSize=b._source.tileSize*2**this.deltaZoom;b.usedForTerrain=!0;b.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1;this.sourceCache.tileSize=null}update(b,g){this.sourceCache.update(b,g);this._renderableTilesKeys=[];const m={};for(const u of Nc(b,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:g,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))m[u.key]=
!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),v.bZ(u.terrainRttPosMatrix32f,0,v.$,v.$,0,0,1),this._tiles[u.key]=new bi(u,this.tileSize),this._lastTilesetChange=qd.now());for(const u in this._tiles)m[u]||delete this._tiles[u]}freeRtt(b){for(const g in this._tiles){const m=this._tiles[g];(!b||m.tileID.equals(b)||m.tileID.isChildOf(b)||b.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(b=>this.getTileByID(b))}getTileByID(b){return this._tiles[b]}getTerrainCoords(b,
g){return g?this._getTerrainCoordsForTileRanges(b,g):this._getTerrainCoordsForRegularTile(b)}_getTerrainCoordsForRegularTile(b){const g={};for(const C of this._renderableTilesKeys){var m=this._tiles[C].tileID;const G=b.clone(),K=v.ba();if(m.canonical.equals(b.canonical))v.bZ(K,0,v.$,v.$,0,0,1);else if(m.canonical.isChildOf(b.canonical)){var u=m.canonical.z-b.canonical.z,z=m.canonical.x-(m.canonical.x>>u<<u);m=m.canonical.y-(m.canonical.y>>u<<u);u=v.$>>u;v.bZ(K,0,u,u,0,0,1);v.M(K,K,[-z*u,-m*u,0])}else{if(!b.canonical.isChildOf(m.canonical))continue;
z=b.canonical.z-m.canonical.z;u=b.canonical.x-(b.canonical.x>>z<<z);m=b.canonical.y-(b.canonical.y>>z<<z);const R=v.$>>z;v.bZ(K,0,v.$,v.$,0,0,1);v.M(K,K,[u*R,m*R,0]);v.N(K,K,[1/2**z,1/2**z,0])}G.terrainRttPosMatrix32f=new Float32Array(K);g[C]=G}return g}_getTerrainCoordsForTileRanges(b,g){const m={};for(const R of this._renderableTilesKeys){var u=this._tiles[R].tileID;if(!this._isWithinTileRanges(u,g))continue;const X=b.clone(),ca=v.ba();if(u.canonical.z===b.canonical.z){var z=b.canonical.x-u.canonical.x;
u=b.canonical.y-u.canonical.y;v.bZ(ca,0,v.$,v.$,0,0,1);v.M(ca,ca,[z*v.$,u*v.$,0])}else if(u.canonical.z>b.canonical.z){var C=u.canonical.z-b.canonical.z;z=u.canonical.x-(u.canonical.x>>C<<C);var G=u.canonical.y-(u.canonical.y>>C<<C),K=b.canonical.x-(u.canonical.x>>C);u=b.canonical.y-(u.canonical.y>>C);C=v.$>>C;v.bZ(ca,0,C,C,0,0,1);v.M(ca,ca,[-z*C+K*v.$,-G*C+u*v.$,0])}else C=b.canonical.z-u.canonical.z,z=b.canonical.x-(b.canonical.x>>C<<C),G=b.canonical.y-(b.canonical.y>>C<<C),K=(b.canonical.x>>C)-
u.canonical.x,u=(b.canonical.y>>C)-u.canonical.y,C=v.$<<C,v.bZ(ca,0,C,C,0,0,1),v.M(ca,ca,[z*v.$+K*C,G*v.$+u*C,0]);X.terrainRttPosMatrix32f=new Float32Array(ca);m[R]=X}return m}getSourceTile(b,g){const m=this.sourceCache._source;let u=b.overscaledZ-this.deltaZoom;if(u>m.maxzoom&&(u=m.maxzoom),u<m.minzoom)return null;this._sourceTileCache[b.key]||(this._sourceTileCache[b.key]=b.scaledTo(u).key);let z=this.sourceCache.getTileByID(this._sourceTileCache[b.key]);if((!z||!z.dem)&&g)for(;u>=m.minzoom&&(!z||
!z.dem);)z=this.sourceCache.getTileByID(b.scaledTo(u--).key);return z}anyTilesAfterTime(b=Date.now()){return this._lastTilesetChange>=b}_isWithinTileRanges(b,g){return g[b.canonical.z]&&b.canonical.x>=g[b.canonical.z].minTileX&&b.canonical.x<=g[b.canonical.z].maxTileX&&b.canonical.y>=g[b.canonical.z].minTileY&&b.canonical.y<=g[b.canonical.z].maxTileY}}class Dk{constructor(b,g,m){this._meshCache={};this.painter=b;this.sourceCache=new Of(g);this.options=m;this.exaggeration="number"==typeof m.exaggeration?
m.exaggeration:1;this.qualityFactor=2;this.meshSize=128;this._demMatrixCache={};this.coordsIndex=[];this._coordsTextureSize=1024}getDEMElevation(b,g,m,u=v.$){var z;if(!(0<=g&&g<u&&0<=m&&m<u))return 0;const C=this.getTerrainData(b);b=null===(z=C.tile)||void 0===z?void 0:z.dem;if(!b)return 0;g=v.cs([],[g/u*v.$,m/u*v.$],C.u_terrain_matrix);z=[g[0]*b.dim,g[1]*b.dim];g=Math.floor(z[0]);m=Math.floor(z[1]);u=z[0]-g;z=z[1]-m;return b.get(g,m)*(1-u)*(1-z)+b.get(g+1,m)*u*(1-z)+b.get(g,m+1)*(1-u)*z+b.get(g+
1,m+1)*u*z}getElevationForLngLatZoom(b,g){if(!v.ct(g,b.wrap()))return 0;const {tileID:m,mercatorX:u,mercatorY:z}=this._getOverscaledTileIDFromLngLatZoom(b,g);return this.getElevation(m,u%v.$,z%v.$,v.$)}getElevation(b,g,m,u=v.$){return this.getDEMElevation(b,g,m,u)*this.exaggeration}getTerrainData(b){if(!this._emptyDemTexture){var g=this.painter.context,m=new v.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new v.T(g,m,g.gl.RGBA,{premultiply:!1});this._emptyDemUnpack=[0,0,0,0];this._emptyDemTexture=
new v.T(g,new v.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1});this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE);this._emptyDemMatrix=v.ag([])}(g=this.sourceCache.getSourceTile(b,!0))&&g.dem&&(!g.demTexture||g.needsTerrainPrepare)&&(m=this.painter.context,g.demTexture=this.painter.getTileTexture(g.dem.stride),g.demTexture?g.demTexture.update(g.dem.getPixels(),{premultiply:!1}):g.demTexture=new v.T(m,g.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),g.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),
g.needsTerrainPrepare=!1);if((m=g&&g+g.tileID.key+b.key)&&!this._demMatrixCache[m]){var u=this.sourceCache.sourceCache._source.maxzoom,z=b.canonical.z-g.tileID.canonical.z;b.overscaledZ>b.canonical.z&&(b.canonical.z>=u?z=b.canonical.z-u:v.w("cannot calculate elevation if elevation maxzoom \x3e source.maxzoom"));u=b.canonical.x-(b.canonical.x>>z<<z);const C=b.canonical.y-(b.canonical.y>>z<<z);z=v.cu(new Float64Array(16),[1/(v.$<<z),1/(v.$<<z),0]);v.M(z,z,[u*v.$,C*v.$,0]);this._demMatrixCache[b.key]=
{matrix:z,coord:b}}return{u_depth:2,u_terrain:3,u_terrain_dim:g&&g.dem&&g.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[b.key].matrix:this._emptyDemMatrix,u_terrain_unpack:g&&g.dem&&g.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(g&&g.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:g}}getFramebuffer(b){const g=this.painter,m=g.width/devicePixelRatio,u=g.height/devicePixelRatio;
return!this._fbo||this._fbo.width===m&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new v.T(g.context,{width:m,height:u,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new v.T(g.context,{width:m,
height:u,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=g.context.createFramebuffer(m,u,!0,!1),this._fbo.depthAttachment.set(g.context.createRenderbuffer(g.context.gl.DEPTH_COMPONENT16,m,u))),this._fbo.colorAttachment.set("coords"===b?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const b=this.painter.context;if(this._coordsTexture)return this._coordsTexture;
var g=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,u=0;m<this._coordsTextureSize;m++)for(let z=0;z<this._coordsTextureSize;z++,u+=4)g[u+0]=255&z,g[u+1]=255&m,g[u+2]=z>>8<<4|m>>8,g[u+3]=0;g=new v.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(g.buffer));g=new v.T(b,g,b.gl.RGBA,{premultiply:!1});return g.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(b){this.painter.maybeDrawDepthAndCoords(!0);var g=new Uint8Array(4),
m=this.painter.context,u=m.gl,z=Math.round(b.x*this.painter.pixelRatio/devicePixelRatio);b=Math.round(b.y*this.painter.pixelRatio/devicePixelRatio);const C=Math.round(this.painter.height/devicePixelRatio);m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer);u.readPixels(z,C-b-1,1,1,u.RGBA,u.UNSIGNED_BYTE,g);m.bindFramebuffer.set(null);m=g[0]+(g[2]>>4<<8);u=g[1]+((15&g[2])<<8);g=(g=this.coordsIndex[255-g[3]])&&this.sourceCache.getTileByID(g);if(!g)return null;z=this._coordsTextureSize;
b=(1<<g.tileID.canonical.z)*z;return new v.a1((g.tileID.canonical.x*z+m)/b+g.tileID.wrap,(g.tileID.canonical.y*z+u)/b,this.getElevation(g.tileID,m,u,z))}depthAtPoint(b){const g=new Uint8Array(4),m=this.painter.context,u=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(b.x,this.painter.height/devicePixelRatio-b.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,g),m.bindFramebuffer.set(null),(g[0]/16777216+g[1]/65536+g[2]/256+g[3])/256}getTerrainMesh(b){var g,m=0<(null===(g=this.painter.style.projection)||
void 0===g?void 0:g.transitionState),u=m&&0===b.canonical.y,z=m&&b.canonical.y===(1<<b.canonical.z)-1;b=`m_${u?"n":""}_${z?"s":""}`;if(this._meshCache[b])return this._meshCache[b];m=this.painter.context;g=new v.cv;const C=new v.aN,G=this.meshSize,K=v.$/G;var R=G*G;for(var X=0;X<=G;X++)for(var ca=0;ca<=G;ca++)g.emplaceBack(ca*K,X*K,0);for(X=0;X<R;X+=G+1)for(ca=0;ca<G;ca++)C.emplaceBack(ca+X,G+ca+X+1,G+ca+X+2),C.emplaceBack(ca+X,G+ca+X+2,ca+X+1);R=g.length;X=R+(G+1);ca=(G+1)*G;var ja=u?v.bh:0;const la=
u?0:1;u=z?v.bi:v.$;z=z?0:1;for(let ya=0;ya<=G;ya++)g.emplaceBack(ya*K,ja,la);for(ja=0;ja<=G;ja++)g.emplaceBack(ja*K,u,z);for(u=0;u<G;u++)C.emplaceBack(ca+u,X+u,X+u+1),C.emplaceBack(ca+u,X+u+1,ca+u+1),C.emplaceBack(0+u,R+u+1,R+u),C.emplaceBack(0+u,0+u+1,R+u+1);u=g.length;z=u+2*(G+1);for(var pa of[0,1])for(R=0;R<=G;R++)for(const ya of[0,1])g.emplaceBack(pa*v.$,R*K,ya);for(pa=0;pa<2*G;pa+=2)C.emplaceBack(u+pa,u+pa+1,u+pa+3),C.emplaceBack(u+pa,u+pa+3,u+pa+2),C.emplaceBack(z+pa,z+pa+3,z+pa+1),C.emplaceBack(z+
pa,z+pa+2,z+pa+3);pa=new sg(m.createVertexBuffer(g,kj.members),m.createIndexBuffer(C),v.aM.simpleSegment(0,0,g.length,C.length));return this._meshCache[b]=pa,pa}getMeshFrameDelta(b){return 2*Math.PI*v.bu/Math.pow(2,Math.max(b,0))/5}getMinTileElevationForLngLatZoom(b,g){var m;({tileID:b}=this._getOverscaledTileIDFromLngLatZoom(b,g));return null!==(m=this.getMinMaxElevation(b).minElevation)&&void 0!==m?m:0}getMinMaxElevation(b){b=this.getTerrainData(b).tile;const g={minElevation:null,maxElevation:null};
return b&&b.dem&&(g.minElevation=b.dem.min*this.exaggeration,g.maxElevation=b.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(b,g){var m=v.a1.fromLngLat(b.wrap());const u=(1<<g)*v.$;b=m.x*u;m=m.y*u;return{tileID:new v.Z(g,0,g,Math.floor(b/v.$),Math.floor(m/v.$)),mercatorX:b,mercatorY:m}}}class fk{constructor(b,g,m){this._context=b;this._size=g;this._tileSize=m;this._objects=[];this._recentlyUsed=[];this._stamp=0}destruct(){for(const b of this._objects)b.texture.destroy(),b.fbo.destroy()}_createObject(b){const g=
this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new v.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),g.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,
this._tileSize,this._tileSize)),g.colorAttachment.set(m.texture),{id:b,fbo:g,texture:m,stamp:-1,inUse:!1}}getObjectForId(b){return this._objects[b]}useObject(b){b.inUse=!0;this._recentlyUsed=this._recentlyUsed.filter(g=>b.id!==g);this._recentlyUsed.push(b.id)}stampObject(b){b.stamp=++this._stamp}getOrCreateFreeObject(){for(var b of this._recentlyUsed)if(!this._objects[b].inUse)return this._objects[b];if(this._objects.length>=this._size)throw Error("No free RenderPool available, call freeAllObjects() required!");
b=this._createObject(this._objects.length);return this._objects.push(b),b}freeObject(b){b.inUse=!1}freeAllObjects(){for(const b of this._objects)this.freeObject(b)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(b=>!b.inUse)}}const Cf={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Uc{constructor(b,g){this.painter=b;this.terrain=g;this.pool=new fk(b.context,30,g.sourceCache.tileSize*g.qualityFactor)}destruct(){this.pool.destruct()}getTexture(b){return this.pool.getObjectForId(b.rtt[this._stacks.length-
1].id).texture}prepareForRender(b,g){this._stacks=[];this._prevType=null;this._rttTiles=[];this._renderableTiles=this.terrain.sourceCache.getRenderableTiles();this._renderableLayerIds=b._order.filter(K=>!b._layers[K].isHidden(g));this._coordsAscending={};for(var m in b.sourceCaches){this._coordsAscending[m]={};var u=b.sourceCaches[m].getVisibleCoordinates(),z=b.sourceCaches[m].getSource();z=z instanceof Td?z.terrainTileRanges:null;for(var C of u){u=this.terrain.sourceCache.getTerrainCoords(C,z);for(const K in u)this._coordsAscending[m][K]||
(this._coordsAscending[m][K]=[]),this._coordsAscending[m][K].push(u[K])}}this._coordsAscendingStr={};for(var G of b._order)if(m=b._layers[G],C=m.source,Cf[m.type]&&!this._coordsAscendingStr[C]){this._coordsAscendingStr[C]={};for(const K in this._coordsAscending[C])this._coordsAscendingStr[C][K]=this._coordsAscending[C][K].map(R=>R.key).sort().join()}for(const K of this._renderableTiles)for(const R in this._coordsAscendingStr)(G=this._coordsAscendingStr[R][K.tileID.key])&&G!==K.rttCoords[R]&&(K.rtt=
[])}renderLayer(b,g){if(b.isHidden(this.painter.transform.zoom))return!1;g=Object.assign(Object.assign({},g),{isRenderingToTexture:!0});const m=b.type,u=this.painter;var z=this._renderableLayerIds[this._renderableLayerIds.length-1]===b.id;if(Cf[m]&&(this._prevType&&Cf[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(b.id),!z))return!0;if(Cf[this._prevType]||Cf[m]&&z){this._prevType=m;b=this._stacks.length-1;z=this._stacks[b]||[];for(const G of this._renderableTiles){if(this.pool.isFull()&&
(Id(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(G),G.rtt[b]){var C=this.pool.getObjectForId(G.rtt[b].id);if(C.stamp===G.rtt[b].stamp){this.pool.useObject(C);continue}}C=this.pool.getOrCreateFreeObject();this.pool.useObject(C);this.pool.stampObject(C);G.rtt[b]={id:C.id,stamp:C.stamp};u.context.bindFramebuffer.set(C.fbo.framebuffer);u.context.clear({color:v.bf.transparent,stencil:0});u.currentStencilSource=void 0;for(let K=0;K<z.length;K++){const R=
u.style._layers[z[K]],X=R.source?this._coordsAscending[R.source][G.tileID.key]:[G.tileID];u.context.viewport.set([0,0,C.fbo.width,C.fbo.height]);u._renderTileClippingMasks(R,X,!0);u.renderLayer(u,u.style.sourceCaches[R.source],R,X,g);R.source&&(G.rttCoords[R.source]=this._coordsAscendingStr[R.source][G.tileID.key])}}return Id(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),Cf[m]}return!1}}const oc={"AttributionControl.ToggleAttribution":"Toggle attribution",
"AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft",
"ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},
Rg={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Kj,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,
pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:v.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ak={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Kg{constructor(b,g,m=!1){this.mousedown=
z=>{this.startMove(z,rb.mousePos(this.element,z));rb.addEventListener(window,"mousemove",this.mousemove);rb.addEventListener(window,"mouseup",this.mouseup)};this.mousemove=z=>{this.move(z,rb.mousePos(this.element,z))};this.mouseup=z=>{this._rotatePitchHandler.dragEnd(z);this.offTemp()};this.touchstart=z=>{1!==z.targetTouches.length?this.reset():(this._startPos=this._lastPos=rb.touchPos(this.element,z.targetTouches)[0],this.startMove(z,this._startPos),rb.addEventListener(window,"touchmove",this.touchmove,
{passive:!1}),rb.addEventListener(window,"touchend",this.touchend))};this.touchmove=z=>{1!==z.targetTouches.length?this.reset():(this._lastPos=rb.touchPos(this.element,z.targetTouches)[0],this.move(z,this._lastPos))};this.touchend=z=>{0===z.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click();delete this._startPos;delete this._lastPos;this.offTemp()};this.reset=()=>{this._rotatePitchHandler.reset();delete this._startPos;
delete this._lastPos;this.offTemp()};this._clickTolerance=10;this.element=g;const u=new Ri;this._rotatePitchHandler=new fg({clickTolerance:3,move:(z,C)=>{var G=g.getBoundingClientRect();G=new v.P((G.bottom-G.top)/2,(G.right-G.left)/2);return{bearingDelta:v.cn(new v.P(z.x,C.y),C,G),pitchDelta:m?-.5*(C.y-z.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}});this.map=b;rb.addEventListener(g,"mousedown",this.mousedown);rb.addEventListener(g,"touchstart",this.touchstart,{passive:!1});rb.addEventListener(g,
"touchcancel",this.reset)}startMove(b,g){this._rotatePitchHandler.dragStart(b,g);rb.disableDrag()}move(b,g){const m=this.map,{bearingDelta:u,pitchDelta:z}=this._rotatePitchHandler.dragMove(b,g)||{};u&&m.setBearing(m.getBearing()+u);z&&m.setPitch(m.getPitch()+z)}off(){const b=this.element;rb.removeEventListener(b,"mousedown",this.mousedown);rb.removeEventListener(b,"touchstart",this.touchstart,{passive:!1});rb.removeEventListener(window,"touchmove",this.touchmove,{passive:!1});rb.removeEventListener(window,
"touchend",this.touchend);rb.removeEventListener(b,"touchcancel",this.reset);this.offTemp()}offTemp(){rb.enableDrag();rb.removeEventListener(window,"mousemove",this.mousemove);rb.removeEventListener(window,"mouseup",this.mouseup);rb.removeEventListener(window,"touchmove",this.touchmove,{passive:!1});rb.removeEventListener(window,"touchend",this.touchend)}}let lj;const Th={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)",
"bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Lj extends v.E{constructor(b){if(super(),this._onKeyPress=C=>{const G=C.code;C=C.charCode||C.keyCode;"Space"!==G&&"Enter"!==G&&32!==C&&13!==C||this.togglePopup()},this._onMapClick=C=>{C=C.originalEvent.target;const G=this._element;this._popup&&(C===G||G.contains(C))&&this.togglePopup()},this._update=C=>{if(this._map){var G=this._map.loaded()&&!this._map.isMoving();
("terrain"===(null==C?void 0:C.type)||"render"===(null==C?void 0:C.type)&&!G)&&this._map.once("render",this._update);this._lngLat=Tf(this._lngLat,this._flatPos,this._map.transform);this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset);this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));G="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?G=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&
(G=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);var K="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?K="rotateX(0deg)":"map"===this._pitchAlignment&&(K=`rotateX(${this._map.getPitch()}deg)`);this._subpixelPositioning||C&&"moveend"!==C.type||(this._pos=this._pos.round());rb.setTransform(this._element,`${Th[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${K} ${G}`);qd.frameAsync(new AbortController).then(()=>{this._updateOpacity(C&&"moveend"===C.type)}).catch(()=>
{})}},this._onMove=C=>{if(!this._isDragging){const G=this._clickTolerance||this._map._clickTolerance;this._isDragging=C.point.dist(this._pointerdownPos)>=G}this._isDragging&&(this._pos=C.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.l("dragstart"))),this.fire(new v.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto";this._pointerdownPos=
this._positionDelta=null;this._isDragging=!1;this._map.off("mousemove",this._onMove);this._map.off("touchmove",this._onMove);"active"===this._state&&this.fire(new v.l("dragend"));this._state="inactive"},this._addDragHandler=C=>{this._element.contains(C.originalEvent.target)&&(C.preventDefault(),this._positionDelta=C.point.sub(this._pos).add(this._offset),this._pointerdownPos=C.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",
this._onUp),this._map.once("touchend",this._onUp))},this._anchor=b&&b.anchor||"center",this._color=b&&b.color||"#3FB1CE",this._scale=b&&b.scale||1,this._draggable=b&&b.draggable||!1,this._clickTolerance=b&&b.clickTolerance||0,this._subpixelPositioning=b&&b.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=b&&b.rotation||0,this._rotationAlignment=b&&b.rotationAlignment||"auto",this._pitchAlignment=b&&b.pitchAlignment&&"auto"!==b.pitchAlignment?b.pitchAlignment:this._rotationAlignment,
this.setOpacity(null==b?void 0:b.opacity,null==b?void 0:b.opacityWhenCovered),b&&b.element)this._element=b.element,this._offset=v.P.convert(b&&b.offset||[0,0]);else{this._defaultMarker=!0;this._element=rb.create("div");const C=rb.createNS("http://www.w3.org/2000/svg","svg");C.setAttributeNS(null,"display","block");C.setAttributeNS(null,"height","41px");C.setAttributeNS(null,"width","27px");C.setAttributeNS(null,"viewBox","0 0 27 41");var g=rb.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,
"stroke","none");g.setAttributeNS(null,"stroke-width","1");g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"fill-rule","evenodd");g=rb.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");const G=rb.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(3.0, 29.0)");G.setAttributeNS(null,"fill","#000000");var m=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},
{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(var u of m)m=rb.createNS("http://www.w3.org/2000/svg","ellipse"),m.setAttributeNS(null,"opacity","0.04"),m.setAttributeNS(null,"cx","10.5"),m.setAttributeNS(null,"cy","5.80029008"),m.setAttributeNS(null,"rx",u.rx),m.setAttributeNS(null,"ry",u.ry),G.appendChild(m);u=rb.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);m=rb.createNS("http://www.w3.org/2000/svg",
"path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z");u.appendChild(m);m=rb.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25");m.setAttributeNS(null,"fill","#000000");var z=rb.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z");
m.appendChild(z);z=rb.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(6.0, 7.0)");z.setAttributeNS(null,"fill","#FFFFFF");const K=rb.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const R=rb.createNS("http://www.w3.org/2000/svg","circle");R.setAttributeNS(null,"fill","#000000");R.setAttributeNS(null,"opacity","0.25");R.setAttributeNS(null,"cx","5.5");R.setAttributeNS(null,"cy","5.5");R.setAttributeNS(null,
"r","5.4999962");const X=rb.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF");X.setAttributeNS(null,"cx","5.5");X.setAttributeNS(null,"cy","5.5");X.setAttributeNS(null,"r","5.4999962");K.appendChild(R);K.appendChild(X);g.appendChild(G);g.appendChild(u);g.appendChild(m);g.appendChild(z);g.appendChild(K);C.appendChild(g);C.setAttributeNS(null,"height",41*this._scale+"px");C.setAttributeNS(null,"width",27*this._scale+"px");this._element.appendChild(C);this._offset=
v.P.convert(b&&b.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()}),vi(this._element,this._anchor,"marker"),b&&b.className)for(const C of b.className.split(" "))this._element.classList.add(C);this._popup=null}addTo(b){return this.remove(),this._map=b,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",b._getUIString("Marker.Title")),
this._element.hasAttribute("role")||this._element.setAttribute("role","button"),b.getCanvasContainer().appendChild(this._element),b.on("move",this._update),b.on("moveend",this._update),b.on("terrain",this._update),b.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),
this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),rb.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=
v.S.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(b){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),b){if(!("offset"in b.options)){const g=13.5/Math.SQRT2;b.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,
-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=b;(this._originalTabIndex=this._element.getAttribute("tabindex"))||this._element.setAttribute("tabindex","0");this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(b){return this._subpixelPositioning=b,this}getPopup(){return this._popup}togglePopup(){const b=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:b?(b.isOpen()?
b.remove():(b.setLngLat(this._lngLat),b.addTo(this._map)),this):this}_updateOpacity(b=!1){var g,m=null===(g=this._map)||void 0===g?void 0:g.terrain;g=this._map.transform.isLocationOccluded(this._lngLat);if(!m||g){var u=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==u&&(this._element.style.opacity=u))}if(b)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}b=this._map;g=b.terrain.depthAtPoint(this._pos);
m=b.terrain.getElevationForLngLatZoom(this._lngLat,b.transform.tileZoom);if(.006>b.transform.lngLatToCameraDepth(this._lngLat,m)-g)return void(this._element.style.opacity=this._opacity);g=-this._offset.y/b.transform.pixelsPerMeter;g*=Math.sin(b.getPitch()*Math.PI/180);const z=b.terrain.depthAtPoint(new v.P(this._pos.x,this._pos.y-this._offset.y));b=.006<b.transform.lngLatToCameraDepth(this._lngLat,m+g)-z;(null===(u=this._popup)||void 0===u?0:u.isOpen())&&b&&this._popup.remove();this._element.style.opacity=
b?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(b){return this._offset=v.P.convert(b),this._update(),this}addClassName(b){this._element.classList.add(b)}removeClassName(b){this._element.classList.remove(b)}toggleClassName(b){return this._element.classList.toggle(b)}setDraggable(b){return this._draggable=!!b,this._map&&(b?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),
this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(b){return this._rotation=b||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(b){return this._rotationAlignment=b||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(b){return this._pitchAlignment=b&&"auto"!==b?b:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(b,g){return(void 0===
this._opacity||void 0===b&&void 0===g)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==b&&(this._opacity=b),void 0!==g&&(this._opacityWhenCovered=g),this._map&&this._updateOpacity(!0),this}}const tl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6E3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let gk=0,Ah=!1;const Si={maxWidth:100,unit:"metric"},Ok={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",
subpixelPositioning:!1,locationOccludedOpacity:void 0};M.AJAXError=v.cz;M.Event=v.l;M.Evented=v.E;M.LngLat=v.S;M.MercatorCoordinate=v.a1;M.Point=v.P;M.addProtocol=v.cA;M.config=v.a;M.removeProtocol=v.cB;M.AttributionControl=Fk;M.BoxZoomHandler=Vg;M.CanvasSource=Ee;M.CooperativeGesturesHandler=Rl;M.DoubleClickZoomHandler=nf;M.DragPanHandler=ih;M.DragRotateHandler=Jj;M.EdgeInsets=Cb;M.FullscreenControl=class extends v.E{constructor(b={}){super();this._onFullscreenChange=()=>{var g;let m=window.document.fullscreenElement||
window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(g=null==m?void 0:m.shadowRoot)||void 0===g?0:g.fullscreenElement;)m=m.shadowRoot.fullscreenElement;m===this._container!==this._fullscreen&&this._handleFullscreenChange()};this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()};this._fullscreen=!1;b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:v.w("Full screen control 'container' must be a DOM element."));
"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=rb.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),
this._controlContainer}onRemove(){rb.remove(this._controlContainer);this._map=null;window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=rb.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);rb.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true");b.type="button";this._updateTitle();this._fullscreenButton.addEventListener("click",this._onClickFullscreen);window.document.addEventListener(this._fullscreenchange,
this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b);this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen;this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink");this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen");
this._updateTitle();this._fullscreen?(this.fire(new v.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new v.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():
window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen");
this._handleFullscreenChange();this._map.resize()}};M.GeoJSONSource=kg;const hk=class{constructor(){this._toggleProjection=()=>{var b;const g=null===(b=this._map.getProjection())||void 0===b?void 0:b.type;this._map.setProjection("mercator"!==g&&g?{type:"mercator"}:{type:"globe"});this._updateGlobeIcon()};this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe");this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled");"globe"===(null===(b=this._map.getProjection())||
void 0===b?void 0:b.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=rb.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=rb.create("button","maplibregl-ctrl-globe",this._container),rb.create("span","maplibregl-ctrl-icon",
this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){rb.remove(this._container);this._map.off("styledata",this._updateGlobeIcon);this._globeButton.removeEventListener("click",this._toggleProjection);this._map=void 0}};M.GeolocateControl=class extends v.E{constructor(b){super();this._onSuccess=g=>{if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),
this.fire(new v.l("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case "WAITING_ACTIVE":case "ACTIVE_LOCK":case "ACTIVE_ERROR":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case "BACKGROUND":case "BACKGROUND_ERROR":this._watchState=
"BACKGROUND";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw Error(`Unexpected watchState ${this._watchState}`);}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(g);this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(g);this.options.showUserLocation&&
this._dotElement.classList.remove("maplibregl-user-location-dot-stale");this.fire(new v.l("geolocate",g));this._finish()}};this._updateCamera=g=>{var m=new v.S(g.coords.longitude,g.coords.latitude);g=g.coords.accuracy;var u=this._map.getBearing();u=v.e({bearing:u},this.options.fitBoundsOptions);m=qf.fromLngLat(m,g);this._map.fitBounds(m,u,{geolocateSource:!0})};this._updateMarker=g=>{if(g){const m=new v.S(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map);
this._userLocationDotMarker.setLngLat(m).addTo(this._map);this._accuracy=g.coords.accuracy;this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()};this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()};this._onError=g=>{if(this._map){if(1===g.code){this._watchState="OFF";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error");
this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error");this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m;this._geolocateButton.setAttribute("aria-label",m);void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===g.code&&Ah)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&
this._dotElement.classList.add("maplibregl-user-location-dot-stale");this.fire(new v.l("error",g));this._finish()}};this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId);this._timeoutId=void 0};this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",g=>g.preventDefault()),this._geolocateButton=rb.create("button","maplibregl-ctrl-geolocate",this._container),rb.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type=
"button",this._geolocateButton.disabled=!0)};this._finishSetupUI=g=>{this._map&&(!1===g?(v.w("Geolocation support is not available so the GeolocateControl will be disabled."),g=this._map._getUIString("GeolocateControl.LocationNotAvailable"),this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)):(g=this._map._getUIString("GeolocateControl.FindMyLocation"),this._geolocateButton.disabled=!1,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",
g)),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=rb.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Lj({element:this._dotElement}),this._circleElement=rb.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lj({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),
this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{const u=(null==m?void 0:m[0])instanceof ResizeObserverEntry;m.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),
this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new v.l("trackuserlocationend")),this.fire(new v.l("userlocationlostfocus")))}))};this.options=v.e({},tl,b)}onAdd(b){return this._map=b,this._container=rb.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return v._(this,arguments,void 0,function*(g=!1){if(void 0!==lj&&!g)return lj;if(void 0===window.navigator.permissions)return lj=!!window.navigator.geolocation,lj;try{lj="denied"!==
(yield window.navigator.permissions.query({name:"geolocation"})).state}catch(m){lj=!!window.navigator.geolocation}return lj})}().then(g=>this._finishSetupUI(g)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0);this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove();this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove();
rb.remove(this._container);this._map.off("zoom",this._onUpdate);this._map.off("move",this._onUpdate);this._map.off("rotate",this._onUpdate);this._map.off("pitch",this._onUpdate);this._map=void 0;gk=0;Ah=!1}_isOutOfMapMaxBounds(b){const g=this._map.getMaxBounds();b=b.coords;return g&&(b.longitude<g.getWest()||b.longitude>g.getEast()||b.latitude<g.getSouth()||b.latitude>g.getNorth())}_setErrorState(){switch(this._watchState){case "WAITING_ACTIVE":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active");
this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case "ACTIVE_LOCK":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case "BACKGROUND":this._watchState="BACKGROUND_ERROR";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error");
this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case "ACTIVE_ERROR":case "BACKGROUND_ERROR":case "OFF":case void 0:break;default:throw Error(`Unexpected watchState ${this._watchState}`);}}_updateCircleRadiusIfNeeded(){var b=this._userLocationDotMarker.getLngLat();if(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b){var g=this._map.project(b);g=this._map.unproject([g.x+100,g.y]);b=b.distanceTo(g)/100;b=2*this._accuracy/b;this._circleElement.style.width=
`${b.toFixed(2)}px`;this._circleElement.style.height=`${b.toFixed(2)}px`}}trigger(){if(!this._setup)return v.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case "OFF":this._watchState="WAITING_ACTIVE";this.fire(new v.l("trackuserlocationstart"));break;case "WAITING_ACTIVE":case "ACTIVE_LOCK":case "ACTIVE_ERROR":case "BACKGROUND_ERROR":gk--;Ah=!1;this._watchState="OFF";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting");
this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background");this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error");this.fire(new v.l("trackuserlocationend"));break;case "BACKGROUND":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background");this._lastKnownPosition&&
this._updateCamera(this._lastKnownPosition);this.fire(new v.l("trackuserlocationstart"));this.fire(new v.l("userlocationfocus"));break;default:throw Error(`Unexpected watchState ${this._watchState}`);}switch(this._watchState){case "WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case "ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case "OFF":break;
default:throw Error(`Unexpected watchState ${this._watchState}`);}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","true");gk++;1<gk?(b={maximumAge:6E5,timeout:0},Ah=!0):(b=this.options.positionOptions,Ah=!1);this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,
b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1E4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=void 0;this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","false");this.options.showUserLocation&&this._updateMarker(null)}};M.GlobeControl=hk;M.Hash=
ic;M.ImageSource=Td;M.KeyboardHandler=Pi;M.LngLatBounds=qf;M.LogoControl=rm;const mj=class{constructor(b){this._updateZoomButtons=()=>{var g=this._map.getZoom();const m=g===this._map.getMaxZoom();g=g===this._map.getMinZoom();this._zoomInButton.disabled=m;this._zoomOutButton.disabled=g;this._zoomInButton.setAttribute("aria-disabled",m.toString());this._zoomOutButton.setAttribute("aria-disabled",g.toString())};this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&
this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:
`rotate(${-this._map.transform.bearing}deg)`};this._setButtonTitle=(g,m)=>{m=this._map._getUIString(`NavigationControl.${m}`);g.title=m;g.setAttribute("aria-label",m)};this.options=v.e({},Ak,b);this._container=rb.create("div","maplibregl-ctrl maplibregl-ctrl-group");this._container.addEventListener("contextmenu",g=>g.preventDefault());this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",g=>this._map.zoomIn({},{originalEvent:g})),rb.create("span","maplibregl-ctrl-icon",
this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",g=>this._map.zoomOut({},{originalEvent:g})),rb.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true"));this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",g=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:g}):this._map.resetNorth({},{originalEvent:g})}),this._compassIcon=rb.create("span",
"maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",
this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){rb.remove(this._container);this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons);this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",
this._rotateCompassArrow),this._handler.off(),delete this._handler);delete this._map}_createButton(b,g){b=rb.create("button",b,this._container);return b.type="button",b.addEventListener("click",g),b}};M.Map=class extends Ck{constructor(b){var g,m;v.cw.mark(v.cx.create);b=Object.assign(Object.assign(Object.assign({},Rg),b),{canvasContextAttributes:Object.assign(Object.assign({},Rg.canvasContextAttributes),b.canvasContextAttributes)});if(null!=b.minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");
if(null!=b.minPitch&&null!=b.maxPitch&&b.minPitch>b.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=b.minPitch&&0>b.minPitch)throw Error("minPitch must be greater than or equal to 0");if(null!=b.maxPitch&&180<b.maxPitch)throw Error("maxPitch must be less than or equal to 180");const u=new Ld,z=new yd;if(void 0!==b.minZoom&&u.setMinZoom(b.minZoom),void 0!==b.maxZoom&&u.setMaxZoom(b.maxZoom),void 0!==b.minPitch&&u.setMinPitch(b.minPitch),void 0!==b.maxPitch&&u.setMaxPitch(b.maxPitch),
void 0!==b.renderWorldCopies&&u.setRenderWorldCopies(b.renderWorldCopies),super(u,z,{bearingSnap:b.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Nl,this._controls=[],this._mapId=v.a7(),this._contextLost=G=>{G.preventDefault();this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null);this.fire(new v.l("webglcontextlost",{originalEvent:G}))},this._contextRestored=G=>{this._setupPainter();this.resize();this._update();this.fire(new v.l("webglcontextrestored",
{originalEvent:G}))},this._onMapScroll=G=>{if(G.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._maxTileCacheZoomLevels=b.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},b.canvasContextAttributes),this._trackResize=!0===b.trackResize,this._bearingSnap=b.bearingSnap,this._centerClampedToGround=b.centerClampedToGround,
this._refreshExpiredTiles=!0===b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=!0===b.crossSourceCollisions,this._collectResourceTiming=!0===b.collectResourceTiming,this._locale=Object.assign(Object.assign({},oc),b.locale),this._clickTolerance=b.clickTolerance,this._overridePixelRatio=b.pixelRatio,this._maxCanvasSize=b.maxCanvasSize,this.transformCameraUpdate=b.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===b.cancelPendingTileRequestsWhileZooming,
this._imageQueueHandle=yf.addThrottleControl(()=>this.isMoving()),this._requestManager=new Jh(b.transformRequest),"string"==typeof b.container){if(this._container=document.getElementById(b.container),!this._container)throw Error(`Container '${b.container}' not found.`);}else{if(!(b.container instanceof HTMLElement))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),this._setupContainer(),this._setupPainter(),
this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0;this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let G=!1;const K=tk(R=>{this._trackResize&&!this._removed&&(this.resize(R),this.redraw())},50);this._resizeObserver=new ResizeObserver(R=>{G?K(R):G=!0});this._resizeObserver.observe(this._container)}this.handlers=
new Je(this,b);(this._hash=b.hash&&(new ic("string"==typeof b.hash&&b.hash||void 0)).addTo(this))&&this._hash._onHashChange()||(this.jumpTo({center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,roll:b.roll}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,v.e({},b.fitBoundsOptions,{duration:0}))));const C="string"==typeof b.style||"globe"!==(null===(m=null===(g=b.style)||void 0===g?void 0:g.projection)||void 0===m?void 0:m.type);this.resize(null,C);this._localIdeographFontFamily=
b.localIdeographFontFamily;this._validateStyle=b.validateStyle;b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily});b.attributionControl&&this.addControl(new Fk("boolean"==typeof b.attributionControl?void 0:b.attributionControl));b.maplibreLogo&&this.addControl(new rm,b.logoPosition);this.on("style.load",()=>{if(C||this._resizeTransform(),this.transform.unmodified){const G=v.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(G)}});this.on("data",
G=>{this._update("style"===G.dataType);this.fire(new v.l(`${G.dataType}data`,G))});this.on("dataloading",G=>{this.fire(new v.l(`${G.dataType}dataloading`,G))});this.on("dataabort",G=>{this.fire(new v.l("sourcedataabort",G))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,g){return this.style.setGlobalStateProperty(b,g),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,g){if(void 0===g&&(g=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new v.k(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
const m=b.onAdd(this);this._controls.push(b);b=this._controlPositions[g];return-1!==g.indexOf("bottom")?b.insertBefore(m,b.firstChild):b.appendChild(m),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new v.k(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const g=this._controls.indexOf(b);return-1<g&&this._controls.splice(g,1),b.onRemove(this),this}hasControl(b){return-1<this._controls.indexOf(b)}coveringTiles(b){return Nc(this.transform,
b)}calculateCameraOptionsFromTo(b,g,m,u){return null==u&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,g,m,u)}resize(b,g=!0){const [m,u]=this._containerDimensions();var z=this._getClampedPixelRatio(m,u);if(this._resizeCanvas(m,u,z),this.painter.resize(m,u,z),this.painter.overLimit())z=this.painter.context.gl,this._maxCanvasSize=[z.drawingBufferWidth,z.drawingBufferHeight],z=this._getClampedPixelRatio(m,u),this._resizeCanvas(m,
u,z),this.painter.resize(m,u,z);this._resizeTransform(g);g=!this._moving;return g&&(this.stop(),this.fire(new v.l("movestart",b)).fire(new v.l("move",b))),this.fire(new v.l("resize",b)),g&&this.fire(new v.l("moveend",b)),this}_resizeTransform(b=!0){var g;const [m,u]=this._containerDimensions();this.transform.resize(m,u,b);null===(g=this._requestedCameraState)||void 0===g||g.resize(m,u,b)}_getClampedPixelRatio(b,g){const {0:m,1:u}=this._maxCanvasSize,z=this.getPixelRatio();b*=z;g*=z;return Math.min(b>
m?m/b:1,g>u?u/g:1)*z}getPixelRatio(){var b;return null!==(b=this._overridePixelRatio)&&void 0!==b?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b;this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(qf.convert(b)),this._update()}setMinZoom(b){if(-2<=(b=null==b?-2:b)&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),
this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive");}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=null==b?22:b)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw Error("maxZoom must be greater than the current minZoom");}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if(0>(b=null==b?0:b))throw Error("minPitch must be greater than or equal to 0");if(0<=b&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),
this._update(),this.getPitch()<b&&this.setPitch(b),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive");}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if(180<(b=null==b?60:b))throw Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw Error("maxPitch must be greater than the current minPitch");}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),
this._update()}project(b){return this.transform.locationToScreenPoint(v.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(v.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||(null===(b=this.handlers)||void 0===b?void 0:b.isMoving())}isZooming(){var b;return this._zooming||(null===(b=this.handlers)||void 0===b?void 0:b.isZooming())}isRotating(){var b;return this._rotating||(null===(b=this.handlers)||void 0===b?void 0:b.isRotating())}_createDelegatedListener(b,
g,m){if("mouseenter"===b||"mouseover"===b){let u=!1;return{layers:g,listener:m,delegates:{mousemove:z=>{var C=g.filter(G=>this.getLayer(G));C=0!==C.length?this.queryRenderedFeatures(z.point,{layers:C}):[];C.length?u||(u=!0,m.call(this,new mf(b,this,z.originalEvent,{features:C}))):u=!1},mouseout:()=>{u=!1}}}}if("mouseleave"===b||"mouseout"===b){let u=!1;return{layers:g,listener:m,delegates:{mousemove:z=>{const C=g.filter(G=>this.getLayer(G));(0!==C.length?this.queryRenderedFeatures(z.point,{layers:C}):
[]).length?u=!0:u&&(u=!1,m.call(this,new mf(b,this,z.originalEvent)))},mouseout:z=>{u&&(u=!1,m.call(this,new mf(b,this,z.originalEvent)))}}}}return{layers:g,listener:m,delegates:{[b]:u=>{var z=g.filter(C=>this.getLayer(C));z=0!==z.length?this.queryRenderedFeatures(u.point,{layers:z}):[];z.length&&(u.features=z,m.call(this,u),delete u.features)}}}}_saveDelegatedListener(b,g){this._delegatedListeners=this._delegatedListeners||{};this._delegatedListeners[b]=this._delegatedListeners[b]||[];this._delegatedListeners[b].push(g)}_removeDelegatedListener(b,
g,m){if(this._delegatedListeners&&this._delegatedListeners[b]){b=this._delegatedListeners[b];for(let u=0;u<b.length;u++){const z=b[u];if(z.listener===m&&z.layers.length===g.length&&z.layers.every(C=>g.includes(C))){for(const C in z.delegates)this.off(C,z.delegates[C]);return void b.splice(u,1)}}}}on(b,g,m){if(void 0===m)return super.on(b,g);const u="string"==typeof g?[g]:g;g=this._createDelegatedListener(b,u,m);this._saveDelegatedListener(b,g);for(const z in g.delegates)this.on(z,g.delegates[z]);
return{unsubscribe:()=>{this._removeDelegatedListener(b,u,m)}}}once(b,g,m){if(void 0===m)return super.once(b,g);const u="string"==typeof g?[g]:g;g=this._createDelegatedListener(b,u,m);for(const z in g.delegates){const C=g.delegates[z];g.delegates[z]=(...G)=>{this._removeDelegatedListener(b,u,m);C(...G)}}this._saveDelegatedListener(b,g);for(const z in g.delegates)this.once(z,g.delegates[z]);return this}off(b,g,m){return void 0===m?super.off(b,g):(this._removeDelegatedListener(b,"string"==typeof g?
[g]:g,m),this)}queryRenderedFeatures(b,g){if(!this.style)return[];const m=b instanceof v.P||Array.isArray(b);var u=m?b:[[0,0],[this.transform.width,this.transform.height]];(g=g||(m?{}:b)||{},u instanceof v.P||"number"==typeof u[0])?u=[v.P.convert(u)]:(b=v.P.convert(u[0]),u=v.P.convert(u[1]),u=[b,new v.P(u.x,b.y),u,new v.P(b.x,u.y),b]);return this.style.queryRenderedFeatures(u,g,this.transform)}querySourceFeatures(b,g){return this.style.querySourceFeatures(b,g)}setStyle(b,g){return!1!==(g=v.e({},{localIdeographFontFamily:this._localIdeographFontFamily,
validate:this._validateStyle},g)).diff&&g.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,g),this):(this._localIdeographFontFamily=g.localIdeographFontFamily,this._updateStyle(b,g))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const g=this._locale[b];if(null==g)throw Error(`Missing UI string '${b}'`);return g}_updateStyle(b,g){var m,u;if(g.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",
()=>this._updateStyle(b,g));const z=this.style&&g.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new ge(this,g||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof b?this.style.loadURL(b,g,z):this.style.loadJSON(b,g,z),this):(null===(u=null===(m=this.style)||void 0===m?void 0:m.projection)||void 0===u||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ge(this,
{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,g){"string"==typeof b?(b=this._requestManager.transformRequest(b,"Style"),v.j(b,new AbortController).then(m=>{this._updateDiff(m.data,g)}).catch(m=>{m&&this.fire(new v.k(m))})):"object"==typeof b&&this._updateDiff(b,g)}_updateDiff(b,g){try{this.style.setState(b,g)&&this._update(!0)}catch(m){v.w(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(b,
g)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():v.w("There is no style added to the map.")}addSource(b,g){return this._lazyInitEmptyStyle(),this.style.addSource(b,g),this._update(!0)}isSourceLoaded(b){const g=this.style&&this.style.sourceCaches[b];if(void 0!==g)return g.loaded();this.fire(new v.k(Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),
b){const g=this.style.sourceCaches[b.source];if(!g)throw Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);null===this.terrain&&g.reload();for(const m in this.style._layers){const u=this.style._layers[m];"hillshade"===u.type&&u.source===b.source&&v.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.");"color-relief"===u.type&&u.source===b.source&&v.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=
new Dk(this.painter,g,b);this.painter.renderToTexture=new Uc(this.painter,this.terrain);this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom));this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom));this._terrainDataCallback=m=>{var u;"style"===m.dataType?this.terrain.sourceCache.freeRtt():"source"===m.dataType&&m.tile&&(m.sourceId!==b.source||this._elevationFreeze||
(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(u=m.source)||void 0===u?void 0:u.type)?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(m.tile.tileID))};this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),
this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new v.l("terrain",{terrain:b})),this}getTerrain(){var b,g;return null!==(g=null===(b=this.terrain)||void 0===b?void 0:b.options)&&void 0!==g?g:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const g in b){const m=b[g]._tiles;for(const u in m){const z=
m[u];if("loaded"!==z.state&&"errored"!==z.state)return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,g,m){if(m){var u=this.getSource(m);if(!u)throw Error(`There is no source with ID "${m}", cannot set LOD parameters`);u.calculateTileZoom=dc(Math.max(1,b),Math.max(1,g))}else for(u in this.style.sourceCaches)this.style.sourceCaches[u].getSource().calculateTileZoom=dc(Math.max(1,b),Math.max(1,g));return this._update(!0),
this}refreshTiles(b,g){const m=this.style.sourceCaches[b];if(!m)throw Error(`There is no source cache with ID "${b}", cannot refresh tile`);void 0===g?m.reload(!0):m.refreshTiles(g.map(u=>new v.a4(u.z,u.x,u.y)))}addImage(b,g,m={}){const {pixelRatio:u=1,sdf:z=!1,stretchX:C,stretchY:G,content:K,textFitWidth:R,textFitHeight:X}=m;if(this._lazyInitEmptyStyle(),!(g instanceof HTMLImageElement||v.b(g))){if(void 0===g.width||void 0===g.height)return this.fire(new v.k(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
const {width:pa,height:ya,data:Ba}=g;return this.style.addImage(b,{data:new v.R({width:pa,height:ya},new Uint8Array(Ba)),pixelRatio:u,stretchX:C,stretchY:G,content:K,textFitWidth:R,textFitHeight:X,sdf:z,version:0,userImage:g}),g.onAdd&&g.onAdd(this,b),this}const {width:ca,height:ja,data:la}=qd.getImageData(g);this.style.addImage(b,{data:new v.R({width:ca,height:ja},la),pixelRatio:u,stretchX:C,stretchY:G,content:K,textFitWidth:R,textFitHeight:X,sdf:z,version:0})}updateImage(b,g){const m=this.style.getImage(b);
if(!m)return this.fire(new v.k(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=g instanceof HTMLImageElement||v.b(g)?qd.getImageData(g):g,{width:z,height:C,data:G}=u;if(void 0===z||void 0===C)return this.fire(new v.k(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
if(z!==m.data.width||C!==m.data.height)return this.fire(new v.k(Error("The width and height of the updated image must be that same as the previous version of the image")));g=!(g instanceof HTMLImageElement||v.b(g));return m.data.replace(G,g),this.style.updateImage(b,m),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new v.k(Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return yf.getImage(this._requestManager.transformRequest(b,
"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,g){return this._lazyInitEmptyStyle(),this.style.addLayer(b,g),this._update(!0)}moveLayer(b,g){return this.style.moveLayer(b,g),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,g,m){return this.style.setLayerZoomRange(b,g,m),this._update(!0)}setFilter(b,g,m={}){return this.style.setFilter(b,
g,m),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,g,m,u={}){return this.style.setPaintProperty(b,g,m,u),this._update(!0)}getPaintProperty(b,g){return this.style.getPaintProperty(b,g)}setLayoutProperty(b,g,m,u={}){return this.style.setLayoutProperty(b,g,m,u),this._update(!0)}getLayoutProperty(b,g){return this.style.getLayoutProperty(b,g)}setGlyphs(b,g={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,g),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,
g,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,g,m,u=>{u||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,g={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,g,m=>{m||this._update(!0)}),this}setLight(b,g={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,g),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,g={}){return this._lazyInitEmptyStyle(),
this.style.setSky(b,g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,g){return this.style.setFeatureState(b,g),this._update()}removeFeatureState(b,g){return this.style.removeFeatureState(b,g),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,g=0;return this._container&&(b=this._container.clientWidth||400,
g=this._container.clientHeight||300),[b,g]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");var g=this._canvasContainer=rb.create("div","maplibregl-canvas-container",b);this._interactive&&g.classList.add("maplibregl-interactive");this._canvas=rb.create("canvas","maplibregl-canvas",g);this._canvas.addEventListener("webglcontextlost",this._contextLost,!1);this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1);this._canvas.setAttribute("tabindex",this._interactive?
"0":"-1");this._canvas.setAttribute("aria-label",this._getUIString("Map.Title"));this._canvas.setAttribute("role","region");g=this._containerDimensions();const m=this._getClampedPixelRatio(g[0],g[1]);this._resizeCanvas(g[0],g[1],m);const u=this._controlContainer=rb.create("div","maplibregl-control-container",b),z=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{z[C]=rb.create("div",`maplibregl-ctrl-${C} `,u)});this._container.addEventListener("scroll",this._onMapScroll,
!1)}_resizeCanvas(b,g,m){this._canvas.width=Math.floor(m*b);this._canvas.height=Math.floor(m*g);this._canvas.style.width=`${b}px`;this._canvas.style.height=`${g}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let g=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{g={requestedAttributes:b};u&&(g.statusMessage=u.statusMessage,g.type=u.type)},{once:!0});let m=null;if(m=this._canvasContextAttributes.contextType?
this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!m)throw g?(g.message="Failed to initialize WebGL",Error(JSON.stringify(g))):Error("Failed to initialize WebGL");this.painter=new Qb(m,this.transform);Zi.testSupport(m)}migrateProjection(b,g){super.migrateProjection(b,g);this.painter.transform=b;this.fire(new v.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&
!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var g,m,u,z,C;const G=this._idleTriggered?this._fadeDuration:0,K=0<(null===(g=this.style.projection)||void 0===g?void 0:g.transitionState);if(this.painter.context.setDirty(),
this.painter.setBaseState(),this._renderTaskQueue.run(b),!this._removed){b=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;g=this.transform.zoom;var R=qd.now();this.style.zoomHistory.update(g,R);g=new v.F(g,{now:R,fadeDuration:G,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()});R=g.crossFadingFactor();1===R&&R===this._crossFadingFactor||(b=!0,this._crossFadingFactor=R);this.style.update(g)}g=0<(null===(m=this.style.projection)||void 0===m?void 0:m.transitionState)!==
K;null===(u=this.style.projection)||void 0===u||u.setErrorQueryLatitudeDegrees(this.transform.center.lat);this.transform.setTransitionState(null===(z=this.style.projection)||void 0===z?void 0:z.transitionState,null===(C=this.style.projection)||void 0===C?void 0:C.latitudeErrorCorrectionRadians);this.style&&(this._sourcesDirty||g)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform));this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,
this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0));this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,G,this._crossSourceCollisions,g);this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,
showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:G,showPadding:this.showPadding});this.fire(new v.l("render"));this.loaded()&&!this._loaded&&(this._loaded=!0,v.cw.mark(v.cx.load),this.fire(new v.l("load")));this.style&&(this.style.hasTransitions()||b)&&(this._styleDirty=!0);this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();m=this._sourcesDirty||this._styleDirty||this._placementDirty;return m||
this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.l("idle")),!this._loaded||this._fullyLoaded||m||(this._fullyLoaded=!0,v.cw.mark(v.cx.fullLoad)),this}}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const g of this._controls)g.onRemove(this);this._controls=[];this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null);this._renderTaskQueue.clear();
this.painter.destroy();this.handlers.destroy();delete this.handlers;this.setStyle(null);"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1);yf.removeThrottleControl(this._imageQueueHandle);null===(b=this._resizeObserver)||void 0===b||b.disconnect();b=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==b?0:b.loseContext)&&b.loseContext();this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1);this._canvas.removeEventListener("webglcontextlost",
this._contextLost,!1);rb.remove(this._canvasContainer);rb.remove(this._controlContainer);this._container.removeEventListener("scroll",this._onMapScroll,!1);this._container.classList.remove("maplibregl-map");v.cw.clearMetrics();this._removed=!0;this.fire(new v.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,qd.frame(this._frameRequest,b=>{v.cw.frame(b);this._frameRequest=null;try{this._render(b)}catch(g){if(!v.cy(g)&&"Framebuffer is not complete"!==
g.message)throw g;}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==
b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b;this._update()}get version(){return"5.9.0"}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}};M.MapMouseEvent=mf;M.MapTouchEvent=
Rf;M.MapWheelEvent=ij;M.Marker=Lj;M.NavigationControl=mj;const Ti=class{constructor(b){this._onMove=()=>{tj(this._map,this._container,this.options)};this.setUnit=g=>{this.options.unit=g;tj(this._map,this._container,this.options)};this.options=Object.assign(Object.assign({},Si),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=rb.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){rb.remove(this._container);
this._map.off("move",this._onMove);this._map=void 0}},Pk=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options);this._updateTerrainIcon()};this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain");this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled");this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):
(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))};this.options=b}onAdd(b){return this._map=b,this._container=rb.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=rb.create("button","maplibregl-ctrl-terrain",this._container),rb.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",
this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){rb.remove(this._container);this._map.off("terrain",this._updateTerrainIcon);this._map=void 0}};M.Popup=class extends v.E{constructor(b){super();this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")};this.remove=()=>(this._content&&
rb.remove(this._content),this._container&&(rb.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new v.l("close"))),this);this._onMouseUp=
g=>{this._update(g.point)};this._onMouseMove=g=>{this._update(g.point)};this._onDrag=g=>{this._update(g.point)};this._update=g=>{if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(!this._container){if(this._container=rb.create("div","maplibregl-popup",this._map.getContainer()),this._tip=rb.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(var m of this.options.className.split(" "))this._container.classList.add(m);
this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close"));this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Tf(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),!this._trackPointer||g){m=this._flatPos=this._pos=this._trackPointer&&g?g:this._map.project(this._lngLat);
this._map.terrain&&(this._flatPos=this._trackPointer&&g?g:this._map.transform.locationToScreenPoint(this._lngLat));var u=this.options.anchor;g=uk(this.options.offset);if(!u){u=this._container.offsetWidth;var z=this._container.offsetHeight;z=m.y+g.bottom.y<z?["top"]:m.y>this._map.transform.height-z?["bottom"]:[];m.x<u/2?z.push("left"):m.x>this._map.transform.width-u/2&&z.push("right");u=0===z.length?"bottom":z.join("-")}m=m.add(g[u]);this.options.subpixelPositioning||(m=m.round());rb.setTransform(this._container,
`${Th[u]} translate(${m.x}px,${m.y}px)`);vi(this._container,u,"popup");this._updateOpacity()}}};this._onClose=()=>{this.remove()};this.options=v.e(Object.create(Ok),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",
this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new v.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=v.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),
this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),
this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const g=document.createDocumentFragment(),m=document.createElement("body");let u;for(m.innerHTML=b;u=m.firstChild,u;)g.appendChild(u);return this.setDOMContent(g)}getMaxWidth(){var b;return null===(b=this._container)||void 0===b?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&
this._content.removeChild(this._content.firstChild);else this._content=rb.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=
b}_createCloseButton(){this.options.closeButton&&(this._closeButton=rb.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="\x26#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(this.options.focusAfterOpen&&this._container){var b=this._container.querySelector("a[href], [tabindex]:not([tabindex\x3d'-1']), [contenteditable]:not([contenteditable\x3d'false']), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled])");
b&&b.focus()}}};M.RasterDEMTileSource=qg;M.RasterTileSource=Ff;M.ScaleControl=Ti;M.ScrollZoomHandler=Mk;M.Style=ge;M.TerrainControl=Pk;M.TwoFingersTouchPitchHandler=ni;M.TwoFingersTouchRotateHandler=jj;M.TwoFingersTouchZoomHandler=dk;M.TwoFingersTouchZoomRotateHandler=Wg;M.VectorTileSource=Gg;M.VideoSource=Mf;M.addSourceType=(b,g)=>v._(void 0,void 0,void 0,function*(){if($c(b))throw Error(`A source type called "${b}" already exists.`);zf[b]=g});M.clearPrewarmedResources=function(){const b=Vf;b&&(b.isPreloaded()&&
1===b.numActive()?(b.release("maplibre_preloaded_worker_pool"),Vf=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))};M.createTileMesh=Aa;M.getMaxParallelImageRequests=function(){return v.a.MAX_PARALLEL_IMAGE_REQUESTS};M.getRTLTextPluginStatus=function(){return zb().getRTLTextPluginStatus()};M.getVersion=function(){return"5.9.0"};
M.getWorkerCount=function(){return Fg.workerCount};M.getWorkerUrl=function(){return v.a.WORKER_URL};M.importScriptInWorkers=function(b){return tc().broadcast("IS",b)};M.prewarm=function(){bb().acquire("maplibre_preloaded_worker_pool")};M.setMaxParallelImageRequests=function(b){v.a.MAX_PARALLEL_IMAGE_REQUESTS=b};M.setRTLTextPlugin=function(b,g){return zb().setRTLTextPlugin(b,g)};M.setWorkerCount=function(b){Fg.workerCount=b};M.setWorkerUrl=function(b){v.a.WORKER_URL=b}});return qc})};
shadow$provide[12]=function(Le,Sd,Yd,ba){Yd.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,
255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],
dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],
lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],
magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,
0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],
sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}};
shadow$provide[13]=function(Le,Sd,Yd,ba){Yd.exports=function(Na){return Na&&"string"!==typeof Na?Na instanceof Array||Array.isArray(Na)||0<=Na.length&&(Na.splice instanceof Function||Object.getOwnPropertyDescriptor(Na,Na.length-1)&&"String"!==Na.constructor.name):!1}};
shadow$provide[14]=function(Le,Sd,Yd,ba){var Na=Sd(13),qc=Array.prototype.concat,hb=Array.prototype.slice,M=Yd.exports=function(v){for(var ta=[],Va=0,Ab=v.length;Va<Ab;Va++){var $a=v[Va];Na($a)?ta=qc.call(ta,hb.call($a)):ta.push($a)}return ta};M.wrap=function(v){return function(){return v(M(arguments))}}};
shadow$provide[15]=function(Le,Sd,Yd,ba){function Na($a,Sb,na){return Math.min(Math.max(Sb,$a),na)}function qc($a){$a=Math.round($a).toString(16).toUpperCase();return 2>$a.length?"0"+$a:$a}var hb=Sd(12),M=Sd(14),v=Object.hasOwnProperty,ta=Object.create(null),Va;for(Va in hb)v.call(hb,Va)&&(ta[hb[Va]]=Va);var Ab=Yd.exports={to:{},get:{}};Ab.get=function($a){switch($a.substring(0,3).toLowerCase()){case "hsl":$a=Ab.get.hsl($a);var Sb="hsl";break;case "hwb":$a=Ab.get.hwb($a);Sb="hwb";break;default:$a=
Ab.get.rgb($a),Sb="rgb"}return $a?{model:Sb,value:$a}:null};Ab.get.rgb=function($a){if(!$a)return null;var Sb=/^#([a-f0-9]{3,4})$/i,na=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,bb=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,tc=/^(\w+)$/,vb=[0,0,0,1],Pa;if(Pa=$a.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){Sb=Pa[2];Pa=Pa[1];for($a=0;3>$a;$a++)na=
2*$a,vb[$a]=parseInt(Pa.slice(na,na+2),16);Sb&&(vb[3]=parseInt(Sb,16)/255)}else if(Pa=$a.match(Sb)){Pa=Pa[1];Sb=Pa[3];for($a=0;3>$a;$a++)vb[$a]=parseInt(Pa[$a]+Pa[$a],16);Sb&&(vb[3]=parseInt(Sb+Sb,16)/255)}else if(Pa=$a.match(na)){for($a=0;3>$a;$a++)vb[$a]=parseInt(Pa[$a+1],0);Pa[4]&&(vb[3]=Pa[5]?.01*parseFloat(Pa[4]):parseFloat(Pa[4]))}else if(Pa=$a.match(bb)){for($a=0;3>$a;$a++)vb[$a]=Math.round(2.55*parseFloat(Pa[$a+1]));Pa[4]&&(vb[3]=Pa[5]?.01*parseFloat(Pa[4]):parseFloat(Pa[4]))}else{if(Pa=$a.match(tc)){if("transparent"===
Pa[1])return[0,0,0,0];if(!v.call(hb,Pa[1]))return null;vb=hb[Pa[1]];vb[3]=1;return vb}return null}for($a=0;3>$a;$a++)vb[$a]=Na(vb[$a],0,255);vb[3]=Na(vb[3],0,1);return vb};Ab.get.hsl=function($a){if(!$a)return null;var Sb=$a.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(Sb){var na=parseFloat(Sb[4]);$a=(parseFloat(Sb[1])%360+360)%360;var bb=Na(parseFloat(Sb[2]),
0,100);Sb=Na(parseFloat(Sb[3]),0,100);na=Na(isNaN(na)?1:na,0,1);return[$a,bb,Sb,na]}return null};Ab.get.hwb=function($a){if(!$a)return null;var Sb=$a.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(Sb){var na=parseFloat(Sb[4]);$a=(parseFloat(Sb[1])%360+360)%360;var bb=Na(parseFloat(Sb[2]),0,100);Sb=Na(parseFloat(Sb[3]),0,100);na=Na(isNaN(na)?1:na,0,1);return[$a,bb,Sb,na]}return null};
Ab.to.hex=function(){var $a=M(arguments);return"#"+qc($a[0])+qc($a[1])+qc($a[2])+(1>$a[3]?qc(Math.round(255*$a[3])):"")};Ab.to.rgb=function(){var $a=M(arguments);return 4>$a.length||1===$a[3]?"rgb("+Math.round($a[0])+", "+Math.round($a[1])+", "+Math.round($a[2])+")":"rgba("+Math.round($a[0])+", "+Math.round($a[1])+", "+Math.round($a[2])+", "+$a[3]+")"};Ab.to.rgb.percent=function(){var $a=M(arguments),Sb=Math.round($a[0]/255*100),na=Math.round($a[1]/255*100),bb=Math.round($a[2]/255*100);return 4>$a.length||
1===$a[3]?"rgb("+Sb+"%, "+na+"%, "+bb+"%)":"rgba("+Sb+"%, "+na+"%, "+bb+"%, "+$a[3]+")"};Ab.to.hsl=function(){var $a=M(arguments);return 4>$a.length||1===$a[3]?"hsl("+$a[0]+", "+$a[1]+"%, "+$a[2]+"%)":"hsla("+$a[0]+", "+$a[1]+"%, "+$a[2]+"%, "+$a[3]+")"};Ab.to.hwb=function(){var $a=M(arguments),Sb="";4<=$a.length&&1!==$a[3]&&(Sb=", "+$a[3]);return"hwb("+$a[0]+", "+$a[1]+"%, "+$a[2]+"%"+Sb+")"};Ab.to.keyword=function($a){return ta[$a.slice(0,3)]}};
shadow$provide[16]=function(Le,Sd,Yd,ba){const Na=Sd(12),qc={};for(const M of Object.keys(Na))qc[Na[M]]=M;const hb={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},
hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Yd.exports=hb;for(const M of Object.keys(hb)){if(!("channels"in hb[M]))throw Error("missing channels property: "+M);if(!("labels"in hb[M]))throw Error("missing channel labels property: "+M);if(hb[M].labels.length!==hb[M].channels)throw Error("channel and label counts mismatch: "+M);const {channels:v,labels:ta}=hb[M];delete hb[M].channels;delete hb[M].labels;Object.defineProperty(hb[M],
"channels",{value:v});Object.defineProperty(hb[M],"labels",{value:ta})}hb.rgb.hsl=function(M){var v=M[0]/255;const ta=M[1]/255,Va=M[2]/255;M=Math.min(v,ta,Va);const Ab=Math.max(v,ta,Va),$a=Ab-M;let Sb;Ab===M?Sb=0:v===Ab?Sb=(ta-Va)/$a:ta===Ab?Sb=2+(Va-v)/$a:Va===Ab&&(Sb=4+(v-ta)/$a);Sb=Math.min(60*Sb,360);0>Sb&&(Sb+=360);v=(M+Ab)/2;return[Sb,100*(Ab===M?0:.5>=v?$a/(Ab+M):$a/(2-Ab-M)),100*v]};hb.rgb.hsv=function(M){let v;let ta,Va;const Ab=M[0]/255,$a=M[1]/255,Sb=M[2]/255,na=Math.max(Ab,$a,Sb);var bb=
na-Math.min(Ab,$a,Sb);0===bb?Va=ta=0:(Va=bb/na,M=(na-Ab)/6/bb+.5,v=(na-$a)/6/bb+.5,bb=(na-Sb)/6/bb+.5,Ab===na?ta=bb-v:$a===na?ta=1/3+M-bb:Sb===na&&(ta=2/3+v-M),0>ta?ta+=1:1<ta&&--ta);return[360*ta,100*Va,100*na]};hb.rgb.hwb=function(M){const v=M[0],ta=M[1];let Va=M[2];M=hb.rgb.hsl(M)[0];const Ab=1/255*Math.min(v,Math.min(ta,Va));Va=1-1/255*Math.max(v,Math.max(ta,Va));return[M,100*Ab,100*Va]};hb.rgb.cmyk=function(M){const v=M[0]/255,ta=M[1]/255;M=M[2]/255;const Va=Math.min(1-v,1-ta,1-M);return[100*
((1-v-Va)/(1-Va)||0),100*((1-ta-Va)/(1-Va)||0),100*((1-M-Va)/(1-Va)||0),100*Va]};hb.rgb.keyword=function(M){var v=qc[M];if(v)return v;v=Infinity;let ta;for(const Ab of Object.keys(Na)){var Va=Na[Ab];Va=(M[0]-Va[0])**2+(M[1]-Va[1])**2+(M[2]-Va[2])**2;Va<v&&(v=Va,ta=Ab)}return ta};hb.keyword.rgb=function(M){return Na[M]};hb.rgb.xyz=function(M){let v=M[0]/255,ta=M[1]/255;M=M[2]/255;v=.04045<v?((v+.055)/1.055)**2.4:v/12.92;ta=.04045<ta?((ta+.055)/1.055)**2.4:ta/12.92;M=.04045<M?((M+.055)/1.055)**2.4:
M/12.92;return[100*(.4124*v+.3576*ta+.1805*M),100*(.2126*v+.7152*ta+.0722*M),100*(.0193*v+.1192*ta+.9505*M)]};hb.rgb.lab=function(M){var v=hb.rgb.xyz(M);M=v[0];let ta=v[1];v=v[2];M/=95.047;ta/=100;v/=108.883;ta=.008856<ta?ta**(1/3):7.787*ta+16/116;return[116*ta-16,500*((.008856<M?M**(1/3):7.787*M+16/116)-ta),200*(ta-(.008856<v?v**(1/3):7.787*v+16/116))]};hb.hsl.rgb=function(M){const v=M[0]/360;var ta=M[1]/100;M=M[2]/100;if(0===ta){var Va=255*M;return[Va,Va,Va]}ta=.5>M?M*(1+ta):M+ta-M*ta;M=2*M-ta;
const Ab=[0,0,0];for(let $a=0;3>$a;$a++)Va=v+1/3*-($a-1),0>Va&&Va++,1<Va&&Va--,Va=1>6*Va?M+6*(ta-M)*Va:1>2*Va?ta:2>3*Va?M+(ta-M)*(2/3-Va)*6:M,Ab[$a]=255*Va;return Ab};hb.hsl.hsv=function(M){const v=M[0];let ta=M[1]/100;M=M[2]/100;let Va=ta;const Ab=Math.max(M,.01);M*=2;ta*=1>=M?M:2-M;Va*=1>=Ab?Ab:2-Ab;return[v,100*(0===M?2*Va/(Ab+Va):2*ta/(M+ta)),(M+ta)/2*100]};hb.hsv.rgb=function(M){var v=M[0]/60,ta=M[1]/100;M=M[2]/100;const Va=Math.floor(v)%6,Ab=v-Math.floor(v);v=255*M*(1-ta);const $a=255*M*(1-
ta*Ab);ta=255*M*(1-ta*(1-Ab));M*=255;switch(Va){case 0:return[M,ta,v];case 1:return[$a,M,v];case 2:return[v,M,ta];case 3:return[v,$a,M];case 4:return[ta,v,M];case 5:return[M,v,$a]}};hb.hsv.hsl=function(M){const v=M[0],ta=M[1]/100;M=M[2]/100;var Va=Math.max(M,.01);const Ab=(2-ta)*Va;Va=ta*Va/(1>=Ab?Ab:2-Ab)||0;return[v,100*Va,(2-ta)*M/2*100]};hb.hwb.rgb=function(M){var v=M[0]/360,ta=M[1]/100;M=M[2]/100;var Va=ta+M;1<Va&&(ta/=Va,M/=Va);Va=Math.floor(6*v);M=1-M;v=6*v-Va;0!==(Va&1)&&(v=1-v);v=ta+v*(M-
ta);let Ab;switch(Va){default:case 6:case 0:Va=M;Ab=v;break;case 1:Va=v;Ab=M;break;case 2:Va=ta;Ab=M;ta=v;break;case 3:Va=ta;Ab=v;ta=M;break;case 4:Va=v;Ab=ta;ta=M;break;case 5:Va=M,Ab=ta,ta=v}return[255*Va,255*Ab,255*ta]};hb.cmyk.rgb=function(M){const v=M[3]/100;return[255*(1-Math.min(1,M[0]/100*(1-v)+v)),255*(1-Math.min(1,M[1]/100*(1-v)+v)),255*(1-Math.min(1,M[2]/100*(1-v)+v))]};hb.xyz.rgb=function(M){var v=M[0]/100;const ta=M[1]/100,Va=M[2]/100;let Ab;M=3.2406*v+-1.5372*ta+-.4986*Va;Ab=-.9689*
v+1.8758*ta+.0415*Va;v=.0557*v+-.204*ta+1.057*Va;M=Math.min(Math.max(0,.0031308<M?1.055*M**(1/2.4)-.055:12.92*M),1);Ab=Math.min(Math.max(0,.0031308<Ab?1.055*Ab**(1/2.4)-.055:12.92*Ab),1);v=Math.min(Math.max(0,.0031308<v?1.055*v**(1/2.4)-.055:12.92*v),1);return[255*M,255*Ab,255*v]};hb.xyz.lab=function(M){let v=M[0],ta=M[1];M=M[2];v/=95.047;ta/=100;M/=108.883;ta=.008856<ta?ta**(1/3):7.787*ta+16/116;return[116*ta-16,500*((.008856<v?v**(1/3):7.787*v+16/116)-ta),200*(ta-(.008856<M?M**(1/3):7.787*M+16/
116))]};hb.lab.xyz=function(M){var v=M[1],ta=M[2];M=(M[0]+16)/116;v=v/500+M;ta=M-ta/200;const Va=M**3,Ab=v**3,$a=ta**3;return[95.047*(.008856<Ab?Ab:(v-16/116)/7.787),100*(.008856<Va?Va:(M-16/116)/7.787),108.883*(.008856<$a?$a:(ta-16/116)/7.787)]};hb.lab.lch=function(M){const v=M[0],ta=M[1];M=M[2];let Va;Va=360*Math.atan2(M,ta)/2/Math.PI;0>Va&&(Va+=360);return[v,Math.sqrt(ta*ta+M*M),Va]};hb.lch.lab=function(M){const v=M[1],ta=M[2]/360*2*Math.PI;return[M[0],v*Math.cos(ta),v*Math.sin(ta)]};hb.rgb.ansi16=
function(M,v=null){const [ta,Va,Ab]=M;M=null===v?hb.rgb.hsv(M)[2]:v;M=Math.round(M/50);if(0===M)return 30;v=30+(Math.round(Ab/255)<<2|Math.round(Va/255)<<1|Math.round(ta/255));2===M&&(v+=60);return v};hb.hsv.ansi16=function(M){return hb.rgb.ansi16(hb.hsv.rgb(M),M[2])};hb.rgb.ansi256=function(M){const v=M[0],ta=M[1];M=M[2];return v===ta&&ta===M?8>v?16:248<v?231:Math.round((v-8)/247*24)+232:16+36*Math.round(v/255*5)+6*Math.round(ta/255*5)+Math.round(M/255*5)};hb.ansi16.rgb=function(M){let v=M%10;if(0===
v||7===v)return 50<M&&(v+=3.5),v=v/10.5*255,[v,v,v];M=.5*(~~(50<M)+1);return[(v&1)*M*255,(v>>1&1)*M*255,(v>>2&1)*M*255]};hb.ansi256.rgb=function(M){if(232<=M){var v=10*(M-232)+8;return[v,v,v]}M-=16;v=Math.floor(M/36)/5*255;const ta=Math.floor((M%=36)/6)/5*255;return[v,ta,M%6/5*255]};hb.rgb.hex=function(M){M=(((Math.round(M[0])&255)<<16)+((Math.round(M[1])&255)<<8)+(Math.round(M[2])&255)).toString(16).toUpperCase();return"000000".substring(M.length)+M};hb.hex.rgb=function(M){M=M.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);
if(!M)return[0,0,0];let v=M[0];3===M[0].length&&(v=v.split("").map(ta=>ta+ta).join(""));M=parseInt(v,16);return[M>>16&255,M>>8&255,M&255]};hb.rgb.hcg=function(M){const v=M[0]/255,ta=M[1]/255;M=M[2]/255;const Va=Math.max(Math.max(v,ta),M),Ab=Math.min(Math.min(v,ta),M),$a=Va-Ab;return[(0>=$a?0:Va===v?(ta-M)/$a%6:Va===ta?2+(M-v)/$a:4+(v-ta)/$a)/6%1*360,100*$a,100*(1>$a?Ab/(1-$a):0)]};hb.hsl.hcg=function(M){var v=M[1]/100;const ta=M[2]/100;v=.5>ta?2*v*ta:2*v*(1-ta);let Va=0;1>v&&(Va=(ta-.5*v)/(1-v));
return[M[0],100*v,100*Va]};hb.hsv.hcg=function(M){const v=M[2]/100,ta=M[1]/100*v;let Va=0;1>ta&&(Va=(v-ta)/(1-ta));return[M[0],100*ta,100*Va]};hb.hcg.rgb=function(M){const v=M[1]/100;var ta=M[2]/100;if(0===v)return[255*ta,255*ta,255*ta];const Va=[0,0,0];M=M[0]/360%1*6;const Ab=M%1,$a=1-Ab;switch(Math.floor(M)){case 0:Va[0]=1;Va[1]=Ab;Va[2]=0;break;case 1:Va[0]=$a;Va[1]=1;Va[2]=0;break;case 2:Va[0]=0;Va[1]=1;Va[2]=Ab;break;case 3:Va[0]=0;Va[1]=$a;Va[2]=1;break;case 4:Va[0]=Ab;Va[1]=0;Va[2]=1;break;
default:Va[0]=1,Va[1]=0,Va[2]=$a}ta*=1-v;return[255*(v*Va[0]+ta),255*(v*Va[1]+ta),255*(v*Va[2]+ta)]};hb.hcg.hsv=function(M){const v=M[1]/100,ta=v+M[2]/100*(1-v);let Va=0;0<ta&&(Va=v/ta);return[M[0],100*Va,100*ta]};hb.hcg.hsl=function(M){const v=M[1]/100,ta=M[2]/100*(1-v)+.5*v;let Va=0;0<ta&&.5>ta?Va=v/(2*ta):.5<=ta&&1>ta&&(Va=v/(2*(1-ta)));return[M[0],100*Va,100*ta]};hb.hcg.hwb=function(M){const v=M[1]/100,ta=v+M[2]/100*(1-v);return[M[0],100*(ta-v),100*(1-ta)]};hb.hwb.hcg=function(M){const v=1-M[2]/
100,ta=v-M[1]/100;let Va=0;1>ta&&(Va=(v-ta)/(1-ta));return[M[0],100*ta,100*Va]};hb.apple.rgb=function(M){return[M[0]/65535*255,M[1]/65535*255,M[2]/65535*255]};hb.rgb.apple=function(M){return[M[0]/255*65535,M[1]/255*65535,M[2]/255*65535]};hb.gray.rgb=function(M){return[M[0]/100*255,M[0]/100*255,M[0]/100*255]};hb.gray.hsl=function(M){return[0,0,M[0]]};hb.gray.hsv=hb.gray.hsl;hb.gray.hwb=function(M){return[0,100,M[0]]};hb.gray.cmyk=function(M){return[0,0,0,M[0]]};hb.gray.lab=function(M){return[M[0],
0,0]};hb.gray.hex=function(M){M=Math.round(M[0]/100*255)&255;M=((M<<16)+(M<<8)+M).toString(16).toUpperCase();return"000000".substring(M.length)+M};hb.rgb.gray=function(M){return[(M[0]+M[1]+M[2])/3/255*100]}};
shadow$provide[17]=function(Le,Sd,Yd,ba){function Na(hb,M){return function(v){return M(hb(v))}}const qc=Sd(16);Yd.exports=function(hb){const M={};var v=Object.keys(qc);for(let $a=v.length,Sb=0;Sb<$a;Sb++)M[v[Sb]]={distance:-1,parent:null};v=[hb];for(M[hb].distance=0;v.length;){hb=v.pop();var ta=Object.keys(qc[hb]);for(let $a=ta.length,Sb=0;Sb<$a;Sb++){var Va=ta[Sb],Ab=M[Va];-1===Ab.distance&&(Ab.distance=M[hb].distance+1,Ab.parent=hb,v.unshift(Va))}}v={};hb=Object.keys(M);for(let $a=hb.length,Sb=
0;Sb<$a;Sb++){ta=hb[Sb];if(null===M[ta].parent)continue;Va=[M[ta].parent,ta];Ab=qc[M[ta].parent][ta];let na=M[ta].parent;for(;M[na].parent;)Va.unshift(M[na].parent),Ab=Na(qc[M[na].parent][na],Ab),na=M[na].parent;Ab.conversion=Va;v[ta]=Ab}return v}};
shadow$provide[18]=function(Le,Sd,Yd,ba){function Na(ta){const Va=function(...Ab){const $a=Ab[0];if(void 0===$a||null===$a)return $a;1<$a.length&&(Ab=$a);return ta(Ab)};"conversion"in ta&&(Va.conversion=ta.conversion);return Va}function qc(ta){const Va=function(...Ab){const $a=Ab[0];if(void 0===$a||null===$a)return $a;1<$a.length&&(Ab=$a);Ab=ta(Ab);if("object"===typeof Ab)for(let Sb=Ab.length,na=0;na<Sb;na++)Ab[na]=Math.round(Ab[na]);return Ab};"conversion"in ta&&(Va.conversion=ta.conversion);return Va}
const hb=Sd(16),M=Sd(17),v={};Object.keys(hb).forEach(ta=>{v[ta]={};Object.defineProperty(v[ta],"channels",{value:hb[ta].channels});Object.defineProperty(v[ta],"labels",{value:hb[ta].labels});const Va=M(ta);Object.keys(Va).forEach(Ab=>{const $a=Va[Ab];v[ta][Ab]=qc($a);v[ta][Ab].raw=Na($a)})});Yd.exports=v};
shadow$provide[19]=function(Le,Sd,Yd,ba){function Na(na,bb){if(!(this instanceof Na))return new Na(na,bb);bb&&bb in Ab&&(bb=null);if(bb&&!(bb in Va))throw Error("Unknown model: "+bb);if(null==na)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(na instanceof Na)this.model=na.model,this.color=[...na.color],this.valpha=na.valpha;else if("string"===typeof na){bb=ta.get(na);if(null===bb)throw Error("Unable to parse color from string: "+na);this.model=bb.model;var tc=Va[this.model].channels;this.color=
bb.value.slice(0,tc);this.valpha="number"===typeof bb.value[tc]?bb.value[tc]:1}else if(0<na.length)this.model=bb||"rgb",tc=Va[this.model].channels,bb=Array.prototype.slice.call(na,0,tc),this.color=v(bb,tc),this.valpha="number"===typeof na[tc]?na[tc]:1;else if("number"===typeof na)this.model="rgb",this.color=[na>>16&255,na>>8&255,na&255],this.valpha=1;else{this.valpha=1;bb=Object.keys(na);"alpha"in na&&(bb.splice(bb.indexOf("alpha"),1),this.valpha="number"===typeof na.alpha?na.alpha:0);bb=bb.sort().join("");
if(!(bb in $a))throw Error("Unable to parse color from object: "+JSON.stringify(na));this.model=$a[bb];({labels:tc}=Va[this.model]);const vb=[];for(bb=0;bb<tc.length;bb++)vb.push(na[tc[bb]]);this.color=v(vb)}if(Sb[this.model])for(tc=Va[this.model].channels,bb=0;bb<tc;bb++)(na=Sb[this.model][bb])&&(this.color[bb]=na(this.color[bb]));this.valpha=Math.max(0,Math.min(1,this.valpha));Object.freeze&&Object.freeze(this)}function qc(na){return function(bb){return Number(bb.toFixed(na))}}function hb(na,bb,
tc){na=Array.isArray(na)?na:[na];for(const vb of na)(Sb[vb]||(Sb[vb]=[]))[bb]=tc;na=na[0];return function(vb){let Pa;if(void 0!==vb)return tc&&(vb=tc(vb)),Pa=this[na](),Pa.color[bb]=vb,Pa;Pa=this[na]().color[bb];tc&&(Pa=tc(Pa));return Pa}}function M(na){return function(bb){return Math.max(0,Math.min(na,bb))}}function v(na,bb){for(let tc=0;tc<bb;tc++)"number"!==typeof na[tc]&&(na[tc]=0);return na}const ta=Sd(15),Va=Sd(18),Ab=["keyword","gray","hex"],$a={};for(const na of Object.keys(Va))$a[[...Va[na].labels].sort().join("")]=
na;const Sb={};Na.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(na){let bb=this.model in ta.to?this:this.rgb();bb=bb.round("number"===typeof na?na:1);na=1===bb.valpha?bb.color:[...bb.color,this.valpha];return ta.to[bb.model](na)},percentString(na){na=this.rgb().round("number"===typeof na?na:1);na=1===na.valpha?na.color:[...na.color,this.valpha];return ta.to.rgb.percent(na)},array(){return 1===this.valpha?[...this.color]:[...this.color,this.valpha]},object(){const na=
{},{channels:bb}=Va[this.model],{labels:tc}=Va[this.model];for(let vb=0;vb<bb;vb++)na[tc[vb]]=this.color[vb];1!==this.valpha&&(na.alpha=this.valpha);return na},unitArray(){const na=this.rgb().color;na[0]/=255;na[1]/=255;na[2]/=255;1!==this.valpha&&na.push(this.valpha);return na},unitObject(){const na=this.rgb().object();na.r/=255;na.g/=255;na.b/=255;1!==this.valpha&&(na.alpha=this.valpha);return na},round(na){na=Math.max(na||0,0);return new Na([...this.color.map(qc(na)),this.valpha],this.model)},
alpha(na){return void 0!==na?new Na([...this.color,Math.max(0,Math.min(1,na))],this.model):this.valpha},red:hb("rgb",0,M(255)),green:hb("rgb",1,M(255)),blue:hb("rgb",2,M(255)),hue:hb(["hsl","hsv","hsl","hwb","hcg"],0,na=>(na%360+360)%360),saturationl:hb("hsl",1,M(100)),lightness:hb("hsl",2,M(100)),saturationv:hb("hsv",1,M(100)),value:hb("hsv",2,M(100)),chroma:hb("hcg",1,M(100)),gray:hb("hcg",2,M(100)),white:hb("hwb",1,M(100)),wblack:hb("hwb",2,M(100)),cyan:hb("cmyk",0,M(100)),magenta:hb("cmyk",1,
M(100)),yellow:hb("cmyk",2,M(100)),black:hb("cmyk",3,M(100)),x:hb("xyz",0,M(95.047)),y:hb("xyz",1,M(100)),z:hb("xyz",2,M(108.833)),l:hb("lab",0,M(100)),a:hb("lab",1),b:hb("lab",2),keyword(na){return void 0!==na?new Na(na):Va[this.model].keyword(this.color)},hex(na){return void 0!==na?new Na(na):ta.to.hex(this.rgb().round().color)},hexa(na){if(void 0!==na)return new Na(na);na=this.rgb().round().color;let bb=Math.round(255*this.valpha).toString(16).toUpperCase();1===bb.length&&(bb="0"+bb);return ta.to.hex(na)+
bb},rgbNumber(){const na=this.rgb().color;return(na[0]&255)<<16|(na[1]&255)<<8|na[2]&255},luminosity(){var na=this.rgb().color;const bb=[];for(const [tc,vb]of na.entries())na=vb/255,bb[tc]=.04045>=na?na/12.92:((na+.055)/1.055)**2.4;return.2126*bb[0]+.7152*bb[1]+.0722*bb[2]},contrast(na){const bb=this.luminosity();na=na.luminosity();return bb>na?(bb+.05)/(na+.05):(na+.05)/(bb+.05)},level(na){na=this.contrast(na);return 7<=na?"AAA":4.5<=na?"AA":""},isDark(){const na=this.rgb().color;return 128>(2126*
na[0]+7152*na[1]+722*na[2])/1E4},isLight(){return!this.isDark()},negate(){const na=this.rgb();for(let bb=0;3>bb;bb++)na.color[bb]=255-na.color[bb];return na},lighten(na){const bb=this.hsl();bb.color[2]+=bb.color[2]*na;return bb},darken(na){const bb=this.hsl();bb.color[2]-=bb.color[2]*na;return bb},saturate(na){const bb=this.hsl();bb.color[1]+=bb.color[1]*na;return bb},desaturate(na){const bb=this.hsl();bb.color[1]-=bb.color[1]*na;return bb},whiten(na){const bb=this.hwb();bb.color[1]+=bb.color[1]*
na;return bb},blacken(na){const bb=this.hwb();bb.color[2]+=bb.color[2]*na;return bb},grayscale(){var na=this.rgb().color;na=.3*na[0]+.59*na[1]+.11*na[2];return Na.rgb(na,na,na)},fade(na){return this.alpha(this.valpha-this.valpha*na)},opaquer(na){return this.alpha(this.valpha+this.valpha*na)},rotate(na){const bb=this.hsl();let tc=bb.color[0];tc=(tc+na)%360;bb.color[0]=0>tc?360+tc:tc;return bb},mix(na,bb){if(!na||!na.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+
typeof na);na=na.rgb();const tc=this.rgb();bb=void 0===bb?.5:bb;var vb=2*bb-1,Pa=na.alpha()-tc.alpha();vb=((-1===vb*Pa?vb:(vb+Pa)/(1+vb*Pa))+1)/2;Pa=1-vb;return Na.rgb(vb*na.red()+Pa*tc.red(),vb*na.green()+Pa*tc.green(),vb*na.blue()+Pa*tc.blue(),na.alpha()*bb+tc.alpha()*(1-bb))}};for(const na of Object.keys(Va)){if(Ab.includes(na))continue;const {channels:bb}=Va[na];Na.prototype[na]=function(...tc){if(this.model===na)return new Na(this);if(0<tc.length)return new Na(tc,na);tc=Va[this.model][na].raw(this.color);
tc=Array.isArray(tc)?tc:[tc];return new Na([...tc,this.valpha],na)};Na[na]=function(...tc){let vb=tc[0];"number"===typeof vb&&(vb=v(tc,bb));return new Na(vb,na)}}Yd.exports=Na};
shadow$provide[20]=function(Le,Sd,Yd,ba){(function(Na,qc){"object"===typeof ba&&"undefined"!==typeof Yd?qc(ba):"function"===typeof define&&define.amd?define(["exports"],qc):(Na="undefined"!==typeof globalThis?globalThis:Na||self,qc(Na.maplibreGlStyleSpecification={}))})(this,function(Na){function qc(t,A){const E={};for(const N in t)"ref"!==N&&(E[N]=t[N]);Xe.forEach(N=>{N in A&&(E[N]=A[N])});return E}function hb(t,A){if(Array.isArray(t)){if(!Array.isArray(A)||t.length!==A.length)return!1;for(var E=
0;E<t.length;E++)if(!hb(t[E],A[E]))return!1;return!0}if("object"===typeof t&&null!==t&&null!==A){if("object"!==typeof A||Object.keys(t).length!==Object.keys(A).length)return!1;for(E in t)if(!hb(t[E],A[E]))return!1;return!0}return t===A}function M(t,A,E){A.push({command:"removeSource",args:[t]});E[t]=!0}function v(t,A,E,N){t=t||{};A=A||{};let U;for(U in t)Object.prototype.hasOwnProperty.call(t,U)&&(Object.prototype.hasOwnProperty.call(A,U)||M(U,E,N));for(U in A)if(Object.prototype.hasOwnProperty.call(A,
U))if(!Object.prototype.hasOwnProperty.call(t,U))E.push({command:"addSource",args:[U,A[U]]});else if(!hb(t[U],A[U])){var ea;if(ea="geojson"===t[U].type&&"geojson"===A[U].type)a:{let Ga=void 0;ea=t;var ia=A,va=U;for(Ga in ea[va])if(Object.prototype.hasOwnProperty.call(ea[va],Ga)&&"data"!==Ga&&!hb(ea[va][Ga],ia[va][Ga])){ea=!1;break a}for(Ga in ia[va])if(Object.prototype.hasOwnProperty.call(ia[va],Ga)&&"data"!==Ga&&!hb(ea[va][Ga],ia[va][Ga])){ea=!1;break a}ea=!0}ea?E.push({command:"setGeoJSONSourceData",
args:[U,A[U].data]}):(ea=U,ia=A,va=E,M(ea,va,N),va.push({command:"addSource",args:[ea,ia[ea]]}))}}function ta(t,A,E,N,U,ea){t=t||{};A=A||{};for(const ia in t)Object.prototype.hasOwnProperty.call(t,ia)&&(hb(t[ia],A[ia])||E.push({command:ea,args:[N,ia,A[ia],U]}));for(const ia in A)Object.prototype.hasOwnProperty.call(A,ia)&&!Object.prototype.hasOwnProperty.call(t,ia)&&(hb(t[ia],A[ia])||E.push({command:ea,args:[N,ia,A[ia],U]}))}function Va(t){return t.id}function Ab(t,A){t[A.id]=A;return t}function $a(t,
A,E){t=t||[];A=A||[];var N=t.map(Va);const U=A.map(Va);t=t.reduce(Ab,{});A=A.reduce(Ab,{});const ea=N.slice(),ia=Object.create(null);let va;let Ga;for(let ab=0,Qb=0;ab<N.length;ab++)va=N[ab],Object.prototype.hasOwnProperty.call(A,va)?Qb++:(E.push({command:"removeLayer",args:[va]}),ea.splice(ea.indexOf(va,Qb),1));for(let ab=0,Qb=0;ab<U.length;ab++)if(va=U[U.length-1-ab],ea[ea.length-1-ab]!==va){Object.prototype.hasOwnProperty.call(t,va)?(E.push({command:"removeLayer",args:[va]}),ea.splice(ea.lastIndexOf(va,
ea.length-Qb),1)):Qb++;var Sa=ea[ea.length-ab];E.push({command:"addLayer",args:[A[va],Sa]});ea.splice(ea.length-ab,0,va);ia[va]=!0}for(let ab=0;ab<U.length;ab++)if(va=U[ab],Sa=t[va],N=A[va],!ia[va]&&!hb(Sa,N))if(hb(Sa.source,N.source)&&hb(Sa["source-layer"],N["source-layer"])&&hb(Sa.type,N.type)){ta(Sa.layout,N.layout,E,va,null,"setLayoutProperty");ta(Sa.paint,N.paint,E,va,null,"setPaintProperty");hb(Sa.filter,N.filter)||E.push({command:"setFilter",args:[va,N.filter]});hb(Sa.minzoom,N.minzoom)&&hb(Sa.maxzoom,
N.maxzoom)||E.push({command:"setLayerZoomRange",args:[va,N.minzoom,N.maxzoom]});for(Ga in Sa)Object.prototype.hasOwnProperty.call(Sa,Ga)&&"layout"!==Ga&&"paint"!==Ga&&"filter"!==Ga&&"metadata"!==Ga&&"minzoom"!==Ga&&"maxzoom"!==Ga&&(0===Ga.indexOf("paint.")?ta(Sa[Ga],N[Ga],E,va,Ga.slice(6),"setPaintProperty"):hb(Sa[Ga],N[Ga])||E.push({command:"setLayerProperty",args:[va,Ga,N[Ga]]}));for(Ga in N)Object.prototype.hasOwnProperty.call(N,Ga)&&!Object.prototype.hasOwnProperty.call(Sa,Ga)&&"layout"!==Ga&&
"paint"!==Ga&&"filter"!==Ga&&"metadata"!==Ga&&"minzoom"!==Ga&&"maxzoom"!==Ga&&(0===Ga.indexOf("paint.")?ta(Sa[Ga],N[Ga],E,va,Ga.slice(6),"setPaintProperty"):hb(Sa[Ga],N[Ga])||E.push({command:"setLayerProperty",args:[va,Ga,N[Ga]]}))}else E.push({command:"removeLayer",args:[va]}),Sa=ea[ea.lastIndexOf(va)+1],E.push({command:"addLayer",args:[N,Sa]})}function Sb(t,...A){for(const E of A)for(const N in E)t[N]=E[N];return t}function na(t,A){return{kind:"array",itemType:t,N:A}}function bb(t){if("array"===
t.kind){const A=bb(t.itemType);return"number"===typeof t.N?`array<${A}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${A}>`}return t.kind}function tc(t,A){if("error"===A.kind)return null;if("array"===t.kind){if("array"===A.kind&&(0===A.N&&"value"===A.itemType.kind||!tc(t.itemType,A.itemType))&&("number"!==typeof t.N||t.N===A.N))return null}else{if(t.kind===A.kind)return null;if("value"===t.kind)for(const E of Jd)if(!tc(E,A))return null}return`Expected ${bb(t)} but found ${bb(A)} instead.`}function vb(t,
A){return A.some(E=>E.kind===t.kind)}function Pa(t,A){return A.some(E=>"null"===E?null===t:"array"===E?Array.isArray(t):"object"===E?t&&!Array.isArray(t)&&"object"===typeof t:E===typeof t)}function yb(t,A){return"array"===t.kind&&"array"===A.kind?t.itemType.kind===A.itemType.kind&&"number"===typeof t.N:t.kind===A.kind}function Ib(t){t%=360;0>t&&(t+=360);return t}function Fb([t,A,E,N]){t=zb(t);A=zb(A);E=zb(E);let U;const ea=lc(.2225045*t+.7168786*A+.0606169*E);t===A&&A===E?U=t=ea:(U=lc((.4360747*t+
.3850649*A+.1430804*E)/.96422),t=lc((.0139322*t+.0971045*A+.7141733*E)/.82521));A=116*ea-16;return[0>A?0:A,500*(U-ea),200*(ea-t),N]}function zb(t){return.04045>=t?t/12.92:Math.pow((t+.055)/1.055,2.4)}function lc(t){return t>Da?Math.pow(t,1/3):t/Ze+ee}function bc([t,A,E,N]){t=(t+16)/116;A=isNaN(A)?t:t+A/500;E=isNaN(E)?t:t-E/200;t=1*Jc(t);A=.96422*Jc(A);E=.82521*Jc(E);return[Hc(3.1338561*A-1.6168667*t-.4906146*E),Hc(-.9787684*A+1.9161415*t+.033454*E),Hc(.0719453*A-.2289914*t+1.4052427*E),N]}function Hc(t){t=
.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055;return 0>t?0:1<t?1:t}function Jc(t){return t>Ie?t*t*t:Ze*(t-ee)}function id([t,A,E,N]){t=isNaN(t)?0:t*Fi;return bc([E,Math.cos(t)*A,Math.sin(t)*A,N])}function sd([t,A,E,N]){function U(ea){ea=(ea+t/30)%12;return E-A*Math.min(E,1-E)*Math.max(-1,Math.min(ea-3,9-ea,1))}t=Ib(t);A/=100;E/=100;return[U(0),U(8),U(4),N]}function Dc(t){t=t.toLowerCase().trim();if("transparent"===t)return[0,0,0,0];var A=fe[t];if(A){const [U,ea,ia]=A;return[U/255,ea/255,ia/255,1]}if(t.startsWith("#")&&
/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){A=6>t.length?1:2;var E=1;return[dc(t.slice(E,E+=A)),dc(t.slice(E,E+=A)),dc(t.slice(E,E+=A)),dc(t.slice(E,E+A)||"ff")]}if(t.startsWith("rgb")&&(A=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/))){const [,U,ea,ia,va,Ga,Sa,ab,Qb,ic,Vb,Sc]=A;t=[ia||" ",Sa||" ",ic].join("");if("  "===t||"  /"===t||",,"===t||",,,"===t)if(t=[ea,Ga,Qb].join(""),E="%%%"===t?100:
""===t?255:0){t=xc(+U/E,0,1);A=xc(+va/E,0,1);E=xc(+ab/E,0,1);if(Vb){var N=+Vb;N=xc(Sc?N/100:N,0,1)}else N=1;t=[t,A,E,N];if(!t.some(Number.isNaN))return t}return}if(t=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/)){const [,U,ea,ia,va,Ga,Sa,ab,Qb]=t;t=[ea||" ",va||" ",Sa].join("");if("  "===t||"  /"===t||",,"===t||",,,"===t)if(t=xc(+ia,0,100),A=xc(+Ga,0,100),ab?(E=+ab,E=xc(Qb?E/100:E,0,1)):E=1,t=[+U,t,A,E],!t.some(Number.isNaN))return sd(t)}}
function dc(t){return parseInt(t.padEnd(2,t),16)/255}function xc(t,A,E){return Math.min(Math.max(A,t),E)}function Nc(t,A,E,N){return"number"===typeof t&&0<=t&&255>=t&&"number"===typeof A&&0<=A&&255>=A&&"number"===typeof E&&0<=E&&255>=E?"undefined"===typeof N||"number"===typeof N&&0<=N&&1>=N?null:`Invalid rgba value [${[t,A,E,N].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"===typeof N?[t,A,E,N]:[t,A,E]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pd(t){if(null===
t||"string"===typeof t||"boolean"===typeof t||"number"===typeof t||t instanceof Ad||t instanceof ye||t instanceof tf||t instanceof Ce||t instanceof af||t instanceof Pe)return!0;if(Array.isArray(t)){for(const A of t)if(!pd(A))return!1;return!0}if("object"===typeof t){for(const A in t)if(!pd(t[A]))return!1;return!0}return!1}function Ic(t){if(null===t)return He;if("string"===typeof t)return Cb;if("boolean"===typeof t)return kd;if("number"===typeof t)return Eb;if(t instanceof Ad)return $f;if(t instanceof
ye)return Ld;if(t instanceof tf)return yd;if(t instanceof Ce)return Md;if(t instanceof af)return ed;if(t instanceof Pe)return dd;if(Array.isArray(t)){const A=t.length;let E;for(const N of t)if(t=Ic(N),E){if(E!==t){E=ld;break}}else E=t;return na(E||ld,A)}return sf}function Rc(t){const A=typeof t;return null===t?"":"string"===A||"number"===A||"boolean"===A?String(t):t instanceof Ad||t instanceof tf||t instanceof Ce||t instanceof af||t instanceof Pe?t.toString():JSON.stringify(t)}function Kb(t,A){const E=
t.length-1;let N=0,U=E,ea,ia,va;for(;N<=U;)if(ea=Math.floor((N+U)/2),ia=t[ea],va=t[ea+1],ia<=A){if(ea===E||A<va)return ea;N=ea+1}else if(ia>A)U=ea-1;else throw new ge("Input is not a number.");return 0}function Ma(t){return"rgb"===t||"hcl"===t||"lab"===t}function jb(t,A,E){return t+E*(A-t)}function sc(t,A,E,N="rgb"){switch(N){case "rgb":const [U,ea,ia,va]=Ac(t.rgb,A.rgb,E);return new Ad(U,ea,ia,va,!1);case "hcl":const [Ga,Sa,ab,Qb]=t.hcl,[ic,Vb,Sc,mc]=A.hcl;let xd;if(isNaN(Ga)||isNaN(ic))if(isNaN(Ga))if(isNaN(ic))t=
NaN;else{if(t=ic,1===ab||0===ab)xd=Vb}else{if(t=Ga,1===Sc||0===Sc)xd=Sa}else t=ic-Ga,ic>Ga&&180<t?t-=360:ic<Ga&&180<Ga-ic&&(t+=360),t=Ga+E*t;const [Sg,If,Fj,mf]=id([t,null!==xd&&void 0!==xd?xd:jb(Sa,Vb,E),jb(ab,Sc,E),jb(Qb,mc,E)]);return new Ad(Sg,If,Fj,mf,!1);case "lab":const [Rf,ij,Ug,Mc]=bc(Ac(t.lab,A.lab,E));return new Ad(Rf,ij,Ug,Mc,!1)}}function Ac(t,A,E){return t.map((N,U)=>jb(N,A[U],E))}function Tc(t,A,E){return new Ce(Ac(t.values,A.values,E))}function od(t,A,E){const N=t.values,U=A.values;
if(N.length!==U.length)throw new ge(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${A.toString()}`);t=[];for(A=0;A<N.length;A+=2){if(N[A]!==U[A])throw new ge(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${N[A]}, to[${A}]: ${U[A]}`);t.push(N[A]);const [ea,ia]=N[A+1],[va,Ga]=U[A+1];t.push([jb(ea,va,E),jb(ia,Ga,E)])}return new af(t)}function Vc(t,A,E,N){N-=E;t-=E;return 0===N?0:1===A?t/N:(Math.pow(A,t)-1)/(Math.pow(A,N)-1)}function yc(t,A){return"\x3d\x3d"===
t||"!\x3d"===t?"boolean"===A.kind||"string"===A.kind||"number"===A.kind||"null"===A.kind||"value"===A.kind:"string"===A.kind||"number"===A.kind||"value"===A.kind}function Pc(t,A,E,N){return 0===N.compare(A,E)}function td(t,A,E){const N="\x3d\x3d"!==t&&"!\x3d"!==t,U=class{constructor(ea,ia,va){this.type=kd;this.lhs=ea;this.rhs=ia;this.collator=va;this.hasUntypedArgument="value"===ea.type.kind||"value"===ia.type.kind}static parse(ea,ia){if(3!==ea.length&&4!==ea.length)return ia.error("Expected two or three arguments.");
var va=ea[0];let Ga=ia.parse(ea[1],1,ld);if(!Ga)return null;if(!yc(va,Ga.type))return ia.concat(1).error(`"${va}" comparisons are not supported for type '${bb(Ga.type)}'.`);let Sa=ia.parse(ea[2],2,ld);if(!Sa)return null;if(!yc(va,Sa.type))return ia.concat(2).error(`"${va}" comparisons are not supported for type '${bb(Sa.type)}'.`);if(Ga.type.kind!==Sa.type.kind&&"value"!==Ga.type.kind&&"value"!==Sa.type.kind)return ia.error(`Cannot compare types '${bb(Ga.type)}' and '${bb(Sa.type)}'.`);N&&("value"===
Ga.type.kind&&"value"!==Sa.type.kind?Ga=new Qe(Sa.type,[Ga]):"value"!==Ga.type.kind&&"value"===Sa.type.kind&&(Sa=new Qe(Ga.type,[Sa])));va=null;if(4===ea.length){if("string"!==Ga.type.kind&&"string"!==Sa.type.kind&&"value"!==Ga.type.kind&&"value"!==Sa.type.kind)return ia.error("Cannot use collator to compare non-string types.");va=ia.parse(ea[3],3,Ld);if(!va)return null}return new U(Ga,Sa,va)}evaluate(ea){const ia=this.lhs.evaluate(ea),va=this.rhs.evaluate(ea);if(N&&this.hasUntypedArgument){var Ga=
Ic(ia),Sa=Ic(va);if(Ga.kind!==Sa.kind||"string"!==Ga.kind&&"number"!==Ga.kind)throw new ge(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${Ga.kind}, ${Sa.kind}) instead.`);}return this.collator&&!N&&this.hasUntypedArgument&&(Ga=Ic(ia),Sa=Ic(va),"string"!==Ga.kind||"string"!==Sa.kind)?A(ea,ia,va):this.collator?E(ea,ia,va,this.collator.evaluate(ea)):A(ea,ia,va)}eachChild(ea){ea(this.lhs);ea(this.rhs);this.collator&&ea(this.collator)}outputDefined(){return!0}};
return U}function Cd(t,A){const E=Math.pow(2,A.z);return[(t[0]/8192+A.x)/E*360-180,360/Math.PI*Math.atan(Math.exp((180-(t[1]/8192+A.y)/E*360)*Math.PI/180))-90]}function Gd(t,A){t[0]=Math.min(t[0],A[0]);t[1]=Math.min(t[1],A[1]);t[2]=Math.max(t[2],A[0]);t[3]=Math.max(t[3],A[1])}function pe(t,A){return t[0]<=A[0]||t[2]>=A[2]||t[1]<=A[1]||t[3]>=A[3]?!1:!0}function qe(t,A,E,N){const U=[A[0]-t[0],A[1]-t[1]],ea=[N[0]-E[0],N[1]-E[1]];return 0===ea[0]*U[1]-ea[1]*U[0]?!1:J(t,A,E,N)&&J(E,N,t,A)?!0:!1}function gf(t,
A,E=!1){let N=!1;for(const Ga of A)for(A=0;A<Ga.length-1;A++){var U=t,ea=Ga[A],ia=Ga[A+1],va=U[0]-ea[0];ea=U[1]-ea[1];const Sa=U[0]-ia[0];U=U[1]-ia[1];if(0===va*U-Sa*ea&&0>=va*Sa&&0>=ea*U)return E;va=t;U=Ga[A];ia=Ga[A+1];U[1]>va[1]!==ia[1]>va[1]&&va[0]<(ia[0]-U[0])*(va[1]-U[1])/(ia[1]-U[1])+U[0]&&(N=!N)}return N}function da(t,A){for(var E of t)if(!gf(E,A))return!1;for(E=0;E<t.length-1;++E){a:{var N=t[E];var U=t[E+1],ea=A;for(const ia of ea)for(ea=0;ea<ia.length-1;++ea)if(qe(N,U,ia[ea],ia[ea+1])){N=
!0;break a}N=!1}if(N)return!1}return!0}function J(t,A,E,N){const U=N[0]-E[0];N=N[1]-E[1];t=(t[0]-E[0])*N-U*(t[1]-E[1]);A=(A[0]-E[0])*N-U*(A[1]-E[1]);return 0<t&&0>A||0>t&&0<A?!0:!1}function O(t,A,E){const N=[];for(let ea=0;ea<t.length;ea++){const ia=[];for(let va=0;va<t[ea].length;va++){var U=t[ea][va];const Ga=Math.pow(2,E.z);U=[Math.round((180+U[0])/360*Ga*8192),Math.round((180-180/Math.PI*Math.log(Math.tan(Math.PI/4+U[1]*Math.PI/360)))/360*Ga*8192)];Gd(A,U);ia.push(U)}N.push(ia)}return N}function W(t,
A,E){const N=[];for(let U=0;U<t.length;U++){const ea=O(t[U],A,E);N.push(ea)}return N}function S(t,A,E,N){if(t[0]<E[0]||t[0]>E[2]){const U=.5*N;let ea=t[0]-E[0]>U?-N:E[0]-t[0]>U?N:0;0===ea&&(ea=t[0]-E[2]>U?-N:E[2]-t[0]>U?N:0);t[0]+=ea}Gd(A,t)}function fa(t,A,E,N){const U=8192*Math.pow(2,N.z);N=[8192*N.x,8192*N.y];const ea=[];for(const ia of t)for(const va of ia)t=[va.x+N[0],va.y+N[1]],S(t,A,E,U),ea.push(t);return ea}function ra(t,A,E,N){const U=8192*Math.pow(2,N.z);N=[8192*N.x,8192*N.y];const ea=[];
for(const ia of t){t=[];for(const va of ia){const Ga=[va.x+N[0],va.y+N[1]];Gd(A,Ga);t.push(Ga)}ea.push(t)}if(A[2]-A[0]<=U/2){A[0]=A[1]=Infinity;A[2]=A[3]=-Infinity;for(const ia of ea)for(const va of ia)S(va,A,E,U)}return ea}function ma(t,A){var E=[Infinity,Infinity,-Infinity,-Infinity];const N=[Infinity,Infinity,-Infinity,-Infinity],U=t.canonicalID();if("Polygon"===A.type){const ea=O(A.coordinates,N,U),ia=fa(t.geometry(),E,N,U);if(!pe(E,N))return!1;for(const va of ia)if(!gf(va,ea))return!1}if("MultiPolygon"===
A.type){A=W(A.coordinates,N,U);t=fa(t.geometry(),E,N,U);if(!pe(E,N))return!1;for(const ea of t){a:{for(const ia of A)if(gf(ea,ia)){E=!0;break a}E=!1}if(!E)return!1}}return!0}function ua(t,A){var E=[Infinity,Infinity,-Infinity,-Infinity];const N=[Infinity,Infinity,-Infinity,-Infinity],U=t.canonicalID();if("Polygon"===A.type){const ea=O(A.coordinates,N,U),ia=ra(t.geometry(),E,N,U);if(!pe(E,N))return!1;for(const va of ia)if(!da(va,ea))return!1}if("MultiPolygon"===A.type){A=W(A.coordinates,N,U);t=ra(t.geometry(),
E,N,U);if(!pe(E,N))return!1;for(const ea of t){a:{for(const ia of A)if(da(ea,ia)){E=!0;break a}E=!1}if(!E)return!1}}return!0}function Aa(t,A,E,N,U){for(;N>E;){if(600<N-E){var ea=N-E+1,ia=A-E+1,va=Math.log(ea),Ga=.5*Math.exp(2*va/3);va=.5*Math.sqrt(va*Ga*(ea-Ga)/ea)*(0>ia-ea/2?-1:1);Aa(t,A,Math.max(E,Math.floor(A-ia*Ga/ea+va)),Math.min(N,Math.floor(A+(ea-ia)*Ga/ea+va)),U)}ea=t[A];ia=E;Ga=N;Ua(t,E,A);for(0<U(t[N],ea)&&Ua(t,E,N);ia<Ga;){Ua(t,ia,Ga);ia++;for(Ga--;0>U(t[ia],ea);)ia++;for(;0<U(t[Ga],ea);)Ga--}0===
U(t[E],ea)?Ua(t,E,Ga):(Ga++,Ua(t,Ga,N));Ga<=A&&(E=Ga+1);A<=Ga&&(N=Ga-1)}}function Ua(t,A,E){var N=t[A];t[A]=t[E];t[E]=N}function fb(t,A){return t<A?-1:t>A?1:0}function pb(t,A){if(1>=t.length)return[t];const E=[];var N;for(const ea of t){t=0;for(let ia=0,va=ea.length,Ga=va-1,Sa,ab;ia<va;Ga=ia++)Sa=ea[ia],ab=ea[Ga],t+=(ab.x-Sa.x)*(Sa.y+ab.y);if(0!==t)if(ea.area=Math.abs(t),void 0===N&&(N=0>t),N===0>t){U&&E.push(U);var U=[ea]}else U.push(ea)}U&&E.push(U);if(1<A)for(N=0;N<E.length;N++)E[N].length<=A||
(U=E[N],Aa(U,A,1,E[N].length-1||U.length-1,Rb||fb),E[N]=E[N].slice(0,A));return E}function Rb(t,A){return A.area-t.area}function ec(t,A){return A[0]-t[0]}function kc(t,A){return t[1]>=t[0]&&t[1]<A}function fc(t,A){if(t[0]>t[1])return[null,null];const E=t[1]-t[0]+1;if(A){if(2===E)return[t,null];A=Math.floor(E/2);return[[t[0],t[0]+A],[t[0]+A,t[1]]]}if(1===E)return[t,null];A=Math.floor(E/2)-1;return[[t[0],t[0]+A],[t[0]+A+1,t[1]]]}function Gc(t,A){if(!kc(A,t.length))return[Infinity,Infinity,-Infinity,
-Infinity];const E=[Infinity,Infinity,-Infinity,-Infinity];for(let N=A[0];N<=A[1];++N)Gd(E,t[N]);return E}function Fc(t){const A=[Infinity,Infinity,-Infinity,-Infinity];for(const E of t)for(const N of E)Gd(A,N);return A}function Hd(t){return-Infinity!==t[0]&&-Infinity!==t[1]&&Infinity!==t[2]&&Infinity!==t[3]}function de(t,A,E){if(!Hd(t)||!Hd(A))return NaN;let N=0,U=0;t[2]<A[0]&&(N=A[0]-t[2]);t[0]>A[2]&&(N=t[0]-A[2]);t[1]>A[3]&&(U=t[1]-A[3]);t[3]<A[1]&&(U=A[1]-t[3]);return E.distance([0,0],[N,U])}
function Me(t,A,E){A=E.pointOnLine(A,t);return E.distance(t,A.point)}function zg(t,A,E,N,U){const ea=Math.min(Me(t,[E,N],U),Me(A,[E,N],U));t=Math.min(Me(E,[t,A],U),Me(N,[t,A],U));return Math.min(ea,t)}function Kf(t,A){for(const E of t)for(const N of E)if(gf(N,A,!0))return!0;return!1}function Lf(t,A,E,N=Infinity){var U=Fc(t),ea=Fc(A);if(Infinity!==N&&de(U,ea,E)>=N)return N;if(pe(U,ea)){if(Kf(t,A))return 0}else if(Kf(A,t))return 0;N=Infinity;for(const ia of t)for(let va=0,Ga=ia.length,Sa=Ga-1;va<Ga;Sa=
va++){t=ia[Sa];U=ia[va];for(const ab of A)for(let Qb=0,ic=ab.length,Vb=ic-1;Qb<ic;Vb=Qb++){ea=ab[Vb];const Sc=ab[Qb];if(qe(t,U,ea,Sc))return 0;N=Math.min(N,zg(t,U,ea,Sc,E))}}return N}function Ag(t,A,E,N,U,ea,ia){ea&&ia&&(E=de(Gc(N,ea),Gc(U,ia),E),E<A&&t.push([E,ea,ia]))}function Vi(t,A,E,N,U=Infinity){U=Math.min(N.distance(t[0],E[0][0]),U);if(0===U)return U;const ea=new hj([[0,[0,t.length-1],[0,0]]],ec),ia=Fc(E);for(;0<ea.length;){var va=ea.pop();if(!(va[0]>=U)){var Ga=va[1];if(Ga[1]-Ga[0]+1<=(A?
50:100)){if(!kc(Ga,t.length))return NaN;if(A){a:{va=t;var Sa=E,ab=N;if(kc(Ga,va.length)){for(var Qb=Ga[0];Qb<=Ga[1];++Qb)if(gf(va[Qb],Sa,!0)){va=0;break a}Qb=Infinity;for(var ic=Ga[0];ic<Ga[1];++ic){var Vb=va[ic];const Sc=va[ic+1];for(const mc of Sa)for(let xd=0,Sg=mc.length,If=Sg-1;xd<Sg;If=xd++){const Fj=mc[If],mf=mc[xd];if(qe(Vb,Sc,Fj,mf)){va=0;break a}Qb=Math.min(Qb,zg(Vb,Sc,Fj,mf,ab))}}va=Qb}else va=NaN}if(isNaN(va)||0===va)return va;U=Math.min(U,va)}else for(va=Ga[0];va<=Ga[1];++va){a:if(Sa=
t[va],ic=E,ab=N,gf(Sa,ic,!0))Sa=0;else{Qb=Infinity;for(const Sc of ic){ic=Sc[0];Vb=Sc[Sc.length-1];if(ic!==Vb&&(Qb=Math.min(Qb,Me(Sa,[Vb,ic],ab)),0===Qb)){Sa=Qb;break a}ic=ab.pointOnLine(Sc,Sa);Qb=Math.min(Qb,ab.distance(Sa,ic.point));if(0===Qb){Sa=Qb;break a}}Sa=Qb}U=Math.min(U,Sa);if(0===U)return 0}}else{va=fc(Ga,A);Ga=ea;Sa=U;Qb=N;ic=t;Vb=ia;if(ab=va[0])Qb=de(Gc(ic,ab),Vb,Qb),Qb<Sa&&Ga.push([Qb,ab,[0,0]]);Ga=ea;Sa=U;ab=N;Qb=t;ic=ia;if(va=va[1])ab=de(Gc(Qb,va),ic,ab),ab<Sa&&Ga.push([ab,va,[0,0]])}}}return U}
function qi(t,A,E,N,U,ea=Infinity){ea=Math.min(ea,U.distance(t[0],E[0]));if(0===ea)return ea;const ia=new hj([[0,[0,t.length-1],[0,E.length-1]]],ec);for(;0<ia.length;){var va=ia.pop();if(!(va[0]>=ea)){var Ga=va[1],Sa=va[2];va=N?50:100;if(Ga[1]-Ga[0]+1<=(A?50:100)&&Sa[1]-Sa[0]+1<=va){if(!kc(Ga,t.length)&&kc(Sa,E.length))return NaN;if(A&&N){a:{va=t;var ab=E,Qb=U;if(kc(Ga,va.length)&&kc(Sa,ab.length)){var ic=Infinity;for(var Vb=Ga[0];Vb<Ga[1];++Vb){var Sc=va[Vb];const mc=va[Vb+1];for(let xd=Sa[0];xd<
Sa[1];++xd){const Sg=ab[xd],If=ab[xd+1];if(qe(Sc,mc,Sg,If)){va=0;break a}ic=Math.min(ic,zg(Sc,mc,Sg,If,Qb))}}va=ic}else va=Infinity}ea=Math.min(ea,va)}else if(A&&!N)for(Ga=t.slice(Ga[0],Ga[1]+1),ab=Sa[0];ab<=Sa[1];++ab){if(va=Me(E[ab],Ga,U),ea=Math.min(ea,va),0===ea)return ea}else if(!A&&N)for(ab=E.slice(Sa[0],Sa[1]+1),Sa=Ga[0];Sa<=Ga[1];++Sa){if(va=Me(t[Sa],ab,U),ea=Math.min(ea,va),0===ea)return ea}else{a:if(va=t,ab=E,Qb=U,kc(Ga,va.length)&&kc(Sa,ab.length)){ic=Infinity;for(Vb=Ga[0];Vb<=Ga[1];++Vb)for(Sc=
Sa[0];Sc<=Sa[1];++Sc)if(ic=Math.min(ic,Qb.distance(va[Vb],ab[Sc])),0===ic){va=ic;break a}va=ic}else va=NaN;ea=Math.min(ea,va)}}else va=fc(Ga,A),Ga=fc(Sa,N),Ag(ia,ea,U,t,E,va[0],Ga[0]),Ag(ia,ea,U,t,E,va[0],Ga[1]),Ag(ia,ea,U,t,E,va[1],Ga[0]),Ag(ia,ea,U,t,E,va[1],Ga[1])}}return ea}function re(t,A){var E=t.geometry();const N=E.flat().map(ea=>Cd([ea.x,ea.y],t.canonical));if(0===E.length)return NaN;E=new Cj(N[0][1]);let U=Infinity;for(const ea of A){switch(ea.type){case "Point":U=Math.min(U,qi(N,!1,[ea.coordinates],
!1,E,U));break;case "LineString":U=Math.min(U,qi(N,!1,ea.coordinates,!0,E,U));break;case "Polygon":U=Math.min(U,Vi(N,!1,ea.coordinates,E,U))}if(0===U)break}return U}function Eh(t,A){var E=t.geometry();const N=E.flat().map(ea=>Cd([ea.x,ea.y],t.canonical));if(0===E.length)return NaN;E=new Cj(N[0][1]);let U=Infinity;for(const ea of A){switch(ea.type){case "Point":U=Math.min(U,qi(N,!0,[ea.coordinates],!1,E,U));break;case "LineString":U=Math.min(U,qi(N,!0,ea.coordinates,!0,E,U));break;case "Polygon":U=
Math.min(U,Vi(N,!0,ea.coordinates,E,U))}if(0===U)break}return U}function ok(t,A){var E=t.geometry();if(0===E.length||0===E[0].length)return NaN;E=pb(E,0).map(ea=>ea.map(ia=>ia.map(va=>Cd([va.x,va.y],t.canonical))));const N=new Cj(E[0][0][0][1]);let U=Infinity;for(const ea of A)for(const ia of E){switch(ea.type){case "Point":U=Math.min(U,Vi([ea.coordinates],!1,ia,N,U));break;case "LineString":U=Math.min(U,Vi(ea.coordinates,!0,ia,N,U));break;case "Polygon":U=Math.min(U,Lf(ia,ea.coordinates,N,U))}if(0===
U)return U}return U}function Nj(t){return"MultiPolygon"===t.type?t.coordinates.map(A=>({type:"Polygon",coordinates:A})):"MultiLineString"===t.type?t.coordinates.map(A=>({type:"LineString",coordinates:A})):"MultiPoint"===t.type?t.coordinates.map(A=>({type:"Point",coordinates:A})):[t]}function qj(t,[A,E,N,U]){A=A.evaluate(t);E=E.evaluate(t);N=N.evaluate(t);t=U?U.evaluate(t):1;if(U=Nc(A,E,N,t))throw new ge(U);return new Ad(A/255,E/255,N/255,t,!1)}function Ui(t,A){t=A[t];return"undefined"===typeof t?
null:t}function mh(t){if(t instanceof Gi)return mh(t.boundExpression);if(t instanceof vg&&"error"===t.name||t instanceof Nh||t instanceof Mi||t instanceof yh)return!1;const A=t instanceof Og||t instanceof Qe;let E=!0;t.eachChild(N=>{E=A?E&&mh(N):E&&N instanceof ug});return E?ri(t)&&Cg(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function ri(t){if(t instanceof vg&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||
"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Mi||t instanceof yh)return!1;let A=!0;t.eachChild(E=>{A&&!ri(E)&&(A=!1)});return A}function Bg(t){if(t instanceof vg&&"feature-state"===t.name)return!1;let A=!0;t.eachChild(E=>{A&&!Bg(E)&&(A=!1)});return A}function Cg(t,A){if(t instanceof vg&&0<=A.indexOf(t.name))return!1;let E=!0;t.eachChild(N=>{E&&!Cg(N,A)&&(E=!1)});return E}function Gh(t){return{result:"success",value:t}}function te(t){return{result:"error",
value:t}}function Zh(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Pj(t){return!!t.expression&&-1<t.expression.parameters.indexOf("zoom")}function oh(t){return!!t.expression&&t.expression.interpolated}function Id(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Xg(t){return"object"===typeof t&&null!==t&&!Array.isArray(t)}function tk(t){return t}
function ph(t,A){var E="color"===A.type,N=t.stops&&"object"===typeof t.stops[0][0],U=N||void 0!==t.property;U=N||!U;var ea=t.type||(oh(A)?"exponential":"interval");if(E||"padding"===A.type){const Qb=E?Ad.parse:Ce.parse;t=Sb({},t);t.stops&&(t.stops=t.stops.map(ic=>[ic[0],Qb(ic[1])]));t.default=t.default?Qb(t.default):Qb(A.default)}if(t.colorSpace&&!Ma(t.colorSpace))throw Error(`Unknown color space: "${t.colorSpace}"`);let ia,va,Ga;if("exponential"===ea)ia=Yi;else if("interval"===ea)ia=ui;else if("categorical"===
ea){ia=ti;va=Object.create(null);for(var Sa of t.stops)va[Sa[0]]=Sa[1];Ga=typeof t.stops[0][0]}else if("identity"===ea)ia=Fl;else throw Error(`Unknown function type "${ea}"`);if(N){E={};N=[];for(Sa=0;Sa<t.stops.length;Sa++)U=t.stops[Sa],ea=U[0].zoom,void 0===E[ea]&&(E[ea]={zoom:ea,type:t.type,property:t.property,default:t.default,stops:[]},N.push(ea)),E[ea].stops.push([U[0].value,U[1]]);const Qb=[];for(var ab of N)Qb.push([E[ab].zoom,ph(E[ab],A)]);ab={name:"linear"};return{kind:"composite",interpolationType:ab,
interpolationFactor:lf.interpolationFactor.bind(void 0,ab),zoomStops:Qb.map(ic=>ic[0]),evaluate({zoom:ic},Vb){return Yi({stops:Qb,base:t.base},A,ic).evaluate(ic,Vb)}}}return U?(ab="exponential"===ea?{name:"exponential",base:void 0!==t.base?t.base:1}:null,{kind:"camera",interpolationType:ab,interpolationFactor:lf.interpolationFactor.bind(void 0,ab),zoomStops:t.stops.map(Qb=>Qb[0]),evaluate:({zoom:Qb})=>ia(t,A,Qb,va,Ga)}):{kind:"source",evaluate(Qb,ic){Qb=ic&&ic.properties?ic.properties[t.property]:
void 0;return void 0===Qb?Dg(t.default,A.default):ia(t,A,Qb,va,Ga)}}}function Dg(t,A,E){if(void 0!==t)return t;if(void 0!==A)return A;if(void 0!==E)return E}function ti(t,A,E,N,U){return Dg(typeof E===U?N[E]:void 0,t.default,A.default)}function ui(t,A,E){if("number"!==Id(E))return Dg(t.default,A.default);A=t.stops.length;if(1===A||E<=t.stops[0][0])return t.stops[0][1];if(E>=t.stops[A-1][0])return t.stops[A-1][1];E=Kb(t.stops.map(N=>N[0]),E);return t.stops[E][1]}function Yi(t,A,E){const N=void 0!==
t.base?t.base:1;if("number"!==Id(E))return Dg(t.default,A.default);var U=t.stops.length;if(1===U||E<=t.stops[0][0])return t.stops[0][1];if(E>=t.stops[U-1][0])return t.stops[U-1][1];U=Kb(t.stops.map(Sa=>Sa[0]),E);const ea=Rj(E,N,t.stops[U][0],t.stops[U+1][0]),ia=t.stops[U][1],va=t.stops[U+1][1],Ga=zd[A.type]||tk;return"function"===typeof ia.evaluate?{evaluate(...Sa){const ab=ia.evaluate.apply(void 0,Sa);Sa=va.evaluate.apply(void 0,Sa);if(void 0!==ab&&void 0!==Sa)return Ga(ab,Sa,ea,t.colorSpace)}}:
Ga(ia,va,ea,t.colorSpace)}function Fl(t,A,E){switch(A.type){case "color":E=Ad.parse(E);break;case "formatted":E=tf.fromString(E.toString());break;case "resolvedImage":E=Pe.fromString(E.toString());break;case "padding":E=Ce.parse(E);break;default:Id(E)===A.type||"enum"===A.type&&A.values[E]||(E=void 0)}return Dg(E,t.default,A.default)}function Rj(t,A,E,N){N-=E;t-=E;return 0===N?0:1===A?t/N:(Math.pow(A,t)-1)/(Math.pow(A,N)-1)}function Tf(t){return Array.isArray(t)&&0<t.length&&"string"===typeof t[0]&&
t[0]in Qh}function vi(t,A){if(A){var E={color:$f,string:Cb,number:Eb,enum:Cb,boolean:kd,formatted:yd,padding:Md,resolvedImage:dd,variableAnchorOffsetCollection:ed};E="array"===A.type?na(E[A.value]||ld,A.length):E[A.type]}else E=void 0;E=new $e(Qh,mh,[],E);return(t=E.parse(t,void 0,void 0,void 0,A&&"string"===A.type?{typeAnnotation:"coerce"}:void 0))?Gh(new Nd(t,A)):te(E.errors)}function tj(t){return void 0!==t._styleExpression}function Hh(t,A){t=vi(t,A);if("error"===t.result)return t;var E=t.value.expression;
const N=ri(E);if(!N&&!Zh(A))return te([new Ed("","data expressions not supported")]);const U=Cg(E,["zoom"]);if(!U&&!Pj(A))return te([new Ed("","zoom expressions not supported")]);if((E=og(E))||U){if(E instanceof Ed)return te([E]);if(E instanceof lf&&!oh(A))return te([new Ed("",'"interpolate" expressions cannot be used with this property')])}else return te([new Ed("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(!E)return Gh(N?new vf("constant",
t.value):new vf("source",t.value));A=E instanceof lf?E.interpolation:void 0;return Gh(N?new wg("camera",t.value,E.labels,A):new wg("composite",t.value,E.labels,A))}function uk(t,A){if(Xg(t))return new Ni(t,A);if(Tf(t)){t=Hh(t,A);if("error"===t.result)throw Error(t.value.map(N=>`${N.key}: ${N.message}`).join(", "));return t.value}let E=t;"color"===A.type&&"string"===typeof t?E=Ad.parse(t):"padding"!==A.type||"number"!==typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===A.type&&Array.isArray(t)&&
(E=af.parse(t)):E=Ce.parse(t);return{kind:"constant",evaluate:()=>E}}function og(t){let A=null;if(t instanceof Pg)A=og(t.result);else if(t instanceof Ii)for(const E of t.args){if(A=og(E))break}else(t instanceof Wc||t instanceof lf)&&t.input instanceof vg&&"zoom"===t.input.name&&(A=t);if(A instanceof Ed)return A;t.eachChild(E=>{E=og(E);E instanceof Ed?A=E:!A&&E?A=new Ed("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):A&&E&&A!==E&&(A=new Ed("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))});
return A}function Uf(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case "has":return 2<=t.length&&"$id"!==t[1]&&"$type"!==t[1];case "in":return 3<=t.length&&("string"!==typeof t[1]||Array.isArray(t[2]));case "!in":case "!has":case "none":return!1;case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3e\x3d":case "\x3c":case "\x3c\x3d":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case "any":case "all":for(const A of t.slice(1))if(!Uf(A)&&"boolean"!==
typeof A)return!1;return!0;default:return!0}}function qd(t,A){return t<A?-1:t>A?1:0}function rb(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let A=1;A<t.length;A++)if(rb(t[A]))return!0;return!1}function Zi(t){if(!t)return!0;const A=t[0];return 1>=t.length?"any"!==A:"\x3d\x3d"===A?Zg(t[1],t[2],"\x3d\x3d"):"!\x3d"===A?rh(Zg(t[1],t[2],"\x3d\x3d")):"\x3c"===A||"\x3e"===A||"\x3c\x3d"===A||"\x3e\x3d"===A?Zg(t[1],t[2],A):"any"===A?["any"].concat(t.slice(1).map(Zi)):
"all"===A?["all"].concat(t.slice(1).map(Zi)):"none"===A?["all"].concat(t.slice(1).map(Zi).map(rh)):"in"===A?Ih(t[1],t.slice(2)):"!in"===A?rh(Ih(t[1],t.slice(2))):"has"===A?wi(t[1]):"!has"===A?rh(wi(t[1])):!0}function Zg(t,A,E){switch(t){case "$type":return[`filter-type-${E}`,A];case "$id":return[`filter-id-${E}`,A];default:return[`filter-${E}`,t,A]}}function Ih(t,A){if(0===A.length)return!1;switch(t){case "$type":return["filter-type-in",["literal",A]];case "$id":return["filter-id-in",["literal",A]];
default:return 200<A.length&&!A.some(E=>typeof E!==typeof A[0])?["filter-in-large",t,["literal",A.sort(qd)]]:["filter-in-small",t,["literal",A]]}}function wi(t){switch(t){case "$type":return!0;case "$id":return["filter-has-id"];default:return["filter-has",t]}}function rh(t){return["!",t]}function yf(t,A={}){if(Uf(t))return t;if(!t)return!0;const E=t[0];if(1>=t.length)return"any"!==E;switch(E){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":const [,N,U]=t;return Jh(N,
U,E,A);case "any":return[,...t]=t,["any",...t.map(Sa=>{var ab={};Sa=yf(Sa,ab);{const Qb=[];for(const ic in ab)Qb.push(["\x3d\x3d",["typeof","$id"===ic?["id"]:["get",ic]],ab[ic]]);ab=0===Qb.length?!0:1===Qb.length?Qb[0]:["all",...Qb]}return!0===ab?Sa:["case",ab,Sa,!1]})];case "all":return[,...t]=t,t=t.map(Sa=>yf(Sa,A)),1<t.length?["all",...t]:t[0];case "none":return[,...t]=t,["!",yf(["any",...t],{})];case "in":const [,ea,...ia]=t;return uj(ea,ia);case "!in":const [,va,...Ga]=t;return uj(va,Ga,!0);
case "has":return Yg(t[1]);case "!has":return["!",Yg(t[1])];default:return!0}}function Jh(t,A,E,N){let U;if("$type"===t)return[E,["geometry-type"],A];U="$id"===t?["id"]:["get",t];N&&null!==A&&(N[t]=typeof A);return"\x3d\x3d"===E&&"$id"!==t&&null===A?["all",["has",t],["\x3d\x3d",U,null]]:"!\x3d"===E&&"$id"!==t&&null===A?["any",["!",["has",t]],["!\x3d",U,null]]:[E,U,A]}function uj(t,A,E=!1){if(0===A.length)return E;let N;N="$type"===t?["geometry-type"]:"$id"===t?["id"]:["get",t];t=!0;const U=typeof A[0];
for(var ea of A)if(typeof ea!==U){t=!1;break}return!t||"string"!==U&&"number"!==U?E?["all",...A.map(ia=>["!\x3d",N,ia])]:["any",...A.map(ia=>["\x3d\x3d",N,ia])]:(ea=A.sort().filter((ia,va)=>0===va||A[va-1]!==ia),["match",N,ea,!E,E])}function Yg(t){return"$type"===t?!0:"$id"===t?["!\x3d",["id"],null]:["has",t]}function Ud(t){return"object"===typeof t?["literal",t]:t}function xi(t,A){let E=t.stops;if(!E)return Eg(t,A);const N=E&&"object"===typeof E[0][0],U=N||void 0!==t.property,ea=N||!U;E=E.map(ia=>
!U&&A.tokens&&"string"===typeof ia[1]?[ia[0],zi(ia[1])]:[ia[0],Ud(ia[1])]);return N?qk(t,A,E):ea?Fg(t,A,E):vd(t,A,E)}function Eg(t,A){const E=["get",t.property];if(void 0===t.default)return"string"===A.type?["string",E]:E;if("enum"===A.type)return["match",E,Object.keys(A.values),E,t.default];t=["color"===A.type?"to-color":A.type,E,Ud(t.default)];"array"===A.type&&t.splice(1,0,A.value,A.length||null);return t}function $h(t){switch(t.colorSpace){case "hcl":return"interpolate-hcl";case "lab":return"interpolate-lab";
default:return"interpolate"}}function qk(t,A,E){const N={},U={};var ea=[];for(let Ga=0;Ga<E.length;Ga++){const Sa=E[Ga],ab=Sa[0].zoom;void 0===N[ab]&&(N[ab]={zoom:ab,type:t.type,property:t.property,default:t.default},U[ab]=[],ea.push(ab));U[ab].push([Sa[0].value,Sa[1]])}if("exponential"===pg({},A)){var ia=[$h(t),["linear"],["zoom"]];for(var va of ea)ea=vd(N[va],A,U[va]),Vf(ia,va,ea,!1);return ia}va=["step",["zoom"]];for(ia of ea)ea=vd(N[ia],A,U[ia]),Vf(va,ia,ea,!0);xk(va);return va}function sh(t,
A){t=t.default;var E=A.default;t=Ud(void 0!==t?t:void 0!==E?E:void 0);return void 0===t&&"resolvedImage"===A.type?"":t}function vd(t,A,E){const N=pg(t,A);var U=["get",t.property];if("categorical"===N&&"boolean"===typeof E[0][0]){var ea=["case"];for(const ia of E)ea.push(["\x3d\x3d",U,ia[0]],ia[1]);ea.push(sh(t,A));return ea}if("categorical"===N){U=["match",U];for(const ia of E)Vf(U,ia[0],ia[1],!1);U.push(sh(t,A));return U}if("interval"===N){A=["step",["number",U]];for(const ia of E)Vf(A,ia[0],ia[1],
!0);xk(A);return void 0===t.default?A:["case",["\x3d\x3d",["typeof",U],"number"],A,Ud(t.default)]}if("exponential"===N){A=void 0!==t.base?t.base:1;A=[$h(t),1===A?["linear"]:["exponential",A],["number",U]];for(ea of E)Vf(A,ea[0],ea[1],!1);return void 0===t.default?A:["case",["\x3d\x3d",["typeof",U],"number"],A,Ud(t.default)]}throw Error(`Unknown property function type ${N}`);}function Fg(t,A,E,N=["zoom"]){var U=pg(t,A);A=!1;if("interval"===U)t=["step",N],A=!0;else if("exponential"===U)U=void 0!==t.base?
t.base:1,t=[$h(t),1===U?["linear"]:["exponential",U],N];else throw Error(`Unknown zoom function type "${U}"`);for(const ea of E)Vf(t,ea[0],ea[1],A);xk(t);return t}function xk(t){"step"===t[0]&&3===t.length&&(t.push(0),t.push(t[3]))}function Vf(t,A,E,N){3<t.length&&A===t[t.length-2]||(N&&2===t.length||t.push(A),t.push(E))}function pg(t,A){return t.type?t.type:A.expression.interpolated?"exponential":"interval"}function zi(t){const A=["concat"],E=/{([^{}]+)}/g;let N=0;for(let U=E.exec(t);null!==U;U=
E.exec(t)){const ea=t.slice(N,E.lastIndex-U[0].length);N=E.lastIndex;0<ea.length&&A.push(ea);A.push(["get",U[1]])}if(1===A.length)return t;if(N<t.length)A.push(t.slice(N));else if(2===A.length)return["to-string",A[1]];return A}function qf(t){for(var A=0;A<ue.layout.length;A++)for(const E in ue[ue.layout[A]])if(E===t)return ue[ue.layout[A]][E];for(A=0;A<ue.paint.length;A++)for(const E in ue[ue.paint[A]])if(E===t)return ue[ue.paint[A]][E];return null}function Ai(t,A){for(const E in t.sources)A(t.sources[E])}
function Gg(t,A){for(const E of t.layers)A(E)}function Ff(t,A,E){function N(U,ea){const ia=U[ea];ia&&Object.keys(ia).forEach(va=>{E({path:[U.id,ea,va],key:va,value:ia[va],reference:qf(va),set(Ga){ia[va]=Ga}})})}Gg(t,U=>{A.paint&&N(U,"paint");A.layout&&N(U,"layout")})}function qg(t){var A=typeof t;if("number"===A||"boolean"===A||"string"===A||void 0===t||null===t)return JSON.stringify(t);if(Array.isArray(t)){A="[";for(var E of t)A+=`${qg(E)},`;return`${A}]`}E=Object.keys(t).sort();A="{";for(let N=
0;N<E.length;N++)A+=`${JSON.stringify(E[N])}:${qg(t[E[N]])},`;return`${A}}`}function kg(t){const A=t.key;return(t=t.value)?[new hc(A,t,"constants have been deprecated as of v8")]:[]}function Td(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Mf(t){if(Array.isArray(t))return t.map(Mf);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const A={};for(const E in t)A[E]=Mf(t[E]);return A}return Td(t)}function Ee(t){const A=
t.key,E=t.value,N=t.valueSpec||{},U=t.objectElementValidators||{},ea=t.style,ia=t.styleSpec;t=t.validateSpec;let va=[];var Ga=Id(E);if("object"!==Ga)return[new hc(A,E,`object expected, ${Ga} found`)];for(const ab in E){var Sa=ab.split(".")[0];Ga=N[Sa]||N["*"];if(U[Sa])Sa=U[Sa];else if(N[Sa])Sa=t;else if(U["*"])Sa=U["*"];else if(N["*"])Sa=t;else{va.push(new hc(A,E[ab],`unknown property "${ab}"`));continue}va=va.concat(Sa({key:(A?`${A}.`:A)+ab,value:E[ab],valueSpec:Ga,style:ea,styleSpec:ia,object:E,
objectKey:ab,validateSpec:t},E))}for(const ab in N)U[ab]||N[ab].required&&void 0===N[ab]["default"]&&void 0===E[ab]&&va.push(new hc(A,E,`missing required property "${ab}"`));return va}function zf(t){const A=t.value;var E=t.valueSpec,N=t.validateSpec;const U=t.style,ea=t.styleSpec,ia=t.key;N=t.arrayElementValidator||N;if("array"!==Id(A))return[new hc(ia,A,`array expected, ${Id(A)} found`)];if(E.length&&A.length!==E.length)return[new hc(ia,A,`array length ${E.length} expected, length ${A.length} found`)];
if(E["min-length"]&&A.length<E["min-length"])return[new hc(ia,A,`array length at least ${E["min-length"]} expected, length ${A.length} found`)];let va={type:E.value,values:E.values};7>ea.$version&&(va["function"]=E.function);"object"===Id(E.value)&&(va=E.value);E=[];for(let Ga=0;Ga<A.length;Ga++)E=E.concat(N({array:A,arrayIndex:Ga,value:A[Ga],valueSpec:va,validateSpec:t.validateSpec,style:U,styleSpec:ea,key:`${ia}[${Ga}]`}));return E}function $c(t){const A=t.key,E=t.value;t=t.valueSpec;let N=Id(E);
"number"===N&&E!==E&&(N="NaN");return"number"!==N?[new hc(A,E,`number expected, ${N} found`)]:"minimum"in t&&E<t.minimum?[new hc(A,E,`${E} is less than the minimum value ${t.minimum}`)]:"maximum"in t&&E>t.maximum?[new hc(A,E,`${E} is greater than the maximum value ${t.maximum}`)]:[]}function Zd(t){function A(Vb){let Sc=[];const mc=Vb.value,xd=Vb.key;if("array"!==Id(mc))return[new hc(xd,mc,`array expected, ${Id(mc)} found`)];if(2!==mc.length)return[new hc(xd,mc,`array length 2 expected, length ${mc.length} found`)];
if(Qb){if("object"!==Id(mc[0]))return[new hc(xd,mc,`object expected, ${Id(mc[0])} found`)];if(void 0===mc[0].zoom)return[new hc(xd,mc,"object stop key must have zoom")];if(void 0===mc[0].value)return[new hc(xd,mc,"object stop key must have value")];if(Ga&&Ga>Td(mc[0].zoom))return[new hc(xd,mc[0].zoom,"stop zoom values must appear in ascending order")];Td(mc[0].zoom)!==Ga&&(Ga=Td(mc[0].zoom),va=void 0,ia={});Sc=Sc.concat(Ee({key:`${xd}[0]`,value:mc[0],valueSpec:{zoom:{}},validateSpec:Vb.validateSpec,
style:Vb.style,styleSpec:Vb.styleSpec,objectElementValidators:{zoom:$c,value:E}}))}else Sc=Sc.concat(E({key:`${xd}[0]`,value:mc[0],valueSpec:{},validateSpec:Vb.validateSpec,style:Vb.style,styleSpec:Vb.styleSpec},mc));return Tf(Mf(mc[1]))?Sc.concat([new hc(`${xd}[1]`,mc[1],"expressions are not allowed in function stops.")]):Sc.concat(Vb.validateSpec({key:`${xd}[1]`,value:mc[1],valueSpec:N,validateSpec:Vb.validateSpec,style:Vb.style,styleSpec:Vb.styleSpec}))}function E(Vb,Sc){var mc=Id(Vb.value);const xd=
Td(Vb.value);Sc=null!==Vb.value?Vb.value:Sc;if(!ea)ea=mc;else if(mc!==ea)return[new hc(Vb.key,Sc,`${mc} stop domain type must match previous stop domain type ${ea}`)];if("number"!==mc&&"string"!==mc&&"boolean"!==mc)return[new hc(Vb.key,Sc,"stop domain value must be a number, string, or boolean")];if("number"!==mc&&"categorical"!==U)return mc=`number expected, ${mc} found`,Zh(N)&&void 0===U&&(mc+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hc(Vb.key,Sc,
mc)];if("categorical"===U&&"number"===mc&&(!isFinite(xd)||Math.floor(xd)!==xd))return[new hc(Vb.key,Sc,`integer expected, found ${xd}`)];if("categorical"!==U&&"number"===mc&&void 0!==va&&xd<va)return[new hc(Vb.key,Sc,"stop domain values must appear in ascending order")];va=xd;if("categorical"===U&&xd in ia)return[new hc(Vb.key,Sc,"stop domain values must be unique")];ia[xd]=!0;return[]}const N=t.valueSpec,U=Td(t.value.type);let ea,ia={},va,Ga;const Sa="categorical"!==U&&void 0===t.value.property,
ab=!Sa,Qb="array"===Id(t.value.stops)&&"array"===Id(t.value.stops[0])&&"object"===Id(t.value.stops[0][0]),ic=Ee({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(Vb){if("identity"===U)return[new hc(Vb.key,Vb.value,'identity function may not have a "stops" property')];let Sc=[];const mc=Vb.value;Sc=Sc.concat(zf({key:Vb.key,value:mc,valueSpec:Vb.valueSpec,validateSpec:Vb.validateSpec,style:Vb.style,
styleSpec:Vb.styleSpec,arrayElementValidator:A}));"array"===Id(mc)&&0===mc.length&&Sc.push(new hc(Vb.key,mc,"array must have at least one stop"));return Sc},default:function(Vb){return Vb.validateSpec({key:Vb.key,value:Vb.value,valueSpec:N,validateSpec:Vb.validateSpec,style:Vb.style,styleSpec:Vb.styleSpec})}}});"identity"===U&&Sa&&ic.push(new hc(t.key,t.value,'missing required property "property"'));"identity"===U||t.value.stops||ic.push(new hc(t.key,t.value,'missing required property "stops"'));
"exponential"===U&&t.valueSpec.expression&&!oh(t.valueSpec)&&ic.push(new hc(t.key,t.value,"exponential functions not supported"));8<=t.styleSpec.$version&&(ab&&!Zh(t.valueSpec)?ic.push(new hc(t.key,t.value,"property functions not supported")):Sa&&!Pj(t.valueSpec)&&ic.push(new hc(t.key,t.value,"zoom functions not supported")));"categorical"!==U&&!Qb||void 0!==t.value.property||ic.push(new hc(t.key,t.value,'"property" property is required'));return ic}function Wf(t){var A=("property"===t.expressionContext?
Hh:vi)(Mf(t.value),t.valueSpec);if("error"===A.result)return A.value.map(E=>new hc(`${t.key}${E.key}`,t.value,E.message));A=A.value.expression||A.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!A.outputDefined())return[new hc(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Bg(A))return[new hc(t.key,
t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Bg(A))return[new hc(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Cg(A,["zoom","feature-state"]))return[new hc(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!ri(A))return[new hc(t.key,
t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vd(t){const A=t.key,E=t.value;t=t.valueSpec;const N=[];Array.isArray(t.values)?-1===t.values.indexOf(Td(E))&&N.push(new hc(A,E,`expected one of [${t.values.join(", ")}], ${JSON.stringify(E)} found`)):-1===Object.keys(t.values).indexOf(Td(E))&&N.push(new hc(A,E,`expected one of [${Object.keys(t.values).join(", ")}], ${JSON.stringify(E)} found`));return N}function jf(t){return Uf(Mf(t.value))?
Wf(Sb({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):bi(t)}function bi(t){const A=t.value,E=t.key;if("array"!==Id(A))return[new hc(E,A,`array expected, ${Id(A)} found`)];var N=t.styleSpec;let U,ea=[];if(1>A.length)return[new hc(E,A,"filter array must have at least 1 element")];ea=ea.concat(Vd({key:`${E}[0]`,value:A[0],valueSpec:N.filter_operator,style:t.style,styleSpec:t.styleSpec}));switch(Td(A[0])){case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":2<=A.length&&"$type"===Td(A[1])&&
ea.push(new hc(E,A,`"$type" cannot be use with operator "${A[0]}"`));case "\x3d\x3d":case "!\x3d":3!==A.length&&ea.push(new hc(E,A,`filter array for operator "${A[0]}" must have 3 elements`));case "in":case "!in":2<=A.length&&(U=Id(A[1]),"string"!==U&&ea.push(new hc(`${E}[1]`,A[1],`string expected, ${U} found`)));for(let ia=2;ia<A.length;ia++)U=Id(A[ia]),"$type"===Td(A[1])?ea=ea.concat(Vd({key:`${E}[${ia}]`,value:A[ia],valueSpec:N.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==U&&
"number"!==U&&"boolean"!==U&&ea.push(new hc(`${E}[${ia}]`,A[ia],`string, number, or boolean expected, ${U} found`));break;case "any":case "all":case "none":for(N=1;N<A.length;N++)ea=ea.concat(bi({key:`${E}[${N}]`,value:A[N],style:t.style,styleSpec:t.styleSpec}));break;case "has":case "!has":U=Id(A[1]),2!==A.length?ea.push(new hc(E,A,`filter array for "${A[0]}" operator must have 2 elements`)):"string"!==U&&ea.push(new hc(`${E}[1]`,A[1],`string expected, ${U} found`))}return ea}function Xj(t,A){const E=
t.key,N=t.validateSpec,U=t.style,ea=t.styleSpec,ia=t.value,va=t.objectKey;var Ga=ea[`${A}_${t.layerType}`];if(!Ga)return[];const Sa=va.match(/^(.*)-transition$/);if("paint"===A&&Sa&&Ga[Sa[1]]&&Ga[Sa[1]].transition)return N({key:E,value:ia,valueSpec:ea.transition,style:U,styleSpec:ea});Ga=t.valueSpec||Ga[va];if(!Ga)return[new hc(E,ia,`unknown property "${va}"`)];var ab;if("string"===Id(ia)&&Zh(Ga)&&!Ga.tokens&&(ab=/^{([^}]+)}$/.exec(ia)))return[new hc(E,ia,`"${va}" does not support interpolation syntax\n`+
`Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ab[1])} }\`.`)];ab=[];"symbol"===t.layerType&&("text-field"===va&&U&&!U.glyphs&&ab.push(new hc(E,ia,'use of "text-field" requires a style "glyphs" property')),"text-font"===va&&Xg(Mf(ia))&&"identity"===Td(ia.type)&&ab.push(new hc(E,ia,'"text-font" does not support identity functions')));return ab.concat(N({key:t.key,value:ia,valueSpec:Ga,style:U,styleSpec:ea,expressionContext:"property",propertyType:A,
propertyKey:va}))}function ci(t){return Xj(t,"paint")}function di(t){return Xj(t,"layout")}function vj(t){let A=[];const E=t.value,N=t.key;var U=t.style;const ea=t.styleSpec;E.type||E.ref||A.push(new hc(N,E,'either "type" or "ref" is required'));let ia=Td(E.type);const va=Td(E.ref);if(E.id){var Ga=Td(E.id);for(let Sa=0;Sa<t.arrayIndex;Sa++){const ab=U.layers[Sa];Td(ab.id)===Ga&&A.push(new hc(N,E.id,`duplicate layer id "${E.id}", previously used at line ${ab.id.__line__}`))}}if("ref"in E){["type",
"source","source-layer","filter","layout"].forEach(ab=>{ab in E&&A.push(new hc(N,E[ab],`"${ab}" is prohibited for ref layers`))});let Sa;U.layers.forEach(ab=>{Td(ab.id)===va&&(Sa=ab)});Sa?Sa.ref?A.push(new hc(N,E.ref,"ref cannot reference another ref layer")):ia=Td(Sa.type):A.push(new hc(N,E.ref,`ref layer "${va}" not found`))}else"background"!==ia&&(E.source?(Ga=(U=U.sources&&U.sources[E.source])&&Td(U.type),U?"vector"===Ga&&"raster"===ia?A.push(new hc(N,E.source,`layer "${E.id}" requires a raster source`)):
"raster-dem"!==Ga&&"hillshade"===ia?A.push(new hc(N,E.source,`layer "${E.id}" requires a raster-dem source`)):"raster"===Ga&&"raster"!==ia?A.push(new hc(N,E.source,`layer "${E.id}" requires a vector source`)):"vector"!==Ga||E["source-layer"]?"raster-dem"===Ga&&"hillshade"!==ia?A.push(new hc(N,E.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==ia||!E.paint||!E.paint["line-gradient"]||"geojson"===Ga&&U.lineMetrics||A.push(new hc(N,E,`layer "${E.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):
A.push(new hc(N,E,`layer "${E.id}" must specify a "source-layer"`)):A.push(new hc(N,E.source,`source "${E.source}" not found`))):A.push(new hc(N,E,'missing required property "source"')));return A=A.concat(Ee({key:N,value:E,valueSpec:ea.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{["*"](){return[]},type(){return t.validateSpec({key:`${N}.type`,value:E.type,valueSpec:ea.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:E,
objectKey:"type"})},filter:jf,layout(Sa){return Ee({layer:E,key:Sa.key,value:Sa.value,style:Sa.style,styleSpec:Sa.styleSpec,validateSpec:Sa.validateSpec,objectElementValidators:{["*"](ab){return di(Sb({layerType:ia},ab))}}})},paint(Sa){return Ee({layer:E,key:Sa.key,value:Sa.value,style:Sa.style,styleSpec:Sa.styleSpec,validateSpec:Sa.validateSpec,objectElementValidators:{["*"](ab){return ci(Sb({layerType:ia},ab))}}})}}}))}function Od(t){const A=t.value;t=t.key;const E=Id(A);return"string"!==E?[new hc(t,
A,`string expected, ${E} found`)]:[]}function Nf(t){var A=t.value,E=t.key,N=t.styleSpec,U=t.style,ea=t.validateSpec;if(!A.type)return[new hc(E,A,'"type" is required')];var ia=Td(A.type),va;switch(ia){case "vector":case "raster":return va=Ee({key:E,value:A,valueSpec:N[`source_${ia.replace("-","_")}`],style:t.style,styleSpec:N,objectElementValidators:ii,validateSpec:ea});case "raster-dem":A={sourceName:E,value:A,style:t.style,styleSpec:N,validateSpec:ea};var Ga;E=null!==(Ga=A.sourceName)&&void 0!==
Ga?Ga:"";ea=A.value;Ga=A.styleSpec;var Sa=Ga.source_raster_dem;t=A.style;N=[];U=Id(ea);if(void 0!==ea)if("object"!==U)N.push(new hc("source_raster_dem",ea,`object expected, ${U} found`));else{U="custom"===Td(ea.encoding);ia=["redFactor","greenFactor","blueFactor","baseShift"];var ab=A.value.encoding?`"${A.value.encoding}"`:"Default";for(va in ea)!U&&ia.includes(va)?N.push(new hc(va,ea[va],`In "${E}": "${va}" is only valid when "encoding" is set to "custom". ${ab} encoding found`)):Sa[va]?N=N.concat(A.validateSpec({key:va,
value:ea[va],valueSpec:Sa[va],validateSpec:A.validateSpec,style:t,styleSpec:Ga})):N.push(new hc(va,ea[va],`unknown property "${va}"`))}va=N;return va;case "geojson":va=Ee({key:E,value:A,valueSpec:N.source_geojson,style:U,styleSpec:N,validateSpec:ea,objectElementValidators:ii});if(A.cluster)for(Sa in A.clusterProperties){const [Qb,ic]=A.clusterProperties[Sa];Ga="string"===typeof Qb?[Qb,["accumulated"],["get",Sa]]:Qb;va.push(...Wf({key:`${E}.${Sa}.map`,value:ic,validateSpec:ea,expressionContext:"cluster-map"}));
va.push(...Wf({key:`${E}.${Sa}.reduce`,value:Ga,validateSpec:ea,expressionContext:"cluster-reduce"}))}return va;case "video":return Ee({key:E,value:A,valueSpec:N.source_video,style:U,validateSpec:ea,styleSpec:N});case "image":return Ee({key:E,value:A,valueSpec:N.source_image,style:U,validateSpec:ea,styleSpec:N});case "canvas":return[new hc(E,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vd({key:`${E}.type`,value:A.type,
valueSpec:{values:"vector raster raster-dem geojson video image".split(" ")},style:U,validateSpec:ea,styleSpec:N})}}function Ue(t){const A=t.value,E=t.styleSpec,N=E.light,U=t.style;let ea=[];var ia=Id(A);if(void 0===A)return ea;if("object"!==ia)return ea=ea.concat([new hc("light",A,`object expected, ${ia} found`)]);for(const va in A)ea=(ia=va.match(/^(.*)-transition$/))&&N[ia[1]]&&N[ia[1]].transition?ea.concat(t.validateSpec({key:va,value:A[va],valueSpec:E.transition,validateSpec:t.validateSpec,style:U,
styleSpec:E})):N[va]?ea.concat(t.validateSpec({key:va,value:A[va],valueSpec:N[va],validateSpec:t.validateSpec,style:U,styleSpec:E})):ea.concat([new hc(va,A[va],`unknown property "${va}"`)]);return ea}function th(t){const A=t.value,E=t.styleSpec,N=E.sky,U=t.style;var ea=Id(A);if(void 0===A)return[];if("object"!==ea)return[new hc("sky",A,`object expected, ${ea} found`)];ea=[];for(const ia in A)ea=N[ia]?ea.concat(t.validateSpec({key:ia,value:A[ia],valueSpec:N[ia],style:U,styleSpec:E})):ea.concat([new hc(ia,
A[ia],`unknown property "${ia}"`)]);return ea}function Di(t){const A=t.value,E=t.styleSpec,N=E.terrain,U=t.style;let ea=[];const ia=Id(A);if(void 0===A)return ea;if("object"!==ia)return ea=ea.concat([new hc("terrain",A,`object expected, ${ia} found`)]);for(const va in A)ea=N[va]?ea.concat(t.validateSpec({key:va,value:A[va],valueSpec:N[va],validateSpec:t.validateSpec,style:U,styleSpec:E})):ea.concat([new hc(va,A[va],`unknown property "${va}"`)]);return ea}function cj(t){let A=[];const E=t.value,N=
t.key;if(Array.isArray(E)){const U=[],ea=[];for(const ia in E)E[ia].id&&U.includes(E[ia].id)&&A.push(new hc(N,E,`all the sprites' ids must be unique, but ${E[ia].id} is duplicated`)),U.push(E[ia].id),E[ia].url&&ea.includes(E[ia].url)&&A.push(new hc(N,E,`all the sprites' URLs must be unique, but ${E[ia].url} is duplicated`)),ea.push(E[ia].url),A=A.concat(Ee({key:`${N}[${ia}]`,value:E[ia],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return A}return Od({key:N,
value:E})}function Af(t){const A=t.value,E=t.valueSpec,N=t.styleSpec;t.validateSpec=Af;return E.expression&&Xg(Td(A))?Zd(t):E.expression&&Tf(Mf(A))?Wf(t):E.type&&Sh[E.type]?Sh[E.type](t):Ee(Sb({},t,{valueSpec:E.type?N[E.type]:E}))}function Ei(t){const A=t.value,E=t.key;t=Od(t);if(t.length)return t;-1===A.indexOf("{fontstack}")&&t.push(new hc(E,A,'"glyphs" url must include a "{fontstack}" token'));-1===A.indexOf("{range}")&&t.push(new hc(E,A,'"glyphs" url must include a "{range}" token'));return t}
function Gf(t,A=ue){let E=[];E=E.concat(Af({key:"",value:t,valueSpec:A.$root,styleSpec:A,style:t,validateSpec:Af,objectElementValidators:{glyphs:Ei,["*"](){return[]}}}));t.constants&&(E=E.concat(kg({key:"constants",value:t.constants,style:t,styleSpec:A,validateSpec:Af})));return wj(E)}function Xf(t){return function(A){return t({...A,validateSpec:Af})}}function wj(t){return[].concat(t).sort((A,E)=>A.line-E.line)}function Yf(t){return function(...A){return wj(t.apply(this,A))}}function Ge(t,A={}){const E=
JSON.stringify([1],void 0,void 0===A.indent?2:A.indent).slice(2,-3),N=""===E?Infinity:void 0===A.maxLength?80:A.maxLength;let {replacer:U}=A;return function Sa(ia,va,Ga){ia&&"function"===typeof ia.toJSON&&(ia=ia.toJSON());const ab=JSON.stringify(ia,U);if(void 0===ab)return ab;Ga=N-va.length-Ga;if(ab.length<=Ga){var Qb=ab.replace(ak,(Sc,mc)=>mc||`${Sc} `);if(Qb.length<=Ga)return Qb}null!=U&&(ia=JSON.parse(ab),U=void 0);if("object"===typeof ia&&null!==ia){Ga=va+E;Qb=[];let Sc=0,mc,xd;if(Array.isArray(ia)){mc=
"[";xd="]";for(var {length:ic}=ia;Sc<ic;Sc++)Qb.push(Sa(ia[Sc],Ga,Sc===ic-1?0:1)||"null")}else{mc="{";xd="}";ic=Object.keys(ia);const {length:Sg}=ic;for(;Sc<Sg;Sc++){var Vb=ic[Sc];const If=`${JSON.stringify(Vb)}: `;Vb=Sa(ia[Vb],Ga,If.length+(Sc===Sg-1?0:1));void 0!==Vb&&Qb.push(If+Vb)}}if(0<Qb.length)return[mc,E+Qb.join(`,\n${Ga}`),xd].join(`\n${va}`)}return ab}(t,"",0)}function Bf(t,A){const E={};for(const N in A)void 0!==t[N]&&(E[N]=t[N]);for(const N in t)void 0===E[N]&&(E[N]=t[N]);return E}function Ne(t,
A){for(const E in t)0===E.indexOf("layout")&&A(t[E],E)}function Ig(t,A){for(const E in t)0===E.indexOf("paint")&&A(t[E],E)}function Jg(t,A){return"string"===typeof A&&"@"===A[0]?Jg(t,t.constants[A]):A}function bh(t,A,E){t[E]=t[A];delete t[A]}function jl(t){function A(N){function U(ea){return ea.split(",").map(ia=>ia.trim())}if(Array.isArray(N))return N;if("string"===typeof N)return U(N);if("object"===typeof N)return N.stops.forEach(ea=>{ea[1]=U(ea[1])}),N;throw Error("unexpected font value");}t.version=
8;Ai(t,N=>{"video"===N.type&&void 0!==N.url&&bh(N,"url","urls");"video"===N.type&&N.coordinates.forEach(U=>U.reverse())});Gg(t,N=>{Ne(N,U=>{void 0!==U["symbol-min-distance"]&&bh(U,"symbol-min-distance","symbol-spacing")});Ig(N,U=>{void 0!==U["background-image"]&&bh(U,"background-image","background-pattern");void 0!==U["line-image"]&&bh(U,"line-image","line-pattern");void 0!==U["fill-image"]&&bh(U,"fill-image","fill-pattern")})});Ff(t,{paint:!0,layout:!0},N=>{const U=Jg(t,N.value);Array.isArray(U.stops)&&
U.stops.forEach(ea=>{ea[1]=Jg(t,ea[1])});N.set(U)});delete t.constants;Gg(t,N=>{Ne(N,U=>{delete U["text-max-size"];delete U["icon-max-size"]});Ig(N,U=>{U["text-size"]&&(N.layout||(N.layout={}),N.layout["text-size"]=U["text-size"],delete U["text-size"]);U["icon-size"]&&(N.layout||(N.layout={}),N.layout["icon-size"]=U["icon-size"],delete U["icon-size"])})});Gg(t,N=>{Ne(N,U=>{U["text-font"]&&(U["text-font"]=A(U["text-font"]))})});var E=0;for(let N=t.layers.length-1;0<=N;N--)if("symbol"!==t.layers[N].type){E=
N+1;break}E=t.layers.splice(E);E.reverse();t.layers=t.layers.concat(E);return t}function Lb(t){const A=[];Gg(t,E=>{E.filter&&(E.filter=yf(E.filter))});Ff(t,{paint:!0,layout:!0},({path:E,value:N,reference:U,set:ea})=>{Tf(N)||("object"!==typeof N||Array.isArray(N)?U.tokens&&"string"===typeof N&&ea(zi(N)):(ea(xi(N,U)),A.push(E.join("."))))});return t}function nd(t){return t.replace(/"hsla?\((.+?)\)"/gi,(A,E)=>{if(E=E.match(/^(.+?)\s*,\s*(.+?)\s*,\s*(.+?)(?:\s*,\s*(.+))?$/i)){let [N,U,ea,ia]=E.slice(1);
[U,ea]=[U,ea].map(va=>va.endsWith("%")?va:`${100*parseFloat(va)}%`);return`"hsl${"string"===typeof ia?"a":""}(${[N,U,ea,ia].filter(Boolean).join(",")})"`}return A})}var ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},roll:{type:"number","default":0,units:"degrees"},light:{type:"light"},
sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:"source_vector source_raster source_raster_dem source_geojson source_video source_image".split(" "),source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",
value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean","default":!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,
180,85.051129]},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},attribution:{type:"string"},volatile:{type:"boolean","default":!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},
minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},"default":"mapbox"},redFactor:{type:"number","default":1},blueFactor:{type:"number","default":1},greenFactor:{type:"number","default":1},baseShift:{type:"number","default":0},volatile:{type:"boolean","default":!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},
data:{required:!0,type:"*"},maxzoom:{type:"number","default":18},attribution:{type:"string"},buffer:{type:"number","default":128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number","default":.375},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean","default":!1},generateId:{type:"boolean","default":!1},promoteId:{type:"promoteId"}},
source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},
"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:"layout_fill layout_line layout_circle layout_heatmap layout_fill-extrusion layout_symbol layout_raster layout_hillshade layout_background".split(" "),layout_background:{visibility:{type:"enum",
values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},
"default":"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},"default":"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},
round:{},miter:{}},"default":"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number","default":2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number","default":1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,
parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},"default":"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number","default":250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},
"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean","default":!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},"default":"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean","default":!1,
requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean","default":!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean","default":!1,
requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number","default":1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},
"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},"default":"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",
tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding","default":[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean","default":!1,
requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},
"default":"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},
"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted","default":"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,
parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number","default":16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number","default":10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number","default":1.2,units:"ems",requires:["text-field"],
expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number","default":0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},"default":"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",
"default":0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",
{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number","default":45,units:"degrees",requires:["text-field",
{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},
"text-padding":{type:"number","default":2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean","default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},"default":"none",requires:["text-field"],
expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,"default":[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean","default":!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",
values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean","default":!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean","default":!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},
none:{}},"default":"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"\x3d\x3d":{},"!\x3d":{},"\x3e":{},"\x3e\x3d":{},"\x3c":{},"\x3c\x3d":{},"in":{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",
values:{Point:{},LineString:{},Polygon:{}}},"function":{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number","default":1,minimum:0},property:{type:"string","default":"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},"default":"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},"default":"rgb"},"default":{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],
length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum","default":"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array","default":[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant","default":"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},
transition:!0},intensity:{type:"number","property-type":"data-constant","default":.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant","default":"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant","default":"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",
"default":"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant","default":.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant","default":.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant","default":.8,minimum:0,
maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant","default":.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,"default":1}},projection:{type:{type:"enum","default":"mercator",values:{mercator:{},globe:{}}}},paint:"paint_fill paint_line paint_circle paint_heatmap paint_fill-extrusion paint_symbol paint_raster paint_hillshade paint_background".split(" "),
paint_fill:{"fill-antialias":{type:"boolean","default":!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-translate"],expression:{interpolated:!1,
parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],
expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},
"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number","default":0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number","default":0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,
parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean","default":!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"line-pattern"}],
expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",
"default":1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number","default":0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"line-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},
"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,
parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number","default":0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,
units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},"default":"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},
viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",
"default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number","default":30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number","default":1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},
"property-type":"data-driven"},"heatmap-intensity":{type:"number","default":1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number","default":1,minimum:0,
maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color","default":"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},
"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",
requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},
"property-type":"data-constant"},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color","default":"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",
transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom",
"feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",
"default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number","default":0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number","default":0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",
"default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},
nearest:{}},"default":"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number","default":300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number","default":335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",
values:{map:{},viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number","default":.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color","default":"#FFFFFF",
transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,
expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},
"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Xe="type source source-layer minzoom maxzoom filter layout".split(" ");class hc{constructor(t,A,E,N){this.message=(t?`${t}: `:"")+E;N&&(this.identifier=N);null!==A&&void 0!==A&&A.__line__&&(this.line=A.__line__)}}class kf{constructor(t){this.error=t;this.message=t.message;this.line=(t=t.message.match(/line (\d+)/))?parseInt(t[1],10):0}}class Ed extends Error{constructor(t,
A){super(A);this.message=A;this.key=t}}class sg{constructor(t,A=[]){this.parent=t;this.bindings={};for(const [E,N]of A)this.bindings[E]=N}concat(t){return new sg(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw Error(`${t} not found in scope.`);}has(t){return this.bindings[t]?!0:this.parent?this.parent.has(t):!1}}const He={kind:"null"},Eb={kind:"number"},Cb={kind:"string"},kd={kind:"boolean"},$f={kind:"color"},sf={kind:"object"},ld={kind:"value"},
Ld={kind:"collator"},yd={kind:"formatted"},Md={kind:"padding"},dd={kind:"resolvedImage"},ed={kind:"variableAnchorOffsetCollection"},Jd=[He,Eb,Cb,kd,$f,yd,sf,na(ld),Md,dd,ed],ee=4/29,Ie=6/29,Ze=3*Ie*Ie,Da=Ie*Ie*Ie,Fi=Math.PI/180,tg=180/Math.PI,fe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],
burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,
188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,
128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,
206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,
255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],
red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ad{constructor(t,A,E,N=1,U=!0){this.r=t;this.g=A;this.b=E;this.a=N;U||(this.r*=N,this.g*=N,this.b*=N,N||this.overwriteGetter("rgb",[t,A,E,N]))}static parse(t){if(t instanceof Ad)return t;if("string"===typeof t&&(t=Dc(t)))return new Ad(...t,!1)}get rgb(){const {r:t,g:A,b:E,a:N}=this,U=N||Infinity;return this.overwriteGetter("rgb",[t/U,A/U,E/U,N])}get hcl(){var t=this.overwriteGetter;const [A,E,
N,U]=Fb(this.rgb);var ea=Math.sqrt(E*E+N*N);ea=[Math.round(1E4*ea)?Ib(Math.atan2(N,E)*tg):NaN,ea,A,U];return t.call(this,"hcl",ea)}get lab(){return this.overwriteGetter("lab",Fb(this.rgb))}overwriteGetter(t,A){Object.defineProperty(this,t,{value:A});return A}toString(){const [t,A,E,N]=this.rgb;return`rgba(${[t,A,E].map(U=>Math.round(255*U)).join(",")},${N})`}}Ad.black=new Ad(0,0,0,1);Ad.white=new Ad(1,1,1,1);Ad.transparent=new Ad(0,0,0,0);Ad.red=new Ad(1,0,0,1);class ye{constructor(t,A,E){this.sensitivity=
t?A?"variant":"case":A?"accent":"base";this.locale=E;this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,A){return this.collator.compare(t,A)}resolvedLocale(){return(new Intl.Collator(this.locale?this.locale:[])).resolvedOptions().locale}}class dg{constructor(t,A,E,N,U){this.text=t;this.image=A;this.scale=E;this.fontStack=N;this.textColor=U}}class tf{constructor(t){this.sections=t}static fromString(t){return new tf([new dg(t,null,null,
null,null)])}isEmpty(){return 0===this.sections.length?!0:!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof tf?t:tf.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}}class Ce{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ce)return t;if("number"===typeof t)return new Ce([t,t,t,t]);if(Array.isArray(t)&&!(1>t.length||4<t.length)){for(const A of t)if("number"!==typeof A)return;
switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Ce(t)}}toString(){return JSON.stringify(this.values)}}const Hf=new Set("center left right top bottom top-left top-right bottom-left bottom-right".split(" "));class af{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof af)return t;if(Array.isArray(t)&&!(1>t.length)&&0===t.length%2){for(let A=0;A<t.length;A+=2){const E=t[A],N=t[A+1];if("string"!==typeof E||
!Hf.has(E)||!Array.isArray(N)||2!==N.length||"number"!==typeof N[0]||"number"!==typeof N[1])return}return new af(t)}}toString(){return JSON.stringify(this.values)}}class Pe{constructor(t){this.name=t.name;this.available=t.available}toString(){return this.name}static fromString(t){return t?new Pe({name:t,available:!1}):null}}class ug{constructor(t,A){this.type=t;this.value=A}static parse(t,A){if(2!==t.length)return A.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);
if(!pd(t[1]))return A.error("invalid value");t=t[1];let E=Ic(t);A=A.expectedType;"array"!==E.kind||0!==E.N||!A||"array"!==A.kind||"number"===typeof A.N&&0!==A.N||(E=A);return new ug(E,t)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ge{constructor(t){this.name="ExpressionEvaluationError";this.message=t}toJSON(){return this.message}}const Ng={string:Cb,number:Eb,boolean:kd,object:sf};class Qe{constructor(t,A){this.type=t;this.args=A}static parse(t,A){if(2>t.length)return A.error("Expected at least one argument.");
let E=1;var N=t[0];if("array"===N){if(2<t.length){N=t[1];if("string"!==typeof N||!(N in Ng)||"object"===N)return A.error('The item type argument of "array" must be one of string, number, boolean',1);N=Ng[N];E++}else N=ld;if(3<t.length){if(null!==t[2]&&("number"!==typeof t[2]||0>t[2]||t[2]!==Math.floor(t[2])))return A.error('The length argument to "array" must be a positive integer literal',2);var U=t[2];E++}U=na(N,U)}else{if(!Ng[N])throw Error(`Types doesn't contain name = ${N}`);U=Ng[N]}for(N=[];E<
t.length;E++){const ea=A.parse(t[E],E,ld);if(!ea)return null;N.push(ea)}return new Qe(U,N)}evaluate(t){for(let A=0;A<this.args.length;A++){const E=this.args[A].evaluate(t);if(!tc(this.type,Ic(E)))return E;if(A===this.args.length-1)throw new ge(`Expected value to be of type ${bb(this.type)}, but found ${bb(Ic(E))} instead.`);}throw Error();}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const eh={"to-boolean":kd,"to-color":$f,"to-number":Eb,"to-string":Cb};
class Og{constructor(t,A){this.type=t;this.args=A}static parse(t,A){if(2>t.length)return A.error("Expected at least one argument.");var E=t[0];if(!eh[E])throw Error(`Can't parse ${E} as it is not part of the known types`);if(("to-boolean"===E||"to-string"===E)&&2!==t.length)return A.error("Expected one argument.");E=eh[E];const N=[];for(let U=1;U<t.length;U++){const ea=A.parse(t[U],U,ld);if(!ea)return null;N.push(ea)}return new Og(E,N)}evaluate(t){switch(this.type.kind){case "boolean":return!!this.args[0].evaluate(t);
case "color":for(const ia of this.args){var A=ia.evaluate(t);var E=null;if(A instanceof Ad)return A;if("string"===typeof A){var N=t.parseColor(A);if(N)return N}else if(Array.isArray(A)&&(E=3>A.length||4<A.length?`Invalid rgba value ${JSON.stringify(A)}: expected an array containing either three or four numeric values.`:Nc(A[0],A[1],A[2],A[3]),!E))return new Ad(A[0]/255,A[1]/255,A[2]/255,A[3])}throw new ge(E||`Could not parse color from value '${"string"===typeof A?A:JSON.stringify(A)}'`);case "padding":let U;
for(const ia of this.args)if(U=ia.evaluate(t),N=Ce.parse(U))return N;throw new ge(`Could not parse padding from value '${"string"===typeof U?U:JSON.stringify(U)}'`);case "variableAnchorOffsetCollection":let ea;for(const ia of this.args)if(ea=ia.evaluate(t),N=af.parse(ea))return N;throw new ge(`Could not parse variableAnchorOffsetCollection from value '${"string"===typeof ea?ea:JSON.stringify(ea)}'`);case "number":A=null;for(N of this.args){A=N.evaluate(t);if(null===A)return 0;E=Number(A);if(!isNaN(E))return E}throw new ge(`Could not convert ${JSON.stringify(A)} to number.`);
case "formatted":return tf.fromString(Rc(this.args[0].evaluate(t)));case "resolvedImage":return Pe.fromString(Rc(this.args[0].evaluate(t)));default:return Rc(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const fi=["Unknown","Point","LineString","Polygon"];class yj{constructor(){this.formattedSection=this.featureState=this.feature=this.globals=null;this._parseColorCache={};this.canonical=this.availableImages=null}id(){return this.feature&&
"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"===typeof this.feature.type?fi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let A=this._parseColorCache[t];A||(A=this._parseColorCache[t]=Ad.parse(t));return A}}class $e{constructor(t,A,E=[],N,U=new sg,ea=[]){this.registry=
t;this.path=E;this.key=E.map(ia=>`[${ia}]`).join("");this.scope=U;this.errors=ea;this.expectedType=N;this._isConstant=A}parse(t,A,E,N,U={}){return A?this.concat(A,E,N)._parse(t,U):this._parse(t,U)}_parse(t,A){function E(ea,ia,va){return"assert"===va?new Qe(ia,[ea]):"coerce"===va?new Og(ia,[ea]):ea}if(null===t||"string"===typeof t||"boolean"===typeof t||"number"===typeof t)t=["literal",t];if(Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
var N=t[0];if("string"!==typeof N)return this.error(`Expression name must be a string, but found ${typeof N} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;var U=this.registry[N];if(U){t=U.parse(t,this);if(!t)return null;if(this.expectedType)if(N=this.expectedType,U=t.type,("string"===N.kind||"number"===N.kind||"boolean"===N.kind||"object"===N.kind||"array"===N.kind)&&"value"===U.kind)t=E(t,N,A.typeAnnotation||"assert");else if(!("color"!==N.kind&&"formatted"!==N.kind&&"resolvedImage"!==
N.kind||"value"!==U.kind&&"string"!==U.kind))t=E(t,N,A.typeAnnotation||"coerce");else if("padding"===N.kind&&("value"===U.kind||"number"===U.kind||"array"===U.kind))t=E(t,N,A.typeAnnotation||"coerce");else if("variableAnchorOffsetCollection"===N.kind&&("value"===U.kind||"array"===U.kind))t=E(t,N,A.typeAnnotation||"coerce");else if(this.checkSubtype(N,U))return null;if(!(t instanceof ug)&&"resolvedImage"!==t.type.kind&&this._isConstant(t)){A=new yj;try{t=new ug(t.type,t.evaluate(A))}catch(ea){return this.error(ea.message),
null}}return t}return this.error(`Unknown expression "${N}". If you wanted a literal array, use ["literal", [...]].`,0)}return"undefined"===typeof t?this.error("'undefined' value invalid. Use null instead."):"object"===typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,A,E){t="number"===typeof t?this.path.concat(t):this.path;E=E?this.scope.concat(E):this.scope;return new $e(this.registry,this._isConstant,
t,A||null,E,this.errors)}error(t,...A){A=`${this.key}${A.map(E=>`[${E}]`).join("")}`;this.errors.push(new Ed(A,t))}checkSubtype(t,A){(t=tc(t,A))&&this.error(t);return t}}class Pg{constructor(t,A){this.type=A.type;this.bindings=[].concat(t);this.result=A}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const A of this.bindings)t(A[1]);t(this.result)}static parse(t,A){if(4>t.length)return A.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const E=[];for(let N=1;N<
t.length-1;N+=2){const U=t[N];if("string"!==typeof U)return A.error(`Expected string, but found ${typeof U} instead.`,N);if(/[^a-zA-Z0-9_]/.test(U))return A.error("Variable names must contain only alphanumeric characters or '_'.",N);const ea=A.parse(t[N+1],N+1);if(!ea)return null;E.push([U,ea])}return(t=A.parse(t[t.length-1],t.length-1,A.expectedType,E))?new Pg(E,t):null}outputDefined(){return this.result.outputDefined()}}class Gi{constructor(t,A){this.type=A.type;this.name=t;this.boundExpression=
A}static parse(t,A){if(2!==t.length||"string"!==typeof t[1])return A.error("'var' expression requires exactly one string literal argument.");t=t[1];return A.scope.has(t)?new Gi(t,A.scope.get(t)):A.error(`Unknown variable "${t}". Make sure "${t}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Hi{constructor(t,A,E){this.type=t;this.index=A;this.input=E}static parse(t,A){if(3!==t.length)return A.error(`Expected 2 arguments, but found ${t.length-
1} instead.`);const E=A.parse(t[1],1,Eb);t=A.parse(t[2],2,na(A.expectedType||ld));return E&&t?new Hi(t.type.itemType,E,t):null}evaluate(t){const A=this.index.evaluate(t);t=this.input.evaluate(t);if(0>A)throw new ge(`Array index out of bounds: ${A} < 0.`);if(A>=t.length)throw new ge(`Array index out of bounds: ${A} > ${t.length-1}.`);if(A!==Math.floor(A))throw new ge(`Array index must be an integer, but found ${A} instead.`);return t[A]}eachChild(t){t(this.index);t(this.input)}outputDefined(){return!1}}
class eg{constructor(t,A){this.type=kd;this.needle=t;this.haystack=A}static parse(t,A){if(3!==t.length)return A.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const E=A.parse(t[1],1,ld);t=A.parse(t[2],2,ld);return E&&t?vb(E.type,[kd,Cb,Eb,He,ld])?new eg(E,t):A.error(`Expected first argument to be of type boolean, string, number or null, but found ${bb(E.type)} instead`):null}evaluate(t){const A=this.needle.evaluate(t);t=this.haystack.evaluate(t);if(!t)return!1;if(!Pa(A,["boolean",
"string","number","null"]))throw new ge(`Expected first argument to be of type boolean, string, number or null, but found ${bb(Ic(A))} instead.`);if(!Pa(t,["string","array"]))throw new ge(`Expected second argument to be of type array or string, but found ${bb(Ic(t))} instead.`);return 0<=t.indexOf(A)}eachChild(t){t(this.needle);t(this.haystack)}outputDefined(){return!0}}class gi{constructor(t,A,E){this.type=Eb;this.needle=t;this.haystack=A;this.fromIndex=E}static parse(t,A){if(2>=t.length||5<=t.length)return A.error(`Expected 3 or 4 arguments, but found ${t.length-
1} instead.`);const E=A.parse(t[1],1,ld),N=A.parse(t[2],2,ld);return E&&N?vb(E.type,[kd,Cb,Eb,He,ld])?4===t.length?(t=A.parse(t[3],3,Eb))?new gi(E,N,t):null:new gi(E,N):A.error(`Expected first argument to be of type boolean, string, number or null, but found ${bb(E.type)} instead`):null}evaluate(t){const A=this.needle.evaluate(t),E=this.haystack.evaluate(t);if(!Pa(A,["boolean","string","number","null"]))throw new ge(`Expected first argument to be of type boolean, string, number or null, but found ${bb(Ic(A))} instead.`);
let N;this.fromIndex&&(N=this.fromIndex.evaluate(t));if(Pa(E,["string"]))return t=E.indexOf(A,N),-1===t?-1:[...E.slice(0,t)].length;if(Pa(E,["array"]))return E.indexOf(A,N);throw new ge(`Expected second argument to be of type array or string, but found ${bb(Ic(E))} instead.`);}eachChild(t){t(this.needle);t(this.haystack);this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class hi{constructor(t,A,E,N,U,ea){this.inputType=t;this.type=A;this.input=E;this.cases=N;this.outputs=U;this.otherwise=
ea}static parse(t,A){if(5>t.length)return A.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(1!==t.length%2)return A.error("Expected an even number of arguments.");let E,N;A.expectedType&&"value"!==A.expectedType.kind&&(N=A.expectedType);const U={},ea=[];for(var ia=2;ia<t.length-1;ia+=2){var va=t[ia];const Ga=t[ia+1];Array.isArray(va)||(va=[va]);const Sa=A.concat(ia);if(0===va.length)return Sa.error("Expected at least one branch label.");for(const ab of va){if("number"!==typeof ab&&
"string"!==typeof ab)return Sa.error("Branch labels must be numbers or strings.");if("number"===typeof ab&&Math.abs(ab)>Number.MAX_SAFE_INTEGER)return Sa.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"===typeof ab&&Math.floor(ab)!==ab)return Sa.error("Numeric branch labels must be integer values.");if(!E)E=Ic(ab);else if(Sa.checkSubtype(E,Ic(ab)))return null;if("undefined"!==typeof U[String(ab)])return Sa.error("Branch labels must be unique.");U[String(ab)]=
ea.length}va=A.parse(Ga,ia,N);if(!va)return null;N=N||va.type;ea.push(va)}ia=A.parse(t[1],1,ld);if(!ia)return null;t=A.parse(t[t.length-1],t.length-1,N);return!t||"value"!==ia.type.kind&&A.concat(1).checkSubtype(E,ia.type)?null:new hi(E,N,ia,U,ea,t)}evaluate(t){const A=this.input.evaluate(t);return(Ic(A)===this.inputType&&this.outputs[this.cases[A]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input);this.outputs.forEach(t);t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&
this.otherwise.outputDefined()}}class zj{constructor(t,A,E){this.type=t;this.branches=A;this.otherwise=E}static parse(t,A){if(4>t.length)return A.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(0!==t.length%2)return A.error("Expected an odd number of arguments.");let E;A.expectedType&&"value"!==A.expectedType.kind&&(E=A.expectedType);const N=[];for(let U=1;U<t.length-1;U+=2){const ea=A.parse(t[U],U,kd);if(!ea)return null;const ia=A.parse(t[U+1],U+1,E);if(!ia)return null;N.push([ea,
ia]);E=E||ia.type}t=A.parse(t[t.length-1],t.length-1,E);if(!t)return null;if(!E)throw Error("Can't infer output type");return new zj(E,N,t)}evaluate(t){for(const [A,E]of this.branches)if(A.evaluate(t))return E.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const [A,E]of this.branches)t(A),t(E);t(this.otherwise)}outputDefined(){return this.branches.every(([,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class wh{constructor(t,A,E,N){this.type=t;this.input=A;this.beginIndex=
E;this.endIndex=N}static parse(t,A){if(2>=t.length||5<=t.length)return A.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const E=A.parse(t[1],1,ld),N=A.parse(t[2],2,Eb);return E&&N?vb(E.type,[na(ld),Cb,ld])?4===t.length?(t=A.parse(t[3],3,Eb))?new wh(E.type,E,N,t):null:new wh(E.type,E,N):A.error(`Expected first argument to be of type array or string, but found ${bb(E.type)} instead`):null}evaluate(t){const A=this.input.evaluate(t),E=this.beginIndex.evaluate(t);let N;this.endIndex&&
(N=this.endIndex.evaluate(t));if(Pa(A,["string"]))return[...A].slice(E,N).join("");if(Pa(A,["array"]))return A.slice(E,N);throw new ge(`Expected first argument to be of type array or string, but found ${bb(Ic(A))} instead.`);}eachChild(t){t(this.input);t(this.beginIndex);this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}class Wc{constructor(t,A,E){this.type=t;this.input=A;this.labels=[];this.outputs=[];for(const [N,U]of E)this.labels.push(N),this.outputs.push(U)}static parse(t,A){if(4>t.length-
1)return A.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(0!==(t.length-1)%2)return A.error("Expected an even number of arguments.");const E=A.parse(t[1],1,Eb);if(!E)return null;const N=[];let U=null;A.expectedType&&"value"!==A.expectedType.kind&&(U=A.expectedType);for(let ia=1;ia<t.length;ia+=2){const va=1===ia?-Infinity:t[ia];var ea=t[ia+1];const Ga=ia,Sa=ia+1;if("number"!==typeof va)return A.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',
Ga);if(N.length&&N[N.length-1][0]>=va)return A.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ga);ea=A.parse(ea,Sa,U);if(!ea)return null;U=U||ea.type;N.push([va,ea])}return new Wc(U,E,N)}evaluate(t){var A=this.labels;const E=this.outputs;if(1===A.length)return E[0].evaluate(t);const N=this.input.evaluate(t);if(N<=A[0])return E[0].evaluate(t);const U=A.length;if(N>=A[U-1])return E[U-1].evaluate(t);A=Kb(A,N);return E[A].evaluate(t)}eachChild(t){t(this.input);
for(const A of this.outputs)t(A)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}var xh,Re,fj=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}(function(){function t(A,E,N,U){this.cx=3*A;this.bx=3*(N-A)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*E;this.by=3*(U-E)-this.cy;this.ay=1-this.cy-this.by;this.p1x=A;this.p1y=E;this.p2x=N;this.p2y=U}if(Re)return xh;Re=1;xh=t;t.prototype={sampleCurveX:function(A){return((this.ax*A+this.bx)*
A+this.cx)*A},sampleCurveY:function(A){return((this.ay*A+this.by)*A+this.cy)*A},sampleCurveDerivativeX:function(A){return(3*this.ax*A+2*this.bx)*A+this.cx},solveCurveX:function(A,E){void 0===E&&(E=1E-6);if(0>A)return 0;if(1<A)return 1;for(var N=A,U=0;8>U;U++){var ea=this.sampleCurveX(N)-A;if(Math.abs(ea)<E)return N;var ia=this.sampleCurveDerivativeX(N);if(1E-6>Math.abs(ia))break;N-=ea/ia}ia=0;var va=1;N=A;for(U=0;20>U;U++){ea=this.sampleCurveX(N);if(Math.abs(ea-A)<E)break;A>ea?ia=N:va=N;N=.5*(va-
ia)+ia}return N},solve:function(A,E){return this.sampleCurveY(this.solveCurveX(A,E))}};return xh}());const zd={number:jb,color:sc,array:Ac,padding:Tc,variableAnchorOffsetCollection:od};class lf{constructor(t,A,E,N,U){this.type=t;this.operator=A;this.interpolation=E;this.input=N;this.labels=[];this.outputs=[];for(const [ea,ia]of U)this.labels.push(ea),this.outputs.push(ia)}static interpolationFactor(t,A,E,N){let U=0;"exponential"===t.name?U=Vc(A,t.base,E,N):"linear"===t.name?U=Vc(A,1,E,N):"cubic-bezier"===
t.name&&(t=t.controlPoints,U=(new fj(t[0],t[1],t[2],t[3])).solve(Vc(A,1,E,N)));return U}static parse(t,A){let [E,N,U,...ea]=t;if(!Array.isArray(N)||0===N.length)return A.error("Expected an interpolation type expression.",1);if("linear"===N[0])N={name:"linear"};else if("exponential"===N[0]){var ia=N[1];if("number"!==typeof ia)return A.error("Exponential interpolation requires a numeric base.",1,1);N={name:"exponential",base:ia}}else if("cubic-bezier"===N[0]){ia=N.slice(1);if(4!==ia.length||ia.some(Ga=>
"number"!==typeof Ga||0>Ga||1<Ga))return A.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);N={name:"cubic-bezier",controlPoints:ia}}else return A.error(`Unknown interpolation type ${String(N[0])}`,1,0);if(4>t.length-1)return A.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(0!==(t.length-1)%2)return A.error("Expected an even number of arguments.");U=A.parse(U,2,Eb);if(!U)return null;t=[];ia=null;"interpolate-hcl"===E||"interpolate-lab"===
E?ia=$f:A.expectedType&&"value"!==A.expectedType.kind&&(ia=A.expectedType);for(let Ga=0;Ga<ea.length;Ga+=2){const Sa=ea[Ga];var va=ea[Ga+1];const ab=Ga+3,Qb=Ga+4;if("number"!==typeof Sa)return A.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ab);if(t.length&&t[t.length-1][0]>=Sa)return A.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',
ab);va=A.parse(va,Qb,ia);if(!va)return null;ia=ia||va.type;t.push([Sa,va])}return yb(ia,Eb)||yb(ia,$f)||yb(ia,Md)||yb(ia,ed)||yb(ia,na(Eb))?new lf(ia,E,N,U,t):A.error(`Type ${bb(ia)} is not interpolatable.`)}evaluate(t){var A=this.labels;const E=this.outputs;if(1===A.length)return E[0].evaluate(t);var N=this.input.evaluate(t);if(N<=A[0])return E[0].evaluate(t);var U=A.length;if(N>=A[U-1])return E[U-1].evaluate(t);U=Kb(A,N);A=lf.interpolationFactor(this.interpolation,N,A[U],A[U+1]);N=E[U].evaluate(t);
t=E[U+1].evaluate(t);switch(this.operator){case "interpolate":return zd[this.type.kind](N,t,A);case "interpolate-hcl":return zd.color(N,t,A,"hcl");case "interpolate-lab":return zd.color(N,t,A,"lab")}}eachChild(t){t(this.input);for(const A of this.outputs)t(A)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}class Ii{constructor(t,A){this.type=t;this.args=A}static parse(t,A){if(2>t.length)return A.error("Expected at least one argument.");let E=null;const N=A.expectedType;N&&"value"!==
N.kind&&(E=N);const U=[];for(const ea of t.slice(1)){t=A.parse(ea,1+U.length,E,void 0,{typeAnnotation:"omit"});if(!t)return null;E=E||t.type;U.push(t)}if(!E)throw Error("No output type");return N&&U.some(ea=>tc(N,ea.type))?new Ii(ld,U):new Ii(E,U)}evaluate(t){let A=null,E=0,N;for(const U of this.args)if(E++,(A=U.evaluate(t))&&A instanceof Pe&&!A.available&&(N||(N=A.name),A=null,E===this.args.length&&(A=N)),null!==A)break;return A}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>
t.outputDefined())}}const je=td("\x3d\x3d",function(t,A,E){return A===E},Pc),Zj=td("!\x3d",function(t,A,E){return A!==E},function(t,A,E,N){return!Pc(t,A,E,N)}),gj=td("\x3c",function(t,A,E){return A<E},function(t,A,E,N){return 0>N.compare(A,E)}),Qg=td("\x3e",function(t,A,E){return A>E},function(t,A,E,N){return 0<N.compare(A,E)}),ke=td("\x3c\x3d",function(t,A,E){return A<=E},function(t,A,E,N){return 0>=N.compare(A,E)}),Ji=td("\x3e\x3d",function(t,A,E){return A>=E},function(t,A,E,N){return 0<=N.compare(A,
E)});class Nh{constructor(t,A,E){this.type=Ld;this.locale=E;this.caseSensitive=t;this.diacriticSensitive=A}static parse(t,A){if(2!==t.length)return A.error("Expected one argument.");t=t[1];if("object"!==typeof t||Array.isArray(t))return A.error("Collator options argument must be an object.");const E=A.parse(void 0===t["case-sensitive"]?!1:t["case-sensitive"],1,kd);if(!E)return null;const N=A.parse(void 0===t["diacritic-sensitive"]?!1:t["diacritic-sensitive"],1,kd);if(!N)return null;let U=null;return t.locale&&
(U=A.parse(t.locale,1,Cb),!U)?null:new Nh(E,N,U)}evaluate(t){return new ye(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive);t(this.diacriticSensitive);this.locale&&t(this.locale)}outputDefined(){return!1}}class fh{constructor(t,A,E,N,U){this.type=Cb;this.number=t;this.locale=A;this.currency=E;this.minFractionDigits=N;this.maxFractionDigits=U}static parse(t,A){if(3!==t.length)return A.error("Expected two arguments.");
const E=A.parse(t[1],1,Eb);if(!E)return null;t=t[2];if("object"!==typeof t||Array.isArray(t))return A.error("NumberFormat options argument must be an object.");let N=null;if(t.locale&&(N=A.parse(t.locale,1,Cb),!N))return null;let U=null;if(t.currency&&(U=A.parse(t.currency,1,Cb),!U))return null;let ea=null;if(t["min-fraction-digits"]&&(ea=A.parse(t["min-fraction-digits"],1,Eb),!ea))return null;let ia=null;return t["max-fraction-digits"]&&(ia=A.parse(t["max-fraction-digits"],1,Eb),!ia)?null:new fh(E,
N,U,ea,ia)}evaluate(t){return(new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0})).format(this.number.evaluate(t))}eachChild(t){t(this.number);this.locale&&t(this.locale);this.currency&&t(this.currency);this.minFractionDigits&&
t(this.minFractionDigits);this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Qf{constructor(t){this.type=yd;this.sections=t}static parse(t,A){if(2>t.length)return A.error("Expected at least one argument.");var E=t[1];if(!Array.isArray(E)&&"object"===typeof E)return A.error("First argument must be an image or text section.");E=[];var N=!1;for(let ia=1;ia<=t.length-1;++ia){var U=t[ia];if(N&&"object"===typeof U&&!Array.isArray(U)){N=!1;var ea=null;if(U["font-scale"]&&(ea=
A.parse(U["font-scale"],1,Eb),!ea))return null;let va=null;if(U["text-font"]&&(va=A.parse(U["text-font"],1,na(Cb)),!va))return null;let Ga=null;if(U["text-color"]&&(Ga=A.parse(U["text-color"],1,$f),!Ga))return null;U=E[E.length-1];U.scale=ea;U.font=va;U.textColor=Ga}else{ea=A.parse(t[ia],1,ld);if(!ea)return null;N=ea.type.kind;if("string"!==N&&"value"!==N&&"null"!==N&&"resolvedImage"!==N)return A.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");N=!0;E.push({content:ea,scale:null,
font:null,textColor:null})}}return new Qf(E)}evaluate(t){return new tf(this.sections.map(A=>{const E=A.content.evaluate(t);return Ic(E)===dd?new dg("",E,null,null,null):new dg(Rc(E),null,A.scale?A.scale.evaluate(t):null,A.font?A.font.evaluate(t).join(","):null,A.textColor?A.textColor.evaluate(t):null)}))}eachChild(t){for(const A of this.sections)t(A.content),A.scale&&t(A.scale),A.font&&t(A.font),A.textColor&&t(A.textColor)}outputDefined(){return!1}}class Oh{constructor(t){this.type=dd;this.input=
t}static parse(t,A){return 2!==t.length?A.error("Expected two arguments."):(t=A.parse(t[1],1,Cb))?new Oh(t):A.error("No image name provided.")}evaluate(t){const A=this.input.evaluate(t),E=Pe.fromString(A);E&&t.availableImages&&(E.available=-1<t.availableImages.indexOf(A));return E}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ki{constructor(t){this.type=Eb;this.input=t}static parse(t,A){return 2!==t.length?A.error(`Expected 1 argument, but found ${t.length-1} instead.`):(t=A.parse(t[1],
1))?"array"!==t.type.kind&&"string"!==t.type.kind&&"value"!==t.type.kind?A.error(`Expected argument of type string or array, but found ${bb(t.type)} instead.`):new Ki(t):null}evaluate(t){t=this.input.evaluate(t);if("string"===typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new ge(`Expected value to be of type string or array, but found ${bb(Ic(t))} instead.`);}eachChild(t){t(this.input)}outputDefined(){return!1}}class Mi{constructor(t,A){this.type=kd;this.geojson=t;this.geometries=
A}static parse(t,A){if(2!==t.length)return A.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(pd(t[1]))if(t=t[1],"FeatureCollection"===t.type){const N=[];for(var E of t.features){const {type:U,coordinates:ea}=E.geometry;"Polygon"===U&&N.push(ea);"MultiPolygon"===U&&N.push(...ea)}if(N.length)return new Mi(t,{type:"MultiPolygon",coordinates:N})}else if("Feature"===t.type){if(E=t.geometry.type,"Polygon"===E||"MultiPolygon"===E)return new Mi(t,t.geometry)}else if("Polygon"===
t.type||"MultiPolygon"===t.type)return new Mi(t,t);return A.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return ma(t,this.geometries);if("LineString"===t.geometryType())return ua(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class hj{constructor(t=[],A=(E,N)=>E<N?-1:E>N?1:0){this.data=t;this.length=this.data.length;this.compare=A;if(0<this.length)for(t=
(this.length>>1)-1;0<=t;t--)this._down(t)}push(t){this.data.push(t);this._up(this.length++)}pop(){if(0!==this.length){var t=this.data[0],A=this.data.pop();0<--this.length&&(this.data[0]=A,this._down(0));return t}}peek(){return this.data[0]}_up(t){const {data:A,compare:E}=this,N=A[t];for(;0<t;){const U=t-1>>1,ea=A[U];if(0<=E(N,ea))break;A[t]=ea;t=U}A[t]=N}_down(t){const {data:A,compare:E}=this,N=this.length>>1,U=A[t];for(;t<N;){let ea=(t<<1)+1;const ia=ea+1;ia<this.length&&0>E(A[ia],A[ea])&&(ea=ia);
if(0<=E(A[ea],U))break;A[t]=A[ea];t=ea}A[t]=U}}const Aj=1/298.257223563,uf=Aj*(2-Aj),Ph=Math.PI/180;class Cj{constructor(t){const A=6378137*Ph;t=Math.cos(t*Ph);const E=1/(1-uf*(1-t*t)),N=Math.sqrt(E);this.kx=A*N*t;this.ky=A*N*E*(1-uf)}distance(t,A){const E=this.wrap(t[0]-A[0])*this.kx;t=(t[1]-A[1])*this.ky;return Math.sqrt(E*E+t*t)}pointOnLine(t,A){let E=Infinity,N,U,ea,ia;for(let Ga=0;Ga<t.length-1;Ga++){let Sa=t[Ga][0],ab=t[Ga][1];var va=this.wrap(t[Ga+1][0]-Sa)*this.kx;let Qb=(t[Ga+1][1]-ab)*this.ky,
ic=0;if(0!==va||0!==Qb)ic=(this.wrap(A[0]-Sa)*this.kx*va+(A[1]-ab)*this.ky*Qb)/(va*va+Qb*Qb),1<ic?(Sa=t[Ga+1][0],ab=t[Ga+1][1]):0<ic&&(Sa+=va/this.kx*ic,ab+=Qb/this.ky*ic);va=this.wrap(A[0]-Sa)*this.kx;Qb=(A[1]-ab)*this.ky;va=va*va+Qb*Qb;va<E&&(E=va,N=Sa,U=ab,ea=Ga,ia=ic)}return{point:[N,U],index:ea,t:Math.max(0,Math.min(1,ia))}}wrap(t){for(;-180>t;)t+=360;for(;180<t;)t-=360;return t}}class yh{constructor(t,A){this.type=Eb;this.geojson=t;this.geometries=A}static parse(t,A){if(2!==t.length)return A.error(`'distance' expression requires exactly one argument, but found ${t.length-
1} instead.`);if(pd(t[1])){t=t[1];if("FeatureCollection"===t.type)return new yh(t,t.features.map(E=>Nj(E.geometry)).flat());if("Feature"===t.type)return new yh(t,Nj(t.geometry));if("type"in t&&"coordinates"in t)return new yh(t,Nj(t))}return A.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return re(t,this.geometries);if("LineString"===t.geometryType())return Eh(t,
this.geometries);if("Polygon"===t.geometryType())return ok(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Qh={"\x3d\x3d":je,"!\x3d":Zj,"\x3e":Qg,"\x3c":gj,"\x3e\x3d":Ji,"\x3c\x3d":ke,array:Qe,at:Hi,"boolean":Qe,"case":zj,coalesce:Ii,collator:Nh,format:Qf,image:Oh,"in":eg,"index-of":gi,interpolate:lf,"interpolate-hcl":lf,"interpolate-lab":lf,length:Ki,let:Pg,literal:ug,match:hi,number:Qe,"number-format":fh,object:Qe,slice:wh,step:Wc,string:Qe,"to-boolean":Og,"to-color":Og,
"to-number":Og,"to-string":Og,"var":Gi,within:Mi,distance:yh};class vg{constructor(t,A,E,N){this.name=t;this.type=A;this._evaluate=E;this.args=N}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,A){var E=t[0],N=vg.definitions[E];if(!N)return A.error(`Unknown expression "${E}". If you wanted a literal array, use ["literal", [...]].`,0);var U=Array.isArray(N)?N[0]:N.type;N=Array.isArray(N)?[[N[1],N[2]]]:N.overloads;var ea=N.filter(([ab])=>
!Array.isArray(ab)||ab.length===t.length-1);let ia=null;for(const [ab,Qb]of ea){ia=new $e(A.registry,mh,A.path,null,A.scope);const ic=[];var va=!1;for(var Ga=1;Ga<t.length;Ga++){var Sa=t[Ga];const Vb=Array.isArray(ab)?ab[Ga-1]:ab.type;Sa=ia.parse(Sa,1+ic.length,Vb);if(!Sa){va=!0;break}ic.push(Sa)}if(!va)if(Array.isArray(ab)&&ab.length!==ic.length)ia.error(`Expected ${ab.length} arguments, but found ${ic.length} instead.`);else{for(va=0;va<ic.length;va++)Ga=Array.isArray(ab)?ab[va]:ab.type,Sa=ic[va],
ia.concat(va+1).checkSubtype(Ga,Sa.type);if(0===ia.errors.length)return new vg(E,U,Qb,ic)}}if(1===ea.length)A.errors.push(...ia.errors);else{E=(ea.length?ea:N).map(([ab])=>{ab=Array.isArray(ab)?`(${ab.map(bb).join(", ")})`:`(${bb(ab.type)}...)`;return ab}).join(" | ");U=[];for(N=1;N<t.length;N++){ea=A.parse(t[N],1+U.length);if(!ea)return null;U.push(bb(ea.type))}A.error(`Expected arguments of type ${E}, but found (${U.join(", ")}) instead.`)}return null}static register(t,A){vg.definitions=A;for(const E in A)t[E]=
vg}}vg.register(Qh,{error:[{kind:"error"},[Cb],(t,[A])=>{throw new ge(A.evaluate(t));}],"typeof":[Cb,[ld],(t,[A])=>bb(Ic(A.evaluate(t)))],"to-rgba":[na(Eb,4),[$f],(t,[A])=>{const [E,N,U,ea]=A.evaluate(t).rgb;return[255*E,255*N,255*U,ea]}],rgb:[$f,[Eb,Eb,Eb],qj],rgba:[$f,[Eb,Eb,Eb,Eb],qj],has:{type:kd,overloads:[[[Cb],(t,[A])=>{A=A.evaluate(t);t=t.properties();return A in t}],[[Cb,sf],(t,[A,E])=>{A=A.evaluate(t);t=E.evaluate(t);return A in t}]]},get:{type:ld,overloads:[[[Cb],(t,[A])=>Ui(A.evaluate(t),
t.properties())],[[Cb,sf],(t,[A,E])=>Ui(A.evaluate(t),E.evaluate(t))]]},"feature-state":[ld,[Cb],(t,[A])=>Ui(A.evaluate(t),t.featureState||{})],properties:[sf,[],t=>t.properties()],"geometry-type":[Cb,[],t=>t.geometryType()],id:[ld,[],t=>t.id()],zoom:[Eb,[],t=>t.globals.zoom],"heatmap-density":[Eb,[],t=>t.globals.heatmapDensity||0],"line-progress":[Eb,[],t=>t.globals.lineProgress||0],accumulated:[ld,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Eb,{type:Eb},(t,A)=>{let E=0;
for(const N of A)E+=N.evaluate(t);return E}],"*":[Eb,{type:Eb},(t,A)=>{let E=1;for(const N of A)E*=N.evaluate(t);return E}],"-":{type:Eb,overloads:[[[Eb,Eb],(t,[A,E])=>A.evaluate(t)-E.evaluate(t)],[[Eb],(t,[A])=>-A.evaluate(t)]]},"/":[Eb,[Eb,Eb],(t,[A,E])=>A.evaluate(t)/E.evaluate(t)],"%":[Eb,[Eb,Eb],(t,[A,E])=>A.evaluate(t)%E.evaluate(t)],ln2:[Eb,[],()=>Math.LN2],pi:[Eb,[],()=>Math.PI],e:[Eb,[],()=>Math.E],"^":[Eb,[Eb,Eb],(t,[A,E])=>Math.pow(A.evaluate(t),E.evaluate(t))],sqrt:[Eb,[Eb],(t,[A])=>Math.sqrt(A.evaluate(t))],
log10:[Eb,[Eb],(t,[A])=>Math.log(A.evaluate(t))/Math.LN10],ln:[Eb,[Eb],(t,[A])=>Math.log(A.evaluate(t))],log2:[Eb,[Eb],(t,[A])=>Math.log(A.evaluate(t))/Math.LN2],sin:[Eb,[Eb],(t,[A])=>Math.sin(A.evaluate(t))],cos:[Eb,[Eb],(t,[A])=>Math.cos(A.evaluate(t))],tan:[Eb,[Eb],(t,[A])=>Math.tan(A.evaluate(t))],asin:[Eb,[Eb],(t,[A])=>Math.asin(A.evaluate(t))],acos:[Eb,[Eb],(t,[A])=>Math.acos(A.evaluate(t))],atan:[Eb,[Eb],(t,[A])=>Math.atan(A.evaluate(t))],min:[Eb,{type:Eb},(t,A)=>Math.min(...A.map(E=>E.evaluate(t)))],
max:[Eb,{type:Eb},(t,A)=>Math.max(...A.map(E=>E.evaluate(t)))],abs:[Eb,[Eb],(t,[A])=>Math.abs(A.evaluate(t))],round:[Eb,[Eb],(t,[A])=>{t=A.evaluate(t);return 0>t?-Math.round(-t):Math.round(t)}],floor:[Eb,[Eb],(t,[A])=>Math.floor(A.evaluate(t))],ceil:[Eb,[Eb],(t,[A])=>Math.ceil(A.evaluate(t))],"filter-\x3d\x3d":[kd,[Cb,ld],(t,[A,E])=>t.properties()[A.value]===E.value],"filter-id-\x3d\x3d":[kd,[ld],(t,[A])=>t.id()===A.value],"filter-type-\x3d\x3d":[kd,[Cb],(t,[A])=>t.geometryType()===A.value],"filter-\x3c":[kd,
[Cb,ld],(t,[A,E])=>{t=t.properties()[A.value];E=E.value;return typeof t===typeof E&&t<E}],"filter-id-\x3c":[kd,[ld],(t,[A])=>{t=t.id();A=A.value;return typeof t===typeof A&&t<A}],"filter-\x3e":[kd,[Cb,ld],(t,[A,E])=>{t=t.properties()[A.value];E=E.value;return typeof t===typeof E&&t>E}],"filter-id-\x3e":[kd,[ld],(t,[A])=>{t=t.id();A=A.value;return typeof t===typeof A&&t>A}],"filter-\x3c\x3d":[kd,[Cb,ld],(t,[A,E])=>{t=t.properties()[A.value];E=E.value;return typeof t===typeof E&&t<=E}],"filter-id-\x3c\x3d":[kd,
[ld],(t,[A])=>{t=t.id();A=A.value;return typeof t===typeof A&&t<=A}],"filter-\x3e\x3d":[kd,[Cb,ld],(t,[A,E])=>{t=t.properties()[A.value];E=E.value;return typeof t===typeof E&&t>=E}],"filter-id-\x3e\x3d":[kd,[ld],(t,[A])=>{t=t.id();A=A.value;return typeof t===typeof A&&t>=A}],"filter-has":[kd,[ld],(t,[A])=>A.value in t.properties()],"filter-has-id":[kd,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[kd,[na(Cb)],(t,[A])=>0<=A.value.indexOf(t.geometryType())],"filter-id-in":[kd,[na(ld)],(t,[A])=>
0<=A.value.indexOf(t.id())],"filter-in-small":[kd,[Cb,na(ld)],(t,[A,E])=>0<=E.value.indexOf(t.properties()[A.value])],"filter-in-large":[kd,[Cb,na(ld)],(t,[A,E])=>{a:{t=t.properties()[A.value];A=E.value;var N=0;for(E=E.value.length-1;N<=E;){const U=N+E>>1;if(A[U]===t){E=!0;break a}A[U]>t?E=U-1:N=U+1}E=!1}return E}],all:{type:kd,overloads:[[[kd,kd],(t,[A,E])=>A.evaluate(t)&&E.evaluate(t)],[{type:kd},(t,A)=>{for(const E of A)if(!E.evaluate(t))return!1;return!0}]]},any:{type:kd,overloads:[[[kd,kd],(t,
[A,E])=>A.evaluate(t)||E.evaluate(t)],[{type:kd},(t,A)=>{for(const E of A)if(E.evaluate(t))return!0;return!1}]]},"!":[kd,[kd],(t,[A])=>!A.evaluate(t)],"is-supported-script":[kd,[Cb],(t,[A])=>{const E=t.globals&&t.globals.isSupportedScript;return E?E(A.evaluate(t)):!0}],upcase:[Cb,[Cb],(t,[A])=>A.evaluate(t).toUpperCase()],downcase:[Cb,[Cb],(t,[A])=>A.evaluate(t).toLowerCase()],concat:[Cb,{type:ld},(t,A)=>A.map(E=>Rc(E.evaluate(t))).join("")],"resolved-locale":[Cb,[Ld],(t,[A])=>A.evaluate(t).resolvedLocale()]});
class Nd{constructor(t,A){this.expression=t;this._warningHistory={};this._evaluator=new yj;this._defaultValue=A?"color"===A.type&&Xg(A.default)?new Ad(0,0,0,0):"color"===A.type?Ad.parse(A.default)||null:"padding"===A.type?Ce.parse(A.default)||null:"variableAnchorOffsetCollection"===A.type?af.parse(A.default)||null:void 0===A.default?null:A.default:null;this._enumValues=A&&"enum"===A.type?A.values:null}evaluateWithoutErrorHandling(t,A,E,N,U,ea){this._evaluator.globals=t;this._evaluator.feature=A;this._evaluator.featureState=
E;this._evaluator.canonical=N;this._evaluator.availableImages=U||null;this._evaluator.formattedSection=ea;return this.expression.evaluate(this._evaluator)}evaluate(t,A,E,N,U,ea){this._evaluator.globals=t;this._evaluator.feature=A||null;this._evaluator.featureState=E||null;this._evaluator.canonical=N;this._evaluator.availableImages=U||null;this._evaluator.formattedSection=ea||null;try{const ia=this.expression.evaluate(this._evaluator);if(null===ia||void 0===ia||"number"===typeof ia&&ia!==ia)return this._defaultValue;
if(this._enumValues&&!(ia in this._enumValues))throw new ge(`Expected value to be one of ${Object.keys(this._enumValues).map(va=>JSON.stringify(va)).join(", ")}, but found ${JSON.stringify(ia)} instead.`);return ia}catch(ia){return this._warningHistory[ia.message]||(this._warningHistory[ia.message]=!0,"undefined"!==typeof console&&console.warn(ia.message)),this._defaultValue}}}class vf{constructor(t,A){this.kind=t;this._styleExpression=A;this.isStateDependent="constant"!==t&&!Bg(A.expression)}evaluateWithoutErrorHandling(t,
A,E,N,U,ea){return this._styleExpression.evaluateWithoutErrorHandling(t,A,E,N,U,ea)}evaluate(t,A,E,N,U,ea){return this._styleExpression.evaluate(t,A,E,N,U,ea)}}class wg{constructor(t,A,E,N){this.kind=t;this.zoomStops=E;this._styleExpression=A;this.isStateDependent="camera"!==t&&!Bg(A.expression);this.interpolationType=N}evaluateWithoutErrorHandling(t,A,E,N,U,ea){return this._styleExpression.evaluateWithoutErrorHandling(t,A,E,N,U,ea)}evaluate(t,A,E,N,U,ea){return this._styleExpression.evaluate(t,A,
E,N,U,ea)}interpolationFactor(t,A,E){return this.interpolationType?lf.interpolationFactor(this.interpolationType,t,A,E):0}}class Ni{constructor(t,A){this._parameters=t;this._specification=A;Sb(this,ph(this._parameters,this._specification))}static deserialize(t){return new Ni(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}const gg={type:"boolean","default":!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,
parameters:["zoom","feature"]}},ii={promoteId:function({key:t,value:A}){if("string"===Id(A))return Od({key:t,value:A});const E=[];for(const N in A)E.push(...Od({key:`${t}.${N}`,value:A[N]}));return E}},Sh={["*"](){return[]},array:zf,"boolean":function(t){const A=t.value;t=t.key;const E=Id(A);return"boolean"!==E?[new hc(t,A,`boolean expected, ${E} found`)]:[]},number:$c,color:function(t){const A=t.key;t=t.value;const E=Id(t);return"string"!==E?[new hc(A,t,`color expected, ${E} found`)]:Ad.parse(String(t))?
[]:[new hc(A,t,`color expected, "${t}" found`)]},constants:kg,"enum":Vd,filter:jf,"function":Zd,layer:vj,object:Ee,source:Nf,light:Ue,sky:th,terrain:Di,projection:function(t){const A=t.value,E=t.styleSpec,N=E.projection,U=t.style;var ea=Id(A);if(void 0===A)return[];if("object"!==ea)return[new hc("projection",A,`object expected, ${ea} found`)];ea=[];for(const ia in A)ea=N[ia]?ea.concat(t.validateSpec({key:ia,value:A[ia],valueSpec:N[ia],style:U,styleSpec:E})):ea.concat([new hc(ia,A[ia],`unknown property "${ia}"`)]);
return ea},string:Od,formatted:function(t){return 0===Od(t).length?[]:Wf(t)},resolvedImage:function(t){return 0===Od(t).length?[]:Wf(t)},padding:function(t){const A=t.key,E=t.value;if("array"===Id(E)){if(1>E.length||4<E.length)return[new hc(A,E,`padding requires 1 to 4 values; ${E.length} values found`)];const N={type:"number"};let U=[];for(let ea=0;ea<E.length;ea++)U=U.concat(t.validateSpec({key:`${A}[${ea}]`,value:E[ea],validateSpec:t.validateSpec,valueSpec:N}));return U}return $c({key:A,value:E,
valueSpec:{}})},variableAnchorOffsetCollection:function(t){const A=t.key,E=t.value;var N=Id(E);const U=t.styleSpec;if("array"!==N||1>E.length||0!==E.length%2)return[new hc(A,E,"variableAnchorOffsetCollection requires a non-empty array of even length")];N=[];for(let ea=0;ea<E.length;ea+=2)N=N.concat(Vd({key:`${A}[${ea}]`,value:E[ea],valueSpec:U.layout_symbol["text-anchor"]})),N=N.concat(zf({key:`${A}[${ea+1}]`,value:E[ea+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,
styleSpec:U}));return N},sprite:cj};Gf.source=Yf(Xf(Nf));Gf.sprite=Yf(Xf(cj));Gf.glyphs=Yf(Xf(Ei));Gf.light=Yf(Xf(Ue));Gf.sky=Yf(Xf(th));Gf.terrain=Yf(Xf(Di));Gf.layer=Yf(Xf(vj));Gf.filter=Yf(Xf(jf));Gf.paintProperty=Yf(Xf(ci));Gf.layoutProperty=Yf(Xf(di));const ak=/("(?:[^\\"]|\\.)*")|[:,]/g,Ek=ue,Dj={StyleExpression:Nd,StylePropertyFunction:Ni,ZoomConstantExpression:vf,ZoomDependentExpression:wg,createExpression:vi,createPropertyExpression:Hh,isExpression:Tf,isExpressionFilter:Uf,isZoomExpression:tj,
normalizePropertyExpression:uk},bk={convertFunction:xi,createFunction:ph,isFunction:Xg},Gk={eachLayer:Gg,eachProperty:Ff,eachSource:Ai};Na.Color=Ad;Na.ColorType=$f;Na.CompoundExpression=vg;Na.EvaluationContext=yj;Na.FormatExpression=Qf;Na.Formatted=tf;Na.FormattedSection=dg;Na.FormattedType=yd;Na.Interpolate=lf;Na.Literal=ug;Na.NullType=He;Na.Padding=Ce;Na.ParsingError=kf;Na.ResolvedImage=Pe;Na.Step=Wc;Na.StyleExpression=Nd;Na.StylePropertyFunction=Ni;Na.ValidationError=hc;Na.VariableAnchorOffsetCollection=
af;Na.ZoomConstantExpression=vf;Na.ZoomDependentExpression=wg;Na.classifyRings=pb;Na.convertFilter=yf;Na.convertFunction=xi;Na.createExpression=vi;Na.createFunction=ph;Na.createPropertyExpression=Hh;Na.derefLayers=function(t){t=t.slice();const A=Object.create(null);for(var E=0;E<t.length;E++)A[t[E].id]=t[E];for(E=0;E<t.length;E++)"ref"in t[E]&&(t[E]=qc(t[E],A[t[E].ref]));return t};Na.diff=function(t,A){if(!t)return[{command:"setStyle",args:[A]}];let E=[];try{if(!hb(t.version,A.version))return[{command:"setStyle",
args:[A]}];hb(t.center,A.center)||E.push({command:"setCenter",args:[A.center]});hb(t.zoom,A.zoom)||E.push({command:"setZoom",args:[A.zoom]});hb(t.bearing,A.bearing)||E.push({command:"setBearing",args:[A.bearing]});hb(t.pitch,A.pitch)||E.push({command:"setPitch",args:[A.pitch]});hb(t.roll,A.roll)||E.push({command:"setRoll",args:[A.roll]});hb(t.sprite,A.sprite)||E.push({command:"setSprite",args:[A.sprite]});hb(t.glyphs,A.glyphs)||E.push({command:"setGlyphs",args:[A.glyphs]});hb(t.transition,A.transition)||
E.push({command:"setTransition",args:[A.transition]});hb(t.light,A.light)||E.push({command:"setLight",args:[A.light]});hb(t.terrain,A.terrain)||E.push({command:"setTerrain",args:[A.terrain]});hb(t.sky,A.sky)||E.push({command:"setSky",args:[A.sky]});hb(t.projection,A.projection)||E.push({command:"setProjection",args:[A.projection]});const N={},U=[];v(t.sources,A.sources,U,N);const ea=[];t.layers&&t.layers.forEach(ia=>{"source"in ia&&N[ia.source]?E.push({command:"removeLayer",args:[ia.id]}):ea.push(ia)});
E=E.concat(U);$a(ea,A.layers,E)}catch(N){console.warn("Unable to compute style diff:",N),E=[{command:"setStyle",args:[A]}]}return E};Na.emptyStyle=function(){const t={},A=ue.$version;for(const N in ue.$root){var E=ue.$root[N];E.required&&(E="version"===N?A:"array"===E.type?[]:{},null!=E&&(t[N]=E))}return t};Na.expression=Dj;Na.expressions=Qh;Na.featureFilter=function(t){if(null===t||void 0===t)return{filter:()=>!0,needGeometry:!1};Uf(t)||(t=Zi(t));const A=vi(t,gg);if("error"===A.result)throw Error(A.value.map(E=>
`${E.key}: ${E.message}`).join(", "));return{filter:(E,N,U)=>A.value.evaluate(E,N,{},U),needGeometry:rb(t)}};Na.format=function(t,A=2){t=Bf(t,ue.$root);t.layers&&(t.layers=t.layers.map(E=>Bf(E,ue.layer)));return Ge(t,{indent:A})};Na.function=bk;Na.groupByLayout=function(t,A){const E={};for(let ea=0;ea<t.length;ea++){var N;if(!(N=A&&A[t[ea].id])){N=t[ea];var U="";for(const ia of Xe)U+=`/${qg(N[ia])}`;N=U}A&&(A[t[ea].id]=N);(U=E[N])||(U=E[N]=[]);U.push(t[ea])}t=[];for(const ea in E)t.push(E[ea]);return t};
Na.interpolateFactory=t=>{switch(t){case "number":return jb;case "color":return sc;case "array":return Ac;case "padding":return Tc;case "variableAnchorOffsetCollection":return od}};Na.interpolates=zd;Na.isExpression=Tf;Na.isFunction=Xg;Na.isZoomExpression=tj;Na.latest=ue;Na.migrate=function(t){let A=!1;7===t.version&&(t=jl(t),A=!0);8===t.version&&(A=!!Lb(t),A=!0);Ff(t,{paint:!0,layout:!0},({value:E,reference:N,set:U})=>{"color"===N.type&&U(JSON.parse(nd(JSON.stringify(E))))});if(!A)throw Error(`Cannot migrate from ${t.version}`);
return t};Na.normalizePropertyExpression=uk;Na.supportsPropertyExpression=Zh;Na.toString=bb;Na.typeOf=Ic;Na.v8=Ek;Na.validate=Af;Na.validateStyleMin=Gf;Na.visit=Gk})};
shadow$provide[21]=function(Le,Sd,Yd,ba){function Na(Pa,yb,Ib=!0){function Fb(lc){if(lc.normalized||lc.isInterleavedBufferAttribute){const bc=new Float32Array(lc.count*lc.itemSize);for(let Hc=0,Jc=0;Hc<lc.count;Hc++)bc[Jc++]=lc.getX(Hc),bc[Jc++]=lc.getY(Hc),2<lc.itemSize&&(bc[Jc++]=lc.getZ(Hc));return bc}return lc.array instanceof Float32Array?lc.array:new Float32Array(lc.array)}if(!yb||!yb.isReady)throw Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!Pa.hasAttribute("position")||
!Pa.hasAttribute("normal")||!Pa.hasAttribute("uv"))throw Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');const zb=Pa.index?Pa.toNonIndexed():Pa;yb=yb.generateTangents(Fb(zb.attributes.position),Fb(zb.attributes.normal),Fb(zb.attributes.uv));if(Ib)for(Ib=3;Ib<yb.length;Ib+=4)yb[Ib]*=-1;zb.setAttribute("tangent",new vb.BufferAttribute(yb,4));Pa!==zb&&Pa.copy(zb);return Pa}function qc(Pa,yb=!1){var Ib=null!==Pa[0].index,Fb=new Set(Object.keys(Pa[0].attributes)),
zb=new Set(Object.keys(Pa[0].morphAttributes)),lc={};const bc={};var Hc=Pa[0].morphTargetsRelative;const Jc=new vb.BufferGeometry;let id=0;for(let dc=0;dc<Pa.length;++dc){var sd=Pa[dc];let xc=0;if(Ib!==(null!==sd.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dc+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const Nc in sd.attributes){if(!Fb.has(Nc))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
dc+'. All geometries must have compatible attributes; make sure "'+Nc+'" attribute exists among all geometries, or in none of them.'),null;void 0===lc[Nc]&&(lc[Nc]=[]);lc[Nc].push(sd.attributes[Nc]);xc++}if(xc!==Fb.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dc+". Make sure all geometries have the same number of attributes."),null;if(Hc!==sd.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
dc+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const Nc in sd.morphAttributes){if(!zb.has(Nc))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dc+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===bc[Nc]&&(bc[Nc]=[]);bc[Nc].push(sd.morphAttributes[Nc])}if(yb){if(Ib)sd=sd.index.count;else if(void 0!==sd.attributes.position)sd=sd.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
dc+". The geometry must have either an index or a position attribute"),null;Jc.addGroup(id,sd,dc);id+=sd}}if(Ib){yb=0;Ib=[];for(Fb=0;Fb<Pa.length;++Fb){zb=Pa[Fb].index;for(Hc=0;Hc<zb.count;++Hc)Ib.push(zb.getX(Hc)+yb);yb+=Pa[Fb].attributes.position.count}Jc.setIndex(Ib)}for(var Dc in lc){Pa=hb(lc[Dc]);if(!Pa)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Dc+" attribute."),null;Jc.setAttribute(Dc,Pa)}for(const dc in bc){lc=bc[dc][0].length;if(0===
lc)break;Jc.morphAttributes=Jc.morphAttributes||{};Jc.morphAttributes[dc]=[];for(Dc=0;Dc<lc;++Dc){Pa=[];for(yb=0;yb<bc[dc].length;++yb)Pa.push(bc[dc][yb][Dc]);Pa=hb(Pa);if(!Pa)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+dc+" morphAttribute."),null;Jc.morphAttributes[dc].push(Pa)}}return Jc}function hb(Pa){let yb;let Ib=-1;var Fb=0;for(var zb=0;zb<Pa.length;++zb){var lc=Pa[zb];if(void 0===bc)var bc=lc.array.constructor;if(bc!==lc.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),
null;void 0===yb&&(yb=lc.itemSize);if(yb!==lc.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===Hc)var Hc=lc.normalized;if(Hc!==lc.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;-1===Ib&&(Ib=lc.gpuType);if(Ib!==lc.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),
null;Fb+=lc.count*yb}bc=new bc(Fb);Hc=new vb.BufferAttribute(bc,yb,Hc);Fb=0;for(zb=0;zb<Pa.length;++zb){lc=Pa[zb];if(lc.isInterleavedBufferAttribute){const Jc=Fb/yb;for(let id=0,sd=lc.count;id<sd;id++)for(let Dc=0;Dc<yb;Dc++){const dc=lc.getComponent(id,Dc);Hc.setComponent(id+Jc,Dc,dc)}}else bc.set(lc.array,Fb);Fb+=lc.count*yb}void 0!==Ib&&(Hc.gpuType=Ib);return Hc}function M(Pa){return Pa.isInstancedInterleavedBufferAttribute||Pa.isInterleavedBufferAttribute?ta(Pa):Pa.isInstancedBufferAttribute?
(new vb.InstancedBufferAttribute).copy(Pa):(new vb.BufferAttribute).copy(Pa)}function v(Pa){var yb=0,Ib=0;for(let bc=0,Hc=Pa.length;bc<Hc;++bc){var Fb=Pa[bc];if(void 0===zb)var zb=Fb.array.constructor;if(zb!==Fb.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;yb+=Fb.array.length;Ib+=Fb.itemSize}zb=new vb.InterleavedBuffer(new zb(yb),Ib);yb=0;Ib=[];Fb=["getX","getY","getZ","getW"];const lc=["setX","setY","setZ","setW"];for(let bc=0,Hc=Pa.length;bc<
Hc;bc++){const Jc=Pa[bc],id=Jc.itemSize,sd=Jc.count,Dc=new vb.InterleavedBufferAttribute(zb,id,yb,Jc.normalized);Ib.push(Dc);yb+=id;for(let dc=0;dc<sd;dc++)for(let xc=0;xc<id;xc++)Dc[lc[xc]](dc,Jc[Fb[xc]](dc))}return Ib}function ta(Pa){const yb=Pa.count,Ib=Pa.itemSize;var Fb=Pa.normalized,zb=new Pa.data.array.constructor(yb*Ib);Fb=Pa.isInstancedInterleavedBufferAttribute?new vb.InstancedBufferAttribute(zb,Ib,Fb,Pa.meshPerAttribute):new vb.BufferAttribute(zb,Ib,Fb);for(zb=0;zb<yb;zb++)Fb.setX(zb,Pa.getX(zb)),
2<=Ib&&Fb.setY(zb,Pa.getY(zb)),3<=Ib&&Fb.setZ(zb,Pa.getZ(zb)),4<=Ib&&Fb.setW(zb,Pa.getW(zb));return Fb}function Va(Pa){var yb=Pa.attributes;Pa=Pa.morphTargets;const Ib=new Map;for(const Fb in yb){const zb=yb[Fb];zb.isInterleavedBufferAttribute&&(Ib.has(zb)||Ib.set(zb,ta(zb)),yb[Fb]=Ib.get(zb))}for(const Fb in Pa)yb=Pa[Fb],yb.isInterleavedBufferAttribute&&(Ib.has(yb)||Ib.set(yb,ta(yb)),Pa[Fb]=Ib.get(yb))}function Ab(Pa){let yb=0;for(const Ib in Pa.attributes){const Fb=Pa.getAttribute(Ib);yb+=Fb.count*
Fb.itemSize*Fb.array.BYTES_PER_ELEMENT}Pa=Pa.getIndex();return yb+=Pa?Pa.count*Pa.itemSize*Pa.array.BYTES_PER_ELEMENT:0}function $a(Pa,yb=1E-4){yb=Math.max(yb,Number.EPSILON);var Ib={},Fb=Pa.getIndex(),zb=Pa.getAttribute("position");const lc=Fb?Fb.count:zb.count;zb=0;const bc=Object.keys(Pa.attributes),Hc={},Jc={},id=[],sd=["getX","getY","getZ","getW"],Dc=["setX","setY","setZ","setW"];for(let Rc=0,Kb=bc.length;Rc<Kb;Rc++){const Ma=bc[Rc];var dc=Pa.attributes[Ma];Hc[Ma]=new dc.constructor(new dc.array.constructor(dc.count*
dc.itemSize),dc.itemSize,dc.normalized);if(dc=Pa.morphAttributes[Ma])Jc[Ma]||(Jc[Ma]=[]),dc.forEach((jb,sc)=>{const Ac=new jb.array.constructor(jb.count*jb.itemSize);Jc[Ma][sc]=new jb.constructor(Ac,jb.itemSize,jb.normalized)})}dc=Math.pow(10,Math.log10(1/yb));yb=.5*yb*dc;for(let Rc=0;Rc<lc;Rc++){const Kb=Fb?Fb.getX(Rc):Rc;let Ma="";for(let jb=0,sc=bc.length;jb<sc;jb++){var xc=Pa.getAttribute(bc[jb]),Nc=xc.itemSize;for(var pd=0;pd<Nc;pd++)Ma+=`${~~(xc[sd[pd]](Kb)*dc+yb)},`}if(Ma in Ib)id.push(Ib[Ma]);
else{for(let jb=0,sc=bc.length;jb<sc;jb++){var Ic=bc[jb];xc=Pa.getAttribute(Ic);Nc=Pa.morphAttributes[Ic];pd=xc.itemSize;const Ac=Hc[Ic];Ic=Jc[Ic];for(let Tc=0;Tc<pd;Tc++){const od=sd[Tc],Vc=Dc[Tc];Ac[Vc](zb,xc[od](Kb));if(Nc)for(let yc=0,Pc=Nc.length;yc<Pc;yc++)Ic[yc][Vc](zb,Nc[yc][od](Kb))}}Ib[Ma]=zb;id.push(zb);zb++}}Ib=Pa.clone();for(const Rc in Pa.attributes)if(Pa=Hc[Rc],Ib.setAttribute(Rc,new Pa.constructor(Pa.array.slice(0,zb*Pa.itemSize),Pa.itemSize,Pa.normalized)),Rc in Jc)for(Pa=0;Pa<Jc[Rc].length;Pa++)Fb=
Jc[Rc][Pa],Ib.morphAttributes[Rc][Pa]=new Fb.constructor(Fb.array.slice(0,zb*Fb.itemSize),Fb.itemSize,Fb.normalized);Ib.setIndex(id);return Ib}function Sb(Pa,yb){if(yb===vb.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),Pa;if(yb===vb.TriangleFanDrawMode||yb===vb.TriangleStripDrawMode){var Ib=Pa.getIndex();if(null===Ib){var Fb=[];Ib=Pa.getAttribute("position");if(void 0!==Ib){for(var zb=0;zb<Ib.count;zb++)Fb.push(zb);
Pa.setIndex(Fb);Ib=Pa.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),Pa}zb=Ib.count-2;Fb=[];if(yb===vb.TriangleFanDrawMode)for(yb=1;yb<=zb;yb++)Fb.push(Ib.getX(0)),Fb.push(Ib.getX(yb)),Fb.push(Ib.getX(yb+1));else for(yb=0;yb<zb;yb++)0===yb%2?(Fb.push(Ib.getX(yb)),Fb.push(Ib.getX(yb+1)),Fb.push(Ib.getX(yb+2))):(Fb.push(Ib.getX(yb+2)),Fb.push(Ib.getX(yb+1)),Fb.push(Ib.getX(yb)));Fb.length/3!==zb&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");
Pa=Pa.clone();Pa.setIndex(Fb);Pa.clearGroups();return Pa}console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",yb);return Pa}function na(Pa){function yb(td,Cd,Gd,pe,qe,gf,da,J){Ib.fromBufferAttribute(Cd,qe);Fb.fromBufferAttribute(Cd,gf);zb.fromBufferAttribute(Cd,da);Cd=td.morphTargetInfluences;if(Gd&&Cd){Jc.set(0,0,0);id.set(0,0,0);sd.set(0,0,0);for(let O=0,W=Gd.length;O<W;O++){const S=Cd[O],fa=Gd[O];0!==S&&(lc.fromBufferAttribute(fa,qe),bc.fromBufferAttribute(fa,gf),
Hc.fromBufferAttribute(fa,da),pe?(Jc.addScaledVector(lc,S),id.addScaledVector(bc,S),sd.addScaledVector(Hc,S)):(Jc.addScaledVector(lc.sub(Ib),S),id.addScaledVector(bc.sub(Fb),S),sd.addScaledVector(Hc.sub(zb),S)))}Ib.add(Jc);Fb.add(id);zb.add(sd)}td.isSkinnedMesh&&(td.applyBoneTransform(qe,Ib),td.applyBoneTransform(gf,Fb),td.applyBoneTransform(da,zb));J[3*qe]=Ib.x;J[3*qe+1]=Ib.y;J[3*qe+2]=Ib.z;J[3*gf]=Fb.x;J[3*gf+1]=Fb.y;J[3*gf+2]=Fb.z;J[3*da]=zb.x;J[3*da+1]=zb.y;J[3*da+2]=zb.z}const Ib=new vb.Vector3,
Fb=new vb.Vector3,zb=new vb.Vector3,lc=new vb.Vector3,bc=new vb.Vector3,Hc=new vb.Vector3,Jc=new vb.Vector3,id=new vb.Vector3,sd=new vb.Vector3;var Dc=Pa.geometry,dc=Pa.material;let xc,Nc;var pd=Dc.index;const Ic=Dc.attributes.position,Rc=Dc.morphAttributes.position,Kb=Dc.morphTargetsRelative,Ma=Dc.attributes.normal,jb=Dc.morphAttributes.position,sc=Dc.groups,Ac=Dc.drawRange;let Tc,od;const Vc=new Float32Array(Ic.count*Ic.itemSize);Dc=new Float32Array(Ma.count*Ma.itemSize);if(null!==pd)if(Array.isArray(dc))for(dc=
0,Tc=sc.length;dc<Tc;dc++){var yc=sc[dc];var Pc=Math.max(yc.start,Ac.start);for(od=yc=Math.min(yc.start+yc.count,Ac.start+Ac.count);Pc<od;Pc+=3)yc=pd.getX(Pc),xc=pd.getX(Pc+1),Nc=pd.getX(Pc+2),yb(Pa,Ic,Rc,Kb,yc,xc,Nc,Vc),yb(Pa,Ma,jb,Kb,yc,xc,Nc,Dc)}else for(Pc=Math.max(0,Ac.start),yc=Math.min(pd.count,Ac.start+Ac.count),dc=Pc,Tc=yc;dc<Tc;dc+=3)yc=pd.getX(dc),xc=pd.getX(dc+1),Nc=pd.getX(dc+2),yb(Pa,Ic,Rc,Kb,yc,xc,Nc,Vc),yb(Pa,Ma,jb,Kb,yc,xc,Nc,Dc);else if(Array.isArray(dc))for(dc=0,Tc=sc.length;dc<
Tc;dc++)for(yc=sc[dc],Pc=Math.max(yc.start,Ac.start),od=yc=Math.min(yc.start+yc.count,Ac.start+Ac.count);Pc<od;Pc+=3)yc=Pc,xc=Pc+1,Nc=Pc+2,yb(Pa,Ic,Rc,Kb,yc,xc,Nc,Vc),yb(Pa,Ma,jb,Kb,yc,xc,Nc,Dc);else for(Pc=Math.max(0,Ac.start),yc=Math.min(Ic.count,Ac.start+Ac.count),dc=Pc,Tc=yc;dc<Tc;dc+=3)yc=dc,xc=dc+1,Nc=dc+2,yb(Pa,Ic,Rc,Kb,yc,xc,Nc,Vc),yb(Pa,Ma,jb,Kb,yc,xc,Nc,Dc);Pa=new vb.Float32BufferAttribute(Vc,3);pd=new vb.Float32BufferAttribute(Dc,3);return{positionAttribute:Ic,normalAttribute:Ma,morphedPositionAttribute:Pa,
morphedNormalAttribute:pd}}function bb(Pa){if(0===Pa.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),Pa;let yb=Pa.groups;yb=yb.sort((Hc,Jc)=>Hc.materialIndex!==Jc.materialIndex?Hc.materialIndex-Jc.materialIndex:Hc.start-Jc.start);if(null===Pa.getIndex()){var Ib=Pa.getAttribute("position"),Fb=[];for(var zb=0;zb<Ib.count;zb+=3)Fb.push(zb,zb+1,zb+2);Pa.setIndex(Fb)}Ib=Pa.getIndex();Fb=[];for(zb=0;zb<yb.length;zb++){var lc=yb[zb],
bc=lc.start;for(lc=bc+lc.count;bc<lc;bc++)Fb.push(Ib.getX(bc))}Pa.dispose();Pa.setIndex(Fb);Ib=0;for(Fb=0;Fb<yb.length;Fb++)zb=yb[Fb],zb.start=Ib,Ib+=zb.count;Ib=yb[0];Pa.groups=[Ib];for(Fb=1;Fb<yb.length;Fb++)zb=yb[Fb],Ib.materialIndex===zb.materialIndex?Ib.count+=zb.count:(Ib=zb,Pa.groups.push(Ib));return Pa}function tc(Pa,yb=Math.PI/3){function Ib(Ic){return`${~~(Ic.x*Fb)},${~~(Ic.y*Fb)},${~~(Ic.z*Fb)}`}yb=Math.cos(yb);const Fb=100*(1+1E-10),zb=[new vb.Vector3,new vb.Vector3,new vb.Vector3],lc=
new vb.Vector3,bc=new vb.Vector3,Hc=new vb.Vector3,Jc=new vb.Vector3;Pa=Pa.index?Pa.toNonIndexed():Pa;const id=Pa.attributes.position,sd={};for(let Ic=0,Rc=id.count/3;Ic<Rc;Ic++){var Dc=3*Ic,dc=zb[0].fromBufferAttribute(id,Dc+0),xc=zb[1].fromBufferAttribute(id,Dc+1);Dc=zb[2].fromBufferAttribute(id,Dc+2);lc.subVectors(Dc,xc);bc.subVectors(dc,xc);dc=(new vb.Vector3).crossVectors(lc,bc).normalize();for(xc=0;3>xc;xc++)Dc=Ib(zb[xc]),Dc in sd||(sd[Dc]=[]),sd[Dc].push(dc)}dc=new Float32Array(3*id.count);
dc=new vb.BufferAttribute(dc,3,!1);for(let Ic=0,Rc=id.count/3;Ic<Rc;Ic++){xc=3*Ic;Dc=zb[0].fromBufferAttribute(id,xc+0);var Nc=zb[1].fromBufferAttribute(id,xc+1),pd=zb[2].fromBufferAttribute(id,xc+2);lc.subVectors(pd,Nc);bc.subVectors(Dc,Nc);Hc.crossVectors(lc,bc).normalize();for(Dc=0;3>Dc;Dc++){Nc=Ib(zb[Dc]);Nc=sd[Nc];Jc.set(0,0,0);for(let Kb=0,Ma=Nc.length;Kb<Ma;Kb++)pd=Nc[Kb],Hc.dot(pd)>yb&&Jc.add(pd);Jc.normalize();dc.setXYZ(xc+Dc,Jc.x,Jc.y,Jc.z)}}Pa.setAttribute("normal",dc);return Pa}Object.defineProperties(ba,
{__esModule:{enumerable:!0,value:!0},computeMikkTSpaceTangents:{enumerable:!0,get:function(){return Na}},computeMorphedAttributes:{enumerable:!0,get:function(){return na}},deepCloneAttribute:{enumerable:!0,get:function(){return M}},deinterleaveAttribute:{enumerable:!0,get:function(){return ta}},deinterleaveGeometry:{enumerable:!0,get:function(){return Va}},estimateBytesUsed:{enumerable:!0,get:function(){return Ab}},interleaveAttributes:{enumerable:!0,get:function(){return v}},mergeAttributes:{enumerable:!0,
get:function(){return hb}},mergeGeometries:{enumerable:!0,get:function(){return qc}},mergeGroups:{enumerable:!0,get:function(){return bb}},mergeVertices:{enumerable:!0,get:function(){return $a}},toCreasedNormals:{enumerable:!0,get:function(){return tc}},toTrianglesDrawMode:{enumerable:!0,get:function(){return Sb}}});var vb=Sd(10)};
shadow$provide[22]=function(Le,Sd,Yd,ba){function Na(){let J={};return{get:function(O){return J[O]},add:function(O,W){J[O]=W},remove:function(O){delete J[O]},removeAll:function(){J={}}}}function qc(J){void 0===J.DefaultMaterial&&(J.DefaultMaterial=new na.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:na.FrontSide}));return J.DefaultMaterial}function hb(J,O,W){for(const S in W.extensions)void 0===J[S]&&(O.userData.gltfExtensions=O.userData.gltfExtensions||
{},O.userData.gltfExtensions[S]=W.extensions[S])}function M(J,O){void 0!==O.extras&&("object"===typeof O.extras?Object.assign(J.userData,O.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+O.extras))}function v(J,O,W){let S=!1,fa=!1,ra=!1;for(let pb=0,Rb=O.length;pb<Rb;pb++){var ma=O[pb];void 0!==ma.POSITION&&(S=!0);void 0!==ma.NORMAL&&(fa=!0);void 0!==ma.COLOR_0&&(ra=!0);if(S&&fa&&ra)break}if(!S&&!fa&&!ra)return Promise.resolve(J);ma=[];const ua=[],Aa=[];for(let pb=0,Rb=
O.length;pb<Rb;pb++){var Ua=O[pb];if(S){var fb=void 0!==Ua.POSITION?W.getDependency("accessor",Ua.POSITION):J.attributes.position;ma.push(fb)}fa&&(fb=void 0!==Ua.NORMAL?W.getDependency("accessor",Ua.NORMAL):J.attributes.normal,ua.push(fb));ra&&(Ua=void 0!==Ua.COLOR_0?W.getDependency("accessor",Ua.COLOR_0):J.attributes.color,Aa.push(Ua))}return Promise.all([Promise.all(ma),Promise.all(ua),Promise.all(Aa)]).then(function(pb){const Rb=pb[0],ec=pb[1];pb=pb[2];S&&(J.morphAttributes.position=Rb);fa&&(J.morphAttributes.normal=
ec);ra&&(J.morphAttributes.color=pb);J.morphTargetsRelative=!0;return J})}function ta(J){var O=(O=J.extensions&&J.extensions[vb.KHR_DRACO_MESH_COMPRESSION])?"draco:"+O.bufferView+":"+O.indices+":"+Va(O.attributes):J.indices+":"+Va(J.attributes)+":"+J.mode;if(void 0!==J.targets)for(let W=0,S=J.targets.length;W<S;W++)O+=":"+Va(J.targets[W]);return O}function Va(J){let O="";const W=Object.keys(J).sort();for(let S=0,fa=W.length;S<fa;S++)O+=W[S]+":"+J[W[S]]+";";return O}function Ab(J){switch(J){case Int8Array:return 1/
127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.");}}function $a(J,O,W){var S=O.attributes;const fa=new na.Box3;if(void 0!==S.POSITION){S=W.json.accessors[S.POSITION];var ra=S.min,ma=S.max;if(void 0!==ra&&void 0!==ma){fa.set(new na.Vector3(ra[0],ra[1],ra[2]),new na.Vector3(ma[0],ma[1],ma[2]));S.normalized&&(S=Ab(yc[S.componentType]),fa.min.multiplyScalar(S),fa.max.multiplyScalar(S));
O=O.targets;if(void 0!==O){S=new na.Vector3;ra=new na.Vector3;for(let ua=0,Aa=O.length;ua<Aa;ua++)if(ma=O[ua],void 0!==ma.POSITION){ma=W.json.accessors[ma.POSITION];const Ua=ma.min,fb=ma.max;void 0!==Ua&&void 0!==fb?(ra.setX(Math.max(Math.abs(Ua[0]),Math.abs(fb[0]))),ra.setY(Math.max(Math.abs(Ua[1]),Math.abs(fb[1]))),ra.setZ(Math.max(Math.abs(Ua[2]),Math.abs(fb[2]))),ma.normalized&&(ma=Ab(yc[ma.componentType]),ra.multiplyScalar(ma)),S.max(ra)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}fa.expandByVector(S)}J.boundingBox=
fa;W=new na.Sphere;fa.getCenter(W.center);W.radius=fa.min.distanceTo(fa.max)/2;J.boundingSphere=W}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function Sb(J,O,W){function S(ua,Aa){return W.getDependency("accessor",ua).then(function(Ua){J.setAttribute(Aa,Ua)})}const fa=O.attributes,ra=[];for(var ma in fa){const ua=Gd[ma]||ma.toLowerCase();ua in J.attributes||ra.push(S(fa[ma],ua))}void 0===O.indices||J.index||(ma=W.getDependency("accessor",O.indices).then(function(ua){J.setIndex(ua)}),
ra.push(ma));na.ColorManagement.workingColorSpace!==na.LinearSRGBColorSpace&&"COLOR_0"in fa&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${na.ColorManagement.workingColorSpace}" not supported.`);M(J,O);$a(J,O,W);return Promise.all(ra).then(function(){return void 0!==O.targets?v(J,O.targets,W):J})}Object.defineProperties(ba,{__esModule:{enumerable:!0,value:!0},GLTFLoader:{enumerable:!0,get:function(){return tc}}});var na=Sd(10),bb=Sd(21);class tc extends na.Loader{constructor(J){super(J);
this.meshoptDecoder=this.ktx2Loader=this.dracoLoader=null;this.pluginCallbacks=[];this.register(function(O){return new Fb(O)});this.register(function(O){return new zb(O)});this.register(function(O){return new xc(O)});this.register(function(O){return new Nc(O)});this.register(function(O){return new pd(O)});this.register(function(O){return new bc(O)});this.register(function(O){return new Hc(O)});this.register(function(O){return new Jc(O)});this.register(function(O){return new id(O)});this.register(function(O){return new Ib(O)});
this.register(function(O){return new sd(O)});this.register(function(O){return new lc(O)});this.register(function(O){return new dc(O)});this.register(function(O){return new Dc(O)});this.register(function(O){return new Pa(O)});this.register(function(O){return new Ic(O)});this.register(function(O){return new Rc(O)})}load(J,O,W,S){const fa=this;let ra;if(""!==this.resourcePath)ra=this.resourcePath;else if(""!==this.path){var ma=na.LoaderUtils.extractUrlBase(J);ra=na.LoaderUtils.resolveURL(ma,this.path)}else ra=
na.LoaderUtils.extractUrlBase(J);this.manager.itemStart(J);const ua=function(Aa){S?S(Aa):console.error(Aa);fa.manager.itemError(J);fa.manager.itemEnd(J)};ma=new na.FileLoader(this.manager);ma.setPath(this.path);ma.setResponseType("arraybuffer");ma.setRequestHeader(this.requestHeader);ma.setWithCredentials(this.withCredentials);ma.load(J,function(Aa){try{fa.parse(Aa,ra,function(Ua){O(Ua);fa.manager.itemEnd(J)},ua)}catch(Ua){ua(Ua)}},W,ua)}setDRACOLoader(J){this.dracoLoader=J;return this}setKTX2Loader(J){this.ktx2Loader=
J;return this}setMeshoptDecoder(J){this.meshoptDecoder=J;return this}register(J){-1===this.pluginCallbacks.indexOf(J)&&this.pluginCallbacks.push(J);return this}unregister(J){-1!==this.pluginCallbacks.indexOf(J)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(J),1);return this}parse(J,O,W,S){const fa={},ra={};var ma=new TextDecoder;if("string"===typeof J)J=JSON.parse(J);else if(J instanceof ArrayBuffer)if("glTF"===ma.decode(new Uint8Array(J,0,4))){try{fa[vb.KHR_BINARY_GLTF]=new Kb(J)}catch(Aa){S&&
S(Aa);return}J=JSON.parse(fa[vb.KHR_BINARY_GLTF].content)}else J=JSON.parse(ma.decode(J));if(void 0===J.asset||2>J.asset.version[0])S&&S(Error("THREE.GLTFLoader: Unsupported asset. glTF versions \x3e\x3d2.0 are supported."));else{O=new da(J,{path:O||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});O.fileLoader.setRequestHeader(this.requestHeader);for(ma=0;ma<this.pluginCallbacks.length;ma++){var ua=
this.pluginCallbacks[ma](O);ua.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name");ra[ua.name]=ua;fa[ua.name]=!0}if(J.extensionsUsed)for(ma=0;ma<J.extensionsUsed.length;++ma){ua=J.extensionsUsed[ma];const Aa=J.extensionsRequired||[];switch(ua){case vb.KHR_MATERIALS_UNLIT:fa[ua]=new yb;break;case vb.KHR_DRACO_MESH_COMPRESSION:fa[ua]=new Ma(J,this.dracoLoader);break;case vb.KHR_TEXTURE_TRANSFORM:fa[ua]=new jb;break;case vb.KHR_MESH_QUANTIZATION:fa[ua]=new sc;break;default:0<=
Aa.indexOf(ua)&&void 0===ra[ua]&&console.warn('THREE.GLTFLoader: Unknown extension "'+ua+'".')}}O.setExtensions(fa);O.setPlugins(ra);O.parse(W,S)}}parseAsync(J,O){const W=this;return new Promise(function(S,fa){W.parse(J,O,S,fa)})}}const vb={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",
KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",
EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Pa{constructor(J){this.parser=J;this.name=vb.KHR_LIGHTS_PUNCTUAL;this.cache={refs:{},uses:{}}}_markDefs(){const J=this.parser,O=this.parser.json.nodes||[];for(let W=0,S=O.length;W<S;W++){const fa=O[W];fa.extensions&&fa.extensions[this.name]&&void 0!==fa.extensions[this.name].light&&
J._addNodeRef(this.cache,fa.extensions[this.name].light)}}_loadLight(J){const O=this.parser,W="light:"+J;var S=O.cache.get(W);if(S)return S;S=O.json;S=((S.extensions&&S.extensions[this.name]||{}).lights||[])[J];var fa=new na.Color(16777215);void 0!==S.color&&fa.setRGB(S.color[0],S.color[1],S.color[2],na.LinearSRGBColorSpace);const ra=void 0!==S.range?S.range:0;switch(S.type){case "directional":fa=new na.DirectionalLight(fa);fa.target.position.set(0,0,-1);fa.add(fa.target);break;case "point":fa=new na.PointLight(fa);
fa.distance=ra;break;case "spot":fa=new na.SpotLight(fa);fa.distance=ra;S.spot=S.spot||{};S.spot.innerConeAngle=void 0!==S.spot.innerConeAngle?S.spot.innerConeAngle:0;S.spot.outerConeAngle=void 0!==S.spot.outerConeAngle?S.spot.outerConeAngle:Math.PI/4;fa.angle=S.spot.outerConeAngle;fa.penumbra=1-S.spot.innerConeAngle/S.spot.outerConeAngle;fa.target.position.set(0,0,-1);fa.add(fa.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+S.type);}fa.position.set(0,0,0);fa.decay=
2;M(fa,S);void 0!==S.intensity&&(fa.intensity=S.intensity);fa.name=O.createUniqueName(S.name||"light_"+J);S=Promise.resolve(fa);O.cache.add(W,S);return S}getDependency(J,O){if("light"===J)return this._loadLight(O)}createNodeAttachment(J){const O=this,W=this.parser;J=W.json.nodes[J];const S=(J.extensions&&J.extensions[this.name]||{}).light;return void 0===S?null:this._loadLight(S).then(function(fa){return W._getNodeRef(O.cache,S,fa)})}}class yb{constructor(){this.name=vb.KHR_MATERIALS_UNLIT}getMaterialType(){return na.MeshBasicMaterial}extendParams(J,
O,W){const S=[];J.color=new na.Color(1,1,1);J.opacity=1;if(O=O.pbrMetallicRoughness){if(Array.isArray(O.baseColorFactor)){const fa=O.baseColorFactor;J.color.setRGB(fa[0],fa[1],fa[2],na.LinearSRGBColorSpace);J.opacity=fa[3]}void 0!==O.baseColorTexture&&S.push(W.assignTexture(J,"map",O.baseColorTexture,na.SRGBColorSpace))}return Promise.all(S)}}class Ib{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(J,O){J=this.parser.json.materials[J];if(!J.extensions||
!J.extensions[this.name])return Promise.resolve();J=J.extensions[this.name].emissiveStrength;void 0!==J&&(O.emissiveIntensity=J);return Promise.resolve()}}class Fb{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_CLEARCOAT}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){var W=this.parser,S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];
void 0!==S.clearcoatFactor&&(O.clearcoat=S.clearcoatFactor);void 0!==S.clearcoatTexture&&J.push(W.assignTexture(O,"clearcoatMap",S.clearcoatTexture));void 0!==S.clearcoatRoughnessFactor&&(O.clearcoatRoughness=S.clearcoatRoughnessFactor);void 0!==S.clearcoatRoughnessTexture&&J.push(W.assignTexture(O,"clearcoatRoughnessMap",S.clearcoatRoughnessTexture));void 0!==S.clearcoatNormalTexture&&(J.push(W.assignTexture(O,"clearcoatNormalMap",S.clearcoatNormalTexture)),void 0!==S.clearcoatNormalTexture.scale&&
(W=S.clearcoatNormalTexture.scale,O.clearcoatNormalScale=new na.Vector2(W,W)));return Promise.all(J)}}class zb{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_DISPERSION}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){J=this.parser.json.materials[J];if(!J.extensions||!J.extensions[this.name])return Promise.resolve();J=J.extensions[this.name];O.dispersion=void 0!==J.dispersion?J.dispersion:
0;return Promise.resolve()}}class lc{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_IRIDESCENCE}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];void 0!==S.iridescenceFactor&&(O.iridescence=S.iridescenceFactor);void 0!==S.iridescenceTexture&&J.push(W.assignTexture(O,
"iridescenceMap",S.iridescenceTexture));void 0!==S.iridescenceIor&&(O.iridescenceIOR=S.iridescenceIor);void 0===O.iridescenceThicknessRange&&(O.iridescenceThicknessRange=[100,400]);void 0!==S.iridescenceThicknessMinimum&&(O.iridescenceThicknessRange[0]=S.iridescenceThicknessMinimum);void 0!==S.iridescenceThicknessMaximum&&(O.iridescenceThicknessRange[1]=S.iridescenceThicknessMaximum);void 0!==S.iridescenceThicknessTexture&&J.push(W.assignTexture(O,"iridescenceThicknessMap",S.iridescenceThicknessTexture));
return Promise.all(J)}}class bc{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_SHEEN}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];O.sheenColor=new na.Color(0,0,0);O.sheenRoughness=0;O.sheen=1;S=S.extensions[this.name];if(void 0!==S.sheenColorFactor){const fa=S.sheenColorFactor;
O.sheenColor.setRGB(fa[0],fa[1],fa[2],na.LinearSRGBColorSpace)}void 0!==S.sheenRoughnessFactor&&(O.sheenRoughness=S.sheenRoughnessFactor);void 0!==S.sheenColorTexture&&J.push(W.assignTexture(O,"sheenColorMap",S.sheenColorTexture,na.SRGBColorSpace));void 0!==S.sheenRoughnessTexture&&J.push(W.assignTexture(O,"sheenRoughnessMap",S.sheenRoughnessTexture));return Promise.all(J)}}class Hc{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_TRANSMISSION}getMaterialType(J){J=this.parser.json.materials[J];
return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];void 0!==S.transmissionFactor&&(O.transmission=S.transmissionFactor);void 0!==S.transmissionTexture&&J.push(W.assignTexture(O,"transmissionMap",S.transmissionTexture));return Promise.all(J)}}class Jc{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_VOLUME}getMaterialType(J){J=
this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){var W=this.parser,S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];O.thickness=void 0!==S.thicknessFactor?S.thicknessFactor:0;void 0!==S.thicknessTexture&&J.push(W.assignTexture(O,"thicknessMap",S.thicknessTexture));O.attenuationDistance=S.attenuationDistance||Infinity;W=S.attenuationColor||[1,1,1];
O.attenuationColor=(new na.Color).setRGB(W[0],W[1],W[2],na.LinearSRGBColorSpace);return Promise.all(J)}}class id{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_IOR}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){J=this.parser.json.materials[J];if(!J.extensions||!J.extensions[this.name])return Promise.resolve();J=J.extensions[this.name];O.ior=void 0!==J.ior?J.ior:1.5;return Promise.resolve()}}
class sd{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_SPECULAR}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];O.specularIntensity=void 0!==S.specularFactor?S.specularFactor:1;void 0!==S.specularTexture&&J.push(W.assignTexture(O,"specularIntensityMap",
S.specularTexture));const fa=S.specularColorFactor||[1,1,1];O.specularColor=(new na.Color).setRGB(fa[0],fa[1],fa[2],na.LinearSRGBColorSpace);void 0!==S.specularColorTexture&&J.push(W.assignTexture(O,"specularColorMap",S.specularColorTexture,na.SRGBColorSpace));return Promise.all(J)}}class Dc{constructor(J){this.parser=J;this.name=vb.EXT_MATERIALS_BUMP}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,
O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];O.bumpScale=void 0!==S.bumpFactor?S.bumpFactor:1;void 0!==S.bumpTexture&&J.push(W.assignTexture(O,"bumpMap",S.bumpTexture));return Promise.all(J)}}class dc{constructor(J){this.parser=J;this.name=vb.KHR_MATERIALS_ANISOTROPY}getMaterialType(J){J=this.parser.json.materials[J];return J.extensions&&J.extensions[this.name]?na.MeshPhysicalMaterial:null}extendMaterialParams(J,
O){const W=this.parser;var S=W.json.materials[J];if(!S.extensions||!S.extensions[this.name])return Promise.resolve();J=[];S=S.extensions[this.name];void 0!==S.anisotropyStrength&&(O.anisotropy=S.anisotropyStrength);void 0!==S.anisotropyRotation&&(O.anisotropyRotation=S.anisotropyRotation);void 0!==S.anisotropyTexture&&J.push(W.assignTexture(O,"anisotropyMap",S.anisotropyTexture));return Promise.all(J)}}class xc{constructor(J){this.parser=J;this.name=vb.KHR_TEXTURE_BASISU}loadTexture(J){const O=this.parser,
W=O.json;var S=W.textures[J];if(!S.extensions||!S.extensions[this.name])return null;S=S.extensions[this.name];const fa=O.options.ktx2Loader;if(!fa){if(W.extensionsRequired&&0<=W.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return O.loadTextureImage(J,S.source,fa)}}class Nc{constructor(J){this.parser=J;this.name=vb.EXT_TEXTURE_WEBP;this.isSupported=null}loadTexture(J){const O=this.name,W=this.parser,S=W.json;
var fa=S.textures[J];if(!fa.extensions||!fa.extensions[O])return null;const ra=fa.extensions[O];fa=S.images[ra.source];let ma=W.textureLoader;fa.uri&&(fa=W.options.manager.getHandler(fa.uri),null!==fa&&(ma=fa));return this.detectSupport().then(function(ua){if(ua)return W.loadTextureImage(J,ra.source,ma);if(S.extensionsRequired&&0<=S.extensionsRequired.indexOf(O))throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return W.loadTexture(J)})}detectSupport(){this.isSupported||(this.isSupported=
new Promise(function(J){const O=new Image;O.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";O.onload=O.onerror=function(){J(1===O.height)}}));return this.isSupported}}class pd{constructor(J){this.parser=J;this.name=vb.EXT_TEXTURE_AVIF;this.isSupported=null}loadTexture(J){const O=this.name,W=this.parser,S=W.json;var fa=S.textures[J];if(!fa.extensions||!fa.extensions[O])return null;const ra=fa.extensions[O];fa=S.images[ra.source];let ma=W.textureLoader;fa.uri&&
(fa=W.options.manager.getHandler(fa.uri),null!==fa&&(ma=fa));return this.detectSupport().then(function(ua){if(ua)return W.loadTextureImage(J,ra.source,ma);if(S.extensionsRequired&&0<=S.extensionsRequired.indexOf(O))throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return W.loadTexture(J)})}detectSupport(){this.isSupported||(this.isSupported=new Promise(function(J){const O=new Image;O.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI\x3d";
O.onload=O.onerror=function(){J(1===O.height)}}));return this.isSupported}}class Ic{constructor(J){this.name=vb.EXT_MESHOPT_COMPRESSION;this.parser=J}loadBufferView(J){const O=this.parser.json;J=O.bufferViews[J];if(J.extensions&&J.extensions[this.name]){const W=J.extensions[this.name];J=this.parser.getDependency("buffer",W.buffer);const S=this.parser.options.meshoptDecoder;if(!S||!S.supported){if(O.extensionsRequired&&0<=O.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");
return null}return J.then(function(fa){const ra=W.count,ma=W.byteStride,ua=new Uint8Array(fa,W.byteOffset||0,W.byteLength||0);return S.decodeGltfBufferAsync?S.decodeGltfBufferAsync(ra,ma,ua,W.mode,W.filter).then(function(Aa){return Aa.buffer}):S.ready.then(function(){const Aa=new ArrayBuffer(ra*ma);S.decodeGltfBuffer(new Uint8Array(Aa),ra,ma,ua,W.mode,W.filter);return Aa})})}return null}}class Rc{constructor(J){this.name=vb.EXT_MESH_GPU_INSTANCING;this.parser=J}createNodeMesh(J){var O=this.parser.json,
W=O.nodes[J];if(!W.extensions||!W.extensions[this.name]||void 0===W.mesh)return null;O=O.meshes[W.mesh];for(var S of O.primitives)if(S.mode!==Vc.TRIANGLES&&S.mode!==Vc.TRIANGLE_STRIP&&S.mode!==Vc.TRIANGLE_FAN&&void 0!==S.mode)return null;W=W.extensions[this.name].attributes;S=[];const fa={};for(const ra in W)S.push(this.parser.getDependency("accessor",W[ra]).then(ma=>{fa[ra]=ma;return fa[ra]}));if(1>S.length)return null;S.push(this.parser.createNodeMesh(J));return Promise.all(S).then(ra=>{const ma=
ra.pop();var ua=ma.isGroup?ma.children:[ma];ra=ra[0].count;const Aa=[];for(const fb of ua){var Ua=new na.Matrix4;const pb=new na.Vector3,Rb=new na.Quaternion,ec=new na.Vector3(1,1,1);ua=new na.InstancedMesh(fb.geometry,fb.material,ra);for(let kc=0;kc<ra;kc++)fa.TRANSLATION&&pb.fromBufferAttribute(fa.TRANSLATION,kc),fa.ROTATION&&Rb.fromBufferAttribute(fa.ROTATION,kc),fa.SCALE&&ec.fromBufferAttribute(fa.SCALE,kc),ua.setMatrixAt(kc,Ua.compose(pb,Rb,ec));for(const kc in fa)"_COLOR_0"===kc?(Ua=fa[kc],
ua.instanceColor=new na.InstancedBufferAttribute(Ua.array,Ua.itemSize,Ua.normalized)):"TRANSLATION"!==kc&&"ROTATION"!==kc&&"SCALE"!==kc&&fb.geometry.setAttribute(kc,fa[kc]);na.Object3D.prototype.copy.call(ua,fb);this.parser.assignFinalMaterial(ua);Aa.push(ua)}return ma.isGroup?(ma.clear(),ma.add(...Aa),ma):Aa[0]})}}class Kb{constructor(J){this.name=vb.KHR_BINARY_GLTF;this.body=this.content=null;var O=new DataView(J,0,12);const W=new TextDecoder;this.header={magic:W.decode(new Uint8Array(J.slice(0,
4))),version:O.getUint32(4,!0),length:O.getUint32(8,!0)};if("glTF"!==this.header.magic)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");O=this.header.length-12;const S=new DataView(J,12);let fa=0;for(;fa<O;){const ma=S.getUint32(fa,!0);fa+=4;var ra=S.getUint32(fa,!0);fa+=4;1313821514===ra?(ra=new Uint8Array(J,12+fa,ma),this.content=W.decode(ra)):5130562===ra&&(ra=12+fa,this.body=J.slice(ra,ra+ma));
fa+=ma}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.");}}class Ma{constructor(J,O){if(!O)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=vb.KHR_DRACO_MESH_COMPRESSION;this.json=J;this.dracoLoader=O;this.dracoLoader.preload()}decodePrimitive(J,O){const W=this.json,S=this.dracoLoader,fa=J.extensions[this.name].bufferView,ra=J.extensions[this.name].attributes,ma={},ua={},Aa={};for(var Ua in ra){var fb=Gd[Ua]||Ua.toLowerCase();ma[fb]=ra[Ua]}for(const pb in J.attributes)Ua=
Gd[pb]||pb.toLowerCase(),void 0!==ra[pb]&&(fb=W.accessors[J.attributes[pb]],Aa[Ua]=yc[fb.componentType].name,ua[Ua]=!0===fb.normalized);return O.getDependency("bufferView",fa).then(function(pb){return new Promise(function(Rb,ec){S.decodeDracoFile(pb,function(kc){for(const fc in kc.attributes){const Gc=kc.attributes[fc],Fc=ua[fc];void 0!==Fc&&(Gc.normalized=Fc)}Rb(kc)},ma,Aa,na.LinearSRGBColorSpace,ec)})})}}class jb{constructor(){this.name=vb.KHR_TEXTURE_TRANSFORM}extendTexture(J,O){if((void 0===O.texCoord||
O.texCoord===J.channel)&&void 0===O.offset&&void 0===O.rotation&&void 0===O.scale)return J;J=J.clone();void 0!==O.texCoord&&(J.channel=O.texCoord);void 0!==O.offset&&J.offset.fromArray(O.offset);void 0!==O.rotation&&(J.rotation=O.rotation);void 0!==O.scale&&J.repeat.fromArray(O.scale);J.needsUpdate=!0;return J}}class sc{constructor(){this.name=vb.KHR_MESH_QUANTIZATION}}class Ac extends na.Interpolant{constructor(J,O,W,S){super(J,O,W,S)}copySampleValue_(J){const O=this.resultBuffer,W=this.sampleValues,
S=this.valueSize;J=J*S*3+S;for(let fa=0;fa!==S;fa++)O[fa]=W[J+fa];return O}interpolate_(J,O,W,S){const fa=this.resultBuffer,ra=this.sampleValues,ma=this.valueSize,ua=2*ma;var Aa=3*ma;S-=O;O=(W-O)/S;W=O*O;var Ua=W*O;J*=Aa;Aa=J-Aa;const fb=-2*Ua+3*W;Ua-=W;const pb=1-fb;O=Ua-W+O;for(W=0;W!==ma;W++)fa[W]=pb*ra[Aa+W+ma]+O*ra[Aa+W+ua]*S+fb*ra[J+W+ma]+Ua*ra[J+W]*S;return fa}}const Tc=new na.Quaternion;class od extends Ac{interpolate_(J,O,W,S){J=super.interpolate_(J,O,W,S);Tc.fromArray(J).normalize().toArray(J);
return J}}const Vc={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},yc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Pc={9728:na.NearestFilter,9729:na.LinearFilter,9984:na.NearestMipmapNearestFilter,9985:na.LinearMipmapNearestFilter,
9986:na.NearestMipmapLinearFilter,9987:na.LinearMipmapLinearFilter},td={33071:na.ClampToEdgeWrapping,33648:na.MirroredRepeatWrapping,10497:na.RepeatWrapping},Cd={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gd={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},pe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qe={CUBICSPLINE:void 0,
LINEAR:na.InterpolateLinear,STEP:na.InterpolateDiscrete},gf=new na.Matrix4;class da{constructor(J={},O={}){this.json=J;this.extensions={};this.plugins={};this.options=O;this.cache=new Na;this.associations=new Map;this.primitiveCache={};this.nodeCache={};this.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};this.lightCache={refs:{},uses:{}};this.sourceCache={};this.textureCache={};this.nodeNamesUsed={};J=!1;O=-1;let W=!1;var S=-1;"undefined"!==typeof navigator&&(S=navigator.userAgent,
J=!0===/^((?!chrome|android).)*safari/i.test(S),O=S.match(/Version\/(\d+)/),O=J&&O?parseInt(O[1],10):-1,S=(W=-1<S.indexOf("Firefox"))?S.match(/Firefox\/([0-9]+)\./)[1]:-1);this.textureLoader="undefined"===typeof createImageBitmap||J&&17>O||W&&98>S?new na.TextureLoader(this.options.manager):new na.ImageBitmapLoader(this.options.manager);this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.textureLoader.setRequestHeader(this.options.requestHeader);this.fileLoader=new na.FileLoader(this.options.manager);
this.fileLoader.setResponseType("arraybuffer");"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(J){this.extensions=J}setPlugins(J){this.plugins=J}parse(J,O){const W=this,S=this.json,fa=this.extensions;this.cache.removeAll();this.nodeCache={};this._invokeAll(function(ra){return ra._markDefs&&ra._markDefs()});Promise.all(this._invokeAll(function(ra){return ra.beforeRoot&&ra.beforeRoot()})).then(function(){return Promise.all([W.getDependencies("scene"),
W.getDependencies("animation"),W.getDependencies("camera")])}).then(function(ra){const ma={scene:ra[0][S.scene||0],scenes:ra[0],animations:ra[1],cameras:ra[2],asset:S.asset,parser:W,userData:{}};hb(fa,ma,S);M(ma,S);return Promise.all(W._invokeAll(function(ua){return ua.afterRoot&&ua.afterRoot(ma)})).then(function(){for(const ua of ma.scenes)ua.updateMatrixWorld();J(ma)})}).catch(O)}_markDefs(){const J=this.json.nodes||[];var O=this.json.skins||[];const W=this.json.meshes||[];for(let S=0,fa=O.length;S<
fa;S++){const ra=O[S].joints;for(let ma=0,ua=ra.length;ma<ua;ma++)J[ra[ma]].isBone=!0}for(let S=0,fa=J.length;S<fa;S++)O=J[S],void 0!==O.mesh&&(this._addNodeRef(this.meshCache,O.mesh),void 0!==O.skin&&(W[O.mesh].isSkinnedMesh=!0)),void 0!==O.camera&&this._addNodeRef(this.cameraCache,O.camera)}_addNodeRef(J,O){void 0!==O&&(void 0===J.refs[O]&&(J.refs[O]=J.uses[O]=0),J.refs[O]++)}_getNodeRef(J,O,W){if(1>=J.refs[O])return W;const S=W.clone(),fa=(ra,ma)=>{const ua=this.associations.get(ra);null!=ua&&
this.associations.set(ma,ua);for(const [Aa,Ua]of ra.children.entries())fa(Ua,ma.children[Aa])};fa(W,S);S.name+="_instance_"+J.uses[O]++;return S}_invokeOne(J){const O=Object.values(this.plugins);O.push(this);for(let W=0;W<O.length;W++){const S=J(O[W]);if(S)return S}return null}_invokeAll(J){const O=Object.values(this.plugins);O.unshift(this);const W=[];for(let S=0;S<O.length;S++){const fa=J(O[S]);fa&&W.push(fa)}return W}getDependency(J,O){const W=J+":"+O;let S=this.cache.get(W);if(!S){switch(J){case "scene":S=
this.loadScene(O);break;case "node":S=this._invokeOne(function(fa){return fa.loadNode&&fa.loadNode(O)});break;case "mesh":S=this._invokeOne(function(fa){return fa.loadMesh&&fa.loadMesh(O)});break;case "accessor":S=this.loadAccessor(O);break;case "bufferView":S=this._invokeOne(function(fa){return fa.loadBufferView&&fa.loadBufferView(O)});break;case "buffer":S=this.loadBuffer(O);break;case "material":S=this._invokeOne(function(fa){return fa.loadMaterial&&fa.loadMaterial(O)});break;case "texture":S=
this._invokeOne(function(fa){return fa.loadTexture&&fa.loadTexture(O)});break;case "skin":S=this.loadSkin(O);break;case "animation":S=this._invokeOne(function(fa){return fa.loadAnimation&&fa.loadAnimation(O)});break;case "camera":S=this.loadCamera(O);break;default:if(S=this._invokeOne(function(fa){return fa!=this&&fa.getDependency&&fa.getDependency(J,O)}),!S)throw Error("Unknown type: "+J);}this.cache.add(W,S)}return S}getDependencies(J){let O=this.cache.get(J);if(!O){const W=this;O=Promise.all((this.json[J+
("mesh"===J?"es":"s")]||[]).map(function(S,fa){return W.getDependency(J,fa)}));this.cache.add(J,O)}return O}loadBuffer(J){const O=this.json.buffers[J],W=this.fileLoader;if(O.type&&"arraybuffer"!==O.type)throw Error("THREE.GLTFLoader: "+O.type+" buffer type is not supported.");if(void 0===O.uri&&0===J)return Promise.resolve(this.extensions[vb.KHR_BINARY_GLTF].body);const S=this.options;return new Promise(function(fa,ra){W.load(na.LoaderUtils.resolveURL(O.uri,S.path),fa,void 0,function(){ra(Error('THREE.GLTFLoader: Failed to load buffer "'+
O.uri+'".'))})})}loadBufferView(J){const O=this.json.bufferViews[J];return this.getDependency("buffer",O.buffer).then(function(W){const S=O.byteOffset||0;return W.slice(S,S+(O.byteLength||0))})}loadAccessor(J){const O=this,W=this.json,S=this.json.accessors[J];if(void 0===S.bufferView&&void 0===S.sparse){J=Cd[S.type];const fa=!0===S.normalized,ra=new yc[S.componentType](S.count*J);return Promise.resolve(new na.BufferAttribute(ra,J,fa))}J=[];void 0!==S.bufferView?J.push(this.getDependency("bufferView",
S.bufferView)):J.push(null);void 0!==S.sparse&&(J.push(this.getDependency("bufferView",S.sparse.indices.bufferView)),J.push(this.getDependency("bufferView",S.sparse.values.bufferView)));return Promise.all(J).then(function(fa){var ra=fa[0];const ma=Cd[S.type],ua=yc[S.componentType];var Aa=ua.BYTES_PER_ELEMENT,Ua=S.byteOffset||0,fb=void 0!==S.bufferView?W.bufferViews[S.bufferView].byteStride:void 0;const pb=!0===S.normalized;if(fb&&fb!==Aa*ma){var Rb=Math.floor(Ua/fb);const ec="InterleavedBuffer:"+
S.bufferView+":"+S.componentType+":"+Rb+":"+S.count;let kc=O.cache.get(ec);kc||(Rb=new ua(ra,Rb*fb,S.count*fb/Aa),kc=new na.InterleavedBuffer(Rb,fb/Aa),O.cache.add(ec,kc));Aa=new na.InterleavedBufferAttribute(kc,ma,Ua%fb/Aa,pb)}else Rb=null===ra?new ua(S.count*ma):new ua(ra,Ua,S.count*ma),Aa=new na.BufferAttribute(Rb,ma,pb);if(void 0!==S.sparse){fb=S.sparse.values.byteOffset||0;Ua=new yc[S.sparse.indices.componentType](fa[1],S.sparse.indices.byteOffset||0,S.sparse.count*Cd.SCALAR);fa=new ua(fa[2],
fb,S.sparse.count*ma);null!==ra&&(Aa=new na.BufferAttribute(Aa.array.slice(),Aa.itemSize,Aa.normalized));Aa.normalized=!1;for(let ec=0,kc=Ua.length;ec<kc;ec++)if(ra=Ua[ec],Aa.setX(ra,fa[ec*ma]),2<=ma&&Aa.setY(ra,fa[ec*ma+1]),3<=ma&&Aa.setZ(ra,fa[ec*ma+2]),4<=ma&&Aa.setW(ra,fa[ec*ma+3]),5<=ma)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.");Aa.normalized=pb}return Aa})}loadTexture(J){var O=this.json,W=this.options;const S=O.textures[J].source,fa=O.images[S];O=this.textureLoader;
fa.uri&&(W=W.manager.getHandler(fa.uri),null!==W&&(O=W));return this.loadTextureImage(J,S,O)}loadTextureImage(J,O,W){const S=this,fa=this.json,ra=fa.textures[J],ma=fa.images[O],ua=(ma.uri||ma.bufferView)+":"+ra.sampler;if(this.textureCache[ua])return this.textureCache[ua];O=this.loadImageSource(O,W).then(function(Aa){Aa.flipY=!1;Aa.name=ra.name||ma.name||"";""===Aa.name&&"string"===typeof ma.uri&&!1===ma.uri.startsWith("data:image/")&&(Aa.name=ma.uri);const Ua=(fa.samplers||{})[ra.sampler]||{};Aa.magFilter=
Pc[Ua.magFilter]||na.LinearFilter;Aa.minFilter=Pc[Ua.minFilter]||na.LinearMipmapLinearFilter;Aa.wrapS=td[Ua.wrapS]||na.RepeatWrapping;Aa.wrapT=td[Ua.wrapT]||na.RepeatWrapping;S.associations.set(Aa,{textures:J});return Aa}).catch(function(){return null});return this.textureCache[ua]=O}loadImageSource(J,O){var W=this.json;const S=this.options;if(void 0!==this.sourceCache[J])return this.sourceCache[J].then(Aa=>Aa.clone());const fa=W.images[J],ra=self.URL||self.webkitURL;let ma=fa.uri||"",ua=!1;if(void 0!==
fa.bufferView)ma=this.getDependency("bufferView",fa.bufferView).then(function(Aa){ua=!0;Aa=new Blob([Aa],{type:fa.mimeType});return ma=ra.createObjectURL(Aa)});else if(void 0===fa.uri)throw Error("THREE.GLTFLoader: Image "+J+" is missing URI and bufferView");W=Promise.resolve(ma).then(function(Aa){return new Promise(function(Ua,fb){let pb=Ua;!0===O.isImageBitmapLoader&&(pb=function(Rb){Rb=new na.Texture(Rb);Rb.needsUpdate=!0;Ua(Rb)});O.load(na.LoaderUtils.resolveURL(Aa,S.path),pb,void 0,fb)})}).then(function(Aa){!0===
ua&&ra.revokeObjectURL(ma);M(Aa,fa);var Ua=Aa.userData,fb;(fb=fa.mimeType)||(fb=fa.uri,fb=0<fb.search(/\.jpe?g($|\?)/i)||0===fb.search(/^data:image\/jpeg/)?"image/jpeg":0<fb.search(/\.webp($|\?)/i)||0===fb.search(/^data:image\/webp/)?"image/webp":"image/png");Ua.mimeType=fb;return Aa}).catch(function(Aa){console.error("THREE.GLTFLoader: Couldn't load texture",ma);throw Aa;});return this.sourceCache[J]=W}assignTexture(J,O,W,S){const fa=this;return this.getDependency("texture",W.index).then(function(ra){if(!ra)return null;
void 0!==W.texCoord&&0<W.texCoord&&(ra=ra.clone(),ra.channel=W.texCoord);if(fa.extensions[vb.KHR_TEXTURE_TRANSFORM]){const ma=void 0!==W.extensions?W.extensions[vb.KHR_TEXTURE_TRANSFORM]:void 0;if(ma){const ua=fa.associations.get(ra);ra=fa.extensions[vb.KHR_TEXTURE_TRANSFORM].extendTexture(ra,ma);fa.associations.set(ra,ua)}}void 0!==S&&(ra.colorSpace=S);return J[O]=ra})}assignFinalMaterial(J){var O=J.geometry;let W=J.material;const S=void 0===O.attributes.tangent,fa=void 0!==O.attributes.color;O=
void 0===O.attributes.normal;if(J.isPoints){var ra="PointsMaterial:"+W.uuid,ma=this.cache.get(ra);ma||(ma=new na.PointsMaterial,na.Material.prototype.copy.call(ma,W),ma.color.copy(W.color),ma.map=W.map,ma.sizeAttenuation=!1,this.cache.add(ra,ma));W=ma}else J.isLine&&(ra="LineBasicMaterial:"+W.uuid,ma=this.cache.get(ra),ma||(ma=new na.LineBasicMaterial,na.Material.prototype.copy.call(ma,W),ma.color.copy(W.color),ma.map=W.map,this.cache.add(ra,ma)),W=ma);if(S||fa||O)ra="ClonedMaterial:"+W.uuid+":",
S&&(ra+="derivative-tangents:"),fa&&(ra+="vertex-colors:"),O&&(ra+="flat-shading:"),ma=this.cache.get(ra),ma||(ma=W.clone(),fa&&(ma.vertexColors=!0),O&&(ma.flatShading=!0),S&&(ma.normalScale&&(ma.normalScale.y*=-1),ma.clearcoatNormalScale&&(ma.clearcoatNormalScale.y*=-1)),this.cache.add(ra,ma),this.associations.set(ma,this.associations.get(W))),W=ma;J.material=W}getMaterialType(){return na.MeshStandardMaterial}loadMaterial(J){const O=this,W=this.extensions,S=this.json.materials[J];let fa;const ra=
{},ma=[];if((S.extensions||{})[vb.KHR_MATERIALS_UNLIT]){var ua=W[vb.KHR_MATERIALS_UNLIT];fa=ua.getMaterialType();ma.push(ua.extendParams(ra,S,O))}else{ua=S.pbrMetallicRoughness||{};ra.color=new na.Color(1,1,1);ra.opacity=1;if(Array.isArray(ua.baseColorFactor)){const Aa=ua.baseColorFactor;ra.color.setRGB(Aa[0],Aa[1],Aa[2],na.LinearSRGBColorSpace);ra.opacity=Aa[3]}void 0!==ua.baseColorTexture&&ma.push(O.assignTexture(ra,"map",ua.baseColorTexture,na.SRGBColorSpace));ra.metalness=void 0!==ua.metallicFactor?
ua.metallicFactor:1;ra.roughness=void 0!==ua.roughnessFactor?ua.roughnessFactor:1;void 0!==ua.metallicRoughnessTexture&&(ma.push(O.assignTexture(ra,"metalnessMap",ua.metallicRoughnessTexture)),ma.push(O.assignTexture(ra,"roughnessMap",ua.metallicRoughnessTexture)));fa=this._invokeOne(function(Aa){return Aa.getMaterialType&&Aa.getMaterialType(J)});ma.push(Promise.all(this._invokeAll(function(Aa){return Aa.extendMaterialParams&&Aa.extendMaterialParams(J,ra)})))}!0===S.doubleSided&&(ra.side=na.DoubleSide);
ua=S.alphaMode||"OPAQUE";"BLEND"===ua?(ra.transparent=!0,ra.depthWrite=!1):(ra.transparent=!1,"MASK"===ua&&(ra.alphaTest=void 0!==S.alphaCutoff?S.alphaCutoff:.5));void 0!==S.normalTexture&&fa!==na.MeshBasicMaterial&&(ma.push(O.assignTexture(ra,"normalMap",S.normalTexture)),ra.normalScale=new na.Vector2(1,1),void 0!==S.normalTexture.scale&&(ua=S.normalTexture.scale,ra.normalScale.set(ua,ua)));void 0!==S.occlusionTexture&&fa!==na.MeshBasicMaterial&&(ma.push(O.assignTexture(ra,"aoMap",S.occlusionTexture)),
void 0!==S.occlusionTexture.strength&&(ra.aoMapIntensity=S.occlusionTexture.strength));void 0!==S.emissiveFactor&&fa!==na.MeshBasicMaterial&&(ua=S.emissiveFactor,ra.emissive=(new na.Color).setRGB(ua[0],ua[1],ua[2],na.LinearSRGBColorSpace));void 0!==S.emissiveTexture&&fa!==na.MeshBasicMaterial&&ma.push(O.assignTexture(ra,"emissiveMap",S.emissiveTexture,na.SRGBColorSpace));return Promise.all(ma).then(function(){const Aa=new fa(ra);S.name&&(Aa.name=S.name);M(Aa,S);O.associations.set(Aa,{materials:J});
S.extensions&&hb(W,Aa,S);return Aa})}createUniqueName(J){J=na.PropertyBinding.sanitizeNodeName(J||"");if(J in this.nodeNamesUsed)return J+"_"+ ++this.nodeNamesUsed[J];this.nodeNamesUsed[J]=0;return J}loadGeometries(J){function O(ua){return S[vb.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ua,W).then(function(Aa){return Sb(Aa,ua,W)})}const W=this,S=this.extensions,fa=this.primitiveCache,ra=[];for(let ua=0,Aa=J.length;ua<Aa;ua++){const Ua=J[ua],fb=ta(Ua);var ma=fa[fb];ma?ra.push(ma.promise):(ma=Ua.extensions&&
Ua.extensions[vb.KHR_DRACO_MESH_COMPRESSION]?O(Ua):Sb(new na.BufferGeometry,Ua,W),fa[fb]={primitive:Ua,promise:ma},ra.push(ma))}return Promise.all(ra)}loadMesh(J){const O=this,W=this.extensions,S=this.json.meshes[J],fa=S.primitives,ra=[];for(let ma=0,ua=fa.length;ma<ua;ma++){const Aa=void 0===fa[ma].material?qc(this.cache):this.getDependency("material",fa[ma].material);ra.push(Aa)}ra.push(O.loadGeometries(fa));return Promise.all(ra).then(function(ma){var ua=ma.slice(0,ma.length-1);const Aa=ma[ma.length-
1];ma=[];for(let pb=0,Rb=Aa.length;pb<Rb;pb++){var Ua=Aa[pb];const ec=fa[pb];var fb=void 0;fb=ua[pb];if(ec.mode===Vc.TRIANGLES||ec.mode===Vc.TRIANGLE_STRIP||ec.mode===Vc.TRIANGLE_FAN||void 0===ec.mode)fb=!0===S.isSkinnedMesh?new na.SkinnedMesh(Ua,fb):new na.Mesh(Ua,fb),!0===fb.isSkinnedMesh&&fb.normalizeSkinWeights(),ec.mode===Vc.TRIANGLE_STRIP?fb.geometry=(0,bb.toTrianglesDrawMode)(fb.geometry,na.TriangleStripDrawMode):ec.mode===Vc.TRIANGLE_FAN&&(fb.geometry=(0,bb.toTrianglesDrawMode)(fb.geometry,
na.TriangleFanDrawMode));else if(ec.mode===Vc.LINES)fb=new na.LineSegments(Ua,fb);else if(ec.mode===Vc.LINE_STRIP)fb=new na.Line(Ua,fb);else if(ec.mode===Vc.LINE_LOOP)fb=new na.LineLoop(Ua,fb);else if(ec.mode===Vc.POINTS)fb=new na.Points(Ua,fb);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+ec.mode);if(0<Object.keys(fb.geometry.morphAttributes).length){Ua=fb;Ua.updateMorphTargets();if(void 0!==S.weights)for(let kc=0,fc=S.weights.length;kc<fc;kc++)Ua.morphTargetInfluences[kc]=S.weights[kc];
if(S.extras&&Array.isArray(S.extras.targetNames)){const kc=S.extras.targetNames;if(Ua.morphTargetInfluences.length===kc.length){Ua.morphTargetDictionary={};for(let fc=0,Gc=kc.length;fc<Gc;fc++)Ua.morphTargetDictionary[kc[fc]]=fc}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}fb.name=O.createUniqueName(S.name||"mesh_"+J);M(fb,S);ec.extensions&&hb(W,fb,ec);O.assignFinalMaterial(fb);ma.push(fb)}for(let pb=0,Rb=ma.length;pb<Rb;pb++)O.associations.set(ma[pb],
{meshes:J,primitives:pb});if(1===ma.length)return S.extensions&&hb(W,ma[0],S),ma[0];ua=new na.Group;S.extensions&&hb(W,ua,S);O.associations.set(ua,{meshes:J});for(let pb=0,Rb=ma.length;pb<Rb;pb++)ua.add(ma[pb]);return ua})}loadCamera(J){let O;J=this.json.cameras[J];const W=J[J.type];if(W)return"perspective"===J.type?O=new na.PerspectiveCamera(na.MathUtils.radToDeg(W.yfov),W.aspectRatio||1,W.znear||1,W.zfar||2E6):"orthographic"===J.type&&(O=new na.OrthographicCamera(-W.xmag,W.xmag,W.ymag,-W.ymag,W.znear,
W.zfar)),J.name&&(O.name=this.createUniqueName(J.name)),M(O,J),Promise.resolve(O);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(J){const O=this.json.skins[J];J=[];for(let W=0,S=O.joints.length;W<S;W++)J.push(this._loadNodeShallow(O.joints[W]));void 0!==O.inverseBindMatrices?J.push(this.getDependency("accessor",O.inverseBindMatrices)):J.push(null);return Promise.all(J).then(function(W){const S=W.pop(),fa=[],ra=[];for(let ua=0,Aa=W.length;ua<Aa;ua++){var ma=W[ua];ma?(fa.push(ma),
ma=new na.Matrix4,null!==S&&ma.fromArray(S.array,16*ua),ra.push(ma)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',O.joints[ua])}return new na.Skeleton(fa,ra)})}loadAnimation(J){const O=this,W=this.json.animations[J],S=W.name?W.name:"animation_"+J;J=[];const fa=[],ra=[],ma=[],ua=[];for(let Ua=0,fb=W.channels.length;Ua<fb;Ua++){var Aa=W.channels[Ua];const pb=W.samplers[Aa.sampler];Aa=Aa.target;const Rb=void 0!==W.parameters?W.parameters[pb.input]:pb.input,ec=void 0!==W.parameters?
W.parameters[pb.output]:pb.output;void 0!==Aa.node&&(J.push(this.getDependency("node",Aa.node)),fa.push(this.getDependency("accessor",Rb)),ra.push(this.getDependency("accessor",ec)),ma.push(pb),ua.push(Aa))}return Promise.all([Promise.all(J),Promise.all(fa),Promise.all(ra),Promise.all(ma),Promise.all(ua)]).then(function(Ua){const fb=Ua[0],pb=Ua[1],Rb=Ua[2],ec=Ua[3];Ua=Ua[4];const kc=[];for(let Fc=0,Hd=fb.length;Fc<Hd;Fc++){var fc=fb[Fc],Gc=pb[Fc];const de=Rb[Fc],Me=ec[Fc],zg=Ua[Fc];if(void 0!==fc&&
(fc.updateMatrix&&fc.updateMatrix(),fc=O._createAnimationTracks(fc,Gc,de,Me,zg)))for(Gc=0;Gc<fc.length;Gc++)kc.push(fc[Gc])}return new na.AnimationClip(S,void 0,kc)})}createNodeMesh(J){const O=this,W=this.json.nodes[J];return void 0===W.mesh?null:O.getDependency("mesh",W.mesh).then(function(S){S=O._getNodeRef(O.meshCache,W.mesh,S);void 0!==W.weights&&S.traverse(function(fa){if(fa.isMesh)for(let ra=0,ma=W.weights.length;ra<ma;ra++)fa.morphTargetInfluences[ra]=W.weights[ra]});return S})}loadNode(J){var O=
this.json.nodes[J];J=this._loadNodeShallow(J);const W=[],S=O.children||[];for(let fa=0,ra=S.length;fa<ra;fa++)W.push(this.getDependency("node",S[fa]));O=void 0===O.skin?Promise.resolve(null):this.getDependency("skin",O.skin);return Promise.all([J,Promise.all(W),O]).then(function(fa){const ra=fa[0],ma=fa[1],ua=fa[2];null!==ua&&ra.traverse(function(Aa){Aa.isSkinnedMesh&&Aa.bind(ua,gf)});for(let Aa=0,Ua=ma.length;Aa<Ua;Aa++)ra.add(ma[Aa]);return ra})}_loadNodeShallow(J){const O=this.extensions,W=this;
if(void 0!==this.nodeCache[J])return this.nodeCache[J];const S=this.json.nodes[J],fa=S.name?W.createUniqueName(S.name):"",ra=[],ma=W._invokeOne(function(ua){return ua.createNodeMesh&&ua.createNodeMesh(J)});ma&&ra.push(ma);void 0!==S.camera&&ra.push(W.getDependency("camera",S.camera).then(function(ua){return W._getNodeRef(W.cameraCache,S.camera,ua)}));W._invokeAll(function(ua){return ua.createNodeAttachment&&ua.createNodeAttachment(J)}).forEach(function(ua){ra.push(ua)});this.nodeCache[J]=Promise.all(ra).then(function(ua){let Aa;
Aa=!0===S.isBone?new na.Bone:1<ua.length?new na.Group:1===ua.length?ua[0]:new na.Object3D;if(Aa!==ua[0])for(let Ua=0,fb=ua.length;Ua<fb;Ua++)Aa.add(ua[Ua]);S.name&&(Aa.userData.name=S.name,Aa.name=fa);M(Aa,S);S.extensions&&hb(O,Aa,S);void 0!==S.matrix?(ua=new na.Matrix4,ua.fromArray(S.matrix),Aa.applyMatrix4(ua)):(void 0!==S.translation&&Aa.position.fromArray(S.translation),void 0!==S.rotation&&Aa.quaternion.fromArray(S.rotation),void 0!==S.scale&&Aa.scale.fromArray(S.scale));W.associations.has(Aa)||
W.associations.set(Aa,{});W.associations.get(Aa).nodes=J;return Aa});return this.nodeCache[J]}loadScene(J){var O=this.extensions;J=this.json.scenes[J];const W=this,S=new na.Group;J.name&&(S.name=W.createUniqueName(J.name));M(S,J);J.extensions&&hb(O,S,J);O=J.nodes||[];J=[];for(let fa=0,ra=O.length;fa<ra;fa++)J.push(W.getDependency("node",O[fa]));return Promise.all(J).then(function(fa){for(let ra=0,ma=fa.length;ra<ma;ra++)S.add(fa[ra]);W.associations=(ra=>{const ma=new Map;for(const [ua,Aa]of W.associations)(ua instanceof
na.Material||ua instanceof na.Texture)&&ma.set(ua,Aa);ra.traverse(ua=>{const Aa=W.associations.get(ua);null!=Aa&&ma.set(ua,Aa)});return ma})(S);return S})}_createAnimationTracks(J,O,W,S,fa){const ra=[];var ma=J.name?J.name:J.uuid;const ua=[];pe[fa.path]===pe.weights?J.traverse(function(Aa){Aa.morphTargetInfluences&&ua.push(Aa.name?Aa.name:Aa.uuid)}):ua.push(ma);switch(pe[fa.path]){case pe.weights:J=na.NumberKeyframeTrack;break;case pe.rotation:J=na.QuaternionKeyframeTrack;break;case pe.position:case pe.scale:J=
na.VectorKeyframeTrack;break;default:switch(W.itemSize){case 1:J=na.NumberKeyframeTrack;break;default:J=na.VectorKeyframeTrack}}ma=void 0!==S.interpolation?qe[S.interpolation]:na.InterpolateLinear;W=this._getArrayFromAccessor(W);for(let Aa=0,Ua=ua.length;Aa<Ua;Aa++){const fb=new J(ua[Aa]+"."+pe[fa.path],O.array,W,ma);"CUBICSPLINE"===S.interpolation&&this._createCubicSplineTrackInterpolant(fb);ra.push(fb)}return ra}_getArrayFromAccessor(J){let O=J.array;if(J.normalized){J=Ab(O.constructor);const W=
new Float32Array(O.length);for(let S=0,fa=O.length;S<fa;S++)W[S]=O[S]*J;O=W}return O}_createCubicSplineTrackInterpolant(J){J.createInterpolant=function(O){return new (this instanceof na.QuaternionKeyframeTrack?od:Ac)(this.times,this.values,this.getValueSize()/3,O)};J.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}};
/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
'use strict';var h,aa=this||self;function m(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function ca(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function da(a){return Object.prototype.hasOwnProperty.call(a,ea)&&a[ea]||(a[ea]=++fa)}var ea="closure_uid_"+(1E9*Math.random()>>>0),fa=0;function ha(a,b,c){return a.call.apply(a.bind,arguments)}
function ia(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ja(a,b,c){ja=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return ja.apply(null,arguments)}
function ka(a,b){function c(){}c.prototype=b.prototype;a.wc=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(d,e,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[e].apply(d,g)}};function la(a){la[" "](a);return a}la[" "]=function(){};function ma(a){return/^[\s\xa0]*$/.test(a)}var na=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function oa(a){const b=[];let c=0;for(const d in a)b[c++]=d;return b}function pa(a,b,c){return null!==a&&b in a?a[b]:c}const ra="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function sa(a,b){let c,d;for(let e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(let f=0;f<ra.length;f++)c=ra[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function ta(){var a=aa.navigator;return a&&(a=a.userAgent)?a:""}function ua(a){return-1!=ta().indexOf(a)};const va=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(let c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function wa(a,b){a.sort(b||xa)}function za(a,b){const c=Array(a.length);for(let e=0;e<a.length;e++)c[e]={index:e,value:a[e]};const d=b||xa;wa(c,function(e,f){return d(e.value,f.value)||e.index-f.index});for(b=0;b<a.length;b++)a[b]=c[b].value}
function xa(a,b){return a>b?1:a<b?-1:0};function Aa(a,b){null!=a&&this.append.apply(this,arguments)}h=Aa.prototype;h.Ra="";h.set=function(a){this.Ra=""+a};h.append=function(a,b,c){this.Ra+=String(a);if(null!=b)for(let d=1;d<arguments.length;d++)this.Ra+=arguments[d];return this};h.clear=function(){this.Ra=""};h.toString=function(){return this.Ra};var n={},Ba=null;function Ca(){return new r(null,5,[Da,!0,Ea,!0,Fa,!1,Ga,!1,Ha,null],null)}function u(a){return null!=a&&!1!==a}function Ia(a){return null==a}function Ja(a){return a instanceof Array}function Ka(a){return null==a?!0:!1===a?!0:!1}function La(a){return null!=a?a.constructor===Object:!1}function v(a,b){return a[m(null==b?null:b)]?!0:a._?!0:!1}function Ma(a){return null==a?null:a.constructor}
function x(a,b){var c=Ma(b);return Error(["No protocol method ",a," defined for type ",u(u(c)?c.Hc:c)?c.Yb:m(b),": ",b].join(""))}function Na(a){var b=a.Yb;return u(b)?b:y.j(a)}var Pa="undefined"!==typeof Symbol&&"function"===m(Symbol)?Symbol.iterator:"@@iterator";function Qa(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function Ra(a){function b(d,e){d.push(e);return d}var c=[];return Sa?Sa(b,c,a):Ta.call(null,b,c,a)}function Ua(){}function Va(){}
function Wa(){}function Xa(a){if(null!=a&&null!=a.$)a=a.$(a);else{var b=Xa[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Xa._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("ICounted.-count",a);}return a}function Za(){}function $a(a){if(null!=a&&null!=a.ba)a=a.ba(a);else{var b=$a[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=$a._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IEmptyableCollection.-empty",a);}return a}function ab(){}
function bb(a,b){if(null!=a&&null!=a.da)a=a.da(a,b);else{var c=bb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=bb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("ICollection.-conj",a);}return a}function cb(){}
var eb=function(){function a(d,e,f){var g=db[m(null==d?null:d)];if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);g=db._;if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);throw x("IIndexed.-nth",d);}function b(d,e){var f=db[m(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=db._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw x("IIndexed.-nth",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.o=a;return c}(),db=function db(a){switch(arguments.length){case 2:return db.m(arguments[0],arguments[1]);case 3:return db.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};db.m=function(a,b){return null!=a&&null!=a.M?a.M(a,b):eb(a,b)};db.o=function(a,b,c){return null!=a&&null!=a.qa?a.qa(a,b,c):eb(a,b,c)};db.D=3;function fb(){}
function gb(a){if(null!=a&&null!=a.ga)a=a.ga(a);else{var b=gb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=gb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("ISeq.-first",a);}return a}function hb(a){if(null!=a&&null!=a.ia)a=a.ia(a);else{var b=hb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=hb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("ISeq.-rest",a);}return a}function ib(){}function jb(){}
var lb=function(){function a(d,e,f){var g=kb[m(null==d?null:d)];if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);g=kb._;if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);throw x("ILookup.-lookup",d);}function b(d,e){var f=kb[m(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=kb._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw x("ILookup.-lookup",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.o=a;return c}(),kb=function kb(a){switch(arguments.length){case 2:return kb.m(arguments[0],arguments[1]);case 3:return kb.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};kb.m=function(a,b){return null!=a&&null!=a.ra?a.ra(a,b):lb(a,b)};kb.o=function(a,b,c){return null!=a&&null!=a.X?a.X(a,b,c):lb(a,b,c)};kb.D=3;function mb(){}
function nb(a,b){if(null!=a&&null!=a.Sa)a=a.Sa(a,b);else{var c=nb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=nb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IAssociative.-contains-key?",a);}return a}function pb(a,b,c){if(null!=a&&null!=a.Ha)a=a.Ha(a,b,c);else{var d=pb[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=pb._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("IAssociative.-assoc",a);}return a}
function qb(a,b){if(null!=a&&null!=a.rb)a=a.rb(a,b);else{var c=qb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=qb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IFind.-find",a);}return a}function sb(){}function tb(a,b){if(null!=a&&null!=a.nc)a=a.nc(a,b);else{var c=tb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=tb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IMap.-dissoc",a);}return a}
function ub(a){if(null!=a&&null!=a.dd)a=a.key;else{var b=ub[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=ub._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IMapEntry.-key",a);}return a}function vb(a){if(null!=a&&null!=a.ed)a=a.K;else{var b=vb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=vb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IMapEntry.-val",a);}return a}function wb(){}
function xb(a,b){if(null!=a&&null!=a.Ec)a=a.Ec(a,b);else{var c=xb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=xb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("ISet.-disjoin",a);}return a}function yb(a){if(null!=a&&null!=a.ib)a=a.ib(a);else{var b=yb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=yb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IStack.-peek",a);}return a}
function zb(a){if(null!=a&&null!=a.jb)a=a.jb(a);else{var b=zb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=zb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IStack.-pop",a);}return a}function Ab(){}function Bb(a,b,c){if(null!=a&&null!=a.kb)a=a.kb(a,b,c);else{var d=Bb[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=Bb._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("IVector.-assoc-n",a);}return a}function Cb(){}
function A(a){if(null!=a&&null!=a.ta)a=a.ta(a);else{var b=A[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=A._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IDeref.-deref",a);}return a}function Db(){}function Eb(a){if(null!=a&&null!=a.V)a=a.V(a);else{var b=Eb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Eb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IMeta.-meta",a);}return a}
function Fb(a,b){if(null!=a&&null!=a.Y)a=a.Y(a,b);else{var c=Fb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Fb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IWithMeta.-with-meta",a);}return a}function Gb(){}
var Ib=function(){function a(d,e,f){var g=Hb[m(null==d?null:d)];if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);g=Hb._;if(null!=g)return g.o?g.o(d,e,f):g.call(null,d,e,f);throw x("IReduce.-reduce",d);}function b(d,e){var f=Hb[m(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=Hb._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw x("IReduce.-reduce",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.o=a;return c}(),Hb=function Hb(a){switch(arguments.length){case 2:return Hb.m(arguments[0],arguments[1]);case 3:return Hb.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};Hb.m=function(a,b){return null!=a&&null!=a.ka?a.ka(a,b):Ib(a,b)};Hb.o=function(a,b,c){return null!=a&&null!=a.la?a.la(a,b,c):Ib(a,b,c)};Hb.D=3;function Jb(){}
function Kb(a,b,c){if(null!=a&&null!=a.Bb)a=a.Bb(a,b,c);else{var d=Kb[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=Kb._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("IKVReduce.-kv-reduce",a);}return a}function Mb(a,b){if(null!=a&&null!=a.S)a=a.S(a,b);else{var c=Mb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Mb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IEquiv.-equiv",a);}return a}
function Nb(a){if(null!=a&&null!=a.U)a=a.U(a);else{var b=Nb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Nb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IHash.-hash",a);}return a}function Ob(){}function Pb(a){if(null!=a&&null!=a.W)a=a.W(a);else{var b=Pb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Pb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("ISeqable.-seq",a);}return a}function Qb(){}function Rb(){}function Sb(){}
function Tb(a,b){if(null!=a&&null!=a.Gc)a=a.Gc(a,b);else{var c=Tb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Tb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IWriter.-write",a);}return a}function Ub(){}function Vb(a,b,c){if(null!=a&&null!=a.R)a=a.R(a,b,c);else{var d=Vb[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=Vb._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("IPrintWithWriter.-pr-writer",a);}return a}
function Wb(a,b,c){if(null!=a&&null!=a.Eb)a.Eb(a,b,c);else{var d=Wb[m(null==a?null:a)];if(null!=d)d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=Wb._,null!=d)d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("IWatchable.-add-watch",a);}}function Xb(a,b){if(null!=a&&null!=a.Fb)a.Fb(a,b);else{var c=Xb[m(null==a?null:a)];if(null!=c)c.m?c.m(a,b):c.call(null,a,b);else if(c=Xb._,null!=c)c.m?c.m(a,b):c.call(null,a,b);else throw x("IWatchable.-remove-watch",a);}}
function Yb(a){if(null!=a&&null!=a.qb)a=a.qb(a);else{var b=Yb[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Yb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IEditableCollection.-as-transient",a);}return a}function Zb(a,b){if(null!=a&&null!=a.ub)a=a.ub(a,b);else{var c=Zb[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Zb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("ITransientCollection.-conj!",a);}return a}
function $b(a){if(null!=a&&null!=a.Db)a=a.Db(a);else{var b=$b[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=$b._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("ITransientCollection.-persistent!",a);}return a}function ac(a,b,c){if(null!=a&&null!=a.tb)a=a.tb(a,b,c);else{var d=ac[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=ac._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("ITransientAssociative.-assoc!",a);}return a}
function bc(){}function cc(a,b){if(null!=a&&null!=a.Ta)a=a.Ta(a,b);else{var c=cc[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=cc._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IComparable.-compare",a);}return a}function dc(a){if(null!=a&&null!=a.lc)a=a.lc(a);else{var b=dc[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=dc._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IChunk.-drop-first",a);}return a}
function ec(a){if(null!=a&&null!=a.Ab)a=a.Ab(a);else{var b=ec[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=ec._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IChunkedSeq.-chunked-first",a);}return a}function fc(a){if(null!=a&&null!=a.Ma)a=a.Ma(a);else{var b=fc[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=fc._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IChunkedSeq.-chunked-rest",a);}return a}
function gc(a,b){if(null!=a&&null!=a.ua)a=a.ua(a,b);else{var c=gc[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=gc._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IReset.-reset!",a);}return a}
var ic=function(){function a(f,g,k,l,p){var q=hc[m(null==f?null:f)];if(null!=q)return q.O?q.O(f,g,k,l,p):q.call(null,f,g,k,l,p);q=hc._;if(null!=q)return q.O?q.O(f,g,k,l,p):q.call(null,f,g,k,l,p);throw x("ISwap.-swap!",f);}function b(f,g,k,l){var p=hc[m(null==f?null:f)];if(null!=p)return p.I?p.I(f,g,k,l):p.call(null,f,g,k,l);p=hc._;if(null!=p)return p.I?p.I(f,g,k,l):p.call(null,f,g,k,l);throw x("ISwap.-swap!",f);}function c(f,g,k){var l=hc[m(null==f?null:f)];if(null!=l)return l.o?l.o(f,g,k):l.call(null,
f,g,k);l=hc._;if(null!=l)return l.o?l.o(f,g,k):l.call(null,f,g,k);throw x("ISwap.-swap!",f);}function d(f,g){var k=hc[m(null==f?null:f)];if(null!=k)return k.m?k.m(f,g):k.call(null,f,g);k=hc._;if(null!=k)return k.m?k.m(f,g):k.call(null,f,g);throw x("ISwap.-swap!",f);}var e=null;e=function(f,g,k,l,p){switch(arguments.length){case 2:return d.call(this,f,g);case 3:return c.call(this,f,g,k);case 4:return b.call(this,f,g,k,l);case 5:return a.call(this,f,g,k,l,p)}throw Error("Invalid arity: "+arguments.length);
};e.m=d;e.o=c;e.I=b;e.O=a;return e}(),hc=function hc(a){switch(arguments.length){case 2:return hc.m(arguments[0],arguments[1]);case 3:return hc.o(arguments[0],arguments[1],arguments[2]);case 4:return hc.I(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return hc.O(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};hc.m=function(a,b){return null!=a&&null!=a.Tb?a.Tb(a,b):ic(a,b)};
hc.o=function(a,b,c){return null!=a&&null!=a.Ub?a.Ub(a,b,c):ic(a,b,c)};hc.I=function(a,b,c,d){return null!=a&&null!=a.Vb?a.Vb(a,b,c,d):ic(a,b,c,d)};hc.O=function(a,b,c,d,e){return null!=a&&null!=a.Wb?a.Wb(a,b,c,d,e):ic(a,b,c,d,e)};hc.D=5;function jc(a,b){if(null!=a&&null!=a.Fc)a=a.Fc(a,b);else{var c=jc[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=jc._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IVolatile.-vreset!",a);}return a}function lc(){}
function mc(a){if(null!=a&&null!=a.xa)a=a.xa(a);else{var b=mc[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=mc._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IIterable.-iterator",a);}return a}function nc(a,b){if(null!=a&&null!=a.Ia)a=a.Ia(a,b);else{var c=nc[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=nc._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IDrop.-drop",a);}return a}function oc(a){this.yd=a;this.A=1073741824;this.J=0}
oc.prototype.Gc=function(a,b){return this.yd.append(b)};function pc(a){var b=new Aa;a.R(null,new oc(b),Ca());return y.j(b)}var qc="undefined"!==typeof Math&&"undefined"!==typeof Math.imul?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function rc(a){a=qc(a|0,-862048943);return qc(a<<15|a>>>-15,461845907)}function sc(a,b){a=(a|0)^(b|0);return qc(a<<13|a>>>-13,5)+-430675100|0}
function tc(a,b){a=(a|0)^b;a=qc(a^a>>>16,-2048144789);a=qc(a^a>>>13,-1028477387);return a^a>>>16}function uc(a){a:{var b=1;for(var c=0;;)if(b<a.length)c=sc(c,rc(a.charCodeAt(b-1)|a.charCodeAt(b)<<16)),b+=2;else{b=c;break a}}return tc(1===(a.length&1)?b^rc(a.charCodeAt(a.length-1)):b,qc(2,a.length))}var vc={},wc=0;
function xc(a){255<wc&&(vc={},wc=0);if(null==a)return 0;var b=vc[a];if("number"===typeof b)a=b;else{a:if(null!=a)if(b=a.length,0<b)for(var c=0,d=0;;)if(c<b)d=qc(31,d)+a.charCodeAt(c),c+=1;else{b=d;break a}else b=0;else b=0;vc[a]=b;wc+=1;a=b}return a}
function Ac(a){if(null!=a&&(a.A&4194304||n===a.Gd))return a.U(null)^0;if("number"===typeof a){if(isFinite(a)){if(Number.isSafeInteger(a))a=Math.floor(a)%2147483647;else{var b=new Float64Array(1);b[0]=a;b=b.buffer;a=(new DataView(b,0,4)).getInt32();b=(new DataView(b,4,4)).getInt32();a^=b}return a}switch(a){case Infinity:return 2146435072;case -Infinity:return-1048576;default:return 2146959360}}else return!0===a?a=1231:!1===a?a=1237:"string"===typeof a?(a=xc(a),a=0===a?a:tc(sc(0,rc(a)),4)):a=a instanceof
Date?a.valueOf()^0:null==a?0:Nb(a)^0,a}function Bc(a,b){return a^b+2654435769+(a<<6)+(a>>2)}function Cc(a,b){return b instanceof a}function Dc(a,b){if(a.Ga===b.Ga)return 0;var c=Ka(a.sa);if(u(c?b.sa:c))return-1;if(u(a.sa)){if(Ka(b.sa))return 1;c=xa(a.sa,b.sa);return 0===c?xa(a.name,b.name):c}return xa(a.name,b.name)}function Ec(a,b,c,d,e){this.sa=a;this.name=b;this.Ga=c;this._hash=d;this.Ea=e;this.A=2154168321;this.J=4096}h=Ec.prototype;h.toString=function(){return this.Ga};
h.S=function(a,b){return b instanceof Ec?this.Ga===b.Ga:!1};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return B?B(a,this):Fc.call(null,a,this)};h.m=function(a,b){return Gc?Gc(a,this,b):Fc.call(null,a,this,b)};h.V=function(){return this.Ea};
h.Y=function(a,b){return new Ec(this.sa,this.name,this.Ga,this._hash,b)};h.U=function(){var a=this._hash;return null!=a?a:this._hash=a=Bc(uc(this.name),xc(this.sa))};h.R=function(a,b){return Tb(b,this.Ga)};var Hc=function Hc(a){switch(arguments.length){case 1:return Hc.j(arguments[0]);case 2:return Hc.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};
Hc.j=function(a){for(;;){if(a instanceof Ec)return a;if("string"===typeof a){var b=a.indexOf("/");return 1>b?Hc.m(null,a):Hc.m(a.substring(0,b),a.substring(b+1,a.length))}if(a instanceof C)a=a.va;else throw Error("no conversion to symbol");}};Hc.m=function(a,b){var c=null!=a?[y.j(a),"/",y.j(b)].join(""):b;return new Ec(a,b,c,null,null)};Hc.D=2;function Ic(a){return null!=a?a.J&131072||n===a.Hd?!0:a.J?!1:v(lc,a):v(lc,a)}
function D(a){if(null==a)return null;if(null!=a&&(a.A&8388608||n===a.hd))return a.W(null);if(Ja(a)||"string"===typeof a)return 0===a.length?null:new G(a,0,null);if(null!=a&&null!=a[Pa])return a=pa(a,Pa).call(a),Jc.j?Jc.j(a):Jc.call(null,a);if(v(Ob,a))return Pb(a);throw Error([y.j(a)," is not ISeqable"].join(""));}function H(a){if(null==a)return null;if(null!=a&&(a.A&64||n===a.sb))return a.ga(null);a=D(a);return null==a?null:gb(a)}
function Kc(a){return null!=a?null!=a&&(a.A&64||n===a.sb)?a.ia(null):(a=D(a))?a.ia(null):Lc:Lc}function I(a){return null==a?null:null!=a&&(a.A&128||n===a.Cb)?a.fa():D(Kc(a))}var J=function J(a){switch(arguments.length){case 1:return J.j(arguments[0]);case 2:return J.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return J.v(arguments[0],arguments[1],c)}};J.j=function(){return!0};
J.m=function(a,b){return null==a?null==b:a===b||Mb(a,b)};J.v=function(a,b,c){for(;;)if(J.m(a,b))if(I(c))a=b,b=H(c),c=I(c);else return J.m(b,H(c));else return!1};J.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};J.D=2;function Mc(a){this.s=a}Mc.prototype.next=function(){if(null!=this.s){var a=H(this.s);this.s=I(this.s);return{value:a,done:!1}}return{value:null,done:!0}};function Nc(a){return new Mc(D(a))}
function Oc(a,b){this.value=a;this.xb=b;this.fc=null;this.A=8388672;this.J=0}Oc.prototype.W=function(){return this};Oc.prototype.ga=function(){return this.value};Oc.prototype.ia=function(){null==this.fc&&(this.fc=Jc.j?Jc.j(this.xb):Jc.call(null,this.xb));return this.fc};function Jc(a){var b=a.next();return u(b.done)?null:new Oc(b.value,a)}function Pc(a){var b=0,c=1;for(a=D(a);;)if(null!=a)b+=1,c=qc(31,c)+Ac(H(a))|0,a=I(a);else return tc(sc(0,rc(c)),b)}var Qc=tc(sc(0,rc(1)),0);
function Rc(a){var b=0,c=0;for(a=D(a);;)if(null!=a)b+=1,c=c+Ac(H(a))|0,a=I(a);else return tc(sc(0,rc(c)),b)}var Sc=tc(sc(0,rc(0)),0);Wa["null"]=!0;Xa["null"]=function(){return 0};Date.prototype.S=function(a,b){return b instanceof Date&&this.valueOf()===b.valueOf()};Date.prototype.pb=n;Date.prototype.Ta=function(a,b){if(b instanceof Date)return xa(this.valueOf(),b.valueOf());throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};Mb.number=function(a,b){return a===b};Ua["function"]=!0;
Db["function"]=!0;Eb["function"]=function(){return null};Nb._=function(a){return da(a)};function Tc(a){return a+1}function Uc(){this.K=!1;this.A=32768;this.J=0}Uc.prototype.ta=function(){return this.K};function Wc(a){return a instanceof Uc}function Xc(a){return A(a)}function Yc(a,b){var c=a.$(null);if(0===c)return b.H?b.H():b.call(null);for(var d=a.M(null,0),e=1;;)if(e<c){var f=a.M(null,e);d=b.m?b.m(d,f):b.call(null,d,f);if(Wc(d))return A(d);e+=1}else return d}
function Zc(a,b,c){var d=a.$(null),e=c;for(c=0;;)if(c<d){var f=a.M(null,c);e=b.m?b.m(e,f):b.call(null,e,f);if(Wc(e))return A(e);c+=1}else return e}function $c(a,b){var c=a.length;if(0===a.length)return b.H?b.H():b.call(null);for(var d=a[0],e=1;;)if(e<c){var f=a[e];d=b.m?b.m(d,f):b.call(null,d,f);if(Wc(d))return A(d);e+=1}else return d}function ad(a,b,c){var d=a.length,e=c;for(c=0;;)if(c<d){var f=a[c];e=b.m?b.m(e,f):b.call(null,e,f);if(Wc(e))return A(e);c+=1}else return e}
function bd(a,b,c,d){for(var e=a.length;;)if(d<e){var f=a[d];c=b.m?b.m(c,f):b.call(null,c,f);if(Wc(c))return A(c);d+=1}else return c}function cd(a){return null!=a?a.A&2||n===a.Ac?!0:a.A?!1:v(Wa,a):v(Wa,a)}function dd(a){return null!=a?a.A&16||n===a.Cc?!0:a.A?!1:v(cb,a):v(cb,a)}function K(a,b,c){var d=M.j?M.j(a):M.call(null,a);if(c>=d)return-1;!(0<c)&&0>c&&(c+=d,c=0>c?0:c);for(;;)if(c<d){if(J.m(ed?ed(a,c):fd.call(null,a,c),b))return c;c+=1}else return-1}
function N(a,b,c){var d=M.j?M.j(a):M.call(null,a);if(0===d)return-1;0<c?(--d,c=d<c?d:c):c=0>c?d+c:c;for(;;)if(0<=c){if(J.m(ed?ed(a,c):fd.call(null,a,c),b))return c;--c}else return-1}function gd(a,b){this.u=a;this.i=b}gd.prototype.ea=function(){return this.i<this.u.length};gd.prototype.next=function(){var a=this.u[this.i];this.i+=1;return a};function G(a,b,c){this.u=a;this.i=b;this.meta=c;this.A=166592766;this.J=401408}h=G.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M.j?M.j(this):M.call(null,this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.M=function(a,b){a=b+this.i;if(0<=a&&a<this.u.length)return this.u[a];throw Error("Index out of bounds");};h.qa=function(a,b,c){a=b+this.i;return 0<=a&&a<this.u.length?this.u[a]:c};
h.xa=function(){return new gd(this.u,this.i)};h.V=function(){return this.meta};h.fa=function(){return this.i+1<this.u.length?new G(this.u,this.i+1,null):null};h.$=function(){var a=this.u.length-this.i;return 0>a?0:a};h.U=function(){return Pc(this)};h.S=function(a,b){return hd.m?hd.m(this,b):hd.call(null,this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return bd(this.u,b,this.u[this.i],this.i+1)};h.la=function(a,b,c){return bd(this.u,b,c,this.i)};h.ga=function(){return this.u[this.i]};
h.ia=function(){return this.i+1<this.u.length?new G(this.u,this.i+1,null):Lc};h.W=function(){return this.i<this.u.length?this:null};h.Y=function(a,b){return b===this.meta?this:new G(this.u,this.i,b)};h.da=function(a,b){return id.m?id.m(b,this):id.call(null,b,this)};h.Ia=function(a,b){return 0<b?this.i+b<this.u.length?new G(this.u,this.i+b,null):null:this};G.prototype[Pa]=function(){return Nc(this)};function O(a){return 0<a.length?new G(a,0,null):null}function jd(a){return H(I(a))}
function kd(a){for(;;){var b=I(a);if(null!=b)a=b;else return H(a)}}Mb._=function(a,b){return a===b};var ld=function ld(a){switch(arguments.length){case 0:return ld.H();case 1:return ld.j(arguments[0]);case 2:return ld.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return ld.v(arguments[0],arguments[1],c)}};ld.H=function(){return md};ld.j=function(a){return a};
ld.m=function(a,b){return null!=a?bb(a,b):new nd(null,b,null,1,null)};ld.v=function(a,b,c){for(;;)if(u(c))a=ld.m(a,b),b=H(c),c=I(c);else return ld.m(a,b)};ld.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};ld.D=2;function od(a){return null==a?null:null!=a&&(a.A&4||n===a.Xc)?a.ba(null):(null!=a?a.A&4||n===a.Xc||(a.A?0:v(Za,a)):v(Za,a))?$a(a):null}
function M(a){if(null!=a)if(null!=a&&(a.A&2||n===a.Ac))a=a.$(null);else if(Ja(a))a=a.length;else if("string"===typeof a)a=a.length;else if(null!=a&&(a.A&8388608||n===a.hd))a:{a=D(a);for(var b=0;;){if(cd(a)){a=b+Xa(a);break a}a=I(a);b+=1}}else a=Xa(a);else a=0;return a}function pd(a,b,c){for(;;){if(null==a)return c;if(0===b)return D(a)?H(a):c;if(dd(a))return db(a,b,c);if(D(a))a=I(a),--b;else return c}}
function fd(a){switch(arguments.length){case 2:return ed(arguments[0],arguments[1]);case 3:return Q(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}
function ed(a,b){if("number"!==typeof b)throw Error("Index argument to nth must be a number");if(null==a)return a;if(null!=a&&(a.A&16||n===a.Cc))return a.M(null,b);if(Ja(a)){if(-1<b&&b<a.length)return a[b|0];throw Error("Index out of bounds");}if("string"===typeof a){if(-1<b&&b<a.length)return a.charAt(b|0);throw Error("Index out of bounds");}if(null!=a&&(a.A&64||n===a.sb)||null!=a&&(a.A&16777216||n===a.oc)){if(0>b)throw Error("Index out of bounds");a:for(;;){if(null==a)throw Error("Index out of bounds");
if(0===b){if(D(a)){a=H(a);break a}throw Error("Index out of bounds");}if(dd(a)){a=db(a,b);break a}if(D(a))a=I(a),--b;else throw Error("Index out of bounds");}return a}if(v(cb,a))return db(a,b);throw Error(["nth not supported on this type ",y.j(Na(Ma(a)))].join(""));}
function Q(a,b,c){if("number"!==typeof b)throw Error("Index argument to nth must be a number.");if(null==a)return c;if(null!=a&&(a.A&16||n===a.Cc))return a.qa(null,b,c);if(Ja(a))return-1<b&&b<a.length?a[b|0]:c;if("string"===typeof a)return-1<b&&b<a.length?a.charAt(b|0):c;if(null!=a&&(a.A&64||n===a.sb)||null!=a&&(a.A&16777216||n===a.oc))return 0>b?c:pd(a,b,c);if(v(cb,a))return db(a,b,c);throw Error(["nth not supported on this type ",y.j(Na(Ma(a)))].join(""));}
function Fc(a){switch(arguments.length){case 2:return B(arguments[0],arguments[1]);case 3:return Gc(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}function B(a,b){return null==a?null:null!=a&&(a.A&256||n===a.bd)?a.ra(null,b):Ja(a)?null!=b&&b<a.length?a[b|0]:null:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):null:v(jb,a)?kb(a,b):null}
function Gc(a,b,c){return null!=a?null!=a&&(a.A&256||n===a.bd)?a.X(null,b,c):Ja(a)?null!=b&&-1<b&&b<a.length?a[b|0]:c:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):c:v(jb,a)?kb(a,b,c):c:c}var R=function R(a){switch(arguments.length){case 3:return R.o(arguments[0],arguments[1],arguments[2]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=3<c.length?new G(c.slice(3),0,null):null;return R.v(arguments[0],arguments[1],arguments[2],c)}};
R.o=function(a,b,c){return null!=a&&(a.A&512||n===a.Vc)?a.Ha(null,b,c):null!=a?pb(a,b,c):qd([b,c])};R.v=function(a,b,c,d){for(;;)if(a=R.o(a,b,c),u(d))b=H(d),c=jd(d),d=I(I(d));else return a};R.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);d=I(d);return this.v(b,a,c,d)};R.D=3;
var rd=function rd(a){switch(arguments.length){case 1:return rd.j(arguments[0]);case 2:return rd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return rd.v(arguments[0],arguments[1],c)}};rd.j=function(a){return a};rd.m=function(a,b){return null==a?null:tb(a,b)};rd.v=function(a,b,c){for(;;){if(null==a)return null;a=rd.m(a,b);if(u(c))b=H(c),c=I(c);else return a}};
rd.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};rd.D=2;function sd(a){var b="function"===typeof a;return b?b:null!=a?n===a.Uc?!0:a.pc?!1:v(Ua,a):v(Ua,a)}function td(a,b){this.G=a;this.meta=b;this.A=393217;this.J=0}h=td.prototype;h.V=function(){return this.meta};h.Y=function(a,b){return new td(this.G,b)};h.Uc=n;
h.call=function(a){switch(arguments.length-1){case 0:return this.H();case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);case 3:return this.o(arguments[1],arguments[2],arguments[3]);case 4:return this.I(arguments[1],arguments[2],arguments[3],arguments[4]);case 5:return this.O(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 6:return this.ya(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);case 7:return this.fb(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);case 8:return this.gb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);case 9:return this.hb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);case 10:return this.Ua(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10]);
case 11:return this.Va(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]);case 12:return this.Wa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12]);case 13:return this.Xa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],
arguments[11],arguments[12],arguments[13]);case 14:return this.Ya(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14]);case 15:return this.Za(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]);case 16:return this.$a(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16]);case 17:return this.ab(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17]);case 18:return this.bb(arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18]);case 19:return this.cb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19]);case 20:return this.eb(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19],arguments[20]);case 21:return this.mc(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],
arguments[18],arguments[19],arguments[20],arguments[21]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.H=function(){return this.G.H?this.G.H():this.G.call(null)};h.j=function(a){return this.G.j?this.G.j(a):this.G.call(null,a)};h.m=function(a,b){return this.G.m?this.G.m(a,b):this.G.call(null,a,b)};h.o=function(a,b,c){return this.G.o?this.G.o(a,b,c):this.G.call(null,a,b,c)};
h.I=function(a,b,c,d){return this.G.I?this.G.I(a,b,c,d):this.G.call(null,a,b,c,d)};h.O=function(a,b,c,d,e){return this.G.O?this.G.O(a,b,c,d,e):this.G.call(null,a,b,c,d,e)};h.ya=function(a,b,c,d,e,f){return this.G.ya?this.G.ya(a,b,c,d,e,f):this.G.call(null,a,b,c,d,e,f)};h.fb=function(a,b,c,d,e,f,g){return this.G.fb?this.G.fb(a,b,c,d,e,f,g):this.G.call(null,a,b,c,d,e,f,g)};h.gb=function(a,b,c,d,e,f,g,k){return this.G.gb?this.G.gb(a,b,c,d,e,f,g,k):this.G.call(null,a,b,c,d,e,f,g,k)};
h.hb=function(a,b,c,d,e,f,g,k,l){return this.G.hb?this.G.hb(a,b,c,d,e,f,g,k,l):this.G.call(null,a,b,c,d,e,f,g,k,l)};h.Ua=function(a,b,c,d,e,f,g,k,l,p){return this.G.Ua?this.G.Ua(a,b,c,d,e,f,g,k,l,p):this.G.call(null,a,b,c,d,e,f,g,k,l,p)};h.Va=function(a,b,c,d,e,f,g,k,l,p,q){return this.G.Va?this.G.Va(a,b,c,d,e,f,g,k,l,p,q):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q)};h.Wa=function(a,b,c,d,e,f,g,k,l,p,q,t){return this.G.Wa?this.G.Wa(a,b,c,d,e,f,g,k,l,p,q,t):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t)};
h.Xa=function(a,b,c,d,e,f,g,k,l,p,q,t,w){return this.G.Xa?this.G.Xa(a,b,c,d,e,f,g,k,l,p,q,t,w):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w)};h.Ya=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z){return this.G.Ya?this.G.Ya(a,b,c,d,e,f,g,k,l,p,q,t,w,z):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z)};h.Za=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E){return this.G.Za?this.G.Za(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E)};
h.$a=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F){return this.G.$a?this.G.$a(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F)};h.ab=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P){return this.G.ab?this.G.ab(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P)};h.bb=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V){return this.G.bb?this.G.bb(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V)};
h.cb=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba){return this.G.cb?this.G.cb(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba)};h.eb=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z){return this.G.eb?this.G.eb(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z):this.G.call(null,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z)};
h.mc=function(a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa){return ud.mc?ud.mc(this.G,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,new G([Z,qa],0,null)):ud.call(null,this.G,a,b,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa)};function vd(a,b){return"function"===typeof a?new td(a,b):null==a?null:Fb(a,b)}function wd(a){var b=null!=a;return(b?null!=a?a.A&131072||n===a.fd||(a.A?0:v(Db,a)):v(Db,a):b)?Eb(a):null}function xd(a){return null==a?null:yb(a)}
var yd=function yd(a){switch(arguments.length){case 1:return yd.j(arguments[0]);case 2:return yd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return yd.v(arguments[0],arguments[1],c)}};yd.j=function(a){return a};yd.m=function(a,b){return null==a?null:xb(a,b)};yd.v=function(a,b,c){for(;;){if(null==a)return null;a=yd.m(a,b);if(u(c))b=H(c),c=I(c);else return a}};
yd.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};yd.D=2;function zd(a){return null==a?!0:(null!=a?a.A&2||n===a.Ac||(a.A?0:v(Wa,a)):v(Wa,a))?0===Xa(a):Ka(D(a))}function Ad(a){return null==a?!1:null!=a?a.A&8||n===a.Cd?!0:a.A?!1:v(ab,a):v(ab,a)}function Bd(a){return null==a?!1:null!=a?a.A&4096||n===a.jd?!0:a.A?!1:v(wb,a):v(wb,a)}function Cd(a){return null!=a?a.A&16777216||n===a.oc?!0:a.A?!1:v(Qb,a):v(Qb,a)}
function Dd(a){return null==a?!1:null!=a?a.A&1024||n===a.cd?!0:a.A?!1:v(sb,a):v(sb,a)}function Ed(a){return null!=a?a.A&67108864||n===a.Kd?!0:a.A?!1:v(Sb,a):v(Sb,a)}function Fd(a){return null!=a?a.A&16384||n===a.Ld?!0:a.A?!1:v(Ab,a):v(Ab,a)}function Gd(a){return null!=a?a.J&512||n===a.Bd?!0:!1:!1}function Hd(a,b,c,d,e){for(;;){if(0===e)return c;c[d]=a[b];d+=1;--e;b+=1}}var Id={};function Jd(a){return null==a?!1:null!=a?a.A&64||n===a.sb?!0:a.A?!1:v(fb,a):v(fb,a)}
function Kd(a){return null==a?!1:!1===a?!1:!0}function Ld(a){var b=sd(a);return b?b:null!=a?a.A&1||n===a.Fd?!0:a.A?!1:v(Va,a):v(Va,a)}function Md(a){return"number"===typeof a&&!isNaN(a)&&Infinity!==a&&parseFloat(a)===parseInt(a,10)}function Nd(a,b){return null!=a&&(a.A&512||n===a.Vc)?a.Sa(null,b):v(mb,a)?nb(a,b):Gc(a,b,Id)===Id?!1:!0}
function Od(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if("number"===typeof a){if("number"===typeof b)return xa(a,b);throw Error(["Cannot compare ",y.j(a)," to ",y.j(b)].join(""));}if(null!=a?a.J&2048||n===a.pb||(a.J?0:v(bc,a)):v(bc,a))return cc(a,b);if("string"!==typeof a&&!Ja(a)&&!0!==a&&!1!==a||Ma(a)!==Ma(b))throw Error(["Cannot compare ",y.j(a)," to ",y.j(b)].join(""));return xa(a,b)}
function Pd(a,b){var c=M(a),d=M(b);if(c<d)a=-1;else if(c>d)a=1;else if(0===c)a=0;else a:for(d=0;;){var e=Od(ed(a,d),ed(b,d));if(0===e&&d+1<c)d+=1;else{a=e;break a}}return a}function Qd(a){return J.m(a,Od)?Od:function(b,c){var d=a.m?a.m(b,c):a.call(null,b,c);return"number"===typeof d?d:u(d)?-1:u(a.m?a.m(c,b):a.call(null,c,b))?1:0}}function Rd(a,b){if(D(b)){var c=Sd.j?Sd.j(b):Sd.call(null,b);za(c,Qd(a));return vd(D(c),wd(b))}return Lc}
function Td(a,b,c){return Rd(function(d,e){d=a.j?a.j(d):a.call(null,d);e=a.j?a.j(e):a.call(null,e);var f=Qd(b);return f.m?f.m(d,e):f.call(null,d,e)},c)}function Ud(a,b){var c=D(b);return c?(b=H(c),c=I(c),Sa?Sa(a,b,c):Ta.call(null,a,b,c)):a.H?a.H():a.call(null)}function Vd(a,b,c){for(c=D(c);;)if(c){var d=H(c);b=a.m?a.m(b,d):a.call(null,b,d);if(Wc(b))return A(b);c=I(c)}else return b}
function Wd(a,b){a=mc(a);if(u(a.ea()))for(var c=a.next();;)if(a.ea()){var d=a.next();c=b.m?b.m(c,d):b.call(null,c,d);if(Wc(c))return A(c)}else return c;else return b.H?b.H():b.call(null)}function Xd(a,b,c){for(a=mc(a);;)if(a.ea()){var d=a.next();c=b.m?b.m(c,d):b.call(null,c,d);if(Wc(c))return A(c)}else return c}
function Ta(a){switch(arguments.length){case 2:return Yd(arguments[0],arguments[1]);case 3:return Sa(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}function Yd(a,b){return null!=b&&(b.A&524288||n===b.gd)?b.ka(null,a):Ja(b)?$c(b,a):"string"===typeof b?$c(b,a):v(Gb,b)?Hb(b,a):Ic(b)?Wd(b,a):Ud(a,b)}
function Sa(a,b,c){return null!=c&&(c.A&524288||n===c.gd)?c.la(null,a,b):Ja(c)?ad(c,a,b):"string"===typeof c?ad(c,a,b):v(Gb,c)?Hb(c,a,b):Ic(c)?Xd(c,a,b):Vd(a,b,c)}function Zd(a,b,c){return(null!=c?c.A&1048576||n===c.ad||(c.A?0:v(Jb,c)):v(Jb,c))?Kb(c,a,b):Sa(function(d,e){var f=ub(e);e=vb(e);return a.o?a.o(d,f,e):a.call(null,d,f,e)},b,c)}function $d(a){return a}function ae(a,b,c,d){a=a.j?a.j(b):a.call(null,b);c=Sa(a,c,d);return a.j?a.j(c):a.call(null,c)}
var be=function be(a){switch(arguments.length){case 1:return be.j(arguments[0]);case 2:return be.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return be.v(arguments[0],arguments[1],c)}};be.j=function(){return!0};be.m=function(a,b){return a>b};be.v=function(a,b,c){for(;;)if(a>b)if(I(c))a=b,b=H(c),c=I(c);else return b>H(c);else return!1};
be.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};be.D=2;var ce=function ce(a){switch(arguments.length){case 1:return ce.j(arguments[0]);case 2:return ce.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return ce.v(arguments[0],arguments[1],c)}};ce.j=function(a){return a};ce.m=function(a,b){return a>b?a:b};ce.v=function(a,b,c){return Sa(ce,a>b?a:b,c)};
ce.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};ce.D=2;function de(a){a=(a-a%2)/2;return 0<=a?Math.floor(a):Math.ceil(a)}function ee(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}
var y=function y(a){switch(arguments.length){case 0:return y.H();case 1:return y.j(arguments[0]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return y.v(arguments[0],c)}};y.H=function(){return""};y.j=function(a){return null==a?"":[a].join("")};y.v=function(a,b){for(a=new Aa(y.j(a));;)if(u(b))a=a.append(y.j(H(b))),b=I(b);else return a.toString()};y.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};y.D=1;
function hd(a,b){if(Cd(b))if(cd(a)&&cd(b)&&M(a)!==M(b))a=!1;else a:for(a=D(a),b=D(b);;){if(null==a){a=null==b;break a}if(null!=b&&J.m(H(a),H(b)))a=I(a),b=I(b);else{a=!1;break a}}else a=null;return Kd(a)}function nd(a,b,c,d,e){this.meta=a;this.first=b;this.La=c;this.count=d;this.C=e;this.A=65937646;this.J=8192}h=nd.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,this.count)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){return 1===this.count?null:this.La};h.$=function(){return this.count};h.ib=function(){return this.first};h.jb=function(){return this.ia(null)};
h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Fb(Lc,this.meta)};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return this.first};h.ia=function(){return 1===this.count?Lc:this.La};h.W=function(){return this};h.Y=function(a,b){return b===this.meta?this:new nd(b,this.first,this.La,this.count,this.C)};h.da=function(a,b){return new nd(this.meta,b,this,this.count+1,null)};
nd.prototype[Pa]=function(){return Nc(this)};function fe(a){this.meta=a;this.A=65937614;this.J=8192}h=fe.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){return null};h.$=function(){return 0};h.ib=function(){return null};h.jb=function(){throw Error("Can't pop empty list");};h.U=function(){return Qc};
h.S=function(a,b){return(null!=b?b.A&33554432||n===b.Id||(b.A?0:v(Rb,b)):v(Rb,b))||Cd(b)?null==D(b):!1};h.ba=function(){return this};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return null};h.ia=function(){return Lc};h.W=function(){return null};h.Y=function(a,b){return b===this.meta?this:new fe(b)};h.da=function(a,b){return new nd(this.meta,b,null,1,null)};var Lc=new fe(null);fe.prototype[Pa]=function(){return Nc(this)};
function ge(a,b,c,d){this.meta=a;this.first=b;this.La=c;this.C=d;this.A=65929452;this.J=8192}h=ge.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){return null==this.La?null:D(this.La)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};
h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return this.first};h.ia=function(){return null==this.La?Lc:this.La};h.W=function(){return this};h.Y=function(a,b){return b===this.meta?this:new ge(b,this.first,this.La,this.C)};h.da=function(a,b){return new ge(null,b,this,null)};ge.prototype[Pa]=function(){return Nc(this)};
function id(a,b){return null==b?new nd(null,a,null,1,null):null!=b&&(b.A&64||n===b.sb)?new ge(null,a,b,null):new ge(null,a,D(b),null)}function he(a,b){if(a.va===b.va)return 0;var c=Ka(a.sa);if(u(c?b.sa:c))return-1;if(u(a.sa)){if(Ka(b.sa))return 1;c=xa(a.sa,b.sa);return 0===c?xa(a.name,b.name):c}return xa(a.name,b.name)}function C(a,b,c,d){this.sa=a;this.name=b;this.va=c;this._hash=d;this.A=2153775105;this.J=4096}h=C.prototype;h.toString=function(){return[":",y.j(this.va)].join("")};
h.S=function(a,b){return b instanceof C?this.va===b.va:!1};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return B(a,this)};h.m=function(a,b){return Gc(a,this,b)};
h.U=function(){var a=this._hash;return null!=a?a:this._hash=a=Bc(uc(this.name),xc(this.sa))+2654435769|0};h.R=function(a,b){return Tb(b,[":",y.j(this.va)].join(""))};function ie(a){if(null!=a&&(a.J&4096||n===a.Dc))return a.sa;throw Error(["Doesn't support namespace: ",y.j(a)].join(""));}var je=function je(a){switch(arguments.length){case 1:return je.j(arguments[0]);case 2:return je.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};
je.j=function(a){if(a instanceof C)return a;if(a instanceof Ec)return new C(ie(a),ke.j?ke.j(a):ke.call(null,a),a.Ga,null);if(J.m("/",a))return new C(null,a,a,null);if("string"===typeof a){var b=a.split("/");return 2===b.length?new C(b[0],b[1],a,null):new C(null,b[0],a,null)}return null};
je.m=function(a,b){a=a instanceof C?ke.j?ke.j(a):ke.call(null,a):a instanceof Ec?ke.j?ke.j(a):ke.call(null,a):a;b=b instanceof C?ke.j?ke.j(b):ke.call(null,b):b instanceof Ec?ke.j?ke.j(b):ke.call(null,b):b;return new C(a,b,[u(a)?[y.j(a),"/"].join(""):null,y.j(b)].join(""),null)};je.D=2;function le(a,b,c){this.meta=a;this.Hb=b;this.s=null;this.C=c;this.A=32374988;this.J=1}h=le.prototype;h.toString=function(){return pc(this)};
function me(a){null!=a.Hb&&(a.s=a.Hb.H?a.Hb.H():a.Hb.call(null),a.Hb=null);return a.s}h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){this.W(null);return null==this.s?null:I(this.s)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};
h.ba=function(){return Fb(Lc,this.meta)};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){this.W(null);return null==this.s?null:H(this.s)};h.ia=function(){this.W(null);return null!=this.s?Kc(this.s):Lc};h.W=function(){me(this);if(null==this.s)return null;for(var a=this.s;;)if(a instanceof le)a=me(a);else return this.s=a,D(this.s)};h.Y=function(a,b){var c=this;return b===this.meta?c:new le(b,function(){return c.W(null)},this.C)};
h.da=function(a,b){return id(b,this)};le.prototype[Pa]=function(){return Nc(this)};function ne(a){this.buf=a;this.end=0;this.A=2;this.J=0}ne.prototype.add=function(a){this.buf[this.end]=a;return this.end+=1};ne.prototype.T=function(){var a=new oe(this.buf,0,this.end);this.buf=null;return a};ne.prototype.$=function(){return this.end};function pe(a){return new ne(Array(a))}function oe(a,b,c){this.u=a;this.ma=b;this.end=c;this.A=524306;this.J=0}h=oe.prototype;h.$=function(){return this.end-this.ma};
h.M=function(a,b){return this.u[this.ma+b]};h.qa=function(a,b,c){return 0<=b&&b<this.end-this.ma?this.u[this.ma+b]:c};h.lc=function(){if(this.ma===this.end)throw Error("-drop-first of empty chunk");return new oe(this.u,this.ma+1,this.end)};h.ka=function(a,b){return bd(this.u,b,this.u[this.ma],this.ma+1)};h.la=function(a,b,c){return bd(this.u,b,c,this.ma)};function qe(a,b,c,d){this.T=a;this.Ca=b;this.meta=c;this.C=d;this.A=31850732;this.J=1536}h=qe.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){return 1<Xa(this.T)?new qe(dc(this.T),this.Ca,null,null):null==this.Ca?null:Pb(this.Ca)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ga=function(){return db(this.T,0)};h.ia=function(){return 1<Xa(this.T)?new qe(dc(this.T),this.Ca,null,null):null==this.Ca?Lc:this.Ca};h.W=function(){return this};h.Ab=function(){return this.T};h.Ma=function(){return null==this.Ca?Lc:this.Ca};h.Y=function(a,b){return b===this.meta?this:new qe(this.T,this.Ca,b,this.C)};h.da=function(a,b){return id(b,this)};h.Sb=function(){return null==this.Ca?null:this.Ca};qe.prototype[Pa]=function(){return Nc(this)};
function re(a,b){return 0===Xa(a)?b:new qe(a,b,null,null)}function se(a,b){a.add(b)}function Sd(a){var b=[];for(a=D(a);;)if(null!=a)b.push(H(a)),a=I(a);else return b}function te(a,b){if(cd(b))return M(b);var c=0;for(b=D(b);;)if(null!=b&&c<a)c+=1,b=I(b);else return c}
var ue=function ue(a){if(null==a)return null;var c=I(a);return null==c?D(H(a)):id(H(a),ue.j?ue.j(c):ue.call(null,c))},ve=function ve(a){switch(arguments.length){case 0:return ve.H();case 1:return ve.j(arguments[0]);case 2:return ve.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return ve.v(arguments[0],arguments[1],c)}};ve.H=function(){return new le(null,function(){return null},null)};
ve.j=function(a){return new le(null,function(){return a},null)};ve.m=function(a,b){return new le(null,function(){var c=D(a);return c?Gd(c)?re(ec(c),ve.m(fc(c),b)):id(H(c),ve.m(Kc(c),b)):b},null)};ve.v=function(a,b,c){return function g(e,f){return new le(null,function(){var k=D(e);return k?Gd(k)?re(ec(k),g(fc(k),f)):id(H(k),g(Kc(k),f)):u(f)?g(H(f),I(f)):null},null)}(ve.m(a,b),c)};ve.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};ve.D=2;
function we(a,b,c){var d=D(c);if(0===b)return a.H?a.H():a.call(null);c=gb(d);var e=hb(d);if(1===b)return a.j?a.j(c):a.call(null,c);d=gb(e);var f=hb(e);if(2===b)return a.m?a.m(c,d):a.call(null,c,d);e=gb(f);var g=hb(f);if(3===b)return a.o?a.o(c,d,e):a.call(null,c,d,e);f=gb(g);var k=hb(g);if(4===b)return a.I?a.I(c,d,e,f):a.call(null,c,d,e,f);g=gb(k);var l=hb(k);if(5===b)return a.O?a.O(c,d,e,f,g):a.call(null,c,d,e,f,g);k=gb(l);var p=hb(l);if(6===b)return a.ya?a.ya(c,d,e,f,g,k):a.call(null,c,d,e,f,g,k);
l=gb(p);var q=hb(p);if(7===b)return a.fb?a.fb(c,d,e,f,g,k,l):a.call(null,c,d,e,f,g,k,l);p=gb(q);var t=hb(q);if(8===b)return a.gb?a.gb(c,d,e,f,g,k,l,p):a.call(null,c,d,e,f,g,k,l,p);q=gb(t);var w=hb(t);if(9===b)return a.hb?a.hb(c,d,e,f,g,k,l,p,q):a.call(null,c,d,e,f,g,k,l,p,q);t=gb(w);var z=hb(w);if(10===b)return a.Ua?a.Ua(c,d,e,f,g,k,l,p,q,t):a.call(null,c,d,e,f,g,k,l,p,q,t);w=gb(z);var E=hb(z);if(11===b)return a.Va?a.Va(c,d,e,f,g,k,l,p,q,t,w):a.call(null,c,d,e,f,g,k,l,p,q,t,w);z=gb(E);var F=hb(E);
if(12===b)return a.Wa?a.Wa(c,d,e,f,g,k,l,p,q,t,w,z):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z);E=gb(F);var P=hb(F);if(13===b)return a.Xa?a.Xa(c,d,e,f,g,k,l,p,q,t,w,z,E):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E);F=gb(P);var V=hb(P);if(14===b)return a.Ya?a.Ya(c,d,e,f,g,k,l,p,q,t,w,z,E,F):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F);P=gb(V);var ba=hb(V);if(15===b)return a.Za?a.Za(c,d,e,f,g,k,l,p,q,t,w,z,E,F,P):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P);V=gb(ba);var Z=hb(ba);if(16===b)return a.$a?a.$a(c,d,e,f,g,k,
l,p,q,t,w,z,E,F,P,V):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V);ba=gb(Z);var qa=hb(Z);if(17===b)return a.ab?a.ab(c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba);Z=gb(qa);var ya=hb(qa);if(18===b)return a.bb?a.bb(c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z);qa=gb(ya);ya=hb(ya);if(19===b)return a.cb?a.cb(c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa);var rb=gb(ya);hb(ya);if(20===
b)return a.eb?a.eb(c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa,rb):a.call(null,c,d,e,f,g,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa,rb);throw Error("Only up to 20 arguments supported on functions");}function xe(a){return null!=a&&(a.A&128||n===a.Cb)?a.fa():D(Kc(a))}function ye(a,b,c){return null==c?a.j?a.j(b):a.call(a,b):ze(a,b,gb(c),xe(c))}function ze(a,b,c,d){return null==d?a.m?a.m(b,c):a.call(a,b,c):Ae(a,b,c,gb(d),xe(d))}
function Ae(a,b,c,d,e){return null==e?a.o?a.o(b,c,d):a.call(a,b,c,d):Be(a,b,c,d,gb(e),xe(e))}
function Be(a,b,c,d,e,f){if(null==f)return a.I?a.I(b,c,d,e):a.call(a,b,c,d,e);var g=gb(f),k=I(f);if(null==k)return a.O?a.O(b,c,d,e,g):a.call(a,b,c,d,e,g);f=gb(k);var l=I(k);if(null==l)return a.ya?a.ya(b,c,d,e,g,f):a.call(a,b,c,d,e,g,f);k=gb(l);var p=I(l);if(null==p)return a.fb?a.fb(b,c,d,e,g,f,k):a.call(a,b,c,d,e,g,f,k);l=gb(p);var q=I(p);if(null==q)return a.gb?a.gb(b,c,d,e,g,f,k,l):a.call(a,b,c,d,e,g,f,k,l);p=gb(q);var t=I(q);if(null==t)return a.hb?a.hb(b,c,d,e,g,f,k,l,p):a.call(a,b,c,d,e,g,f,k,
l,p);q=gb(t);var w=I(t);if(null==w)return a.Ua?a.Ua(b,c,d,e,g,f,k,l,p,q):a.call(a,b,c,d,e,g,f,k,l,p,q);t=gb(w);var z=I(w);if(null==z)return a.Va?a.Va(b,c,d,e,g,f,k,l,p,q,t):a.call(a,b,c,d,e,g,f,k,l,p,q,t);w=gb(z);var E=I(z);if(null==E)return a.Wa?a.Wa(b,c,d,e,g,f,k,l,p,q,t,w):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w);z=gb(E);var F=I(E);if(null==F)return a.Xa?a.Xa(b,c,d,e,g,f,k,l,p,q,t,w,z):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z);E=gb(F);var P=I(F);if(null==P)return a.Ya?a.Ya(b,c,d,e,g,f,k,l,p,q,t,w,z,E):a.call(a,
b,c,d,e,g,f,k,l,p,q,t,w,z,E);F=gb(P);var V=I(P);if(null==V)return a.Za?a.Za(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z,E,F);P=gb(V);var ba=I(V);if(null==ba)return a.$a?a.$a(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P);V=gb(ba);var Z=I(ba);if(null==Z)return a.ab?a.ab(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V);ba=gb(Z);var qa=I(Z);if(null==qa)return a.bb?a.bb(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba):a.call(a,b,c,d,
e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba);Z=gb(qa);var ya=I(qa);if(null==ya)return a.cb?a.cb(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba,Z):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba,Z);qa=gb(ya);ya=I(ya);if(null==ya)return a.eb?a.eb(b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa):a.call(a,b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa);b=[b,c,d,e,g,f,k,l,p,q,t,w,z,E,F,P,V,ba,Z,qa];for(c=ya;;)if(c)b.push(gb(c)),c=I(c);else break;return a.apply(a,b)}
function ud(a){switch(arguments.length){case 2:return Ce(arguments[0],arguments[1]);case 3:return De(arguments[0],arguments[1],arguments[2]);case 4:return Ee(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return Fe(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;b=5<b.length?new G(b.slice(5),0,null):null;return Ge(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],
b)}}function Ce(a,b){if(a.F){var c=a.D,d=te(c+1,b);return d<=c?we(a,d,b):a.F(b)}b=D(b);return null==b?a.H?a.H():a.call(a):ye(a,gb(b),xe(b))}function De(a,b,c){if(a.F){b=id(b,c);var d=a.D;c=te(d,c)+1;return c<=d?we(a,c,b):a.F(b)}return ye(a,b,D(c))}function Ee(a,b,c,d){return a.F?(b=id(b,id(c,d)),c=a.D,d=2+te(c-1,d),d<=c?we(a,d,b):a.F(b)):ze(a,b,c,D(d))}function Fe(a,b,c,d,e){return a.F?(b=id(b,id(c,id(d,e))),c=a.D,e=3+te(c-2,e),e<=c?we(a,e,b):a.F(b)):Ae(a,b,c,d,D(e))}
function Ge(a,b,c,d,e,f){return a.F?(f=ue(f),b=id(b,id(c,id(d,id(e,f)))),c=a.D,f=4+te(c-3,f),f<=c?we(a,f,b):a.F(b)):Be(a,b,c,d,e,ue(f))}function S(a){return null!=a&&(a.A&64||n===a.sb)?I(a)?qd(Sd(a)):D(a)?H(a):He:a}function Ie(a,b){return!J.m(a,b)}function Je(a){return D(a)?a:null}function Ke(a){this.rd=a;this.A=393216;this.J=0}h=Ke.prototype;h.Y=function(a,b){return new Ke(b)};h.V=function(){return this.rd};h.ea=function(){return!1};h.next=function(){return Error("No such element")};h.remove=function(){return Error("Unsupported operation")};
var Le={},Me={};function Ne(a){this.zb=Le;this.Qa=a}Ne.prototype.ea=function(){this.zb===Le?(this.zb=Me,this.Qa=D(this.Qa)):this.zb===this.Qa&&(this.Qa=I(this.zb));return null!=this.Qa};Ne.prototype.next=function(){if(this.ea())return this.zb=this.Qa,H(this.Qa);throw Error("No such element");};Ne.prototype.remove=function(){return Error("Unsupported operation")};function Oe(a,b){for(;;){if(null==D(b))return!0;var c=H(b);c=a.j?a.j(c):a.call(null,c);if(u(c))b=I(b);else return!1}}
function Pe(a,b){for(;;)if(b=D(b)){var c=H(b);c=a.j?a.j(c):a.call(null,c);if(u(c))return c;b=I(b)}else return null}
function Qe(a){return function(){function b(g,k){return Ka(a.m?a.m(g,k):a.call(null,g,k))}function c(g){return Ka(a.j?a.j(g):a.call(null,g))}function d(){return Ka(a.H?a.H():a.call(null))}var e=null,f=function(){function g(l,p,q){var t=null;if(2<arguments.length){t=0;for(var w=Array(arguments.length-2);t<w.length;)w[t]=arguments[t+2],++t;t=new G(w,0,null)}return k.call(this,l,p,t)}function k(l,p,q){return Ka(Ee(a,l,p,q))}g.D=2;g.F=function(l){var p=H(l);l=I(l);var q=H(l);l=Kc(l);return k(p,q,l)};
g.v=k;return g}();e=function(g,k,l){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,g);case 2:return b.call(this,g,k);default:var p=null;if(2<arguments.length){p=0;for(var q=Array(arguments.length-2);p<q.length;)q[p]=arguments[p+2],++p;p=new G(q,0,null)}return f.v(g,k,p)}throw Error("Invalid arity: "+arguments.length);};e.D=2;e.F=f.F;e.H=d;e.j=c;e.m=b;e.v=f.v;return e}()}
var Re=function Re(a){switch(arguments.length){case 1:return Re.j(arguments[0]);case 2:return Re.m(arguments[0],arguments[1]);case 3:return Re.o(arguments[0],arguments[1],arguments[2]);case 4:return Re.I(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=4<c.length?new G(c.slice(4),0,null):null;return Re.v(arguments[0],arguments[1],arguments[2],arguments[3],c)}};Re.j=function(a){return a};
Re.m=function(a,b){return function(){function c(l,p,q){return a.I?a.I(b,l,p,q):a.call(null,b,l,p,q)}function d(l,p){return a.o?a.o(b,l,p):a.call(null,b,l,p)}function e(l){return a.m?a.m(b,l):a.call(null,b,l)}function f(){return a.j?a.j(b):a.call(null,b)}var g=null,k=function(){function l(q,t,w,z){var E=null;if(3<arguments.length){E=0;for(var F=Array(arguments.length-3);E<F.length;)F[E]=arguments[E+3],++E;E=new G(F,0,null)}return p.call(this,q,t,w,E)}function p(q,t,w,z){return Ge(a,b,q,t,w,O([z]))}
l.D=3;l.F=function(q){var t=H(q);q=I(q);var w=H(q);q=I(q);var z=H(q);q=Kc(q);return p(t,w,z,q)};l.v=p;return l}();g=function(l,p,q,t){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,l);case 2:return d.call(this,l,p);case 3:return c.call(this,l,p,q);default:var w=null;if(3<arguments.length){w=0;for(var z=Array(arguments.length-3);w<z.length;)z[w]=arguments[w+3],++w;w=new G(z,0,null)}return k.v(l,p,q,w)}throw Error("Invalid arity: "+arguments.length);};g.D=3;g.F=k.F;g.H=
f;g.j=e;g.m=d;g.o=c;g.v=k.v;return g}()};
Re.o=function(a,b,c){return function(){function d(p,q,t){return a.O?a.O(b,c,p,q,t):a.call(null,b,c,p,q,t)}function e(p,q){return a.I?a.I(b,c,p,q):a.call(null,b,c,p,q)}function f(p){return a.o?a.o(b,c,p):a.call(null,b,c,p)}function g(){return a.m?a.m(b,c):a.call(null,b,c)}var k=null,l=function(){function p(t,w,z,E){var F=null;if(3<arguments.length){F=0;for(var P=Array(arguments.length-3);F<P.length;)P[F]=arguments[F+3],++F;F=new G(P,0,null)}return q.call(this,t,w,z,F)}function q(t,w,z,E){return Ge(a,
b,c,t,w,O([z,E]))}p.D=3;p.F=function(t){var w=H(t);t=I(t);var z=H(t);t=I(t);var E=H(t);t=Kc(t);return q(w,z,E,t)};p.v=q;return p}();k=function(p,q,t,w){switch(arguments.length){case 0:return g.call(this);case 1:return f.call(this,p);case 2:return e.call(this,p,q);case 3:return d.call(this,p,q,t);default:var z=null;if(3<arguments.length){z=0;for(var E=Array(arguments.length-3);z<E.length;)E[z]=arguments[z+3],++z;z=new G(E,0,null)}return l.v(p,q,t,z)}throw Error("Invalid arity: "+arguments.length);
};k.D=3;k.F=l.F;k.H=g;k.j=f;k.m=e;k.o=d;k.v=l.v;return k}()};
Re.I=function(a,b,c,d){return function(){function e(q,t,w){return a.ya?a.ya(b,c,d,q,t,w):a.call(null,b,c,d,q,t,w)}function f(q,t){return a.O?a.O(b,c,d,q,t):a.call(null,b,c,d,q,t)}function g(q){return a.I?a.I(b,c,d,q):a.call(null,b,c,d,q)}function k(){return a.o?a.o(b,c,d):a.call(null,b,c,d)}var l=null,p=function(){function q(w,z,E,F){var P=null;if(3<arguments.length){P=0;for(var V=Array(arguments.length-3);P<V.length;)V[P]=arguments[P+3],++P;P=new G(V,0,null)}return t.call(this,w,z,E,P)}function t(w,
z,E,F){return Ge(a,b,c,d,w,O([z,E,F]))}q.D=3;q.F=function(w){var z=H(w);w=I(w);var E=H(w);w=I(w);var F=H(w);w=Kc(w);return t(z,E,F,w)};q.v=t;return q}();l=function(q,t,w,z){switch(arguments.length){case 0:return k.call(this);case 1:return g.call(this,q);case 2:return f.call(this,q,t);case 3:return e.call(this,q,t,w);default:var E=null;if(3<arguments.length){E=0;for(var F=Array(arguments.length-3);E<F.length;)F[E]=arguments[E+3],++E;E=new G(F,0,null)}return p.v(q,t,w,E)}throw Error("Invalid arity: "+
arguments.length);};l.D=3;l.F=p.F;l.H=k;l.j=g;l.m=f;l.o=e;l.v=p.v;return l}()};Re.v=function(a,b,c,d,e){return function(){function f(k){var l=null;if(0<arguments.length){l=0;for(var p=Array(arguments.length-0);l<p.length;)p[l]=arguments[l+0],++l;l=new G(p,0,null)}return g.call(this,l)}function g(k){return Fe(a,b,c,d,ve.m(e,k))}f.D=0;f.F=function(k){k=D(k);return g(k)};f.v=g;return f}()};Re.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);var e=I(d);d=H(e);e=I(e);return this.v(b,a,c,d,e)};
Re.D=4;
function Se(){var a=Te,b=Ue;return function(){function c(k,l,p){k=null==k?b:k;return a.o?a.o(k,l,p):a.call(null,k,l,p)}function d(k,l){k=null==k?b:k;return a.m?a.m(k,l):a.call(null,k,l)}function e(k){k=null==k?b:k;return a.j?a.j(k):a.call(null,k)}var f=null,g=function(){function k(p,q,t,w){var z=null;if(3<arguments.length){z=0;for(var E=Array(arguments.length-3);z<E.length;)E[z]=arguments[z+3],++z;z=new G(E,0,null)}return l.call(this,p,q,t,z)}function l(p,q,t,w){return Fe(a,null==p?b:p,q,t,w)}k.D=
3;k.F=function(p){var q=H(p);p=I(p);var t=H(p);p=I(p);var w=H(p);p=Kc(p);return l(q,t,w,p)};k.v=l;return k}();f=function(k,l,p,q){switch(arguments.length){case 1:return e.call(this,k);case 2:return d.call(this,k,l);case 3:return c.call(this,k,l,p);default:var t=null;if(3<arguments.length){t=0;for(var w=Array(arguments.length-3);t<w.length;)w[t]=arguments[t+3],++t;t=new G(w,0,null)}return g.v(k,l,p,t)}throw Error("Invalid arity: "+arguments.length);};f.D=3;f.F=g.F;f.j=e;f.m=d;f.o=c;f.v=g.v;return f}()}
function Ve(a){var b=We;return function f(d,e){return new le(null,function(){var g=D(e);if(g){if(Gd(g)){for(var k=ec(g),l=M(k),p=pe(l),q=0;;)if(q<l)se(p,function(){var t=d+q,w=db(k,q);return b.m?b.m(t,w):b.call(null,t,w)}()),q+=1;else break;return re(p.T(),f(d+l,fc(g)))}return id(function(){var t=H(g);return b.m?b.m(d,t):b.call(null,d,t)}(),f(d+1,Kc(g)))}return null},null)}(0,a)}
function Xe(a,b){return new le(null,function(){var c=D(b);if(c){if(Gd(c)){for(var d=ec(c),e=M(d),f=pe(e),g=0;;)if(g<e){var k=function(){var l=db(d,g);return a.j?a.j(l):a.call(null,l)}();null!=k&&f.add(k);g+=1}else break;return re(f.T(),Xe(a,fc(c)))}e=function(){var l=H(c);return a.j?a.j(l):a.call(null,l)}();return null==e?Xe(a,Kc(c)):id(e,Xe(a,Kc(c)))}return null},null)}function Ye(a){this.state=a;this.ja=this.xc=this.meta=null;this.J=16386;this.A=6455296}h=Ye.prototype;
h.S=function(a,b){return this===b};h.ta=function(){return this.state};h.V=function(){return this.meta};h.Xb=function(a,b){for(var c=D(this.ja),d=null,e=0,f=0;;)if(f<e){var g=d.M(null,f),k=Q(g,0,null);g=Q(g,1,null);g.I?g.I(k,this,a,b):g.call(null,k,this,a,b);f+=1}else if(c=D(c))Gd(c)?(d=ec(c),c=fc(c),k=d,e=M(d),d=k):(d=H(c),k=Q(d,0,null),g=Q(d,1,null),g.I?g.I(k,this,a,b):g.call(null,k,this,a,b),c=I(c),d=null,e=0),f=0;else break};h.Eb=function(a,b,c){this.ja=R.o(this.ja,b,c);return this};
h.Fb=function(a,b){return this.ja=rd.m(this.ja,b)};h.U=function(){return da(this)};function Ze(a){return new Ye(a)}function $e(a,b){if(a instanceof Ye){var c=a.xc;if(null!=c&&!u(c.j?c.j(b):c.call(null,b)))throw Error("Validator rejected reference state");c=a.state;a.state=b;null!=a.ja&&a.Xb(c,b);return b}return gc(a,b)}
var af=function af(a){switch(arguments.length){case 2:return af.m(arguments[0],arguments[1]);case 3:return af.o(arguments[0],arguments[1],arguments[2]);case 4:return af.I(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=4<c.length?new G(c.slice(4),0,null):null;return af.v(arguments[0],arguments[1],arguments[2],arguments[3],c)}};
af.m=function(a,b){if(a instanceof Ye){var c=a.state;b=b.j?b.j(c):b.call(null,c);a=$e(a,b)}else a=hc(a,b);return a};af.o=function(a,b,c){if(a instanceof Ye){var d=a.state;b=b.m?b.m(d,c):b.call(null,d,c);a=$e(a,b)}else a=hc(a,b,c);return a};af.I=function(a,b,c,d){if(a instanceof Ye){var e=a.state;b=b.o?b.o(e,c,d):b.call(null,e,c,d);a=$e(a,b)}else a=hc(a,b,c,d);return a};af.v=function(a,b,c,d,e){return a instanceof Ye?$e(a,Fe(b,a.state,c,d,e)):hc(a,b,c,d,e)};
af.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);var e=I(d);d=H(e);e=I(e);return this.v(b,a,c,d,e)};af.D=4;function bf(){this.state=null;this.A=32768;this.J=0}bf.prototype.Fc=function(a,b){return this.state=b};bf.prototype.ta=function(){return this.state};function cf(a,b){jc(a,b)}
function df(a,b){return function f(d,e){return new le(null,function(){var g=D(e);if(g){if(Gd(g)){for(var k=ec(g),l=M(k),p=pe(l),q=0;;)if(q<l){var t=function(){var w=d+q,z=db(k,q);return a.m?a.m(w,z):a.call(null,w,z)}();null!=t&&p.add(t);q+=1}else break;return re(p.T(),f(d+l,fc(g)))}l=function(){var w=H(g);return a.m?a.m(d,w):a.call(null,d,w)}();return null==l?f(d+1,Kc(g)):id(l,f(d+1,Kc(g)))}return null},null)}(0,b)}
var ef=function ef(a){switch(arguments.length){case 1:return ef.j(arguments[0]);case 2:return ef.m(arguments[0],arguments[1]);case 3:return ef.o(arguments[0],arguments[1],arguments[2]);case 4:return ef.I(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=4<c.length?new G(c.slice(4),0,null):null;return ef.v(arguments[0],arguments[1],arguments[2],arguments[3],c)}};
ef.j=function(a){return function(b){return function(){function c(k,l){l=a.j?a.j(l):a.call(null,l);return b.m?b.m(k,l):b.call(null,k,l)}function d(k){return b.j?b.j(k):b.call(null,k)}function e(){return b.H?b.H():b.call(null)}var f=null,g=function(){function k(p,q,t){var w=null;if(2<arguments.length){w=0;for(var z=Array(arguments.length-2);w<z.length;)z[w]=arguments[w+2],++w;w=new G(z,0,null)}return l.call(this,p,q,w)}function l(p,q,t){q=De(a,q,t);return b.m?b.m(p,q):b.call(null,p,q)}k.D=2;k.F=function(p){var q=
H(p);p=I(p);var t=H(p);p=Kc(p);return l(q,t,p)};k.v=l;return k}();f=function(k,l,p){switch(arguments.length){case 0:return e.call(this);case 1:return d.call(this,k);case 2:return c.call(this,k,l);default:var q=null;if(2<arguments.length){q=0;for(var t=Array(arguments.length-2);q<t.length;)t[q]=arguments[q+2],++q;q=new G(t,0,null)}return g.v(k,l,q)}throw Error("Invalid arity: "+arguments.length);};f.D=2;f.F=g.F;f.H=e;f.j=d;f.m=c;f.v=g.v;return f}()}};
ef.m=function(a,b){return new le(null,function(){var c=D(b);if(c){if(Gd(c)){for(var d=ec(c),e=M(d),f=pe(e),g=0;;)if(g<e)se(f,function(){var k=db(d,g);return a.j?a.j(k):a.call(null,k)}()),g+=1;else break;return re(f.T(),ef.m(a,fc(c)))}return id(function(){var k=H(c);return a.j?a.j(k):a.call(null,k)}(),ef.m(a,Kc(c)))}return null},null)};
ef.o=function(a,b,c){return new le(null,function(){var d=D(b),e=D(c);if(d&&e){var f=H(d);var g=H(e);f=a.m?a.m(f,g):a.call(null,f,g);d=id(f,ef.o(a,Kc(d),Kc(e)))}else d=null;return d},null)};ef.I=function(a,b,c,d){return new le(null,function(){var e=D(b),f=D(c),g=D(d);if(e&&f&&g){var k=H(e);var l=H(f),p=H(g);k=a.o?a.o(k,l,p):a.call(null,k,l,p);e=id(k,ef.I(a,Kc(e),Kc(f),Kc(g)))}else e=null;return e},null)};
ef.v=function(a,b,c,d,e){return ef.m(function(f){return Ce(a,f)},function k(g){return new le(null,function(){var l=ef.m(D,g);return Oe($d,l)?id(ef.m(H,l),k(ef.m(Kc,l))):null},null)}(ld.v(e,d,O([c,b]))))};ef.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);var e=I(d);d=H(e);e=I(e);return this.v(b,a,c,d,e)};ef.D=4;function ff(a,b){return new le(null,function(){if(0<a){var c=D(b);return c?id(H(c),ff(a-1,Kc(c))):null}return null},null)}
function gf(a,b){if(null!=b&&(b.J&262144||n===b.Dd)){var c=0<a?b.Ia(null,Math.ceil(a)):D(b);return u(c)?c:Lc}return new le(null,function(){a:for(var d=a,e=b;;)if(e=D(e),0<d&&e)--d,e=Kc(e);else break a;return e},null)}function hf(a){return ef.o(function(b){return b},a,gf(2,a))}function jf(a){var b=D(a);for(a=D(gf(2,a));;)if(a)b=I(b),a=I(a);else return b}function kf(a,b,c,d){this.meta=a;this.count=b;this.K=c;this.next=d;this.C=null;this.A=32374988;this.J=262145}h=kf.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,this.count)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){return null==this.next?1<this.count?this.next=new kf(null,this.count-1,this.K,null):-1===this.count?this:null:this.next};
h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){if(-1===this.count)for(var c=b.m?b.m(this.K,this.K):b.call(null,this.K,this.K);;){if(Wc(c))return A(c);c=b.m?b.m(c,this.K):b.call(null,c,this.K)}else for(a=1,c=this.K;;)if(a<this.count){c=b.m?b.m(c,this.K):b.call(null,c,this.K);if(Wc(c))return A(c);a+=1}else return c};
h.la=function(a,b,c){if(-1===this.count)for(c=b.m?b.m(c,this.K):b.call(null,c,this.K);;){if(Wc(c))return A(c);c=b.m?b.m(c,this.K):b.call(null,c,this.K)}else for(a=0;;)if(a<this.count){c=b.m?b.m(c,this.K):b.call(null,c,this.K);if(Wc(c))return A(c);a+=1}else return c};h.ga=function(){return this.K};h.ia=function(){return null==this.next?1<this.count?this.next=new kf(null,this.count-1,this.K,null):-1===this.count?this:Lc:this.next};h.W=function(){return this};
h.Y=function(a,b){return b===this.meta?this:new kf(b,this.count,this.K,this.next)};h.da=function(a,b){return id(b,this)};h.Ia=function(a,b){if(-1===this.count)return this;a=this.count-b;return 0<a?new kf(null,a,this.K,null):null};function lf(a,b){return 0<a?new kf(null,a,b,null):Lc}function mf(a,b){return Ce(ve,De(ef,a,b))}
function nf(a,b){return new le(null,function(){var c=D(b);if(c){if(Gd(c)){for(var d=ec(c),e=M(d),f=pe(e),g=0;;)if(g<e){var k=db(d,g);k=a.j?a.j(k):a.call(null,k);if(u(k)){k=f;var l=db(d,g);k.add(l)}g+=1}else break;return re(f.T(),nf(a,fc(c)))}d=H(c);c=Kc(c);return u(a.j?a.j(d):a.call(null,d))?id(d,nf(a,c)):nf(a,c)}return null},null)}function of(a,b){return nf(Qe(a),b)}
function pf(a){return function d(c){return new le(null,function(){return id(c,u(Cd.j?Cd.j(c):Cd.call(null,c))?mf(d,O([D.j?D.j(c):D.call(null,c)])):null)},null)}(a)}function qf(a){return nf(function(b){return!Cd(b)},Kc(pf(a)))}
var Te=function Te(a){switch(arguments.length){case 0:return Te.H();case 1:return Te.j(arguments[0]);case 2:return Te.m(arguments[0],arguments[1]);case 3:return Te.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};Te.H=function(){return md};Te.j=function(a){return a};Te.m=function(a,b){return null!=a?null!=a&&(a.J&4||n===a.Wc)?Fb($b(Sa(Zb,Yb(a),b)),wd(a)):Sa(bb,a,b):Sa(ld,a,b)};
Te.o=function(a,b,c){if(null!=a&&(a.J&4||n===a.Wc)){var d=wd(a);return ae(b,function(){function e(g){return Fb($b(g),d)}var f=null;f=function(g,k){switch(arguments.length){case 1:return e.call(this,g);case 2:return Zb(g,k)}throw Error("Invalid arity: "+arguments.length);};f.j=e;f.m=function(g,k){return Zb(g,k)};return f}(),Yb(a),c)}return ae(b,ld,a,c)};Te.D=3;function rf(a,b){return $b(Sa(function(c,d){d=a.j?a.j(d):a.call(null,d);return Zb(c,d)},Yb(md),b))}
function sf(a,b,c){return new le(null,function(){var d=D(c);if(d){var e=ff(a,d);return a===M(e)?id(e,sf(a,b,gf(b,d))):null}return null},null)}function tf(a,b){for(b=D(b);;){if(null==b)return a;a=B(a,H(b));b=I(b)}}
var uf=function uf(a,b,c){var e=D(b);b=H(e);var f=I(e);if(f){e=R.o;var g=B(a,b);c=uf.o?uf.o(g,f,c):uf.call(null,g,f,c);a=e.call(R,a,b,c)}else a=R.o(a,b,c);return a},vf=function vf(a){switch(arguments.length){case 3:return vf.o(arguments[0],arguments[1],arguments[2]);case 4:return vf.I(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return vf.O(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return vf.ya(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],
arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=6<c.length?new G(c.slice(6),0,null):null;return vf.v(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],c)}};vf.o=function(a,b,c){var d=D(b);b=H(d);if(d=I(d))a=R.o(a,b,vf.o(B(a,b),d,c));else{d=R.o;var e=B(a,b);c=c.j?c.j(e):c.call(null,e);a=d.call(R,a,b,c)}return a};
vf.I=function(a,b,c,d){var e=D(b);b=H(e);if(e=I(e))a=R.o(a,b,vf.I(B(a,b),e,c,d));else{e=R.o;var f=B(a,b);c=c.m?c.m(f,d):c.call(null,f,d);a=e.call(R,a,b,c)}return a};vf.O=function(a,b,c,d,e){var f=D(b);b=H(f);if(f=I(f))a=R.o(a,b,vf.O(B(a,b),f,c,d,e));else{f=R.o;var g=B(a,b);c=c.o?c.o(g,d,e):c.call(null,g,d,e);a=f.call(R,a,b,c)}return a};
vf.ya=function(a,b,c,d,e,f){var g=D(b);b=H(g);if(g=I(g))a=R.o(a,b,vf.ya(B(a,b),g,c,d,e,f));else{g=R.o;var k=B(a,b);c=c.I?c.I(k,d,e,f):c.call(null,k,d,e,f);a=g.call(R,a,b,c)}return a};vf.v=function(a,b,c,d,e,f,g){var k=D(b);b=H(k);return(k=I(k))?R.o(a,b,Ge(vf,B(a,b),k,c,d,O([e,f,g]))):R.o(a,b,Ge(c,B(a,b),d,e,f,O([g])))};vf.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);var e=I(d);d=H(e);var f=I(e);e=H(f);var g=I(f);f=H(g);g=I(g);return this.v(b,a,c,d,e,f,g)};vf.D=6;
var wf=function wf(a){switch(arguments.length){case 3:return wf.o(arguments[0],arguments[1],arguments[2]);case 4:return wf.I(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return wf.O(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return wf.ya(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=6<c.length?new G(c.slice(6),0,null):null;return wf.v(arguments[0],
arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],c)}};wf.o=function(a,b,c){var d=R.o,e=B(a,b);c=c.j?c.j(e):c.call(null,e);return d.call(R,a,b,c)};wf.I=function(a,b,c,d){var e=R.o,f=B(a,b);c=c.m?c.m(f,d):c.call(null,f,d);return e.call(R,a,b,c)};wf.O=function(a,b,c,d,e){var f=R.o,g=B(a,b);c=c.o?c.o(g,d,e):c.call(null,g,d,e);return f.call(R,a,b,c)};wf.ya=function(a,b,c,d,e,f){var g=R.o,k=B(a,b);c=c.I?c.I(k,d,e,f):c.call(null,k,d,e,f);return g.call(R,a,b,c)};
wf.v=function(a,b,c,d,e,f,g){return R.o(a,b,Ge(c,B(a,b),d,e,f,O([g])))};wf.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);var e=I(d);d=H(e);var f=I(e);e=H(f);var g=I(f);f=H(g);g=I(g);return this.v(b,a,c,d,e,f,g)};wf.D=6;function xf(a,b){this.Z=a;this.u=b}function yf(a){return new xf(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}
function zf(a){return new xf(a.Z,Qa(a.u))}function Af(a){a=a.B;return 32>a?0:a-1>>>5<<5}function Bf(a,b,c){for(;;){if(0===b)return c;var d=yf(a);d.u[0]=c;c=d;b-=5}}var Cf=function Cf(a,b,c,d){var f=zf(c),g=a.B-1>>>b&31;5===b?f.u[g]=d:(c=c.u[g],null!=c?(b-=5,a=Cf.I?Cf.I(a,b,c,d):Cf.call(null,a,b,c,d)):a=Bf(null,b-5,d),f.u[g]=a);return f};function Df(a,b){throw Error(["No item ",y.j(a)," in vector of length ",y.j(b)].join(""));}
function Ef(a,b){if(b>=Af(a))return a.tail;var c=a.root;for(a=a.shift;;)if(0<a){var d=a-5;c=c.u[b>>>a&31];a=d}else return c.u}function If(a,b){return 0<=b&&b<a.B?Ef(a,b):Df(b,a.B)}
var Jf=function Jf(a,b,c,d,e){var g=zf(c);if(0===b)g.u[d&31]=e;else{var k=d>>>b&31;b-=5;c=c.u[k];a=Jf.O?Jf.O(a,b,c,d,e):Jf.call(null,a,b,c,d,e);g.u[k]=a}return g},Kf=function Kf(a,b,c){var e=a.B-2>>>b&31;if(5<b){b-=5;var f=c.u[e];a=Kf.o?Kf.o(a,b,f):Kf.call(null,a,b,f);if(null==a&&0===e)return null;c=zf(c);c.u[e]=a;return c}if(0===e)return null;c=zf(c);c.u[e]=null;return c};function Lf(a,b,c,d,e,f){this.i=a;this.base=b;this.u=c;this.ha=d;this.start=e;this.end=f}
Lf.prototype.ea=function(){return this.i<this.end};Lf.prototype.next=function(){32===this.i-this.base&&(this.u=Ef(this.ha,this.i),this.base+=32);var a=this.u[this.i&31];this.i+=1;return a};function Mf(a,b,c){return new Lf(b,b-b%32,b<M(a)?Ef(a,b):null,a,b,c)}function Nf(a,b,c,d){return c<d?Of(a,b,ed(a,c),c+1,d):b.H?b.H():b.call(null)}
function Of(a,b,c,d,e){var f=c;c=d;for(d=Ef(a,d);;)if(c<e){var g=c&31;d=0===g?Ef(a,c):d;g=d[g];f=b.m?b.m(f,g):b.call(null,f,g);if(Wc(f))return A(f);c+=1}else return f}function T(a,b,c,d,e,f){this.meta=a;this.B=b;this.shift=c;this.root=d;this.tail=e;this.C=f;this.A=167666463;this.J=401412}h=T.prototype;h.rb=function(a,b){return 0<=b&&b<this.B?new Pf(b,Ef(this,b)[b&31]):null};h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return"number"===typeof b?this.qa(null,b,c):c};
h.Bb=function(a,b,c){a=0;for(var d=c;;)if(a<this.B){var e=Ef(this,a);c=e.length;a:for(var f=0;;)if(f<c){var g=f+a,k=e[f];d=b.o?b.o(d,g,k):b.call(null,d,g,k);if(Wc(d)){e=d;break a}f+=1}else{e=d;break a}if(Wc(e))return A(e);a+=c;d=e}else return d};h.kc=n;h.M=function(a,b){return If(this,b)[b&31]};h.qa=function(a,b,c){return 0<=b&&b<this.B?Ef(this,b)[b&31]:c};
h.kb=function(a,b,c){if(0<=b&&b<this.B)return Af(this)<=b?(a=Qa(this.tail),a[b&31]=c,new T(this.meta,this.B,this.shift,this.root,a,null)):new T(this.meta,this.B,this.shift,Jf(this,this.shift,this.root,b,c),this.tail,null);if(b===this.B)return this.da(null,c);throw Error(["Index ",y.j(b)," out of bounds  [0,",y.j(this.B),"]"].join(""));};h.xa=function(){return Mf(this,0,this.B)};h.V=function(){return this.meta};h.$=function(){return this.B};h.ib=function(){return 0<this.B?this.M(null,this.B-1):null};
h.jb=function(){if(0===this.B)throw Error("Can't pop empty vector");if(1===this.B)return Fb(md,this.meta);if(1<this.B-Af(this))return new T(this.meta,this.B-1,this.shift,this.root,this.tail.slice(0,-1),null);var a=Ef(this,this.B-2),b=Kf(this,this.shift,this.root);b=null==b?U:b;var c=this.B-1;return 5<this.shift&&null==b.u[1]?new T(this.meta,c,this.shift-5,b.u[0],a,null):new T(this.meta,c,this.shift,b,a,null)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};
h.S=function(a,b){if(b instanceof T)if(this.B===M(b))for(a=this.xa(null),b=b.xa(null);;)if(a.ea()){var c=a.next(),d=b.next();if(!J.m(c,d))return!1}else return!0;else return!1;else return hd(this,b)};h.qb=function(){return new Qf(this.B,this.shift,Rf.j?Rf.j(this.root):Rf.call(null,this.root),Sf.j?Sf.j(this.tail):Sf.call(null,this.tail))};h.ba=function(){return Fb(md,this.meta)};h.ka=function(a,b){return Nf(this,b,0,this.B)};
h.la=function(a,b,c){a=0;for(var d=c;;)if(a<this.B){var e=Ef(this,a);c=e.length;a:for(var f=0;;)if(f<c){var g=e[f];d=b.m?b.m(d,g):b.call(null,d,g);if(Wc(d)){e=d;break a}f+=1}else{e=d;break a}if(Wc(e))return A(e);a+=c;d=e}else return d};h.Ha=function(a,b,c){if("number"===typeof b)return this.kb(null,b,c);throw Error("Vector's key for assoc must be a number.");};h.Sa=function(a,b){return Md(b)?0<=b&&b<this.B:!1};
h.W=function(){if(0===this.B)return null;if(32>=this.B)return new G(this.tail,0,null);a:{var a=this.root;for(var b=this.shift;;)if(0<b)b-=5,a=a.u[0];else{a=a.u;break a}}return Tf?Tf(this,a,0,0):Uf.call(null,this,a,0,0)};h.Y=function(a,b){return b===this.meta?this:new T(b,this.B,this.shift,this.root,this.tail,this.C)};
h.da=function(a,b){if(32>this.B-Af(this)){a=this.tail.length;for(var c=Array(a+1),d=0;;)if(d<a)c[d]=this.tail[d],d+=1;else break;c[a]=b;return new T(this.meta,this.B+1,this.shift,this.root,c,null)}a=(c=this.B>>>5>1<<this.shift)?this.shift+5:this.shift;c?(c=yf(null),c.u[0]=this.root,d=Bf(null,this.shift,new xf(null,this.tail)),c.u[1]=d):c=Cf(this,this.shift,this.root,new xf(null,this.tail));return new T(this.meta,this.B+1,a,c,[b],null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){if("number"===typeof a)return this.M(null,a);throw Error("Key must be integer");};h.Ia=function(a,b){if(b<this.B){a=b%32;var c=Ef(this,b);b-=a;return Tf?Tf(this,c,b,a):Uf.call(null,this,c,b,a)}return null};
var U=new xf(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),md=new T(null,0,5,U,[],Qc);function Vf(a,b){var c=a.length;a=b?a:Qa(a);if(32>c)return new T(null,c,5,U,a,null);var d=a.slice(0,32);b=32;for(var e=(new T(null,32,5,U,d,null)).qb(null);;)if(b<c)d=b+1,e=Zb(e,a[b]),b=d;else return $b(e)}T.prototype[Pa]=function(){return Nc(this)};
function Wf(a){return u(Xf.j?Xf.j(a):Xf.call(null,a))?new T(null,2,5,U,[Yf.j?Yf.j(a):Yf.call(null,a),Zf.j?Zf.j(a):Zf.call(null,a)],null):Fd(a)?vd(a,null):Ja(a)?Vf(a,!0):$b(Sa(Zb,Yb(md),a))}var We=function We(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=0<c.length?new G(c.slice(0),0,null):null;return We.v(c)};We.v=function(a){return a instanceof G&&0===a.i?Vf(a.u,!Ja(a.u)):Wf(a)};We.D=0;We.F=function(a){return this.v(D(a))};
function $f(a,b,c,d,e){this.pa=a;this.node=b;this.i=c;this.ma=d;this.meta=e;this.C=null;this.A=32375020;this.J=263680}h=$f.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){if(this.ma+1<this.node.length){var a=this.pa;var b=this.node,c=this.i,d=this.ma+1;a=Tf?Tf(a,b,c,d):Uf.call(null,a,b,c,d);return null==a?null:a}return this.Sb()};
h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Nf(this.pa,b,this.i+this.ma,M(this.pa))};h.la=function(a,b,c){return Of(this.pa,b,c,this.i+this.ma,M(this.pa))};h.ga=function(){return this.node[this.ma]};h.ia=function(){if(this.ma+1<this.node.length){var a=this.pa;var b=this.node,c=this.i,d=this.ma+1;a=Tf?Tf(a,b,c,d):Uf.call(null,a,b,c,d);return null==a?Lc:a}return this.Ma(null)};h.W=function(){return this};
h.Ab=function(){var a=this.node;return new oe(a,this.ma,a.length)};h.Ma=function(){var a=this.i+this.node.length;if(a<Xa(this.pa)){var b=this.pa,c=Ef(this.pa,a);return Tf?Tf(b,c,a,0):Uf.call(null,b,c,a,0)}return Lc};h.Y=function(a,b){return b===this.meta?this:ag?ag(this.pa,this.node,this.i,this.ma,b):Uf.call(null,this.pa,this.node,this.i,this.ma,b)};h.da=function(a,b){return id(b,this)};
h.Ia=function(a,b){a=this.ma+b;if(a<this.node.length)return Tf?Tf(this.pa,this.node,this.i,a):Uf.call(null,this.pa,this.node,this.i,a);var c=this.i+a;if(c<Xa(this.pa)){a=c%32;b=this.pa;var d=Ef(this.pa,c);c-=a;return Tf?Tf(b,d,c,a):Uf.call(null,b,d,c,a)}return null};h.Sb=function(){var a=this.i+this.node.length;if(a<Xa(this.pa)){var b=this.pa,c=Ef(this.pa,a);return Tf?Tf(b,c,a,0):Uf.call(null,b,c,a,0)}return null};$f.prototype[Pa]=function(){return Nc(this)};
function Uf(a){switch(arguments.length){case 3:var b=arguments[0],c=arguments[1],d=arguments[2];return new $f(b,If(b,c),c,d,null);case 4:return Tf(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return ag(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}function Tf(a,b,c,d){return new $f(a,b,c,d,null)}function ag(a,b,c,d,e){return new $f(a,b,c,d,e)}
function bg(a,b,c,d,e){this.meta=a;this.ha=b;this.start=c;this.end=d;this.C=e;this.A=167666463;this.J=139264}h=bg.prototype;h.rb=function(a,b){if(0>b)return null;a=this.start+b;return a<this.end?new Pf(b,kb(this.ha,a)):null};h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return"number"===typeof b?this.qa(null,b,c):c};
h.Bb=function(a,b,c){a=this.start;for(var d=0;;)if(a<this.end){var e=d,f=db(this.ha,a);c=b.o?b.o(c,e,f):b.call(null,c,e,f);if(Wc(c))return A(c);d+=1;a+=1}else return c};h.M=function(a,b){return 0>b||this.end<=this.start+b?Df(b,this.end-this.start):db(this.ha,this.start+b)};h.qa=function(a,b,c){return 0>b||this.end<=this.start+b?c:db(this.ha,this.start+b,c)};
h.kb=function(a,b,c){a=this.start+b;if(0>b||this.end+1<=a)throw Error(["Index ",y.j(b)," out of bounds [0,",y.j(this.$(null)),"]"].join(""));b=this.meta;c=R.o(this.ha,a,c);var d=this.start,e=this.end;a+=1;a=e>a?e:a;return cg.O?cg.O(b,c,d,a,null):cg.call(null,b,c,d,a,null)};h.xa=function(){return null!=this.ha&&n===this.ha.kc?Mf(this.ha,this.start,this.end):new Ne(this)};h.V=function(){return this.meta};h.$=function(){return this.end-this.start};
h.ib=function(){return this.start===this.end?null:db(this.ha,this.end-1)};h.jb=function(){if(this.start===this.end)throw Error("Can't pop empty vector");var a=this.meta,b=this.ha,c=this.start,d=this.end-1;return cg.O?cg.O(a,b,c,d,null):cg.call(null,a,b,c,d,null)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Fb(md,this.meta)};
h.ka=function(a,b){return null!=this.ha&&n===this.ha.kc?Nf(this.ha,b,this.start,this.end):Yc(this,b)};h.la=function(a,b,c){return null!=this.ha&&n===this.ha.kc?Of(this.ha,b,c,this.start,this.end):Zc(this,b,c)};h.Ha=function(a,b,c){if("number"===typeof b)return this.kb(null,b,c);throw Error("Subvec's key for assoc must be a number.");};h.Sa=function(a,b){return Md(b)?0<=b&&b<this.end-this.start:!1};
h.W=function(){var a=this;return function d(c){return c===a.end?null:id(db(a.ha,c),new le(null,function(){return d(c+1)},null))}(a.start)};h.Y=function(a,b){return b===this.meta?this:cg.O?cg.O(b,this.ha,this.start,this.end,this.C):cg.call(null,b,this.ha,this.start,this.end,this.C)};h.da=function(a,b){a=this.meta;b=Bb(this.ha,this.end,b);var c=this.start,d=this.end+1;return cg.O?cg.O(a,b,c,d,null):cg.call(null,a,b,c,d,null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.M(null,a)};h.m=function(a,b){return this.qa(null,a,b)};bg.prototype[Pa]=function(){return Nc(this)};
function cg(a,b,c,d,e){for(;;)if(b instanceof bg)c=b.start+c,d=b.start+d,b=b.ha;else{if(!Fd(b))throw Error("v must satisfy IVector");if(0>c||d<c||d>M(b))throw Error("Index out of bounds");return new bg(a,b,c,d,e)}}var dg=function dg(a){switch(arguments.length){case 2:return dg.m(arguments[0],arguments[1]);case 3:return dg.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};dg.m=function(a,b){return dg.o(a,b,M(a))};
dg.o=function(a,b,c){return cg(null,a,b|0,c|0,null)};dg.D=3;function eg(a,b){return a===b.Z?b:new xf(a,Qa(b.u))}function Rf(a){return new xf({},Qa(a.u))}function Sf(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];Hd(a,0,b,0,a.length);return b}
var fg=function fg(a,b,c,d){c=eg(a.root.Z,c);var f=a.B-1>>>b&31;if(5===b)a=d;else{var g=c.u[f];null!=g?(b-=5,a=fg.I?fg.I(a,b,g,d):fg.call(null,a,b,g,d)):a=Bf(a.root.Z,b-5,d)}c.u[f]=a;return c};function Qf(a,b,c,d){this.B=a;this.shift=b;this.root=c;this.tail=d;this.J=88;this.A=275}h=Qf.prototype;
h.ub=function(a,b){if(this.root.Z){if(32>this.B-Af(this))this.tail[this.B&31]=b;else{a=new xf(this.root.Z,this.tail);var c=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];c[0]=b;this.tail=c;this.B>>>5>1<<this.shift?(b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],c=this.shift+
5,b[0]=this.root,b[1]=Bf(this.root.Z,this.shift,a),this.root=new xf(this.root.Z,b),this.shift=c):this.root=fg(this,this.shift,this.root,a)}this.B+=1;return this}throw Error("conj! after persistent!");};h.Db=function(){if(this.root.Z){this.root.Z=null;var a=this.B-Af(this),b=Array(a);Hd(this.tail,0,b,0,a);return new T(null,this.B,this.shift,this.root,b,null)}throw Error("persistent! called twice");};
h.tb=function(a,b,c){if("number"===typeof b)return gg(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
function gg(a,b,c){if(a.root.Z){if(0<=b&&b<a.B){if(Af(a)<=b)a.tail[b&31]=c;else{var d=function k(f,g){g=eg(a.root.Z,g);if(0===f)g.u[b&31]=c;else{var l=b>>>f&31;f=k(f-5,g.u[l]);g.u[l]=f}return g}(a.shift,a.root);a.root=d}return a}if(b===a.B)return a.ub(null,c);throw Error(["Index ",y.j(b)," out of bounds for TransientVector of length",y.j(a.B)].join(""));}throw Error("assoc! after persistent!");}h.$=function(){if(this.root.Z)return this.B;throw Error("count after persistent!");};
h.M=function(a,b){if(this.root.Z)return If(this,b)[b&31];throw Error("nth after persistent!");};h.qa=function(a,b,c){return 0<=b&&b<this.B?this.M(null,b):c};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){if(this.root.Z)return"number"===typeof b?this.qa(null,b,c):c;throw Error("lookup after persistent!");};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.ra(null,a)};h.m=function(a,b){return this.X(null,a,b)};function hg(a,b){this.wb=a;this.Nb=b}hg.prototype.ea=function(){var a=null!=this.wb&&D(this.wb);return a?a:(a=null!=this.Nb)?this.Nb.ea():a};
hg.prototype.next=function(){if(null!=this.wb){var a=H(this.wb);this.wb=I(this.wb);return a}if(null!=this.Nb&&this.Nb.ea())return this.Nb.next();throw Error("No such element");};hg.prototype.remove=function(){return Error("Unsupported operation")};function ig(a,b,c,d){this.meta=a;this.wa=b;this.za=c;this.C=d;this.A=31850700;this.J=0}h=ig.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){var a=I(this.wa);return a?new ig(this.meta,a,this.za,null):null!=this.za?new ig(this.meta,this.za,null,null):null};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Fb(Lc,this.meta)};h.ga=function(){return H(this.wa)};h.ia=function(){var a=I(this.wa);return a?new ig(this.meta,a,this.za,null):null==this.za?this.ba(null):new ig(this.meta,this.za,null,null)};h.W=function(){return this};h.Y=function(a,b){return b===this.meta?this:new ig(b,this.wa,this.za,this.C)};h.da=function(a,b){return id(b,this)};ig.prototype[Pa]=function(){return Nc(this)};
function jg(a,b,c,d,e){this.meta=a;this.count=b;this.wa=c;this.za=d;this.C=e;this.J=139264;this.A=31858766}h=jg.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,this.count.j?this.count.j(this):this.count.call(null,this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.xa=function(){return new hg(this.wa,mc(this.za))};h.V=function(){return this.meta};h.$=function(){return this.count};h.ib=function(){return H(this.wa)};
h.jb=function(){if(u(this.wa)){var a=I(this.wa);return a?new jg(this.meta,this.count-1,a,this.za,null):new jg(this.meta,this.count-1,D(this.za),md,null)}return this};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Fb(kg,this.meta)};h.ga=function(){return H(this.wa)};h.ia=function(){return Kc(D(this))};h.W=function(){var a=D(this.za),b=this.wa;return u(u(b)?b:a)?new ig(null,this.wa,D(a),null):null};
h.Y=function(a,b){return b===this.meta?this:new jg(b,this.count,this.wa,this.za,this.C)};h.da=function(a,b){u(this.wa)?(a=this.za,b=new jg(this.meta,this.count+1,this.wa,ld.m(u(a)?a:md,b),null)):b=new jg(this.meta,this.count+1,ld.m(this.wa,b),md,null);return b};var kg=new jg(null,0,null,md,Qc);jg.prototype[Pa]=function(){return Nc(this)};function lg(){this.A=2097152;this.J=0}lg.prototype.S=function(){return!1};var mg=new lg;
function ng(a,b){return Kd(Dd(b)&&!Ed(b)?M(a)===M(b)?(null!=a?a.A&1048576||n===a.ad||(a.A?0:v(Jb,a)):v(Jb,a))?Zd(function(c,d,e){return J.m(Gc(b,d,mg),e)?!0:new Uc},!0,a):Oe(function(c){return J.m(Gc(b,H(c),mg),jd(c))},a):null:null)}function og(a){this.s=a}og.prototype.next=function(){if(null!=this.s){var a=H(this.s),b=Q(a,0,null);a=Q(a,1,null);this.s=I(this.s);return{value:[b,a],done:!1}}return{value:null,done:!0}};function pg(a){this.s=a}
pg.prototype.next=function(){if(null!=this.s){var a=H(this.s);this.s=I(this.s);return{value:[a,a],done:!1}}return{value:null,done:!0}};
function qg(a,b){if(b instanceof C)a:{var c=a.length;b=b.va;for(var d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof C&&b===a[d].va){a=d;break a}d+=2}}else if("string"===typeof b||"number"===typeof b)a:for(c=a.length,d=0;;){if(c<=d){a=-1;break a}if(b===a[d]){a=d;break a}d+=2}else if(b instanceof Ec)a:for(c=a.length,b=b.Ga,d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof Ec&&b===a[d].Ga){a=d;break a}d+=2}else if(null==b)a:for(b=a.length,c=0;;){if(b<=c){a=-1;break a}if(null==a[c]){a=c;break a}c+=2}else a:for(c=
a.length,d=0;;){if(c<=d){a=-1;break a}if(J.m(b,a[d])){a=d;break a}d+=2}return a}function Pf(a,b){this.key=a;this.K=b;this.C=null;this.A=166619935;this.J=0}h=Pf.prototype;h.rb=function(a,b){switch(b){case 0:return new Pf(0,this.key);case 1:return new Pf(1,this.K);default:return null}};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.ra=function(a,b){return this.qa(null,b,null)};h.X=function(a,b,c){return this.qa(null,b,c)};h.M=function(a,b){if(0===b)return this.key;if(1===b)return this.K;throw Error("Index out of bounds");};
h.qa=function(a,b,c){return 0===b?this.key:1===b?this.K:c};h.kb=function(a,b,c){return(new T(null,2,5,U,[this.key,this.K],null)).kb(null,b,c)};h.V=function(){return null};h.$=function(){return 2};h.dd=function(){return this.key};h.ed=function(){return this.K};h.ib=function(){return this.K};h.jb=function(){return new T(null,1,5,U,[this.key],null)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return null};
h.ka=function(a,b){return Yc(this,b)};h.la=function(a,b,c){return Zc(this,b,c)};h.Ha=function(a,b,c){return R.o(new T(null,2,5,U,[this.key,this.K],null),b,c)};h.Sa=function(a,b){return 0===b||1===b};h.W=function(){return new G([this.key,this.K],0,null)};h.Y=function(a,b){return vd(new T(null,2,5,U,[this.key,this.K],null),b)};h.da=function(a,b){return new T(null,3,5,U,[this.key,this.K,b],null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.M(null,a)};h.m=function(a,b){return this.qa(null,a,b)};function Xf(a){return null!=a?a.A&2048||n===a.Jd?!0:!1:!1}function rg(a,b,c){this.u=a;this.i=b;this.Ea=c;this.A=32374990;this.J=262144}h=rg.prototype;
h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.Ea};h.fa=function(){return this.i<this.u.length-2?new rg(this.u,this.i+2,null):null};h.$=function(){return(this.u.length-this.i)/2};h.U=function(){return Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return new Pf(this.u[this.i],this.u[this.i+1])};h.ia=function(){return this.i<this.u.length-2?new rg(this.u,this.i+2,null):Lc};h.W=function(){return this};h.Y=function(a,b){return b===this.Ea?this:new rg(this.u,this.i,b)};h.da=function(a,b){return id(b,this)};h.Ia=function(a,b){return b<this.$(null)?new rg(this.u,this.i+2*b,null):null};
rg.prototype[Pa]=function(){return Nc(this)};function sg(a,b){this.u=a;this.i=0;this.B=b}sg.prototype.ea=function(){return this.i<this.B};sg.prototype.next=function(){var a=new Pf(this.u[this.i],this.u[this.i+1]);this.i+=2;return a};function r(a,b,c,d){this.meta=a;this.B=b;this.u=c;this.C=d;this.A=16647951;this.J=401412}h=r.prototype;h.rb=function(a,b){a=qg(this.u,b);return-1===a?null:new Pf(this.u[a],this.u[a+1])};h.toString=function(){return pc(this)};
h.keys=function(){return Nc(tg.j?tg.j(this):tg.call(null,this))};h.entries=function(){return new og(D(D(this)))};h.values=function(){return Nc(ug.j?ug.j(this):ug.call(null,this))};h.has=function(a){return Nd(this,a)};h.get=function(a,b){return this.X(null,a,b)};
h.forEach=function(a){for(var b=D(this),c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e),g=Q(f,0,null);f=Q(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=D(b))Gd(b)?(c=ec(b),b=fc(b),g=c,d=M(c),c=g):(c=H(b),g=Q(c,0,null),f=Q(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=I(b),c=null,d=0),e=0;else return null};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){a=qg(this.u,b);return-1===a?c:this.u[a+1]};
h.Bb=function(a,b,c){a=this.u.length;for(var d=0;;)if(d<a){var e=this.u[d],f=this.u[d+1];c=b.o?b.o(c,e,f):b.call(null,c,e,f);if(Wc(c))return A(c);d+=2}else return c};h.xa=function(){return new sg(this.u,2*this.B)};h.V=function(){return this.meta};h.$=function(){return this.B};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Rc(this)};
h.S=function(a,b){if(Dd(b)&&!Ed(b))if(a=this.u.length,this.B===b.$(null))for(var c=0;;)if(c<a){var d=b.X(null,this.u[c],Id);if(d!==Id)if(J.m(this.u[c+1],d))c+=2;else return!1;else return!1}else return!0;else return!1;else return!1};h.qb=function(){return new vg(this.u.length,Qa(this.u))};h.ba=function(){return Fb(He,this.meta)};h.ka=function(a,b){return Wd(this,b)};h.la=function(a,b,c){return Xd(this,b,c)};
h.nc=function(a,b){if(0<=qg(this.u,b)){a=this.u.length;var c=a-2;if(0===c)return this.ba(null);c=Array(c);for(var d=0,e=0;;){if(d>=a)return new r(this.meta,this.B-1,c,null);J.m(b,this.u[d])?d+=2:(c[e]=this.u[d],c[e+1]=this.u[d+1],e+=2,d+=2)}}else return this};
h.Ha=function(a,b,c){a=qg(this.u,b);if(-1===a){if(this.B<wg){a=this.u;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new r(this.meta,this.B+1,e,null)}return Fb(pb(Te.m(xg,this),b,c),this.meta)}if(c===this.u[a+1])return this;b=Qa(this.u);b[a+1]=c;return new r(this.meta,this.B,b,null)};h.Sa=function(a,b){return-1!==qg(this.u,b)};h.W=function(){var a=this.u;return 0<=a.length-2?new rg(a,0,null):null};
h.Y=function(a,b){return b===this.meta?this:new r(b,this.B,this.u,this.C)};h.da=function(a,b){if(Fd(b))return this.Ha(null,db(b,0),db(b,1));a=this;for(b=D(b);;){if(null==b)return a;var c=H(b);if(Fd(c))a=pb(a,db(c,0),db(c,1)),b=I(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.ra(null,a)};h.m=function(a,b){return this.X(null,a,b)};h.Ia=function(a,b){a=this.W(null);return null==a?null:nc(a,b)};var He=new r(null,0,[],Sc),wg=8;
function yg(a,b){return a===b?!0:a===b||a instanceof C&&b instanceof C&&a.va===b.va?!0:J.m(a,b)}function zg(a){for(var b=0,c=0;;)if(b<a.length){var d;a:for(d=0;;)if(d<b){var e=yg(a[b],a[d]);if(e){d=e;break a}d=2+d}else{d=!1;break a}c=d?c:c+2;b=2+b}else return c}function Ag(a,b){var c=a.length-1,d=D(b);b=Array(c+2*M(d));a=Hd(a,0,b,0,c);for(b=c;;)if(d){var e=H(d);a[b]=ub(e);a[b+1]=vb(e);b=2+c;d=I(d)}else return a}
function qd(a){var b=a.length,c=1===(b&1),d;if(!(d=c))a:for(d=0;;)if(d<a.length){var e;b:for(e=0;;)if(e<d){var f=yg(a[d],a[e]);if(f){e=f;break b}e=2+e}else{e=!1;break b}if(e){d=e;break a}d=2+d}else{d=!1;break a}return d?Bg(a,c):new r(null,b/2,a,null)}
function Bg(a,b){var c=b?Ag(a,Te.m(He,a[a.length-1])):a;a=zg(c);var d=c.length;if(a<d){a=Array(a);for(var e=0,f=0;;)if(e<d)(function(){for(var g=0;;)if(g<f){var k=yg(c[e],c[g]);if(k)return k;g=2+g}else return!1})()?(b=f,e=2+e,f=b):(b=function(){for(var g=d-2;;)if(g>=e){if(yg(c[e],c[g]))return g;g-=2}else return g}(),a[f]=c[e],a[f+1]=c[b+1],b=2+f,e=2+e,f=b);else break;return new r(null,a.length/2,a,null)}return new r(null,c.length/2,c,null)}r.prototype[Pa]=function(){return Nc(this)};
function vg(a,b){this.vb={};this.mb=a;this.u=b;this.A=259;this.J=56}h=vg.prototype;h.$=function(){if(this.vb)return de(this.mb);throw Error("count after persistent!");};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){if(this.vb)return a=qg(this.u,b),-1===a?c:this.u[a+1];throw Error("lookup after persistent!");};
h.ub=function(a,b){if(this.vb){if(Xf(b))return this.tb(null,Yf.j?Yf.j(b):Yf.call(null,b),Zf.j?Zf.j(b):Zf.call(null,b));if(Fd(b))return this.tb(null,b.j?b.j(0):b.call(null,0),b.j?b.j(1):b.call(null,1));a=D(b);for(b=this;;){var c=H(a);if(u(c))a=I(a),b=ac(b,Yf.j?Yf.j(c):Yf.call(null,c),Zf.j?Zf.j(c):Zf.call(null,c));else return b}}else throw Error("conj! after persistent!");};h.Db=function(){if(this.vb)return this.vb=!1,new r(null,de(this.mb),this.u,null);throw Error("persistent! called twice");};
h.tb=function(a,b,c){if(this.vb){a=qg(this.u,b);if(-1===a){if(this.mb+2<=2*wg)return this.mb+=2,this.u.push(b),this.u.push(c),this;a=Cg.m?Cg.m(this.mb,this.u):Cg.call(null,this.mb,this.u);return ac(a,b,c)}c!==this.u[a+1]&&(this.u[a+1]=c);return this}throw Error("assoc! after persistent!");};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};
h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.X(null,a,null)};h.m=function(a,b){return this.X(null,a,b)};function Cg(a,b){for(var c=Yb(xg),d=0;;)if(d<a)c=ac(c,b[d],b[d+1]),d+=2;else return c}function Dg(){this.K=!1}function Eg(a,b,c){a=Qa(a);a[b]=c;return a}function Fg(a,b){var c=Array(a.length-2);Hd(a,0,c,0,2*b);Hd(a,2*(b+1),c,2*b,c.length-2*b);return c}function Gg(a,b,c,d){a=a.lb(b);a.u[c]=d;return a}
function Hg(a,b,c){for(var d=a.length,e=0,f=c;;)if(e<d){c=a[e];if(null!=c){var g=a[e+1];c=b.o?b.o(f,c,g):b.call(null,f,c,g)}else c=a[e+1],c=null!=c?c.Lb(b,f):f;if(Wc(c))return c;e+=2;f=c}else return f}function Ig(a){this.u=a;this.i=0;this.Da=this.Mb=null}Ig.prototype.advance=function(){for(var a=this.u.length;;)if(this.i<a){var b=this.u[this.i],c=this.u[this.i+1];null!=b?b=this.Mb=new Pf(b,c):null!=c?(b=mc(c),b=b.ea()?this.Da=b:!1):b=!1;this.i+=2;if(b)return!0}else return!1};
Ig.prototype.ea=function(){var a=null!=this.Mb;return a?a:(a=null!=this.Da)?a:this.advance()};Ig.prototype.next=function(){if(null!=this.Mb){var a=this.Mb;this.Mb=null;return a}if(null!=this.Da)return a=this.Da.next(),this.Da.ea()||(this.Da=null),a;if(this.advance())return this.next();throw Error("No such element");};Ig.prototype.remove=function(){return Error("Unsupported operation")};function Jg(a,b,c){this.Z=a;this.bitmap=b;this.u=c;this.J=131072;this.A=0}h=Jg.prototype;
h.lb=function(a){if(a===this.Z)return this;var b=ee(this.bitmap),c=Array(0>b?4:2*(b+1));Hd(this.u,0,c,0,2*b);return new Jg(a,this.bitmap,c)};h.Jb=function(){return Kg?Kg(this.u):Lg.call(null,this.u)};h.Lb=function(a,b){return Hg(this.u,a,b)};h.Oa=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.bitmap&e))return d;var f=ee(this.bitmap&e-1);e=this.u[2*f];f=this.u[2*f+1];return null==e?f.Oa(a+5,b,c,d):yg(c,e)?f:d};
h.Ba=function(a,b,c,d,e,f){var g=1<<(c>>>b&31),k=ee(this.bitmap&g-1);if(0===(this.bitmap&g)){var l=ee(this.bitmap);if(2*l<this.u.length){a=this.lb(a);b=a.u;f.K=!0;c=2*(l-k);f=2*k+(c-1);for(l=2*(k+1)+(c-1);0!==c;)b[l]=b[f],--l,--c,--f;b[2*k]=d;b[2*k+1]=e;a.bitmap|=g;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=Mg.Ba(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0===
(this.bitmap>>>d&1)?d+=1:(k[d]=null!=this.u[e]?Mg.Ba(a,b+5,Ac(this.u[e]),this.u[e],this.u[e+1],f):this.u[e+1],e+=2,d+=1);else break;return new Ng(a,l+1,k)}b=Array(2*(l+4));Hd(this.u,0,b,0,2*k);b[2*k]=d;b[2*k+1]=e;Hd(this.u,2*k,b,2*(k+1),2*(l-k));f.K=!0;a=this.lb(a);a.u=b;a.bitmap|=g;return a}l=this.u[2*k];g=this.u[2*k+1];if(null==l)return l=g.Ba(a,b+5,c,d,e,f),l===g?this:Gg(this,a,2*k+1,l);if(yg(d,l))return e===g?this:Gg(this,a,2*k+1,e);f.K=!0;f=b+5;d=Og?Og(a,f,l,g,c,d,e):Pg.call(null,a,f,l,g,c,d,
e);e=2*k;k=2*k+1;a=this.lb(a);a.u[e]=null;a.u[k]=d;return a};
h.Aa=function(a,b,c,d,e){var f=1<<(b>>>a&31),g=ee(this.bitmap&f-1);if(0===(this.bitmap&f)){var k=ee(this.bitmap);if(16<=k){g=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];g[b>>>a&31]=Mg.Aa(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0===(this.bitmap>>>c&1)?c+=1:(g[c]=null!=this.u[d]?Mg.Aa(a+5,Ac(this.u[d]),this.u[d],this.u[d+1],e):this.u[d+1],d+=2,c+=1);else break;return new Ng(null,k+1,g)}a=Array(2*
(k+1));Hd(this.u,0,a,0,2*g);a[2*g]=c;a[2*g+1]=d;Hd(this.u,2*g,a,2*(g+1),2*(k-g));e.K=!0;return new Jg(null,this.bitmap|f,a)}var l=this.u[2*g];f=this.u[2*g+1];if(null==l)return k=f.Aa(a+5,b,c,d,e),k===f?this:new Jg(null,this.bitmap,Eg(this.u,2*g+1,k));if(yg(c,l))return d===f?this:new Jg(null,this.bitmap,Eg(this.u,2*g+1,d));e.K=!0;e=this.bitmap;k=this.u;a+=5;a=Qg?Qg(a,l,f,b,c,d):Pg.call(null,a,l,f,b,c,d);c=2*g;g=2*g+1;d=Qa(k);d[c]=null;d[g]=a;return new Jg(null,e,d)};
h.Ib=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.bitmap&e))return d;var f=ee(this.bitmap&e-1);e=this.u[2*f];f=this.u[2*f+1];return null==e?f.Ib(a+5,b,c,d):yg(c,e)?new Pf(e,f):d};
h.Kb=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.bitmap&d))return this;var e=ee(this.bitmap&d-1),f=this.u[2*e],g=this.u[2*e+1];return null==f?(a=g.Kb(a+5,b,c),a===g?this:null!=a?new Jg(null,this.bitmap,Eg(this.u,2*e+1,a)):this.bitmap===d?null:new Jg(null,this.bitmap^d,Fg(this.u,e))):yg(c,f)?this.bitmap===d?null:new Jg(null,this.bitmap^d,Fg(this.u,e)):this};h.xa=function(){return new Ig(this.u)};var Mg=new Jg(null,0,[]);function Rg(a){this.u=a;this.i=0;this.Da=null}
Rg.prototype.ea=function(){for(var a=this.u.length;;){if(null!=this.Da&&this.Da.ea())return!0;if(this.i<a){var b=this.u[this.i];this.i+=1;null!=b&&(this.Da=mc(b))}else return!1}};Rg.prototype.next=function(){if(this.ea())return this.Da.next();throw Error("No such element");};Rg.prototype.remove=function(){return Error("Unsupported operation")};function Ng(a,b,c){this.Z=a;this.B=b;this.u=c;this.J=131072;this.A=0}h=Ng.prototype;h.lb=function(a){return a===this.Z?this:new Ng(a,this.B,Qa(this.u))};
h.Jb=function(){return Sg?Sg(this.u):Tg.call(null,this.u)};h.Lb=function(a,b){for(var c=this.u.length,d=0;;)if(d<c){var e=this.u[d];if(null!=e){b=e.Lb(a,b);if(Wc(b))return b;d+=1}else d+=1}else return b};h.Oa=function(a,b,c,d){var e=this.u[b>>>a&31];return null!=e?e.Oa(a+5,b,c,d):d};h.Ba=function(a,b,c,d,e,f){var g=c>>>b&31,k=this.u[g];if(null==k)return a=Gg(this,a,g,Mg.Ba(a,b+5,c,d,e,f)),a.B+=1,a;b=k.Ba(a,b+5,c,d,e,f);return b===k?this:Gg(this,a,g,b)};
h.Aa=function(a,b,c,d,e){var f=b>>>a&31,g=this.u[f];if(null==g)return new Ng(null,this.B+1,Eg(this.u,f,Mg.Aa(a+5,b,c,d,e)));a=g.Aa(a+5,b,c,d,e);return a===g?this:new Ng(null,this.B,Eg(this.u,f,a))};h.Ib=function(a,b,c,d){var e=this.u[b>>>a&31];return null!=e?e.Ib(a+5,b,c,d):d};
h.Kb=function(a,b,c){var d=b>>>a&31,e=this.u[d];if(null!=e){a=e.Kb(a+5,b,c);if(a===e)d=this;else if(null==a)if(8>=this.B)a:{e=this.u;a=e.length;b=Array(2*(this.B-1));c=0;for(var f=1,g=0;;)if(c<a)c!==d&&null!=e[c]?(b[f]=e[c],f+=2,g|=1<<c,c+=1):c+=1;else{d=new Jg(null,g,b);break a}}else d=new Ng(null,this.B-1,Eg(this.u,d,a));else d=new Ng(null,this.B,Eg(this.u,d,a));return d}return this};h.xa=function(){return new Rg(this.u)};
function Ug(a,b,c){b*=2;for(var d=0;;)if(d<b){if(yg(c,a[d]))return d;d+=2}else return-1}function Vg(a,b,c,d){this.Z=a;this.Ja=b;this.B=c;this.u=d;this.J=131072;this.A=0}h=Vg.prototype;h.lb=function(a){if(a===this.Z)return this;var b=Array(2*(this.B+1));Hd(this.u,0,b,0,2*this.B);return new Vg(a,this.Ja,this.B,b)};h.Jb=function(){return Kg?Kg(this.u):Lg.call(null,this.u)};h.Lb=function(a,b){return Hg(this.u,a,b)};
h.Oa=function(a,b,c,d){a=Ug(this.u,this.B,c);return 0>a?d:yg(c,this.u[a])?this.u[a+1]:d};
h.Ba=function(a,b,c,d,e,f){if(c===this.Ja){b=Ug(this.u,this.B,d);if(-1===b){if(this.u.length>2*this.B)return b=2*this.B,c=2*this.B+1,a=this.lb(a),a.u[b]=d,a.u[c]=e,f.K=!0,a.B+=1,a;c=this.u.length;b=Array(c+2);Hd(this.u,0,b,0,c);b[c]=d;b[c+1]=e;f.K=!0;d=this.B+1;a===this.Z?(this.u=b,this.B=d,a=this):a=new Vg(this.Z,this.Ja,d,b);return a}return this.u[b+1]===e?this:Gg(this,a,b+1,e)}return(new Jg(a,1<<(this.Ja>>>b&31),[null,this,null,null])).Ba(a,b,c,d,e,f)};
h.Aa=function(a,b,c,d,e){return b===this.Ja?(a=Ug(this.u,this.B,c),-1===a?(a=2*this.B,b=Array(a+2),Hd(this.u,0,b,0,a),b[a]=c,b[a+1]=d,e.K=!0,new Vg(null,this.Ja,this.B+1,b)):J.m(this.u[a+1],d)?this:new Vg(null,this.Ja,this.B,Eg(this.u,a+1,d))):(new Jg(null,1<<(this.Ja>>>a&31),[null,this])).Aa(a,b,c,d,e)};h.Ib=function(a,b,c,d){a=Ug(this.u,this.B,c);return 0>a?d:yg(c,this.u[a])?new Pf(this.u[a],this.u[a+1]):d};
h.Kb=function(a,b,c){a=Ug(this.u,this.B,c);return-1===a?this:1===this.B?null:new Vg(null,this.Ja,this.B-1,Fg(this.u,de(a)))};h.xa=function(){return new Ig(this.u)};function Pg(a){switch(arguments.length){case 6:return Qg(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 7:return Og(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}
function Qg(a,b,c,d,e,f){var g=Ac(b);if(g===d)return new Vg(null,g,2,[b,c,e,f]);var k=new Dg;return Mg.Aa(a,g,b,c,k).Aa(a,d,e,f,k)}function Og(a,b,c,d,e,f,g){var k=Ac(c);if(k===e)return new Vg(null,k,2,[c,d,f,g]);var l=new Dg;return Mg.Ba(a,b,k,c,d,l).Ba(a,b,e,f,g,l)}function Wg(a,b,c,d,e){this.meta=a;this.nodes=b;this.i=c;this.s=d;this.C=e;this.A=32374988;this.J=0}h=Wg.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){if(null==this.s){var a=this.nodes,b=this.i+2;return Xg?Xg(a,b,null):Lg.call(null,a,b,null)}a=this.nodes;b=this.i;var c=I(this.s);return Xg?Xg(a,b,c):Lg.call(null,a,b,c)};
h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return null==this.s?new Pf(this.nodes[this.i],this.nodes[this.i+1]):H(this.s)};
h.ia=function(){var a=this,b=null==a.s?function(){var c=a.nodes,d=a.i+2;return Xg?Xg(c,d,null):Lg.call(null,c,d,null)}():function(){var c=a.nodes,d=a.i,e=I(a.s);return Xg?Xg(c,d,e):Lg.call(null,c,d,e)}();return null!=b?b:Lc};h.W=function(){return this};h.Y=function(a,b){return b===this.meta?this:new Wg(b,this.nodes,this.i,this.s,this.C)};h.da=function(a,b){return id(b,this)};Wg.prototype[Pa]=function(){return Nc(this)};
function Lg(a){switch(arguments.length){case 1:return Kg(arguments[0]);case 3:return Xg(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}function Kg(a){return Xg(a,0,null)}function Xg(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new Wg(null,a,b,null,null);var d=a[b+1];if(u(d)&&(d=d.Jb(),u(d)))return new Wg(null,a,b+2,d,null);b+=2}else return null;else return new Wg(null,a,b,c,null)}
function Yg(a,b,c,d,e){this.meta=a;this.nodes=b;this.i=c;this.s=d;this.C=e;this.A=32374988;this.J=0}h=Yg.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.meta};h.fa=function(){var a=this.nodes,b=this.i,c=I(this.s);return Zg?Zg(a,b,c):Tg.call(null,a,b,c)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return H(this.s)};h.ia=function(){var a=this.nodes;var b=this.i,c=I(this.s);a=Zg?Zg(a,b,c):Tg.call(null,a,b,c);return null!=a?a:Lc};h.W=function(){return this};h.Y=function(a,b){return b===this.meta?this:new Yg(b,this.nodes,this.i,this.s,this.C)};h.da=function(a,b){return id(b,this)};Yg.prototype[Pa]=function(){return Nc(this)};
function Tg(a){switch(arguments.length){case 1:return Sg(arguments[0]);case 3:return Zg(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}}function Sg(a){return Zg(a,0,null)}function Zg(a,b,c){if(null==c)for(c=a.length;;)if(b<c){var d=a[b];if(u(d)&&(d=d.Jb(),u(d)))return new Yg(null,a,b+1,d,null);b+=1}else return null;else return new Yg(null,a,b,c,null)}function $g(a,b){this.oa=a;this.Tc=b;this.vc=!1}
$g.prototype.ea=function(){return!this.vc||this.Tc.ea()};$g.prototype.next=function(){if(this.vc)return this.Tc.next();this.vc=!0;return new Pf(null,this.oa)};$g.prototype.remove=function(){return Error("Unsupported operation")};function ah(a,b,c,d,e,f){this.meta=a;this.B=b;this.root=c;this.na=d;this.oa=e;this.C=f;this.A=16123663;this.J=139268}h=ah.prototype;h.rb=function(a,b){return null==b?this.na?new Pf(null,this.oa):null:null==this.root?null:this.root.Ib(0,Ac(b),b,null)};h.toString=function(){return pc(this)};
h.keys=function(){return Nc(tg.j?tg.j(this):tg.call(null,this))};h.entries=function(){return new og(D(D(this)))};h.values=function(){return Nc(ug.j?ug.j(this):ug.call(null,this))};h.has=function(a){return Nd(this,a)};h.get=function(a,b){return this.X(null,a,b)};
h.forEach=function(a){for(var b=D(this),c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e),g=Q(f,0,null);f=Q(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=D(b))Gd(b)?(c=ec(b),b=fc(b),g=c,d=M(c),c=g):(c=H(b),g=Q(c,0,null),f=Q(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=I(b),c=null,d=0),e=0;else return null};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return null==b?this.na?this.oa:c:null==this.root?c:this.root.Oa(0,Ac(b),b,c)};
h.Bb=function(a,b,c){a=this.na?b.o?b.o(c,null,this.oa):b.call(null,c,null,this.oa):c;Wc(a)?b=A(a):null!=this.root?(b=this.root.Lb(b,a),b=Wc(b)?Xc.j?Xc.j(b):Xc.call(null,b):b):b=a;return b};h.xa=function(){var a=this.root?mc(this.root):new Ke(He);return this.na?new $g(this.oa,a):a};h.V=function(){return this.meta};h.$=function(){return this.B};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Rc(this)};h.S=function(a,b){return ng(this,b)};
h.qb=function(){return new bh(this.root,this.B,this.na,this.oa)};h.ba=function(){return Fb(xg,this.meta)};h.nc=function(a,b){if(null==b)return this.na?new ah(this.meta,this.B-1,this.root,!1,null,null):this;if(null==this.root)return this;a=this.root.Kb(0,Ac(b),b);return a===this.root?this:new ah(this.meta,this.B-1,a,this.na,this.oa,null)};
h.Ha=function(a,b,c){if(null==b)return this.na&&c===this.oa?this:new ah(this.meta,this.na?this.B:this.B+1,this.root,!0,c,null);a=new Dg;b=(null==this.root?Mg:this.root).Aa(0,Ac(b),b,c,a);return b===this.root?this:new ah(this.meta,a.K?this.B+1:this.B,b,this.na,this.oa,null)};h.Sa=function(a,b){return null==b?this.na:null==this.root?!1:this.root.Oa(0,Ac(b),b,Id)!==Id};h.W=function(){if(0<this.B){var a=null!=this.root?this.root.Jb():null;return this.na?id(new Pf(null,this.oa),a):a}return null};
h.Y=function(a,b){return b===this.meta?this:new ah(b,this.B,this.root,this.na,this.oa,this.C)};h.da=function(a,b){if(Fd(b))return this.Ha(null,db(b,0),db(b,1));a=this;for(b=D(b);;){if(null==b)return a;var c=H(b);if(Fd(c))a=pb(a,db(c,0),db(c,1)),b=I(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.ra(null,a)};h.m=function(a,b){return this.X(null,a,b)};var xg=new ah(null,0,null,!1,null,Sc);
function ch(a,b){for(var c=a.length,d=0,e=Yb(xg);;)if(d<c){if(b.length<=d)throw Error(["No value supplied for key: ",y.j(a[d])].join(""));var f=d+1;e=ac(e,a[d],b[d]);d=f}else return $b(e)}ah.prototype[Pa]=function(){return Nc(this)};function bh(a,b,c,d){this.Z={};this.root=a;this.count=b;this.na=c;this.oa=d;this.A=259;this.J=56}
function dh(a,b,c){if(a.Z){if(null==b)a.oa!==c&&(a.oa=c),a.na||(a.count+=1,a.na=!0);else{var d=new Dg;b=(null==a.root?Mg:a.root).Ba(a.Z,0,Ac(b),b,c,d);b!==a.root&&(a.root=b);d.K&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}h=bh.prototype;h.$=function(){if(this.Z)return this.count;throw Error("count after persistent!");};h.ra=function(a,b){return null==b?this.na?this.oa:null:null==this.root?null:this.root.Oa(0,Ac(b),b)};
h.X=function(a,b,c){return null==b?this.na?this.oa:c:null==this.root?c:this.root.Oa(0,Ac(b),b,c)};h.ub=function(a,b){a:if(this.Z)if(Xf(b))a=dh(this,Yf.j?Yf.j(b):Yf.call(null,b),Zf.j?Zf.j(b):Zf.call(null,b));else if(Fd(b))a=dh(this,b.j?b.j(0):b.call(null,0),b.j?b.j(1):b.call(null,1));else for(a=D(b),b=this;;){var c=H(a);if(u(c))a=I(a),b=dh(b,Yf.j?Yf.j(c):Yf.call(null,c),Zf.j?Zf.j(c):Zf.call(null,c));else{a=b;break a}}else throw Error("conj! after persistent");return a};
h.Db=function(){if(this.Z){this.Z=null;var a=new ah(null,this.count,this.root,this.na,this.oa,null)}else throw Error("persistent! called twice");return a};h.tb=function(a,b,c){return dh(this,b,c)};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};
h.j=function(a){return this.ra(null,a)};h.m=function(a,b){return this.X(null,a,b)};var eh=function eh(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=0<c.length?new G(c.slice(0),0,null):null;return eh.v(c)};eh.v=function(a){a=a instanceof G&&0===a.i?a.u:Ra(a);var b=a.length;if(!Md(b))throw Error(["Argument must be an integer: ",y.j(b)].join(""));if(0!==(b&1))throw Error(["No value supplied for key: ",y.j(kd(a))].join(""));return qd(a)};eh.D=0;eh.F=function(a){return this.v(D(a))};
function fh(a,b){this.P=a;this.Ea=b;this.A=32374988;this.J=0}h=fh.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.Ea};h.fa=function(){var a=(null!=this.P?this.P.A&128||n===this.P.Cb||(this.P.A?0:v(ib,this.P)):v(ib,this.P))?this.P.fa():I(this.P);return null==a?null:new fh(a,null)};h.U=function(){return Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return this.P.ga(null).key};h.ia=function(){var a=(null!=this.P?this.P.A&128||n===this.P.Cb||(this.P.A?0:v(ib,this.P)):v(ib,this.P))?this.P.fa():I(this.P);return null!=a?new fh(a,null):Lc};h.W=function(){return this};h.Y=function(a,b){return b===this.Ea?this:new fh(this.P,b)};h.da=function(a,b){return id(b,this)};fh.prototype[Pa]=function(){return Nc(this)};
function tg(a){return(a=D(a))?new fh(a,null):null}function Yf(a){return ub(a)}function gh(a,b){this.P=a;this.Ea=b;this.A=32374988;this.J=0}h=gh.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.V=function(){return this.Ea};h.fa=function(){var a=(null!=this.P?this.P.A&128||n===this.P.Cb||(this.P.A?0:v(ib,this.P)):v(ib,this.P))?this.P.fa():I(this.P);return null==a?null:new gh(a,null)};h.U=function(){return Pc(this)};
h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};h.la=function(a,b,c){return Vd(b,c,this)};h.ga=function(){return this.P.ga(null).K};h.ia=function(){var a=(null!=this.P?this.P.A&128||n===this.P.Cb||(this.P.A?0:v(ib,this.P)):v(ib,this.P))?this.P.fa():I(this.P);return null!=a?new gh(a,null):Lc};h.W=function(){return this};h.Y=function(a,b){return b===this.Ea?this:new gh(this.P,b)};h.da=function(a,b){return id(b,this)};gh.prototype[Pa]=function(){return Nc(this)};
function ug(a){return(a=D(a))?new gh(a,null):null}function Zf(a){return vb(a)}var hh=function hh(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=0<c.length?new G(c.slice(0),0,null):null;return hh.v(c)};hh.v=function(a){return u(Pe($d,a))?Yd(function(b,c){return ld.m(u(b)?b:He,c)},a):null};hh.D=0;hh.F=function(a){return this.v(D(a))};function ih(a,b){var c=He;for(b=D(b);;)if(b){var d=H(b),e=Gc(a,d,jh);c=Ie(e,jh)?R.o(c,d,e):c;b=I(b)}else return Fb(c,wd(a))}
function kh(a){this.xb=a}kh.prototype.ea=function(){return this.xb.ea()};kh.prototype.next=function(){if(this.xb.ea())return this.xb.next().key;throw Error("No such element");};kh.prototype.remove=function(){return Error("Unsupported operation")};function lh(a,b,c){this.meta=a;this.Ka=b;this.C=c;this.A=15077647;this.J=139268}h=lh.prototype;h.toString=function(){return pc(this)};h.keys=function(){return Nc(D(this))};h.entries=function(){return new pg(D(D(this)))};h.values=function(){return Nc(D(this))};
h.has=function(a){return Nd(this,a)};h.forEach=function(a){for(var b=D(this),c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e),g=Q(f,0,null);f=Q(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=D(b))Gd(b)?(c=ec(b),b=fc(b),g=c,d=M(c),c=g):(c=H(b),g=Q(c,0,null),f=Q(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=I(b),c=null,d=0),e=0;else return null};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){a=qb(this.Ka,b);return u(a)?ub(a):c};h.xa=function(){return new kh(mc(this.Ka))};h.V=function(){return this.meta};
h.$=function(){return Xa(this.Ka)};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Rc(this)};h.S=function(a,b){if(a=Bd(b))if(a=M(this)===M(b))try{return Zd(function(c,d){return(c=Nd(b,d))?c:new Uc},!0,this.Ka)}catch(c){if(c instanceof Error)return!1;throw c;}else return a;else return a};h.qb=function(){return new mh(Yb(this.Ka))};h.ba=function(){return Fb(nh,this.meta)};h.Ec=function(a,b){return new lh(this.meta,tb(this.Ka,b),null)};h.W=function(){return tg(this.Ka)};
h.Y=function(a,b){return b===this.meta?this:new lh(b,this.Ka,this.C)};h.da=function(a,b){return new lh(this.meta,R.o(this.Ka,b,null),null)};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return this.ra(null,a)};h.m=function(a,b){return this.X(null,a,b)};
var nh=new lh(null,He,Sc);function oh(a){for(var b=a.length,c=Yb(nh),d=0;;)if(d<b)Zb(c,a[d]),d+=1;else break;return $b(c)}lh.prototype[Pa]=function(){return Nc(this)};function mh(a){this.nb=a;this.J=136;this.A=259}h=mh.prototype;h.ub=function(a,b){this.nb=ac(this.nb,b,null);return this};h.Db=function(){return new lh(null,$b(this.nb),null)};h.$=function(){return M(this.nb)};h.ra=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return kb(this.nb,b,Id)===Id?c:b};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Qa(b)))};h.j=function(a){return kb(this.nb,a,Id)===Id?null:a};h.m=function(a,b){return kb(this.nb,a,Id)===Id?b:a};
function ph(a){if(Bd(a))return vd(a,null);a=D(a);if(null==a)return nh;if(a instanceof G&&0===a.i)return oh(a.u);for(var b=Yb(nh);;)if(null!=a){var c=I(a);b=Zb(b,gb(a));a=c}else return $b(b)}function qh(a){for(var b=md;;)if(I(a))b=ld.m(b,H(a)),a=I(a);else return D(b)}function ke(a){if(null!=a&&(a.J&4096||n===a.Dc))return a.name;if("string"===typeof a)return a;throw Error(["Doesn't support name: ",y.j(a)].join(""));}
function rh(a){var b=sh,c=Yb(He);b=D(b);for(a=D(a);;)if(b&&a){var d=H(b),e=H(a);c=ac(c,d,e);b=I(b);a=I(a)}else return $b(c)}var th=function th(a){switch(arguments.length){case 2:return th.m(arguments[0],arguments[1]);case 3:return th.o(arguments[0],arguments[1],arguments[2]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=3<c.length?new G(c.slice(3),0,null):null;return th.v(arguments[0],arguments[1],arguments[2],c)}};th.m=function(a,b){return b};
th.o=function(a,b,c){return(a.j?a.j(b):a.call(null,b))>(a.j?a.j(c):a.call(null,c))?b:c};th.v=function(a,b,c,d){return Sa(function(e,f){return th.o(a,e,f)},th.o(a,b,c),d)};th.F=function(a){var b=H(a),c=I(a);a=H(c);var d=I(c);c=H(d);d=I(d);return this.v(b,a,c,d)};th.D=3;function uh(a,b,c){this.start=a;this.step=b;this.count=c;this.A=82;this.J=0}h=uh.prototype;h.$=function(){return this.count};h.ga=function(){return this.start};h.M=function(a,b){return this.start+b*this.step};
h.qa=function(a,b,c){return 0<=b&&b<this.count?this.start+b*this.step:c};h.lc=function(){if(1>=this.count)throw Error("-drop-first of empty chunk");return new uh(this.start+this.step,this.step,this.count-1)};function vh(a,b,c){this.i=a;this.end=b;this.step=c}vh.prototype.ea=function(){return 0<this.step?this.i<this.end:this.i>this.end};vh.prototype.next=function(){var a=this.i;this.i+=this.step;return a};
function wh(a,b,c,d,e,f){this.meta=a;this.start=b;this.end=c;this.step=d;this.B=e;this.C=f;this.A=32375006;this.J=402944}h=wh.prototype;h.toString=function(){return pc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();h.M=function(a,b){if(0<=b&&b<this.$(null))return this.start+b*this.step;if(0<=b&&this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};
h.qa=function(a,b,c){return 0<=b&&b<this.$(null)?this.start+b*this.step:0<=b&&this.start>this.end&&0===this.step?this.start:c};h.xa=function(){return new vh(this.start,this.end,this.step)};h.V=function(){return this.meta};
h.fa=function(){return 0<this.step?this.start+this.step<this.end?new wh(null,this.start+this.step,this.end,this.step,Math.ceil((this.end-(this.start+this.step))/this.step),null):null:this.start+this.step>this.end?new wh(null,this.start+this.step,this.end,this.step,Math.ceil((this.end-(this.start+this.step))/this.step),null):null};h.$=function(){return this.B};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};
h.ka=function(a,b){return Yc(this,b)};h.la=function(a,b,c){for(a=this.start;;)if(0<this.step?a<this.end:a>this.end){c=b.m?b.m(c,a):b.call(null,c,a);if(Wc(c))return A(c);a+=this.step}else return c};h.ga=function(){return this.start};h.ia=function(){var a=this.fa();return null==a?Lc:a};h.W=function(){return this};h.Ab=function(){var a=this.B;return new uh(this.start,this.step,32>a?a:32)};
h.Ma=function(){if(32>=this.B)return Lc;var a=this.start+32*this.step;return 0<this.step?this.end<=a?Lc:new wh(null,a,this.end,this.step,Math.ceil((this.end-a)/this.step),null):0>this.step?this.end>=a?Lc:new wh(null,a,this.end,this.step,Math.ceil((this.end-a)/this.step),null):this.end===a?Lc:new kf(null,-1,a,null)};h.Y=function(a,b){return b===this.meta?this:new wh(b,this.start,this.end,this.step,this.B,this.C)};h.da=function(a,b){return id(b,this)};
h.Ia=function(a,b){return 0<b?b<this.B?new wh(null,this.start+this.step*b,this.end,this.step,this.B-b,null):null:this};h.Sb=function(){return D(this.Ma(null))};wh.prototype[Pa]=function(){return Nc(this)};function xh(a,b,c,d,e,f,g){this.meta=a;this.start=b;this.end=c;this.step=d;this.T=e;this.Rb=f;this.C=g;this.J=140800;this.A=32374988}h=xh.prototype;h.toString=function(){return pc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return K(this,b,0);case 2:return K(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return K(this,b,0)};a.m=function(b,c){return K(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return N(this,c,M(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return N(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return N(this,c,d)};return b}();
function yh(a){if(null==a.T){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];a:{var c=0;for(var d=a.start;;)if(32>c){if(b[c]=d,c+=1,d+=a.step,!(0<a.step?d<a.end:d>a.end)){c=a.T=new oe(b,0,c);break a}}else{c=d;break a}}null==a.T&&(a.T=new oe(b,0,32),(0<a.step?c<a.end:c>a.end)&&(a.Rb=new xh(null,c,a.end,a.step,null,null,null)))}}h.xa=function(){return new vh(this.start,this.end,this.step)};
h.V=function(){return this.meta};h.fa=function(){return 0<this.step?this.start+this.step<this.end?new xh(null,this.start+this.step,this.end,this.step,null,null,null):null:this.start+this.step>this.end?new xh(null,this.start+this.step,this.end,this.step,null,null,null):null};h.U=function(){var a=this.C;return null!=a?a:this.C=a=Pc(this)};h.S=function(a,b){return hd(this,b)};h.ba=function(){return Lc};h.ka=function(a,b){return Ud(b,this)};
h.la=function(a,b,c){for(a=this.start;;)if(0<this.step?a<this.end:a>this.end){c=b.m?b.m(c,a):b.call(null,c,a);if(Wc(c))return A(c);a+=this.step}else return c};h.ga=function(){return this.start};h.ia=function(){var a=this.fa();return null==a?Lc:a};h.W=function(){return this};h.Ab=function(){yh(this);return this.T};h.Ma=function(){yh(this);return null==this.Rb?Lc:this.Rb};h.Y=function(a,b){return b===this.meta?this:new xh(b,this.start,this.end,this.step,this.T,this.Rb,this.C)};
h.da=function(a,b){return id(b,this)};h.Sb=function(){return D(this.Ma(null))};xh.prototype[Pa]=function(){return Nc(this)};function zh(a,b){return b<=a?Lc:Md(a)&&Md(b)&&Md(1)?new wh(null,a,b,1,Math.ceil(b-a),null):new xh(null,a,b,1,null,null,null)}function Ah(a){a:for(var b=a;;)if(b=D(b))b=I(b);else break a;return a}function Bh(a,b){if("string"===typeof b)return a=a.exec(b),null!=a&&J.m(a[0],b)?1===a.length?a[0]:Wf(a):null;throw new TypeError("re-matches must match against a string.");}
function Ch(a,b,c,d,e,f,g){var k=Ba;Ba=null==Ba?null:Ba-1;try{if(null!=Ba&&0>Ba)return Tb(a,"#");Tb(a,c);if(0===Ha.j(f))D(g)&&Tb(a,function(){var z=Dh.j(f);return u(z)?z:"..."}());else{if(D(g)){var l=H(g);b.o?b.o(l,a,f):b.call(null,l,a,f)}for(var p=I(g),q=Ha.j(f)-1;;)if(!p||null!=q&&0===q){D(p)&&0===q&&(Tb(a,d),Tb(a,function(){var z=Dh.j(f);return u(z)?z:"..."}()));break}else{Tb(a,d);var t=H(p);c=a;g=f;b.o?b.o(t,c,g):b.call(null,t,c,g);var w=I(p);c=q-1;p=w;q=c}}return Tb(a,e)}finally{Ba=k}}
function Eh(a,b){b=D(b);for(var c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e);Tb(a,f);e+=1}else if(b=D(b))c=b,Gd(c)?(b=ec(c),d=fc(c),c=b,f=M(b),b=d,d=f):(f=H(c),Tb(a,f),b=I(c),c=null,d=0),e=0;else return null}var Fh={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function Gh(a){return['"',y.j(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(b){return Fh[b]})),'"'].join("")}
function Hh(a,b){return(a=Kd(B(a,Fa)))?(a=null!=b?b.A&131072||n===b.fd?!0:!1:!1)?null!=wd(b):a:a}
function Ih(a,b,c){if(null==a)return Tb(b,"nil");if(Hh(c,a)){Tb(b,"^");var d=wd(a);Jh.o?Jh.o(d,b,c):Jh.call(null,d,b,c);Tb(b," ")}if(a.Hc)return a.kd(b);if(null!=a?a.A&2147483648||n===a.aa||(a.A?0:v(Ub,a)):v(Ub,a))return Vb(a,b,c);if(!0===a||!1===a)return Tb(b,y.j(a));if("number"===typeof a)return Tb(b,isNaN(a)?"##NaN":a===Number.POSITIVE_INFINITY?"##Inf":a===Number.NEGATIVE_INFINITY?"##-Inf":y.j(a));if(La(a))return Tb(b,"#js "),d=ef.m(function(f){return new Pf(null!=Bh(/[A-Za-z_\*\+\?!\-'][\w\*\+\?!\-']*/,
f)?je.j(f):f,a[f])},oa(a)),Kh.I?Kh.I(d,Jh,b,c):Kh.call(null,d,Jh,b,c);if(Ja(a))return Ch(b,Jh,"#js ["," ","]",c,a);if("string"===typeof a)return u(Ea.j(c))?Tb(b,Gh(a)):Tb(b,a);if("function"===typeof a){var e=a.name;c=u(function(){var f=null==e;return f?f:ma(e)}())?"Function":e;return Eh(b,O(["#object[",c,u(!1)?[' "',y.j(a),'"'].join(""):"","]"]))}if(a instanceof Date)return c=function(f,g){for(f=y.j(f);;)if(f.length<g)f=["0",f].join("");else return f},Eh(b,O(['#inst "',c(a.getUTCFullYear(),4),"-",
c(a.getUTCMonth()+1,2),"-",c(a.getUTCDate(),2),"T",c(a.getUTCHours(),2),":",c(a.getUTCMinutes(),2),":",c(a.getUTCSeconds(),2),".",c(a.getUTCMilliseconds(),3),"-",'00:00"']));if(a instanceof RegExp)return Eh(b,O(['#"',a.source,'"']));if("symbol"===m(a)||"undefined"!==typeof Symbol&&a instanceof Symbol)return Eh(b,O(["#object[",a.toString(),"]"]));if(u(function(){var f=null==a?null:a.constructor;return null==f?null:f.Yb}()))return Eh(b,O(["#object[",a.constructor.Yb.replace(RegExp("/","g"),"."),"]"]));
e=function(){var f=null==a?null:a.constructor;return null==f?null:f.name}();c=u(function(){var f=null==e;return f?f:ma(e)}())?"Object":e;return null==a.constructor?Eh(b,O(["#object[",c,"]"])):Eh(b,O(["#object[",c," ",y.j(a),"]"]))}function Jh(a,b,c){var d=Lh.j(c);return u(d)?(c=R.o(c,Mh,Ih),d.o?d.o(a,b,c):d.call(null,a,b,c)):Ih(a,b,c)}
function Nh(a){var b=Ca();if(zd(a))b="";else{var c=y,d=c.j,e=new Aa,f=new oc(e);Jh(H(a),f,b);a=D(I(a));for(var g=null,k=0,l=0;;)if(l<k){var p=g.M(null,l);Tb(f," ");Jh(p,f,b);l+=1}else if(a=D(a))g=a,Gd(g)?(a=ec(g),k=fc(g),g=a,p=M(a),a=k,k=p):(p=H(g),Tb(f," "),Jh(p,f,b),a=I(g),g=null,k=0),l=0;else break;b=d.call(c,e)}return b}function Oh(a){return a instanceof Ec?Hc.m(null,ke(a)):je.m(null,ke(a))}
function Ph(a){if(u(!1)){var b=D(a),c=D(b),d=H(c);I(c);Q(d,0,null);Q(d,1,null);c=od(a);for(a=null;;){d=a;b=D(b);a=H(b);var e=I(b),f=a;a=Q(f,0,null);b=Q(f,1,null);if(u(f))if(a instanceof C||a instanceof Ec)if(u(d))if(J.m(d,ie(a)))c=R.o(c,Oh(a),b),a=d,b=e;else return null;else if(d=ie(a),u(d))c=R.o(c,Oh(a),b),a=d,b=e;else return null;else return null;else return new T(null,2,5,U,[d,c],null)}}else return null}
function Qh(a,b,c,d,e){return Ch(d,function(f,g,k){var l=ub(f);c.o?c.o(l,g,k):c.call(null,l,g,k);Tb(g," ");f=vb(f);return c.o?c.o(f,g,k):c.call(null,f,g,k)},[y.j(a),"{"].join(""),", ","}",e,D(b))}function Kh(a,b,c,d){var e=Dd(a)?Ph(a):null,f=Q(e,0,null);e=Q(e,1,null);return u(f)?Qh(["#:",y.j(f)].join(""),e,b,c,d):Qh(null,a,b,c,d)}bf.prototype.aa=n;bf.prototype.R=function(a,b,c){Tb(b,"#object[cljs.core.Volatile ");Jh(new r(null,1,[Rh,this.state],null),b,c);return Tb(b,"]")};G.prototype.aa=n;
G.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};le.prototype.aa=n;le.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};Pf.prototype.aa=n;Pf.prototype.R=function(a,b,c){return Ch(b,Jh,"["," ","]",c,this)};Wg.prototype.aa=n;Wg.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};rg.prototype.aa=n;rg.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};Oc.prototype.aa=n;Oc.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};
$f.prototype.aa=n;$f.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};ge.prototype.aa=n;ge.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};wh.prototype.aa=n;wh.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};ah.prototype.aa=n;ah.prototype.R=function(a,b,c){return Kh(this,Jh,b,c)};Yg.prototype.aa=n;Yg.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};bg.prototype.aa=n;bg.prototype.R=function(a,b,c){return Ch(b,Jh,"["," ","]",c,this)};
lh.prototype.aa=n;lh.prototype.R=function(a,b,c){return Ch(b,Jh,"#{"," ","}",c,this)};qe.prototype.aa=n;qe.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};Ye.prototype.aa=n;Ye.prototype.R=function(a,b,c){Tb(b,"#object[cljs.core.Atom ");Jh(new r(null,1,[Rh,this.state],null),b,c);return Tb(b,"]")};gh.prototype.aa=n;gh.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};kf.prototype.aa=n;kf.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};T.prototype.aa=n;
T.prototype.R=function(a,b,c){return Ch(b,Jh,"["," ","]",c,this)};ig.prototype.aa=n;ig.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};fe.prototype.aa=n;fe.prototype.R=function(a,b){return Tb(b,"()")};jg.prototype.aa=n;jg.prototype.R=function(a,b,c){return Ch(b,Jh,"#queue ["," ","]",c,D(this))};r.prototype.aa=n;r.prototype.R=function(a,b,c){return Kh(this,Jh,b,c)};xh.prototype.aa=n;xh.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};fh.prototype.aa=n;
fh.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};nd.prototype.aa=n;nd.prototype.R=function(a,b,c){return Ch(b,Jh,"("," ",")",c,this)};Ec.prototype.pb=n;Ec.prototype.Ta=function(a,b){if(b instanceof Ec)return Dc(this,b);throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};C.prototype.pb=n;C.prototype.Ta=function(a,b){if(b instanceof C)return he(this,b);throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};bg.prototype.pb=n;
bg.prototype.Ta=function(a,b){if(Fd(b))return Pd(this,b);throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};T.prototype.pb=n;T.prototype.Ta=function(a,b){if(Fd(b))return Pd(this,b);throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};Pf.prototype.pb=n;Pf.prototype.Ta=function(a,b){if(Fd(b))return Pd(this,b);throw Error(["Cannot compare ",y.j(this)," to ",y.j(b)].join(""));};function Sh(a,b){Wb(a,Th,b);return a}var Uh=null;
function Vh(a){null==Uh&&(Uh=Ze(0));return Hc.j([y.j(a),y.j(af.m(Uh,Tc))].join(""))}function Wh(a){this.f=a;this.value=null;this.A=2147516416;this.J=1}Wh.prototype.ta=function(){u(this.f)&&(this.value=this.f.H?this.f.H():this.f.call(null),this.f=null);return this.value};Wh.prototype.R=function(a,b,c){Tb(b,"#object[cljs.core.Delay ");Jh(new r(null,2,[Xh,null==this.f?Yh:Zh,Rh,this.value],null),b,c);return Tb(b,"]")};function $h(){}
function ai(a){if(null!=a&&null!=a.$c)a=a.$c(a);else{var b=ai[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=ai._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IEncodeJS.-clj-\x3ejs",a);}return a}function bi(a,b){return(null!=a?n===a.Zc||(a.pc?0:v($h,a)):v($h,a))?ai(a):"string"===typeof a||"number"===typeof a||a instanceof C||a instanceof Ec?b.j?b.j(a):b.call(null,a):Nh(O([a]))}
var ci=function ci(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return ci.v(arguments[0],c)};
ci.v=function(a,b){b=S(b);var c=Gc(b,di,ke),d=function g(f){if(null==f)return null;if(null!=f?n===f.Zc||(f.pc?0:v($h,f)):v($h,f))return ai(f);if(f instanceof C)return c.j?c.j(f):c.call(null,f);if(f instanceof Ec)return y.j(f);if(Dd(f)){var k={};f=D(f);for(var l=null,p=0,q=0;;)if(q<p){var t=l.M(null,q),w=Q(t,0,null),z=Q(t,1,null);t=k;w=bi(w,d);z=g(z);t[w]=z;q+=1}else if(f=D(f))Gd(f)?(p=ec(f),f=fc(f),l=p,p=M(p)):(l=H(f),p=Q(l,0,null),q=Q(l,1,null),l=k,p=bi(p,d),q=g(q),l[p]=q,f=I(f),l=null,p=0),q=0;
else break;return k}if(Ad(f)){k=[];f=D(ef.m(g,f));l=null;for(q=p=0;;)if(q<p)t=l.M(null,q),k.push(t),q+=1;else if(f=D(f))l=f,Gd(l)?(f=ec(l),q=fc(l),l=f,p=M(f),f=q):(f=H(l),k.push(f),f=I(l),l=null,p=0),q=0;else break;return k}return f};return d(a)};ci.D=1;ci.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};function ei(){}
function fi(a,b){if(null!=a&&null!=a.Yc)a=a.Yc(a,b);else{var c=fi[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=fi._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("IEncodeClojure.-js-\x3eclj",a);}return a}function gi(a){return hi(a,O([ii,!1]))}
function hi(a,b){var c=S(b);c=B(c,ii);var d=u(c)?je:y;return function g(f){return(null!=f?n===f.Ed||(f.pc?0:v(ei,f)):v(ei,f))?fi(f,Ce(eh,b)):Jd(f)?Ah(ef.m(g,f)):Xf(f)?new Pf(g(ub(f)),g(vb(f))):Ad(f)?Te.o(od(f),ef.j(g),f):Ja(f)?$b(Sa(function(k,l){l=g(l);return Zb(k,l)},Yb(md),f)):Ma(f)===Object?$b(Sa(function(k,l){var p=d.j?d.j(l):d.call(null,l);l=g(pa(f,l));return ac(k,p,l)},Yb(He),oa(f))):f}(a)}
function ji(a,b){var c=Error(a);this.message=a;this.data=b;this.cause=null;this.name=c.name;this.description=c.description;this.number=c.number;this.fileName=c.fileName;this.lineNumber=c.lineNumber;this.columnNumber=c.columnNumber;this.stack=c.stack;return this}ji.prototype.__proto__=Error.prototype;ji.prototype.aa=n;
ji.prototype.R=function(a,b,c){Tb(b,"#error {:message ");Jh(this.message,b,c);u(this.data)&&(Tb(b,", :data "),Jh(this.data,b,c));u(this.cause)&&(Tb(b,", :cause "),Jh(this.cause,b,c));return Tb(b,"}")};ji.prototype.toString=function(){return pc(this)};function ki(a,b){return new ji(a,b)};var li=new C(null,"fx","fx",-1237829572),mi=new C(null,"transformRequest","transformRequest",-422300899),ni=new C("style-editor","editing-style","style-editor/editing-style",-215043617),oi=new C(null,"text-field","text-field",1955422445),pi=new C(null,"set-current-style-key","set-current-style-key",2090764858),qi=new C(null,"trim-v","trim-v",-1274938640),ri=new C(null,"left","left",-399115937),si=new C(null,"fill-opacity","fill-opacity",-537571170),ti=new C(null,"final-scale","final-scale",-2105230483),
ui=new C(null,"current-style-key","current-style-key",2068490901),vi=new C("style-editor","reset-styles-immediately","style-editor/reset-styles-immediately",559761532),wi=new C(null,"intensity","intensity",1142770863),xi=new C(null,"deregister-event-handler","deregister-event-handler",-1096518994),yi=new C(null,"text-opacity","text-opacity",-124349139),zi=new C(null,"model-transform","model-transform",-308254495),Ai=new C(null,"constructor","constructor",-1953928811),Ga=new C(null,"dup","dup",556298533),
Ci=new C(null,"visibility","visibility",1338380893),Di=new C(null,"no-cache","no-cache",1588056370),Xh=new C(null,"status","status",-1997798413),Ei=new C(null,"idle","idle",-2007156861),Fi=new C(null,"transportation","transportation",1963737572),Gi=new C(null,"dispatch","dispatch",1319337009),Hi=new C(null,"style","style",-496642736),Ii=new C(null,"line-cap","line-cap",448406012),Ji=new C(null,"right","right",-452581833),Ki=new C(null,"groupEnd","groupEnd",-337721382),Li=new C(null,"pause","pause",
-2095325672),Mi=new C(null,"margin-top","margin-top",392161226),Ni=new C(null,"default-value","default-value",232220170),Oi=new C("map","light-properties","map/light-properties",1435069473),Pi=new C("style-editor","initialize","style-editor/initialize",985289104),Qi=new C(null,"auto-run","auto-run",1958400437),Ri=new C(null,"getDerivedStateFromProps","getDerivedStateFromProps",-991834739),Ea=new C(null,"readably","readably",1129599760),Si=new C(null,"parse-tag","parse-tag",1427313738),Ti=new C(null,
"unregister-custom-layer","unregister-custom-layer",-1105365433),Ui=new C(null,"attribution","attribution",1937239286),Vi=new C(null,"boundaries","boundaries",-1344379964),Wi=new C("map","prewarming?","map/prewarming?",-511334339),Xi=new C(null,"width","width",-384071477),Yi=new C(null,"h1","h1",-1896887462),Zi=new C(null,"shouldComponentUpdate","shouldComponentUpdate",1795750960),$i=new C(null,"childContextTypes","childContextTypes",578717991),aj=new C(null,"h3","h3",2067611163),bj=new C(null,"map-loading?",
"map-loading?",-1734759699),cj=new C(null,"bottom","bottom",-1550509018),dj=new C("style-editor","reset-to-defaults","style-editor/reset-to-defaults",-1551553187),ej=new C(null,"fill-extrusion-base","fill-extrusion-base",-954195233),fj=new C(null,"component-will-unmount","component-will-unmount",-2058314698),gj=new C(null,"set-map-instance","set-map-instance",-1366329814),W=new C(null,"class","class",-2030961996),hj=new C(null,"stack","stack",-793405930),Zh=new C(null,"pending","pending",-220036727),
ij=new C(null,"reagentRender","reagentRender",-358306383),jj=new C(null,"paused","paused",-1710376127),kj=new C(null,"db","db",993250759),lj=new C(null,"unwrap","unwrap",-1399175462),mj=new C(null,"single-zoom-renderer","single-zoom-renderer",102637547),nj=new C(null,"light","light",1918998747),oj=new C(null,"delay","delay",-574225219),pj=new C(null,"fill-outline-color","fill-outline-color",1960554289),qj=new C(null,"line-opacity","line-opacity",1142929072),rj=new C(null,"option","option",65132272),
sj=new C(null,"fill-extrusion-height","fill-extrusion-height",933696521),tj=new C(null,"zoom","zoom",-1827487038),uj=new C(null,"original-event","original-event",2121330403),vj=new C(null,"top","top",-1856271961),wj=new C(null,"offset","offset",296498311),xj=new C(null,"wrap","wrap",851669987),yj=new C(null,"do-fx","do-fx",1194163050),zj=new C(null,"map","map",1371690461),Aj=new C(null,"max","max",61366548),Bj=new C(null,"render","render",-1408033454),Cj=new C("style-editor","update-layer-style",
"style-editor/update-layer-style",-627218383),Dj=new C("style-editor","set-target-layer","style-editor/set-target-layer",243317582),Ej=new C(null,"path","path",-188191168),Fj=new C(null,"pointer-events","pointer-events",-1053858853),Gj=new C(null,"dispatch-n","dispatch-n",-504469236),Hj=new C("models-3d","eiffel-scale","models-3d/eiffel-scale",1179736605),Ij=new C(null,"background","background",-863952629),Jj=new C(null,"minZoom","minZoom",1002989305),Kj=new C(null,"fill-extrusion-translate-anchor",
"fill-extrusion-translate-anchor",-846269924),Lj=new C(null,"on-change","on-change",-732046149),Mj=new C(null,"after","after",594996914),Nj=new C(null,"fill-extrusion-vertical-gradient","fill-extrusion-vertical-gradient",2089732235),Oj=new C(null,"on-style-change","on-style-change",2142202940),Pj=new C(null,"symbol-placement","symbol-placement",830414628),Qj=new C(null,"ambient","ambient",-983195016),Rj=new C(null,"border-radius","border-radius",419594011),Sj=new C(null,"map-instance","map-instance",
457152648),Tj=new C(null,"register-custom-layer","register-custom-layer",-1570456041),Uj=new C(null,"error","error",-978969032),Vj=new C(null,"div.prewarming-overlay","div.prewarming-overlay",-253674262),Wj=new C(null,"div.spinner","div.spinner",-1989566624),Xj=new C(null,"bearing","bearing",-1189702101),Yj=new C(null,"version","version",425292698),Zj=new C(null,"background-color","background-color",570434026),ak=new C(null,"line-width","line-width",-906934988),bk=new C(null,"stops","stops",-1205459005),
ck=new C(null,"group","group",582596132),dk=new C(null,"queue","queue",1455835879),ek=new C(null,"ms","ms",-1152709733),fk=new C("models-3d","set-eiffel-loaded","models-3d/set-eiffel-loaded",18076453),gk=new C(null,"on-click","on-click",1632826543),hk=new C(null,"sequential","sequential",-1082983960),ik=new C(null,"fill-extrusion-translate","fill-extrusion-translate",-1691963925),jk=new C("map-engine","map-loaded","map-engine/map-loaded",2066130576),kk=new C(null,"cljsLegacyRender","cljsLegacyRender",
-1527295613),lk=new C(null,"renderer","renderer",336841071),mk=new C(null,"function-components","function-components",1492814963),nk=new C(null,"dispatch-debounce","dispatch-debounce",-2065179020),ok=new C(null,"for","for",-1323786319),pk=new C("style-editor","update-style-debounced","style-editor/update-style-debounced",558531404),qk=new C("buildings","add-layers","buildings/add-layers",141884331),X=new C(null,"div","div",1057191632),rk=new C(null,"center","center",-748944368),sk=new C(null,"fx-handler",
"fx-handler",-549783097),tk=new C(null,"event","event",301435442),uk=new C(null,"source","source",-433931539),vk=new C(null,"dispatch-later","dispatch-later",291951390),wk=new C(null,"value","value",305978217),xk=new C("map-engine","on-load-callbacks","map-engine/on-load-callbacks",-358763394),yk=new C(null,"scale","scale",-230427353),zk=new C(null,"attributionControl","attributionControl",1896212741),Ak=new C(null,"scheduled","scheduled",553898551),Bk=new C(null,"zoom-pairs","zoom-pairs",931925474),
Ck=new C(null,"target-layer","target-layer",476652512),Dk=new C(null,"debug","debug",-1608172596),Ek=new C(null,"coeffects","coeffects",497912985),Fk=new C(null,"atom","atom",-397043653),Gk=new C(null,"id","id",-1388402092),Hk=new C("re-frame.std-interceptors","not-found","re-frame.std-interceptors/not-found",-1614827865),Ik=new C(null,"contextType","contextType",1033066077),Jk=new C(null,"inject-global-interceptors","inject-global-interceptors",-2144129737),Kk=new C(null,"set","set",304602554),Lk=
new C(null,"layers","layers",1944875032),Mk=new C(null,"maxTileCacheSize","maxTileCacheSize",252979776),Yh=new C(null,"ready","ready",1086465795),Nk=new C(null,"maxZoom","maxZoom",566190639),Ok=new C(null,"with-let10999","with-let10999",-1911462842),Pk=new C(null,"fill-color","fill-color",-1156875903),Qk=new C(null,"maxParallelImageRequests","maxParallelImageRequests",1439539509),Rk=new C(null,"select","select",1147833503),Sk=new C(null,"cursor","cursor",1011937484),Tk=new C("map","set-prewarming?",
"map/set-prewarming?",1596454497),Uk=new C(null,"on-set","on-set",-140953470),Vk=new C(null,"light-style","light-style",1640900908),Wk=new C(null,"props-fn","props-fn",-1077414056),Fa=new C(null,"meta","meta",1499536964),Xk=new C(null,"maxzoom","maxzoom",-1367370196),Ha=new C(null,"print-length","print-length",1931866356),Yk=new C(null,"disabled?","disabled?",-1523234181),Zk=new C(null,"loaded?","loaded?",-1108015206),$k=new C("style-editor","re-apply-all-styles","style-editor/re-apply-all-styles",
166436822),al=new C(null,"transform","transform",1381301764),bl=new C(null,"on-write","on-write",31519475),cl=new C(null,"finish-run","finish-run",753148477),dl=new C(null,"p","p",151049309),el=new C(null,"componentWillUnmount","componentWillUnmount",1573788814),fl=new C(null,"selected-category","selected-category",-1539830769),gl=new C(null,"className","className",-1983287057),hl=new C(null,"shadow","shadow",873231803),il=new C(null,"on-commit","on-commit",551275063),jl=new C("map","set-zoom","map/set-zoom",
-538879925),kl=new C(null,"toggle-other-components","toggle-other-components",961207462),ll=new C(null,"justify","justify",-722524056),ml=new C(null,"natural","natural",722422122),nl=new C("style-editor","selected-category","style-editor/selected-category",265904918),ol=new C(null,"multi-zoom-renderer","multi-zoom-renderer",1112507718),pl=new C(null,"direction","direction",-633359395),ql=new C(null,"f","f",-1597136552),rl=new C(null,"options","options",99638489),sl=new C(null,"align","align",1964212802),
tl=new C(null,"active-indices","active-indices",1311386713),ul=new C(null,"tileSize","tileSize",997837978),vl=new C(null,"getInitialState","getInitialState",1541760916),wl=new C(null,"filter","filter",-948537934),xl=new C(null,"anchor","anchor",1549638489),yl=new C("map-engine","on-map-loaded","map-engine/on-map-loaded",528806121),zl=new C(null,"border","border",1444987323),Mh=new C(null,"fallback-impl","fallback-impl",-1501286995),Al=new C(null,"name","name",1843675177),Bl=new C(null,"running","running",
1554969103),Cl=new C(null,"custom-layers","custom-layers",-945819655),Dl=new C(null,"warn","warn",-436710552),El=new C("models-3d","fly-to-eiffel-tower","models-3d/fly-to-eiffel-tower",1099017390),Fl=new C(null,"label","label",1718410804),Gl=new C(null,"component-did-update","component-did-update",-1468549173),Hl=new C(null,"component-did-mount","component-did-mount",-1126910518),di=new C(null,"keyword-fn","keyword-fn",-64566675),Il=new C(null,"line-join","line-join",-1560936092),Jl=new C(null,"editing-style",
"editing-style",-330414366),Kl=new C(null,"reagent-render","reagent-render",-985383853),Ll=new C(null,"text-color","text-color",1728708298),ii=new C(null,"keywordize-keys","keywordize-keys",1310784252),Ml=new C(null,"db-handler","db-handler",579530098),Nl=new C(null,"line-color","line-color",1331573993),Ol=new C(null,"z-index","z-index",1892827090),Pl=new C(null,"on-change-fn","on-change-fn",-1237394275),Ql=new C(null,"container","container",-1736937707),Rl=new C(null,"text-size","text-size",-945618309),
Sl=new C(null,"text-anchor","text-anchor",585613696),Tl=new C("models-3d","eiffel-loaded?","models-3d/eiffel-loaded?",-463318992),Ul=new C(null,"paint","paint",1531901299),Vl=new C(null,"contextTypes","contextTypes",-2023853910),Th=new C(null,"layer-repaint","layer-repaint",-1852278440),Wl=new C(null,"user-rotation-z","user-rotation-z",-252586405),Xl=new C(null,"run-queue","run-queue",-1701798027),Yl=new C(null,"rotation-z","rotation-z",-1097301628),Zl=new C(null,"cofx","cofx",2013202907),$l=new C(null,
"directional","directional",-395676974),am=new C(null,"display","display",242065432),bm=new C(null,"initialize-db","initialize-db",230998432),cm=new C(null,"on-dispose","on-dispose",2105306360),dm=new C(null,"displayName","displayName",-809144601),em=new C(null,"color","color",1011675173),fm=new C(null,"minzoom","minzoom",837870895),gm=new C(null,"property","property",-1114278232),hm=new C(null,"background-opacity","background-opacity",-1073748756),im=new C(null,"disabled","disabled",-1529784218),
jm=new C("map-engine","register-on-load-callback","map-engine/register-on-load-callback",907667540),km=new C(null,"log","log",-1595516004),jh=new C("cljs.core","not-found","cljs.core/not-found",-1572889185),lm=new C(null,"style-key","style-key",-567658392),mm=new C("map","zoom","map/zoom",-1827365530),nm=new C(null,"trigger","trigger",103466139),om=new C(null,"show-other-components?","show-other-components?",1239426461),pm=new C(null,"text-font","text-font",1082626311),qm=new C(null,"margin","margin",
-995903681),rm=new C(null,"prop-type","prop-type",-29963356),Rh=new C(null,"val","val",128701612),sm=new C(null,"getDerivedStateFromError","getDerivedStateFromError",166658477),tm=new C(null,"validator","validator",-1966190681),um=new C(null,"source-layer","source-layer",-637591060),vm=new C("lighting","update-property","lighting/update-property",-911564627),wm=new C(null,"flush-dom","flush-dom",-933676816),xm=new C("buildings","update-shadow","buildings/update-shadow",-361175877),ym=new C(null,"labels",
"labels",-626734591),Da=new C(null,"flush-on-newline","flush-on-newline",-151457939),zm=new C(null,"osm","osm",855693280),Am=new C(null,"resume","resume",-118572261),Bm=new C(null,"flex-direction","flex-direction",364609438),Cm=new C(null,"not-set-label","not-set-label",-1071979799),Dm=new C("style-editor","set-selected-category","style-editor/set-selected-category",331301449),Em=new C(null,"avg","avg",197406200),Fm=new C(null,"step","step",1288888124),Gm=new C(null,"gap","gap",80255254),Hm=new C("models-3d",
"remove-eiffel-tower","models-3d/remove-eiffel-tower",-159595345),Im=new C(null,"yield","yield",177875009),Jm=new C(null,"height","height",1025178622),Km=new C("style-editor","target-layer","style-editor/target-layer",512227593),Lm=new C(null,"font-family","font-family",-667419874),Mm=new C(null,"on-zoom-style-change","on-zoom-style-change",960187506),Nm=new C(null,"display-name","display-name",694513143),Om=new C(null,"before","before",-1633692388),Pm=new C("models-3d","eiffel-rotation-z","models-3d/eiffel-rotation-z",
-1552906895),Qm=new C(null,"padding","padding",1660304693),Rm=new C(null,"dark-style","dark-style",-240580206),Sm=new C(null,"effects","effects",-282369292),Tm=new C(null,"pitch","pitch",1495126700),Um=new C("style-editor","fly-to-feature","style-editor/fly-to-feature",-1187955656),Vm=new C(null,"lighting","lighting",562618055),Wm=new C(null,"add-event","add-event",938429088),Xm=new C(null,"set-map-loading?","set-map-loading?",-407826014),Ym=new C(null,"exception","exception",-335277064),Zm=new C(null,
"unsupported","unsupported",-1045607016),$m=new C(null,"\x3c-","\x3c-",760412998),an=new C(null,"checked","checked",-50955819),bn=new C("style-editor","update-and-apply-style","style-editor/update-and-apply-style",-318945270),cn=new C(null,"tiles","tiles",178505240),dn=new C(null,"text-transform","text-transform",1685000676),en=new C("models-3d","set-eiffel-rotation-z","models-3d/set-eiffel-rotation-z",1077785455),fn=new C(null,"fill-extrusion-color","fill-extrusion-color",-825219524),gn=new C(null,
"single-props-fn","single-props-fn",-892330629),hn=new C(null,"sources","sources",-321166424),jn=new C(null,"fill-extrusion-opacity","fill-extrusion-opacity",-457270565),kn=new C(null,"input","input",556931961),ln=new C(null,"\x3c\x3e","\x3c\x3e",1280186386),mn=new C(null,"label-fn","label-fn",-860923263),Dh=new C(null,"more-marker","more-marker",-14717935),nn=new C(null,"fsm-state","fsm-state",1656310533),on=new C(null,"clear-custom-layers","clear-custom-layers",-594285938),pn=new C(null,"span",
"span",1394872991),qn=new C(null,"min","min",444991522),rn=new C(null,"button","button",1456579943),Y=new C(null,"key","key",-1516042587),sn=new C(null,"type","type",1174270348),Lh=new C(null,"alt-impl","alt-impl",670969595),tn=new C(null,"unnamed","unnamed",-26044928),un=new C(null,"div.prewarming-text","div.prewarming-text",1183402498),vn=new C(null,"global-interceptors","global-interceptors",-1995759472),wn=new C(null,"position","position",-2011731912),xn=new C("style-editor","switch-target-layer",
"style-editor/switch-target-layer",-1724739528),yn=new C(null,"sub","sub",-2093760025),zn=new C("models-3d","set-eiffel-scale","models-3d/set-eiffel-scale",-2090890888),An=new C("models-3d","add-eiffel-tower","models-3d/add-eiffel-tower",1502005857),Bn=new C(null,"default-layer","default-layer",385967031),Cn=new C(null,"raster-style","raster-style",563017384),Dn=new C(null,"buildings","buildings",-308691065);var En={},Fn={},Gn=[];function Hn(a,b){var c=Fn[a];if(void 0!==c)return c;try{Gn.push(a);var d=En[a],e=shadow$provide[a];if(void 0===d){if(void 0===e)throw"Module not provided: "+a;d={exports:{}};En[a]=d}if(e){delete shadow$provide[a];try{e.call(d,aa,Hn,d,d.exports)}catch(g){throw console.warn("shadow-cljs - failed to load",a),console.error(g),g;}if(b){var f=b.globals;if(f)for(a=0;a<f.length;a++)window[f[a]]=d.exports}}}finally{Gn.pop()}return d.exports}Hn.cache={};Hn.resolve=function(a){return a};
Hn.exportCopy=function(a,b){let c={};a=a.exports;for(let d in b)"default"==d||d in a||d in c||(c[d]={enumerable:!0,get:function(){return b[d]}});Object.defineProperties(a,c)};Hn.esmDefault=function(a){return a&&a.__esModule?a:{"default":a}};Hn.dynamic=function(a){return Promise.resolve().then(function(){return Hn(a)})};var In=Hn(2,{});function Jn(a,b,c){var d=u(b.ignoreCase)?"gi":"g";d=u(b.multiline)?[d,"m"].join(""):d;return a.replace(new RegExp(b.source,u(b.unicode)?[d,"u"].join(""):d),c)}
function Kn(a){return function(){function b(d){var e=null;if(0<arguments.length){e=0;for(var f=Array(arguments.length-0);e<f.length;)f[e]=arguments[e+0],++e;e=new G(f,0,null)}return c.call(this,e)}function c(d){d=hf(d);if(J.m(M(d),1))return d=H(d),a.j?a.j(d):a.call(null,d);d=Wf(d);return a.j?a.j(d):a.call(null,d)}b.D=0;b.F=function(d){d=D(d);return c(d)};b.v=c;return b}()}
function Ln(a,b,c){if("string"===typeof b)return a.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c);if(b instanceof RegExp)return"string"===typeof c?Jn(a,b,c):Jn(a,b,Kn(c));throw["Invalid match arg: ",y.j(b)].join("");}function Mn(a){var b=new Aa;for(a=D(a);;)if(null!=a)b.append(y.j(H(a))),a=I(a),null!=a&&b.append(" ");else return b.toString()}
function Nn(a){var b=/-/;a="/(?:)/"===y.j(b)?ld.m(Wf(id("",ef.m(y,D(a)))),""):Wf(y.j(a).split(b));if(1<M(a))a:for(;;)if(""===xd(a))a=null==a?null:zb(a);else break a;return a};var On="undefined"!==typeof window&&null!=window.document,Pn=new lh(null,new r(null,2,["aria",null,"data",null],null),null);function Qn(a){return 2>M(a)?a.toUpperCase():[a.substring(0,1).toUpperCase(),a.substring(1)].join("")}function Rn(a){if("string"===typeof a)return a;a=ke(a);var b=Nn(a),c=D(b);b=H(c);c=I(c);return u(Pn.j?Pn.j(b):Pn.call(null,b))?a:De(y,b,ef.m(Qn,c))}
function Sn(a){var b=function(){var c=function(){var d=sd(a);if(d){d=a.displayName;if(u(d))return d;d=a.name;return"string"===typeof d&&D(d)?d:null}return d}();if(u(c))return c;c=function(){var d=null!=a?a.J&4096||n===a.Dc?!0:!1:!1;return d?ke(a):d}();if(u(c))return c;c=wd(a);return Dd(c)?Al.j(c):null}();return u(b)?Ln(y.j(b),"$","."):null}function Tn(a){return a instanceof C||a instanceof Ec}
var Un=function Un(a){switch(arguments.length){case 0:return Un.H();case 1:return Un.j(arguments[0]);case 2:return Un.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return Un.v(arguments[0],arguments[1],c)}};Un.H=function(){return null};Un.j=function(a){return Ad(a)?(a=Xe(function(b){return u(b)?Tn(b)?ke(b):b:null},a),D(a)?Mn(a):null):Tn(a)?ke(a):a};
Un.m=function(a,b){return u(a)?u(b)?[y.j(Un.j(a))," ",y.j(Un.j(b))].join(""):Un.j(a):Un.j(b)};Un.v=function(a,b,c){return Sa(Un,Un.m(a,b),c)};Un.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};Un.D=2;var Vn=!1;function Wn(a){if(Dd(a))try{var b=B(a,Y)}catch(c){b=null}else b=null;return b}
function Xn(a){var b=Y.j(wd(a));if(null!=b)return b;b=Q(a,0,null);switch(b instanceof C?b.va:null){case "\x3e":case "f\x3e":return Wn(Q(a,2,null));case "r\x3e":return a=Q(a,2,null),null==a?null:a.key;default:return Wn(Q(a,1,null))}};var Yn=0;function Zn(a){return setTimeout(a,16)}var $n=On?function(){var a=window;return function(){var b=a.requestAnimationFrame;if(u(b))return b;b=a.webkitRequestAnimationFrame;if(u(b))return b;b=a.mozRequestAnimationFrame;if(u(b))return b;b=a.msRequestAnimationFrame;return u(b)?b:Zn}().bind(a)}():Zn;function ao(a,b){return a.rc-b.rc}function bo(){return null}function co(a){for(var b=a.length,c=0;;)if(c<b){var d=a[c];d.H?d.H():d.call(null);c+=1}else return null}
function eo(a,b,c){b.push(c);return a.schedule()}function fo(){this.ec=!1}h=fo.prototype;h.flush_after_render=function(){var a=this.Pb;if(null==a)return null;this.Pb=null;return co(a)};h.queue_render=function(a){null==this.$b&&(this.$b=[]);return eo(this,this.$b,a)};h.schedule=function(){function a(){return b.run_queues()}var b=this;if(this.ec)return null;this.ec=!0;return $n.j?$n.j(a):$n.call(null,a)};h.flush_before_flush=function(){var a=this.Qb;if(null==a)return null;this.Qb=null;return co(a)};
h.flush_queues=function(){this.flush_before_flush();bo();this.flush_render();return this.flush_after_render()};h.run_queues=function(){this.ec=!1;return this.flush_queues()};h.add_before_flush=function(a){null==this.Qb&&(this.Qb=[]);return eo(this,this.Qb,a)};h.add_after_render=function(a){null==this.Pb&&(this.Pb=[]);return eo(this,this.Pb,a)};
h.flush_render=function(){var a=this.$b;if(null==a)return null;this.$b=null;a:{a.sort(ao);for(var b=a.length,c=0;;)if(c<b){var d=a[c];!0===d.cljsIsDirty&&d.forceUpdate();c+=1}else break a}return null};var go=new fo;function ho(a){if(u(a.cljsIsDirty))return null;a.cljsIsDirty=!0;return go.queue_render(a)};function io(a){if(null!=a&&null!=a.wd)a=a.id;else{var b=io[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=io._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("Compiler.get-id",a);}return a}function jo(a,b,c){if(null!=a&&null!=a.Qc)a=a.Qc(a,b,c);else{var d=jo[m(null==a?null:a)];if(null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else if(d=jo._,null!=d)a=d.o?d.o(a,b,c):d.call(null,a,b,c);else throw x("Compiler.parse-tag",a);}return a}
function ko(a,b){if(null!=a&&null!=a.Oc)a=a.Oc(a,b);else{var c=ko[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=ko._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("Compiler.as-element",a);}return a}function lo(a,b,c,d,e){if(null!=a&&null!=a.Pc)a=a.Pc(a,b,c,d,e);else{var f=lo[m(null==a?null:a)];if(null!=f)a=f.O?f.O(a,b,c,d,e):f.call(null,a,b,c,d,e);else if(f=lo._,null!=f)a=f.O?f.O(a,b,c,d,e):f.call(null,a,b,c,d,e);else throw x("Compiler.make-element",a);}return a};function mo(a,b){var c=De(th,a,b);return id(c,of(function(d){return c===d},b))}function no(a,b){return M(a)<M(b)?Sa(ld,b,a):Sa(ld,a,b)}var oo=function oo(a){switch(arguments.length){case 1:return oo.j(arguments[0]);case 2:return oo.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return oo.v(arguments[0],arguments[1],c)}};oo.j=function(a){return a};
oo.m=function(a,b){for(;;)if(M(b)<M(a)){var c=a;a=b;b=c}else return Sa(function(d,e){return function(f,g){return Nd(e,g)?f:yd.m(f,g)}}(a,b),a,a)};oo.v=function(a,b,c){a=mo(function(d){return-M(d)},ld.v(c,b,O([a])));return Sa(oo,H(a),Kc(a))};oo.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};oo.D=2;
var po=function po(a){switch(arguments.length){case 1:return po.j(arguments[0]);case 2:return po.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=2<c.length?new G(c.slice(2),0,null):null;return po.v(arguments[0],arguments[1],c)}};po.j=function(a){return a};po.m=function(a,b){return M(a)<M(b)?Sa(function(c,d){return Nd(b,d)?yd.m(c,d):c},a,a):Sa(yd,a,b)};po.v=function(a,b,c){return Sa(po,a,ld.m(c,b))};
po.F=function(a){var b=H(a),c=I(a);a=H(c);c=I(c);return this.v(b,a,c)};po.D=2;var qo;function ro(a,b){b.ic=null;a:{var c=qo;qo=b;try{var d=a.H?a.H():a.call(null);break a}finally{qo=c}d=void 0}a=b.ic;b.Na=!1;a:{c=b.ob;var e=null==a?0:a.length,f=e===(null==c?0:c.length);if(f)for(f=0;;){var g=f===e;if(g){c=g;break a}if(a[f]===c[f])f+=1;else{c=!1;break a}}else c=f}c||b._update_watching(a);return d}function so(a){var b=qo;if(null!=b){var c=b.ic;null==c?b.ic=[a]:c.push(a)}}function to(a,b,c){a.ja=R.o(a.ja,b,c);return a.yc=null}
function uo(a,b){a.ja=rd.m(a.ja,b);return a.yc=null}function vo(a,b,c){var d=a.yc;d=null==d?a.yc=Zd(function(l,p,q){l.push(p);l.push(q);return l},[],a.ja):d;for(var e=d.length,f=0;;)if(f<e){var g=d[f],k=d[f+1];k.I?k.I(g,a,b,c):k.call(null,g,a,b,c);f=2+f}else return null}function wo(a,b,c,d){Tb(a,["#object[reagent.ratom.",y.j(c)," "].join(""));a:{c=qo;qo=null;try{var e=d;break a}finally{qo=c}e=void 0}Jh(e,a,b);return Tb(a,"]")}var xo=null;
function yo(a,b,c,d){this.state=a;this.meta=b;this.xc=c;this.ja=d;this.A=2154201088;this.J=114690}h=yo.prototype;h.cc=n;h.R=function(a,b,c){return wo(b,c,"RAtom",new r(null,1,[Rh,this.ta(null)],null))};h.V=function(){return this.meta};h.U=function(){return da(this)};h.S=function(a,b){return this===b};h.ua=function(a,b){a=this.state;this.state=b;null!=this.ja&&vo(this,a,b);return b};h.Tb=function(a,b){return this.ua(null,b.j?b.j(this.state):b.call(null,this.state))};
h.Ub=function(a,b,c){return this.ua(null,b.m?b.m(this.state,c):b.call(null,this.state,c))};h.Vb=function(a,b,c,d){return this.ua(null,b.o?b.o(this.state,c,d):b.call(null,this.state,c,d))};h.Wb=function(a,b,c,d,e){return this.ua(null,Fe(b,this.state,c,d,e))};h.Xb=function(a,b){vo(this,a,b)};h.Eb=function(a,b,c){return to(this,b,c)};h.Fb=function(a,b){return uo(this,b)};h.Y=function(a,b){return new yo(this.state,b,this.xc,this.ja)};h.ta=function(){so(this);return this.state};
var zo=function zo(a){switch(arguments.length){case 1:return zo.j(arguments[0]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return zo.v(arguments[0],c)}};zo.j=function(a){return new yo(a,null,null,null)};zo.v=function(a,b){var c=S(b);b=B(c,Fa);c=B(c,tm);return new yo(a,b,c,null)};zo.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};zo.D=1;
function Ao(a,b,c,d,e){var f=b.tc;f=null==f?He:f;var g=f.m?f.m(c,null):f.call(null,c,null);if(null!=g)return A(g);if(null==qo)return a.H?a.H():a.call(null);g=function(){function l(p){var q=rd.m(b.tc,c);b.tc=q;null!=d&&(d.yb=null);return null!=e?e.j?e.j(p):e.call(null,p):null}return Bo.o?Bo.o(a,cm,l):Bo.call(null,a,cm,l)}();var k=A(g);b.tc=R.o(f,c,g);null!=d&&(d.yb=g);return k}function Co(a,b,c){this.f=a;this.args=b;this.yb=c;this.A=2153807872;this.J=0}h=Co.prototype;h.cc=n;
h.ta=function(){var a=this,b=a.yb;return null==b?Ao(function(){return Ce(a.f,a.args)},a.f,a.args,this,null):A(b)};h.S=function(a,b){return b instanceof Co&&J.m(this.f,b.f)&&J.m(this.args,b.args)};h.U=function(){return Ac(new T(null,2,5,U,[this.f,this.args],null))};h.R=function(a,b,c){return wo(b,c,"Track",new r(null,2,[Rh,this.ta(null),ql,this.f],null))};
function Do(a,b){var c=new Co(a,b,null);a=function(){function d(){return c.ta(null)}return Bo.o?Bo.o(d,Qi,!0):Bo.call(null,d,Qi,!0)}();A(a);return a}function Eo(a,b,c,d,e,f){this.ca=a;this.path=b;this.yb=c;this.state=d;this.ja=e;this.meta=f;this.A=2154201088;this.J=114690}h=Eo.prototype;h._peek=function(){var a=qo;qo=null;try{return this.ta(null)}finally{qo=a}};h._set_state=function(a,b){if(a===b)return null;this.state=b;return null!=this.ja?vo(this,a,b):null};h.cc=n;
h.R=function(a,b,c){return wo(b,c,"RCursor",new r(null,2,[Rh,this.ta(null),Ej,this.path],null))};h.V=function(){return this.meta};h.U=function(){return Ac(new T(null,2,5,U,[this.ca,this.path],null))};h.S=function(a,b){return b instanceof Eo&&J.m(this.path,b.path)&&J.m(this.ca,b.ca)};
h.ua=function(a,b){this._set_state(this.state,b);(null!=this.ca?this.ca.A&32768||n===this.ca.Bc||(this.ca.A?0:v(Cb,this.ca)):v(Cb,this.ca))?J.m(this.path,md)?$e(this.ca,b):af.I(this.ca,uf,this.path,b):this.ca.m?this.ca.m(this.path,b):this.ca.call(null,this.path,b);return b};h.Tb=function(a,b){a=this.ua;var c=this._peek();b=b.j?b.j(c):b.call(null,c);return a.call(this,null,b)};h.Ub=function(a,b,c){a=this.ua;var d=this._peek();b=b.m?b.m(d,c):b.call(null,d,c);return a.call(this,null,b)};
h.Vb=function(a,b,c,d){a=this.ua;var e=this._peek();b=b.o?b.o(e,c,d):b.call(null,e,c,d);return a.call(this,null,b)};h.Wb=function(a,b,c,d,e){return this.ua(null,Fe(b,this._peek(),c,d,e))};h.Xb=function(a,b){vo(this,a,b)};h.Eb=function(a,b,c){return to(this,b,c)};h.Fb=function(a,b){return uo(this,b)};h.Y=function(a,b){return new Eo(this.ca,this.path,this.yb,this.state,this.ja,b)};
h.ta=function(){var a=this,b=this,c=a.state,d=function(){var e=a.yb;return null==e?Ao((null!=a.ca?a.ca.A&32768||n===a.ca.Bc||(a.ca.A?0:v(Cb,a.ca)):v(Cb,a.ca))?function(){return tf(A(a.ca),a.path)}:function(){return a.ca.j?a.ca.j(a.path):a.ca.call(null,a.path)},a.ca,a.path,b,null):A(e)}();b._set_state(c,d);return d};function Fo(a){a=a.destroy;return null==a?null:a.H?a.H():a.call(null)}function Go(){var a=qo;return null==a?[]:Ao(function(){return[]},a,Ok,null,Fo)}
function Ho(a){if(null!=a&&null!=a.uc)a=a.uc(a);else{var b=Ho[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Ho._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("IDisposable.dispose!",a);}return a}function Io(a,b){if(null!=a&&null!=a.Rc)a.Rc(a,b);else{var c=Io[m(null==a?null:a)];if(null!=c)c.m?c.m(a,b):c.call(null,a,b);else if(c=Io._,null!=c)c.m?c.m(a,b):c.call(null,a,b);else throw x("IDisposable.add-on-dispose!",a);}}function Jo(a,b,c,d){return a._handle_change(b,c,d)}
function Ko(a,b,c,d,e,f,g,k){this.f=a;this.state=b;this.Na=c;this.Lc=d;this.ob=e;this.ja=f;this.Fa=g;this.jc=k;this.A=2153807872;this.J=114690}h=Ko.prototype;h._peek_at=function(){var a=qo;qo=null;try{return this.ta(null)}finally{qo=a}};h._handle_change=function(a,b,c){return b===c||this.Na?null:null==this.Fa?(this.Na=!0,null==xo&&(xo=[],!1===go.ec&&go.schedule()),xo.push(this)):!0===this.Fa?this._run(!1):this.Fa.j?this.Fa.j(this):this.Fa.call(null,this)};
h._update_watching=function(a){var b=ph(a),c=ph(this.ob);this.ob=a;a=D(po.m(b,c));for(var d=null,e=0,f=0;;)if(f<e){var g=d.M(null,f);Wb(g,this,Jo);f+=1}else if(a=D(a))d=a,Gd(d)?(a=ec(d),f=fc(d),d=a,e=M(a),a=f):(a=H(d),Wb(a,this,Jo),a=I(d),d=null,e=0),f=0;else break;b=D(po.m(c,b));c=null;for(e=d=0;;)if(e<d)a=c.M(null,e),Xb(a,this),e+=1;else if(b=D(b))c=b,Gd(c)?(b=ec(c),d=fc(c),c=b,a=M(b),b=d,d=a):(a=H(c),Xb(a,this),b=I(c),c=null,d=0),e=0;else return null};
h._queued_run=function(){return this.Na&&null!=this.ob?this._run(!0):null};h._try_capture=function(a){try{return this.jc=null,ro(a,this)}catch(b){return this.jc=this.state=a=b,this.Na=!1}};h._run=function(a){var b=this.state;a=u(a)?this._try_capture(this.f):ro(this.f,this);this.Lc||(this.state=a,null==this.ja||J.m(b,a)||vo(this,b,a));return a};
h._set_opts=function(a){var b=S(a);a=B(b,Qi);var c=B(b,Uk),d=B(b,cm);b=B(b,Di);null!=a&&(this.Fa=a);null!=c&&(this.td=c);null!=d&&(this.Mc=d);return null!=b?this.Lc=b:null};h.cc=n;h.R=function(a,b,c){return wo(b,c,"Reaction",new r(null,1,[Rh,this.ta(null)],null))};h.U=function(){return da(this)};h.S=function(a,b){return this===b};
h.uc=function(){var a=this.state,b=this.ob;this.Fa=this.state=this.ob=null;this.Na=!0;b=D(ph(b));for(var c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e);Xb(f,this);e+=1}else if(b=D(b))c=b,Gd(c)?(b=ec(c),e=fc(c),c=b,d=M(b),b=e):(b=H(c),Xb(b,this),b=I(c),c=null,d=0),e=0;else break;null!=this.Mc&&this.Mc(a);a=this.Nc;if(null==a)return null;b=a.length;for(c=0;;)if(c<b)d=a[c],d.j?d.j(this):d.call(null,this),c+=1;else return null};h.Rc=function(a,b){a=this.Nc;return null==a?this.Nc=[b]:a.push(b)};
h.ua=function(a,b){a=this.state;this.state=b;this.td(a,b);vo(this,a,b);return b};h.Tb=function(a,b){a=this.ua;var c=this._peek_at();b=b.j?b.j(c):b.call(null,c);return a.call(this,null,b)};h.Ub=function(a,b,c){a=this.ua;var d=this._peek_at();b=b.m?b.m(d,c):b.call(null,d,c);return a.call(this,null,b)};h.Vb=function(a,b,c,d){a=this.ua;var e=this._peek_at();b=b.o?b.o(e,c,d):b.call(null,e,c,d);return a.call(this,null,b)};h.Wb=function(a,b,c,d,e){return this.ua(null,Fe(b,this._peek_at(),c,d,e))};
h.Xb=function(a,b){vo(this,a,b)};h.Eb=function(a,b,c){return to(this,b,c)};h.Fb=function(a,b){a=zd(this.ja);uo(this,b);return!a&&zd(this.ja)&&null==this.Fa?this.uc(null):null};h.ta=function(){var a=this.jc;if(null!=a)throw a;(a=null==qo)&&(Lo.H?Lo.H():Lo.call(null));a&&null==this.Fa?this.Na&&(a=this.state,this.state=this.f.H?this.f.H():this.f.call(null),null==this.ja||J.m(a,this.state)||vo(this,a,this.state)):(so(this),this.Na&&this._run(!1));return this.state};
function Lo(){for(;;){var a=xo;if(null==a)return null;xo=null;for(var b=a.length,c=0;;)if(c<b)a[c]._queued_run(),c+=1;else break}}bo=Lo;function Bo(a){for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;c=1<b.length?new G(b.slice(1),0,null):null;b=arguments[0];var e=S(c);c=B(e,Qi);d=B(e,Uk);e=B(e,cm);b=new Ko(b,null,!0,!1,null,null,null,null);b._set_opts(new r(null,3,[Qi,c,Uk,d,cm,e],null));return b}var Mo=Bo(null);
function No(a,b){var c=Oo,d=Mo,e=ro(a,d);null!=d.ob&&(Mo=Bo(null),d._set_opts(c),d.f=a,d.Fa=function(){return ho.j?ho.j(b):ho.call(null,b)},b.cljsRatom=d);return e};var Po;function Qo(a,b){var c=b.argv;if(null==c){c=U;a=a.constructor;a:for(var d=oa(b),e=d.length,f=He,g=0;;)if(g<e){var k=d[g];f=R.o(f,je.j(k),pa(b,k));g+=1}else break a;b=new T(null,2,5,c,[a,f],null)}else b=c;return b}function Ro(a){var b;if(b=sd(a))a=null==a?null:a.prototype,b=null!=(null==a?null:a.Pa);return b}
function So(a,b){for(;;){var c=a.Pa,d=!0===a.ld?c.call(a,a):function(){var e=Qo(a,a.props);switch(M(e)){case 1:return c.call(a);case 2:return c.call(a,ed(e,1));case 3:return c.call(a,ed(e,1),ed(e,2));case 4:return c.call(a,ed(e,1),ed(e,2),ed(e,3));case 5:return c.call(a,ed(e,1),ed(e,2),ed(e,3),ed(e,4));default:return c.apply(a,Ra(e).slice(1))}}();if(Fd(d))return ko(b,d);if(Ld(d))a.Pa=Ro(d)?function(e,f,g,k,l){return function(){function p(t){var w=null;if(0<arguments.length){w=0;for(var z=Array(arguments.length-
0);w<z.length;)z[w]=arguments[w+0],++w;w=new G(z,0,null)}return q.call(this,w)}function q(t){return ko(f,De(We,l,t))}p.D=0;p.F=function(t){t=D(t);return q(t)};p.v=q;return p}()}(a,b,c,null,d):d;else return d}}var Oo=new r(null,1,[Di,!0],null);
function To(a,b){switch(a instanceof C?a.va:null){case "getDefaultProps":throw Error("getDefaultProps not supported");case "getDerivedStateFromProps":return function(c,d){var e=b.call,f=c.argv;null!=f&&(c=Q(f,1,null),c=Dd(c)?c:null);return e.call(b,null,c,d)};case "getInitialState":return function(c){var d=c.nd;d=null!=d?d:c.nd=zo.j(null);return $e(d,b.call(c,c))};case "getSnapshotBeforeUpdate":return function(c,d){return b.call(this,this,Qo(this,c),d)};case "componentWillReceiveProps":return function(c){return b.call(this,
this,Qo(this,c))};case "UNSAFE_componentWillReceiveProps":return function(c){return b.call(this,this,Qo(this,c))};case "shouldComponentUpdate":return function(c){var d=Vn;if(u(d))return d;d=this.props.argv;var e=c.argv,f=null==d||null==e;if(null==b){if(f)return f;try{return Ie(d,e)}catch(g){return!1}}else return f?b.call(this,this,Qo(this,this.props),Qo(this,c)):b.call(this,this,d,e)};case "componentWillUpdate":return function(c,d){return b.call(this,this,Qo(this,c),d)};case "UNSAFE_componentWillUpdate":return function(c,
d){return b.call(this,this,Qo(this,c),d)};case "componentDidUpdate":return function(c,d,e){return b.call(this,this,Qo(this,c),d,e)};case "componentWillMount":return function(){return b.call(this,this)};case "UNSAFE_componentWillMount":return function(){return b.call(this,this)};case "componentDidMount":return function(){return b.call(this,this)};case "componentWillUnmount":return function(){var c=pa(this,"cljsRatom");null!=c&&Ho(c);this.cljsIsDirty=!1;return null==b?null:b.call(this,this)};case "componentDidCatch":return function(c,
d){return b.call(this,this,c,d)};default:return null}}var Uo=new r(null,2,[Zi,null,el,null],null),Vo=function(a){var b=Ze(He);return function(c){var d=B(A(b),c);if(null!=d)return d;d=a.j?a.j(c):a.call(null,c);af.I(b,R,c,d);return d}}(function(a){if("string"===typeof a)return a;a=ke(a);a=Ln(a,/(unsafe|UNSAFE)[-_]/,"UNSAFE_");a=Nn(a);var b=D(a);a=H(b);b=I(b);return De(y,a,ef.m(Qn,b))});function Wo(a){return Zd(function(b,c,d){return R.o(b,je.j(Vo(c)),d)},He,a)}
function Xo(a,b){var c=function(){var g=ij.j(a);return u(g)?g:Bj.j(a)}(),d=null==ij.j(a),e=function(){var g=dm.j(a);if(u(g))return g;g=Sn(c);return u(g)?g:y.j(Vh("reagent"))}(),f=Zd(function(g,k,l){var p=R.o,q=To(k,l);return p.call(R,g,k,u(q)?q:l)},He,a);return R.v(f,dm,e,O([kk,d,ij,c,Bj,function(){var g=this,k=pa(g,"cljsRatom");g.cljsIsDirty=!1;return null==k?No(function(){a:{var l=Po;Po=g;try{var p=So(g,b);break a}finally{Po=l}p=void 0}return p},g):k._run(!1)}]))}
function Yo(a){return Zd(function(b,c,d){c=ke(c);b[c]=d;return b},{},a)}function Zo(a,b){return Xo(hh.v(O([Uo,Wo(a)])),b)}var $o=new T(null,5,5,U,[$i,Vl,Ik,Ri,sm],null);
function ap(a,b){function c(k,l,p){In.Component.call(this,k,l,p);u(g)&&(g.m?g.m(this,k):g.call(null,this,k));u(f)&&(this.state=f.j?f.j(this):f.call(null,this));this.rc=Yn+=1;return this}a=Zo(a,b);b=Yo(Ge(rd,a,dm,vl,Ai,O([Bj,ij,$o])));var d=Yo(ih(a,$o)),e=dm.j(a),f=vl.j(a),g=Ai.j(a);sa(c.prototype,In.Component.prototype,b);u(Bj.j(a))&&(c.prototype.render=Bj.j(a));u(ij.j(a))&&(c.prototype.Pa=ij.j(a));u(kk.j(a))&&(c.prototype.ld=kk.j(a));sa(c,In.Component,d);u(e)&&(c.displayName=e,c.Yb=e,c.kd=function(k){return Tb(k,
e)},Object.defineProperty(c,"name",{value:e,writable:!1}));c.Hc=!0;return c.prototype.constructor=c}function bp(a,b,c){a=io(a);return b[a]=c}
function cp(a,b){for(;;){var c=b.Pa,d=b.argv,e=Ce(c,d);if(Fd(e))return ko(a,e);if(Ld(e))b.Pa=Ro(e)?function(f,g,k,l,p,q){return function(){function t(z){var E=null;if(0<arguments.length){E=0;for(var F=Array(arguments.length-0);E<F.length;)F[E]=arguments[E+0],++E;E=new G(F,0,null)}return w.call(this,E)}function w(z){return ko(f,De(We,q,z))}t.D=0;t.F=function(z){z=D(z);return w(z)};t.v=w;return t}()}(a,b,c,null,d,e):e;else return e}}
function dp(a,b){var c=b.argv,d=b.Pa;b=In.useState(0);Q(b,0,null);var e=Q(b,1,null),f=In.useRef();u(f.current)||function(){var k={forceUpdate:function(){return e.j?e.j(Tc):e.call(null,Tc)}};k.rc=Yn+=1;k.constructor=d;k.Pa=d;return f.current=k}();var g=f.current;b=pa(g,"cljsRatom");In.useEffect(function(){return function(){var k=pa(g,"cljsRatom");return null==k?null:Ho(k)}},[]);g.argv=c;g.cljsIsDirty=!1;return null==b?No(function(){a:{var k=Po;Po=g;try{var l=cp(a,g);break a}finally{Po=k}l=void 0}return l},
g):b._run(!1)}function ep(a,b){a=a.argv;b=b.argv;var c=!1===Vn;if(c)try{return J.m(a,b)}catch(d){return!1}else return c}function fp(a,b){function c(e){return dp(a,e)}var d=pa(b,io(a));if(u(d))return d;d=Sn(b);c.displayName=d;Object.defineProperty(c,"name",{value:d,writable:!1});d=In.memo(c,ep);bp(a,b,d);return d};var gp=new lh(null,new r(null,6,["url",null,"tel",null,"text",null,"textarea",null,"password",null,"search",null],null),null),hp=!1;
function ip(a,b,c,d){var e=S(He);e=B(e,bl);if(u(function(){var g=!(a===document.activeElement&&Nd(gp,a.type)&&"string"===typeof b&&"string"===typeof c);return g?g:hp}()))return d.Zb=b,a.value=b,sd(e)?e.j?e.j(b):e.call(null,b):null;var f=a.value;if(Ie(f,c))return go.add_after_render(function(){var g=hp;hp=!0;try{return jp.j?jp.j(d):jp.call(null,d)}finally{hp=g}});f=M(f)-a.selectionStart;f=M(b)-f;d.Zb=b;a.value=b;sd(e)&&(e.j?e.j(b):e.call(null,b));a.selectionStart=f;return a.selectionEnd=f}
function jp(a){if(u(a.qc)){a.Ic=!1;var b=a.md,c=a.Zb,d=a.sc;return Ie(b,c)?ip(d,b,c,a):null}return null}function kp(a,b,c){a.Zb=c.target.value;u(a.Ic)||(a.Ic=!0,go.add_after_render(function(){return jp(a)}));return b.j?b.j(c):b.call(null,c)}
function lp(a){var b=Po;if(u(function(){var f=null!=a;return f?(f=a.hasOwnProperty("onChange"),u(f)?a.hasOwnProperty("value"):f):f}())){var c=a.value;c=null==c?"":c;var d=a.onChange,e=a.ref;u(b.qc)||(b.qc=!0,b.Zb=c);u(b.Sc)||(b.Sc=sd(e)?function(f){b.sc=f;return e.j?e.j(f):e.call(null,f)}:u(u(e)?e.hasOwnProperty("current"):e)?function(f){b.sc=f;return e.current=f}:function(f){return b.sc=f});b.md=c;delete a.value;a.defaultValue=c;a.onChange=function(f){return kp(b,d,f)};a.ref=b.Sc}}
var mp=new r(null,4,[Nm,"ReagentInput",Gl,jp,fj,function(a){return a.qc=null},Kl,function(a,b,c,d,e){lp(c);return lo(e,a,b,c,d)}],null);var np=/([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?/,op={"class":"className","for":"htmlFor",charset:"charSet"};function pp(a,b){return a.hasOwnProperty(b)?pa(a,b):null}function yp(a,b,c){if(Tn(b)){var d=pp(op,ke(b));null==d?(d=Rn(b),b=ke(b),b=op[b]=d):b=d}c=zp.j?zp.j(c):zp.call(null,c);a[b]=c;return a}
function zp(a){return"object"!==m(a)?a:Tn(a)?ke(a):Dd(a)?Zd(yp,{},a):Ad(a)?ci(a):Ld(a)?function(){function b(d){var e=null;if(0<arguments.length){e=0;for(var f=Array(arguments.length-0);e<f.length;)f[e]=arguments[e+0],++e;e=new G(f,0,null)}return c.call(this,e)}function c(d){return Ce(a,d)}b.D=0;b.F=function(d){d=D(d);return c(d)};b.v=c;return b}():ci(a)}var Ap={};function Bp(a,b,c){if(Tn(b)){var d=pp(Ap,ke(b));null==d?(d=Rn(b),b=ke(b),b=Ap[b]=d):b=d}c=zp(c);a[b]=c;return a}
function Cp(a){return"object"!==m(a)?a:Tn(a)?ke(a):Dd(a)?Zd(Bp,{},a):Ad(a)?ci(a):Ld(a)?function(){function b(d){var e=null;if(0<arguments.length){e=0;for(var f=Array(arguments.length-0);e<f.length;)f[e]=arguments[e+0],++e;e=new G(f,0,null)}return c.call(this,e)}function c(d){return Ce(a,d)}b.D=0;b.F=function(d){d=D(d);return c(d)};b.v=c;return b}():ci(a)}
function Dp(a,b,c,d,e){switch(M(b)-e){case 0:return In.createElement(c,d);case 1:return In.createElement(c,d,ko(a,Q(b,e,null)));default:return In.createElement.apply(null,Zd(function(f,g,k){g>=e&&f.push(ko(a,k));return f},[c,d],b))}}function Ep(a,b,c,d){this.tag=a;this.id=b;this.className=c;this.custom=d}function Fp(a,b,c){var d=pa(a,io(c));null==d?Ro(a)?a=bp(c,a,a):(d=wd(a),d=R.o(d,Kl,a),d=ap(d,c),a=bp(c,a,d)):a=d;c={};c.argv=b;b=Xn(b);null!=b&&(c.key=b);return In.createElement(a,c)}
function Gp(a,b,c,d){var e={};e.Pa=a;e.argv=dg.m(b,c);b=Xn(b);null!=b&&(e.key=b);return In.createElement(fp(d,a),e)}function Hp(a,b,c){var d;if(d=sd(a))d=null==a?null:a.prototype,d=null!=(null==d?null:d.render);return d?Fp(a,b,c):Gp(a,b,1,c)}var Ip={};
function Jp(a,b,c,d){var e=a.tag,f=Q(b,c,null),g=null==f||Dd(f),k=function(){var q=g?f:null,t=W.j(q);t=u(t)?R.o(q,W,Un.j(t)):q;var w=a.id;q=a.className;w=null!=w&&null==Gk.j(t)?R.o(t,Gk,w):t;if(u(q)){var z=R.o,E=Un.m,F=W.j(t);t=u(F)?F:gl.j(t);q=z.call(R,w,W,E.call(Un,q,t))}else q=w;q=u(a.custom)?Cp(q):zp(q);u(u(q)?q.dangerouslySetInnerHTML:q)&&delete q.dangerouslySetInnerHTML;return u(q)?q:{}}();c+=g?1:0;a:switch(e){case "input":case "textarea":var l=!0;break a;default:l=!1}if(l){l=Wn(f);var p=function(){var q=
d.xd;if(u(q))return q;q=ap(mp,d);return d.xd=q}();return ko(d,vd(new T(null,6,5,U,[p,b,e,k,c,d],null),hh.v(O([u(l)?new r(null,1,[Y,l],null):null,wd(b)]))))}l=Wn(wd(b));null!=l&&(k.key=l);return lo(d,b,e,k,c)}function Kp(a,b){return Ra(ef.m(function(c){return ko(b,c)},a))}
function Lp(a,b,c){null==b&&console.error("vec-to-elem",Nh(O([a])));var d=Q(a,0,null);switch(d instanceof C?d.va:null){case "\x3e":return c=Q(a,1,null),Jp(new Ep(c,null,null,null),a,2,b);case "r\x3e":c=Q(a,1,null);d=Q(a,2,null);d=u(d)?d:{};var e=Wn(wd(a));null!=e&&(d.key=e);return lo(b,a,c,d,3);case "f\x3e":return Gp(Q(a,1,null),a,2,b);case "\x3c\x3e":return d=Q(a,1,null),c=null==d||Dd(d),d=zp(c?d:null),d=u(d)?d:{},c=1+(c?1:0),e=Xn(a),null!=e&&(d.key=e),lo(b,a,In.Fragment,d,c);default:if(Tn(d)||"string"===
typeof d)a:for(;;)switch(c=Q(a,0,null),d=ke(c),e=d.indexOf("\x3e"),e){case -1:b=Jp(jo(b,d,c),a,1,b);break a;case 0:b=null;break a;default:a=vd(new T(null,2,5,U,[d.substring(0,e),R.o(vd(a,null),0,d.substring(e+1))],null),wd(a))}else b=c.o?c.o(d,a,b):c.call(null,d,a,b);return b}}function Mp(a,b,c,d,e){this.ud=a;this.id=b;this.Jc=c;this.bc=d;this.sd=e;this.A=393216;this.J=0}h=Mp.prototype;h.Y=function(a,b){return new Mp(this.ud,this.id,this.Jc,this.bc,b)};h.V=function(){return this.sd};h.wd=function(){return this.id};
h.Qc=function(a,b,c){return this.bc.o?this.bc.o(this,b,c):this.bc.call(null,this,b,c)};h.Oc=function(a,b){return"object"!==m(b)?b:Fd(b)?Lp(b,this,this.Jc):Jd(b)?Kp(b,this):Tn(b)?ke(b):(null!=b?b.A&2147483648||n===b.aa||(b.A?0:v(Ub,b)):v(Ub,b))?Nh(O([b])):b};h.Pc=function(a,b,c,d,e){return Dp(this,b,c,d,e)};
var Np,Op=He,Pp=Vh("reagent-compiler"),Qp=u(mk.j(Op))?Hp:Fp,Rp=Gc(Op,Si,function(a,b){a=pp(Ip,b);if(null==a){var c=I(Bh(np,ke(b)));a=Q(c,0,null);var d=Q(c,1,null);c=Q(c,2,null);c=null==c?null:Ln(c,/\./," ");var e=Ie(-1,a.indexOf("-"));a=new Ep(a,d,c,e);return Ip[b]=a}return a});Np=new Mp(Op,Pp,Qp,Rp,He);function Sp(a){for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;b=1<b.length?new G(b.slice(1),0,null):null;return Do(arguments[0],b)}function Tp(a){return go.add_after_render(a)};var Up=Hn(9,{});function Vp(a){a=pa(a,"comp");In.useEffect(function(){var c=Vn;Vn=!1;try{go.flush_after_render()}finally{Vn=c}});var b=Vn;Vn=!0;try{return a.H?a.H():a.call(null)}finally{Vn=b}}function Wp(){var a=new T(null,1,5,U,[Xp],null);Yp.render(In.createElement(Vp,{comp:function(){return ko(Np,a)}}))};function Zp(){return ua("iPhone")&&!ua("iPod")&&!ua("iPad")};ua("Opera");ua("Trident")||ua("MSIE");ua("Edge");var $p=ua("Gecko")&&!(-1!=ta().toLowerCase().indexOf("webkit")&&!ua("Edge"))&&!(ua("Trident")||ua("MSIE"))&&!ua("Edge"),aq=-1!=ta().toLowerCase().indexOf("webkit")&&!ua("Edge");aq&&ua("Mobile");ua("Macintosh");ua("Windows");ua("Linux")||ua("CrOS");var bq=aa.navigator||null;bq&&(bq.appVersion||"").indexOf("X11");ua("Android");Zp();ua("iPad");ua("iPod");Zp()||ua("iPad")||ua("iPod");ta().toLowerCase().indexOf("kaios");try{(new self.OffscreenCanvas(0,0)).getContext("2d")}catch(a){};function cq(){var a=document;var b="IFRAME";"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)};function dq(a,b,c){var d=a;b&&(d=ja(a,b));d=dq.Ad(d);"function"===typeof aa.setImmediate&&(c||dq.zd())?aa.setImmediate(d):(dq.Kc||(dq.Kc=dq.qd()),dq.Kc(d))}dq.zd=function(){return aa.Window&&aa.Window.prototype&&!ua("Edge")&&aa.Window.prototype.setImmediate==aa.setImmediate?!1:!0};
dq.qd=function(){var a=aa.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ua("Presto")&&(a=function(){var e=cq();e.style.display="none";document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ja(function(l){if(("*"==k||l.origin==k)&&l.data==g)this.port1.onmessage()},this);f.addEventListener("message",
e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!ua("Trident")&&!ua("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.zc;c.zc=null;e()}};return function(e){d.next={zc:e};d=d.next;b.port2.postMessage(0)}}return function(e){aa.setTimeout(e,0)}};dq.Ad=function(a){return a};function eq(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=!1}eq.prototype.stopPropagation=function(){};eq.prototype.preventDefault=function(){this.defaultPrevented=!0};var fq=function(){if(!aa.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{aa.addEventListener("test",()=>{},b),aa.removeEventListener("test",()=>{},b)}catch(c){}return a}();function gq(a,b){eq.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key="";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.Gb=null;a&&this.init(a,b)}ka(gq,eq);var hq={2:"touch",3:"pen",4:"mouse"};
gq.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if($p){a:{try{la(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=
d.screenY||0):(this.offsetX=aq||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=aq||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||"";this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=
a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:hq[a.pointerType]||"";this.state=a.state;this.Gb=a;a.defaultPrevented&&gq.wc.preventDefault.call(this)};gq.prototype.stopPropagation=function(){gq.wc.stopPropagation.call(this);this.Gb.stopPropagation?this.Gb.stopPropagation():this.Gb.cancelBubble=!0};gq.prototype.preventDefault=function(){gq.wc.preventDefault.call(this);var a=this.Gb;a.preventDefault?a.preventDefault():a.returnValue=!1};var iq="closure_listenable_"+(1E6*Math.random()|0);var jq=0;function kq(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.handler=e;this.key=++jq;this.dc=this.hc=!1}function lq(a){a.dc=!0;a.listener=null;a.proxy=null;a.src=null;a.handler=null};function mq(a){this.src=a;this.listeners={};this.Ob=0}mq.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.listeners[f];a||(a=this.listeners[f]=[],this.Ob++);var g=nq(a,b,d,e);-1<g?(b=a[g],c||(b.hc=!1)):(b=new kq(b,this.src,f,!!d,e),b.hc=c,a.push(b));return b};
mq.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.listeners))return!1;var e=this.listeners[a];b=nq(e,b,c,d);return-1<b?(lq(e[b]),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.listeners[a],this.Ob--),!0):!1};mq.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.listeners)if(!a||c==a){for(var d=this.listeners[c],e=0;e<d.length;e++)++b,lq(d[e]);delete this.listeners[c];this.Ob--}return b};
function nq(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.dc&&f.listener==b&&f.capture==!!c&&f.handler==d)return e}return-1};var oq="closure_lm_"+(1E6*Math.random()|0),pq={},qq=0;function rq(a,b,c,d,e){if(d&&d.once)sq(a,b,c,d,e);else if(Array.isArray(b))for(var f=0;f<b.length;f++)rq(a,b[f],c,d,e);else c=tq(c),a&&a[iq]?a.Md(b,c,ca(d)?!!d.capture:!!d,e):uq(a,b,c,!1,d,e)}
function uq(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=ca(e)?!!e.capture:!!e,k=vq(a);k||(a[oq]=k=new mq(a));c=k.add(b,c,d,g,f);if(!c.proxy){d=wq();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)fq||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(xq(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");qq++}}
function wq(){function a(c){return b.call(a.src,a.listener,c)}const b=yq;return a}function sq(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)sq(a,b[f],c,d,e);else c=tq(c),a&&a[iq]?a.Nd(b,c,ca(d)?!!d.capture:!!d,e):uq(a,b,c,!0,d,e)}function xq(a){return a in pq?pq[a]:pq[a]="on"+a}
function yq(a,b){if(a.dc)a=!0;else{b=new gq(b,this);var c=a.listener,d=a.handler||a.src;if(a.hc&&"number"!==typeof a&&a&&!a.dc){var e=a.src;if(e&&e[iq])e.Od(a);else{var f=a.type,g=a.proxy;e.removeEventListener?e.removeEventListener(f,g,a.capture):e.detachEvent?e.detachEvent(xq(f),g):e.addListener&&e.removeListener&&e.removeListener(g);qq--;if(f=vq(e)){g=a.type;var k;if(k=g in f.listeners){k=f.listeners[g];const l=va(k,a);let p;(p=0<=l)&&Array.prototype.splice.call(k,l,1);k=p}k&&(lq(a),0==f.listeners[g].length&&
(delete f.listeners[g],f.Ob--));0==f.Ob&&(f.src=null,e[oq]=null)}else lq(a)}}a=c.call(d,b)}return a}function vq(a){a=a[oq];return a instanceof mq?a:null}var zq="__closure_events_fn_"+(1E9*Math.random()>>>0);function tq(a){if("function"===typeof a)return a;a[zq]||(a[zq]=function(b){return a.handleEvent(b)});return a[zq]};var Ue=Te.m(kg,md);function Aq(a){return null!=a?a.A&32768||n===a.Bc?!0:a.A?!1:v(Cb,a):v(Cb,a)}function Bq(a,b){Io(a,b)}function Cq(a,b){return setTimeout(a,b)}function Dq(a){return null!=a&&n===a.cc?[u(Cc.m?Cc.m(yo,a):Cc.call(null,yo,a))?"ra":u(Cc.m?Cc.m(Eo,a):Cc.call(null,Eo,a))?"rc":u(Cc.m?Cc.m(Ko,a):Cc.call(null,Ko,a))?"rx":u(Cc.m?Cc.m(Co,a):Cc.call(null,Co,a))?"tr":"other",y.j(Ac(a))].join(""):null};var Eq=zo.j(He);var Fq=Ze(new r(null,6,[km,console.log.bind(console),Dl,console.warn.bind(console),Uj,console.error.bind(console),Dk,console.debug.bind(console),ck,u(console.group)?console.group.bind(console):console.log.bind(console),Ki,u(console.groupEnd)?console.groupEnd.bind(console):function(){return Lc}],null)),Gq=function Gq(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Gq.v(arguments[0],c)};
Gq.v=function(a,b){var c=A(Fq);a=a.j?a.j(c):a.call(null,c);return Ce(a,b)};Gq.D=1;Gq.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};function Hq(a){return Fd(a)?H(a):Gq.v(Uj,O(["re-frame: expected a vector, but got:",a]))};var Iq=Ze(new r(null,2,[Zk,!1,vn,Ue],null));var Jq=function(){return af.m(Iq,function(a){return R.o(a,Zk,!0)})};try{rq(self,"load",Jq)}catch(a){};var Kq=Ze(He);function Lq(a,b){return B(B(A(Kq),a),b)}function Mq(a,b,c){af.I(Kq,uf,new T(null,2,5,U,[a,b],null),c);return c}var Nq=function Nq(a){switch(arguments.length){case 0:return Nq.H();case 1:return Nq.j(arguments[0]);case 2:return Nq.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};Nq.H=function(){return $e(Kq,He)};Nq.j=function(a){return af.o(Kq,rd,a)};
Nq.m=function(a,b){return u(Lq(a,b))?af.v(Kq,vf,new T(null,1,5,U,[a],null),rd,O([b])):Gq.v(Dl,O(["re-frame: can't clear",y.j(a),"handler for",[y.j(b),". Handler not found."].join("")]))};Nq.D=2;var Oq=function Oq(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=0<c.length?new G(c.slice(0),0,null):null;return Oq.v(c)};Oq.v=function(a){var b=S(a);a=B(b,Gk);var c=B(b,Om);b=B(b,Mj);return new r(null,3,[Gk,u(a)?a:tn,Om,c,Mj,b],null)};Oq.D=0;Oq.F=function(a){return this.v(D(a))};function Pq(a,b){return tf(a,new T(null,2,5,U,[Ek,b],null))}function Qq(a,b,c){return uf(a,new T(null,2,5,U,[Ek,b],null),c)}
function Rq(a,b){for(var c=a;;){var d=dk.j(c);if(zd(d))return c;a=xd(d);var e=hj.j(c);c=R.v(c,dk,null==d?null:zb(d),O([hj,ld.m(e,a)]));a=B(a,b);c=u(a)?a.j?a.j(c):a.call(null,c):c}}function Sq(a,b){return wf.I(a,dk,Se(),b)};var Tq=null;function Uq(a){var b=Hq(a);b=Lq(tk,b);if(u(b))if(u(Tq))Gq.v(Uj,O(["re-frame: while handling",Tq,", dispatch-sync was called for",a,". You can't call dispatch-sync within an event handler."]));else{var c=Tq;Tq=a;try{var d=Sq(Qq(Qq(He,tk,a),uj,a),b);var e=Rq(d,Om);var f=Sq(rd.m(e,dk),hj.j(e));Rq(f,Mj)}finally{Tq=c}}};var Vq=Ze(He);function Wq(a,b,c){var d=new T(null,2,5,U,[a,b],null);Bq(c,function(){return af.m(Vq,function(e){return Nd(e,d)&&c===B(e,d)?rd.m(e,d):e})});af.m(Vq,function(e){return R.o(e,d,c)});return c}function Xq(a,b){return B(A(Vq),new T(null,2,5,U,[a,b],null))}var Yq=function Yq(a){switch(arguments.length){case 1:return Yq.j(arguments[0]);case 2:return Yq.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};
Yq.j=function(a){var b=Xq(a,md);if(u(b))return b;var c=Hq(a);b=Lq(yn,c);return null==b?Gq.v(Uj,O([["re-frame: no subscription handler registered for: ",y.j(c),". Returning a nil subscription."].join("")])):Wq(a,md,b.m?b.m(Eq,a):b.call(null,Eq,a))};
Yq.m=function(a,b){var c=Xq(a,b);if(u(c))return c;c=Hq(a);var d=Lq(yn,c);if(null==d)return Gq.v(Uj,O([["re-frame: no subscription handler registered for: ",y.j(c),". Returning a nil subscription."].join("")]));var e=Bo(function(){return rf(Xc,b)});var f=Bo(function(){var g=A(e);return d.o?d.o(Eq,a,g):d.call(null,Eq,a,g)});return Wq(a,b,Bo(function(){return A(A(f))}))};Yq.D=2;
function Zq(a){return Te.o(od(a),ef.j(function(b){var c=Q(b,0,null);b=Q(b,1,null);return new T(null,2,5,U,[c,Xc.j?Xc.j(b):Xc.call(null,b)],null)}),a)}function $q(a,b){var c=Cd(a)?ef.m(Xc,a):Dd(a)?Zq(a):Aq(a)?Xc.j?Xc.j(a):Xc.call(null,a):Lc;Cd(a)?ef.m(Xc,a):Dd(a)?Zq(a):Aq(a)?A(a):Gq.v(Uj,O(["re-frame: in the reg-sub for",b,", the input-signals function returns:",a]));return c}
var ar=function ar(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return ar.v(arguments[0],c)};
ar.v=function(a,b){var c=["re-frame: reg-sub for ",y.j(a),", "].join(""),d=function(){var k=jf(b),l=Q(k,0,null),p=Q(k,1,null);if(J.m(1,M(k))||sd(l)||Fd(l))return new T(null,2,5,U,[qh(b),kd(b)],null);k=hf(b);switch(l instanceof C?l.va:null){case "-\x3e":return new T(null,2,5,U,[k,function(q){return p.j?p.j(q):p.call(null,q)}],null);case "\x3d\x3e":return new T(null,2,5,U,[k,function(q,t){t=D(t);H(t);t=I(t);return De(p,q,t)}],null);default:return Gq.v(Uj,O([c,"expected :-\x3e or :\x3d\x3e as second to last argument, got:",
l]))}}(),e=Q(d,0,null),f=Q(d,1,null),g=function(){switch(M(e)){case 0:return function(){var t=null;t=function(w,z){switch(arguments.length){case 1:return Eq;case 2:return Eq}throw Error("Invalid arity: "+arguments.length);};t.j=function(){return Eq};t.m=function(){return Eq};return t}();case 1:var k=H(e);sd(k)||Gq.v(Uj,O([c,"2nd argument expected to be an inputs function, got:",k]));return k;case 2:k=Q(e,0,null);var l=Q(e,1,null);J.m($m,k)||Gq.v(Uj,O([c,"expected :\x3c-, got:",k]));return function(){function t(){return Yq.j(l)}
function w(){return Yq.j(l)}var z=null;z=function(E,F){switch(arguments.length){case 1:return w.call(this,E);case 2:return t.call(this,E,F)}throw Error("Invalid arity: "+arguments.length);};z.j=w;z.m=t;return z}();default:k=sf(2,2,e);var p=ef.m(H,k),q=ef.m(jd,k);Oe(new lh(null,new r(null,1,[$m,null],null),null),p)&&Oe(Fd,q)||Gq.v(Uj,O([c,"expected pairs of :\x3c- and vectors, got:",k]));return function(){function t(){return ef.m(Yq,q)}function w(){return ef.m(Yq,q)}var z=null;z=function(E,F){switch(arguments.length){case 1:return w.call(this,
E);case 2:return t.call(this,E,F)}throw Error("Invalid arity: "+arguments.length);};z.j=w;z.m=t;return z}()}}();return Mq(yn,a,function(){function k(q,t,w){var z=g.m?g.m(t,w):g.call(null,t,w);q=Ze(null);var E=Bo(function(){var F=$q(z,a);return f.o?f.o(F,t,w):f.call(null,F,t,w)});$e(q,Dq(E));return E}function l(q,t){var w=g.m?g.m(t,null):g.call(null,t,null);q=Ze(null);var z=Bo(function(){var E=$q(w,a);return f.m?f.m(E,t):f.call(null,E,t)});$e(q,Dq(z));return z}var p=null;p=function(q,t,w){switch(arguments.length){case 2:return l.call(this,
q,t);case 3:return k.call(this,q,t,w)}throw Error("Invalid arity: "+arguments.length);};p.m=l;p.o=k;return p}())};ar.D=1;ar.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};var br=new r(null,2,[wm,function(a){function b(){return dq.j?dq.j(a):dq.call(null,a)}return Tp.j?Tp.j(b):Tp.call(null,b)},Im,dq],null);function cr(a){for(var b=M(a.queue);;){if(0===b)return dr(a,cl,null);var c=Pe(br,tg(wd(xd(a.queue))));if(u(c))return dr(a,Li,c);er(a);--b}}function fr(a){function b(){return dr(a,Xl,null)}return dq.j?dq.j(b):dq.call(null,b)}
function dr(a,b,c){var d=function(){var f=new T(null,2,5,U,[a.ac,b],null);if(J.m(new T(null,2,5,U,[Ei,Wm],null),f))return new T(null,2,5,U,[Ak,function(){a.queue=ld.m(a.queue,c);return fr(a)}],null);if(J.m(new T(null,2,5,U,[Bl,Ym],null),f))return new T(null,2,5,U,[Ei,function(){a.queue=Ue;throw c;}],null);if(J.m(new T(null,2,5,U,[Bl,cl],null),f))return zd(a.queue)?new T(null,1,5,U,[Ei],null):new T(null,2,5,U,[Ak,function(){return fr(a)}],null);if(J.m(new T(null,2,5,U,[Bl,Li],null),f))return new T(null,
2,5,U,[jj,function(){return gr(a,c)}],null);if(J.m(new T(null,2,5,U,[jj,Am],null),f))return new T(null,2,5,U,[Bl,function(){er(a);return cr(a)}],null);if(J.m(new T(null,2,5,U,[Ak,Xl],null),f))return new T(null,2,5,U,[Bl,function(){return cr(a)}],null);if(J.m(new T(null,2,5,U,[jj,Wm],null),f))return new T(null,2,5,U,[jj,function(){return a.queue=ld.m(a.queue,c)}],null);if(J.m(new T(null,2,5,U,[Bl,Wm],null),f))return new T(null,2,5,U,[Bl,function(){return a.queue=ld.m(a.queue,c)}],null);if(J.m(new T(null,
2,5,U,[Ak,Wm],null),f))return new T(null,2,5,U,[Ak,function(){return a.queue=ld.m(a.queue,c)}],null);throw ki(["re-frame: router state transition not found. ",y.j(a.ac)," ",y.j(b)].join(""),new r(null,2,[nn,a.ac,nm,b],null));}();var e=Q(d,0,null);d=Q(d,1,null);a.ac=e;return u(d)?d.H?d.H():d.call(null):null}function gr(a,b){function c(){return dr(a,Am,null)}return b.j?b.j(c):b.call(null,c)}
function er(a){var b=xd(a.queue);try{Uq(b);var c=a.queue;var d=null==c?null:zb(c);a.queue=d;hr(a,b)}catch(e){dr(a,Ym,e)}}function hr(a,b){for(var c=D(ug(a.vd)),d=null,e=0,f=0;;)if(f<e){var g=d.M(null,f);g.m?g.m(b,a.queue):g.call(null,b,a.queue);f+=1}else if(c=D(c))d=c,Gd(d)?(c=ec(d),e=fc(d),d=c,g=M(c),c=e,e=g):(g=H(d),g.m?g.m(b,a.queue):g.call(null,b,a.queue),c=I(d),d=null,e=0),f=0;else break}var ir=new function(a,b,c){this.ac=a;this.queue=b;this.vd=c}(Ei,Ue,He);
function jr(a){if(null==a)throw new ji('re-frame: you called "dispatch" without an event vector.',He);dr(ir,Wm,a);return null};var kr=Oq.v(O([Gk,yj,Mj,function(a){var b=Sm.j(a);a=rd.m(b,kj);b=kj.j(b);if(u(b)){var c=Lq(li,kj);c.j?c.j(b):c.call(null,b)}c=D(a);for(var d=null,e=0,f=0;;)if(f<e){a=d.M(null,f);b=Q(a,0,null);a=Q(a,1,null);var g=Lq(li,b);u(g)?(b=g,b.j?b.j(a):b.call(null,a)):Gq.v(Dl,O(["re-frame: no handler registered for effect:",b,". Ignoring."]));f+=1}else if(a=D(c))c=a,Gd(c)?(b=ec(c),c=fc(c),a=b,b=M(b),d=a,e=b):(a=H(c),b=Q(a,0,null),a=Q(a,1,null),d=Lq(li,b),u(d)?(b=d,b.j?b.j(a):b.call(null,a)):Gq.v(Dl,O(["re-frame: no handler registered for effect:",
b,". Ignoring."])),c=I(c),d=null,e=0),f=0;else return null}]));function lr(a){a=S(a);var b=B(a,ek),c=B(a,Gi);return zd(c)||"number"!==typeof b?Gq.v(Uj,O(["re-frame: ignoring bad :dispatch-later value:",a])):Cq(function(){return jr(c)},b)}Mq(li,vk,function(a){if(Dd(a))return lr(a);a=D(of(Ia,a));for(var b=null,c=0,d=0;;)if(d<c){var e=b.M(null,d);lr(e);d+=1}else if(a=D(a))b=a,Gd(b)?(a=ec(b),c=fc(b),b=a,e=M(a),a=c,c=e):(e=H(b),lr(e),a=I(b),b=null,c=0),d=0;else return null});
Mq(li,li,function(a){if(Cd(a)){a=D(of(Ia,a));for(var b=null,c=0,d=0;;)if(d<c){var e=b.M(null,d),f=Q(e,0,null);e=Q(e,1,null);J.m(kj,f)&&Gq.v(Dl,O(['re-frame: ":fx" effect should not contain a :db effect']));var g=Lq(li,f);u(g)?(f=g,f.j?f.j(e):f.call(null,e)):Gq.v(Dl,O(['re-frame: in ":fx" effect found ',f," which has no associated handler. Ignoring."]));d+=1}else if(a=D(a))Gd(a)?(e=ec(a),a=fc(a),f=e,e=M(e),b=f,c=e):(e=H(a),f=Q(e,0,null),e=Q(e,1,null),J.m(kj,f)&&Gq.v(Dl,O(['re-frame: ":fx" effect should not contain a :db effect'])),
b=Lq(li,f),u(b)?(f=b,f.j?f.j(e):f.call(null,e)):Gq.v(Dl,O(['re-frame: in ":fx" effect found ',f," which has no associated handler. Ignoring."])),a=I(a),b=null,c=0),d=0;else return null}else return Gq.v(Dl,O(['re-frame: ":fx" effect expects a seq, but was given ',Ma(a)]))});Mq(li,Gi,function(a){return Fd(a)?jr(a):Gq.v(Uj,O(["re-frame: ignoring bad :dispatch value. Expected a vector, but got:",a]))});
Mq(li,Gj,function(a){if(Cd(a)){a=D(of(Ia,a));for(var b=null,c=0,d=0;;)if(d<c){var e=b.M(null,d);jr(e);d+=1}else if(a=D(a))b=a,Gd(b)?(a=ec(b),c=fc(b),b=a,e=M(a),a=c,c=e):(e=H(b),jr(e),a=I(b),b=null,c=0),d=0;else return null}else return Gq.v(Uj,O(["re-frame: ignoring bad :dispatch-n value. Expected a collection, but got:",a]))});
Mq(li,xi,function(a){var b=Re.m(Nq,tk);if(Cd(a)){a=D(a);for(var c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e);b(f);e+=1}else if(a=D(a))c=a,Gd(c)?(a=ec(c),d=fc(c),c=a,f=M(a),a=d,d=f):(f=H(c),b(f),a=I(c),c=null,d=0),e=0;else return null}else return b(a)});Mq(li,kj,function(a){return A(Eq)!==a?$e(Eq,a):null});Mq(Zl,kj,function(a){return R.o(a,kj,A(Eq))});var mr=function(a){return Oq.v(O([Gk,Ek,Om,function(b){var c=Lq(Zl,a);return u(c)?wf.o(b,Ek,c):Gq.v(Uj,O(["No cofx handler registered for",a]))}]))}(kj);function nr(a,b){return J.m(a,b)?new T(null,3,5,U,[null,null,a],null):new T(null,3,5,U,[a,b,null],null)}function or(a){return D(a)?Sa(function(b,c){var d=Q(c,0,null);c=Q(c,1,null);return R.o(b,d,c)},Wf(lf(Ce(ce,tg(a)),null)),a):null}function pr(a,b,c){var d=B(a,c),e=B(b,c),f=qr(d,e),g=Q(f,0,null),k=Q(f,1,null);f=Q(f,2,null);a=Nd(a,c);b=Nd(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new T(null,3,5,U,[!a||null==g&&d?null:qd([c,g]),!b||null==k&&d?null:qd([c,k]),d?qd([c,f]):null],null)}
var rr=function rr(a){switch(arguments.length){case 2:return rr.m(arguments[0],arguments[1]);case 3:return rr.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};rr.m=function(a,b){return rr.o(a,b,no(tg(a),tg(b)))};rr.o=function(a,b,c){return Sa(function(d,e){return Ah(ef.o(hh,d,e))},new T(null,3,5,U,[null,null,null],null),ef.m(Re.o(pr,a,b),c))};rr.D=3;
function sr(a,b){var c=ef.m,d=rr.o,e=Fd(a)?a:Wf(a),f=Fd(b)?b:Wf(b);a=M(a);b=M(b);return Wf(c.call(ef,or,d.call(rr,e,f,zh(0,a>b?a:b))))}function tr(a,b){return new T(null,3,5,U,[Je(po.m(a,b)),Je(po.m(b,a)),Je(oo.m(a,b))],null)}function ur(a){if(null!=a&&null!=a.pd)a=a.pd(a);else{var b=ur[m(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=ur._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw x("EqualityPartition.equality-partition",a);}return a}
function vr(a,b){if(null!=a&&null!=a.od)a=a.od(a,b);else{var c=vr[m(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=vr._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw x("Diff.diff-similar",a);}return a}ur["null"]=function(){return Fk};ur.string=function(){return Fk};ur.number=function(){return Fk};ur.array=function(){return hk};ur["function"]=function(){return Fk};ur["boolean"]=function(){return Fk};
ur._=function(a){return(null!=a?a.A&1024||n===a.cd||(a.A?0:v(sb,a)):v(sb,a))?zj:(null!=a?a.A&4096||n===a.jd||(a.A?0:v(wb,a)):v(wb,a))?Kk:(null!=a?a.A&16777216||n===a.oc||(a.A?0:v(Qb,a)):v(Qb,a))?hk:Fk};vr["null"]=function(a,b){return nr(a,b)};vr.string=function(a,b){return nr(a,b)};vr.number=function(a,b){return nr(a,b)};vr.array=function(a,b){return sr(a,b)};vr["function"]=function(a,b){return nr(a,b)};vr["boolean"]=function(a,b){return nr(a,b)};
vr._=function(a,b){var c=function(){var d=ur(a);d=d instanceof C?d.va:null;switch(d){case "atom":return nr;case "set":return tr;case "sequential":return sr;case "map":return rr;default:throw Error(["No matching clause: ",y.j(d)].join(""));}}();return c.m?c.m(a,b):c.call(null,a,b)};function qr(a,b){return J.m(a,b)?new T(null,3,5,U,[null,null,a],null):J.m(ur(a),ur(b))?vr(a,b):nr(a,b)};Oq.v(O([Gk,Dk,Om,function(a){Gq.v(km,O(["Handling re-frame event:",Pq(a,tk)]));return a},Mj,function(a){var b=Pq(a,tk),c=Pq(a,kj);a:{var d=Id;for(var e=a,f=D(new T(null,2,5,U,[Sm,kj],null));;)if(null!=f){e=Gc(e,H(f),d);if(d===e){d=Hk;break a}f=I(f)}else{d=e;break a}}J.m(d,Hk)?Gq.v(km,O(["No app-db changes in:",b])):(d=qr(c,d),c=Q(d,0,null),d=Q(d,1,null),null!=c||null!=d?(Gq.v(ck,O(["db clojure.data/diff for:",b])),Gq.v(km,O(["only before:",c])),Gq.v(km,O(["only after :",d])),Gq(Ki)):Gq.v(km,O(["No app-db changes resulted from:",
b])));return a}]));Oq.v(O([Gk,lj,Om,function(a){var b=Pq(a,tk);Q(b,0,null);var c=Q(b,1,null);if(J.m(2,M(b))&&Dd(c))return Qq(a,tk,c);Gq.v(Dl,O(['re-frame: "unwrap" interceptor requires event to be a 2-vector of [event-id payload-map]. Got ',b]));return a},Mj,function(a){return Qq(a,tk,Pq(a,uj))}]));
Oq.v(O([Gk,qi,Om,function(a){if(Fd(Pq(a,tk)))return Fe(vf,a,new T(null,2,5,U,[Ek,tk],null),dg,O([1]));Gq.v(Dl,O(['re-frame: "trim-v" interceptor expected event to be a vector. Got a ',Ma(Pq(a,tk))]));return a},Mj,function(a){return Qq(a,tk,Pq(a,uj))}]));function wr(a){return Oq.v(O([Gk,Ml,Om,function(b){var c=Ek.j(b),d=S(c);c=B(d,kj);d=B(d,tk);c=a.m?a.m(c,d):a.call(null,c,d);return uf(b,new T(null,2,5,U,[Sm,kj],null),c)}]))}
function xr(a){return Oq.v(O([Gk,sk,Om,function(b){var c=Ek.j(b);c=S(c);var d=B(c,tk);return R.o(b,Sm,a.m?a.m(c,d):a.call(null,c,d))}]))}var yr=Oq.v(O([Gk,Jk,Om,function(a){return wf.o(a,dk,function(b){return Te.m(vn.j(A(Iq)),b)})}]));function zr(a){Uq(a);hr(ir,a)}var Ar=function Ar(a){switch(arguments.length){case 2:return Ar.m(arguments[0],arguments[1]);case 3:return Ar.o(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",y.j(arguments.length)].join(""));}};Ar.m=function(a,b){return Ar.o(a,null,b)};Ar.o=function(a,b,c){b=new T(null,5,5,U,[mr,kr,yr,b,wr(c)],null);return Mq(tk,a,of(Ia,qf(b)))};Ar.D=3;function Br(a,b){b=new T(null,5,5,U,[mr,kr,yr,null,xr(b)],null);Mq(tk,a,of(Ia,qf(b)))}
function Cr(a,b){De(ar,a,b)}function Dr(a){return Yq.j(a)};var Er=ch([Oi,mm,Sj,Km,bj,Tl,Pm,ui,Cl,Wi,om,Hj,xk,ni],[new r(null,4,[xl,"viewport",em,"#ffffff",wi,.5,wn,new T(null,3,5,U,[1.15,210,30],null)],null),15,null,null,!1,!1,45,Vk,He,!1,!1,1,md,new r(null,4,[Pk,"#f0f0f0",si,1,pj,"#cccccc",fn,"#f0f0f0"],null)]);var Fr=new T(null,2,5,U,[2.294481,48.8582],null);var Gr=Hn(10,{});var Hr=Hn(11,{});var Ir=Hn(19,{});Hn(20,{});var Jr=new r(null,3,[Cn,"raster-style",Rm,"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",Vk,"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"],null),Kr=new r(null,4,[Yj,8,Al,"OSM Bright",hn,new r(null,1,[zm,new r(null,4,[sn,"raster",cn,new T(null,1,5,U,["https://tile.openstreetmap.de/{z}/{x}/{y}.png"],null),ul,256,Ui," OpenStreetMap contributors"],null)],null),Lk,new T(null,1,5,U,[new r(null,5,[Gk,"osm-tiles",sn,"raster",uk,"osm",fm,0,Xk,19],null)],null)],null);
function Lr(){return Sj.j(A(Eq))}function Mr(a){var b=Lr();return u(b)&&(a=b.getLayer(a),u(a))?(a=a.minzoom,"number"===typeof a?a:null):null}function Nr(a,b,c){jr(new T(null,3,5,U,[Tj,b,c],null));u(a)&&(u(a.getLayer(b))||a.addLayer(c,null))}
function Or(a,b){var c=Cl.j(A(Eq));c=D(c);for(var d=null,e=0,f=0;;)if(f<e){var g=d.M(null,f),k=Q(g,0,null);Q(g,1,null);u(a.getLayer(k))&&a.removeLayer(k);f+=1}else if(c=D(c))Gd(c)?(e=ec(c),c=fc(c),d=e,e=M(e)):(d=H(c),e=Q(d,0,null),Q(d,1,null),u(a.getLayer(e))&&a.removeLayer(e),c=I(c),d=null,e=0),f=0;else break;jr(new T(null,1,5,U,[on],null));b=D(b);d=null;for(f=e=0;;)if(f<e)g=d.M(null,f),c=Q(g,0,null),g=Q(g,1,null),Nr(a,c,g),f+=1;else if(b=D(b))Gd(b)?(d=ec(b),b=fc(b),c=d,e=M(d),d=c):(d=H(b),c=Q(d,
0,null),g=Q(d,1,null),Nr(a,c,g),b=I(b),d=null,e=0),f=0;else break}function Pr(){Lr().removeLayer("3d-model-eiffel");jr(new T(null,2,5,U,[Ti,"3d-model-eiffel"],null))}function Qr(a){jr(new T(null,2,5,U,[gj,a],null));window.pearlMapInstance=a}function Rr(a,b){return J.m(b,"Glyphs")?{url:a,cache:"force-cache"}:{url:a}}
function Sr(a){var b=pa(window,"devicePixelRatio");var c=u(b)?b:1;b=Math.round(1024*c);console.log(["Calculated maxTileCacheSize: ",y.j(b)," (based on DPR: ",y.j(c),")"].join(""));c=ci(Fr);var d=-1!=y.j(pa(window,"navigator","userAgent")).indexOf("Firefox");b=ch([Mk,tj,zk,Xj,Tm,Nk,rk,Qk,Ql,Jj,mi],[b,15,!0,0,45,19,c,d?8:16,"map-container",0,Rr]);return J.m(a,"raster-style")?ci(R.o(b,Hi,Kr)):ci(R.o(b,Hi,a))}
function Tr(){if(u(document.getElementById("map-container"))){var a=Lr();if(u(a)){try{a.remove()}catch(c){if(c instanceof Error)console.warn("Error removing old map instance:",c);else throw c;}zr(new T(null,2,5,U,[gj,null],null))}a=ui.j(A(Eq));a=B(Jr,a);a=Sr(a);var b=new Hr.Map(a);b.on("styledataloading",function(){return jr(new T(null,2,5,U,[Xm,!0],null))});b.on("styledata",function(){return jr(new T(null,2,5,U,[Xm,!1],null))});b.on("move",function(){return jr(new T(null,2,5,U,[jl,b.getZoom()],null))});
b.once("load",function(){return jr(new T(null,2,5,U,[jk,b],null))});b.addControl(new Hr.NavigationControl);b.addControl(new Hr.ScaleControl);return b}return null}Br(jk,function(a,b){a=S(a);var c=B(a,kj);Q(b,0,null);var d=Q(b,1,null);Qr(d);b=Cl.j(c);D(b)&&Or(d,b);return new r(null,2,[Gj,function(){var e=id(new T(null,2,5,U,[Xm,!1],null),rf(function(f){return new T(null,3,5,U,[yl,f,d],null)},Gc(c,xk,md)));return Ie(ui.j(c),Cn)?ld.m(e,new T(null,1,5,U,[qk],null)):e}(),kj,R.o(c,xk,md)],null)});
Br(yl,function(a,b){Q(b,0,null);a=Q(b,1,null);b=Q(b,2,null);a.j?a.j(b):a.call(null,b);return He});Ar.m(jm,function(a,b){Q(b,0,null);b=Q(b,1,null);return wf.I(a,xk,ld,b)});function Ur(a){var b=Lr();return u(b)?u(b.loaded)?jr(new T(null,3,5,U,[yl,a,b],null)):jr(new T(null,2,5,U,[jm,a],null)):jr(new T(null,2,5,U,[jm,a],null))}function Vr(a){var b=Lr();u(b)&&b.on("error",function(c){return a.j?a.j(c):a.call(null,c)})}
function Wr(a){var b=Lr();u(b)&&b.flyTo({center:ci(Fr),zoom:a,pitch:45,bearing:0,essential:!0})}var Xr=function Xr(a){return"number"===typeof H(a)?new T(null,1,5,U,[a],null):mf(Xr,O([a]))};
function Yr(a,b){if(J.m(a,"3d-model-eiffel"))Wr(b);else{var c=Lr();if(u(c)){var d=c.getCenter();c.flyTo({center:d,zoom:b,essential:!0});c.once("moveend",function(){var e=Mr(a);a:{var f=Lr();if(u(f)&&(f=f.getLayer(a),u(f))){f=f.maxzoom;f="number"===typeof f?f:null;break a}f=null}f=(u(f)?f:22.1)-.1;f=17<f?17:f;e=u(e)?e:0;a:{e=f>e?f:e;f=Lr();if(u(f)){var g=f.queryRenderedFeatures({layers:[a]});if(D(g)){g=gi(H(g).geometry.coordinates);g=H(Xr(g));e=u(g)?f.flyTo({center:ci(g),zoom:e,essential:!0}):null;
break a}}e=null}return e})}}}function Zr(){var a=Lr();return u(a)?new r(null,5,[rk,a.getCenter(),tj,a.getZoom(),Tm,a.getPitch(),Xj,a.getBearing(),Lk,Cl.j(A(Eq))],null):null}var $r=function $r(a,b,c,d,e){if(zd(c))return e.H?e.H():e.call(null);var g=H(c),k=Kc(c);console.log(["Warming zoom level: ",y.j(g)].join(""));a.jumpTo({center:ci(b),zoom:g});return a.once("idle",function(){return $r.O?$r.O(a,b,k,d,e):$r.call(null,a,b,k,d,e)})};
function as(a){var b=Lr();if(u(b)){var c=b.getContainer(),d=c.style.visibility,e=Zr(),f=b.getMinZoom(),g=b.getMaxZoom(),k=zh(Math.ceil(f),Math.floor(g)+1);console.log(["Prewarming tiles for center ",y.j(Fr)," from zoom ",y.j(f)," to ",y.j(g)].join(""));c.style.visibility="hidden";return $r(b,Fr,k,e,function(){var l={};l.center=rk.j(e);l.zoom=tj.j(e);l.pitch=Tm.j(e);l.bearing=Xj.j(e);b.jumpTo(l);c.style.visibility=d;b.triggerRepaint();console.log("Prewarming complete. Restored original camera.");return u(a)?
a.H?a.H():a.call(null):null})}return null}function bs(a){var b=Lr();if(u(b)){var c=H(H(nf(function(f){Q(f,0,null);f=Q(f,1,null);return J.m(f,a)},Jr))),d=Cl.j(A(Eq)),e=J.m(a,"raster-style")?ci(Kr):a;zr(new T(null,2,5,U,[Xm,!0],null));zr(new T(null,2,5,U,[pi,c],null));b.setStyle(e);return b.once("styledata",function(){Or(b,d);Ie(a,"raster-style")&&jr(new T(null,1,5,U,[qk],null));return jr(new T(null,1,5,U,[dj],null))})}return null}function cs(a){var b=Lr();return u(b)?b.getLayer(a):null}
function ds(a,b){var c=Lr();return u(c)?u(c.getLayer(a))?c.getPaintProperty(a,b):null:null}function es(a,b){var c=Lr();return u(c)?u(c.getLayer(a))?c.getLayoutProperty(a,b):null:null}function fs(a){var b=Fd(a)&&"string"===typeof H(a)&&1<M(a);if(b)return b;if(b=Dd(a)){b=bk.j(a);if(u(b))return b;b=gm.j(a);return u(b)?b:sn.j(a)}return b}
function gs(a,b,c){var d=Lr();if(u(d)){var e=d.getLayer(a);if(u(e)){var f=d.getLayoutProperty(a,"visibility");e=e.type;Ie(f,"none")&&(c="string"===typeof c&&ma(null==c?"":String(c))?null:c,null==c?c=null:u(fs(c))?c=ci(c):(f=new lh(null,new r(null,6,["fill-color",null,"fill-extrusion-color",null,"line-color",null,"fill-outline-color",null,"text-color",null,"background-color",null],null),null),f=f.j?f.j(b):f.call(null,b),c=u(f)?J.m(c,"transparent")?"transparent":"string"===typeof c?c:"number"===typeof c?
["#",y.j(parseInt(y.j(c)).toString(16))].join(""):c:c),(Ie("fill-extrusion-color",b)||J.m("fill-extrusion",e))&&d.setPaintProperty(a,b,c))}}}function hs(a,b,c){var d=Lr();u(d)&&u(d.getLayer(a))&&(c=ci("string"===typeof c&&ma(null==c?"":String(c))?null:c),d.setLayoutProperty(a,b,c))}function is(a){return Ja(a)?"string"===typeof H(a)&&1<a.length:La(a)?null!=a.stops||null!=a.property||null!=a.type:!1}
function js(a,b,c){var d=M(a);if(0===d)return null;for(var e=0;;){if(e>=d)return jd(ed(a,d-1));var f=ed(a,e),g=Q(f,0,null);f=Q(f,1,null);if(b<=g){if(0===e)return f;a=ed(a,e-1);d=Q(a,0,null);a=Q(a,1,null);b=(b-d)/(g-a);c=J.m(c,1)?b:(Math.pow(c,b)-1)/(c-1);return"number"===typeof a&&"number"===typeof f?a+(f-a)*c:"string"===typeof a&&"string"===typeof f?Ir(a).mix(Ir(f),c).rgb():f}e+=1}}
function ks(a,b){if(Ja(a)&&3<=M(a)&&J.m("interpolate",a[0])&&Ja(a[2])&&J.m("zoom",a[2][0])){var c=gi(a);c=dg.m(c,3);c=sf(2,2,c);var d=b.zoom;return js(c,d,1)}if(u(function(){var f=a.stops;return u(f)?b.zoom:f}())){c=Wf(gi(a.stops));d=b.zoom;var e=function(){var f=a.base;return u(f)?f:1}();return js(c,d,e)}return u(a.value)?a.value:u(a.default)?a.default:a}
var ls=function ls(a,b){if(u(a)){if("string"===typeof a)return J.m(a,"transparent")?"transparent":u(a.startsWith("#"))?a:Ir(a).hex().toString().toLowerCase();if(is(a)){b=ks(a,{zoom:b});if("string"===typeof b)return b;if(La(b)&&sd(b.toString))return b.toString();throw Error(["Expression evaluated to non-string color: ",y.j(b)].join(""));}if("number"===typeof a)return["#",y.j(Math.floor(a).toString(16))].join("");if(La(a)){var d=a.default;u(d)?a=d:(d=a.value,a=u(d)?d:a.valueOf);return ls.m?ls.m(a,b):
ls.call(null,a,b)}throw Error(["Unexpected color value type: ",y.j(Ma(a))].join(""));}return null};
function ms(a,b){if(null==a)return null;if("number"===typeof a)return a;if(is(a)){a=ks(a,{zoom:b});if("number"===typeof a)return a;if("string"===typeof a)return a=parseFloat(a),u(isNaN(a))?null:a;throw Error(["Expression evaluated to non-numeric value: ",y.j(a)].join(""));}if("string"===typeof a)return a=parseFloat(a),u(isNaN(a))?null:a;if(La(a)){b=a.default;u(b)?a=b:(b=a.value,a=u(b)?b:a.valueOf);if("number"===typeof a)return a;if("string"===typeof a)return a=parseFloat(a),u(isNaN(a))?null:a}return null}
function ns(a,b,c,d){a=J.m(d,"layout")?es(a,b):ds(a,b);if(u(a)){var e=hi(a,O([ii,!0])),f=u(function(){var g=new lh(null,new r(null,6,["fill-color",null,"fill-extrusion-color",null,"line-color",null,"fill-outline-color",null,"text-color",null,"background-color",null],null),null);return g.j?g.j(b):g.call(null,b)}())?ls:ms;return u(function(){var g=Dd(e);return g?bk.j(e):g}())?Td(tj,be,rf(function(g){var k=Q(g,0,null);g=Q(g,1,null);return new r(null,2,[tj,k,wk,f.m?f.m(g,c):f.call(null,g,c)],null)},bk.j(e))):
Fd(e)&&4<=M(e)&&J.m("interpolate",H(e))&&J.m(new T(null,1,5,U,["zoom"],null),B(e,2))?(a=sf(2,2,dg.m(e,3)),Td(tj,be,rf(function(g){var k=Q(g,0,null);g=Q(g,1,null);return new r(null,2,[tj,k,wk,f.m?f.m(g,c):f.call(null,g,c)],null)},a))):new T(null,1,5,U,[new r(null,2,[tj,c,wk,f.m?f.m(a,c):f.call(null,a,c)],null)],null)}return null}
function os(a,b,c,d,e){var f=parseFloat(c),g=J.m(e,"layout")?es(a,b):ds(a,b),k=parseFloat(mm.j(A(Eq))),l=null!=g?hi(g,O([ii,!0])):null;is(g)?u(function(){var p=Dd(l);return p?bk.j(l):p}())?c=function(){var p=Wf(bk.j(l)),q=Pe(function(t){return J.m(parseFloat(H(t)),f)},p);q=u(q)?rf(function(t){var w=Q(t,0,null);t=Q(t,1,null);return J.m(parseFloat(w),f)?new T(null,2,5,U,[f,d],null):new T(null,2,5,U,[parseFloat(w),t],null)},p):Td(H,be,ld.m(rf(function(t){var w=Q(t,0,null);t=Q(t,1,null);return new T(null,
2,5,U,[parseFloat(w),t],null)},p),new T(null,2,5,U,[f,d],null)));p=new T(null,3,5,U,["interpolate",new T(null,1,5,U,["linear"],null),new T(null,1,5,U,["zoom"],null)],null);q=Sa(Te,md,q);p=Wf(ve.m(p,q));J.m(e,"layout")?hs(a,b,p):gs(a,b,p);return p}():Fd(l)&&4<=M(l)&&J.m("interpolate",H(l))&&J.m(new T(null,1,5,U,["zoom"],null),B(l,2))?c=function(){var p=dg.o(l,0,3),q=dg.m(l,3);q=sf(2,2,q);var t=Pe(function(w){return J.m(parseFloat(H(w)),f)},q);q=u(t)?rf(function(w){var z=Q(w,0,null);w=Q(w,1,null);return J.m(parseFloat(z),
f)?new T(null,2,5,U,[f,d],null):new T(null,2,5,U,[parseFloat(z),w],null)},q):Td(H,be,ld.m(rf(function(w){var z=Q(w,0,null);w=Q(w,1,null);return new T(null,2,5,U,[parseFloat(z),w],null)},q),new T(null,2,5,U,[f,d],null)));q=Sa(Te,md,q);p=Wf(ve.m(p,q));J.m(e,"layout")?hs(a,b,p):gs(a,b,p);return p}():(J.m(e,"layout")?hs(a,b,d):gs(a,b,d),c=d):Ie(f,k)&&null!=g?c=function(){var p=new T(null,7,5,U,["interpolate",new T(null,1,5,U,["linear"],null),new T(null,1,5,U,["zoom"],null),k,g,f,d],null);J.m(e,"layout")?
hs(a,b,p):gs(a,b,p);return p}():(J.m(e,"layout")?hs(a,b,d):gs(a,b,d),c=d);return c};Br(vm,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);var c=Q(b,1,null);b=Q(b,2,null);b=uf(a,Te.m(new T(null,1,5,U,[Oi],null),c),b);c=Oi.j(b);a=Sj.j(a);u(a)&&a.setLight(ci(c));return new r(null,2,[kj,b,Gi,new T(null,2,5,U,[xm,c],null)],null)});var ps=Hn(22,{});function qs(a,b,c){a.load("models/eiffel_tower/scene.gltf",function(d){return b.j?b.j(d):b.call(null,d)},null,function(d){return c.j?c.j(d):c.call(null,d)})};var rs=new T(null,3,5,U,[Math.PI/2,0,0],null);function ss(){var a=Hr.MercatorCoordinate.fromLngLat(ci(Fr),0),b=a.meterInMercatorCoordinateUnits();return{translateX:a.x,translateY:a.y,translateZ:a.z,rotateX:ed(rs,0),rotateY:ed(rs,1),rotateZ:ed(rs,2),scale:b}}function ts(){var a=new Gr.DirectionalLight(16777215);a.castShadow=!0;var b=a.shadow.camera;b.far=5E3;b.near=1;b=a.shadow.mapSize;b.width=2048;b.height=2048;b=new Gr.AmbientLight(16777215,.4);return new r(null,2,[$l,a,Qj,b],null)}
function us(a){var b=new Gr.Mesh(new Gr.PlaneGeometry(2E3,2E3),new Gr.ShadowMaterial({opacity:.3}));b.receiveShadow=!0;b.rotation.x=Math.PI/180*-90;a.add(b)}function vs(a){a.traverse(function(b){return u(b.isMesh)?(b.castShadow=!0,b.receiveShadow=!0,b):null})}
function ws(a,b){var c=ss(),d=new bf,e=Ze(null);return{id:"3d-model-eiffel",type:"custom",renderingMode:"3d",onAdd:function(f){var g=new Gr.Scene,k=new Gr.Camera,l=new ps.GLTFLoader,p=ts(),q=$l.j(p);g.add(q);g.add(Qj.j(p));us(g);qs(l,function(t){t=t.scene;var w=(new Gr.Box3).setFromObject(t).getSize(new Gr.Vector3),z=q.shadow.camera;var E=w.x;var F=w.y;E=E>F?E:F;w=w.z;w=.6*(E>w?E:w);z.left=-w;z.right=w;z.top=w;z.bottom=-w;z.near=.1;z.far=1E3;z.updateProjectionMatrix();vs(t);z=(new Gr.Box3).setFromObject(t).getSize(new Gr.Vector3).y;
z=0<z?330/z:1;g.add(t);t=A(d);u(t)&&(t.modelScaleFactor=z);return f.triggerRepaint()},function(t){return console.error("Failed to load Eiffel Tower model:",t)});jr(new T(null,2,5,U,[zn,a],null));jr(new T(null,2,5,U,[en,b],null));cf(d,{scene:g,camera:k,light:q,map:f,modelTransform:c,modelScaleFactor:1,renderer:null});k=Bo(function(){return new r(null,3,[yk,Hj.j(A(Eq)),Yl,Pm.j(A(Eq)),nj,Oi.j(A(Eq))],null)});$e(e,k);return Sh(k,function(){return f.triggerRepaint()})},onRemove:function(){var f=A(e);u(f)&&
Xb(f,Th);f=A(d);if(u(f)){var g=f.renderer;u(g)&&g.dispose();f.renderer=null;f.scene=null;f.camera=null}return jc(d,null)},render:function(f,g){var k=A(d);if(u(k)){var l=A(Eq),p=new r(null,2,[yk,Hj.j(l),Yl,Pm.j(l)*(Math.PI/180)],null);l=Oi.j(l);var q=k.light;if(u(u(l)?q:l)){q.color.set(new Gr.Color(em.j(l)));var t=q.position,w=t.copy,z=wn.j(l);var E=Q(z,0,null);var F=Q(z,1,null);z=Q(z,2,null);F*=Math.PI/180;z*=Math.PI/180;E=new Gr.Vector3(E*Math.sin(z)*Math.sin(F),E*Math.cos(z),E*-Math.sin(z)*Math.cos(F));
w.call(t,E);q.intensity=wi.j(l)}l=k.scene;q=k.camera;t=k.renderer;u(t)?f=t:(t=k.map.getCanvas(),f=new Gr.WebGLRenderer({canvas:t,context:f,antialias:!0}),f.autoClear=!1,t=f.shadowMap,t.enabled=!0,t.type=Gr.PCFSoftShadowMap,k.renderer=f);t=k.map;w=t.getCanvas();E=k.modelTransform;k=k.modelScaleFactor;k=u(k)?k:1;F=yk.j(p);k=E.scale*k*F;p=Yl.j(p);E=S(new r(null,3,[ti,k,Wl,p,zi,E],null));p=B(E,ti);k=B(E,Wl);E=B(E,zi);g=(new Gr.Matrix4).fromArray(g.defaultProjectionData.mainMatrix);F=(new Gr.Matrix4).makeRotationAxis(new Gr.Vector3(1,
0,0),E.rotateX);z=(new Gr.Matrix4).makeRotationAxis(new Gr.Vector3(0,1,0),E.rotateY);k=(new Gr.Matrix4).makeRotationAxis(new Gr.Vector3(0,0,1),E.rotateZ+k);p=(new Gr.Matrix4).makeTranslation(E.translateX,E.translateY,E.translateZ).scale(new Gr.Vector3(p,-p,p)).multiply(k).multiply(z).multiply(F);q.projectionMatrix=g.multiply(p);f.setSize(w.width,w.height,!1);f.resetState();f.render(l,q);return t.triggerRepaint()}return null}}};Ar.m(fk,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,Tl,b)});Br(zn,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);b=Q(b,1,null);return new r(null,1,[kj,R.o(a,Hj,b)],null)});Br(en,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);b=Q(b,1,null);return new r(null,1,[kj,R.o(a,Pm,b)],null)});
Br(An,function(a){a=S(a);a=B(a,kj);console.log("models-3d/add-eiffel-tower event dispatched.");var b=Hj.j(a),c=Pm.j(a);b=ws(b,c);u(cs("3d-model-eiffel"))&&Pr();b=ci(b);Nr(Lr(),"3d-model-eiffel",b);return new r(null,1,[kj,R.o(a,Tl,!0)],null)});Br(Hm,function(a){a=S(a);a=B(a,kj);Pr();return new r(null,1,[kj,R.o(a,Tl,!1)],null)});Br(El,function(){Wr(16);return He});Ar.m(bm,function(){return Er});Ar.m(gj,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,Sj,b)});Ar.m(Xm,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,bj,b)});Br(pi,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);b=Q(b,1,null);var c=Oi.j(Er),d=ni.j(Er);a=R.o(R.o(R.o(R.o(a,ui,b),Oi,c),ni,d),Km,null);return new r(null,1,[kj,a],null)});Ar.m(Tj,function(a,b){Q(b,0,null);var c=Q(b,1,null);b=Q(b,2,null);return wf.O(a,Cl,R,c,b)});Ar.m(Ti,function(a,b){Q(b,0,null);b=Q(b,1,null);return wf.I(a,Cl,rd,b)});
Ar.m(on,function(a){return R.o(a,Cl,He)});Ar.m(kl,function(a){return wf.o(a,om,Ka)});Ar.m(jl,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,mm,b)});Ar.m(Tk,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,Wi,b)});var xs=Ze(He);Mq(li,nk,function(a){var b=S(a);a=B(b,Y);var c=B(b,tk);b=B(b,oj);var d=B(A(xs),a);u(d)&&clearTimeout(d);b=setTimeout(function(){return jr(c)},u(b)?b:300);return af.I(xs,R,a,b)});
function ys(){var a=Tr();u(a)&&(Ur(function(b){var c=Oi.j(A(Eq));u(c)&&b.setLight(ci(c));jr(new T(null,1,5,U,[qk],null));jr(new T(null,1,5,U,[An],null));if(u(localStorage.getItem("pearl-map-prewarmed")))return null;jr(new T(null,2,5,U,[Tk,!0],null));console.log("Prewarming map tiles for the first time...");return as(function(){jr(new T(null,2,5,U,[Tk,!1],null));localStorage.setItem("pearl-map-prewarmed","true");return console.log("Tile prewarming complete.")})}),Vr(function(b){return console.error("Map loading error:",
b)}))};Cr(Sj,O([function(a){return Sj.j(a)}]));Cr(bj,O([function(a){return bj.j(a)}]));Cr(ui,O([function(a){return ui.j(a)}]));Cr(Cl,O([function(a){return Cl.j(a)}]));Cr(om,O([function(a){return om.j(a)}]));Cr(Oi,O([function(a){return Oi.j(a)}]));Cr(mm,O([function(a){return mm.j(a)}]));Cr(Wi,O([function(a){return Wi.j(a)}]));function zs(){return new T(null,2,5,U,[X,new r(null,2,[Gk,"map-container",Hi,new r(null,5,[Xi,"100%",Jm,"100vh",wn,"absolute",vj,0,ri,0],null)],null)],null)};var As=function As(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return As.v(arguments[0],c)};
As.v=function(a,b){var c=S(Dd(a)?a:He),d=B(c,gk),e=B(c,Hi),f=B(c,W);c=B(c,Yk);return new T(null,3,5,U,[rn,hh.v(O([new r(null,4,[gk,d,im,c,Hi,hh.v(O([new r(null,8,[qm,"5px",Qm,"8px 12px",zl,"none",Rj,"3px",Ij,"#007bff",em,"white",Sk,"pointer",Lm,"Arial, sans-serif"],null),Dd(a)?Hi.j(a):null,e])),W,f],null),Dd(a)?rd.v(a,Hi,O([W,Yk])):null])),b],null)};As.D=1;As.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
var Bs=function Bs(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Bs.v(arguments[0],c)};Bs.v=function(a,b){return new T(null,3,5,U,[As,wf.I(a,Hi,hh,new r(null,1,[Ij,"#007bff"],null)),b],null)};Bs.D=1;Bs.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
var Cs=function Cs(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Cs.v(arguments[0],c)};Cs.v=function(a,b){return new T(null,3,5,U,[As,wf.I(a,Hi,hh,new r(null,1,[Ij,"#6c757d"],null)),b],null)};Cs.D=1;Cs.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
var Ds=function Ds(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Ds.v(arguments[0],c)};Ds.v=function(a,b){return new T(null,3,5,U,[As,wf.I(a,Hi,hh,new r(null,1,[Ij,"#dc3545"],null)),b],null)};Ds.D=1;Ds.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
var Es=function Es(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Es.v(arguments[0],c)};Es.v=function(a,b){return new T(null,3,5,U,[As,wf.I(a,Hi,hh,new r(null,1,[Ij,"#343a40"],null)),b],null)};Es.D=1;Es.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
var Fs=function Fs(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Fs.v(arguments[0],c)};Fs.v=function(a,b){return new T(null,3,5,U,[As,wf.I(a,Hi,hh,new r(null,2,[Ij,"#f8f9fa",em,"black"],null)),b],null)};Fs.D=1;Fs.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};function Gs(a,b){return function(){function c(e,f){var g=null;if(1<arguments.length){g=0;for(var k=Array(arguments.length-1);g<k.length;)k[g]=arguments[g+1],++g;g=new G(k,0,null)}return d.call(this,e,g)}function d(e,f){e=Dd(e)?e:He;var g=y.j(a),k=y,l=k.j,p=W.j(e);g=[g," ",l.call(k,u(p)?p:"")].join("");return Te.m(new T(null,2,5,U,[X,R.o(De(rd,e,b),W,g)],null),f)}c.D=1;c.F=function(e){var f=H(e);e=Kc(e);return d(f,e)};c.v=d;return c}()}
var Hs=Gs("flex-container",new T(null,6,5,U,[pl,sl,ll,Gm,xj,Hi],null)),Is=Gs("card",new T(null,6,5,U,[Qm,Ij,Rj,hl,Hi,Xi],null));function Js(a){a=B(Jr,a);return bs(a)}
function Ks(){var a=A(Dr(new T(null,1,5,U,[ui],null)));a=B(Jr,a);var b=A(Dr(new T(null,1,5,U,[om],null))),c=A(Dr(new T(null,1,5,U,[Sj],null)));return new T(null,4,5,U,[Is,new r(null,1,[W,"style-controls-card"],null),new T(null,4,5,U,[X,new r(null,2,[Y,"header-section",W,"style-controls-header"],null),new T(null,5,5,U,[X,new r(null,2,[Y,"title-section",W,"style-controls-title-section"],null),new T(null,3,5,U,[Yi,new r(null,2,[Y,"title",W,"style-controls-title"],null),"Pearl Map - Paris 3D"],null),
new T(null,3,5,U,[dl,new r(null,2,[Y,"subtitle",W,"style-controls-subtitle"],null),"Centered at Eiffel Tower"],null),new T(null,3,5,U,[dl,new r(null,2,[Y,"coordinates",W,"style-controls-coords"],null),"(2.2945E, 48.8584N)"],null)],null),new T(null,4,5,U,[X,new r(null,2,[Y,"style-section",W,"style-controls-style-section"],null),new T(null,3,5,U,[aj,new r(null,2,[Y,"style-title",W,"style-controls-style-title"],null),"Map Style"],null),new T(null,6,5,U,[Hs,new r(null,4,[Y,"button-row",Gm,"5px",xj,
"wrap",sl,"center"],null),new T(null,3,5,U,[Bs,new r(null,3,[Y,"basic-style",gk,function(){return Js(Cn)},Yk,null==c],null),"Basic"],null),new T(null,3,5,U,[Es,new r(null,3,[Y,"dark-style",gk,function(){return Js(Rm)},Yk,null==c],null),"Dark"],null),new T(null,3,5,U,[Fs,new r(null,3,[Y,"light-style",gk,function(){return Js(Vk)},Yk,null==c],null),"Light"],null),new T(null,3,5,U,[Ds,new r(null,3,[Y,"toggle-button",gk,function(){return jr(new T(null,1,5,U,[kl],null))},W,"style-controls-toggle-button"],
null),u(b)?"Hide":"Show"],null)],null)],null)],null),new T(null,3,5,U,[Hs,new r(null,2,[Y,"current-style",W,"style-controls-current-style"],null),new T(null,4,5,U,[pn,new r(null,2,[Y,"current-style-text",W,"style-controls-current-style-text"],null),"Current: ",y.j(a)],null)],null)],null)};function Ls(a){a=Math.round(a).toString(16);return J.m(M(a),1)?["0",y.j(a)].join(""):a}
function Ms(a){if(u(a))if("string"===typeof a){if(u(a.startsWith("#")))return a;if(u(a.startsWith("rgb"))){var b=Bh(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/,a);Q(b,0,null);var c=Q(b,1,null);var d=Q(b,2,null),e=Q(b,3,null);b=Q(b,4,null);c=u(c)?new T(null,4,5,U,[parseInt(c),parseInt(d),parseInt(e),u(b)?parseFloat(b):1],null):null}else c=null;if(u(c))return["#",y.j(Ls(ed(c,0))),y.j(Ls(ed(c,1))),y.j(Ls(ed(c,2)))].join("");try{return Ir(a).hex().toString().toLowerCase()}catch(f){if(f instanceof
Error)return null;throw f;}}else{if(Fd(a)){if(J.m(M(a),4))return["#",y.j(Ls(ed(a,0))),y.j(Ls(ed(a,1))),y.j(Ls(ed(a,2)))].join("");throw Error(["Invalid RGBA vector length: ",y.j(M(a))].join(""));}if(La(a))throw Error(["Complex color expressions not supported in rgba-to-hex: ",y.j(JSON.stringify(a))].join(""));throw Error(["Invalid color value type: ",y.j(Ma(a))].join(""));}else return null}
function Ns(a){if("string"===typeof a){var b=Bh(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/,a);if(u(b)){Q(b,0,null);a=Q(b,1,null);var c=Q(b,2,null),d=Q(b,3,null);b=Q(b,4,null);return new T(null,4,5,U,[parseInt(a),parseInt(c),parseInt(d),u(b)?parseFloat(b):1],null)}}return null};var Os=new T(null,12,5,U,[Pk,si,pj,fn,jn,Nl,qj,ak,Ll,yi,Zj,hm],null),Ps=new T(null,9,5,U,[Ci,Ii,Il,oi,pm,Rl,dn,Sl,Pj],null),sh=Wf(ve.m(Os,Ps)),Qs=new lh(null,new r(null,6,[Pk,null,Nl,null,Zj,null,Ll,null,pj,null,fn,null],null),null),Rs=new lh(null,new r(null,5,[hm,null,yi,null,qj,null,jn,null,si,null],null),null),Ss=new lh(null,new r(null,1,[ak,null],null),null),Ts=new r(null,5,[Fi,new r(null,3,[Fl,"Transportation",Bn,"road_pri_fill_noramp",Lk,Vf("aeroway-runway aeroway-taxiway tunnel_path tunnel_service_case tunnel_service_fill tunnel_minor_case tunnel_minor_fill tunnel_sec_case tunnel_sec_fill tunnel_pri_case tunnel_pri_fill tunnel_trunk_case tunnel_trunk_fill tunnel_mot_case tunnel_mot_fill tunnel_rail tunnel_rail_dash road_path road_service_case road_service_fill road_minor_case road_minor_fill road_sec_case_noramp road_sec_fill_noramp road_pri_case_noramp road_pri_fill_noramp road_pri_case_ramp road_pri_fill_ramp road_trunk_case_noramp road_trunk_fill_noramp road_trunk_case_ramp road_trunk_fill-ramp road_mot_case_noramp road_mot_fill_noramp road_mot_case_ramp road_mot_fill_ramp rail rail_dash bridge_path bridge_service_case bridge_service_fill bridge_minor_case bridge_minor_fill bridge_sec_case bridge_sec_fill bridge_pri_case bridge_pri_fill bridge_trunk_case bridge_trunk_fill bridge_mot_case bridge_mot_fill".split(" "),
!0)],null),Vi,new r(null,3,[Fl,"Background \x26 Boundaries",Bn,"background",Lk,new T(null,5,5,U,["background","boundary_county","boundary_state","boundary_country_outline","boundary_country_inner"],null)],null),ml,new r(null,3,[Fl,"Natural Features",Bn,"landcover",Lk,new T(null,8,5,U,"landcover park_national_park park_nature_reserve landuse_residential landuse waterway water water_shadow".split(" "),null)],null),Dn,new r(null,3,[Fl,"Buildings",Bn,"extruded-building",Lk,new T(null,4,5,U,["building",
"building-top","extruded-building","extruded-building-top"],null)],null),ym,new r(null,3,[Fl,"Labels",Bn,"poi_park",Lk,new T(null,27,5,U,"waterway_label watername_ocean watername_sea watername_lake watername_lake_line place_hamlet place_suburbs place_villages place_town place_country_2 place_country_1 place_state place_continent place_city_r6 place_city_r5 place_city_dot_r7 place_city_dot_r4 place_city_dot_r2 place_city_dot_z7 place_capital_dot_z7 poi_stadium poi_park roadname_minor roadname_sec roadname_pri roadname_major housenumber".split(" "),
null)],null)],null),Us=ph(Lk.j(Fi.j(Ts))),Vs=ph(Lk.j(ym.j(Ts))),Ws=no(Us,new lh(null,new r(null,5,["boundary_state",null,"waterway",null,"boundary_county",null,"boundary_country_outline",null,"boundary_country_inner",null],null),null)),Xs=no(new lh(null,new r(null,2,["building-top",null,"building",null],null),null),new lh(null,new r(null,7,["park_nature_reserve",null,"landuse_residential",null,"water",null,"landuse",null,"water_shadow",null,"landcover",null,"park_national_park",null],null),null)),
Ys=new r(null,5,["fill",new lh(null,new r(null,4,[Pk,null,pj,null,Ci,null,si,null],null),null),"fill-extrusion",new lh(null,new r(null,3,[jn,null,fn,null,Ci,null],null),null),"line",new lh(null,new r(null,6,[Il,null,Nl,null,qj,null,ak,null,Ii,null,Ci,null],null),null),"symbol",new lh(null,new r(null,9,[Sl,null,dn,null,Pj,null,pm,null,Ll,null,oi,null,yi,null,Rl,null,Ci,null],null),null),"background",new lh(null,new r(null,3,[Zj,null,hm,null,Ci,null],null),null)],null),Zs=ph(Ps);
function $s(a,b){if(D(b)){if(1>=M(b))return new lh(null,new r(null,1,[0,null],null),null);var c=H(df(function(d,e){e=S(e);return B(e,tj)<=a?d:null},b));return null==c?oh([M(b)-1]):oh([c])}return null}
function at(a,b,c){if(J.m(b,"raster-style"))return rh(new kf(null,-1,Zm,null));b=Lr();b=u(b)?b.getLayer(a):b;if(u(b)){var d=Gc(Ys,b.type,new lh(null,new r(null,1,[Ci,null],null),null));return Te.m(He,ef.m(function(e){if(Nd(d,e)){var f=Nd(Zs,e)?"layout":"paint";f=J.m(f,"layout")?es:ds;var g=ke(e);f=f.m?f.m(a,g):f.call(null,a,g);null!=f?J.m(e,pm)?(f=gi(f),f=Fd(f)?f:"string"===typeof f?new T(null,1,5,U,[f],null):f):f=Nd(Rs,e)||Nd(Ss,e)||J.m(e,Rl)?ms(f,c):Nd(Qs,e)?ls(f,c):f:f=null;return new T(null,2,
5,U,[e,J.m(e,Ci)&&null==f?"visible":f],null)}return new T(null,2,5,U,[e,null],null)},sh))}return rh(new kf(null,-1,null,null))}function bt(a){a=null!=a?na(y.j(a)):null;return ma(null==a?"":String(a))?null:J.m(a,"transparent")?"transparent":0==a.lastIndexOf("#",0)?(a=Ln(a,"#",""),J.m(a.length,3)?["#",y.j(Ce(y,mf(function(b){return lf(2,b)},O([a]))))].join(""):J.m(a.length,6)?["#",a].join(""):null):0==a.lastIndexOf("rgb",0)?(a=Ns(a),u(a)?Ms(a):null):null}
function ct(a,b,c,d){return Nd(ph(Ps),b)?jr(new T(null,5,5,U,[pk,a,b,c,d],null)):jr(new T(null,5,5,U,[Cj,a,b,c,d],null))}
function dt(a){a=S(a);var b=B(a,wk),c=B(a,il),d=B(a,Ni),e=B(a,qn),f=B(a,Aj),g=B(a,Fm),k=B(a,mn);a=Go();var l=0===a.length,p=l||Ka(a.hasOwnProperty(0))?a[0]=zo.j(b):a[0];(l||Ka(a.hasOwnProperty(1)))&&(a[1]=Sp(function(){return $e(p,b)}));return function(){return new T(null,3,5,U,[X,new T(null,2,5,U,[kn,new r(null,7,[sn,"range",qn,e,Aj,f,Fm,g,wk,function(){var q=A(p);return u(q)?q:d}(),Lj,function(q){q=parseFloat(q.target.value);$e(p,q);return c.j?c.j(q):c.call(null,q)},W,"slider-input"],null)],null),
new T(null,3,5,U,[pn,new r(null,1,[W,"single-value-label"],null),function(){var q=A(p);q=u(q)?q:d;return k.j?k.j(q):k.call(null,q)}()],null)],null)}()}var et=function et(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return et.v(arguments[0],c)};et.v=function(a,b){return Te.m(new T(null,3,5,U,[X,new r(null,1,[W,"control-group"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"control-label"],null),a],null)],null),b)};
et.D=1;et.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};function ft(){return new T(null,4,5,U,[X,new r(null,1,[W,"unsupported-message"],null),new T(null,3,5,U,[dl,new r(null,1,[W,"unsupported-message-title"],null),"Style editing is not supported in Raster mode."],null),new T(null,3,5,U,[dl,new r(null,1,[W,"unsupported-message-text"],null),"Switch to Dark or Light vector styles to edit building styles."],null)],null)}
function gt(a){a=S(a);a=B(a,Ck);return new T(null,4,5,U,[X,new r(null,1,[W,"layer-warning"],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-title"],null),["Layer '",y.j(a),"' does not exist in current style."].join("")],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-text"],null),"Style editing will not work for this layer. Please make sure you are using a vector style (Dark or Light)."],null)],null)}
function ht(a){var b=S(a),c=B(b,wk);a=B(b,Lj);b=B(b,Cm);c=bt(c);var d=J.m(c,"transparent"),e=null==c;return new T(null,4,5,U,[X,new r(null,1,[W,"color-input-overlay-container"],null),new T(null,2,5,U,[kn,new r(null,4,[sn,"color",wk,d||e?"#f0f0f0":c,Lj,a,W,["color-input-with-overlay",d||e?" color-input-with-overlay-hidden":null].join("")],null)],null),d||e?new T(null,3,5,U,[X,new r(null,1,[W,"color-input-overlay-content"],null),e?u(b)?b:"NOT SET":"TRANSPARENT"],null):null],null)}
function it(a){var b=S(a);a=B(b,wk);var c=B(b,Lj),d=B(b,Ni);b=B(b,Fl);return new T(null,3,5,U,[X,new T(null,2,5,U,[kn,new r(null,7,[sn,"range",qn,"0",Aj,"1",Fm,"0.1",wk,u(a)?a:d,Lj,c,W,"slider-input"],null)],null),new T(null,3,5,U,[pn,new r(null,1,[W,"single-value-label"],null),["Current: ",y.j(b)].join("")],null)],null)}
function jt(a){a=S(a);var b=B(a,wk),c=B(a,Lj),d=B(a,Ni),e=B(a,Fl);return new T(null,2,5,U,[dt,new r(null,7,[wk,b,il,c,Ni,d,qn,"0",Aj,"20",Fm,"0.5",mn,function(){return["Current: ",y.j(e)].join("")}],null)],null)}
function kt(a){var b=S(a),c=B(b,Bk),d=B(b,Pl),e=B(b,tl);return new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-controls"],null),function(){return function k(g){return new le(null,function(){for(;;){var l=D(g);if(l){var p=l;if(Gd(p)){var q=ec(p),t=M(q),w=pe(t);return function(){for(var Z=0;;)if(Z<t){var qa=db(q,Z),ya=Q(qa,0,null),rb=Q(qa,1,null),Oa=S(rb),ob=B(Oa,tj),kc=B(Oa,wk);se(w,new T(null,4,5,U,[X,new r(null,2,[Y,["color-",y.j(ob),"-",y.j(ya)].join(""),W,["multi-zoom-item",Nd(e,ya)?" multi-zoom-item-active":
null].join("")],null),new T(null,2,5,U,[ht,new r(null,2,[wk,kc,Lj,function(yc,Ff,Gf,Hf,Lb,Ya,Bi,qp,rp,sp,tp,up,vp,wp,xp,Vc){return function(zc){zc=zc.target.value;return Vc.m?Vc.m(Ya,zc):Vc.call(null,Ya,zc)}}(Z,qa,ya,rb,Oa,ob,kc,q,t,w,p,l,a,b,c,d,e)],null)],null),new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-label"],null),["z",y.j(ob)].join("")],null)],null));Z+=1}else return!0}()?re(w.T(),k(fc(p))):re(w.T(),null)}var z=H(p),E=Q(z,0,null),F=Q(z,1,null),P=S(F),V=B(P,tj),ba=B(P,wk);return id(new T(null,
4,5,U,[X,new r(null,2,[Y,["color-",y.j(V),"-",y.j(E)].join(""),W,["multi-zoom-item",Nd(e,E)?" multi-zoom-item-active":null].join("")],null),new T(null,2,5,U,[ht,new r(null,2,[wk,ba,Lj,function(Z,qa,ya,rb,Oa,ob,kc,yc,Ff,Gf,Hf,Lb){return function(Ya){Ya=Ya.target.value;return Lb.m?Lb.m(Oa,Ya):Lb.call(null,Oa,Ya)}}(z,E,F,P,V,ba,p,l,a,b,c,d,e)],null)],null),new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-label"],null),["z",y.j(V)].join("")],null)],null),k(Kc(p)))}return null}},null)}(Ve(c))}()],null)}
function lt(a){var b=S(a),c=B(b,Bk),d=B(b,Pl),e=B(b,tl);return new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-controls"],null),function(){return function k(g){return new le(null,function(){for(;;){var l=D(g);if(l){var p=l;if(Gd(p)){var q=ec(p),t=M(q),w=pe(t);return function(){for(var Z=0;;)if(Z<t){var qa=db(q,Z),ya=Q(qa,0,null),rb=Q(qa,1,null),Oa=S(rb),ob=B(Oa,tj),kc=B(Oa,wk);se(w,new T(null,4,5,U,[X,new r(null,2,[Y,["opacity-",y.j(ob),"-",y.j(ya)].join(""),W,["multi-zoom-item",Nd(e,ya)?" multi-zoom-item-active":
null].join("")],null),new T(null,2,5,U,[kn,new r(null,7,[sn,"range",qn,"0",Aj,"1",Fm,"0.1",wk,function(){var yc=kc;return u(yc)?yc:0}(),Lj,function(yc,Ff,Gf,Hf,Lb,Ya,Bi,qp,rp,sp,tp,up,vp,wp,xp,Vc){return function(zc){zc=parseFloat(zc.target.value);return Vc.m?Vc.m(Ya,zc):Vc.call(null,Ya,zc)}}(Z,qa,ya,rb,Oa,ob,kc,q,t,w,p,l,a,b,c,d,e),W,"slider-input"],null)],null),new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-label"],null),["z",y.j(ob)," (",y.j(Math.round(100*function(){var yc=kc;return u(yc)?yc:
0}())),"%)"].join("")],null)],null));Z+=1}else return!0}()?re(w.T(),k(fc(p))):re(w.T(),null)}var z=H(p),E=Q(z,0,null),F=Q(z,1,null),P=S(F),V=B(P,tj),ba=B(P,wk);return id(new T(null,4,5,U,[X,new r(null,2,[Y,["opacity-",y.j(V),"-",y.j(E)].join(""),W,["multi-zoom-item",Nd(e,E)?" multi-zoom-item-active":null].join("")],null),new T(null,2,5,U,[kn,new r(null,7,[sn,"range",qn,"0",Aj,"1",Fm,"0.1",wk,function(){var Z=ba;return u(Z)?Z:0}(),Lj,function(Z,qa,ya,rb,Oa,ob,kc,yc,Ff,Gf,Hf,Lb){return function(Ya){Ya=
parseFloat(Ya.target.value);return Lb.m?Lb.m(Oa,Ya):Lb.call(null,Oa,Ya)}}(z,E,F,P,V,ba,p,l,a,b,c,d,e),W,"slider-input"],null)],null),new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-label"],null),["z",y.j(V)," (",y.j(Math.round(100*function(){var Z=ba;return u(Z)?Z:0}())),"%)"].join("")],null)],null),k(Kc(p)))}return null}},null)}(Ve(c))}()],null)}
function mt(a){var b=S(a),c=B(b,Bk),d=B(b,Pl),e=B(b,tl);return new T(null,3,5,U,[X,new r(null,1,[W,"multi-zoom-controls"],null),function(){return function k(g){return new le(null,function(){for(;;){var l=D(g);if(l){var p=l;if(Gd(p)){var q=ec(p),t=M(q),w=pe(t);return function(){for(var Z=0;;)if(Z<t){var qa=db(q,Z),ya=Q(qa,0,null),rb=Q(qa,1,null),Oa=S(rb),ob=B(Oa,tj),kc=B(Oa,wk);se(w,new T(null,3,5,U,[X,new r(null,2,[Y,["width-",y.j(ob),"-",y.j(ya)].join(""),W,["multi-zoom-item",Nd(e,ya)?" multi-zoom-item-active":
null].join("")],null),new T(null,2,5,U,[dt,new r(null,7,[wk,kc,il,function(yc,Ff,Gf,Hf,Lb,Ya,Bi,qp,rp,sp,tp,up,vp,wp,xp,Vc){return function(zc){return Vc.m?Vc.m(Ya,zc):Vc.call(null,Ya,zc)}}(Z,qa,ya,rb,Oa,ob,kc,q,t,w,p,l,a,b,c,d,e),Ni,0,qn,"0",Aj,"20",Fm,"0.5",mn,function(yc,Ff,Gf,Hf,Lb,Ya){return function(Bi){return["z",y.j(Ya)," (",y.j(Bi.toFixed(1)),"px)"].join("")}}(Z,qa,ya,rb,Oa,ob,kc,q,t,w,p,l,a,b,c,d,e)],null)],null)],null));Z+=1}else return!0}()?re(w.T(),k(fc(p))):re(w.T(),null)}var z=H(p),
E=Q(z,0,null),F=Q(z,1,null),P=S(F),V=B(P,tj),ba=B(P,wk);return id(new T(null,3,5,U,[X,new r(null,2,[Y,["width-",y.j(V),"-",y.j(E)].join(""),W,["multi-zoom-item",Nd(e,E)?" multi-zoom-item-active":null].join("")],null),new T(null,2,5,U,[dt,new r(null,7,[wk,ba,il,function(Z,qa,ya,rb,Oa,ob,kc,yc,Ff,Gf,Hf,Lb){return function(Ya){return Lb.m?Lb.m(Oa,Ya):Lb.call(null,Oa,Ya)}}(z,E,F,P,V,ba,p,l,a,b,c,d,e),Ni,0,qn,"0",Aj,"20",Fm,"0.5",mn,function(Z,qa,ya,rb,Oa){return function(ob){return["z",y.j(Oa)," (",y.j(ob.toFixed(1)),
"px)"].join("")}}(z,E,F,P,V,ba,p,l,a,b,c,d,e)],null)],null)],null),k(Kc(p)))}return null}},null)}(Ve(c))}()],null)}
function nt(a){var b=S(a);a=B(b,Fl);var c=B(b,wk),d=B(b,rl);b=B(b,Lj);return new T(null,3,5,U,[et,a,new T(null,3,5,U,[Rk,new r(null,3,[wk,u(c)?c:"",Lj,b,W,"styled-select"],null),function(){return function g(f){return new le(null,function(){for(;;){var k=D(f);if(k){if(Gd(k)){var l=ec(k),p=M(l),q=pe(p);a:for(var t=0;;)if(t<p){var w=db(l,t);q.add(new T(null,3,5,U,[rj,new r(null,2,[Y,w,wk,w],null),w],null));t+=1}else{l=!0;break a}return l?re(q.T(),g(fc(k))):re(q.T(),null)}q=H(k);return id(new T(null,
3,5,U,[rj,new r(null,2,[Y,q,wk,q],null),q],null),g(Kc(k)))}return null}},null)}(d)}()],null)],null)}function ot(a){var b=S(a);a=B(b,Fl);var c=B(b,wk);b=B(b,Lj);return new T(null,3,5,U,[et,a,new T(null,2,5,U,[kn,new r(null,4,[sn,"text",wk,u(c)?c:"",Lj,b,W,"styled-select"],null)],null)],null)}function pt(a,b){var c=S(b);b=B(c,Jl);c=B(c,Oj);b=B(b,a);var d=c.j?c.j(a):c.call(null,a);return new r(null,2,[wk,b,Lj,function(e){e=e.target.value;return d.j?d.j(e):d.call(null,e)}],null)}
function qt(a,b){var c=S(b);b=B(c,Jl);c=B(c,Oj);b=B(b,a);var d=c.j?c.j(a):c.call(null,a);a=[y.j(Math.round(100*(u(b)?b:1))),"%"].join("");return new r(null,4,[wk,b,Lj,function(e){e=parseFloat(e.target.value);return d.j?d.j(e):d.call(null,e)},Ni,1,Fl,a],null)}function rt(a){a=S(a);var b=B(a,lm),c=B(a,Fl),d=B(a,lk),e=B(a,Wk);return function(f){return new T(null,3,5,U,[et,c,new T(null,2,5,U,[d,e.m?e.m(b,f):e.call(null,b,f)],null)],null)}}
function st(a){a=S(a);var b=B(a,lm),c=B(a,Fl),d=B(a,rm),e=B(a,ol),f=B(a,mj),g=B(a,gn);return function(k){k=S(k);var l=B(k,Ck),p=B(k,Mm),q=A(Dr(new T(null,1,5,U,[mm],null)));l=ns(l,ke(b),q,d);q=$s(q,l);return new T(null,3,5,U,[et,c,1<M(l)?new T(null,2,5,U,[e,new r(null,3,[Bk,l,tl,q,Pl,p.j?p.j(b):p.call(null,b)],null)],null):new T(null,2,5,U,[f,g.m?g.m(b,k):g.call(null,b,k)],null)],null)}}
var tt=st(new r(null,6,[lm,Nl,Fl,"Line Color",rm,"paint",ol,kt,mj,ht,gn,pt],null)),ut=st(new r(null,6,[lm,qj,Fl,"Line Opacity",rm,"paint",ol,lt,mj,it,gn,qt],null)),vt=st(new r(null,6,[lm,ak,Fl,"Line Width",rm,"paint",ol,mt,mj,jt,gn,function(a,b){var c=S(b);b=B(c,Jl);c=B(c,Oj);b=B(b,a);var d=c.j?c.j(a):c.call(null,a);a="number"===typeof b?[y.j(b.toFixed(1)),"px"].join(""):"default";return new r(null,4,[wk,b,Lj,function(e){e=parseFloat(e.target.value);return d.j?d.j(e):d.call(null,e)},Ni,1,Fl,a],null)}],
null)),wt=st(new r(null,6,[lm,Ll,Fl,"Text Color",rm,"paint",ol,kt,mj,ht,gn,pt],null)),xt=st(new r(null,6,[lm,yi,Fl,"Text Opacity",rm,"paint",ol,lt,mj,it,gn,qt],null)),yt=st(new r(null,6,[lm,Pk,Fl,"Fill Color",rm,"paint",ol,kt,mj,ht,gn,pt],null)),zt=st(new r(null,6,[lm,si,Fl,"Opacity",rm,"paint",ol,lt,mj,it,gn,function(a,b){b=S(b);var c=B(b,Jl),d=B(b,Oj);b=B(c,a);var e=d.j?d.j(a):d.call(null,a);a=(c=J.m(Pk.j(c),"transparent"))?0:b;b=c?"0% (transparent)":"number"===typeof b?[y.j(Math.round(100*b)),
"%"].join(""):"100% (default)";return new r(null,4,[wk,a,Lj,function(f){f=parseFloat(f.target.value);return e.j?e.j(f):e.call(null,f)},Ni,1,Fl,b],null)}],null)),At=rt(new r(null,4,[lm,pj,Fl,"Outline Color",lk,ht,Wk,pt],null)),Bt=rt(new r(null,4,[lm,fn,Fl,"Extrusion Color",lk,ht,Wk,pt],null)),Ct=st(new r(null,6,[lm,jn,Fl,"Extrusion Opacity",rm,"paint",ol,lt,mj,it,gn,qt],null)),Dt=st(new r(null,6,[lm,Zj,Fl,"Background Color",rm,"paint",ol,kt,mj,ht,gn,pt],null)),Et=st(new r(null,6,[lm,hm,Fl,"Background Opacity",
rm,"paint",ol,lt,mj,it,gn,qt],null));function Ft(a){a=S(a);var b=B(a,Jl);a=B(a,Oj);var c=function(){var e=B(b,pm);return Ad(e)?e:md}(),d=a.j?a.j(pm):a.call(null,pm);return new T(null,2,5,U,[nt,new r(null,4,[Fl,"Text Font",wk,H(c),rl,Rd(Od,c),Lj,function(e){var f=e.target.value;e=Wf(id(f,of(function(g){return J.m(g,f)},c)));return d.j?d.j(e):d.call(null,e)}],null)],null)}
var Gt=st(new r(null,6,[lm,Rl,Fl,"Text Size",rm,"layout",ol,mt,mj,jt,gn,function(a,b){var c=S(b);b=B(c,Jl);c=B(c,Oj);b=B(b,a);var d=c.j?c.j(a):c.call(null,a);a="number"===typeof b?[y.j(b.toFixed(0)),"px"].join(""):"default";return new r(null,4,[wk,b,Lj,function(e){e=parseFloat(e.target.value);return d.j?d.j(e):d.call(null,e)},Ni,12,Fl,a],null)}],null));
function Ht(a){var b=S(a),c=B(b,fl);return new T(null,4,5,U,[X,new r(null,1,[W,"category-selector"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"control-label"],null),"Layer Category"],null),new T(null,3,5,U,[X,new r(null,1,[W,"category-selector-items"],null),function(){return function f(e){return new le(null,function(){for(;;){var g=D(e);if(g){var k=g;if(Gd(k)){var l=ec(k),p=M(l),q=pe(p);return function(){for(var P=0;;)if(P<p){var V=db(l,P),ba=Q(V,0,null),Z=Q(V,1,null),qa=S(Z),ya=B(qa,Fl);se(q,new T(null,
4,5,U,[Fl,new r(null,2,[Y,ba,W,["category-item",J.m(c,ba)?" category-item-selected":null].join("")],null),new T(null,2,5,U,[kn,new r(null,6,[sn,"radio",Al,"layer-category",wk,ke(ba),an,J.m(c,ba),Lj,function(rb,Oa,ob){return function(){return jr(new T(null,2,5,U,[Dm,ob],null))}}(P,V,ba,Z,qa,ya,l,p,q,k,g,a,b,c),W,"category-item-radio"],null)],null),ya],null));P+=1}else return!0}()?re(q.T(),f(fc(k))):re(q.T(),null)}var t=H(k),w=Q(t,0,null),z=Q(t,1,null),E=S(z),F=B(E,Fl);return id(new T(null,4,5,U,[Fl,
new r(null,2,[Y,w,W,["category-item",J.m(c,w)?" category-item-selected":null].join("")],null),new T(null,2,5,U,[kn,new r(null,6,[sn,"radio",Al,"layer-category",wk,ke(w),an,J.m(c,w),Lj,function(P,V){return function(){return jr(new T(null,2,5,U,[Dm,V],null))}}(t,w,z,E,F,k,g,a,b,c),W,"category-item-radio"],null)],null),F],null),f(Kc(k)))}return null}},null)}(Ts)}()],null)],null)}
function It(a){var b=S(a);a=B(b,Ck);b=B(b,fl);var c=tf(Ts,new T(null,2,5,U,[b,Lk],null));return new T(null,4,5,U,[X,new r(null,1,[W,"layer-selector"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"control-label"],null),"Target Layer"],null),new T(null,3,5,U,[Rk,new r(null,4,[Y,b,wk,u(a)?a:"",Lj,function(d){return jr(new T(null,2,5,U,[xn,d.target.value],null))},W,"styled-select"],null),function(){return function f(e){return new le(null,function(){for(;;){var g=D(e);if(g){if(Gd(g)){var k=ec(g),l=M(k),
p=pe(l);a:for(var q=0;;)if(q<l){var t=db(k,q);p.add(new T(null,3,5,U,[rj,new r(null,2,[Y,t,wk,t],null),t],null));q+=1}else{k=!0;break a}return k?re(p.T(),f(fc(g))):re(p.T(),null)}p=H(g);return id(new T(null,3,5,U,[rj,new r(null,2,[Y,p,wk,p],null),p],null),f(Kc(g)))}return null}},null)}(Rd(Od,c))}()],null)],null)}
function Jt(a){var b=S(a);a=B(b,Ck);b=B(b,Jl);return new T(null,5,5,U,[X,new r(null,1,[W,"status-info"],null),new T(null,3,5,U,[dl,new r(null,1,[W,"status-info-layer"],null),["Current Layer: ",y.j(a)].join("")],null),new T(null,3,5,U,[dl,new r(null,1,[W,"status-info-note"],null),"Only works with Dark or Light vector styles"],null),new T(null,4,5,U,[dl,new r(null,1,[W,"status-info-styles"],null),"Styles: ",Nh(O([ih(b,sh)]))],null)],null)}
function Kt(a){function b(e){return function(f){return ct(d,e,f.target.value,null)}}var c=S(a),d=B(c,Ck);a=B(c,Jl);c=B(c,Oj);c=new r(null,4,[Ck,d,Jl,a,Oj,c,Mm,function(e){return function(f,g){return ct(d,e,g,f)}}],null);return new T(null,7,5,U,[X,Nd(Xs,d)?new T(null,3,5,U,[ln,vd(new T(null,2,5,U,[yt,c],null),new r(null,1,[Y,"fill-color-control"],null)),vd(new T(null,2,5,U,[zt,c],null),new r(null,1,[Y,"fill-opacity-control"],null))],null):null,J.m(d,"building")?vd(new T(null,2,5,U,[At,c],null),new r(null,
1,[Y,"outline-color-control"],null)):null,Nd(new lh(null,new r(null,2,["extruded-building",null,"extruded-building-top",null],null),null),d)?new T(null,3,5,U,[ln,vd(new T(null,2,5,U,[Bt,c],null),new r(null,1,[Y,"extrusion-color-control"],null)),vd(new T(null,2,5,U,[Ct,c],null),new r(null,1,[Y,"extrusion-opacity-control"],null))],null):null,Nd(Ws,d)?new T(null,5,5,U,[ln,vd(new T(null,3,5,U,[X,new T(null,2,5,U,[nt,new r(null,4,[Fl,"Line Cap",wk,Ii.j(a),rl,new T(null,3,5,U,["butt","round","square"],
null),Lj,b(Ii)],null)],null),new T(null,2,5,U,[nt,new r(null,4,[Fl,"Line Join",wk,Il.j(a),rl,new T(null,3,5,U,["bevel","round","miter"],null),Lj,b(Il)],null)],null)],null),new r(null,1,[Y,"line-layout-controls"],null)),vd(new T(null,2,5,U,[tt,c],null),new r(null,1,[Y,"line-color-control"],null)),vd(new T(null,2,5,U,[ut,c],null),new r(null,1,[Y,"line-opacity-control"],null)),vd(new T(null,2,5,U,[vt,c],null),new r(null,1,[Y,"line-width-control"],null))],null):null,Nd(Vs,d)?new T(null,4,5,U,[ln,vd(new T(null,
4,5,U,[X,new T(null,2,5,U,[ot,new r(null,3,[Fl,"Text Field",wk,oi.j(a),Lj,b(oi)],null)],null),vd(new T(null,2,5,U,[Ft,c],null),new r(null,1,[Y,"text-font-control"],null)),vd(new T(null,2,5,U,[Gt,c],null),new r(null,1,[Y,"text-size-control"],null))],null),new r(null,1,[Y,"label-layout-controls"],null)),vd(new T(null,2,5,U,[wt,c],null),new r(null,1,[Y,"text-color-control"],null)),vd(new T(null,2,5,U,[xt,c],null),new r(null,1,[Y,"text-opacity-control"],null))],null):null,J.m(d,"background")?new T(null,
3,5,U,[ln,vd(new T(null,2,5,U,[Dt,c],null),new r(null,1,[Y,"background-color-control"],null)),vd(new T(null,2,5,U,[Et,c],null),new r(null,1,[Y,"background-opacity-control"],null))],null):null],null)}
function Lt(){return ap(new r(null,2,[Hl,function(){jr(new T(null,1,5,U,[Pi],null));var a=Lr();return u(u(a)?a.isStyleLoaded():a)?jr(new T(null,1,5,U,[vi],null)):null},Kl,function(){var a=A(Dr(new T(null,1,5,U,[ni],null))),b=A(Dr(new T(null,1,5,U,[Km],null))),c=A(Dr(new T(null,1,5,U,[nl],null))),d=A(Dr(new T(null,1,5,U,[ui],null))),e=A(Dr(new T(null,1,5,U,[bj],null))),f=function(){var g=Ka(e);return g?u(b)?cs(b):b:g}();return new T(null,4,5,U,[X,new r(null,1,[W,"style-editor-scrollable"],null),new T(null,
3,5,U,[aj,new r(null,1,[W,"style-editor-title"],null),"Style Editor"],null),J.m(d,Cn)?new T(null,1,5,U,[ft],null):u(e)?new T(null,4,5,U,[X,new r(null,1,[W,"layer-warning"],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-title"],null),"Style is loading..."],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-text"],null),"Please wait for the map style to finish loading."],null)],null):new T(null,6,5,U,[X,new T(null,2,5,U,[Ht,new r(null,1,[fl,c],null)],null),new T(null,2,5,U,[It,new r(null,
2,[Ck,b,fl,c],null)],null),null==b?new T(null,4,5,U,[X,new r(null,1,[W,"layer-warning"],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-title"],null),"No layer selected or available for editing."],null),new T(null,3,5,U,[dl,new r(null,1,[W,"layer-warning-text"],null),"Please select a layer from the dropdown above."],null)],null):null,u(u(b)?Ka(f):b)?new T(null,2,5,U,[gt,new r(null,1,[Ck,b],null)],null):null,u(u(b)?f:b)?function(){function g(k){return function(l){return ct(b,k,l,null)}}return new T(null,
4,5,U,[X,new T(null,4,5,U,[X,new r(null,1,[W,"visibility-toggle"],null),new T(null,2,5,U,[kn,new r(null,5,[sn,"checkbox",Gk,"layer-visibility-checkbox",an,J.m(Ci.j(a),"visible"),Lj,function(k){k=u(k.target.checked)?"visible":"none";return g(Ci)(k)},W,"visibility-checkbox"],null)],null),new T(null,3,5,U,[Fl,new r(null,2,[ok,"layer-visibility-checkbox",W,"visibility-label"],null),"Visible"],null)],null),new T(null,2,5,U,[Kt,new r(null,3,[Ck,b,Jl,a,Oj,g],null)],null),new T(null,2,5,U,[Jt,new r(null,
2,[Ck,b,Jl,a],null)],null)],null)}():null],null)],null)}],null),Np)};var Mt=function Mt(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;c=1<c.length?new G(c.slice(1),0,null):null;return Mt.v(arguments[0],c)};Mt.v=function(a,b){return Te.m(new T(null,2,5,U,[X,wf.o(rd.v(Dd(a)?a:He,wn,O([vj,Ji,cj,ri,Ol,Xi,Ij,Fj])),W,function(c){return["control-panel ",y.j(u(c)?c:"")].join("")})],null),b)};Mt.D=1;Mt.F=function(a){var b=H(a);a=I(a);return this.v(b,a)};
function Nt(a){return new T(null,2,5,U,[kn,wf.o(R.o(rd.m(a,Hi),sn,"range"),W,function(b){return["slider-input ",y.j(u(b)?b:"")].join("")})],null)}function Ot(a){return new T(null,2,5,U,[kn,wf.o(R.o(rd.m(a,Hi),sn,"color"),W,function(b){return["color-picker-input ",y.j(u(b)?b:"")].join("")})],null)};function Pt(){var a=A(Dr(new T(null,1,5,U,[Tl],null))),b=A(Dr(new T(null,1,5,U,[Hj],null))),c=A(Dr(new T(null,1,5,U,[Pm],null)));return new T(null,4,5,U,[Mt,new r(null,1,[Xi,"240px"],null),new T(null,3,5,U,[aj,new r(null,2,[Y,"title",W,"model-controls-title"],null),"3D Models"],null),u(a)?new T(null,7,5,U,[ln,new r(null,1,[Y,"eiffel-controls"],null),new T(null,2,5,U,[Nt,new r(null,7,[Y,"scale-slider",Fl,"Scale",qn,.1,Aj,5,Fm,.1,wk,b,Lj,function(d){return jr(new T(null,2,5,U,[zn,parseFloat(d.target.value)],
null))}],null)],null),new T(null,3,5,U,[X,new r(null,2,[Y,"scale-value",W,"model-controls-value"],null),["x ",y.j(Number(b).toFixed(1))].join("")],null),new T(null,2,5,U,[Nt,new r(null,7,[Y,"rotation-slider",Fl,"Rotation (Z)",qn,0,Aj,360,Fm,1,wk,c,Lj,function(d){return jr(new T(null,2,5,U,[en,parseFloat(d.target.value)],null))}],null)],null),new T(null,3,5,U,[X,new r(null,2,[Y,"rotation-value",W,"model-controls-value"],null),[y.j(Number(c).toFixed(0)),""].join("")],null),new T(null,4,5,U,[X,new r(null,
2,[W,"model-controls-buttons",Hi,new r(null,4,[Mi,"1rem",am,"flex",Bm,"column",Gm,"0.5rem"],null)],null),new T(null,3,5,U,[Cs,new r(null,2,[Y,"fly-to-button",gk,function(){return jr(new T(null,1,5,U,[El],null))}],null),"Fly to Eiffel Tower"],null),new T(null,3,5,U,[Cs,new r(null,3,[Y,"remove-button",W,"model-controls-remove-button",gk,function(){return jr(new T(null,1,5,U,[Hm],null))}],null),"Remove Eiffel Tower"],null)],null)],null):new T(null,3,5,U,[Bs,new r(null,2,[Y,"load-button",gk,function(){return jr(new T(null,
1,5,U,[An],null))}],null),"Load \x26 Display Eiffel Tower"],null)],null)};function Qt(a,b){b=parseFloat(b);return u(isNaN(b))?null:jr(new T(null,3,5,U,[vm,a,b],null))}
function Rt(){var a=A(Dr(new T(null,1,5,U,[Oi],null)));if(u(a)){var b=wn.j(a),c=jd(b);b=kd(b);return new T(null,4,5,U,[X,new r(null,1,[W,"light-controls"],null),new T(null,3,5,U,[aj,new r(null,1,[W,"light-controls-title"],null),"Lighting \x26 Shadows"],null),new T(null,6,5,U,[X,new r(null,1,[Y,"light-controls-container"],null),new T(null,5,5,U,[X,new r(null,2,[Y,"color-control-group",W,"light-control-group"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"light-control-label"],null),"Light Color"],null),
new T(null,2,5,U,[Ot,new r(null,2,[wk,em.j(a),Lj,function(d){return jr(new T(null,3,5,U,[vm,new T(null,1,5,U,[em],null),d.target.value],null))}],null)],null),new T(null,3,5,U,[dl,new r(null,1,[W,"light-control-desc"],null),"Color of the main light source."],null)],null),new T(null,6,5,U,[X,new r(null,2,[Y,"intensity-control-group",W,"light-control-group"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"light-control-label"],null),"Intensity"],null),new T(null,2,5,U,[Nt,new r(null,5,[qn,0,Aj,1,Fm,.05,
wk,wi.j(a),Lj,function(d){return Qt(new T(null,1,5,U,[wi],null),d.target.value)}],null)],null),new T(null,3,5,U,[pn,new r(null,1,[W,"light-control-value"],null),["Current: ",y.j(wi.j(a).toFixed(2))].join("")],null),new T(null,3,5,U,[dl,new r(null,1,[W,"light-control-desc"],null),"Brightness of the light."],null)],null),new T(null,6,5,U,[X,new r(null,2,[Y,"azimuth-control-group",W,"light-control-group"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"light-control-label"],null),"Azimuth"],null),new T(null,
2,5,U,[Nt,new r(null,5,[qn,0,Aj,360,Fm,1,wk,c,Lj,function(d){return Qt(new T(null,2,5,U,[wn,1],null),d.target.value)}],null)],null),new T(null,3,5,U,[pn,new r(null,1,[W,"light-control-value"],null),["Current: ",y.j(c),""].join("")],null),new T(null,3,5,U,[dl,new r(null,1,[W,"light-control-desc"],null),"Direction of the light source (like a compass)."],null)],null),new T(null,6,5,U,[X,new r(null,2,[Y,"polar-control-group",W,"light-control-group"],null),new T(null,3,5,U,[Fl,new r(null,1,[W,"light-control-label"],
null),"Polar"],null),new T(null,2,5,U,[Nt,new r(null,5,[qn,0,Aj,90,Fm,1,wk,b,Lj,function(d){return Qt(new T(null,2,5,U,[wn,2],null),d.target.value)}],null)],null),new T(null,3,5,U,[pn,new r(null,1,[W,"light-control-value"],null),["Current: ",y.j(b),""].join("")],null),new T(null,3,5,U,[dl,new r(null,1,[W,"light-control-desc"],null),"Angle from directly overhead (0) to the horizon (90)."],null)],null)],null)],null)}return null};function St(){var a=A(Dr(new T(null,1,5,U,[om],null)));return new T(null,6,5,U,[X,new r(null,1,[Hi,new r(null,7,[wn,"absolute",vj,"0",ri,"0",Ji,"0",cj,"0",Ol,1E3,Fj,"none"],null)],null),new T(null,3,5,U,[X,new r(null,1,[Hi,new r(null,4,[wn,"absolute",vj,"20px",ri,"20px",Fj,"auto"],null)],null),new T(null,1,5,U,[Ks],null)],null),u(a)?new T(null,4,5,U,[X,new T(null,3,5,U,[X,new r(null,1,[Hi,new r(null,5,[wn,"absolute",vj,"50%",Ji,"20px",al,"translateY(-50%)",Fj,"auto"],null)],null),new T(null,1,5,U,
[Lt],null)],null),new T(null,3,5,U,[X,new r(null,1,[Hi,new r(null,5,[wn,"absolute",cj,"20px",ri,"50%",al,"translateX(-50%)",Fj,"auto"],null)],null),new T(null,1,5,U,[Pt],null)],null),new T(null,3,5,U,[X,new r(null,1,[Hi,new r(null,5,[wn,"absolute",vj,"50%",ri,"20px",al,"translateY(-50%)",Fj,"auto"],null)],null),new T(null,1,5,U,[Rt],null)],null)],null):null,new T(null,2,5,U,[X,new r(null,1,[Hi,new r(null,4,[wn,"absolute",cj,"20px",ri,"20px",Fj,"auto"],null)],null)],null),new T(null,2,5,U,[X,new r(null,
1,[Hi,new r(null,4,[wn,"absolute",cj,"20px",Ji,"20px",Fj,"auto"],null)],null)],null)],null)}function Tt(){return new T(null,3,5,U,[Vj,new T(null,1,5,U,[Wj],null),new T(null,2,5,U,[un,"First-time setup: Caching map data for a smoother experience. Please wait..."],null)],null)}
function Xp(){return ap(new r(null,2,[Hl,function(){console.log("home-page: component-did-mount triggered.");zr(new T(null,1,5,U,[bm],null));ys();console.log("home-page: Calling map-engine/on-map-load.");return Ur(function(){console.log("home-page: map-engine/on-map-load callback triggered. Dispatching :models-3d/add-eiffel-tower.");return jr(new T(null,1,5,U,[An],null))})},Kl,function(){var a=A(Dr(new T(null,1,5,U,[Wi],null)));return new T(null,5,5,U,[X,new r(null,1,[Hi,new r(null,3,[wn,"relative",
Xi,"100%",Jm,"100%"],null)],null),new T(null,1,5,U,[zs],null),new T(null,1,5,U,[St],null),u(a)?new T(null,1,5,U,[Tt],null):null],null)}],null),Np)};Ar.m(Dj,function(a,b){Q(b,0,null);b=Q(b,1,null);return R.o(a,Km,b)});Br(Dm,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);b=Q(b,1,null);var c=tf(Ts,new T(null,2,5,U,[b,Bn],null)),d=ui.j(a);d=B(Jr,d);var e=mm.j(a);d=at(c,d,e);return new r(null,1,[kj,R.o(R.o(R.o(a,nl,b),Km,c),ni,d)],null)});function Ut(a){var b=tf(Ts,new T(null,2,5,U,[Dn,Bn],null)),c=ui.j(a);c=B(Jr,c);var d=mm.j(a);c=at(b,c,d);return R.o(R.o(R.o(a,nl,Dn),Km,b),ni,c)}
Br(Pi,function(a){a=S(a);a=B(a,kj);return u(B(a,nl))?new r(null,1,[kj,a],null):new r(null,1,[kj,Ut(a)],null)});Br(xn,function(a,b){a=S(a);a=B(a,kj);Q(b,0,null);b=Q(b,1,null);var c=ui.j(a);c=B(Jr,c);var d=mm.j(a);c=at(b,c,d);d=Mr(b);d=u(d)?d:15;return new r(null,2,[kj,R.o(R.o(a,Km,b),ni,c),Gi,new T(null,3,5,U,[Um,b,d],null)],null)});Br(Um,function(a,b){Q(b,0,null);a=Q(b,1,null);b=Q(b,2,null);Yr(a,b);return He});
Br(Cj,function(a,b){a=S(a);var c=B(a,kj);Q(b,0,null);var d=Q(b,1,null);a=Q(b,2,null);var e=Q(b,3,null);b=Q(b,4,null);b=u(b)?b:mm.j(c);c=Nd(ph(Ps),a)?"layout":"paint";J.m(a,pm)||(Nd(Qs,a)?e=bt(e):Nd(Rs,a)||Nd(Ss,a)||J.m(a,Rl)?null!=e?"string"===typeof e?(e=parseFloat(e),e=u(isNaN(e))?null:e):e="number"===typeof e?e:null:e=null:e=Nd(new lh(null,new r(null,6,[Sl,null,Il,null,dn,null,Pj,null,Ii,null,Ci,null],null),null),a)?null!=e?na(y.j(e)):null:e);return null!=e?(d=os(d,ke(a),b,e,c),new r(null,1,[Gi,
new T(null,3,5,U,[bn,a,d],null)],null)):He});Br(pk,function(a,b){a=S(a);B(a,kj);Q(b,0,null);a=Q(b,1,null);var c=Q(b,2,null),d=Q(b,3,null);b=Q(b,4,null);return new r(null,1,[nk,new r(null,3,[Y,["update-style-",y.j(a),"-",ke(c)].join(""),tk,new T(null,5,5,U,[Cj,a,c,d,b],null),oj,300],null)],null)});
Br(bn,function(a,b){a=S(a);var c=B(a,kj);Q(b,0,null);a=Q(b,1,null);b=Q(b,2,null);c=uf(c,new T(null,2,5,U,[ni,a],null),b);return J.m(a,Ci)&&J.m(b,"visible")?new r(null,2,[kj,c,Gi,new T(null,1,5,U,[$k],null)],null):new r(null,1,[kj,c],null)});
Br($k,function(a){a=S(a);var b=B(a,kj);a=tf(b,new T(null,1,5,U,[Km],null));b=tf(b,new T(null,1,5,U,[ni],null));b=D(b);for(var c=null,d=0,e=0;;)if(e<d){var f=c.M(null,e),g=Q(f,0,null);f=Q(f,1,null);null!=f&&Nd(ph(Os),g)&&gs(a,ke(g),f);e+=1}else if(b=D(b))Gd(b)?(d=ec(b),b=fc(b),c=d,d=M(d)):(d=H(b),c=Q(d,0,null),d=Q(d,1,null),null!=d&&Nd(ph(Os),c)&&gs(a,ke(c),d),b=I(b),c=null,d=0),e=0;else break;return He});
Br(vi,function(a){a=S(a);a=B(a,kj);var b=ui.j(a),c=Lr(),d=Km.j(a);if(Ka(c)||J.m(b,Cn)||Ka(d))return new r(null,1,[kj,a],null);c=mm.j(a);b=at(d,B(Jr,b),c);return new r(null,1,[kj,R.o(a,ni,b)],null)});Br(dj,function(a){a=S(a);a=B(a,kj);var b=ui.j(a);return J.m(b,Cn)?new r(null,1,[kj,R.o(R.o(R.o(a,Km,null),ni,null),nl,null)],null):new r(null,1,[kj,Ut(a)],null)});Cr(Km,O([function(a){return B(a,Km)}]));Cr(ni,O([function(a){return B(a,ni)}]));Cr(nl,O([function(a){return B(a,nl)}]));Cr(Tl,O([function(a){return Gc(a,Tl,!1)}]));Cr(Hj,O([function(a){return Gc(a,Hj,1)}]));Cr(Pm,O([function(a){return Gc(a,Pm,0)}]));var Vt=new T(null,4,5,U,[new r(null,5,[Gk,"short",qn,0,Aj,20,Em,10,wj,0],null),new r(null,5,[Gk,"medium",qn,20,Aj,50,Em,35,wj,.1],null),new r(null,5,[Gk,"tall",qn,50,Aj,150,Em,100,wj,.2],null),new r(null,5,[Gk,"supertall",qn,150,Aj,1E3,Em,300,wj,.3],null)],null);
function Wt(a){var b=Lr();if(u(b)&&u(a)){var c=wn.j(a);Q(c,0,null);a=Q(c,1,null);c=Q(c,2,null);var d=Math.PI/180*a;a=Math.tan(Math.PI/180*(10>c?c:10));c=Math.sin(d);d=Math.cos(d);for(var e=D(Vt),f=null,g=0,k=0;;)if(k<g){var l=f.M(null,k),p=["extruded-building-shadow-",y.j(Gk.j(l))].join("");u(b.getLayer(p))&&(l=Em.j(l)*a,gs(p,"fill-extrusion-translate",ci(new T(null,2,5,U,[l*-c,l*d],null))));k+=1}else if(e=D(e))Gd(e)?(l=ec(e),e=fc(e),f=l,g=l=M(l)):(l=H(e),f=["extruded-building-shadow-",y.j(Gk.j(l))].join(""),
u(b.getLayer(f))&&(l=Em.j(l)*a,gs(f,"fill-extrusion-translate",ci(new T(null,2,5,U,[l*-c,l*d],null)))),e=I(e),f=null,g=0),k=0;else break}}var Xt=new T(null,12,5,U,[5013364,278644,308687745,308687744,308689164,4114842,4114839,308687746,308145239,69034127,335101043,4114841],null);
function Yt(a,b,c){var d=J.m(a,"extruded-building-top"),e=null!=c,f=new T(null,4,5,U,["coalesce",new T(null,2,5,U,["get","height"],null),new T(null,2,5,U,["get","render_height"],null),10],null),g=d?f:new T(null,4,5,U,["coalesce",new T(null,2,5,U,["get","min_height"],null),new T(null,2,5,U,["get","render_min_height"],null),0],null);b=e?new r(null,7,[fn,"black",sj,new T(null,3,5,U,["+",g,1+wj.j(c)],null),ej,g,jn,.3,ik,new T(null,2,5,U,[0,0],null),Kj,"map",Nj,!1],null):new r(null,7,[fn,b,sj,f,ej,g,jn,
1,Nj,!d,ik,new T(null,2,5,U,[0,0],null),Kj,"map"],null);d=new T(null,2,5,U,["!",new T(null,3,5,U,["in",new T(null,1,5,U,["id"],null),new T(null,2,5,U,["literal",Xt],null)],null)],null);c=e?new T(null,4,5,U,["all",d,new T(null,3,5,U,["\x3e\x3d",f,qn.j(c)],null),new T(null,3,5,U,["\x3c",f,Aj.j(c)],null)],null):d;return ci(new r(null,6,[Gk,a,sn,"fill-extrusion",uk,"carto",um,"building",wl,c,Ul,b],null))};Br(qk,function(){var a=Lr();if(u(a)&&u(a.getSource("carto"))){var b=A(Eq);b=S(b);var c=B(b,ui);b=B(b,Vm);c=J.m(c,Rm)?"#2d3748":"#f0f0f0";for(var d=D(Vt),e=null,f=0,g=0;;)if(g<f){var k=e.M(null,g),l=["extruded-building-shadow-",y.j(Gk.j(k))].join("");u(a.getLayer(l))||(k=Yt(l,c,k),a.addLayer(k));g+=1}else if(d=D(d))Gd(d)?(f=ec(d),d=fc(d),e=f,f=M(f)):(e=H(d),f=["extruded-building-shadow-",y.j(Gk.j(e))].join(""),u(a.getLayer(f))||(e=Yt(f,c,e),a.addLayer(e)),d=I(d),e=null,f=0),g=0;else break;d=D(new T(null,
2,5,U,["extruded-building","extruded-building-top"],null));e=null;for(g=f=0;;)if(g<f)k=e.M(null,g),u(a.getLayer(k))||(k=Yt(k,c,null),a.addLayer(k)),g+=1;else if(d=D(d))Gd(d)?(f=ec(d),d=fc(d),e=f,f=M(f)):(e=H(d),u(a.getLayer(e))||(e=Yt(e,c,null),a.addLayer(e)),d=I(d),e=null,f=0),g=0;else break;Wt(b)}return He});Br(xm,function(a,b){Q(b,0,null);a=Q(b,1,null);Wt(a);return He});var Zt=new Wh(function(){var a=document.getElementById("app");return u(a)?Up.createRoot(a):null});for(var $t=D(A(Vq)),au=null,bu=0,cu=0;;)if(cu<bu){var du=au.M(null,cu);Q(du,0,null);var eu=Q(du,1,null);Ho(eu);cu+=1}else{var fu=D($t);if(fu){var gu=fu;if(Gd(gu)){var hu=ec(gu),iu=fc(gu),ju=hu,ku=M(hu);$t=iu;au=ju;bu=ku}else{var lu=H(gu);Q(lu,0,null);var mu=Q(lu,1,null);Ho(mu);$t=I(gu);au=null;bu=0}cu=0}else break}u(Je(A(Vq)))&&Gq.v(Dl,O(["re-frame: The subscription cache isn't empty after being cleared"]));var Yp=A(Zt);u(Yp)&&Wp();
}).call(this);